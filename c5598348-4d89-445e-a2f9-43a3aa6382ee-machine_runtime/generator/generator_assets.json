{
  "entrypoints": {
    "header": "WITH bounds AS (\n  SELECT\n    COALESCE(NULLIF(:from_date, ''), MIN(timestamp_utc)) AS range_start,\n    COALESCE(NULLIF(:to_date, ''), MAX(timestamp_utc)) AS range_end\n  FROM \"neuract__RUNHOURS\"\n)\nSELECT\n  COALESCE(NULLIF(:company_title, ''), 'NeuraReport Machine Runtime') AS company_title,\n  strftime('%Y-%m-%d %H:%M:%S', 'now', 'localtime') AS print_date,\n  range_start,\n  range_end\nFROM bounds;",
    "rows": "WITH\n      params AS (\n        SELECT\n          NULLIF(:from_date, '') AS from_ts,\n          NULLIF(:to_date, '') AS to_ts,\n          NULLIF(:machine_name, '') AS machine_name\n      ),\n      filtered AS (\n        SELECT f.*\n        FROM \"neuract__RUNHOURS\" f, params p\n        WHERE (p.from_ts IS NULL OR datetime(f.timestamp_utc) >= datetime(p.from_ts))\n          AND (p.to_ts IS NULL OR datetime(f.timestamp_utc) <= datetime(p.to_ts))\n      ),\n      machine_values AS (\nSELECT\n  timestamp_utc,\n  'C1A_1_MC' AS machine_name,\n  CASE WHEN \"C1A_1_MC_HRS\" IS NULL AND \"C1A_1_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C1A_1_MC_HRS\", 0) * 3600 + COALESCE(\"C1A_1_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C1A_MC' AS machine_name,\n  CASE WHEN \"C1A_MC_HRS\" IS NULL AND \"C1A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C1A_MC_HRS\", 0) * 3600 + COALESCE(\"C1A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C2A_MC' AS machine_name,\n  CASE WHEN \"C2A_MC_HRS\" IS NULL AND \"C2A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C2A_MC_HRS\", 0) * 3600 + COALESCE(\"C2A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C3A_MC' AS machine_name,\n  CASE WHEN \"C3A_MC_HRS\" IS NULL AND \"C3A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C3A_MC_HRS\", 0) * 3600 + COALESCE(\"C3A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C4A_MC' AS machine_name,\n  CASE WHEN \"C4A_MC_HRS\" IS NULL AND \"C4A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C4A_MC_HRS\", 0) * 3600 + COALESCE(\"C4A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C5A_MC' AS machine_name,\n  CASE WHEN \"C5A_MC_HRS\" IS NULL AND \"C5A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C5A_MC_HRS\", 0) * 3600 + COALESCE(\"C5A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C6A_MC' AS machine_name,\n  CASE WHEN \"C6A_MC_HRS\" IS NULL AND \"C6A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C6A_MC_HRS\", 0) * 3600 + COALESCE(\"C6A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C7A_MC' AS machine_name,\n  CASE WHEN \"C7A_MC_HRS\" IS NULL AND \"C7A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C7A_MC_HRS\", 0) * 3600 + COALESCE(\"C7A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C8A_MC' AS machine_name,\n  CASE WHEN \"C8A_MC_HRS\" IS NULL AND \"C8A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C8A_MC_HRS\", 0) * 3600 + COALESCE(\"C8A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'F1A_MC' AS machine_name,\n  CASE WHEN \"F1A_MC_HRS\" IS NULL AND \"F1A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"F1A_MC_HRS\", 0) * 3600 + COALESCE(\"F1A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G10A_MC' AS machine_name,\n  CASE WHEN \"G10A_MC_HRS\" IS NULL AND \"G10A_MC_MIN\" IS NULL AND \"G10A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G10A_MC_HRS\", 0) * 3600 + COALESCE(\"G10A_MC_MIN\", 0) * 60 + COALESCE(\"G10A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G11A_MC' AS machine_name,\n  CASE WHEN \"G11A_MC_HRS\" IS NULL AND \"G11A_MC_MIN\" IS NULL AND \"G11A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G11A_MC_HRS\", 0) * 3600 + COALESCE(\"G11A_MC_MIN\", 0) * 60 + COALESCE(\"G11A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G13A_MC' AS machine_name,\n  CASE WHEN \"G13A_MC_HRS\" IS NULL AND \"G13A_MC_MIN\" IS NULL AND \"G13A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G13A_MC_HRS\", 0) * 3600 + COALESCE(\"G13A_MC_MIN\", 0) * 60 + COALESCE(\"G13A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G1A_1_MC' AS machine_name,\n  CASE WHEN \"G1A_1_MC_HRS\" IS NULL AND \"G1A_1_MC_MIN\" IS NULL AND \"G1A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G1A_1_MC_HRS\", 0) * 3600 + COALESCE(\"G1A_1_MC_MIN\", 0) * 60 + COALESCE(\"G1A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G1A_MC' AS machine_name,\n  CASE WHEN \"G1A_MC_HRS\" IS NULL AND \"G1A_MC_MIN\" IS NULL AND \"G1A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G1A_MC_HRS\", 0) * 3600 + COALESCE(\"G1A_MC_MIN\", 0) * 60 + COALESCE(\"G1A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G3A_MC' AS machine_name,\n  CASE WHEN \"G3A_MC_HRS\" IS NULL AND \"G3A_MC_MIN\" IS NULL AND \"G3A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G3A_MC_HRS\", 0) * 3600 + COALESCE(\"G3A_MC_MIN\", 0) * 60 + COALESCE(\"G3A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G4A_MC' AS machine_name,\n  CASE WHEN \"G4A_MC_HRS\" IS NULL AND \"G4A_MC_MIN\" IS NULL AND \"G4A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G4A_MC_HRS\", 0) * 3600 + COALESCE(\"G4A_MC_MIN\", 0) * 60 + COALESCE(\"G4A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G5A_1_MC' AS machine_name,\n  CASE WHEN \"G5A_1_MC_HRS\" IS NULL AND \"G5A_1_MC_MIN\" IS NULL AND \"G5A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G5A_1_MC_HRS\", 0) * 3600 + COALESCE(\"G5A_1_MC_MIN\", 0) * 60 + COALESCE(\"G5A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G5A_2_MC' AS machine_name,\n  CASE WHEN \"G5A_2_MC_HRS\" IS NULL AND \"G5A_2_MC_MIN\" IS NULL AND \"G5A_2_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G5A_2_MC_HRS\", 0) * 3600 + COALESCE(\"G5A_2_MC_MIN\", 0) * 60 + COALESCE(\"G5A_2_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G5A_MC' AS machine_name,\n  CASE WHEN \"G5A_MC_HRS\" IS NULL AND \"G5A_MC_MIN\" IS NULL AND \"G5A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G5A_MC_HRS\", 0) * 3600 + COALESCE(\"G5A_MC_MIN\", 0) * 60 + COALESCE(\"G5A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G7A_MC' AS machine_name,\n  CASE WHEN \"G7A_MC_HRS\" IS NULL AND \"G7A_MC_MIN\" IS NULL AND \"G7A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G7A_MC_HRS\", 0) * 3600 + COALESCE(\"G7A_MC_MIN\", 0) * 60 + COALESCE(\"G7A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G9A_MC' AS machine_name,\n  CASE WHEN \"G9A_MC_HRS\" IS NULL AND \"G9A_MC_MIN\" IS NULL AND \"G9A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G9A_MC_HRS\", 0) * 3600 + COALESCE(\"G9A_MC_MIN\", 0) * 60 + COALESCE(\"G9A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I10A_MC' AS machine_name,\n  CASE WHEN \"I10A_MC_HRS\" IS NULL AND \"I10A_MC_MIN\" IS NULL AND \"I10A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I10A_MC_HRS\", 0) * 3600 + COALESCE(\"I10A_MC_MIN\", 0) * 60 + COALESCE(\"I10A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I1A_MC' AS machine_name,\n  CASE WHEN \"I1A_MC_HRS\" IS NULL AND \"I1A_MC_MIN\" IS NULL AND \"I1A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I1A_MC_HRS\", 0) * 3600 + COALESCE(\"I1A_MC_MIN\", 0) * 60 + COALESCE(\"I1A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I2A_MC' AS machine_name,\n  CASE WHEN \"I2A_MC_HRS\" IS NULL AND \"I2A_MC_MIN\" IS NULL AND \"I2A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I2A_MC_HRS\", 0) * 3600 + COALESCE(\"I2A_MC_MIN\", 0) * 60 + COALESCE(\"I2A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I3A_MC' AS machine_name,\n  CASE WHEN \"I3A_MC_HRS\" IS NULL AND \"I3A_MC_MIN\" IS NULL AND \"I3A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I3A_MC_HRS\", 0) * 3600 + COALESCE(\"I3A_MC_MIN\", 0) * 60 + COALESCE(\"I3A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I4A_1_MC' AS machine_name,\n  CASE WHEN \"I4A_1_MC_HRS\" IS NULL AND \"I4A_1_MC_MIN\" IS NULL AND \"I4A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I4A_1_MC_HRS\", 0) * 3600 + COALESCE(\"I4A_1_MC_MIN\", 0) * 60 + COALESCE(\"I4A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I4A_2_MC' AS machine_name,\n  CASE WHEN \"I4A_2_MC_HRS\" IS NULL AND \"I4A_2_MC_MIN\" IS NULL AND \"I4A_2_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I4A_2_MC_HRS\", 0) * 3600 + COALESCE(\"I4A_2_MC_MIN\", 0) * 60 + COALESCE(\"I4A_2_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I5A_MC' AS machine_name,\n  CASE WHEN \"I5A_MC_HRS\" IS NULL AND \"I5A_MC_MIN\" IS NULL AND \"I5A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I5A_MC_HRS\", 0) * 3600 + COALESCE(\"I5A_MC_MIN\", 0) * 60 + COALESCE(\"I5A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_A_MC' AS machine_name,\n  CASE WHEN \"I6A_A_MC_HRS\" IS NULL AND \"I6A_A_MC_MIN\" IS NULL AND \"I6A_A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_A_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_A_MC_MIN\", 0) * 60 + COALESCE(\"I6A_A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_B_MC' AS machine_name,\n  CASE WHEN \"I6A_B_MC_HRS\" IS NULL AND \"I6A_B_MC_MIN\" IS NULL AND \"I6A_B_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_B_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_B_MC_MIN\", 0) * 60 + COALESCE(\"I6A_B_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_C_MC' AS machine_name,\n  CASE WHEN \"I6A_C_MC_HRS\" IS NULL AND \"I6A_C_MC_MIN\" IS NULL AND \"I6A_C_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_C_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_C_MC_MIN\", 0) * 60 + COALESCE(\"I6A_C_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_D_MC' AS machine_name,\n  CASE WHEN \"I6A_D_MC_HRS\" IS NULL AND \"I6A_D_MC_MIN\" IS NULL AND \"I6A_D_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_D_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_D_MC_MIN\", 0) * 60 + COALESCE(\"I6A_D_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_E_MC' AS machine_name,\n  CASE WHEN \"I6A_E_MC_HRS\" IS NULL AND \"I6A_E_MC_MIN\" IS NULL AND \"I6A_E_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_E_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_E_MC_MIN\", 0) * 60 + COALESCE(\"I6A_E_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_F_MC' AS machine_name,\n  CASE WHEN \"I6A_F_MC_HRS\" IS NULL AND \"I6A_F_MC_MIN\" IS NULL AND \"I6A_F_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_F_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_F_MC_MIN\", 0) * 60 + COALESCE(\"I6A_F_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_G_MC' AS machine_name,\n  CASE WHEN \"I6A_G_MC_HRS\" IS NULL AND \"I6A_G_MC_MIN\" IS NULL AND \"I6A_G_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_G_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_G_MC_MIN\", 0) * 60 + COALESCE(\"I6A_G_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_H_MC' AS machine_name,\n  CASE WHEN \"I6A_H_MC_HRS\" IS NULL AND \"I6A_H_MC_MIN\" IS NULL AND \"I6A_H_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_H_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_H_MC_MIN\", 0) * 60 + COALESCE(\"I6A_H_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_I_MC' AS machine_name,\n  CASE WHEN \"I6A_I_MC_HRS\" IS NULL AND \"I6A_I_MC_MIN\" IS NULL AND \"I6A_I_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_I_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_I_MC_MIN\", 0) * 60 + COALESCE(\"I6A_I_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_J_MC' AS machine_name,\n  CASE WHEN \"I6A_J_MC_HRS\" IS NULL AND \"I6A_J_MC_MIN\" IS NULL AND \"I6A_J_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_J_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_J_MC_MIN\", 0) * 60 + COALESCE(\"I6A_J_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_K_MC' AS machine_name,\n  CASE WHEN \"I6A_K_MC_HRS\" IS NULL AND \"I6A_K_MC_MIN\" IS NULL AND \"I6A_K_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_K_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_K_MC_MIN\", 0) * 60 + COALESCE(\"I6A_K_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_L_MC' AS machine_name,\n  CASE WHEN \"I6A_L_MC_HRS\" IS NULL AND \"I6A_L_MC_MIN\" IS NULL AND \"I6A_L_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_L_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_L_MC_MIN\", 0) * 60 + COALESCE(\"I6A_L_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I8A_1_MC' AS machine_name,\n  CASE WHEN \"I8A_1_MC_HRS\" IS NULL AND \"I8A_1_MC_MIN\" IS NULL AND \"I8A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I8A_1_MC_HRS\", 0) * 3600 + COALESCE(\"I8A_1_MC_MIN\", 0) * 60 + COALESCE(\"I8A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I8A_MC' AS machine_name,\n  CASE WHEN \"I8A_MC_HRS\" IS NULL AND \"I8A_MC_MIN\" IS NULL AND \"I8A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I8A_MC_HRS\", 0) * 3600 + COALESCE(\"I8A_MC_MIN\", 0) * 60 + COALESCE(\"I8A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I9A_MC' AS machine_name,\n  CASE WHEN \"I9A_MC_HRS\" IS NULL AND \"I9A_MC_MIN\" IS NULL AND \"I9A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I9A_MC_HRS\", 0) * 3600 + COALESCE(\"I9A_MC_MIN\", 0) * 60 + COALESCE(\"I9A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_11_MC' AS machine_name,\n  CASE WHEN \"M1A_11_MC_HRS\" IS NULL AND \"M1A_11_MC_MIN\" IS NULL AND \"M1A_11_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_11_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_11_MC_MIN\", 0) * 60 + COALESCE(\"M1A_11_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_18_MC' AS machine_name,\n  CASE WHEN \"M1A_18_MC_HRS\" IS NULL AND \"M1A_18_MC_MIN\" IS NULL AND \"M1A_18_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_18_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_18_MC_MIN\", 0) * 60 + COALESCE(\"M1A_18_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_1_MC' AS machine_name,\n  CASE WHEN \"M1A_1_MC_HRS\" IS NULL AND \"M1A_1_MC_MIN\" IS NULL AND \"M1A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_1_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_1_MC_MIN\", 0) * 60 + COALESCE(\"M1A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_2_MC' AS machine_name,\n  CASE WHEN \"M1A_2_MC_HRS\" IS NULL AND \"M1A_2_MC_MIN\" IS NULL AND \"M1A_2_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_2_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_2_MC_MIN\", 0) * 60 + COALESCE(\"M1A_2_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_3_MC' AS machine_name,\n  CASE WHEN \"M1A_3_MC_HRS\" IS NULL AND \"M1A_3_MC_MIN\" IS NULL AND \"M1A_3_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_3_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_3_MC_MIN\", 0) * 60 + COALESCE(\"M1A_3_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_9_MC' AS machine_name,\n  CASE WHEN \"M1A_9_MC_HRS\" IS NULL AND \"M1A_9_MC_MIN\" IS NULL AND \"M1A_9_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_9_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_9_MC_MIN\", 0) * 60 + COALESCE(\"M1A_9_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_MC' AS machine_name,\n  CASE WHEN \"M1A_MC_HRS\" IS NULL AND \"M1A_MC_MIN\" IS NULL AND \"M1A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_MC_MIN\", 0) * 60 + COALESCE(\"M1A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M2A_MC' AS machine_name,\n  CASE WHEN \"M2A_MC_HRS\" IS NULL AND \"M2A_MC_MIN\" IS NULL AND \"M2A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M2A_MC_HRS\", 0) * 3600 + COALESCE(\"M2A_MC_MIN\", 0) * 60 + COALESCE(\"M2A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M3A_MC' AS machine_name,\n  CASE WHEN \"M3A_MC_HRS\" IS NULL AND \"M3A_MC_MIN\" IS NULL AND \"M3A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M3A_MC_HRS\", 0) * 3600 + COALESCE(\"M3A_MC_MIN\", 0) * 60 + COALESCE(\"M3A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M4A_MC' AS machine_name,\n  CASE WHEN \"M4A_MC_HRS\" IS NULL AND \"M4A_MC_MIN\" IS NULL AND \"M4A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M4A_MC_HRS\", 0) * 3600 + COALESCE(\"M4A_MC_MIN\", 0) * 60 + COALESCE(\"M4A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M5A_MC' AS machine_name,\n  CASE WHEN \"M5A_MC_HRS\" IS NULL AND \"M5A_MC_MIN\" IS NULL AND \"M5A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M5A_MC_HRS\", 0) * 3600 + COALESCE(\"M5A_MC_MIN\", 0) * 60 + COALESCE(\"M5A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P11A_MC' AS machine_name,\n  CASE WHEN \"P11A_MC_HRS\" IS NULL AND \"P11A_MC_MIN\" IS NULL AND \"P11A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P11A_MC_HRS\", 0) * 3600 + COALESCE(\"P11A_MC_MIN\", 0) * 60 + COALESCE(\"P11A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P12A_MC' AS machine_name,\n  CASE WHEN \"P12A_MC_HRS\" IS NULL AND \"P12A_MC_MIN\" IS NULL AND \"P12A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P12A_MC_HRS\", 0) * 3600 + COALESCE(\"P12A_MC_MIN\", 0) * 60 + COALESCE(\"P12A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P13A_MC' AS machine_name,\n  CASE WHEN \"P13A_MC_HRS\" IS NULL AND \"P13A_MC_MIN\" IS NULL AND \"P13A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P13A_MC_HRS\", 0) * 3600 + COALESCE(\"P13A_MC_MIN\", 0) * 60 + COALESCE(\"P13A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P14A_MC' AS machine_name,\n  CASE WHEN \"P14A_MC_HRS\" IS NULL AND \"P14A_MC_MIN\" IS NULL AND \"P14A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P14A_MC_HRS\", 0) * 3600 + COALESCE(\"P14A_MC_MIN\", 0) * 60 + COALESCE(\"P14A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P15A_MC' AS machine_name,\n  CASE WHEN \"P15A_MC_HRS\" IS NULL AND \"P15A_MC_MIN\" IS NULL AND \"P15A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P15A_MC_HRS\", 0) * 3600 + COALESCE(\"P15A_MC_MIN\", 0) * 60 + COALESCE(\"P15A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P16A_MC' AS machine_name,\n  CASE WHEN \"P16A_MC_HRS\" IS NULL AND \"P16A_MC_MIN\" IS NULL AND \"P16A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P16A_MC_HRS\", 0) * 3600 + COALESCE(\"P16A_MC_MIN\", 0) * 60 + COALESCE(\"P16A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P1A_MC' AS machine_name,\n  CASE WHEN \"P1A_MC_HRS\" IS NULL AND \"P1A_MC_MIN\" IS NULL AND \"P1A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P1A_MC_HRS\", 0) * 3600 + COALESCE(\"P1A_MC_MIN\", 0) * 60 + COALESCE(\"P1A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P2A_MC' AS machine_name,\n  CASE WHEN \"P2A_MC_HRS\" IS NULL AND \"P2A_MC_MIN\" IS NULL AND \"P2A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P2A_MC_HRS\", 0) * 3600 + COALESCE(\"P2A_MC_MIN\", 0) * 60 + COALESCE(\"P2A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P3A_MC' AS machine_name,\n  CASE WHEN \"P3A_MC_HRS\" IS NULL AND \"P3A_MC_MIN\" IS NULL AND \"P3A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P3A_MC_HRS\", 0) * 3600 + COALESCE(\"P3A_MC_MIN\", 0) * 60 + COALESCE(\"P3A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P4A_MC' AS machine_name,\n  CASE WHEN \"P4A_MC_HRS\" IS NULL AND \"P4A_MC_MIN\" IS NULL AND \"P4A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P4A_MC_HRS\", 0) * 3600 + COALESCE(\"P4A_MC_MIN\", 0) * 60 + COALESCE(\"P4A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P5A_MC' AS machine_name,\n  CASE WHEN \"P5A_MC_HRS\" IS NULL AND \"P5A_MC_MIN\" IS NULL AND \"P5A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P5A_MC_HRS\", 0) * 3600 + COALESCE(\"P5A_MC_MIN\", 0) * 60 + COALESCE(\"P5A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P6A_MC' AS machine_name,\n  CASE WHEN \"P6A_MC_HRS\" IS NULL AND \"P6A_MC_MIN\" IS NULL AND \"P6A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P6A_MC_HRS\", 0) * 3600 + COALESCE(\"P6A_MC_MIN\", 0) * 60 + COALESCE(\"P6A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P7A_1_MC' AS machine_name,\n  CASE WHEN \"P7A_1_MC_HRS\" IS NULL AND \"P7A_1_MC_MIN\" IS NULL AND \"P7A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P7A_1_MC_HRS\", 0) * 3600 + COALESCE(\"P7A_1_MC_MIN\", 0) * 60 + COALESCE(\"P7A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P7A_2_MC' AS machine_name,\n  CASE WHEN \"P7A_2_MC_HRS\" IS NULL AND \"P7A_2_MC_MIN\" IS NULL AND \"P7A_2_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P7A_2_MC_HRS\", 0) * 3600 + COALESCE(\"P7A_2_MC_MIN\", 0) * 60 + COALESCE(\"P7A_2_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P7A_MC' AS machine_name,\n  CASE WHEN \"P7A_MC_HRS\" IS NULL AND \"P7A_MC_MIN\" IS NULL AND \"P7A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P7A_MC_HRS\", 0) * 3600 + COALESCE(\"P7A_MC_MIN\", 0) * 60 + COALESCE(\"P7A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P8A_1_MC' AS machine_name,\n  CASE WHEN \"P8A_1_MC_HRS\" IS NULL AND \"P8A_1_MC_MIN\" IS NULL AND \"P8A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P8A_1_MC_HRS\", 0) * 3600 + COALESCE(\"P8A_1_MC_MIN\", 0) * 60 + COALESCE(\"P8A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P8A_2_MC' AS machine_name,\n  CASE WHEN \"P8A_2_MC_HRS\" IS NULL AND \"P8A_2_MC_MIN\" IS NULL AND \"P8A_2_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P8A_2_MC_HRS\", 0) * 3600 + COALESCE(\"P8A_2_MC_MIN\", 0) * 60 + COALESCE(\"P8A_2_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P8A_3_MC' AS machine_name,\n  CASE WHEN \"P8A_3_MC_HRS\" IS NULL AND \"P8A_3_MC_MIN\" IS NULL AND \"P8A_3_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P8A_3_MC_HRS\", 0) * 3600 + COALESCE(\"P8A_3_MC_MIN\", 0) * 60 + COALESCE(\"P8A_3_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P8A_4_MC' AS machine_name,\n  CASE WHEN \"P8A_4_MC_HRS\" IS NULL AND \"P8A_4_MC_MIN\" IS NULL AND \"P8A_4_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P8A_4_MC_HRS\", 0) * 3600 + COALESCE(\"P8A_4_MC_MIN\", 0) * 60 + COALESCE(\"P8A_4_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P8A_5_MC' AS machine_name,\n  CASE WHEN \"P8A_5_MC_HRS\" IS NULL AND \"P8A_5_MC_MIN\" IS NULL AND \"P8A_5_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P8A_5_MC_HRS\", 0) * 3600 + COALESCE(\"P8A_5_MC_MIN\", 0) * 60 + COALESCE(\"P8A_5_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P8A_MC' AS machine_name,\n  CASE WHEN \"P8A_MC_HRS\" IS NULL AND \"P8A_MC_MIN\" IS NULL AND \"P8A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P8A_MC_HRS\", 0) * 3600 + COALESCE(\"P8A_MC_MIN\", 0) * 60 + COALESCE(\"P8A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P9A_MC' AS machine_name,\n  CASE WHEN \"P9A_MC_HRS\" IS NULL AND \"P9A_MC_MIN\" IS NULL AND \"P9A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P9A_MC_HRS\", 0) * 3600 + COALESCE(\"P9A_MC_MIN\", 0) * 60 + COALESCE(\"P9A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\n      ),\n\nordered AS (\n  SELECT\n    machine_name,\n    timestamp_utc,\n    total_seconds,\n    LEAD(timestamp_utc) OVER (PARTITION BY machine_name ORDER BY timestamp_utc) AS next_ts,\n    LEAD(total_seconds) OVER (PARTITION BY machine_name ORDER BY timestamp_utc) AS next_value\n  FROM machine_values\n  WHERE total_seconds IS NOT NULL\n),\nrunning AS (\n  SELECT\n    machine_name,\n    timestamp_utc AS current_ts,\n    next_ts,\n    total_seconds,\n    next_value,\n    CASE\n      WHEN next_ts IS NULL THEN 0\n      WHEN next_value IS NULL THEN 0\n      WHEN total_seconds = next_value THEN 0\n      ELSE 1\n    END AS is_running\n  FROM ordered\n),\nstart_marked AS (\n  SELECT\n    *,\n    CASE\n      WHEN is_running = 1\n       AND COALESCE(LAG(is_running) OVER (PARTITION BY machine_name ORDER BY current_ts), 0) = 0\n      THEN 1 ELSE 0\n    END AS start_flag\n  FROM running\n),\nrun_groups AS (\n  SELECT\n    *,\n    SUM(start_flag) OVER (\n      PARTITION BY machine_name\n      ORDER BY current_ts\n      ROWS UNBOUNDED PRECEDING\n    ) AS run_group\n  FROM start_marked\n  WHERE is_running = 1\n),\nfinal AS (\n  SELECT\n    machine_name,\n    MIN(current_ts) AS start_ts,\n    MAX(next_ts) AS end_ts,\n    CAST(ROUND((julianday(MAX(next_ts)) - julianday(MIN(current_ts))) * 86400.0) AS INTEGER) AS duration_sec\n  FROM run_groups\n  GROUP BY machine_name, run_group\n  HAVING start_ts IS NOT NULL AND end_ts IS NOT NULL\n)\n\nSELECT\n  final.machine_name AS machine_name,\n  substr(start_ts, 1, 10) AS run_date,\n  substr(start_ts, 12, 8) AS start_time,\n  substr(end_ts, 12, 8) AS end_time,\n  duration_sec,\n  CASE\n    WHEN CAST(substr(start_ts, 12, 2) AS INTEGER) BETWEEN 6 AND 13 THEN '1'\n    WHEN CAST(substr(start_ts, 12, 2) AS INTEGER) BETWEEN 14 AND 21 THEN '2'\n    ELSE '3'\n  END AS shift_no,\n  printf('%02d:%02d:%02d', duration_sec / 3600, (duration_sec / 60) % 60, duration_sec % 60) AS total_time\nFROM final, params p\nWHERE duration_sec > 0\n  AND (p.machine_name IS NULL OR final.machine_name = p.machine_name)\nORDER BY final.machine_name, start_ts;\n",
    "totals": "WITH\n      params AS (\n        SELECT\n          NULLIF(:from_date, '') AS from_ts,\n          NULLIF(:to_date, '') AS to_ts,\n          NULLIF(:machine_name, '') AS machine_name\n      ),\n      filtered AS (\n        SELECT f.*\n        FROM \"neuract__RUNHOURS\" f, params p\n        WHERE (p.from_ts IS NULL OR datetime(f.timestamp_utc) >= datetime(p.from_ts))\n          AND (p.to_ts IS NULL OR datetime(f.timestamp_utc) <= datetime(p.to_ts))\n      ),\n      machine_values AS (\nSELECT\n  timestamp_utc,\n  'C1A_1_MC' AS machine_name,\n  CASE WHEN \"C1A_1_MC_HRS\" IS NULL AND \"C1A_1_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C1A_1_MC_HRS\", 0) * 3600 + COALESCE(\"C1A_1_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C1A_MC' AS machine_name,\n  CASE WHEN \"C1A_MC_HRS\" IS NULL AND \"C1A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C1A_MC_HRS\", 0) * 3600 + COALESCE(\"C1A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C2A_MC' AS machine_name,\n  CASE WHEN \"C2A_MC_HRS\" IS NULL AND \"C2A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C2A_MC_HRS\", 0) * 3600 + COALESCE(\"C2A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C3A_MC' AS machine_name,\n  CASE WHEN \"C3A_MC_HRS\" IS NULL AND \"C3A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C3A_MC_HRS\", 0) * 3600 + COALESCE(\"C3A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C4A_MC' AS machine_name,\n  CASE WHEN \"C4A_MC_HRS\" IS NULL AND \"C4A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C4A_MC_HRS\", 0) * 3600 + COALESCE(\"C4A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C5A_MC' AS machine_name,\n  CASE WHEN \"C5A_MC_HRS\" IS NULL AND \"C5A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C5A_MC_HRS\", 0) * 3600 + COALESCE(\"C5A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C6A_MC' AS machine_name,\n  CASE WHEN \"C6A_MC_HRS\" IS NULL AND \"C6A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C6A_MC_HRS\", 0) * 3600 + COALESCE(\"C6A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C7A_MC' AS machine_name,\n  CASE WHEN \"C7A_MC_HRS\" IS NULL AND \"C7A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C7A_MC_HRS\", 0) * 3600 + COALESCE(\"C7A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'C8A_MC' AS machine_name,\n  CASE WHEN \"C8A_MC_HRS\" IS NULL AND \"C8A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"C8A_MC_HRS\", 0) * 3600 + COALESCE(\"C8A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'F1A_MC' AS machine_name,\n  CASE WHEN \"F1A_MC_HRS\" IS NULL AND \"F1A_MC_MIN\" IS NULL THEN NULL ELSE COALESCE(\"F1A_MC_HRS\", 0) * 3600 + COALESCE(\"F1A_MC_MIN\", 0) * 60 END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G10A_MC' AS machine_name,\n  CASE WHEN \"G10A_MC_HRS\" IS NULL AND \"G10A_MC_MIN\" IS NULL AND \"G10A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G10A_MC_HRS\", 0) * 3600 + COALESCE(\"G10A_MC_MIN\", 0) * 60 + COALESCE(\"G10A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G11A_MC' AS machine_name,\n  CASE WHEN \"G11A_MC_HRS\" IS NULL AND \"G11A_MC_MIN\" IS NULL AND \"G11A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G11A_MC_HRS\", 0) * 3600 + COALESCE(\"G11A_MC_MIN\", 0) * 60 + COALESCE(\"G11A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G13A_MC' AS machine_name,\n  CASE WHEN \"G13A_MC_HRS\" IS NULL AND \"G13A_MC_MIN\" IS NULL AND \"G13A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G13A_MC_HRS\", 0) * 3600 + COALESCE(\"G13A_MC_MIN\", 0) * 60 + COALESCE(\"G13A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G1A_1_MC' AS machine_name,\n  CASE WHEN \"G1A_1_MC_HRS\" IS NULL AND \"G1A_1_MC_MIN\" IS NULL AND \"G1A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G1A_1_MC_HRS\", 0) * 3600 + COALESCE(\"G1A_1_MC_MIN\", 0) * 60 + COALESCE(\"G1A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G1A_MC' AS machine_name,\n  CASE WHEN \"G1A_MC_HRS\" IS NULL AND \"G1A_MC_MIN\" IS NULL AND \"G1A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G1A_MC_HRS\", 0) * 3600 + COALESCE(\"G1A_MC_MIN\", 0) * 60 + COALESCE(\"G1A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G3A_MC' AS machine_name,\n  CASE WHEN \"G3A_MC_HRS\" IS NULL AND \"G3A_MC_MIN\" IS NULL AND \"G3A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G3A_MC_HRS\", 0) * 3600 + COALESCE(\"G3A_MC_MIN\", 0) * 60 + COALESCE(\"G3A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G4A_MC' AS machine_name,\n  CASE WHEN \"G4A_MC_HRS\" IS NULL AND \"G4A_MC_MIN\" IS NULL AND \"G4A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G4A_MC_HRS\", 0) * 3600 + COALESCE(\"G4A_MC_MIN\", 0) * 60 + COALESCE(\"G4A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G5A_1_MC' AS machine_name,\n  CASE WHEN \"G5A_1_MC_HRS\" IS NULL AND \"G5A_1_MC_MIN\" IS NULL AND \"G5A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G5A_1_MC_HRS\", 0) * 3600 + COALESCE(\"G5A_1_MC_MIN\", 0) * 60 + COALESCE(\"G5A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G5A_2_MC' AS machine_name,\n  CASE WHEN \"G5A_2_MC_HRS\" IS NULL AND \"G5A_2_MC_MIN\" IS NULL AND \"G5A_2_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G5A_2_MC_HRS\", 0) * 3600 + COALESCE(\"G5A_2_MC_MIN\", 0) * 60 + COALESCE(\"G5A_2_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G5A_MC' AS machine_name,\n  CASE WHEN \"G5A_MC_HRS\" IS NULL AND \"G5A_MC_MIN\" IS NULL AND \"G5A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G5A_MC_HRS\", 0) * 3600 + COALESCE(\"G5A_MC_MIN\", 0) * 60 + COALESCE(\"G5A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G7A_MC' AS machine_name,\n  CASE WHEN \"G7A_MC_HRS\" IS NULL AND \"G7A_MC_MIN\" IS NULL AND \"G7A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G7A_MC_HRS\", 0) * 3600 + COALESCE(\"G7A_MC_MIN\", 0) * 60 + COALESCE(\"G7A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'G9A_MC' AS machine_name,\n  CASE WHEN \"G9A_MC_HRS\" IS NULL AND \"G9A_MC_MIN\" IS NULL AND \"G9A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"G9A_MC_HRS\", 0) * 3600 + COALESCE(\"G9A_MC_MIN\", 0) * 60 + COALESCE(\"G9A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I10A_MC' AS machine_name,\n  CASE WHEN \"I10A_MC_HRS\" IS NULL AND \"I10A_MC_MIN\" IS NULL AND \"I10A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I10A_MC_HRS\", 0) * 3600 + COALESCE(\"I10A_MC_MIN\", 0) * 60 + COALESCE(\"I10A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I1A_MC' AS machine_name,\n  CASE WHEN \"I1A_MC_HRS\" IS NULL AND \"I1A_MC_MIN\" IS NULL AND \"I1A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I1A_MC_HRS\", 0) * 3600 + COALESCE(\"I1A_MC_MIN\", 0) * 60 + COALESCE(\"I1A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I2A_MC' AS machine_name,\n  CASE WHEN \"I2A_MC_HRS\" IS NULL AND \"I2A_MC_MIN\" IS NULL AND \"I2A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I2A_MC_HRS\", 0) * 3600 + COALESCE(\"I2A_MC_MIN\", 0) * 60 + COALESCE(\"I2A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I3A_MC' AS machine_name,\n  CASE WHEN \"I3A_MC_HRS\" IS NULL AND \"I3A_MC_MIN\" IS NULL AND \"I3A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I3A_MC_HRS\", 0) * 3600 + COALESCE(\"I3A_MC_MIN\", 0) * 60 + COALESCE(\"I3A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I4A_1_MC' AS machine_name,\n  CASE WHEN \"I4A_1_MC_HRS\" IS NULL AND \"I4A_1_MC_MIN\" IS NULL AND \"I4A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I4A_1_MC_HRS\", 0) * 3600 + COALESCE(\"I4A_1_MC_MIN\", 0) * 60 + COALESCE(\"I4A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I4A_2_MC' AS machine_name,\n  CASE WHEN \"I4A_2_MC_HRS\" IS NULL AND \"I4A_2_MC_MIN\" IS NULL AND \"I4A_2_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I4A_2_MC_HRS\", 0) * 3600 + COALESCE(\"I4A_2_MC_MIN\", 0) * 60 + COALESCE(\"I4A_2_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I5A_MC' AS machine_name,\n  CASE WHEN \"I5A_MC_HRS\" IS NULL AND \"I5A_MC_MIN\" IS NULL AND \"I5A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I5A_MC_HRS\", 0) * 3600 + COALESCE(\"I5A_MC_MIN\", 0) * 60 + COALESCE(\"I5A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_A_MC' AS machine_name,\n  CASE WHEN \"I6A_A_MC_HRS\" IS NULL AND \"I6A_A_MC_MIN\" IS NULL AND \"I6A_A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_A_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_A_MC_MIN\", 0) * 60 + COALESCE(\"I6A_A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_B_MC' AS machine_name,\n  CASE WHEN \"I6A_B_MC_HRS\" IS NULL AND \"I6A_B_MC_MIN\" IS NULL AND \"I6A_B_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_B_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_B_MC_MIN\", 0) * 60 + COALESCE(\"I6A_B_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_C_MC' AS machine_name,\n  CASE WHEN \"I6A_C_MC_HRS\" IS NULL AND \"I6A_C_MC_MIN\" IS NULL AND \"I6A_C_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_C_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_C_MC_MIN\", 0) * 60 + COALESCE(\"I6A_C_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_D_MC' AS machine_name,\n  CASE WHEN \"I6A_D_MC_HRS\" IS NULL AND \"I6A_D_MC_MIN\" IS NULL AND \"I6A_D_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_D_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_D_MC_MIN\", 0) * 60 + COALESCE(\"I6A_D_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_E_MC' AS machine_name,\n  CASE WHEN \"I6A_E_MC_HRS\" IS NULL AND \"I6A_E_MC_MIN\" IS NULL AND \"I6A_E_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_E_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_E_MC_MIN\", 0) * 60 + COALESCE(\"I6A_E_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_F_MC' AS machine_name,\n  CASE WHEN \"I6A_F_MC_HRS\" IS NULL AND \"I6A_F_MC_MIN\" IS NULL AND \"I6A_F_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_F_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_F_MC_MIN\", 0) * 60 + COALESCE(\"I6A_F_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_G_MC' AS machine_name,\n  CASE WHEN \"I6A_G_MC_HRS\" IS NULL AND \"I6A_G_MC_MIN\" IS NULL AND \"I6A_G_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_G_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_G_MC_MIN\", 0) * 60 + COALESCE(\"I6A_G_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_H_MC' AS machine_name,\n  CASE WHEN \"I6A_H_MC_HRS\" IS NULL AND \"I6A_H_MC_MIN\" IS NULL AND \"I6A_H_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_H_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_H_MC_MIN\", 0) * 60 + COALESCE(\"I6A_H_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_I_MC' AS machine_name,\n  CASE WHEN \"I6A_I_MC_HRS\" IS NULL AND \"I6A_I_MC_MIN\" IS NULL AND \"I6A_I_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_I_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_I_MC_MIN\", 0) * 60 + COALESCE(\"I6A_I_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_J_MC' AS machine_name,\n  CASE WHEN \"I6A_J_MC_HRS\" IS NULL AND \"I6A_J_MC_MIN\" IS NULL AND \"I6A_J_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_J_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_J_MC_MIN\", 0) * 60 + COALESCE(\"I6A_J_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_K_MC' AS machine_name,\n  CASE WHEN \"I6A_K_MC_HRS\" IS NULL AND \"I6A_K_MC_MIN\" IS NULL AND \"I6A_K_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_K_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_K_MC_MIN\", 0) * 60 + COALESCE(\"I6A_K_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I6A_L_MC' AS machine_name,\n  CASE WHEN \"I6A_L_MC_HRS\" IS NULL AND \"I6A_L_MC_MIN\" IS NULL AND \"I6A_L_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I6A_L_MC_HRS\", 0) * 3600 + COALESCE(\"I6A_L_MC_MIN\", 0) * 60 + COALESCE(\"I6A_L_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I8A_1_MC' AS machine_name,\n  CASE WHEN \"I8A_1_MC_HRS\" IS NULL AND \"I8A_1_MC_MIN\" IS NULL AND \"I8A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I8A_1_MC_HRS\", 0) * 3600 + COALESCE(\"I8A_1_MC_MIN\", 0) * 60 + COALESCE(\"I8A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I8A_MC' AS machine_name,\n  CASE WHEN \"I8A_MC_HRS\" IS NULL AND \"I8A_MC_MIN\" IS NULL AND \"I8A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I8A_MC_HRS\", 0) * 3600 + COALESCE(\"I8A_MC_MIN\", 0) * 60 + COALESCE(\"I8A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'I9A_MC' AS machine_name,\n  CASE WHEN \"I9A_MC_HRS\" IS NULL AND \"I9A_MC_MIN\" IS NULL AND \"I9A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"I9A_MC_HRS\", 0) * 3600 + COALESCE(\"I9A_MC_MIN\", 0) * 60 + COALESCE(\"I9A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_11_MC' AS machine_name,\n  CASE WHEN \"M1A_11_MC_HRS\" IS NULL AND \"M1A_11_MC_MIN\" IS NULL AND \"M1A_11_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_11_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_11_MC_MIN\", 0) * 60 + COALESCE(\"M1A_11_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_18_MC' AS machine_name,\n  CASE WHEN \"M1A_18_MC_HRS\" IS NULL AND \"M1A_18_MC_MIN\" IS NULL AND \"M1A_18_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_18_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_18_MC_MIN\", 0) * 60 + COALESCE(\"M1A_18_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_1_MC' AS machine_name,\n  CASE WHEN \"M1A_1_MC_HRS\" IS NULL AND \"M1A_1_MC_MIN\" IS NULL AND \"M1A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_1_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_1_MC_MIN\", 0) * 60 + COALESCE(\"M1A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_2_MC' AS machine_name,\n  CASE WHEN \"M1A_2_MC_HRS\" IS NULL AND \"M1A_2_MC_MIN\" IS NULL AND \"M1A_2_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_2_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_2_MC_MIN\", 0) * 60 + COALESCE(\"M1A_2_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_3_MC' AS machine_name,\n  CASE WHEN \"M1A_3_MC_HRS\" IS NULL AND \"M1A_3_MC_MIN\" IS NULL AND \"M1A_3_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_3_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_3_MC_MIN\", 0) * 60 + COALESCE(\"M1A_3_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_9_MC' AS machine_name,\n  CASE WHEN \"M1A_9_MC_HRS\" IS NULL AND \"M1A_9_MC_MIN\" IS NULL AND \"M1A_9_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_9_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_9_MC_MIN\", 0) * 60 + COALESCE(\"M1A_9_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M1A_MC' AS machine_name,\n  CASE WHEN \"M1A_MC_HRS\" IS NULL AND \"M1A_MC_MIN\" IS NULL AND \"M1A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M1A_MC_HRS\", 0) * 3600 + COALESCE(\"M1A_MC_MIN\", 0) * 60 + COALESCE(\"M1A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M2A_MC' AS machine_name,\n  CASE WHEN \"M2A_MC_HRS\" IS NULL AND \"M2A_MC_MIN\" IS NULL AND \"M2A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M2A_MC_HRS\", 0) * 3600 + COALESCE(\"M2A_MC_MIN\", 0) * 60 + COALESCE(\"M2A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M3A_MC' AS machine_name,\n  CASE WHEN \"M3A_MC_HRS\" IS NULL AND \"M3A_MC_MIN\" IS NULL AND \"M3A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M3A_MC_HRS\", 0) * 3600 + COALESCE(\"M3A_MC_MIN\", 0) * 60 + COALESCE(\"M3A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M4A_MC' AS machine_name,\n  CASE WHEN \"M4A_MC_HRS\" IS NULL AND \"M4A_MC_MIN\" IS NULL AND \"M4A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M4A_MC_HRS\", 0) * 3600 + COALESCE(\"M4A_MC_MIN\", 0) * 60 + COALESCE(\"M4A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'M5A_MC' AS machine_name,\n  CASE WHEN \"M5A_MC_HRS\" IS NULL AND \"M5A_MC_MIN\" IS NULL AND \"M5A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"M5A_MC_HRS\", 0) * 3600 + COALESCE(\"M5A_MC_MIN\", 0) * 60 + COALESCE(\"M5A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P11A_MC' AS machine_name,\n  CASE WHEN \"P11A_MC_HRS\" IS NULL AND \"P11A_MC_MIN\" IS NULL AND \"P11A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P11A_MC_HRS\", 0) * 3600 + COALESCE(\"P11A_MC_MIN\", 0) * 60 + COALESCE(\"P11A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P12A_MC' AS machine_name,\n  CASE WHEN \"P12A_MC_HRS\" IS NULL AND \"P12A_MC_MIN\" IS NULL AND \"P12A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P12A_MC_HRS\", 0) * 3600 + COALESCE(\"P12A_MC_MIN\", 0) * 60 + COALESCE(\"P12A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P13A_MC' AS machine_name,\n  CASE WHEN \"P13A_MC_HRS\" IS NULL AND \"P13A_MC_MIN\" IS NULL AND \"P13A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P13A_MC_HRS\", 0) * 3600 + COALESCE(\"P13A_MC_MIN\", 0) * 60 + COALESCE(\"P13A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P14A_MC' AS machine_name,\n  CASE WHEN \"P14A_MC_HRS\" IS NULL AND \"P14A_MC_MIN\" IS NULL AND \"P14A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P14A_MC_HRS\", 0) * 3600 + COALESCE(\"P14A_MC_MIN\", 0) * 60 + COALESCE(\"P14A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P15A_MC' AS machine_name,\n  CASE WHEN \"P15A_MC_HRS\" IS NULL AND \"P15A_MC_MIN\" IS NULL AND \"P15A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P15A_MC_HRS\", 0) * 3600 + COALESCE(\"P15A_MC_MIN\", 0) * 60 + COALESCE(\"P15A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P16A_MC' AS machine_name,\n  CASE WHEN \"P16A_MC_HRS\" IS NULL AND \"P16A_MC_MIN\" IS NULL AND \"P16A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P16A_MC_HRS\", 0) * 3600 + COALESCE(\"P16A_MC_MIN\", 0) * 60 + COALESCE(\"P16A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P1A_MC' AS machine_name,\n  CASE WHEN \"P1A_MC_HRS\" IS NULL AND \"P1A_MC_MIN\" IS NULL AND \"P1A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P1A_MC_HRS\", 0) * 3600 + COALESCE(\"P1A_MC_MIN\", 0) * 60 + COALESCE(\"P1A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P2A_MC' AS machine_name,\n  CASE WHEN \"P2A_MC_HRS\" IS NULL AND \"P2A_MC_MIN\" IS NULL AND \"P2A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P2A_MC_HRS\", 0) * 3600 + COALESCE(\"P2A_MC_MIN\", 0) * 60 + COALESCE(\"P2A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P3A_MC' AS machine_name,\n  CASE WHEN \"P3A_MC_HRS\" IS NULL AND \"P3A_MC_MIN\" IS NULL AND \"P3A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P3A_MC_HRS\", 0) * 3600 + COALESCE(\"P3A_MC_MIN\", 0) * 60 + COALESCE(\"P3A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P4A_MC' AS machine_name,\n  CASE WHEN \"P4A_MC_HRS\" IS NULL AND \"P4A_MC_MIN\" IS NULL AND \"P4A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P4A_MC_HRS\", 0) * 3600 + COALESCE(\"P4A_MC_MIN\", 0) * 60 + COALESCE(\"P4A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P5A_MC' AS machine_name,\n  CASE WHEN \"P5A_MC_HRS\" IS NULL AND \"P5A_MC_MIN\" IS NULL AND \"P5A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P5A_MC_HRS\", 0) * 3600 + COALESCE(\"P5A_MC_MIN\", 0) * 60 + COALESCE(\"P5A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P6A_MC' AS machine_name,\n  CASE WHEN \"P6A_MC_HRS\" IS NULL AND \"P6A_MC_MIN\" IS NULL AND \"P6A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P6A_MC_HRS\", 0) * 3600 + COALESCE(\"P6A_MC_MIN\", 0) * 60 + COALESCE(\"P6A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P7A_1_MC' AS machine_name,\n  CASE WHEN \"P7A_1_MC_HRS\" IS NULL AND \"P7A_1_MC_MIN\" IS NULL AND \"P7A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P7A_1_MC_HRS\", 0) * 3600 + COALESCE(\"P7A_1_MC_MIN\", 0) * 60 + COALESCE(\"P7A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P7A_2_MC' AS machine_name,\n  CASE WHEN \"P7A_2_MC_HRS\" IS NULL AND \"P7A_2_MC_MIN\" IS NULL AND \"P7A_2_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P7A_2_MC_HRS\", 0) * 3600 + COALESCE(\"P7A_2_MC_MIN\", 0) * 60 + COALESCE(\"P7A_2_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P7A_MC' AS machine_name,\n  CASE WHEN \"P7A_MC_HRS\" IS NULL AND \"P7A_MC_MIN\" IS NULL AND \"P7A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P7A_MC_HRS\", 0) * 3600 + COALESCE(\"P7A_MC_MIN\", 0) * 60 + COALESCE(\"P7A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P8A_1_MC' AS machine_name,\n  CASE WHEN \"P8A_1_MC_HRS\" IS NULL AND \"P8A_1_MC_MIN\" IS NULL AND \"P8A_1_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P8A_1_MC_HRS\", 0) * 3600 + COALESCE(\"P8A_1_MC_MIN\", 0) * 60 + COALESCE(\"P8A_1_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P8A_2_MC' AS machine_name,\n  CASE WHEN \"P8A_2_MC_HRS\" IS NULL AND \"P8A_2_MC_MIN\" IS NULL AND \"P8A_2_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P8A_2_MC_HRS\", 0) * 3600 + COALESCE(\"P8A_2_MC_MIN\", 0) * 60 + COALESCE(\"P8A_2_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P8A_3_MC' AS machine_name,\n  CASE WHEN \"P8A_3_MC_HRS\" IS NULL AND \"P8A_3_MC_MIN\" IS NULL AND \"P8A_3_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P8A_3_MC_HRS\", 0) * 3600 + COALESCE(\"P8A_3_MC_MIN\", 0) * 60 + COALESCE(\"P8A_3_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P8A_4_MC' AS machine_name,\n  CASE WHEN \"P8A_4_MC_HRS\" IS NULL AND \"P8A_4_MC_MIN\" IS NULL AND \"P8A_4_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P8A_4_MC_HRS\", 0) * 3600 + COALESCE(\"P8A_4_MC_MIN\", 0) * 60 + COALESCE(\"P8A_4_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P8A_5_MC' AS machine_name,\n  CASE WHEN \"P8A_5_MC_HRS\" IS NULL AND \"P8A_5_MC_MIN\" IS NULL AND \"P8A_5_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P8A_5_MC_HRS\", 0) * 3600 + COALESCE(\"P8A_5_MC_MIN\", 0) * 60 + COALESCE(\"P8A_5_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P8A_MC' AS machine_name,\n  CASE WHEN \"P8A_MC_HRS\" IS NULL AND \"P8A_MC_MIN\" IS NULL AND \"P8A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P8A_MC_HRS\", 0) * 3600 + COALESCE(\"P8A_MC_MIN\", 0) * 60 + COALESCE(\"P8A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\nUNION ALL\nSELECT\n  timestamp_utc,\n  'P9A_MC' AS machine_name,\n  CASE WHEN \"P9A_MC_HRS\" IS NULL AND \"P9A_MC_MIN\" IS NULL AND \"P9A_MC_SEC\" IS NULL THEN NULL ELSE COALESCE(\"P9A_MC_HRS\", 0) * 3600 + COALESCE(\"P9A_MC_MIN\", 0) * 60 + COALESCE(\"P9A_MC_SEC\", 0) END AS total_seconds\nFROM filtered\n      ),\n\nordered AS (\n  SELECT\n    machine_name,\n    timestamp_utc,\n    total_seconds,\n    LEAD(timestamp_utc) OVER (PARTITION BY machine_name ORDER BY timestamp_utc) AS next_ts,\n    LEAD(total_seconds) OVER (PARTITION BY machine_name ORDER BY timestamp_utc) AS next_value\n  FROM machine_values\n  WHERE total_seconds IS NOT NULL\n),\nrunning AS (\n  SELECT\n    machine_name,\n    timestamp_utc AS current_ts,\n    next_ts,\n    total_seconds,\n    next_value,\n    CASE\n      WHEN next_ts IS NULL THEN 0\n      WHEN next_value IS NULL THEN 0\n      WHEN total_seconds = next_value THEN 0\n      ELSE 1\n    END AS is_running\n  FROM ordered\n),\nstart_marked AS (\n  SELECT\n    *,\n    CASE\n      WHEN is_running = 1\n       AND COALESCE(LAG(is_running) OVER (PARTITION BY machine_name ORDER BY current_ts), 0) = 0\n      THEN 1 ELSE 0\n    END AS start_flag\n  FROM running\n),\nrun_groups AS (\n  SELECT\n    *,\n    SUM(start_flag) OVER (\n      PARTITION BY machine_name\n      ORDER BY current_ts\n      ROWS UNBOUNDED PRECEDING\n    ) AS run_group\n  FROM start_marked\n  WHERE is_running = 1\n),\nfinal AS (\n  SELECT\n    machine_name,\n    MIN(current_ts) AS start_ts,\n    MAX(next_ts) AS end_ts,\n    CAST(ROUND((julianday(MAX(next_ts)) - julianday(MIN(current_ts))) * 86400.0) AS INTEGER) AS duration_sec\n  FROM run_groups\n  GROUP BY machine_name, run_group\n  HAVING start_ts IS NOT NULL AND end_ts IS NOT NULL\n)\n\nSELECT\n  COALESCE(SUM(duration_sec), 0) AS total_duration_sec,\n  printf('%02d:%02d:%02d',\n         COALESCE(SUM(duration_sec), 0) / 3600,\n         (COALESCE(SUM(duration_sec), 0) / 60) % 60,\n         COALESCE(SUM(duration_sec), 0) % 60) AS total_duration_hms,\n  COUNT(DISTINCT final.machine_name) AS machines_covered\nFROM final, params p\nWHERE duration_sec > 0\n  AND (p.machine_name IS NULL OR final.machine_name = p.machine_name);\n"
  },
  "params": {
    "required": [],
    "optional": [
      "from_ts",
      "to_ts",
      "machine_name",
      "company_title"
    ]
  },
  "dialect": "sqlite",
  "needs_user_fix": [],
  "invalid": false,
  "summary": {}
}