# Role permissions: p, role, resource_pattern, http_method_regex

# Admin: full access to everything
p, admin, /*, (GET)|(POST)|(PUT)|(DELETE)|(PATCH)

# Editor: read + write to most resources, no user management
p, editor, /reports/*, (GET)|(POST)|(PUT)|(DELETE)
p, editor, /templates/*, (GET)|(POST)|(PUT)|(DELETE)
p, editor, /documents/*, (GET)|(POST)|(PUT)|(DELETE)
p, editor, /spreadsheets/*, (GET)|(POST)|(PUT)|(DELETE)
p, editor, /dashboards/*, (GET)|(POST)|(PUT)|(DELETE)
p, editor, /charts/*, (GET)|(POST)|(PUT)|(DELETE)
p, editor, /ai/*, (GET)|(POST)
p, editor, /agents/*, (GET)|(POST)
p, editor, /synthesis/*, (GET)|(POST)
p, editor, /docqa/*, (GET)|(POST)
p, editor, /docai/*, (GET)|(POST)
p, editor, /export/*, (GET)|(POST)
p, editor, /ingestion/*, (GET)|(POST)
p, editor, /workflows/*, (GET)|(POST)|(PUT)|(DELETE)
p, editor, /connections/*, (GET)|(POST)|(PUT)|(DELETE)
p, editor, /connectors/*, (GET)|(POST)
p, editor, /knowledge/*, (GET)|(POST)|(PUT)|(DELETE)
p, editor, /search/*, (GET)
p, editor, /analytics/*, (GET)
p, editor, /design/*, (GET)|(POST)|(PUT)
p, editor, /enrichment/*, (GET)|(POST)
p, editor, /nl2sql/*, (GET)|(POST)
p, editor, /visualization/*, (GET)|(POST)
p, editor, /recommendations/*, (GET)|(POST)
p, editor, /federation/*, (GET)|(POST)
p, editor, /summary/*, (GET)|(POST)
p, editor, /jobs/*, (GET)

# Viewer: read-only access
p, viewer, /reports/*, (GET)
p, viewer, /templates/*, (GET)
p, viewer, /documents/*, (GET)
p, viewer, /spreadsheets/*, (GET)
p, viewer, /dashboards/*, (GET)
p, viewer, /charts/*, (GET)
p, viewer, /search/*, (GET)
p, viewer, /analytics/*, (GET)
p, viewer, /knowledge/*, (GET)
p, viewer, /jobs/*, (GET)
p, viewer, /export/*, (GET)|(POST)
p, viewer, /design/*, (GET)

# Public endpoints (no role needed)
p, anonymous, /health, (GET)
p, anonymous, /healthz, (GET)
p, anonymous, /ready, (GET)
p, anonymous, /readyz, (GET)
p, anonymous, /auth/*, (GET)|(POST)

# Role hierarchy (editor inherits viewer, admin inherits editor)
g, editor, viewer
g, admin, editor
