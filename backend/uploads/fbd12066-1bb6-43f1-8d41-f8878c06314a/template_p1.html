<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Batch report</title>
<style>
  @page { size: A4; margin: 12mm; }
  body {
    font-family: "Times New Roman", serif;
    font-size: 12px;
    line-height: 1.2;
    color: #000;
    margin: 0;
  }
  .topbar {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 6mm;
    margin-bottom: 3mm;
  }
  .topbar .kv {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
  }
  .kv td { padding: 2px 4px; vertical-align: top; }
  .kv td.label { width: 28mm; white-space: nowrap; }
  .kv td.colon { width: 3mm; text-align: center; }
  .title {
    text-align: center;
    font-size: 20px;
    font-weight: 700;
    margin: 1mm 0 3mm;
  }
  .print-line {
    border-top: 1px solid #000;
    border-bottom: 1px solid #000;
    padding: 3px 6px;
    font-weight: 700;
    margin-bottom: 3mm;
  }

  /* Batch block container */
  .batch-block {
    break-inside: avoid;
    page-break-inside: avoid;
    margin: 6mm 0;
  }

  /* Header box (left details + right scale timings) */
  .hdr-box {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
    border: 1px solid #000;
    margin-bottom: 2mm;
  }
  .hdr-box td {
    vertical-align: top;
    padding: 2mm 2.5mm;
  }
  .hdr-left {
    width: 65%;
    border-right: 1px solid #000;
  }
  .kv-inner {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
  }
  .kv-inner td { padding: 1px 2px; }
  .kv-inner td.label { width: 25mm; white-space: nowrap; }
  .kv-inner td.colon { width: 3mm; text-align: center; }
  .kv-inner td.value { word-break: break-word; }

  .scale-table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
  }
  .scale-table th, .scale-table td {
    padding: 2px 3px;
    text-align: left;
  }
  .scale-table thead th {
    font-weight: 700;
    border-bottom: 1px solid #000;
  }
  .scale-table col.scale { width: 34%; }
  .scale-table col.time { width: 33%; }
  .scale-table col.dur { width: 33%; }

  /* Materials table */
  .materials {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
    border: 1px solid #000;
  }
  .materials th, .materials td {
    border: 1px solid #000;
    padding: 3px 4px;
  }
  .materials thead th {
    text-align: left;
    font-weight: 700;
  }
  .materials .num { text-align: right; }
  .materials col.bin  { width: 10%; }
  .materials col.name { width: 40%; }
  .materials col.set  { width: 12%; }
  .materials col.ach  { width: 12%; }
  .materials col.err  { width: 12%; }
  .materials col.errp { width: 8%; }
  .materials col.dose { width: 6%; }

  .total-row td {
    font-weight: 700;
  }
  .total-row td.label {
    text-align: right;
  }

  .footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 8mm;
    border-top: 1px solid #000;
    padding-top: 3mm;
    font-size: 12px;
  }
</style>
</head>
<body>

<div class="topbar">
  <table class="kv">
    <tr>
      <td class="label">Plant name</td><td class="colon">:</td><td>{{plant_name}}</td>
    </tr>
    <tr>
      <td class="label">Location</td><td class="colon">:</td><td>{{location}}</td>
    </tr>
  </table>

  <table class="kv">
    <tr>
      <td class="label">Date</td><td class="colon">:</td><td>{{report_date}}</td>
    </tr>
    <tr>
      <td class="label">Recipe</td><td class="colon">:</td><td>{{recipe_header}}</td>
    </tr>
    <tr>
      <td class="label">Shift No</td><td class="colon">:</td><td>{{shift_no}}</td>
    </tr>
  </table>
</div>

<div class="title">Batch report</div>

<div class="print-line">Print Date : {{print_date}}</div>

<!-- BEGIN:BLOCK_REPEAT batches -->
<section class="batch-block">

  <table class="hdr-box">
    <tr>
      <td class="hdr-left">
        <table class="kv-inner">
          <tr>
            <td class="label">Batch No</td><td class="colon">:</td><td class="value">{{batch_no}}</td>
          </tr>
          <tr>
            <td class="label">Batch Date</td><td class="colon">:</td><td class="value">{{batch_date}}</td>
          </tr>
          <tr>
            <td class="label">Shift No</td><td class="colon">:</td><td class="value">{{shift_no}}</td>
          </tr>
          <tr>
            <td class="label">Recipe Name</td><td class="colon">:</td><td class="value">{{recipe_name}}</td>
          </tr>
          <tr>
            <td class="label">Recipe Code</td><td class="colon">:</td><td class="value">{{recipe_code}}</td>
          </tr>
          <tr>
            <td class="label">Recipe No</td><td class="colon">:</td><td class="value">{{recipe_no}}</td>
          </tr>
        </table>
      </td>
      <td>
        <table class="scale-table">
          <colgroup>
            <col class="scale"><col class="time"><col class="dur">
          </colgroup>
          <thead>
            <tr>
              <th>Scale</th>
              <th>Start time</th>
              <th>Dur(sec)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>{{scale1_name}}</td>
              <td>{{scale1_start}}</td>
              <td class="num">{{scale1_dur_sec}}</td>
            </tr>
            <tr>
              <td>{{scale2_name}}</td>
              <td>{{scale2_start}}</td>
              <td class="num">{{scale2_dur_sec}}</td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
  </table>

  <table class="materials">
    <colgroup>
      <col class="bin"><col class="name"><col class="set"><col class="ach"><col class="err"><col class="errp"><col class="dose">
    </colgroup>
    <thead>
      <tr>
        <th>Bin No</th>
        <th>Material Name</th>
        <th>Set wt(Kg)</th>
        <th>Ach wt(Kg)</th>
        <th>Error(Kg)</th>
        <th>Error %</th>
        <th>Dosine Dur (sec)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="num">{{sl}}</td>
        <td>{{name}}</td>
        <td class="num">{{set}}</td>
        <td class="num">{{ach}}</td>
        <td class="num">{{err}}</td>
        <td class="num">{{errp}}</td>
        <td class="num"></td>
      </tr>
    </tbody>
    <tfoot>
      <tr class="total-row">
        <td colspan="2" class="label">Total :</td>
        <td class="num">{{total_set}}</td>
        <td class="num">{{total_ach}}</td>
        <td class="num">{{total_err}}</td>
        <td class="num">{{total_errp}}</td>
        <td class="num">{{total_dose_dur_sec}}</td>
      </tr>
    </tfoot>
  </table>

</section>
<!-- END:BLOCK_REPEAT -->

<div class="footer">
  <div>Indian Industrial Machines Pvt. Ltd.</div>
  <div>Page {{page_no}} of {{page_count}}</div>
</div>

</body>
</html>