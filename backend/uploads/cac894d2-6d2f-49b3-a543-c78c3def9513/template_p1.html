<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>{title}</title>
<style>
  @page { size: A4; margin: 14mm 16mm; }
  * { box-sizing: border-box; }
  body {
    font-family: "Times New Roman", serif;
    color: #000;
    margin: 0;
    line-height: 1.3;
    font-size: 12pt;
  }
  .report {
    width: 100%;
  }

  /* Header block */
  .top-box {
    border: 1px solid #000;
    padding: 6mm 6mm 5mm 6mm;
    margin-bottom: 6mm;
  }
  .header-grid {
    display: grid;
    grid-template-columns: 42% auto 42%;
    grid-row-gap: 2mm;
    align-items: end;
  }
  .kv {
    display: table;
    width: 100%;
    border-collapse: collapse;
  }
  .kv-row { display: table-row; }
  .kv-label, .kv-value {
    display: table-cell;
    padding: 0;
    vertical-align: bottom;
    white-space: nowrap;
  }
  .kv-label { padding-right: 2mm; }
  .title {
    text-align: center;
    font-size: 18pt;
    font-weight: 700;
  }
  .divider {
    margin-top: 4mm;
    border-top: 1px solid #000;
  }

  /* Table */
  table.grid {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
    font-size: 11pt;
  }
  table.grid th, table.grid td {
    border: 1px solid #000;
    padding: 3.5mm 2.5mm;
    vertical-align: top;
    word-wrap: break-word;
  }
  table.grid thead th {
    font-weight: 700;
    text-align: center;
  }
  .num {
    text-align: right;
    white-space: nowrap;
  }
  .center { text-align: center; }

  /* Column widths mirroring PDF */
  col.c-sl { width: 6%; }
  col.c-name { width: 50%; }
  col.c-set { width: 16%; }
  col.c-ach { width: 16%; }
  col.c-err { width: 6%; }
  col.c-errp { width: 6%; }

  /* Footer */
  .footer {
    position: fixed;
    bottom: 10mm;
    left: 16mm;
    right: 16mm;
    font-size: 10pt;
    display: flex;
    justify-content: space-between;
    color: #000;
  }

  /* Batch block utility (for multi-page repeats) */
  .batch-block { break-inside: avoid; page-break-inside: avoid; margin: 6mm 0; }
</style>
</head>
<body>
<div class="report">

  <div class="top-box">
    <div class="header-grid">
      <div>
        <div class="kv">
          <div class="kv-row">
            <div class="kv-label">Plant name</div><div class="kv-value">: {plant_name}</div>
          </div>
          <div class="kv-row">
            <div class="kv-label">Location</div><div class="kv-value">: {location}</div>
          </div>
        </div>
      </div>

      <div></div>

      <div>
        <div class="kv">
          <div class="kv-row">
            <div class="kv-label">From Date</div><div class="kv-value">: {date_from}</div>
          </div>
          <div class="kv-row">
            <div class="kv-label">To</div><div class="kv-value">: {date_to}</div>
          </div>
        </div>
      </div>

      <div>
        <div class="kv">
          <div class="kv-row">
            <div class="kv-label">Print Date</div><div class="kv-value">: {print_date}</div>
          </div>
        </div>
      </div>

      <div class="title">{title}</div>

      <div>
        <div class="kv" style="justify-self:end;">
          <div class="kv-row">
            <div class="kv-label">Recipe code</div><div class="kv-value">: {recipe_code}</div>
          </div>
        </div>
      </div>
    </div>
    <div class="divider"></div>
  </div>

  <table class="grid">
    <colgroup>
      <col class="c-sl">
      <col class="c-name">
      <col class="c-set">
      <col class="c-ach">
      <col class="c-err">
      <col class="c-errp">
    </colgroup>
    <thead>
      <tr>
        <th>Sl. No.</th>
        <th>Material name</th>
        <th>Set. wt({weight_unit})</th>
        <th>Ach. wt({weight_unit})</th>
        <th>Error({weight_unit})</th>
        <th>Error %</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="center">{rows.sl}</td>
        <td>{rows.name}</td>
        <td class="num">{rows.set}</td>
        <td class="num">{rows.ach}</td>
        <td class="num">{rows.err}</td>
        <td class="num">{rows.errp}</td>
      </tr>
    </tbody>
    <tfoot>
      <tr>
        <th colspan="2" style="text-align:left">Total</th>
        <th class="num">{total_set}</th>
        <th class="num">{total_ach}</th>
        <th class="num">{total_err}</th>
        <th class="num">{total_errp}</th>
      </tr>
    </tfoot>
  </table>
</div>

<div class="footer">
  <div>{company}</div>
  <div>Page {page_no} of {page_count}</div>
</div>
</body>
</html>