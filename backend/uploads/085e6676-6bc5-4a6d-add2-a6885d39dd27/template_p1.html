<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>{title}</title>
<style>
  @page { size: A4; margin: 14mm 16mm 18mm 16mm; }
  html, body { height: 100%; }
  body {
    font-family: "Times New Roman", serif;
    font-size: 12pt;
    color: #000;
    margin: 0;
  }
  .page {
    max-width: 185mm;
    margin: 0 auto;
  }

  /* Header info box */
  .info-box {
    border: 1px solid #000;
    padding: 6mm 8mm 5mm 8mm;
    line-height: 1.35;
    display: flex;
    justify-content: space-between;
    column-gap: 12mm;
  }
  .info-left .row { white-space: nowrap; }
  .label { display: inline-block; min-width: 30mm; }
  .info-right {
    text-align: right;
    white-space: nowrap;
  }

  /* Headline with centered title and right recipe code */
  .report-headline {
    margin-top: 4mm;
    padding-bottom: 2mm;
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    align-items: end;
    border-bottom: 1px solid #000;
  }
  .report-headline .title {
    grid-column: 2 / 3;
    font-size: 18pt;
    font-weight: 700;
    text-align: center;
  }
  .report-headline .rc {
    grid-column: 3 / 4;
    text-align: right;
    font-size: 12pt;
  }

  /* Table */
  table.grid {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
    margin-top: 3mm;
    font-size: 11pt;
  }
  table.grid th, table.grid td {
    border: 1px solid #000;
    padding: 3.5px 6px;
    vertical-align: top;
  }
  table.grid th {
    font-weight: 700;
    text-align: left;
  }
  table.grid th.num, table.grid td.num { text-align: right; }
  table.grid th.center, table.grid td.center { text-align: center; }
  table.grid td.wrap { word-break: break-word; }

  col.sl { width: 7%; }
  col.name { width: 47%; }
  col.set, col.ach, col.err, col.errp { width: 12%; }

  /* Total row */
  .total-row td {
    font-weight: 700;
  }
  .total-row td.label {
    text-align: left;
  }

  /* Footer */
  .footer {
    position: fixed;
    bottom: 10mm;
    left: 16mm;
    right: 16mm;
    font-size: 10pt;
    color: #000;
    display: flex;
    justify-content: space-between;
  }

  /* Repeatable batch blocks support (not used on this page, but style ready) */
  .batch-block { break-inside: avoid; page-break-inside: avoid; margin: 6mm 0; }
</style>
</head>
<body>
  <div class="page">
    <div class="info-box">
      <div class="info-left">
        <div class="row"><span class="label">Plant name</span>: {plant_name}</div>
        <div class="row"><span class="label">Location</span>: {location}</div>
        <div class="row"><span class="label">Print Date</span>: {print_date}</div>
      </div>
      <div class="info-right">
        <div class="row">From Date: {from_date} To {to_date}</div>
      </div>
    </div>

    <div class="report-headline">
      <div></div>
      <div class="title">{title}</div>
      <div class="rc">Recipe code : {recipe_code}</div>
    </div>

    <table class="grid">
      <colgroup>
        <col class="sl">
        <col class="name">
        <col class="set">
        <col class="ach">
        <col class="err">
        <col class="errp">
      </colgroup>
      <thead>
        <tr>
          <th class="center">Sl. No.</th>
          <th>Material name</th>
          <th class="num">Set. wt(Kg)</th>
          <th class="num">Ach. wt(Kg)</th>
          <th class="num">Error(Kg)</th>
          <th class="num">Error %</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="center">{rows.sl}</td>
          <td class="wrap">{rows.name}</td>
          <td class="num">{rows.set}</td>
          <td class="num">{rows.ach}</td>
          <td class="num">{rows.err}</td>
          <td class="num">{rows.errp}</td>
        </tr>
      </tbody>
      <tfoot>
        <tr class="total-row">
          <td colspan="2" class="label">Total</td>
          <td class="num">{total_set}</td>
          <td class="num">{total_ach}</td>
          <td class="num">{total_err}</td>
          <td class="num">{total_errp}</td>
        </tr>
      </tfoot>
    </table>
  </div>

  <div class="footer">
    <div>{company}</div>
    <div>Page {page_no} of {page_count}</div>
  </div>
</body>
</html>