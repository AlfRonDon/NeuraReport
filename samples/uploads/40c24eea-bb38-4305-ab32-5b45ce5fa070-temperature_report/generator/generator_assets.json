{
  "dialect": "sqlite",
  "entrypoints": {
    "header": "SELECT\n  CASE WHEN NULLIF(PARAM:from_date, '') IS NULL\n       THEN ''\n       ELSE strftime('%d-%m-%Y', datetime(PARAM:from_date, '+330 minutes'))\n  END AS report_from_date,\n  CASE WHEN NULLIF(PARAM:to_date, '') IS NULL\n       THEN ''\n       ELSE strftime('%d-%m-%Y', datetime(PARAM:to_date, '+330 minutes'))\n  END AS report_to_date,\n  strftime('%d-%m-%Y', 'now', 'localtime') AS print_date;",
    "rows": "WITH filtered AS (\n  SELECT\n    datetime(neuract__TEMPERATURES.timestamp_utc, '+330 minutes') AS reading_time,\n    date(datetime(neuract__TEMPERATURES.timestamp_utc, '+330 minutes')) AS reading_date,\n    neuract__TEMPERATURES.*\n  FROM neuract__TEMPERATURES\n  WHERE date(datetime(neuract__TEMPERATURES.timestamp_utc, '+330 minutes')) >= date(datetime(PARAM:from_date, '+330 minutes'))\n    AND date(datetime(neuract__TEMPERATURES.timestamp_utc, '+330 minutes')) <= date(datetime(PARAM:to_date, '+330 minutes'))\n)\nSELECT\n  reading_date AS row_date,\n  COALESCE((MAX(M1A_2_PT100_PV) - MIN(M1A_2_PT100_PV)), 0) AS row_m1a_2_pt100,\n  COALESCE((MAX(M1A_3_PT100_PV) - MIN(M1A_3_PT100_PV)), 0) AS row_m1a_3_pt100,\n  COALESCE((MAX(P3A_PT100_PV) - MIN(P3A_PT100_PV)), 0) AS row_p3a_pt100,\n  COALESCE((MAX(P4A_PT100_PV) - MIN(P4A_PT100_PV)), 0) AS row_p4a_pt100,\n  COALESCE((MAX(P5A_PT100_PV) - MIN(P5A_PT100_PV)), 0) AS row_p5a_pt100,\n  COALESCE((MAX(P6A_PT100_PV) - MIN(P6A_PT100_PV)), 0) AS row_p6a_pt100,\n  COALESCE((MAX(P8A_3_PT100_PV) - MIN(P8A_3_PT100_PV)), 0) AS row_p8a_3_pt100,\n  COALESCE((MAX(P8A_4_PT100_PV) - MIN(P8A_4_PT100_PV)), 0) AS row_p8a_4_pt100,\n  COALESCE((MAX(P8A_DRY_OUT_PT100_PV) - MIN(P8A_DRY_OUT_PT100_PV)), 0) AS row_p8a_dry_out_pt100,\n  COALESCE((MAX(P8A_PT100_PV) - MIN(P8A_PT100_PV)), 0) AS row_p8a_pt100,\n  COALESCE((MAX(P9A_DRY_OUT_PT100_PV) - MIN(P9A_DRY_OUT_PT100_PV)), 0) AS row_p9a_dry_out_pt100,\n  COALESCE((MAX(ROOM_PT100_PV) - MIN(ROOM_PT100_PV)), 0) AS row_room_pt100,\n  ROUND((\n    COALESCE((MAX(M1A_2_PT100_PV) - MIN(M1A_2_PT100_PV)), 0) +\n    COALESCE((MAX(M1A_3_PT100_PV) - MIN(M1A_3_PT100_PV)), 0) +\n    COALESCE((MAX(P3A_PT100_PV) - MIN(P3A_PT100_PV)), 0) +\n    COALESCE((MAX(P4A_PT100_PV) - MIN(P4A_PT100_PV)), 0) +\n    COALESCE((MAX(P5A_PT100_PV) - MIN(P5A_PT100_PV)), 0) +\n    COALESCE((MAX(P6A_PT100_PV) - MIN(P6A_PT100_PV)), 0) +\n    COALESCE((MAX(P8A_3_PT100_PV) - MIN(P8A_3_PT100_PV)), 0) +\n    COALESCE((MAX(P8A_4_PT100_PV) - MIN(P8A_4_PT100_PV)), 0) +\n    COALESCE((MAX(P8A_DRY_OUT_PT100_PV) - MIN(P8A_DRY_OUT_PT100_PV)), 0) +\n    COALESCE((MAX(P8A_PT100_PV) - MIN(P8A_PT100_PV)), 0) +\n    COALESCE((MAX(P9A_DRY_OUT_PT100_PV) - MIN(P9A_DRY_OUT_PT100_PV)), 0) +\n    COALESCE((MAX(ROOM_PT100_PV) - MIN(ROOM_PT100_PV)), 0)\n  ) / 12.0, 1) AS row_avg_temp\nFROM filtered\nGROUP BY reading_date\nHAVING (MAX(M1A_2_PT100_PV) - MIN(M1A_2_PT100_PV)) > 10\n    OR (MAX(P3A_PT100_PV) - MIN(P3A_PT100_PV)) > 10\n    OR (MAX(P8A_PT100_PV) - MIN(P8A_PT100_PV)) > 10\nORDER BY row_date ASC;",
    "totals": "WITH filtered AS (\n  SELECT\n    datetime(neuract__TEMPERATURES.timestamp_utc, '+330 minutes') AS reading_time,\n    date(datetime(neuract__TEMPERATURES.timestamp_utc, '+330 minutes')) AS reading_date,\n    neuract__TEMPERATURES.*\n  FROM neuract__TEMPERATURES\n  WHERE date(datetime(neuract__TEMPERATURES.timestamp_utc, '+330 minutes')) >= date(datetime(PARAM:from_date, '+330 minutes'))\n    AND date(datetime(neuract__TEMPERATURES.timestamp_utc, '+330 minutes')) <= date(datetime(PARAM:to_date, '+330 minutes'))\n),\ndaily_temps AS (\n  SELECT\n    reading_date,\n    (MAX(M1A_2_PT100_PV) - MIN(M1A_2_PT100_PV)) AS temp_m1a_2,\n    (MAX(M1A_3_PT100_PV) - MIN(M1A_3_PT100_PV)) AS temp_m1a_3,\n    (MAX(P3A_PT100_PV) - MIN(P3A_PT100_PV)) AS temp_p3a,\n    (MAX(P4A_PT100_PV) - MIN(P4A_PT100_PV)) AS temp_p4a,\n    (MAX(P5A_PT100_PV) - MIN(P5A_PT100_PV)) AS temp_p5a,\n    (MAX(P6A_PT100_PV) - MIN(P6A_PT100_PV)) AS temp_p6a,\n    (MAX(P8A_3_PT100_PV) - MIN(P8A_3_PT100_PV)) AS temp_p8a_3,\n    (MAX(P8A_4_PT100_PV) - MIN(P8A_4_PT100_PV)) AS temp_p8a_4,\n    (MAX(P8A_DRY_OUT_PT100_PV) - MIN(P8A_DRY_OUT_PT100_PV)) AS temp_p8a_dry,\n    (MAX(P8A_PT100_PV) - MIN(P8A_PT100_PV)) AS temp_p8a,\n    (MAX(P9A_DRY_OUT_PT100_PV) - MIN(P9A_DRY_OUT_PT100_PV)) AS temp_p9a_dry,\n    (MAX(ROOM_PT100_PV) - MIN(ROOM_PT100_PV)) AS temp_room\n  FROM filtered\n  GROUP BY reading_date\n  HAVING temp_m1a_2 > 10 OR temp_p3a > 10 OR temp_p8a > 10\n)\nSELECT\n  COALESCE(MAX(temp_m1a_2), 0) AS total_max_m1a_2_pt100,\n  COALESCE(MAX(temp_m1a_3), 0) AS total_max_m1a_3_pt100,\n  COALESCE(MAX(temp_p3a), 0) AS total_max_p3a_pt100,\n  COALESCE(MAX(temp_p4a), 0) AS total_max_p4a_pt100,\n  COALESCE(MAX(temp_p5a), 0) AS total_max_p5a_pt100,\n  COALESCE(MAX(temp_p6a), 0) AS total_max_p6a_pt100,\n  COALESCE(MAX(temp_p8a_3), 0) AS total_max_p8a_3_pt100,\n  COALESCE(MAX(temp_p8a_4), 0) AS total_max_p8a_4_pt100,\n  COALESCE(MAX(temp_p8a_dry), 0) AS total_max_p8a_dry_out_pt100,\n  COALESCE(MAX(temp_p8a), 0) AS total_max_p8a_pt100,\n  COALESCE(MAX(temp_p9a_dry), 0) AS total_max_p9a_dry_out_pt100,\n  COALESCE(MAX(temp_room), 0) AS total_max_room_pt100,\n  ROUND(AVG((\n    COALESCE(temp_m1a_2, 0) + COALESCE(temp_m1a_3, 0) + COALESCE(temp_p3a, 0) +\n    COALESCE(temp_p4a, 0) + COALESCE(temp_p5a, 0) + COALESCE(temp_p6a, 0) +\n    COALESCE(temp_p8a_3, 0) + COALESCE(temp_p8a_4, 0) + COALESCE(temp_p8a_dry, 0) +\n    COALESCE(temp_p8a, 0) + COALESCE(temp_p9a_dry, 0) + COALESCE(temp_room, 0)\n  ) / 12.0), 1) AS total_overall_avg\nFROM daily_temps;"
  },
  "params": {
    "required": [
      "from_date",
      "to_date"
    ],
    "optional": []
  },
  "needs_user_fix": [],
  "invalid": false,
  "summary": {
    "method": "state_based_delta",
    "description": "Calculates temperature using end_value - start_value logic. For each day: temperature = MAX(reading) - MIN(reading), where MIN represents the stable baseline and MAX represents the peak after heating cycle."
  },
  "cached": false,
  "key_tokens": []
}
