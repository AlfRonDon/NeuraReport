{
  "entrypoints": {
    "header": "WITH bounds AS (\n  SELECT\n    COALESCE(NULLIF(:from_date, ''), MIN(timestamp_utc)) AS range_start,\n    COALESCE(NULLIF(:to_date, ''), MAX(timestamp_utc)) AS range_end\n  FROM \"neuract__RUNHOURS\"\n)\nSELECT\n  COALESCE(NULLIF(:company_title, ''), 'NeuraReport Machine Runtime') AS company_title,\n  strftime('%Y-%m-%d %H:%M:%S', 'now', 'localtime') AS print_date,\n  range_start,\n  range_end\nFROM bounds;",
    "rows": "WITH\n  params AS (\n    SELECT\n      datetime(NULLIF(:from_date, '')) AS from_ts,\n      datetime(NULLIF(:to_date, '')) AS to_ts\n  ),\n  filtered AS MATERIALIZED (\n    SELECT f.*\n    FROM \"neuract__RUNHOURS\" f, params p\n    WHERE (p.from_ts IS NULL OR f.timestamp_utc >= p.from_ts)\n      AND (p.to_ts IS NULL OR f.timestamp_utc <= p.to_ts)\n  ),\n  selected_keys AS MATERIALIZED (\n    SELECT k.machine_name\n    FROM runtime_machine_keys k\n    WHERE k.machine_name IS NOT NULL\n      AND TRIM(CAST(k.machine_name AS TEXT)) <> ''\n  ),\n  machine_raw AS (\n    SELECT\n      f.timestamp_utc AS timestamp_utc,\n      sk.machine_name AS machine_name,\n      CASE sk.machine_name\n      WHEN 'C1A_1_MC' THEN f.\"C1A_1_MC_HRS\"\n      WHEN 'C1A_MC' THEN f.\"C1A_MC_HRS\"\n      WHEN 'C2A_MC' THEN f.\"C2A_MC_HRS\"\n      WHEN 'C3A_MC' THEN f.\"C3A_MC_HRS\"\n      WHEN 'C4A_MC' THEN f.\"C4A_MC_HRS\"\n      WHEN 'C5A_MC' THEN f.\"C5A_MC_HRS\"\n      WHEN 'C6A_MC' THEN f.\"C6A_MC_HRS\"\n      WHEN 'C7A_MC' THEN f.\"C7A_MC_HRS\"\n      WHEN 'C8A_MC' THEN f.\"C8A_MC_HRS\"\n      WHEN 'F1A_MC' THEN f.\"F1A_MC_HRS\"\n      WHEN 'G10A_MC' THEN f.\"G10A_MC_HRS\"\n      WHEN 'G11A_MC' THEN f.\"G11A_MC_HRS\"\n      WHEN 'G13A_MC' THEN f.\"G13A_MC_HRS\"\n      WHEN 'G1A_1_MC' THEN f.\"G1A_1_MC_HRS\"\n      WHEN 'G1A_MC' THEN f.\"G1A_MC_HRS\"\n      WHEN 'G3A_MC' THEN f.\"G3A_MC_HRS\"\n      WHEN 'G4A_MC' THEN f.\"G4A_MC_HRS\"\n      WHEN 'G5A_1_MC' THEN f.\"G5A_1_MC_HRS\"\n      WHEN 'G5A_2_MC' THEN f.\"G5A_2_MC_HRS\"\n      WHEN 'G5A_MC' THEN f.\"G5A_MC_HRS\"\n      WHEN 'G7A_MC' THEN f.\"G7A_MC_HRS\"\n      WHEN 'G9A_MC' THEN f.\"G9A_MC_HRS\"\n      WHEN 'I10A_MC' THEN f.\"I10A_MC_HRS\"\n      WHEN 'I1A_MC' THEN f.\"I1A_MC_HRS\"\n      WHEN 'I2A_MC' THEN f.\"I2A_MC_HRS\"\n      WHEN 'I3A_MC' THEN f.\"I3A_MC_HRS\"\n      WHEN 'I4A_1_MC' THEN f.\"I4A_1_MC_HRS\"\n      WHEN 'I4A_2_MC' THEN f.\"I4A_2_MC_HRS\"\n      WHEN 'I5A_MC' THEN f.\"I5A_MC_HRS\"\n      WHEN 'I6A_A_MC' THEN f.\"I6A_A_MC_HRS\"\n      WHEN 'I6A_B_MC' THEN f.\"I6A_B_MC_HRS\"\n      WHEN 'I6A_C_MC' THEN f.\"I6A_C_MC_HRS\"\n      WHEN 'I6A_D_MC' THEN f.\"I6A_D_MC_HRS\"\n      WHEN 'I6A_E_MC' THEN f.\"I6A_E_MC_HRS\"\n      WHEN 'I6A_F_MC' THEN f.\"I6A_F_MC_HRS\"\n      WHEN 'I6A_G_MC' THEN f.\"I6A_G_MC_HRS\"\n      WHEN 'I6A_H_MC' THEN f.\"I6A_H_MC_HRS\"\n      WHEN 'I6A_I_MC' THEN f.\"I6A_I_MC_HRS\"\n      WHEN 'I6A_J_MC' THEN f.\"I6A_J_MC_HRS\"\n      WHEN 'I6A_K_MC' THEN f.\"I6A_K_MC_HRS\"\n      WHEN 'I6A_L_MC' THEN f.\"I6A_L_MC_HRS\"\n      WHEN 'I8A_1_MC' THEN f.\"I8A_1_MC_HRS\"\n      WHEN 'I8A_MC' THEN f.\"I8A_MC_HRS\"\n      WHEN 'I9A_MC' THEN f.\"I9A_MC_HRS\"\n      WHEN 'M1A_11_MC' THEN f.\"M1A_11_MC_HRS\"\n      WHEN 'M1A_18_MC' THEN f.\"M1A_18_MC_HRS\"\n      WHEN 'M1A_1_MC' THEN f.\"M1A_1_MC_HRS\"\n      WHEN 'M1A_2_MC' THEN f.\"M1A_2_MC_HRS\"\n      WHEN 'M1A_3_MC' THEN f.\"M1A_3_MC_HRS\"\n      WHEN 'M1A_9_MC' THEN f.\"M1A_9_MC_HRS\"\n      WHEN 'M1A_MC' THEN f.\"M1A_MC_HRS\"\n      WHEN 'M2A_MC' THEN f.\"M2A_MC_HRS\"\n      WHEN 'M3A_MC' THEN f.\"M3A_MC_HRS\"\n      WHEN 'M4A_MC' THEN f.\"M4A_MC_HRS\"\n      WHEN 'M5A_MC' THEN f.\"M5A_MC_HRS\"\n      WHEN 'P11A_MC' THEN f.\"P11A_MC_HRS\"\n      WHEN 'P12A_MC' THEN f.\"P12A_MC_HRS\"\n      WHEN 'P13A_MC' THEN f.\"P13A_MC_HRS\"\n      WHEN 'P14A_MC' THEN f.\"P14A_MC_HRS\"\n      WHEN 'P15A_MC' THEN f.\"P15A_MC_HRS\"\n      WHEN 'P16A_MC' THEN f.\"P16A_MC_HRS\"\n      WHEN 'P1A_MC' THEN f.\"P1A_MC_HRS\"\n      WHEN 'P2A_MC' THEN f.\"P2A_MC_HRS\"\n      WHEN 'P3A_MC' THEN f.\"P3A_MC_HRS\"\n      WHEN 'P4A_MC' THEN f.\"P4A_MC_HRS\"\n      WHEN 'P5A_MC' THEN f.\"P5A_MC_HRS\"\n      WHEN 'P6A_MC' THEN f.\"P6A_MC_HRS\"\n      WHEN 'P7A_1_MC' THEN f.\"P7A_1_MC_HRS\"\n      WHEN 'P7A_2_MC' THEN f.\"P7A_2_MC_HRS\"\n      WHEN 'P7A_MC' THEN f.\"P7A_MC_HRS\"\n      WHEN 'P8A_1_MC' THEN f.\"P8A_1_MC_HRS\"\n      WHEN 'P8A_2_MC' THEN f.\"P8A_2_MC_HRS\"\n      WHEN 'P8A_3_MC' THEN f.\"P8A_3_MC_HRS\"\n      WHEN 'P8A_4_MC' THEN f.\"P8A_4_MC_HRS\"\n      WHEN 'P8A_5_MC' THEN f.\"P8A_5_MC_HRS\"\n      WHEN 'P8A_MC' THEN f.\"P8A_MC_HRS\"\n      WHEN 'P9A_MC' THEN f.\"P9A_MC_HRS\"\n        ELSE NULL\n      END AS hrs_val,\n      CASE sk.machine_name\n      WHEN 'C1A_1_MC' THEN f.\"C1A_1_MC_MIN\"\n      WHEN 'C1A_MC' THEN f.\"C1A_MC_MIN\"\n      WHEN 'C2A_MC' THEN f.\"C2A_MC_MIN\"\n      WHEN 'C3A_MC' THEN f.\"C3A_MC_MIN\"\n      WHEN 'C4A_MC' THEN f.\"C4A_MC_MIN\"\n      WHEN 'C5A_MC' THEN f.\"C5A_MC_MIN\"\n      WHEN 'C6A_MC' THEN f.\"C6A_MC_MIN\"\n      WHEN 'C7A_MC' THEN f.\"C7A_MC_MIN\"\n      WHEN 'C8A_MC' THEN f.\"C8A_MC_MIN\"\n      WHEN 'F1A_MC' THEN f.\"F1A_MC_MIN\"\n      WHEN 'G10A_MC' THEN f.\"G10A_MC_MIN\"\n      WHEN 'G11A_MC' THEN f.\"G11A_MC_MIN\"\n      WHEN 'G13A_MC' THEN f.\"G13A_MC_MIN\"\n      WHEN 'G1A_1_MC' THEN f.\"G1A_1_MC_MIN\"\n      WHEN 'G1A_MC' THEN f.\"G1A_MC_MIN\"\n      WHEN 'G3A_MC' THEN f.\"G3A_MC_MIN\"\n      WHEN 'G4A_MC' THEN f.\"G4A_MC_MIN\"\n      WHEN 'G5A_1_MC' THEN f.\"G5A_1_MC_MIN\"\n      WHEN 'G5A_2_MC' THEN f.\"G5A_2_MC_MIN\"\n      WHEN 'G5A_MC' THEN f.\"G5A_MC_MIN\"\n      WHEN 'G7A_MC' THEN f.\"G7A_MC_MIN\"\n      WHEN 'G9A_MC' THEN f.\"G9A_MC_MIN\"\n      WHEN 'I10A_MC' THEN f.\"I10A_MC_MIN\"\n      WHEN 'I1A_MC' THEN f.\"I1A_MC_MIN\"\n      WHEN 'I2A_MC' THEN f.\"I2A_MC_MIN\"\n      WHEN 'I3A_MC' THEN f.\"I3A_MC_MIN\"\n      WHEN 'I4A_1_MC' THEN f.\"I4A_1_MC_MIN\"\n      WHEN 'I4A_2_MC' THEN f.\"I4A_2_MC_MIN\"\n      WHEN 'I5A_MC' THEN f.\"I5A_MC_MIN\"\n      WHEN 'I6A_A_MC' THEN f.\"I6A_A_MC_MIN\"\n      WHEN 'I6A_B_MC' THEN f.\"I6A_B_MC_MIN\"\n      WHEN 'I6A_C_MC' THEN f.\"I6A_C_MC_MIN\"\n      WHEN 'I6A_D_MC' THEN f.\"I6A_D_MC_MIN\"\n      WHEN 'I6A_E_MC' THEN f.\"I6A_E_MC_MIN\"\n      WHEN 'I6A_F_MC' THEN f.\"I6A_F_MC_MIN\"\n      WHEN 'I6A_G_MC' THEN f.\"I6A_G_MC_MIN\"\n      WHEN 'I6A_H_MC' THEN f.\"I6A_H_MC_MIN\"\n      WHEN 'I6A_I_MC' THEN f.\"I6A_I_MC_MIN\"\n      WHEN 'I6A_J_MC' THEN f.\"I6A_J_MC_MIN\"\n      WHEN 'I6A_K_MC' THEN f.\"I6A_K_MC_MIN\"\n      WHEN 'I6A_L_MC' THEN f.\"I6A_L_MC_MIN\"\n      WHEN 'I8A_1_MC' THEN f.\"I8A_1_MC_MIN\"\n      WHEN 'I8A_MC' THEN f.\"I8A_MC_MIN\"\n      WHEN 'I9A_MC' THEN f.\"I9A_MC_MIN\"\n      WHEN 'M1A_11_MC' THEN f.\"M1A_11_MC_MIN\"\n      WHEN 'M1A_18_MC' THEN f.\"M1A_18_MC_MIN\"\n      WHEN 'M1A_1_MC' THEN f.\"M1A_1_MC_MIN\"\n      WHEN 'M1A_2_MC' THEN f.\"M1A_2_MC_MIN\"\n      WHEN 'M1A_3_MC' THEN f.\"M1A_3_MC_MIN\"\n      WHEN 'M1A_9_MC' THEN f.\"M1A_9_MC_MIN\"\n      WHEN 'M1A_MC' THEN f.\"M1A_MC_MIN\"\n      WHEN 'M2A_MC' THEN f.\"M2A_MC_MIN\"\n      WHEN 'M3A_MC' THEN f.\"M3A_MC_MIN\"\n      WHEN 'M4A_MC' THEN f.\"M4A_MC_MIN\"\n      WHEN 'M5A_MC' THEN f.\"M5A_MC_MIN\"\n      WHEN 'P11A_MC' THEN f.\"P11A_MC_MIN\"\n      WHEN 'P12A_MC' THEN f.\"P12A_MC_MIN\"\n      WHEN 'P13A_MC' THEN f.\"P13A_MC_MIN\"\n      WHEN 'P14A_MC' THEN f.\"P14A_MC_MIN\"\n      WHEN 'P15A_MC' THEN f.\"P15A_MC_MIN\"\n      WHEN 'P16A_MC' THEN f.\"P16A_MC_MIN\"\n      WHEN 'P1A_MC' THEN f.\"P1A_MC_MIN\"\n      WHEN 'P2A_MC' THEN f.\"P2A_MC_MIN\"\n      WHEN 'P3A_MC' THEN f.\"P3A_MC_MIN\"\n      WHEN 'P4A_MC' THEN f.\"P4A_MC_MIN\"\n      WHEN 'P5A_MC' THEN f.\"P5A_MC_MIN\"\n      WHEN 'P6A_MC' THEN f.\"P6A_MC_MIN\"\n      WHEN 'P7A_1_MC' THEN f.\"P7A_1_MC_MIN\"\n      WHEN 'P7A_2_MC' THEN f.\"P7A_2_MC_MIN\"\n      WHEN 'P7A_MC' THEN f.\"P7A_MC_MIN\"\n      WHEN 'P8A_1_MC' THEN f.\"P8A_1_MC_MIN\"\n      WHEN 'P8A_2_MC' THEN f.\"P8A_2_MC_MIN\"\n      WHEN 'P8A_3_MC' THEN f.\"P8A_3_MC_MIN\"\n      WHEN 'P8A_4_MC' THEN f.\"P8A_4_MC_MIN\"\n      WHEN 'P8A_5_MC' THEN f.\"P8A_5_MC_MIN\"\n      WHEN 'P8A_MC' THEN f.\"P8A_MC_MIN\"\n      WHEN 'P9A_MC' THEN f.\"P9A_MC_MIN\"\n        ELSE NULL\n      END AS min_val,\n      CASE sk.machine_name\n      WHEN 'G10A_MC' THEN f.\"G10A_MC_SEC\"\n      WHEN 'G11A_MC' THEN f.\"G11A_MC_SEC\"\n      WHEN 'G13A_MC' THEN f.\"G13A_MC_SEC\"\n      WHEN 'G1A_1_MC' THEN f.\"G1A_1_MC_SEC\"\n      WHEN 'G1A_MC' THEN f.\"G1A_MC_SEC\"\n      WHEN 'G3A_MC' THEN f.\"G3A_MC_SEC\"\n      WHEN 'G4A_MC' THEN f.\"G4A_MC_SEC\"\n      WHEN 'G5A_1_MC' THEN f.\"G5A_1_MC_SEC\"\n      WHEN 'G5A_2_MC' THEN f.\"G5A_2_MC_SEC\"\n      WHEN 'G5A_MC' THEN f.\"G5A_MC_SEC\"\n      WHEN 'G7A_MC' THEN f.\"G7A_MC_SEC\"\n      WHEN 'G9A_MC' THEN f.\"G9A_MC_SEC\"\n      WHEN 'I10A_MC' THEN f.\"I10A_MC_SEC\"\n      WHEN 'I1A_MC' THEN f.\"I1A_MC_SEC\"\n      WHEN 'I2A_MC' THEN f.\"I2A_MC_SEC\"\n      WHEN 'I3A_MC' THEN f.\"I3A_MC_SEC\"\n      WHEN 'I4A_1_MC' THEN f.\"I4A_1_MC_SEC\"\n      WHEN 'I4A_2_MC' THEN f.\"I4A_2_MC_SEC\"\n      WHEN 'I5A_MC' THEN f.\"I5A_MC_SEC\"\n      WHEN 'I6A_A_MC' THEN f.\"I6A_A_MC_SEC\"\n      WHEN 'I6A_B_MC' THEN f.\"I6A_B_MC_SEC\"\n      WHEN 'I6A_C_MC' THEN f.\"I6A_C_MC_SEC\"\n      WHEN 'I6A_D_MC' THEN f.\"I6A_D_MC_SEC\"\n      WHEN 'I6A_E_MC' THEN f.\"I6A_E_MC_SEC\"\n      WHEN 'I6A_F_MC' THEN f.\"I6A_F_MC_SEC\"\n      WHEN 'I6A_G_MC' THEN f.\"I6A_G_MC_SEC\"\n      WHEN 'I6A_H_MC' THEN f.\"I6A_H_MC_SEC\"\n      WHEN 'I6A_I_MC' THEN f.\"I6A_I_MC_SEC\"\n      WHEN 'I6A_J_MC' THEN f.\"I6A_J_MC_SEC\"\n      WHEN 'I6A_K_MC' THEN f.\"I6A_K_MC_SEC\"\n      WHEN 'I6A_L_MC' THEN f.\"I6A_L_MC_SEC\"\n      WHEN 'I8A_1_MC' THEN f.\"I8A_1_MC_SEC\"\n      WHEN 'I8A_MC' THEN f.\"I8A_MC_SEC\"\n      WHEN 'I9A_MC' THEN f.\"I9A_MC_SEC\"\n      WHEN 'M1A_11_MC' THEN f.\"M1A_11_MC_SEC\"\n      WHEN 'M1A_18_MC' THEN f.\"M1A_18_MC_SEC\"\n      WHEN 'M1A_1_MC' THEN f.\"M1A_1_MC_SEC\"\n      WHEN 'M1A_2_MC' THEN f.\"M1A_2_MC_SEC\"\n      WHEN 'M1A_3_MC' THEN f.\"M1A_3_MC_SEC\"\n      WHEN 'M1A_9_MC' THEN f.\"M1A_9_MC_SEC\"\n      WHEN 'M1A_MC' THEN f.\"M1A_MC_SEC\"\n      WHEN 'M2A_MC' THEN f.\"M2A_MC_SEC\"\n      WHEN 'M3A_MC' THEN f.\"M3A_MC_SEC\"\n      WHEN 'M4A_MC' THEN f.\"M4A_MC_SEC\"\n      WHEN 'M5A_MC' THEN f.\"M5A_MC_SEC\"\n      WHEN 'P11A_MC' THEN f.\"P11A_MC_SEC\"\n      WHEN 'P12A_MC' THEN f.\"P12A_MC_SEC\"\n      WHEN 'P13A_MC' THEN f.\"P13A_MC_SEC\"\n      WHEN 'P14A_MC' THEN f.\"P14A_MC_SEC\"\n      WHEN 'P15A_MC' THEN f.\"P15A_MC_SEC\"\n      WHEN 'P16A_MC' THEN f.\"P16A_MC_SEC\"\n      WHEN 'P1A_MC' THEN f.\"P1A_MC_SEC\"\n      WHEN 'P2A_MC' THEN f.\"P2A_MC_SEC\"\n      WHEN 'P3A_MC' THEN f.\"P3A_MC_SEC\"\n      WHEN 'P4A_MC' THEN f.\"P4A_MC_SEC\"\n      WHEN 'P5A_MC' THEN f.\"P5A_MC_SEC\"\n      WHEN 'P6A_MC' THEN f.\"P6A_MC_SEC\"\n      WHEN 'P7A_1_MC' THEN f.\"P7A_1_MC_SEC\"\n      WHEN 'P7A_2_MC' THEN f.\"P7A_2_MC_SEC\"\n      WHEN 'P7A_MC' THEN f.\"P7A_MC_SEC\"\n      WHEN 'P8A_1_MC' THEN f.\"P8A_1_MC_SEC\"\n      WHEN 'P8A_2_MC' THEN f.\"P8A_2_MC_SEC\"\n      WHEN 'P8A_3_MC' THEN f.\"P8A_3_MC_SEC\"\n      WHEN 'P8A_4_MC' THEN f.\"P8A_4_MC_SEC\"\n      WHEN 'P8A_5_MC' THEN f.\"P8A_5_MC_SEC\"\n      WHEN 'P8A_MC' THEN f.\"P8A_MC_SEC\"\n      WHEN 'P9A_MC' THEN f.\"P9A_MC_SEC\"\n        ELSE NULL\n      END AS sec_val\n    FROM filtered f\n    CROSS JOIN selected_keys sk\n  ),\n  machine_values AS (\n    SELECT\n      timestamp_utc,\n      machine_name,\n      CASE\n        WHEN hrs_val IS NULL AND min_val IS NULL AND sec_val IS NULL THEN NULL\n        ELSE COALESCE(hrs_val, 0) * 3600 + COALESCE(min_val, 0) * 60 + COALESCE(sec_val, 0)\n      END AS total_seconds\n    FROM machine_raw\n  ),\n  ordered AS (\n    SELECT\n      machine_name,\n      timestamp_utc,\n      total_seconds,\n      LEAD(timestamp_utc) OVER (PARTITION BY machine_name ORDER BY timestamp_utc) AS next_ts,\n      LEAD(total_seconds) OVER (PARTITION BY machine_name ORDER BY timestamp_utc) AS next_value\n    FROM machine_values\n    WHERE total_seconds IS NOT NULL\n  ),\n  running AS (\n    SELECT\n      machine_name,\n      timestamp_utc AS current_ts,\n      next_ts,\n      total_seconds,\n      next_value,\n      CASE\n        WHEN next_ts IS NULL THEN 0\n        WHEN next_value IS NULL THEN 0\n        WHEN total_seconds = next_value THEN 0\n        ELSE 1\n      END AS is_running\n    FROM ordered\n  ),\n  start_marked AS (\n    SELECT\n      *,\n      CASE\n        WHEN is_running = 1\n         AND COALESCE(LAG(is_running) OVER (PARTITION BY machine_name ORDER BY current_ts), 0) = 0\n        THEN 1 ELSE 0\n      END AS start_flag\n    FROM running\n  ),\n  run_groups AS (\n    SELECT\n      *,\n      SUM(start_flag) OVER (\n        PARTITION BY machine_name\n        ORDER BY current_ts\n        ROWS UNBOUNDED PRECEDING\n      ) AS run_group\n    FROM start_marked\n    WHERE is_running = 1\n  ),\n  final AS (\n    SELECT\n      machine_name,\n      MIN(current_ts) AS start_ts,\n      MAX(next_ts) AS end_ts,\n      CAST(ROUND((julianday(MAX(next_ts)) - julianday(MIN(current_ts))) * 86400.0) AS INTEGER) AS duration_sec\n    FROM run_groups\n    GROUP BY machine_name, run_group\n    HAVING start_ts IS NOT NULL AND end_ts IS NOT NULL\n  )\nSELECT\n  final.machine_name AS machine_name,\n  substr(start_ts, 1, 10) AS run_date,\n  substr(start_ts, 12, 8) AS start_time,\n  substr(end_ts, 12, 8) AS end_time,\n  duration_sec,\n  CASE\n    WHEN CAST(substr(start_ts, 12, 2) AS INTEGER) BETWEEN 6 AND 13 THEN '1'\n    WHEN CAST(substr(start_ts, 12, 2) AS INTEGER) BETWEEN 14 AND 21 THEN '2'\n    ELSE '3'\n  END AS shift_no,\n  printf('%02d:%02d:%02d', duration_sec / 3600, (duration_sec / 60) % 60, duration_sec % 60) AS total_time\nFROM final\nWHERE duration_sec > 0\nORDER BY final.machine_name, start_ts;\n",
    "totals": "WITH\n  params AS (\n    SELECT\n      datetime(NULLIF(:from_date, '')) AS from_ts,\n      datetime(NULLIF(:to_date, '')) AS to_ts\n  ),\n  filtered AS MATERIALIZED (\n    SELECT f.*\n    FROM \"neuract__RUNHOURS\" f, params p\n    WHERE (p.from_ts IS NULL OR f.timestamp_utc >= p.from_ts)\n      AND (p.to_ts IS NULL OR f.timestamp_utc <= p.to_ts)\n  ),\n  selected_keys AS MATERIALIZED (\n    SELECT k.machine_name\n    FROM runtime_machine_keys k\n    WHERE k.machine_name IS NOT NULL\n      AND TRIM(CAST(k.machine_name AS TEXT)) <> ''\n  ),\n  machine_raw AS (\n    SELECT\n      f.timestamp_utc AS timestamp_utc,\n      sk.machine_name AS machine_name,\n      CASE sk.machine_name\n      WHEN 'C1A_1_MC' THEN f.\"C1A_1_MC_HRS\"\n      WHEN 'C1A_MC' THEN f.\"C1A_MC_HRS\"\n      WHEN 'C2A_MC' THEN f.\"C2A_MC_HRS\"\n      WHEN 'C3A_MC' THEN f.\"C3A_MC_HRS\"\n      WHEN 'C4A_MC' THEN f.\"C4A_MC_HRS\"\n      WHEN 'C5A_MC' THEN f.\"C5A_MC_HRS\"\n      WHEN 'C6A_MC' THEN f.\"C6A_MC_HRS\"\n      WHEN 'C7A_MC' THEN f.\"C7A_MC_HRS\"\n      WHEN 'C8A_MC' THEN f.\"C8A_MC_HRS\"\n      WHEN 'F1A_MC' THEN f.\"F1A_MC_HRS\"\n      WHEN 'G10A_MC' THEN f.\"G10A_MC_HRS\"\n      WHEN 'G11A_MC' THEN f.\"G11A_MC_HRS\"\n      WHEN 'G13A_MC' THEN f.\"G13A_MC_HRS\"\n      WHEN 'G1A_1_MC' THEN f.\"G1A_1_MC_HRS\"\n      WHEN 'G1A_MC' THEN f.\"G1A_MC_HRS\"\n      WHEN 'G3A_MC' THEN f.\"G3A_MC_HRS\"\n      WHEN 'G4A_MC' THEN f.\"G4A_MC_HRS\"\n      WHEN 'G5A_1_MC' THEN f.\"G5A_1_MC_HRS\"\n      WHEN 'G5A_2_MC' THEN f.\"G5A_2_MC_HRS\"\n      WHEN 'G5A_MC' THEN f.\"G5A_MC_HRS\"\n      WHEN 'G7A_MC' THEN f.\"G7A_MC_HRS\"\n      WHEN 'G9A_MC' THEN f.\"G9A_MC_HRS\"\n      WHEN 'I10A_MC' THEN f.\"I10A_MC_HRS\"\n      WHEN 'I1A_MC' THEN f.\"I1A_MC_HRS\"\n      WHEN 'I2A_MC' THEN f.\"I2A_MC_HRS\"\n      WHEN 'I3A_MC' THEN f.\"I3A_MC_HRS\"\n      WHEN 'I4A_1_MC' THEN f.\"I4A_1_MC_HRS\"\n      WHEN 'I4A_2_MC' THEN f.\"I4A_2_MC_HRS\"\n      WHEN 'I5A_MC' THEN f.\"I5A_MC_HRS\"\n      WHEN 'I6A_A_MC' THEN f.\"I6A_A_MC_HRS\"\n      WHEN 'I6A_B_MC' THEN f.\"I6A_B_MC_HRS\"\n      WHEN 'I6A_C_MC' THEN f.\"I6A_C_MC_HRS\"\n      WHEN 'I6A_D_MC' THEN f.\"I6A_D_MC_HRS\"\n      WHEN 'I6A_E_MC' THEN f.\"I6A_E_MC_HRS\"\n      WHEN 'I6A_F_MC' THEN f.\"I6A_F_MC_HRS\"\n      WHEN 'I6A_G_MC' THEN f.\"I6A_G_MC_HRS\"\n      WHEN 'I6A_H_MC' THEN f.\"I6A_H_MC_HRS\"\n      WHEN 'I6A_I_MC' THEN f.\"I6A_I_MC_HRS\"\n      WHEN 'I6A_J_MC' THEN f.\"I6A_J_MC_HRS\"\n      WHEN 'I6A_K_MC' THEN f.\"I6A_K_MC_HRS\"\n      WHEN 'I6A_L_MC' THEN f.\"I6A_L_MC_HRS\"\n      WHEN 'I8A_1_MC' THEN f.\"I8A_1_MC_HRS\"\n      WHEN 'I8A_MC' THEN f.\"I8A_MC_HRS\"\n      WHEN 'I9A_MC' THEN f.\"I9A_MC_HRS\"\n      WHEN 'M1A_11_MC' THEN f.\"M1A_11_MC_HRS\"\n      WHEN 'M1A_18_MC' THEN f.\"M1A_18_MC_HRS\"\n      WHEN 'M1A_1_MC' THEN f.\"M1A_1_MC_HRS\"\n      WHEN 'M1A_2_MC' THEN f.\"M1A_2_MC_HRS\"\n      WHEN 'M1A_3_MC' THEN f.\"M1A_3_MC_HRS\"\n      WHEN 'M1A_9_MC' THEN f.\"M1A_9_MC_HRS\"\n      WHEN 'M1A_MC' THEN f.\"M1A_MC_HRS\"\n      WHEN 'M2A_MC' THEN f.\"M2A_MC_HRS\"\n      WHEN 'M3A_MC' THEN f.\"M3A_MC_HRS\"\n      WHEN 'M4A_MC' THEN f.\"M4A_MC_HRS\"\n      WHEN 'M5A_MC' THEN f.\"M5A_MC_HRS\"\n      WHEN 'P11A_MC' THEN f.\"P11A_MC_HRS\"\n      WHEN 'P12A_MC' THEN f.\"P12A_MC_HRS\"\n      WHEN 'P13A_MC' THEN f.\"P13A_MC_HRS\"\n      WHEN 'P14A_MC' THEN f.\"P14A_MC_HRS\"\n      WHEN 'P15A_MC' THEN f.\"P15A_MC_HRS\"\n      WHEN 'P16A_MC' THEN f.\"P16A_MC_HRS\"\n      WHEN 'P1A_MC' THEN f.\"P1A_MC_HRS\"\n      WHEN 'P2A_MC' THEN f.\"P2A_MC_HRS\"\n      WHEN 'P3A_MC' THEN f.\"P3A_MC_HRS\"\n      WHEN 'P4A_MC' THEN f.\"P4A_MC_HRS\"\n      WHEN 'P5A_MC' THEN f.\"P5A_MC_HRS\"\n      WHEN 'P6A_MC' THEN f.\"P6A_MC_HRS\"\n      WHEN 'P7A_1_MC' THEN f.\"P7A_1_MC_HRS\"\n      WHEN 'P7A_2_MC' THEN f.\"P7A_2_MC_HRS\"\n      WHEN 'P7A_MC' THEN f.\"P7A_MC_HRS\"\n      WHEN 'P8A_1_MC' THEN f.\"P8A_1_MC_HRS\"\n      WHEN 'P8A_2_MC' THEN f.\"P8A_2_MC_HRS\"\n      WHEN 'P8A_3_MC' THEN f.\"P8A_3_MC_HRS\"\n      WHEN 'P8A_4_MC' THEN f.\"P8A_4_MC_HRS\"\n      WHEN 'P8A_5_MC' THEN f.\"P8A_5_MC_HRS\"\n      WHEN 'P8A_MC' THEN f.\"P8A_MC_HRS\"\n      WHEN 'P9A_MC' THEN f.\"P9A_MC_HRS\"\n        ELSE NULL\n      END AS hrs_val,\n      CASE sk.machine_name\n      WHEN 'C1A_1_MC' THEN f.\"C1A_1_MC_MIN\"\n      WHEN 'C1A_MC' THEN f.\"C1A_MC_MIN\"\n      WHEN 'C2A_MC' THEN f.\"C2A_MC_MIN\"\n      WHEN 'C3A_MC' THEN f.\"C3A_MC_MIN\"\n      WHEN 'C4A_MC' THEN f.\"C4A_MC_MIN\"\n      WHEN 'C5A_MC' THEN f.\"C5A_MC_MIN\"\n      WHEN 'C6A_MC' THEN f.\"C6A_MC_MIN\"\n      WHEN 'C7A_MC' THEN f.\"C7A_MC_MIN\"\n      WHEN 'C8A_MC' THEN f.\"C8A_MC_MIN\"\n      WHEN 'F1A_MC' THEN f.\"F1A_MC_MIN\"\n      WHEN 'G10A_MC' THEN f.\"G10A_MC_MIN\"\n      WHEN 'G11A_MC' THEN f.\"G11A_MC_MIN\"\n      WHEN 'G13A_MC' THEN f.\"G13A_MC_MIN\"\n      WHEN 'G1A_1_MC' THEN f.\"G1A_1_MC_MIN\"\n      WHEN 'G1A_MC' THEN f.\"G1A_MC_MIN\"\n      WHEN 'G3A_MC' THEN f.\"G3A_MC_MIN\"\n      WHEN 'G4A_MC' THEN f.\"G4A_MC_MIN\"\n      WHEN 'G5A_1_MC' THEN f.\"G5A_1_MC_MIN\"\n      WHEN 'G5A_2_MC' THEN f.\"G5A_2_MC_MIN\"\n      WHEN 'G5A_MC' THEN f.\"G5A_MC_MIN\"\n      WHEN 'G7A_MC' THEN f.\"G7A_MC_MIN\"\n      WHEN 'G9A_MC' THEN f.\"G9A_MC_MIN\"\n      WHEN 'I10A_MC' THEN f.\"I10A_MC_MIN\"\n      WHEN 'I1A_MC' THEN f.\"I1A_MC_MIN\"\n      WHEN 'I2A_MC' THEN f.\"I2A_MC_MIN\"\n      WHEN 'I3A_MC' THEN f.\"I3A_MC_MIN\"\n      WHEN 'I4A_1_MC' THEN f.\"I4A_1_MC_MIN\"\n      WHEN 'I4A_2_MC' THEN f.\"I4A_2_MC_MIN\"\n      WHEN 'I5A_MC' THEN f.\"I5A_MC_MIN\"\n      WHEN 'I6A_A_MC' THEN f.\"I6A_A_MC_MIN\"\n      WHEN 'I6A_B_MC' THEN f.\"I6A_B_MC_MIN\"\n      WHEN 'I6A_C_MC' THEN f.\"I6A_C_MC_MIN\"\n      WHEN 'I6A_D_MC' THEN f.\"I6A_D_MC_MIN\"\n      WHEN 'I6A_E_MC' THEN f.\"I6A_E_MC_MIN\"\n      WHEN 'I6A_F_MC' THEN f.\"I6A_F_MC_MIN\"\n      WHEN 'I6A_G_MC' THEN f.\"I6A_G_MC_MIN\"\n      WHEN 'I6A_H_MC' THEN f.\"I6A_H_MC_MIN\"\n      WHEN 'I6A_I_MC' THEN f.\"I6A_I_MC_MIN\"\n      WHEN 'I6A_J_MC' THEN f.\"I6A_J_MC_MIN\"\n      WHEN 'I6A_K_MC' THEN f.\"I6A_K_MC_MIN\"\n      WHEN 'I6A_L_MC' THEN f.\"I6A_L_MC_MIN\"\n      WHEN 'I8A_1_MC' THEN f.\"I8A_1_MC_MIN\"\n      WHEN 'I8A_MC' THEN f.\"I8A_MC_MIN\"\n      WHEN 'I9A_MC' THEN f.\"I9A_MC_MIN\"\n      WHEN 'M1A_11_MC' THEN f.\"M1A_11_MC_MIN\"\n      WHEN 'M1A_18_MC' THEN f.\"M1A_18_MC_MIN\"\n      WHEN 'M1A_1_MC' THEN f.\"M1A_1_MC_MIN\"\n      WHEN 'M1A_2_MC' THEN f.\"M1A_2_MC_MIN\"\n      WHEN 'M1A_3_MC' THEN f.\"M1A_3_MC_MIN\"\n      WHEN 'M1A_9_MC' THEN f.\"M1A_9_MC_MIN\"\n      WHEN 'M1A_MC' THEN f.\"M1A_MC_MIN\"\n      WHEN 'M2A_MC' THEN f.\"M2A_MC_MIN\"\n      WHEN 'M3A_MC' THEN f.\"M3A_MC_MIN\"\n      WHEN 'M4A_MC' THEN f.\"M4A_MC_MIN\"\n      WHEN 'M5A_MC' THEN f.\"M5A_MC_MIN\"\n      WHEN 'P11A_MC' THEN f.\"P11A_MC_MIN\"\n      WHEN 'P12A_MC' THEN f.\"P12A_MC_MIN\"\n      WHEN 'P13A_MC' THEN f.\"P13A_MC_MIN\"\n      WHEN 'P14A_MC' THEN f.\"P14A_MC_MIN\"\n      WHEN 'P15A_MC' THEN f.\"P15A_MC_MIN\"\n      WHEN 'P16A_MC' THEN f.\"P16A_MC_MIN\"\n      WHEN 'P1A_MC' THEN f.\"P1A_MC_MIN\"\n      WHEN 'P2A_MC' THEN f.\"P2A_MC_MIN\"\n      WHEN 'P3A_MC' THEN f.\"P3A_MC_MIN\"\n      WHEN 'P4A_MC' THEN f.\"P4A_MC_MIN\"\n      WHEN 'P5A_MC' THEN f.\"P5A_MC_MIN\"\n      WHEN 'P6A_MC' THEN f.\"P6A_MC_MIN\"\n      WHEN 'P7A_1_MC' THEN f.\"P7A_1_MC_MIN\"\n      WHEN 'P7A_2_MC' THEN f.\"P7A_2_MC_MIN\"\n      WHEN 'P7A_MC' THEN f.\"P7A_MC_MIN\"\n      WHEN 'P8A_1_MC' THEN f.\"P8A_1_MC_MIN\"\n      WHEN 'P8A_2_MC' THEN f.\"P8A_2_MC_MIN\"\n      WHEN 'P8A_3_MC' THEN f.\"P8A_3_MC_MIN\"\n      WHEN 'P8A_4_MC' THEN f.\"P8A_4_MC_MIN\"\n      WHEN 'P8A_5_MC' THEN f.\"P8A_5_MC_MIN\"\n      WHEN 'P8A_MC' THEN f.\"P8A_MC_MIN\"\n      WHEN 'P9A_MC' THEN f.\"P9A_MC_MIN\"\n        ELSE NULL\n      END AS min_val,\n      CASE sk.machine_name\n      WHEN 'G10A_MC' THEN f.\"G10A_MC_SEC\"\n      WHEN 'G11A_MC' THEN f.\"G11A_MC_SEC\"\n      WHEN 'G13A_MC' THEN f.\"G13A_MC_SEC\"\n      WHEN 'G1A_1_MC' THEN f.\"G1A_1_MC_SEC\"\n      WHEN 'G1A_MC' THEN f.\"G1A_MC_SEC\"\n      WHEN 'G3A_MC' THEN f.\"G3A_MC_SEC\"\n      WHEN 'G4A_MC' THEN f.\"G4A_MC_SEC\"\n      WHEN 'G5A_1_MC' THEN f.\"G5A_1_MC_SEC\"\n      WHEN 'G5A_2_MC' THEN f.\"G5A_2_MC_SEC\"\n      WHEN 'G5A_MC' THEN f.\"G5A_MC_SEC\"\n      WHEN 'G7A_MC' THEN f.\"G7A_MC_SEC\"\n      WHEN 'G9A_MC' THEN f.\"G9A_MC_SEC\"\n      WHEN 'I10A_MC' THEN f.\"I10A_MC_SEC\"\n      WHEN 'I1A_MC' THEN f.\"I1A_MC_SEC\"\n      WHEN 'I2A_MC' THEN f.\"I2A_MC_SEC\"\n      WHEN 'I3A_MC' THEN f.\"I3A_MC_SEC\"\n      WHEN 'I4A_1_MC' THEN f.\"I4A_1_MC_SEC\"\n      WHEN 'I4A_2_MC' THEN f.\"I4A_2_MC_SEC\"\n      WHEN 'I5A_MC' THEN f.\"I5A_MC_SEC\"\n      WHEN 'I6A_A_MC' THEN f.\"I6A_A_MC_SEC\"\n      WHEN 'I6A_B_MC' THEN f.\"I6A_B_MC_SEC\"\n      WHEN 'I6A_C_MC' THEN f.\"I6A_C_MC_SEC\"\n      WHEN 'I6A_D_MC' THEN f.\"I6A_D_MC_SEC\"\n      WHEN 'I6A_E_MC' THEN f.\"I6A_E_MC_SEC\"\n      WHEN 'I6A_F_MC' THEN f.\"I6A_F_MC_SEC\"\n      WHEN 'I6A_G_MC' THEN f.\"I6A_G_MC_SEC\"\n      WHEN 'I6A_H_MC' THEN f.\"I6A_H_MC_SEC\"\n      WHEN 'I6A_I_MC' THEN f.\"I6A_I_MC_SEC\"\n      WHEN 'I6A_J_MC' THEN f.\"I6A_J_MC_SEC\"\n      WHEN 'I6A_K_MC' THEN f.\"I6A_K_MC_SEC\"\n      WHEN 'I6A_L_MC' THEN f.\"I6A_L_MC_SEC\"\n      WHEN 'I8A_1_MC' THEN f.\"I8A_1_MC_SEC\"\n      WHEN 'I8A_MC' THEN f.\"I8A_MC_SEC\"\n      WHEN 'I9A_MC' THEN f.\"I9A_MC_SEC\"\n      WHEN 'M1A_11_MC' THEN f.\"M1A_11_MC_SEC\"\n      WHEN 'M1A_18_MC' THEN f.\"M1A_18_MC_SEC\"\n      WHEN 'M1A_1_MC' THEN f.\"M1A_1_MC_SEC\"\n      WHEN 'M1A_2_MC' THEN f.\"M1A_2_MC_SEC\"\n      WHEN 'M1A_3_MC' THEN f.\"M1A_3_MC_SEC\"\n      WHEN 'M1A_9_MC' THEN f.\"M1A_9_MC_SEC\"\n      WHEN 'M1A_MC' THEN f.\"M1A_MC_SEC\"\n      WHEN 'M2A_MC' THEN f.\"M2A_MC_SEC\"\n      WHEN 'M3A_MC' THEN f.\"M3A_MC_SEC\"\n      WHEN 'M4A_MC' THEN f.\"M4A_MC_SEC\"\n      WHEN 'M5A_MC' THEN f.\"M5A_MC_SEC\"\n      WHEN 'P11A_MC' THEN f.\"P11A_MC_SEC\"\n      WHEN 'P12A_MC' THEN f.\"P12A_MC_SEC\"\n      WHEN 'P13A_MC' THEN f.\"P13A_MC_SEC\"\n      WHEN 'P14A_MC' THEN f.\"P14A_MC_SEC\"\n      WHEN 'P15A_MC' THEN f.\"P15A_MC_SEC\"\n      WHEN 'P16A_MC' THEN f.\"P16A_MC_SEC\"\n      WHEN 'P1A_MC' THEN f.\"P1A_MC_SEC\"\n      WHEN 'P2A_MC' THEN f.\"P2A_MC_SEC\"\n      WHEN 'P3A_MC' THEN f.\"P3A_MC_SEC\"\n      WHEN 'P4A_MC' THEN f.\"P4A_MC_SEC\"\n      WHEN 'P5A_MC' THEN f.\"P5A_MC_SEC\"\n      WHEN 'P6A_MC' THEN f.\"P6A_MC_SEC\"\n      WHEN 'P7A_1_MC' THEN f.\"P7A_1_MC_SEC\"\n      WHEN 'P7A_2_MC' THEN f.\"P7A_2_MC_SEC\"\n      WHEN 'P7A_MC' THEN f.\"P7A_MC_SEC\"\n      WHEN 'P8A_1_MC' THEN f.\"P8A_1_MC_SEC\"\n      WHEN 'P8A_2_MC' THEN f.\"P8A_2_MC_SEC\"\n      WHEN 'P8A_3_MC' THEN f.\"P8A_3_MC_SEC\"\n      WHEN 'P8A_4_MC' THEN f.\"P8A_4_MC_SEC\"\n      WHEN 'P8A_5_MC' THEN f.\"P8A_5_MC_SEC\"\n      WHEN 'P8A_MC' THEN f.\"P8A_MC_SEC\"\n      WHEN 'P9A_MC' THEN f.\"P9A_MC_SEC\"\n        ELSE NULL\n      END AS sec_val\n    FROM filtered f\n    CROSS JOIN selected_keys sk\n  ),\n  machine_values AS (\n    SELECT\n      timestamp_utc,\n      machine_name,\n      CASE\n        WHEN hrs_val IS NULL AND min_val IS NULL AND sec_val IS NULL THEN NULL\n        ELSE COALESCE(hrs_val, 0) * 3600 + COALESCE(min_val, 0) * 60 + COALESCE(sec_val, 0)\n      END AS total_seconds\n    FROM machine_raw\n  ),\n  ordered AS (\n    SELECT\n      machine_name,\n      timestamp_utc,\n      total_seconds,\n      LEAD(timestamp_utc) OVER (PARTITION BY machine_name ORDER BY timestamp_utc) AS next_ts,\n      LEAD(total_seconds) OVER (PARTITION BY machine_name ORDER BY timestamp_utc) AS next_value\n    FROM machine_values\n    WHERE total_seconds IS NOT NULL\n  ),\n  running AS (\n    SELECT\n      machine_name,\n      timestamp_utc AS current_ts,\n      next_ts,\n      total_seconds,\n      next_value,\n      CASE\n        WHEN next_ts IS NULL THEN 0\n        WHEN next_value IS NULL THEN 0\n        WHEN total_seconds = next_value THEN 0\n        ELSE 1\n      END AS is_running\n    FROM ordered\n  ),\n  start_marked AS (\n    SELECT\n      *,\n      CASE\n        WHEN is_running = 1\n         AND COALESCE(LAG(is_running) OVER (PARTITION BY machine_name ORDER BY current_ts), 0) = 0\n        THEN 1 ELSE 0\n      END AS start_flag\n    FROM running\n  ),\n  run_groups AS (\n    SELECT\n      *,\n      SUM(start_flag) OVER (\n        PARTITION BY machine_name\n        ORDER BY current_ts\n        ROWS UNBOUNDED PRECEDING\n      ) AS run_group\n    FROM start_marked\n    WHERE is_running = 1\n  ),\n  final AS (\n    SELECT\n      machine_name,\n      MIN(current_ts) AS start_ts,\n      MAX(next_ts) AS end_ts,\n      CAST(ROUND((julianday(MAX(next_ts)) - julianday(MIN(current_ts))) * 86400.0) AS INTEGER) AS duration_sec\n    FROM run_groups\n    GROUP BY machine_name, run_group\n    HAVING start_ts IS NOT NULL AND end_ts IS NOT NULL\n  )\nSELECT\n  COALESCE(SUM(duration_sec), 0) AS total_duration_sec,\n  printf('%02d:%02d:%02d',\n         COALESCE(SUM(duration_sec), 0) / 3600,\n         (COALESCE(SUM(duration_sec), 0) / 60) % 60,\n         COALESCE(SUM(duration_sec), 0) % 60) AS total_duration_hms,\n  COUNT(DISTINCT final.machine_name) AS machines_covered\nFROM final\nWHERE duration_sec > 0\n;\n"
  },
  "params": {
    "required": [],
    "optional": [
      "from_ts",
      "to_ts",
      "company_title"
    ]
  },
  "dialect": "sqlite",
  "needs_user_fix": [],
  "invalid": false,
  "summary": {}
}