
<html>
<head>
<meta charset="UTF-8" />
<title>{title}</title>
<style>
  @page { size: A4; margin: 14mm 14mm 16mm 14mm; }
  :root {
    --border: 1px solid #000;
  }
  body {
    font-family: "Times New Roman", serif;
    font-size: 12pt;
    color: #000;
    margin: 0;
  }
  .page {
    padding: 0;
  }
  .header-box {
    border: var(--border);
    padding: 6mm 6mm 3mm 6mm;
    margin-bottom: 4mm;
  }
  .hdr-grid {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
  }
  .hdr-grid td {
    padding: 2px 0;
    vertical-align: top;
  }
  .hdr-left {
    width: 55%;
  }
  .hdr-right {
    width: 45%;
    text-align: right;
  }
  .title {
    text-align: center;
    font-weight: bold;
    font-size: 16pt;
    margin: 2mm 0 1mm 0;
  }

  table.report {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
    border: var(--border);
  }
  table.report th,
  table.report td {
    border: var(--border);
    padding: 4px 6px;
    line-height: 1.15;
    vertical-align: top;
    font-variant-numeric: tabular-nums;
  }
  table.report thead th {
    font-weight: bold;
    text-align: left;
  }
  .c-sl { width: 8%; text-align: center; }
  .c-name { width: 46%; }
  .c-num { width: 14%; text-align: right; white-space: nowrap; }
  .c-err { width: 9%; text-align: right; white-space: nowrap; }
  .c-errp { width: 9%; text-align: right; white-space: nowrap; }
  .material {
    white-space: pre-wrap;
  }
  tfoot td {
    font-weight: bold;
  }

  .footer {
    margin-top: 14mm;
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 11pt;
  }
  .page-no {
    text-align: right;
    flex: 0 0 auto;
    margin-left: auto;
  }

  .batch-block { break-inside: avoid; page-break-inside: avoid; margin: 6mm 0; }
</style>
</head>
<body>
<div class="page">
  <div class="header-box">
    <table class="hdr-grid">
      <tr>
        <td class="hdr-left">Plant name  :  {plant_name}</td>
        <td class="hdr-right">From  Date:  {from_date}  To  {to_date}</td>
      </tr>
      <tr>
        <td class="hdr-left">Location    :  {location}</td>
        <td class="hdr-right">Recipe code :  {recipe_code}</td>
      </tr>
      <tr>
        <td class="hdr-left">Print Date  :  {print_date}</td>
        <td class="hdr-right"></td>
      </tr>
    </table>
    <div class="title">{title}</div>
  </div>

  <table class="report">
    <colgroup>
      <col class="c-sl" />
      <col class="c-name" />
      <col class="c-num" />
      <col class="c-num" />
      <col class="c-err" />
      <col class="c-errp" />
    </colgroup>
    <thead>
      <tr>
        <th>Sl. No.</th>
        <th>Material name</th>
        <th>Set. wt(Kg)</th>
        <th>Ach. wt(Kg)</th>
        <th>Error(Kg)</th>
        <th>Error %</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="c-sl">{rows.sl}</td>
        <td class="c-name material">{rows.name}</td>
        <td class="c-num">{rows.set}</td>
        <td class="c-num">{rows.ach}</td>
        <td class="c-err">{rows.err}</td>
        <td class="c-errp">{rows.errp}</td>
      </tr>
    </tbody>
    <tfoot>
      <tr>
        <td colspan="2">Total</td>
        <td class="c-num">{total_set}</td>
        <td class="c-num">{total_ach}</td>
        <td class="c-err">{total_err}</td>
        <td class="c-errp">{total_errp}</td>
      </tr>
    </tfoot>
  </table>

  <div class="footer">
    <div class="company">{company}</div>
    <div class="page-no">Page {page_no} of {pages}</div>
  </div>
</div>
</body>
</html>