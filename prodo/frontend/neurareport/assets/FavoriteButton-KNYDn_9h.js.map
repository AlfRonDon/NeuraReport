{"version":3,"file":"FavoriteButton-KNYDn_9h.js","sources":["../../src/features/favorites/components/FavoriteButton.jsx"],"sourcesContent":["/**\n * Premium Favorite Button\n * Star toggle with theme-based styling\n */\nimport { useState, useCallback, useEffect } from 'react'\nimport { IconButton, Tooltip, CircularProgress, useTheme, alpha } from '@mui/material'\nimport StarIcon from '@mui/icons-material/Star'\nimport StarBorderIcon from '@mui/icons-material/StarBorder'\nimport * as api from '@/api/client'\nimport { useInteraction, InteractionType, Reversibility } from '@/components/ux/governance'\nimport { neutral, palette } from '@/app/theme'\n\n/**\n * A reusable favorite toggle button.\n * @param {Object} props\n * @param {string} props.entityType - 'templates' or 'connections'\n * @param {string} props.entityId - The ID of the entity\n * @param {boolean} [props.initialFavorite] - Initial favorite state (if known)\n * @param {function} [props.onToggle] - Callback when favorite is toggled (isFavorite) => void\n * @param {'small' | 'medium'} [props.size] - Button size\n */\nexport default function FavoriteButton({\n  entityType,\n  entityId,\n  initialFavorite,\n  onToggle,\n  size = 'small',\n}) {\n  const theme = useTheme()\n  const { execute } = useInteraction()\n  const [isFavorite, setIsFavorite] = useState(initialFavorite ?? false)\n  const [loading, setLoading] = useState(false)\n  const [checked, setChecked] = useState(initialFavorite !== undefined)\n\n  // Check favorite status on mount if not provided\n  useEffect(() => {\n    if (checked || !entityId) return\n\n    let cancelled = false\n    api.checkFavorite(entityType, entityId)\n      .then((result) => {\n        if (!cancelled) {\n          setIsFavorite(result.isFavorite)\n          setChecked(true)\n        }\n      })\n      .catch(() => {\n        // Ignore errors on initial check\n        if (!cancelled) setChecked(true)\n      })\n\n    return () => { cancelled = true }\n  }, [entityType, entityId, checked])\n\n  // Update if initialFavorite prop changes\n  useEffect(() => {\n    if (initialFavorite !== undefined) {\n      setIsFavorite(initialFavorite)\n      setChecked(true)\n    }\n  }, [initialFavorite])\n\n  const handleToggle = useCallback(async (e) => {\n    e.stopPropagation()\n    if (loading || !entityId) return\n\n    setLoading(true)\n    const nextFavorite = !isFavorite\n\n    // Optimistic update\n    setIsFavorite(nextFavorite)\n\n    try {\n      await execute({\n        type: nextFavorite ? InteractionType.CREATE : InteractionType.DELETE,\n        label: nextFavorite ? 'Add favorite' : 'Remove favorite',\n        reversibility: Reversibility.FULLY_REVERSIBLE,\n        suppressSuccessToast: true,\n        suppressErrorToast: true,\n        blocksNavigation: false,\n        intent: {\n          entityType,\n          entityId,\n          action: nextFavorite ? 'favorite_add' : 'favorite_remove',\n        },\n        action: async () => {\n          try {\n            if (nextFavorite) {\n              await api.addFavorite(entityType, entityId)\n            } else {\n              await api.removeFavorite(entityType, entityId)\n            }\n            onToggle?.(nextFavorite)\n          } catch (err) {\n            // Revert on error\n            setIsFavorite(!nextFavorite)\n            throw err\n          }\n        },\n      })\n    } finally {\n      setLoading(false)\n    }\n  }, [entityType, entityId, isFavorite, loading, onToggle, execute])\n\n  const iconSize = size === 'small' ? 18 : 22\n\n  return (\n    <Tooltip title={isFavorite ? 'Remove from favorites' : 'Add to favorites'}>\n      <IconButton\n        size={size}\n        onClick={handleToggle}\n        disabled={loading}\n        data-testid=\"favorite-button\"\n        sx={{\n          color: isFavorite ? (theme.palette.mode === 'dark' ? neutral[300] : neutral[900]) : theme.palette.text.secondary,\n          transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n          '&:hover': {\n            color: theme.palette.mode === 'dark' ? neutral[300] : neutral[900],\n            bgcolor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n            transform: 'scale(1.1)',\n          },\n        }}\n      >\n        {loading ? (\n          <CircularProgress size={iconSize - 4} sx={{ color: theme.palette.text.secondary }} />\n        ) : isFavorite ? (\n          <StarIcon sx={{ fontSize: iconSize }} />\n        ) : (\n          <StarBorderIcon sx={{ fontSize: iconSize }} />\n        )}\n      </IconButton>\n    </Tooltip>\n  )\n}\n"],"names":["FavoriteButton","entityType","entityId","initialFavorite","onToggle","size","theme","useTheme","execute","useInteraction","isFavorite","setIsFavorite","useState","loading","setLoading","checked","setChecked","useEffect","cancelled","api.checkFavorite","result","handleToggle","useCallback","e","nextFavorite","InteractionType","Reversibility","api.addFavorite","api.removeFavorite","err","iconSize","jsx","Tooltip","IconButton","neutral","alpha","CircularProgress","StarIcon","StarBorderIcon"],"mappings":"wMAqBA,SAAwBA,EAAe,CACrC,WAAAC,EACA,SAAAC,EACA,gBAAAC,EACA,SAAAC,EACA,KAAAC,EAAO,OACT,EAAG,CACD,MAAMC,EAAQC,EAAA,EACR,CAAE,QAAAC,CAAA,EAAYC,EAAA,EACd,CAACC,EAAYC,CAAa,EAAIC,EAAAA,SAAST,GAAmB,EAAK,EAC/D,CAACU,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAK,EACtC,CAACG,EAASC,CAAU,EAAIJ,EAAAA,SAAST,IAAoB,MAAS,EAGpEc,EAAAA,UAAU,IAAM,CACd,GAAIF,GAAW,CAACb,EAAU,OAE1B,IAAIgB,EAAY,GAChBC,OAAAA,EAAkBlB,EAAYC,CAAQ,EACnC,KAAMkB,GAAW,CACXF,IACHP,EAAcS,EAAO,UAAU,EAC/BJ,EAAW,EAAI,EAEnB,CAAC,EACA,MAAM,IAAM,CAENE,GAAWF,EAAW,EAAI,CACjC,CAAC,EAEI,IAAM,CAAEE,EAAY,EAAK,CAClC,EAAG,CAACjB,EAAYC,EAAUa,CAAO,CAAC,EAGlCE,EAAAA,UAAU,IAAM,CACVd,IAAoB,SACtBQ,EAAcR,CAAe,EAC7Ba,EAAW,EAAI,EAEnB,EAAG,CAACb,CAAe,CAAC,EAEpB,MAAMkB,EAAeC,cAAY,MAAOC,GAAM,CAE5C,GADAA,EAAE,gBAAA,EACEV,GAAW,CAACX,EAAU,OAE1BY,EAAW,EAAI,EACf,MAAMU,EAAe,CAACd,EAGtBC,EAAca,CAAY,EAE1B,GAAI,CACF,MAAMhB,EAAQ,CACZ,KAAMgB,EAAeC,EAAgB,OAASA,EAAgB,OAC9D,MAAOD,EAAe,eAAiB,kBACvC,cAAeE,EAAc,iBAC7B,qBAAsB,GACtB,mBAAoB,GACpB,iBAAkB,GAClB,OAAQ,CACN,WAAAzB,EACA,SAAAC,EACA,OAAQsB,EAAe,eAAiB,iBAAA,EAE1C,OAAQ,SAAY,CAClB,GAAI,CACEA,EACF,MAAMG,EAAgB1B,EAAYC,CAAQ,EAE1C,MAAM0B,EAAmB3B,EAAYC,CAAQ,EAE/CE,IAAWoB,CAAY,CACzB,OAASK,EAAK,CAEZ,MAAAlB,EAAc,CAACa,CAAY,EACrBK,CACR,CACF,CAAA,CACD,CACH,QAAA,CACEf,EAAW,EAAK,CAClB,CACF,EAAG,CAACb,EAAYC,EAAUQ,EAAYG,EAAST,EAAUI,CAAO,CAAC,EAE3DsB,EAAWzB,IAAS,QAAU,GAAK,GAEzC,OACE0B,EAAAA,IAACC,EAAA,CAAQ,MAAOtB,EAAa,wBAA0B,mBACrD,SAAAqB,EAAAA,IAACE,EAAA,CACC,KAAA5B,EACA,QAASgB,EACT,SAAUR,EACV,cAAY,kBACZ,GAAI,CACF,MAAOH,EAAcJ,EAAM,QAAQ,OAAS,OAAS4B,EAAQ,GAAG,EAAIA,EAAQ,GAAG,EAAK5B,EAAM,QAAQ,KAAK,UACvG,WAAY,0CACZ,UAAW,CACT,MAAOA,EAAM,QAAQ,OAAS,OAAS4B,EAAQ,GAAG,EAAIA,EAAQ,GAAG,EACjE,QAAS5B,EAAM,QAAQ,OAAS,OAAS6B,EAAM7B,EAAM,QAAQ,KAAK,QAAS,GAAI,EAAI4B,EAAQ,GAAG,EAC9F,UAAW,YAAA,CACb,EAGD,SAAArB,EACCkB,EAAAA,IAACK,EAAA,CAAiB,KAAMN,EAAW,EAAG,GAAI,CAAE,MAAOxB,EAAM,QAAQ,KAAK,UAAU,CAAG,EACjFI,EACFqB,EAAAA,IAACM,EAAA,CAAS,GAAI,CAAE,SAAUP,CAAA,CAAS,CAAG,EAEtCC,EAAAA,IAACO,EAAA,CAAe,GAAI,CAAE,SAAUR,EAAS,CAAG,CAAA,CAAA,EAGlD,CAEJ"}