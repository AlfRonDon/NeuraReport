{"version":3,"file":"ReportsPage-Dz6g8iil.js","sources":["../../node_modules/@mui/icons-material/esm/DateRange.js","../../node_modules/@mui/icons-material/esm/Today.js","../../src/features/reports/components/TemplateRecommender.jsx","../../src/features/reports/containers/ReportsPageContainer.jsx","../../src/pages/reports/ReportsPage.jsx"],"sourcesContent":["\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M9 11H7v2h2zm4 0h-2v2h2zm4 0h-2v2h2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 16H5V9h14z\"\n}), 'DateRange');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V8h14zM7 10h5v5H7z\"\n}), 'Today');","import { useState, useCallback } from 'react'\nimport {\n  Box,\n  Stack,\n  Typography,\n  TextField,\n  Button,\n  Paper,\n  Chip,\n  CircularProgress,\n  Collapse,\n  IconButton,\n  Avatar,\n  LinearProgress,\n  Alert,\n  Tooltip,\n  alpha,\n} from '@mui/material'\nimport { neutral, palette } from '@/app/theme'\nimport AutoAwesomeIcon from '@mui/icons-material/AutoAwesome'\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore'\nimport ExpandLessIcon from '@mui/icons-material/ExpandLess'\nimport PictureAsPdfIcon from '@mui/icons-material/PictureAsPdf'\nimport TableChartIcon from '@mui/icons-material/TableChart'\nimport CheckIcon from '@mui/icons-material/Check'\nimport ScheduleIcon from '@mui/icons-material/Schedule'\nimport { recommendTemplates, queueRecommendTemplates } from '@/api/client'\nimport { useToast } from '@/components/ToastProvider.jsx'\nimport { useInteraction, InteractionType, Reversibility } from '@/components/ux/governance'\n\nconst KIND_ICONS = {\n  pdf: PictureAsPdfIcon,\n  excel: TableChartIcon,\n}\n\nconst KIND_COLORS = {\n  pdf: 'error',\n  excel: 'success',\n}\n\nexport default function TemplateRecommender({ onSelectTemplate }) {\n  const { execute } = useInteraction()\n  const [expanded, setExpanded] = useState(false)\n  const [requirement, setRequirement] = useState('')\n  const [loading, setLoading] = useState(false)\n  const [queueing, setQueueing] = useState(false)\n  const [recommendations, setRecommendations] = useState([])\n  const [error, setError] = useState(null)\n  const toast = useToast()\n\n  const executeUI = useCallback(\n    (label, action, intent = {}) =>\n      execute({\n        type: InteractionType.EXECUTE,\n        label,\n        reversibility: Reversibility.FULLY_REVERSIBLE,\n        suppressSuccessToast: true,\n        suppressErrorToast: true,\n        intent: { source: 'template_recommender', ...intent },\n        action,\n      }),\n    [execute]\n  )\n\n  const handleSearch = useCallback(() => {\n    const trimmed = requirement.trim()\n    if (!trimmed) return undefined\n\n    return execute({\n      type: InteractionType.ANALYZE,\n      label: 'Recommend templates',\n      reversibility: Reversibility.FULLY_REVERSIBLE,\n      suppressSuccessToast: true,\n      suppressErrorToast: true,\n      intent: { source: 'template_recommender', action: 'recommend_templates', requirement: trimmed },\n      action: async () => {\n        setLoading(true)\n        setError(null)\n        setRecommendations([])\n\n        try {\n          const results = await recommendTemplates({\n            requirement: trimmed,\n            limit: 5,\n          })\n          const normalized = Array.isArray(results) ? results : []\n          setRecommendations(normalized)\n          if (!normalized.length) {\n            setError('No matching templates found. Try a different description.')\n          }\n          return normalized\n        } catch (err) {\n          setError(err.message || 'Failed to get recommendations')\n          throw err\n        } finally {\n          setLoading(false)\n        }\n      },\n    })\n  }, [execute, requirement])\n\n  const handleQueue = useCallback(() => {\n    const trimmed = requirement.trim()\n    if (!trimmed) return undefined\n\n    return execute({\n      type: InteractionType.GENERATE,\n      label: 'Queue template recommendations',\n      reversibility: Reversibility.SYSTEM_MANAGED,\n      suppressSuccessToast: true,\n      suppressErrorToast: true,\n      intent: { source: 'template_recommender', action: 'queue_recommendations', requirement: trimmed },\n      action: async () => {\n        setQueueing(true)\n        setError(null)\n        try {\n          const response = await queueRecommendTemplates({\n            requirement: trimmed,\n            limit: 5,\n          })\n          if (response?.job_id) {\n            toast.show('Recommendation job queued. Track it in Jobs.', 'success')\n          } else {\n            toast.show('Failed to queue recommendation job.', 'error')\n          }\n          return response\n        } catch (err) {\n          toast.show(err.message || 'Failed to queue recommendations', 'error')\n          throw err\n        } finally {\n          setQueueing(false)\n        }\n      },\n    })\n  }, [execute, requirement, toast])\n\n  const handleSelect = useCallback(\n    (template) =>\n      executeUI(\n        'Select recommended template',\n        () => {\n          onSelectTemplate?.(template)\n          setExpanded(false)\n        },\n        { templateId: template?.id }\n      ),\n    [executeUI, onSelectTemplate]\n  )\n\n  const handleKeyDown = useCallback(\n    (e) => {\n      if (e.key === 'Enter' && !e.shiftKey) {\n        e.preventDefault()\n        handleSearch()\n      }\n    },\n    [handleSearch]\n  )\n\n  return (\n    <Paper\n      sx={{\n        border: 1,\n        borderColor: 'divider',\n        borderStyle: expanded ? 'solid' : 'dashed',\n        transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n        overflow: 'hidden',\n      }}\n    >\n      {/* Header */}\n      <Box\n        sx={{\n          px: 2,\n          py: 1.5,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n          cursor: 'pointer',\n          bgcolor: expanded ? 'action.selected' : 'transparent',\n          '&:hover': {\n            bgcolor: 'action.hover',\n          },\n        }}\n      onClick={() => executeUI('Toggle template recommender', () => setExpanded((prev) => !prev))}\n      >\n        <Stack direction=\"row\" alignItems=\"center\" spacing={1.5}>\n          <Avatar\n            sx={{\n              width: 32,\n              height: 32,\n              bgcolor: (theme) => theme.palette.mode === 'dark' ? 'rgba(255,255,255,0.08)' : neutral[100],\n            }}\n          >\n            <AutoAwesomeIcon sx={{ color: 'text.secondary', fontSize: 18 }} />\n          </Avatar>\n          <Box>\n            <Typography variant=\"subtitle2\" fontWeight={600}>\n              AI Template Picker\n            </Typography>\n            <Typography variant=\"caption\" color=\"text.secondary\">\n              Describe what you need and let AI find the best template\n            </Typography>\n          </Box>\n        </Stack>\n        <Tooltip title={expanded ? 'Collapse' : 'Expand'}>\n          <IconButton size=\"small\" aria-label={expanded ? 'Collapse' : 'Expand'}>\n            {expanded ? <ExpandLessIcon /> : <ExpandMoreIcon />}\n          </IconButton>\n        </Tooltip>\n      </Box>\n\n      {/* Expanded Content */}\n      <Collapse in={expanded}>\n        <Box sx={{ px: 2, pb: 2 }}>\n          <Stack spacing={2}>\n            {/* Search Input */}\n            <Stack direction=\"row\" spacing={1}>\n              <TextField\n                fullWidth\n                size=\"small\"\n                placeholder=\"e.g., monthly sales report with charts, inventory tracking spreadsheet...\"\n                value={requirement}\n                onChange={(e) => setRequirement(e.target.value)}\n                onKeyDown={handleKeyDown}\n                disabled={loading}\n                sx={{\n                  '& .MuiOutlinedInput-root': {\n                    bgcolor: 'background.paper',\n                  },\n                }}\n              />\n              <Button\n                variant=\"contained\"\n                onClick={handleSearch}\n                disabled={loading || queueing || !requirement.trim()}\n                startIcon={\n                  loading ? (\n                    <CircularProgress size={16} color=\"inherit\" />\n                  ) : (\n                    <AutoAwesomeIcon />\n                  )\n                }\n                sx={{ minWidth: 120, textTransform: 'none' }}\n              >\n                {loading ? 'Searching...' : 'Find'}\n              </Button>\n              <Button\n                variant=\"outlined\"\n                onClick={handleQueue}\n                disabled={loading || queueing || !requirement.trim()}\n                startIcon={\n                  queueing ? (\n                    <CircularProgress size={16} color=\"inherit\" />\n                  ) : (\n                    <ScheduleIcon />\n                  )\n                }\n                sx={{ minWidth: 120, textTransform: 'none' }}\n              >\n                {queueing ? 'Queueing...' : 'Queue'}\n              </Button>\n            </Stack>\n\n            {/* Loading */}\n            {loading && <LinearProgress />}\n\n            {/* Error */}\n            {error && (\n              <Alert severity=\"info\" onClose={() => executeUI('Dismiss recommendations error', () => setError(null))}>\n                {error}\n              </Alert>\n            )}\n\n            {/* Results */}\n            {recommendations.length > 0 && (\n              <Stack spacing={1.5}>\n                <Typography variant=\"caption\" color=\"text.secondary\">\n                  {recommendations.length} template{recommendations.length !== 1 ? 's' : ''} found\n                </Typography>\n                {recommendations.map((rec, idx) => {\n                  const template = rec.template || rec\n                  const kind = template.kind || 'pdf'\n                  const Icon = KIND_ICONS[kind] || PictureAsPdfIcon\n                  const score = typeof rec.score === 'number' ? rec.score : null\n\n                  return (\n                    <Paper\n                      key={template.id || idx}\n                      variant=\"outlined\"\n                      sx={{\n                        p: 2,\n                        cursor: 'pointer',\n                        transition: 'all 0.15s cubic-bezier(0.22, 1, 0.36, 1)',\n                        '&:hover': {\n                          borderColor: (theme) => theme.palette.mode === 'dark' ? neutral[500] : neutral[700],\n                          bgcolor: 'action.hover',\n                        },\n                      }}\n                      onClick={() => handleSelect(template)}\n                    >\n                      <Stack\n                        direction=\"row\"\n                        alignItems=\"flex-start\"\n                        spacing={2}\n                      >\n                        <Avatar\n                          variant=\"rounded\"\n                          sx={{\n                            width: 40,\n                            height: 40,\n                            bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n                          }}\n                        >\n                          <Icon\n                            sx={{\n                              color: 'text.secondary',\n                            }}\n                          />\n                        </Avatar>\n                        <Box sx={{ flex: 1, minWidth: 0 }}>\n                          <Stack\n                            direction=\"row\"\n                            alignItems=\"center\"\n                            spacing={1}\n                            sx={{ mb: 0.5 }}\n                          >\n                            <Typography variant=\"subtitle2\" fontWeight={600}>\n                              {template.name || template.id}\n                            </Typography>\n                            <Chip\n                              label={kind.toUpperCase()}\n                              size=\"small\"\n                              variant=\"outlined\"\n                              sx={{ height: 20, fontSize: '10px', bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.1) : neutral[200], color: 'text.secondary' }}\n                            />\n                            {score !== null && (\n                              <Chip\n                                label={`${Math.round(score * 100)}% match`}\n                                size=\"small\"\n                                sx={{ height: 20, fontSize: '10px', bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.1) : neutral[200], color: 'text.secondary' }}\n                              />\n                            )}\n                          </Stack>\n                          {rec.explanation && (\n                            <Typography\n                              variant=\"body2\"\n                              color=\"text.secondary\"\n                              sx={{\n                                display: '-webkit-box',\n                                WebkitLineClamp: 2,\n                                WebkitBoxOrient: 'vertical',\n                                overflow: 'hidden',\n                              }}\n                            >\n                              {rec.explanation}\n                            </Typography>\n                          )}\n                          {!rec.explanation && template.description && (\n                            <Typography\n                              variant=\"body2\"\n                              color=\"text.secondary\"\n                              sx={{\n                                display: '-webkit-box',\n                                WebkitLineClamp: 2,\n                                WebkitBoxOrient: 'vertical',\n                                overflow: 'hidden',\n                              }}\n                            >\n                              {template.description}\n                            </Typography>\n                          )}\n                        </Box>\n                        <Button\n                          size=\"small\"\n                          variant=\"outlined\"\n                          startIcon={<CheckIcon />}\n                      onClick={(e) => {\n                        e.stopPropagation()\n                        handleSelect(template)\n                      }}\n                          sx={{ textTransform: 'none', whiteSpace: 'nowrap' }}\n                        >\n                          Select\n                        </Button>\n                      </Stack>\n                    </Paper>\n                  )\n                })}\n              </Stack>\n            )}\n\n            {/* Quick Examples */}\n            {!loading && recommendations.length === 0 && (\n              <Box>\n                <Typography variant=\"caption\" color=\"text.secondary\" sx={{ mb: 1, display: 'block' }}>\n                  Try these examples:\n                </Typography>\n                <Stack direction=\"row\" spacing={1} flexWrap=\"wrap\" useFlexGap>\n                  {[\n                    'monthly financial report',\n                    'inventory tracking',\n                    'sales summary with charts',\n                    'equipment status report',\n                  ].map((example) => (\n                    <Chip\n                      key={example}\n                      label={example}\n                      size=\"small\"\n                      variant=\"outlined\"\n                      onClick={() => executeUI('Set example requirement', () => setRequirement(example), { example })}\n                      sx={{ cursor: 'pointer' }}\n                    />\n                  ))}\n                </Stack>\n              </Box>\n            )}\n          </Stack>\n        </Box>\n      </Collapse>\n    </Paper>\n  )\n}\n","/**\n * Reports Page — Clean workflow for report generation\n * Single-column layout: Design & Source → Time Period → Generate → Recent Runs\n */\nimport { useState, useCallback, useMemo, useEffect, useRef } from 'react'\nimport { useSearchParams } from 'react-router-dom'\nimport {\n  Box,\n  Container,\n  Typography,\n  Stack,\n  Paper,\n  Button,\n  InputLabel,\n  Select,\n  MenuItem,\n  TextField,\n  Chip,\n  Alert,\n  LinearProgress,\n  Collapse,\n  Divider,\n  Checkbox,\n  List,\n  ListItem,\n  ListItemText,\n  useTheme,\n  alpha,\n  styled,\n} from '@mui/material'\nimport PlayArrowIcon from '@mui/icons-material/PlayArrow'\nimport DownloadIcon from '@mui/icons-material/Download'\nimport TableChartIcon from '@mui/icons-material/TableChart'\nimport ArticleIcon from '@mui/icons-material/Article'\nimport ScheduleIcon from '@mui/icons-material/Schedule'\nimport AutoAwesomeIcon from '@mui/icons-material/AutoAwesome'\nimport SmartToyIcon from '@mui/icons-material/SmartToy'\nimport ArrowForwardIcon from '@mui/icons-material/ArrowForward'\nimport TodayIcon from '@mui/icons-material/Today'\nimport DateRangeIcon from '@mui/icons-material/DateRange'\nimport FilterListIcon from '@mui/icons-material/FilterList'\nimport DescriptionIcon from '@mui/icons-material/Description'\nimport RefreshIcon from '@mui/icons-material/Refresh'\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore'\nimport ExpandLessIcon from '@mui/icons-material/ExpandLess'\nimport { useAppStore } from '@/stores'\nimport { useToast } from '@/components/ToastProvider'\nimport PageHeader from '@/components/layout/PageHeader'\nimport TemplateRecommender from '@/features/reports/components/TemplateRecommender.jsx'\nimport SuccessCelebration, { useCelebration } from '@/components/SuccessCelebration'\nimport AiUsageNotice from '@/components/ai/AiUsageNotice'\nimport { useInteraction, InteractionType, Reversibility, useNavigateInteraction } from '@/components/ux/governance'\nimport ConnectionSelector from '@/components/common/ConnectionSelector'\nimport * as api from '@/api/client'\nimport * as summaryApi from '@/api/summary'\nimport { neutral, palette } from '@/app/theme'\nimport { fadeInUp, GlassCard, StyledFormControl } from '@/styles'\n\n// =============================================================================\n// STYLED COMPONENTS\n// =============================================================================\n\nconst SectionLabel = styled(Typography)(({ theme }) => ({\n  fontSize: '0.8125rem',\n  fontWeight: 700,\n  textTransform: 'uppercase',\n  letterSpacing: '0.08em',\n  color: theme.palette.text.primary,\n  marginBottom: theme.spacing(1.5),\n  display: 'flex',\n  alignItems: 'center',\n  gap: theme.spacing(1),\n  '&::after': {\n    content: '\"\"',\n    flex: 1,\n    height: 1,\n    backgroundColor: alpha(theme.palette.divider, 0.3),\n  },\n}))\n\nconst StyledTextField = styled(TextField)(({ theme }) => ({\n  '& .MuiOutlinedInput-root': {\n    borderRadius: 12,\n    backgroundColor: alpha(theme.palette.background.paper, 0.6),\n    transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n    '&:hover': {\n      backgroundColor: alpha(theme.palette.background.paper, 0.8),\n    },\n    '&.Mui-focused': {\n      backgroundColor: theme.palette.background.paper,\n      boxShadow: `0 0 0 3px ${alpha(theme.palette.text.primary, 0.08)}`,\n    },\n  },\n}))\n\nconst PresetChip = styled(Chip, {\n  shouldForwardProp: (prop) => prop !== 'selected',\n})(({ theme, selected }) => ({\n  borderRadius: 10,\n  fontWeight: 500,\n  fontSize: '0.75rem',\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  cursor: 'pointer',\n  ...(selected && {\n    background: theme.palette.mode === 'dark' ? neutral[700] : neutral[900],\n    color: theme.palette.common.white,\n    boxShadow: `0 4px 12px ${alpha(theme.palette.common.black, 0.15)}`,\n    '& .MuiChip-icon': {\n      color: theme.palette.common.white,\n    },\n  }),\n  ...(!selected && {\n    backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n    color: theme.palette.text.primary,\n    border: `1px solid ${alpha(theme.palette.divider, 0.3)}`,\n    '& .MuiChip-icon': {\n      color: theme.palette.text.secondary,\n    },\n    '&:hover': {\n      backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.14) : neutral[200],\n      transform: 'translateY(-1px)',\n    },\n  }),\n}))\n\nconst DiscoveryChip = styled(Chip)(({ theme }) => ({\n  borderRadius: 8,\n  fontWeight: 600,\n  fontSize: '0.75rem',\n  backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n  color: theme.palette.text.secondary,\n  border: `1px solid ${alpha(theme.palette.divider, 0.2)}`,\n}))\n\nconst BatchListContainer = styled(Box)(({ theme }) => ({\n  maxHeight: 200,\n  overflow: 'auto',\n  borderRadius: 12,\n  border: `1px solid ${alpha(theme.palette.divider, 0.15)}`,\n  backgroundColor: alpha(theme.palette.background.paper, 0.4),\n  '&::-webkit-scrollbar': {\n    width: 6,\n  },\n  '&::-webkit-scrollbar-track': {\n    background: 'transparent',\n  },\n  '&::-webkit-scrollbar-thumb': {\n    background: alpha(theme.palette.text.primary, 0.2),\n    borderRadius: 8,\n  },\n}))\n\nconst BatchListItem = styled(ListItem, {\n  shouldForwardProp: (prop) => prop !== 'selected',\n})(({ theme, selected }) => ({\n  padding: theme.spacing(1, 1.5),\n  cursor: 'pointer',\n  transition: 'all 0.15s cubic-bezier(0.22, 1, 0.36, 1)',\n  borderBottom: `1px solid ${alpha(theme.palette.divider, 0.1)}`,\n  ...(selected && {\n    backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n  }),\n  '&:hover': {\n    backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.05) : neutral[50],\n  },\n  '&:last-child': {\n    borderBottom: 'none',\n  },\n}))\n\nconst PrimaryButton = styled(Button)(({ theme }) => ({\n  borderRadius: 12,\n  textTransform: 'none',\n  fontWeight: 600,\n  fontSize: '0.875rem',\n  padding: theme.spacing(1.25, 3),\n  background: theme.palette.mode === 'dark' ? neutral[700] : neutral[900],\n  color: theme.palette.common.white,\n  boxShadow: `0 4px 14px ${alpha(theme.palette.common.black, 0.15)}`,\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  '&:hover': {\n    background: theme.palette.mode === 'dark' ? neutral[500] : neutral[700],\n    boxShadow: `0 6px 20px ${alpha(theme.palette.common.black, 0.2)}`,\n    transform: 'translateY(-2px)',\n  },\n  '&:active': {\n    transform: 'translateY(0)',\n  },\n  '&:disabled': {\n    background: theme.palette.action.disabledBackground,\n    color: theme.palette.action.disabled,\n    boxShadow: 'none',\n  },\n}))\n\nconst SecondaryButton = styled(Button)(({ theme }) => ({\n  borderRadius: 12,\n  textTransform: 'none',\n  fontWeight: 500,\n  fontSize: '0.875rem',\n  padding: theme.spacing(1.25, 2.5),\n  borderColor: alpha(theme.palette.divider, 0.3),\n  color: theme.palette.text.primary,\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  '&:hover': {\n    borderColor: theme.palette.mode === 'dark' ? neutral[500] : neutral[700],\n    backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.04) : neutral[50],\n    transform: 'translateY(-1px)',\n  },\n}))\n\nconst TextButton = styled(Button)(({ theme }) => ({\n  borderRadius: 8,\n  textTransform: 'none',\n  fontWeight: 500,\n  fontSize: '0.75rem',\n  padding: theme.spacing(0.5, 1.5),\n  color: theme.palette.text.secondary,\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  '&:hover': {\n    backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n    color: theme.palette.text.primary,\n  },\n}))\n\nconst RunHistoryCard = styled(Paper, {\n  shouldForwardProp: (prop) => prop !== 'selected',\n})(({ theme, selected }) => ({\n  padding: theme.spacing(2),\n  borderRadius: 12,\n  cursor: 'pointer',\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  border: `1px solid ${selected ? (theme.palette.mode === 'dark' ? neutral[500] : neutral[700]) : alpha(theme.palette.divider, 0.2)}`,\n  backgroundColor: selected ? (theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.05) : neutral[50]) : 'transparent',\n  '&:hover': {\n    borderColor: alpha(theme.palette.divider, 0.4),\n    backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.03) : neutral[50],\n    '& .view-summary-hint': {\n      opacity: 1,\n      color: theme.palette.text.primary,\n    },\n  },\n}))\n\nconst StyledLinearProgress = styled(LinearProgress)(({ theme }) => ({\n  borderRadius: 4,\n  height: 6,\n  backgroundColor: alpha(theme.palette.text.primary, 0.1),\n  '& .MuiLinearProgress-bar': {\n    borderRadius: 4,\n    background: theme.palette.mode === 'dark' ? neutral[500] : neutral[900],\n  },\n}))\n\nconst DownloadButton = styled(Button)(({ theme }) => ({\n  borderRadius: 8,\n  textTransform: 'none',\n  fontWeight: 500,\n  fontSize: '0.75rem',\n  padding: theme.spacing(0.5, 1.5),\n  borderColor: alpha(theme.palette.divider, 0.3),\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  '&:hover': {\n    borderColor: theme.palette.mode === 'dark' ? neutral[500] : neutral[700],\n    backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.04) : neutral[50],\n  },\n}))\n\nconst AdvancedToggle = styled(Box)(({ theme }) => ({\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'space-between',\n  padding: theme.spacing(1.5, 0),\n  cursor: 'pointer',\n  color: theme.palette.text.secondary,\n  transition: 'color 0.2s ease',\n  '&:hover': {\n    color: theme.palette.text.primary,\n  },\n}))\n\n// =============================================================================\n// HELPERS\n// =============================================================================\n\nconst formatDateForInput = (date) => date.toISOString().split('T')[0]\n\nconst getDatePresets = () => {\n  const today = new Date()\n  const startOfWeek = new Date(today)\n  startOfWeek.setDate(today.getDate() - today.getDay())\n  const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1)\n  const startOfLastMonth = new Date(today.getFullYear(), today.getMonth() - 1, 1)\n  const endOfLastMonth = new Date(today.getFullYear(), today.getMonth(), 0)\n\n  return {\n    today: {\n      label: 'Today',\n      start: formatDateForInput(today),\n      end: formatDateForInput(today),\n    },\n    thisWeek: {\n      label: 'This Week',\n      start: formatDateForInput(startOfWeek),\n      end: formatDateForInput(today),\n    },\n    thisMonth: {\n      label: 'This Month',\n      start: formatDateForInput(startOfMonth),\n      end: formatDateForInput(today),\n    },\n    lastMonth: {\n      label: 'Last Month',\n      start: formatDateForInput(startOfLastMonth),\n      end: formatDateForInput(endOfLastMonth),\n    },\n  }\n}\n\n// =============================================================================\n// HELPERS\n// =============================================================================\n\n/** Download a file via fetch+blob — works in both browser and Tauri webview. */\nfunction downloadFile(url, filename) {\n  fetch(url)\n    .then((res) => {\n      if (!res.ok) throw new Error(`Download failed: ${res.status}`)\n      return res.blob()\n    })\n    .then((blob) => {\n      const blobUrl = URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = blobUrl\n      a.download = filename || 'download'\n      document.body.appendChild(a)\n      a.click()\n      document.body.removeChild(a)\n      URL.revokeObjectURL(blobUrl)\n    })\n    .catch((err) => console.error('[download]', err))\n}\n\n// =============================================================================\n// MAIN COMPONENT\n// =============================================================================\n\nexport default function ReportsPage() {\n  const theme = useTheme()\n  const [searchParams] = useSearchParams()\n  const navigate = useNavigateInteraction()\n  const toast = useToast()\n  const { execute } = useInteraction()\n  const handleNavigate = useCallback(\n    (path, label, intent = {}) =>\n      navigate(path, { label, intent: { from: 'reports', ...intent } }),\n    [navigate]\n  )\n\n  const templates = useAppStore((s) => s.templates)\n  const activeConnection = useAppStore((s) => s.activeConnection)\n  const setActiveConnectionId = useAppStore((s) => s.setActiveConnectionId)\n  const setTemplates = useAppStore((s) => s.setTemplates)\n\n  const [selectedTemplate, setSelectedTemplate] = useState(searchParams.get('template') || '')\n  const [startDate, setStartDate] = useState('')\n  const [endDate, setEndDate] = useState('')\n  const [datePreset, setDatePreset] = useState('thisMonth')\n  const [keyValues, setKeyValues] = useState({})\n  const [loading, setLoading] = useState(false)\n  const [generating, setGenerating] = useState(false)\n  const [result, setResult] = useState(null)\n  const [error, setError] = useState(null)\n  const [keyOptions, setKeyOptions] = useState({})\n  const [discovering, setDiscovering] = useState(false)\n  const [discovery, setDiscovery] = useState(null)\n  const [selectedBatches, setSelectedBatches] = useState([])\n  const [historyLoading, setHistoryLoading] = useState(false)\n  const [runHistory, setRunHistory] = useState([])\n  const [selectedRun, setSelectedRun] = useState(null)\n  const [runSummary, setRunSummary] = useState(null)\n  const [summaryLoading, setSummaryLoading] = useState(false)\n  const [queueingSummary, setQueueingSummary] = useState(false)\n  const [batchDiscoveryOpen, setBatchDiscoveryOpen] = useState(false)\n  const [expandedRunId, setExpandedRunId] = useState(null)\n\n  const selectedTemplateInfo = templates.find((t) => t.id === selectedTemplate)\n  const outputLabel = selectedTemplateInfo?.kind?.toUpperCase() || 'PDF'\n\n  // Success celebration\n  const { celebrating, celebrate, onComplete: onCelebrationComplete } = useCelebration()\n\n  // Refs to prevent race conditions\n  const keyOptionsRequestIdRef = useRef(0)\n  const summaryRequestIdRef = useRef(0)\n\n  // Auto-select first template when templates are loaded but none selected\n  useEffect(() => {\n    if (!selectedTemplate && templates.length > 0) {\n      setSelectedTemplate(templates[0].id)\n    }\n  }, [templates, selectedTemplate])\n\n  useEffect(() => {\n    const fetchTemplates = async () => {\n      setLoading(true)\n      try {\n        const data = await api.listApprovedTemplates()\n        setTemplates(data)\n      } catch (err) {\n        toast.show(err.message || 'Failed to load designs', 'error')\n      } finally {\n        setLoading(false)\n      }\n    }\n    if (templates.length === 0) {\n      fetchTemplates()\n    }\n  }, [templates.length, setTemplates, toast])\n\n  useEffect(() => {\n    const fetchKeyOptions = async () => {\n      if (!selectedTemplate || !activeConnection?.id) return\n\n      const requestId = ++keyOptionsRequestIdRef.current\n\n      try {\n        const template = templates.find((t) => t.id === selectedTemplate)\n        const result = await api.fetchTemplateKeyOptions(selectedTemplate, {\n          connectionId: activeConnection.id,\n          kind: template?.kind || 'pdf',\n        })\n\n        if (requestId === keyOptionsRequestIdRef.current) {\n          setKeyOptions(result.keys || {})\n        }\n      } catch (err) {\n        if (requestId === keyOptionsRequestIdRef.current) {\n          console.error('Failed to fetch key options:', err)\n          toast.show('Could not load filter options. You can still generate reports.', 'warning')\n        }\n      }\n    }\n    fetchKeyOptions()\n  }, [selectedTemplate, activeConnection?.id, templates, toast])\n\n  const handleTemplateChange = useCallback((event) => {\n    setSelectedTemplate(event.target.value)\n    setKeyValues({})\n    setResult(null)\n    setDiscovery(null)\n    setSelectedBatches([])\n  }, [])\n\n  const handleAiSelectTemplate = useCallback((template) => {\n    if (template?.id) {\n      setSelectedTemplate(template.id)\n      setKeyValues({})\n      setResult(null)\n      toast.show(`Selected: ${template.name || template.id}`, 'success')\n    }\n  }, [toast])\n\n  const handleKeyValueChange = useCallback((key, value) => {\n    setKeyValues((prev) => ({\n      ...prev,\n      [key]: value,\n    }))\n  }, [])\n\n  const handleDatePreset = useCallback((presetKey) => {\n    setDatePreset(presetKey)\n    if (presetKey !== 'custom') {\n      const presets = getDatePresets()\n      const preset = presets[presetKey]\n      if (preset) {\n        setStartDate(preset.start)\n        setEndDate(preset.end)\n      }\n    }\n  }, [])\n\n  // Initialize dates on first render\n  useEffect(() => {\n    if (!startDate && !endDate && datePreset !== 'custom') {\n      const presets = getDatePresets()\n      const preset = presets[datePreset]\n      if (preset) {\n        setStartDate(preset.start)\n        setEndDate(preset.end)\n      }\n    }\n  }, []) // eslint-disable-line react-hooks/exhaustive-deps\n\n  const handleGenerate = useCallback(async () => {\n    if (!selectedTemplate || !activeConnection?.id) {\n      toast.show('Please select a design and connect to a data source first', 'error')\n      return\n    }\n    if (discovery && selectedBatches.length === 0) {\n      toast.show('Select at least one batch to run', 'error')\n      return\n    }\n    if (startDate && endDate && new Date(startDate) > new Date(endDate)) {\n      toast.show('Start date must be before or equal to end date', 'error')\n      return\n    }\n\n    await execute({\n      type: InteractionType.EXECUTE,\n      label: 'Generate report',\n      reversibility: Reversibility.SYSTEM_MANAGED,\n      suppressSuccessToast: true,\n      suppressErrorToast: true,\n      intent: {\n        templateId: selectedTemplate,\n        connectionId: activeConnection?.id,\n        action: 'run_report',\n      },\n      action: async () => {\n        setGenerating(true)\n        setError(null)\n        setResult(null)\n\n        try {\n          const template = templates.find((t) => t.id === selectedTemplate)\n\n          const batches = discovery?.batches || []\n          const allSelected = batches.length > 0 && selectedBatches.length === batches.length\n          const useSelectedBatches = batches.length > 0 && selectedBatches.length > 0 && !allSelected\n\n          const reportResult = await api.runReportAsJob({\n            templateId: selectedTemplate,\n            templateName: template?.name,\n            connectionId: activeConnection.id,\n            startDate: startDate || undefined,\n            endDate: endDate || undefined,\n            keyValues: Object.keys(keyValues).length > 0 ? keyValues : undefined,\n            batchIds: useSelectedBatches ? selectedBatches : undefined,\n            kind: template?.kind || 'pdf',\n            xlsx: template?.kind === 'excel',\n          })\n\n          setResult(reportResult)\n          toast.show('Report generation started!', 'success')\n          celebrate()\n          return reportResult\n        } catch (err) {\n          setError(err.message || 'Failed to generate report')\n          toast.show(err.message || 'Failed to generate report', 'error')\n          throw err\n        } finally {\n          setGenerating(false)\n        }\n      },\n    })\n  }, [selectedTemplate, activeConnection?.id, templates, startDate, endDate, keyValues, discovery, selectedBatches, toast, celebrate, execute])\n\n  const keyFields = Object.keys(keyOptions)\n\n  const handleDiscover = useCallback(async () => {\n    if (!selectedTemplate || !activeConnection?.id) {\n      toast.show('Select a design and data source first', 'error')\n      return\n    }\n    if (!startDate || !endDate) {\n      toast.show('Provide a start and end date to discover batches', 'error')\n      return\n    }\n    if (new Date(startDate) > new Date(endDate)) {\n      toast.show('Start date must be before or equal to end date', 'error')\n      return\n    }\n    await execute({\n      type: InteractionType.ANALYZE,\n      label: 'Discover batches',\n      reversibility: Reversibility.SYSTEM_MANAGED,\n      suppressSuccessToast: true,\n      suppressErrorToast: true,\n      intent: {\n        templateId: selectedTemplate,\n        connectionId: activeConnection?.id,\n        action: 'discover_batches',\n      },\n      action: async () => {\n        setDiscovering(true)\n        setDiscovery(null)\n        try {\n          const template = templates.find((t) => t.id === selectedTemplate)\n          const data = await api.discoverReports({\n            templateId: selectedTemplate,\n            connectionId: activeConnection.id,\n            startDate,\n            endDate,\n            keyValues: Object.keys(keyValues).length > 0 ? keyValues : undefined,\n            kind: template?.kind || 'pdf',\n          })\n          setDiscovery(data)\n          const batchIds = Array.isArray(data?.batches) ? data.batches.map((batch) => batch.id) : []\n          setSelectedBatches(batchIds)\n          return data\n        } catch (err) {\n          toast.show(err.message || 'Failed to discover batches', 'error')\n          throw err\n        } finally {\n          setDiscovering(false)\n        }\n      },\n    })\n  }, [selectedTemplate, activeConnection?.id, startDate, endDate, keyValues, templates, toast, execute])\n\n  const fetchRunHistory = useCallback(async () => {\n    setHistoryLoading(true)\n    try {\n      // Fetch all recent runs (not filtered by template) so runs don't\n      // vanish when the auto-selected template changes after page refresh.\n      const runs = await api.listReportRuns({ limit: 10 })\n      setRunHistory(runs)\n    } catch (err) {\n      console.error('Failed to load run history:', err)\n      toast.show('Failed to load run history', 'warning')\n    } finally {\n      setHistoryLoading(false)\n    }\n  }, [toast])\n\n  useEffect(() => {\n    fetchRunHistory()\n  }, [fetchRunHistory])\n\n  const toggleBatch = useCallback((batchId) => {\n    setSelectedBatches((prev) => {\n      if (prev.includes(batchId)) {\n        return prev.filter((id) => id !== batchId)\n      }\n      return [...prev, batchId]\n    })\n  }, [])\n\n  const handleSelectRun = useCallback(async (run) => {\n    // Toggle: clicking the same run collapses it\n    if (selectedRun?.id === run.id) {\n      setSelectedRun(null)\n      setExpandedRunId(null)\n      setRunSummary(null)\n      return\n    }\n\n    setSelectedRun(run)\n    setExpandedRunId(run.id)\n    setRunSummary(null)\n\n    if (run?.id) {\n      const requestId = ++summaryRequestIdRef.current\n\n      setSummaryLoading(true)\n      try {\n        const summaryData = await summaryApi.getReportSummary(run.id)\n\n        if (requestId === summaryRequestIdRef.current) {\n          setRunSummary(summaryData.summary || summaryData)\n        }\n      } catch (err) {\n        if (requestId === summaryRequestIdRef.current) {\n          console.error('Failed to fetch summary:', err)\n          setRunSummary(null)\n        }\n      } finally {\n        if (requestId === summaryRequestIdRef.current) {\n          setSummaryLoading(false)\n        }\n      }\n    }\n  }, [selectedRun?.id])\n\n  const handleQueueSummary = useCallback(async () => {\n    if (!selectedRun?.id) return\n    await execute({\n      type: InteractionType.GENERATE,\n      label: 'Queue summary',\n      reversibility: Reversibility.SYSTEM_MANAGED,\n      suppressSuccessToast: true,\n      suppressErrorToast: true,\n      intent: {\n        runId: selectedRun?.id,\n        action: 'queue_report_summary',\n      },\n      action: async () => {\n        setQueueingSummary(true)\n        try {\n          const response = await summaryApi.queueReportSummary(selectedRun.id)\n          const jobId = response?.job_id || response?.jobId || null\n          if (jobId) {\n            toast.show('Summary queued. Track progress in Report Progress.', 'success')\n          } else {\n            toast.show('Failed to queue summary.', 'error')\n          }\n          return response\n        } catch (err) {\n          toast.show(err?.message || 'Failed to queue summary.', 'error')\n          throw err\n        } finally {\n          setQueueingSummary(false)\n        }\n      },\n    })\n  }, [selectedRun?.id, toast, execute])\n\n  const handleSelectAllBatches = useCallback(() => {\n    const allIds = Array.isArray(discovery?.batches) ? discovery.batches.map((batch) => batch.id) : []\n    setSelectedBatches(allIds)\n  }, [discovery])\n\n  const handleClearBatches = useCallback(() => {\n    setSelectedBatches([])\n  }, [])\n\n  // =========================================================================\n  // RENDER\n  // =========================================================================\n\n  return (\n    <Box sx={{ minHeight: '100vh', p: 3, bgcolor: 'background.default' }}>\n      <SuccessCelebration trigger={celebrating} onComplete={onCelebrationComplete} />\n      <Container maxWidth=\"lg\">\n        <PageHeader\n          title=\"Run a Report\"\n          description=\"Choose a design, set your date range, and generate a report.\"\n          actions={\n            <SecondaryButton\n              variant=\"outlined\"\n              startIcon={<ScheduleIcon />}\n              disabled={!selectedTemplate || generating}\n              onClick={() =>\n                handleNavigate(`/schedules?template=${selectedTemplate}`, 'Open schedules', {\n                  templateId: selectedTemplate,\n                })\n              }\n            >\n              Schedule\n            </SecondaryButton>\n          }\n        />\n\n        <Stack spacing={3}>\n\n          {/* ── CARD 1: Design & Data Source ── */}\n          <GlassCard>\n            <SectionLabel>\n              <DescriptionIcon sx={{ fontSize: 14 }} />\n              Design & Data Source\n            </SectionLabel>\n\n            <Stack direction={{ xs: 'column', md: 'row' }} spacing={2}>\n              {/* Report Design */}\n              <Box sx={{ flex: 1 }}>\n                <StyledFormControl fullWidth>\n                  <InputLabel>Report Design</InputLabel>\n                  <Select\n                    value={selectedTemplate}\n                    onChange={handleTemplateChange}\n                    label=\"Report Design\"\n                  >\n                    {templates.map((template) => (\n                      <MenuItem key={template.id} value={template.id}>\n                        <Stack direction=\"row\" alignItems=\"center\" spacing={1}>\n                          <span>{template.name || template.id}</span>\n                          <Chip\n                            label={template.kind?.toUpperCase() || 'PDF'}\n                            size=\"small\"\n                            variant=\"outlined\"\n                            sx={{ borderRadius: 6, fontSize: '10px', height: 20 }}\n                          />\n                        </Stack>\n                      </MenuItem>\n                    ))}\n                  </Select>\n                </StyledFormControl>\n              </Box>\n\n              {/* Data Source */}\n              <Box sx={{ flex: 1 }}>\n                <ConnectionSelector\n                  value={activeConnection?.id || ''}\n                  onChange={(connId) => setActiveConnectionId(connId)}\n                  label=\"Data Source\"\n                  showStatus\n                />\n                {!activeConnection && (\n                  <Typography variant=\"caption\" color=\"warning.main\" sx={{ mt: 0.75, display: 'block' }}>\n                    No data source selected.{' '}\n                    <Typography\n                      component=\"span\"\n                      variant=\"caption\"\n                      sx={{ color: 'primary.main', cursor: 'pointer', textDecoration: 'underline' }}\n                      onClick={() => handleNavigate('/connections', 'Open connections')}\n                    >\n                      Add one\n                    </Typography>\n                  </Typography>\n                )}\n              </Box>\n            </Stack>\n\n            {/* AI Template Picker — tucked inside, not top-level */}\n            <Box sx={{ mt: 2 }}>\n              <TemplateRecommender onSelectTemplate={handleAiSelectTemplate} />\n            </Box>\n          </GlassCard>\n\n          {/* ── CARD 2: Time Period & Filters ── */}\n          <GlassCard>\n            <SectionLabel>\n              <TodayIcon sx={{ fontSize: 14 }} />\n              Time Period\n            </SectionLabel>\n\n            {/* Date preset chips */}\n            <Stack direction=\"row\" spacing={1} sx={{ mb: 2, flexWrap: 'wrap', gap: 1 }}>\n              {Object.entries(getDatePresets()).map(([key, preset]) => (\n                <PresetChip\n                  key={key}\n                  label={preset.label}\n                  icon={<TodayIcon sx={{ fontSize: 14 }} />}\n                  onClick={() => handleDatePreset(key)}\n                  selected={datePreset === key}\n                  variant={datePreset === key ? 'filled' : 'outlined'}\n                />\n              ))}\n              <PresetChip\n                label=\"Custom\"\n                icon={<DateRangeIcon sx={{ fontSize: 14 }} />}\n                onClick={() => handleDatePreset('custom')}\n                selected={datePreset === 'custom'}\n                variant={datePreset === 'custom' ? 'filled' : 'outlined'}\n              />\n            </Stack>\n\n            {/* Date inputs */}\n            <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2}>\n              <StyledTextField\n                label=\"Start Date\"\n                type=\"date\"\n                value={startDate}\n                onChange={(e) => {\n                  setStartDate(e.target.value)\n                  setDatePreset('custom')\n                }}\n                InputLabelProps={{ shrink: true }}\n                fullWidth\n                size=\"small\"\n              />\n              <StyledTextField\n                label=\"End Date\"\n                type=\"date\"\n                value={endDate}\n                onChange={(e) => {\n                  setEndDate(e.target.value)\n                  setDatePreset('custom')\n                }}\n                InputLabelProps={{ shrink: true }}\n                fullWidth\n                size=\"small\"\n              />\n            </Stack>\n\n            {/* Key field filters (conditional) */}\n            {keyFields.length > 0 && (\n              <Box sx={{ mt: 3 }}>\n                <Divider sx={{ mb: 2, borderColor: alpha(theme.palette.divider, 0.2) }} />\n                <SectionLabel>\n                  <FilterListIcon sx={{ fontSize: 14 }} />\n                  Filter Parameters\n                </SectionLabel>\n                <Stack spacing={2}>\n                  {keyFields.map((key) => (\n                    <StyledFormControl key={key} fullWidth size=\"small\">\n                      <InputLabel>{key}</InputLabel>\n                      <Select\n                        value={keyValues[key] || ''}\n                        onChange={(e) => handleKeyValueChange(key, e.target.value)}\n                        label={key}\n                      >\n                        <MenuItem value=\"\">\n                          <em>All</em>\n                        </MenuItem>\n                        {(keyOptions[key] || []).map((option) => (\n                          <MenuItem key={option} value={option}>\n                            {option}\n                          </MenuItem>\n                        ))}\n                      </Select>\n                    </StyledFormControl>\n                  ))}\n                </Stack>\n              </Box>\n            )}\n          </GlassCard>\n\n          {/* ── ACTION BAR ── */}\n          <Box>\n            {/* Error alert */}\n            {error && (\n              <Alert\n                severity=\"error\"\n                sx={{ mb: 2, borderRadius: 1 }}\n                onClose={() => setError(null)}\n                action={\n                  <TextButton color=\"inherit\" size=\"small\" onClick={handleGenerate} disabled={generating}>\n                    Try Again\n                  </TextButton>\n                }\n              >\n                {error}\n              </Alert>\n            )}\n\n            {/* Generating progress */}\n            {generating && (\n              <Box sx={{ mb: 2 }}>\n                <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 1 }}>\n                  Generating report...\n                </Typography>\n                <StyledLinearProgress />\n              </Box>\n            )}\n\n            {/* Success result */}\n            {result && (\n              <Alert severity=\"success\" sx={{ mb: 2, borderRadius: 1 }}>\n                <Stack direction=\"row\" spacing={2} alignItems=\"center\" flexWrap=\"wrap\">\n                  <Typography variant=\"body2\">\n                    Report started! ID: {result.job_id?.slice(0, 8)}...\n                  </Typography>\n                  <SecondaryButton\n                    size=\"small\"\n                    variant=\"outlined\"\n                    onClick={() => handleNavigate('/jobs', 'Open jobs')}\n                  >\n                    View Progress\n                  </SecondaryButton>\n                </Stack>\n              </Alert>\n            )}\n\n            {/* Primary action row */}\n            <Stack direction=\"row\" spacing={2} alignItems=\"center\" justifyContent=\"flex-end\">\n              <Typography variant=\"caption\" color=\"text.secondary\" sx={{ flex: 1 }}>\n                Reports run in the background.{' '}\n                <Typography\n                  component=\"span\"\n                  variant=\"caption\"\n                  sx={{ color: 'primary.main', cursor: 'pointer', textDecoration: 'underline' }}\n                  onClick={() => handleNavigate('/jobs', 'Open jobs')}\n                >\n                  Track progress\n                </Typography>\n              </Typography>\n              <PrimaryButton\n                startIcon={<PlayArrowIcon />}\n                onClick={handleGenerate}\n                disabled={!selectedTemplate || !activeConnection || generating}\n                sx={{ px: 4, py: 1.5 }}\n              >\n                Generate Report\n              </PrimaryButton>\n            </Stack>\n          </Box>\n\n          {/* ── ADVANCED: Batch Discovery (collapsed by default) ── */}\n          <Box>\n            <AdvancedToggle onClick={() => setBatchDiscoveryOpen((prev) => !prev)}>\n              <Stack direction=\"row\" spacing={1} alignItems=\"center\">\n                <FilterListIcon sx={{ fontSize: 16 }} />\n                <Typography variant=\"subtitle2\" fontWeight={500}>\n                  Advanced: Find Data Batches\n                </Typography>\n              </Stack>\n              {batchDiscoveryOpen ? (\n                <ExpandLessIcon sx={{ fontSize: 20 }} />\n              ) : (\n                <ExpandMoreIcon sx={{ fontSize: 20 }} />\n              )}\n            </AdvancedToggle>\n\n            <Collapse in={batchDiscoveryOpen}>\n              <GlassCard sx={{ mt: 1 }}>\n                <Stack spacing={2}>\n                  <Stack direction=\"row\" spacing={1} alignItems=\"center\" justifyContent=\"space-between\">\n                    <Typography variant=\"body2\" color=\"text.secondary\">\n                      Discover available data batches for the selected design and date range.\n                    </Typography>\n                    <SecondaryButton\n                      variant=\"outlined\"\n                      size=\"small\"\n                      onClick={handleDiscover}\n                      disabled={discovering || !selectedTemplate || !activeConnection}\n                    >\n                      {discovering ? 'Searching...' : 'Find Batches'}\n                    </SecondaryButton>\n                  </Stack>\n\n                  {discovering && <StyledLinearProgress />}\n\n                  {!discovering && discovery && (\n                    <Stack spacing={2}>\n                      <Stack direction=\"row\" spacing={1} alignItems=\"center\">\n                        <DiscoveryChip label={`${discovery.batches_count || discovery.batches?.length || 0} batches`} />\n                        <DiscoveryChip label={`${discovery.rows_total || 0} rows`} />\n                      </Stack>\n                      <Stack direction=\"row\" spacing={1}>\n                        <TextButton size=\"small\" onClick={handleSelectAllBatches}>Select all</TextButton>\n                        <TextButton size=\"small\" onClick={handleClearBatches}>Clear</TextButton>\n                      </Stack>\n                      <BatchListContainer>\n                        <List dense disablePadding>\n                          {(discovery.batches || []).map((batch) => (\n                            <BatchListItem\n                              key={batch.id}\n                              disableGutters\n                              onClick={() => toggleBatch(batch.id)}\n                              selected={selectedBatches.includes(batch.id)}\n                            >\n                              <Checkbox\n                                checked={selectedBatches.includes(batch.id)}\n                                sx={{ p: 0.5, mr: 1 }}\n                              />\n                              <ListItemText\n                                primary={`${batch.id}`}\n                                secondary={`${batch.rows || 0} rows`}\n                                primaryTypographyProps={{ variant: 'body2', fontWeight: 500 }}\n                                secondaryTypographyProps={{ variant: 'caption' }}\n                              />\n                            </BatchListItem>\n                          ))}\n                        </List>\n                      </BatchListContainer>\n                    </Stack>\n                  )}\n                </Stack>\n              </GlassCard>\n            </Collapse>\n          </Box>\n\n          {/* ── RECENT RUNS (full-width) ── */}\n          <Box>\n            <Stack direction=\"row\" spacing={1} alignItems=\"center\" justifyContent=\"space-between\" sx={{ mb: 2 }}>\n              <SectionLabel sx={{ mb: 0, flex: 1 }}>\n                <RefreshIcon sx={{ fontSize: 14 }} />\n                Recent Runs\n              </SectionLabel>\n              <TextButton\n                size=\"small\"\n                onClick={fetchRunHistory}\n                disabled={historyLoading}\n                startIcon={<RefreshIcon sx={{ fontSize: 14 }} />}\n              >\n                Refresh\n              </TextButton>\n            </Stack>\n\n            {historyLoading && <StyledLinearProgress sx={{ mb: 2 }} />}\n\n            {!historyLoading && runHistory.length === 0 && (\n              <Box sx={{ py: 4, textAlign: 'center' }}>\n                <DescriptionIcon sx={{ fontSize: 48, color: 'text.disabled', mb: 1 }} />\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  {selectedTemplate\n                    ? 'No recent runs for this design yet.'\n                    : 'No report runs yet. Generate a report to get started.'}\n                </Typography>\n              </Box>\n            )}\n\n            {/* Run history grid: 2 per row on desktop, 1 on mobile */}\n            <Box\n              sx={{\n                display: 'grid',\n                gridTemplateColumns: { xs: '1fr', md: '1fr 1fr' },\n                gap: 2,\n              }}\n            >\n              {runHistory.map((run) => (\n                <Box key={run.id}>\n                  <RunHistoryCard\n                    selected={selectedRun?.id === run.id}\n                    onClick={() => handleSelectRun(run)}\n                    title=\"Click to view summary\"\n                  >\n                    <Stack spacing={0.5}>\n                      <Stack direction=\"row\" alignItems=\"center\" justifyContent=\"space-between\">\n                        <Typography variant=\"body2\" fontWeight={600}>\n                          {run.templateName || run.templateId}\n                        </Typography>\n                        <Stack\n                          direction=\"row\"\n                          alignItems=\"center\"\n                          spacing={0.5}\n                          className=\"view-summary-hint\"\n                          sx={{ opacity: 0.6, transition: 'all 0.2s' }}\n                        >\n                          <Typography variant=\"caption\" color=\"text.secondary\">\n                            {selectedRun?.id === run.id ? 'Collapse' : 'Summary'}\n                          </Typography>\n                          <ArrowForwardIcon\n                            sx={{\n                              fontSize: 12,\n                              transform: selectedRun?.id === run.id ? 'rotate(90deg)' : 'none',\n                              transition: 'transform 0.2s',\n                            }}\n                          />\n                        </Stack>\n                      </Stack>\n                      <Typography variant=\"caption\" color=\"text.secondary\">\n                        {new Date(run.createdAt).toLocaleString()} &middot; {run.startDate} to {run.endDate}\n                      </Typography>\n                      <Stack direction=\"row\" spacing={1} sx={{ mt: 0.5 }} flexWrap=\"wrap\" useFlexGap>\n                        {run.artifacts?.pdf_url && (\n                          <DownloadButton\n                            size=\"small\"\n                            variant=\"outlined\"\n                            startIcon={<DownloadIcon sx={{ fontSize: 14 }} />}\n                            onClick={(e) => { e.stopPropagation(); downloadFile(api.withBase(run.artifacts.pdf_url), `${run.templateName || 'report'}.pdf`) }}\n                          >\n                            PDF\n                          </DownloadButton>\n                        )}\n                        {run.artifacts?.html_url && (\n                          <DownloadButton\n                            size=\"small\"\n                            variant=\"outlined\"\n                            startIcon={<DownloadIcon sx={{ fontSize: 14 }} />}\n                            onClick={(e) => { e.stopPropagation(); downloadFile(api.withBase(run.artifacts.html_url), `${run.templateName || 'report'}.html`) }}\n                          >\n                            HTML\n                          </DownloadButton>\n                        )}\n                        {run.artifacts?.xlsx_url && (\n                          <DownloadButton\n                            size=\"small\"\n                            variant=\"outlined\"\n                            startIcon={<TableChartIcon sx={{ fontSize: 14 }} />}\n                            onClick={(e) => { e.stopPropagation(); downloadFile(api.withBase(run.artifacts.xlsx_url), `${run.templateName || 'report'}.xlsx`) }}\n                          >\n                            XLSX\n                          </DownloadButton>\n                        )}\n                        {run.artifacts?.docx_url && (\n                          <DownloadButton\n                            size=\"small\"\n                            variant=\"outlined\"\n                            startIcon={<ArticleIcon sx={{ fontSize: 14 }} />}\n                            onClick={(e) => { e.stopPropagation(); downloadFile(api.withBase(run.artifacts.docx_url), `${run.templateName || 'report'}.docx`) }}\n                          >\n                            DOCX\n                          </DownloadButton>\n                        )}\n                        <DownloadButton\n                          size=\"small\"\n                          variant=\"outlined\"\n                          startIcon={<SmartToyIcon sx={{ fontSize: 14 }} />}\n                          onClick={(e) => {\n                            e.stopPropagation()\n                            handleNavigate(`/agents?analyzeRunId=${run.id}`, 'Analyze with AI', { runId: run.id })\n                          }}\n                          data-testid={`analyze-ai-${run.id}`}\n                        >\n                          Analyze\n                        </DownloadButton>\n                      </Stack>\n                    </Stack>\n                  </RunHistoryCard>\n\n                  {/* Expanded inline AI summary */}\n                  <Collapse in={expandedRunId === run.id}>\n                    <Box sx={{ mt: 1, ml: 2, pl: 2, borderLeft: 2, borderColor: 'divider' }}>\n                      <AiUsageNotice\n                        title=\"AI summary\"\n                        description=\"Summaries are generated from the selected report run. Review before sharing.\"\n                        chips={[\n                          { label: 'Source: Selected run', color: 'info', variant: 'outlined' },\n                          { label: 'Confidence: Review required', color: 'warning', variant: 'outlined' },\n                        ]}\n                        dense\n                        sx={{ mb: 1.5 }}\n                      />\n                      {summaryLoading && <StyledLinearProgress sx={{ mb: 1 }} />}\n                      {!summaryLoading && runSummary ? (\n                        <Paper\n                          sx={{\n                            p: 2,\n                            borderRadius: 1.5,\n                            bgcolor: theme.palette.mode === 'dark'\n                              ? alpha(theme.palette.text.primary, 0.04)\n                              : neutral[50],\n                            border: 1,\n                            borderColor: 'divider',\n                          }}\n                        >\n                          <Typography variant=\"body2\" sx={{ whiteSpace: 'pre-wrap' }}>\n                            {typeof runSummary === 'string'\n                              ? runSummary\n                              : runSummary.text || runSummary.content || 'No summary available'}\n                          </Typography>\n                          {runSummary.key_points && (\n                            <Box sx={{ mt: 1.5 }}>\n                              <Typography variant=\"caption\" fontWeight={600} color=\"text.primary\">\n                                Key Points:\n                              </Typography>\n                              <ul style={{ margin: '4px 0', paddingLeft: 20 }}>\n                                {runSummary.key_points.map((point, idx) => (\n                                  <li key={idx}>\n                                    <Typography variant=\"caption\">{point}</Typography>\n                                  </li>\n                                ))}\n                              </ul>\n                            </Box>\n                          )}\n                        </Paper>\n                      ) : !summaryLoading && (\n                        <Stack spacing={1}>\n                          <Typography variant=\"body2\" color=\"text.secondary\">\n                            No summary available for this run.\n                          </Typography>\n                          <SecondaryButton\n                            size=\"small\"\n                            variant=\"outlined\"\n                            startIcon={<AutoAwesomeIcon sx={{ fontSize: 14 }} />}\n                            onClick={handleQueueSummary}\n                            disabled={queueingSummary}\n                            sx={{ alignSelf: 'flex-start' }}\n                          >\n                            {queueingSummary ? 'Queueing...' : 'Generate summary'}\n                          </SecondaryButton>\n                        </Stack>\n                      )}\n                    </Box>\n                  </Collapse>\n                </Box>\n              ))}\n            </Box>\n          </Box>\n\n        </Stack>\n      </Container>\n    </Box>\n  )\n}\n","import { useInteraction } from '@/components/ux/governance'\nimport ReportsPageContainer from '@/features/reports/containers/ReportsPageContainer'\n\nexport default function ReportsPage() {\n  useInteraction()\n  return <ReportsPageContainer />\n}\n"],"names":["DateRangeIcon","createSvgIcon","_jsx","TodayIcon","KIND_ICONS","PictureAsPdfIcon","TableChartIcon","TemplateRecommender","onSelectTemplate","execute","useInteraction","expanded","setExpanded","useState","requirement","setRequirement","loading","setLoading","queueing","setQueueing","recommendations","setRecommendations","error","setError","toast","useToast","executeUI","useCallback","label","action","intent","InteractionType","Reversibility","handleSearch","trimmed","results","recommendTemplates","normalized","err","handleQueue","response","queueRecommendTemplates","handleSelect","template","handleKeyDown","e","jsxs","Paper","Box","prev","Stack","jsx","Avatar","theme","neutral","AutoAwesomeIcon","Typography","Tooltip","IconButton","ExpandLessIcon","ExpandMoreIcon","Collapse","TextField","Button","CircularProgress","ScheduleIcon","LinearProgress","Alert","rec","idx","kind","Icon","score","alpha","Chip","CheckIcon","example","SectionLabel","styled","StyledTextField","PresetChip","prop","selected","DiscoveryChip","BatchListContainer","BatchListItem","ListItem","PrimaryButton","SecondaryButton","TextButton","RunHistoryCard","StyledLinearProgress","DownloadButton","AdvancedToggle","formatDateForInput","date","getDatePresets","today","startOfWeek","startOfMonth","startOfLastMonth","endOfLastMonth","downloadFile","url","filename","res","blob","blobUrl","a","ReportsPage","useTheme","searchParams","useSearchParams","navigate","useNavigateInteraction","handleNavigate","path","templates","useAppStore","s","activeConnection","setActiveConnectionId","setTemplates","selectedTemplate","setSelectedTemplate","startDate","setStartDate","endDate","setEndDate","datePreset","setDatePreset","keyValues","setKeyValues","generating","setGenerating","result","setResult","keyOptions","setKeyOptions","discovering","setDiscovering","discovery","setDiscovery","selectedBatches","setSelectedBatches","historyLoading","setHistoryLoading","runHistory","setRunHistory","selectedRun","setSelectedRun","runSummary","setRunSummary","summaryLoading","setSummaryLoading","queueingSummary","setQueueingSummary","batchDiscoveryOpen","setBatchDiscoveryOpen","expandedRunId","setExpandedRunId","celebrating","celebrate","onCelebrationComplete","useCelebration","keyOptionsRequestIdRef","useRef","summaryRequestIdRef","useEffect","fetchTemplates","data","api.listApprovedTemplates","requestId","t","api.fetchTemplateKeyOptions","handleTemplateChange","event","handleAiSelectTemplate","handleKeyValueChange","key","value","handleDatePreset","presetKey","preset","handleGenerate","batches","allSelected","useSelectedBatches","reportResult","api.runReportAsJob","keyFields","handleDiscover","api.discoverReports","batchIds","batch","fetchRunHistory","runs","api.listReportRuns","toggleBatch","batchId","id","handleSelectRun","run","summaryData","summaryApi.getReportSummary","handleQueueSummary","summaryApi.queueReportSummary","handleSelectAllBatches","allIds","handleClearBatches","SuccessCelebration","Container","PageHeader","GlassCard","DescriptionIcon","StyledFormControl","InputLabel","Select","MenuItem","ConnectionSelector","connId","Divider","FilterListIcon","option","PlayArrowIcon","List","Checkbox","ListItemText","RefreshIcon","ArrowForwardIcon","DownloadIcon","api.withBase","ArticleIcon","SmartToyIcon","AiUsageNotice","point","ReportsPageContainer"],"mappings":"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","x_google_ignoreList":[0,1]}