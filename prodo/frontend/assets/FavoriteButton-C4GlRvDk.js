import{e as b,u as g,r,ap as j,aq as F,ar as C,R as L,I as k,j as i,n as w,o as B,k as n,as as z,p as A}from"./index-B8Eu23bA.js";import{D}from"./Star-BdvflhJ9.js";import{S as _}from"./StarBorder-fpAfr7cR.js";function G({entityType:s,entityId:a,initialFavorite:o,onToggle:p,size:v="small"}){const t=b(),{execute:x}=g(),[c,f]=r.useState(o??!1),[u,h]=r.useState(!1),[E,d]=r.useState(o!==void 0);r.useEffect(()=>{if(E||!a)return;let l=!1;return j(s,a).then(e=>{l||(f(e.isFavorite),d(!0))}).catch(()=>{l||d(!0)}),()=>{l=!0}},[s,a,E]),r.useEffect(()=>{o!==void 0&&(f(o),d(!0))},[o]);const S=r.useCallback(async l=>{if(l.stopPropagation(),u||!a)return;h(!0);const e=!c;f(e);try{await x({type:e?k.CREATE:k.DELETE,label:e?"Add favorite":"Remove favorite",reversibility:L.FULLY_REVERSIBLE,suppressSuccessToast:!0,suppressErrorToast:!0,blocksNavigation:!1,intent:{entityType:s,entityId:a,action:e?"favorite_add":"favorite_remove"},action:async()=>{try{e?await F(s,a):await C(s,a),p?.(e)}catch(R){throw f(!e),R}}})}finally{h(!1)}},[s,a,c,u,p,x]),m=v==="small"?18:22;return i.jsx(w,{title:c?"Remove from favorites":"Add to favorites",children:i.jsx(B,{size:v,onClick:S,disabled:u,sx:{color:c?t.palette.mode==="dark"?n[600]:n[1200]:t.palette.text.secondary,transition:"all 0.2s ease","&:hover":{color:t.palette.mode==="dark"?n[600]:n[1200],bgcolor:t.palette.mode==="dark"?A(t.palette.text.primary,.08):n[300],transform:"scale(1.1)"}},children:u?i.jsx(z,{size:m-4,sx:{color:t.palette.text.secondary}}):c?i.jsx(D,{sx:{fontSize:m}}):i.jsx(_,{sx:{fontSize:m}})})})}export{G as F};
