import{e as L,d as J,b as P,u as M,r as s,bq as U,R as Y,I as q,br as G,j as t,B as f,T as x,S as I,as as R,q as K,a1 as X,ai as E,aj as $,a3 as c,bs as D,J as g,o as B,k,p as r,an as Q,ag as V,x as Z,W as ee,w as te,D as oe,v as ae,bt as ne,K as O}from"./index-B8Eu23bA.js";import{D as re}from"./Star-BdvflhJ9.js";import{C as se}from"./ConfirmModal-Bm9QL03g.js";import"./CheckCircleOutline-BKKyaL-x.js";import"./WarningAmber-DtVJgAFk.js";const w=O`
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
`,ie=O`
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.05); opacity: 0.8; }
`,le=g(f)(({theme:e})=>({padding:e.spacing(3),maxWidth:1e3,margin:"0 auto",width:"100%",minHeight:"100vh",backgroundColor:e.palette.background.default})),ce=g(I)(({theme:e})=>({marginBottom:e.spacing(3),animation:`${w} 0.5s ease-out`})),de=g(I)(({theme:e})=>({marginBottom:e.spacing(3),animation:`${w} 0.5s ease-out 0.1s both`})),pe=g(f)(({theme:e})=>({backgroundColor:r(e.palette.background.paper,.8),backdropFilter:"blur(20px)",borderRadius:8,border:`1px solid ${r(e.palette.divider,.1)}`,padding:e.spacing(2),boxShadow:`0 8px 32px ${r(e.palette.common.black,.08)}`,animation:`${w} 0.5s ease-out 0.2s both`})),z=g(Q)(({theme:e})=>({minWidth:150,"& .MuiOutlinedInput-root":{borderRadius:8,backgroundColor:r(e.palette.background.paper,.6),backdropFilter:"blur(8px)",transition:"all 0.2s ease","&:hover":{backgroundColor:r(e.palette.background.paper,.8)},"&.Mui-focused":{backgroundColor:e.palette.background.paper,boxShadow:`0 0 0 3px ${r(e.palette.text.primary,.08)}`},"& .MuiOutlinedInput-notchedOutline":{borderColor:r(e.palette.divider,.15)}},"& .MuiInputLabel-root":{color:e.palette.text.secondary}})),ue=g(B)(({theme:e})=>({borderRadius:8,transition:"all 0.2s ease","&:hover":{backgroundColor:e.palette.mode==="dark"?r(e.palette.text.primary,.08):k[300],transform:"rotate(180deg)"}})),xe=g(B)(({theme:e})=>({borderRadius:8,transition:"all 0.2s ease","&:hover":{backgroundColor:e.palette.mode==="dark"?r(e.palette.text.primary,.08):k[300],color:e.palette.text.primary}})),fe=g(f)(({theme:e})=>({padding:e.spacing(6),textAlign:"center",animation:`${w} 0.5s ease-out`})),ge={template:e=>`/templates/${e}/edit`,connection:()=>"/connections",job:()=>"/jobs",schedule:()=>"/schedules"},F={template:oe,connection:te,job:ee,schedule:Z,favorite:re,settings:V,default:D},ye=(e,n)=>{const o={created:{color:e.palette.text.secondary},deleted:{color:e.palette.text.secondary},updated:{color:e.palette.text.secondary},completed:{color:e.palette.text.secondary},failed:{color:e.palette.text.secondary},started:{color:e.palette.text.secondary},favorite_added:{color:e.palette.text.secondary},favorite_removed:{color:e.palette.text.secondary},default:{color:e.palette.text.secondary}};return o[n]||o.default};function me(e){if(!e)return"";const n=new Date(e),d=new Date-n,i=Math.floor(d/6e4),p=Math.floor(d/36e5),u=Math.floor(d/864e5);return i<1?"Just now":i<60?`${i}m ago`:p<24?`${p}h ago`:u<7?`${u}d ago`:n.toLocaleDateString()}function he(e){return(e||"").replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase())}function be({activity:e,onNavigate:n}){const o=L(),d=e.entity_type||"default",i=String(d).toLowerCase().replace(/s$/,""),p=e.action||"",u=String(p).toLowerCase(),j=F[i]||F.default,m=ye(o,p).color,y=e.details?.url||null,h=ge[i],l=!u.includes("deleted")&&(h||y),A=()=>{if(l&&n){const C=h?h(e.entity_id):y;C&&n(C)}};return t.jsxs(f,{onClick:A,sx:{display:"flex",alignItems:"flex-start",gap:2,py:2,borderBottom:`1px solid ${r(o.palette.divider,.06)}`,"&:last-child":{borderBottom:"none"},cursor:l?"pointer":"default",borderRadius:1,mx:-1,px:1,transition:"all 0.2s ease","&:hover":l?{bgcolor:o.palette.mode==="dark"?r(o.palette.text.primary,.04):k[200],transform:"translateX(4px)"}:{}},children:[t.jsx(f,{sx:{width:36,height:36,borderRadius:1,bgcolor:r(m,.15),display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transition:"transform 0.2s ease",".MuiBox-root:hover > &":l?{animation:`${ie} 0.5s ease`}:{}},children:t.jsx(j,{sx:{fontSize:16,color:m}})}),t.jsxs(f,{sx:{flex:1,minWidth:0},children:[t.jsxs(I,{direction:"row",alignItems:"center",spacing:1,sx:{mb:.5},children:[t.jsx(x,{sx:{fontSize:"0.8125rem",fontWeight:500,color:o.palette.text.primary},children:he(p)}),t.jsx(ae,{label:i,size:"small",sx:{height:18,fontSize:"0.625rem",bgcolor:o.palette.mode==="dark"?r(o.palette.text.primary,.08):k[300],color:o.palette.text.secondary,borderRadius:1}})]}),e.entity_name&&t.jsx(x,{sx:{fontSize:"0.8125rem",color:o.palette.text.secondary,mb:.5},children:e.entity_name}),e.entity_id&&!e.entity_name&&t.jsxs(x,{sx:{fontSize:"0.75rem",color:o.palette.text.disabled,fontFamily:"monospace",mb:.5},children:[e.entity_id.slice(0,20),"..."]}),t.jsx(x,{sx:{fontSize:"0.6875rem",color:o.palette.text.disabled},children:me(e.timestamp)})]}),l&&t.jsx(ne,{sx:{fontSize:14,color:o.palette.text.disabled,opacity:0,transition:"opacity 0.2s ease",".MuiBox-root:hover > &":{opacity:1}}})]})}function je(){const e=L(),n=J(),o=P(),{execute:d}=M(),i=s.useRef(!1),p=s.useCallback((a,S,H={})=>o(a,{label:S,intent:{from:"activity",...H}}),[o]),[u,j]=s.useState([]),[v,m]=s.useState(!0),[y,h]=s.useState(""),[l,A]=s.useState(""),[C,T]=s.useState(!1),[N,_]=s.useState(!1),b=s.useCallback(async()=>{m(!0);try{const a=await U({limit:100,entityType:y||void 0,action:l||void 0});j(a?.activities||[])}catch(a){n.show(a.message||"Failed to load activity log","error")}finally{m(!1)}},[y,l,n]);s.useEffect(()=>{i.current||(i.current=!0,b())},[b]),s.useEffect(()=>{i.current&&b()},[y,l,b]);const W=s.useCallback(async()=>{await d({type:q.DELETE,label:"Clear activity log",reversibility:Y.SYSTEM_MANAGED,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{action:"clear_activity_log"},action:async()=>{_(!0);try{const a=await G();return j([]),n.show(`Cleared ${a.cleared} activity entries`,"success"),a}catch(a){throw n.show(a.message||"Failed to clear activity log","error"),a}finally{_(!1),T(!1)}}})},[n,d]);return t.jsxs(le,{children:[t.jsxs(ce,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[t.jsxs(f,{children:[t.jsx(x,{variant:"h5",fontWeight:600,sx:{color:e.palette.text.primary},children:"Activity Log"}),t.jsx(x,{variant:"body2",sx:{color:e.palette.text.secondary},children:"Track actions and events in your workspace"})]}),t.jsxs(I,{direction:"row",spacing:1,children:[t.jsx(ue,{onClick:b,disabled:v,sx:{color:e.palette.text.secondary},children:v?t.jsx(R,{size:20}):t.jsx(K,{})}),t.jsx(xe,{onClick:()=>T(!0),disabled:u.length===0,sx:{color:e.palette.text.secondary},children:t.jsx(X,{})})]})]}),t.jsxs(de,{direction:"row",spacing:2,children:[t.jsxs(z,{size:"small",children:[t.jsx(E,{children:"Entity Type"}),t.jsxs($,{value:y,onChange:a=>h(a.target.value),label:"Entity Type",children:[t.jsx(c,{value:"",children:"All"}),t.jsx(c,{value:"template",children:"Template"}),t.jsx(c,{value:"connection",children:"Connection"}),t.jsx(c,{value:"job",children:"Job"}),t.jsx(c,{value:"schedule",children:"Schedule"})]})]}),t.jsxs(z,{size:"small",children:[t.jsx(E,{children:"Action"}),t.jsxs($,{value:l,onChange:a=>A(a.target.value),label:"Action",children:[t.jsx(c,{value:"",children:"All"}),t.jsx(c,{value:"favorite_added",children:"Favorite added"}),t.jsx(c,{value:"favorite_removed",children:"Favorite removed"}),t.jsx(c,{value:"template_deleted",children:"Template deleted"}),t.jsx(c,{value:"job_cancelled",children:"Job cancelled"})]})]})]}),t.jsx(pe,{children:v?t.jsx(f,{sx:{py:4,textAlign:"center"},children:t.jsx(R,{size:32})}):u.length===0?t.jsxs(fe,{children:[t.jsx(D,{sx:{fontSize:48,color:e.palette.text.disabled,mb:2}}),t.jsx(x,{sx:{fontSize:"0.875rem",color:e.palette.text.secondary},children:"No activity recorded yet"}),t.jsx(x,{sx:{fontSize:"0.75rem",color:e.palette.text.disabled,mt:.5},children:"Actions like creating templates, running jobs, and more will appear here"})]}):u.map(a=>t.jsx(be,{activity:a,onNavigate:S=>p(S,"Open activity item",{route:S,activityId:a.id})},a.id))}),t.jsx(se,{open:C,onClose:()=>T(!1),onConfirm:W,title:"Clear Activity Log",message:"Are you sure you want to clear all activity log entries? This action cannot be undone.",confirmLabel:"Clear All",severity:"warning",loading:N})]})}function we(){return M(),t.jsx(je,{})}export{we as default};
