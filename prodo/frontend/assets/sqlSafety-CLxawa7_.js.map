{"version":3,"file":"sqlSafety-CLxawa7_.js","sources":["../../../home/rohith/desktop/NeuraReport/frontend/src/utils/sqlSafety.js"],"sourcesContent":["const WRITE_KEYWORDS = [\n  'insert',\n  'update',\n  'delete',\n  'drop',\n  'alter',\n  'create',\n  'truncate',\n  'replace',\n  'merge',\n  'grant',\n  'revoke',\n  'comment',\n  'rename',\n  'vacuum',\n  'attach',\n  'detach',\n]\n\nconst WRITE_PATTERN = new RegExp(`\\\\b(${WRITE_KEYWORDS.join('|')})\\\\b`, 'i')\n\nconst stripSql = (sql) => {\n  if (!sql) return ''\n  let out = ''\n  let inSingle = false\n  let inDouble = false\n  let inLineComment = false\n  let inBlockComment = false\n\n  for (let i = 0; i < sql.length; i += 1) {\n    const ch = sql[i]\n    const next = sql[i + 1]\n\n    if (inLineComment) {\n      if (ch === '\\n') {\n        inLineComment = false\n        out += ' '\n      }\n      continue\n    }\n\n    if (inBlockComment) {\n      if (ch === '*' && next === '/') {\n        inBlockComment = false\n        i += 1\n        out += ' '\n      }\n      continue\n    }\n\n    if (!inSingle && !inDouble) {\n      if (ch === '-' && next === '-') {\n        inLineComment = true\n        i += 1\n        continue\n      }\n      if (ch === '/' && next === '*') {\n        inBlockComment = true\n        i += 1\n        continue\n      }\n    }\n\n    if (!inDouble && ch === \"'\") {\n      inSingle = !inSingle\n      out += ' '\n      continue\n    }\n\n    if (!inSingle && ch === '\"') {\n      inDouble = !inDouble\n      out += ' '\n      continue\n    }\n\n    if (inSingle || inDouble) {\n      out += ' '\n      continue\n    }\n\n    out += ch\n  }\n\n  return out\n}\n\nexport const getWriteOperation = (sql = '') => {\n  const cleaned = stripSql(sql)\n  const match = cleaned.match(WRITE_PATTERN)\n  return match ? match[1].toLowerCase() : null\n}\n\nexport const isWriteQuery = (sql = '') => Boolean(getWriteOperation(sql))\n"],"names":["WRITE_KEYWORDS","WRITE_PATTERN","stripSql","sql","out","inSingle","inDouble","inLineComment","inBlockComment","i","ch","next","getWriteOperation","match"],"mappings":"AAAA,MAAMA,EAAiB,CACrB,SACA,SACA,SACA,OACA,QACA,SACA,WACA,UACA,QACA,QACA,SACA,UACA,SACA,SACA,SACA,QACF,EAEMC,EAAgB,IAAI,OAAO,OAAOD,EAAe,KAAK,GAAG,CAAC,OAAQ,GAAG,EAErEE,EAAYC,GAAQ,CACxB,GAAI,CAACA,EAAK,MAAO,GACjB,IAAIC,EAAM,GACNC,EAAW,GACXC,EAAW,GACXC,EAAgB,GAChBC,EAAiB,GAErB,QAASC,EAAI,EAAGA,EAAIN,EAAI,OAAQM,GAAK,EAAG,CACtC,MAAMC,EAAKP,EAAIM,CAAC,EACVE,EAAOR,EAAIM,EAAI,CAAC,EAEtB,GAAIF,EAAe,CACbG,IAAO;AAAA,IACTH,EAAgB,GAChBH,GAAO,KAET,QACF,CAEA,GAAII,EAAgB,CACdE,IAAO,KAAOC,IAAS,MACzBH,EAAiB,GACjBC,GAAK,EACLL,GAAO,KAET,QACF,CAEA,GAAI,CAACC,GAAY,CAACC,EAAU,CAC1B,GAAII,IAAO,KAAOC,IAAS,IAAK,CAC9BJ,EAAgB,GAChBE,GAAK,EACL,QACF,CACA,GAAIC,IAAO,KAAOC,IAAS,IAAK,CAC9BH,EAAiB,GACjBC,GAAK,EACL,QACF,CACF,CAEA,GAAI,CAACH,GAAYI,IAAO,IAAK,CAC3BL,EAAW,CAACA,EACZD,GAAO,IACP,QACF,CAEA,GAAI,CAACC,GAAYK,IAAO,IAAK,CAC3BJ,EAAW,CAACA,EACZF,GAAO,IACP,QACF,CAEA,GAAIC,GAAYC,EAAU,CACxBF,GAAO,IACP,QACF,CAEAA,GAAOM,CACT,CAEA,OAAON,CACT,EAEaQ,EAAoB,CAACT,EAAM,KAAO,CAE7C,MAAMU,EADUX,EAASC,CAAG,EACN,MAAMF,CAAa,EACzC,OAAOY,EAAQA,EAAM,CAAC,EAAE,YAAW,EAAK,IAC1C"}