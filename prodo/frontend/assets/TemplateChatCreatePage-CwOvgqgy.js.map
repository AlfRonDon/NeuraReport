{"version":3,"file":"TemplateChatCreatePage-CwOvgqgy.js","sources":["../../src/features/templates/containers/TemplateChatCreateContainer.jsx","../../src/pages/templates/TemplateChatCreatePage.jsx"],"sourcesContent":["import { useState, useCallback, useEffect, useRef } from 'react'\nimport {\n  Box,\n  Stack,\n  Typography,\n  Button,\n  TextField,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Breadcrumbs,\n  Link,\n  Alert,\n  Paper,\n  Chip,\n  IconButton,\n  ToggleButton,\n  ToggleButtonGroup,\n} from '@mui/material'\nimport NavigateNextIcon from '@mui/icons-material/NavigateNext'\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack'\nimport SaveIcon from '@mui/icons-material/Save'\nimport AutoAwesomeIcon from '@mui/icons-material/AutoAwesome'\nimport UploadFileIcon from '@mui/icons-material/UploadFile'\nimport PictureAsPdfIcon from '@mui/icons-material/PictureAsPdf'\nimport TableChartIcon from '@mui/icons-material/TableChart'\nimport CloseIcon from '@mui/icons-material/Close'\nimport { Link as RouterLink, useSearchParams } from 'react-router-dom'\n\nimport Surface from '@/components/layout/Surface.jsx'\nimport ConnectionSelector from '@/components/common/ConnectionSelector'\nimport { useToast } from '@/components/ToastProvider.jsx'\nimport {\n  useInteraction,\n  InteractionType,\n  Reversibility,\n  useNavigateInteraction,\n} from '@/components/ux/governance'\nimport { useAppStore } from '@/stores'\nimport { useTemplateChatStore } from '@/stores/templateChatStore'\nimport { chatTemplateCreate, createTemplateFromChat, mappingPreview, mappingApprove } from '@/api/client'\nimport TemplateChatEditor from '@/features/generate/containers/TemplateChatEditor.jsx'\nimport { neutral } from '@/app/theme'\n\nconst MAX_PDF_SIZE_MB = 10\n\nconst SESSION_KEY = '__chat_create__'\n\nexport default function TemplateChatCreateContainer() {\n  const navigate = useNavigateInteraction()\n  const toast = useToast()\n  const { execute } = useInteraction()\n  const addTemplate = useAppStore((s) => s.addTemplate)\n  const setTemplateId = useAppStore((s) => s.setTemplateId)\n  const lastUsedConnectionId = useAppStore((s) => s.lastUsed?.connectionId || null)\n  const activeConnection = useAppStore((s) => s.activeConnection)\n  const setActiveConnectionId = useAppStore((s) => s.setActiveConnectionId)\n  const deleteSession = useTemplateChatStore((s) => s.deleteSession)\n  const [searchParams] = useSearchParams()\n  const fromWizard = searchParams.get('from') === 'wizard'\n  const wizardConnectionId = searchParams.get('connectionId') || null\n  const [selectedConnectionId, setSelectedConnectionId] = useState(\n    wizardConnectionId || lastUsedConnectionId || activeConnection?.id || ''\n  )\n\n  const addAssistantMessage = useTemplateChatStore((s) => s.addAssistantMessage)\n\n  const [currentHtml, setCurrentHtml] = useState('')\n  const [previewUrl, setPreviewUrl] = useState(null)\n  const [nameDialogOpen, setNameDialogOpen] = useState(false)\n  const [templateName, setTemplateName] = useState('')\n  const [creating, setCreating] = useState(false)\n  const [samplePdf, setSamplePdf] = useState(null) // { file: File, name, size }\n  const [templateKind, setTemplateKind] = useState('pdf')\n  const fileInputRef = useRef(null)\n\n  // Mapping phase state — shown after template save\n  const [savedTemplateId, setSavedTemplateId] = useState(null)\n  const [savedTemplateKind, setSavedTemplateKind] = useState('pdf')\n  const [savedTemplateName, setSavedTemplateName] = useState('')\n  const [mappingPreviewData, setMappingPreviewData] = useState(null)\n  const [mappingApproving, setMappingApproving] = useState(false)\n\n  const handleFileSelect = useCallback((file) => {\n    if (!file) return\n    const pdfTypes = ['application/pdf']\n    const excelTypes = [\n      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n      'application/vnd.ms-excel',\n    ]\n    const allowedTypes = templateKind === 'excel' ? [...pdfTypes, ...excelTypes] : pdfTypes\n    const isExcelExt = /\\.(xlsx|xls)$/i.test(file.name)\n    if (!allowedTypes.includes(file.type) && !(templateKind === 'excel' && isExcelExt)) {\n      toast.show(templateKind === 'excel' ? 'Please upload a PDF or Excel file.' : 'Please upload a PDF file.', 'warning')\n      return\n    }\n    if (file.size > MAX_PDF_SIZE_MB * 1024 * 1024) {\n      toast.show(`File too large. Maximum size is ${MAX_PDF_SIZE_MB}MB.`, 'warning')\n      return\n    }\n    setSamplePdf({ file, name: file.name, size: file.size })\n    toast.show(`Sample file \"${file.name}\" attached. The AI will use this as a visual reference.`, 'info')\n  }, [toast, templateKind])\n\n  const handleDrop = useCallback((e) => {\n    e.preventDefault()\n    const file = e.dataTransfer?.files?.[0]\n    handleFileSelect(file)\n  }, [handleFileSelect])\n\n  const handleDragOver = useCallback((e) => {\n    e.preventDefault()\n  }, [])\n\n  const handleRemovePdf = useCallback(() => {\n    setSamplePdf(null)\n    if (fileInputRef.current) fileInputRef.current.value = ''\n  }, [])\n\n  // Update preview when HTML changes\n  useEffect(() => {\n    if (!currentHtml) {\n      setPreviewUrl(null)\n      return\n    }\n    const blob = new Blob([currentHtml], { type: 'text/html' })\n    const url = URL.createObjectURL(blob)\n    setPreviewUrl(url)\n    return () => URL.revokeObjectURL(url)\n  }, [currentHtml])\n\n  // Clean up session on unmount\n  useEffect(() => {\n    return () => {\n      // Don't clean up — let the user resume if they navigate back\n    }\n  }, [])\n\n  const handleHtmlUpdate = useCallback((html) => {\n    setCurrentHtml(html)\n  }, [])\n\n  const handleApplySuccess = useCallback((result) => {\n    // In create mode, \"apply\" just updates local state (nothing persisted yet)\n    if (result?.updated_html) {\n      setCurrentHtml(result.updated_html)\n    }\n  }, [])\n\n  const handleBack = useCallback(async () => {\n    const backTo = fromWizard ? '/setup?step=template' : '/templates'\n    await navigate(backTo, {\n      interaction: {\n        type: InteractionType.NAVIGATE,\n        label: fromWizard ? 'Back to wizard' : 'Back to templates',\n        reversibility: Reversibility.FULLY_REVERSIBLE,\n      },\n    })\n  }, [navigate, fromWizard])\n\n  const handleOpenNameDialog = useCallback(() => {\n    setNameDialogOpen(true)\n  }, [])\n\n  const handleCloseNameDialog = useCallback(() => {\n    setNameDialogOpen(false)\n  }, [])\n\n  const handleCreateTemplate = useCallback(async () => {\n    const name = templateName.trim()\n    if (!name) {\n      toast.show('Please enter a template name.', 'warning')\n      return\n    }\n    if (!currentHtml) {\n      toast.show('No template HTML to save. Continue the conversation to generate a template first.', 'warning')\n      return\n    }\n\n    await execute({\n      type: InteractionType.CREATE,\n      label: 'Create template from chat',\n      reversibility: Reversibility.SYSTEM_MANAGED,\n      suppressSuccessToast: true,\n      suppressErrorToast: true,\n      intent: {\n        action: 'create_template_from_chat',\n        name,\n      },\n      action: async () => {\n        setCreating(true)\n        try {\n          const result = await createTemplateFromChat(name, currentHtml, templateKind)\n          const templateId = result?.template_id\n          const kind = result?.kind || 'pdf'\n\n          // Add to store and set as active template\n          if (templateId) {\n            addTemplate({\n              id: templateId,\n              name,\n              kind,\n              status: 'draft',\n              artifacts: {},\n              tags: [],\n            })\n            setTemplateId(templateId)\n          }\n\n          setNameDialogOpen(false)\n\n          // Run mapping preview and show in chat for user review\n          const connId = selectedConnectionId || wizardConnectionId || lastUsedConnectionId\n          if (templateId && connId) {\n            // Save template details for mapping phase\n            setSavedTemplateId(templateId)\n            setSavedTemplateKind(kind)\n            setSavedTemplateName(name)\n\n            toast.show(`Template \"${name}\" saved! Fetching data mapping suggestions...`, 'info')\n            addAssistantMessage(\n              SESSION_KEY,\n              `Template \"${name}\" has been saved successfully! Now let's configure how your template fields map to your database columns. Fetching mapping suggestions...`\n            )\n\n            try {\n              const preview = await mappingPreview(templateId, connId, { kind })\n              const mapping = preview?.mapping || preview?.auto_mapping || {}\n\n              if (Object.keys(mapping).length > 0) {\n                // Show the mapping review panel in the chat\n                setMappingPreviewData(preview)\n                addAssistantMessage(\n                  SESSION_KEY,\n                  `I've auto-mapped ${Object.keys(mapping).length} template fields to your database columns. Review the mapping below — you can click any value to change it, or type in the chat to discuss changes.`\n                )\n              } else {\n                toast.show(`Template \"${name}\" saved. No auto-mapping available — you can configure mapping later.`, 'info')\n                addAssistantMessage(\n                  SESSION_KEY,\n                  `Template saved, but I couldn't generate auto-mapping suggestions. You can configure mapping manually from the template editor.`\n                )\n                // Navigate away since no mapping to review\n                navigateToTemplate(templateId, name, kind)\n              }\n            } catch (mapErr) {\n              console.warn('Mapping preview failed:', mapErr)\n              toast.show(`Template \"${name}\" saved. Mapping preview failed — you can map manually later.`, 'warning')\n              addAssistantMessage(\n                SESSION_KEY,\n                `Template saved! Auto-mapping encountered an issue, but you can configure it from the template editor.`\n              )\n              navigateToTemplate(templateId, name, kind)\n            }\n          } else {\n            toast.show(`Template \"${name}\" created successfully.`, 'success')\n            addAssistantMessage(\n              SESSION_KEY,\n              `Template \"${name}\" has been saved! Connect a database to enable field mapping.`\n            )\n            // No connection — navigate away\n            deleteSession(SESSION_KEY)\n            navigateToTemplate(templateId, name, kind)\n          }\n        } catch (err) {\n          toast.show(String(err.message || err), 'error')\n          throw err\n        } finally {\n          setCreating(false)\n        }\n      },\n    })\n  }, [templateName, currentHtml, execute, addTemplate, setTemplateId, deleteSession, toast, navigate, fromWizard, wizardConnectionId, lastUsedConnectionId, addAssistantMessage])\n\n  // Navigate to template editor (after save or after mapping)\n  const navigateToTemplate = useCallback(async (templateId, name, kind) => {\n    deleteSession(SESSION_KEY)\n    if (fromWizard) {\n      try {\n        const wizardRaw = sessionStorage.getItem('neurareport_wizard_state')\n        const wizardData = wizardRaw ? JSON.parse(wizardRaw) : {}\n        wizardData.templateId = templateId\n        wizardData.templateKind = kind\n        wizardData.templateName = name\n        sessionStorage.setItem('neurareport_wizard_state', JSON.stringify(wizardData))\n      } catch (_) { /* ignore storage errors */ }\n\n      await navigate('/setup?step=mapping', {\n        interaction: {\n          type: InteractionType.NAVIGATE,\n          label: 'Continue to mapping',\n          reversibility: Reversibility.FULLY_REVERSIBLE,\n        },\n      })\n    } else {\n      await navigate(`/templates/${templateId}/edit`, {\n        state: { from: '/templates', editMode: 'chat' },\n        interaction: {\n          type: InteractionType.NAVIGATE,\n          label: 'Open new template editor',\n          reversibility: Reversibility.FULLY_REVERSIBLE,\n        },\n      })\n    }\n  }, [deleteSession, fromWizard, navigate])\n\n  // Handle mapping approval from the chat panel\n  const handleMappingApprove = useCallback(async (finalMapping) => {\n    if (!savedTemplateId) return\n    setMappingApproving(true)\n    try {\n      const connId = selectedConnectionId || wizardConnectionId || lastUsedConnectionId\n      addAssistantMessage(SESSION_KEY, 'Building contract and generator assets... This may take a moment.')\n      toast.show('Approving mapping and building contract...', 'info')\n      await mappingApprove(savedTemplateId, finalMapping, {\n        connectionId: connId,\n        kind: savedTemplateKind,\n      })\n      toast.show(`Template \"${savedTemplateName}\" is report-ready!`, 'success')\n      addAssistantMessage(SESSION_KEY, `Mapping approved and contract built! Template \"${savedTemplateName}\" is now report-ready. Redirecting...`)\n      // Short delay so user sees the success message\n      setTimeout(() => {\n        navigateToTemplate(savedTemplateId, savedTemplateName, savedTemplateKind)\n      }, 1500)\n    } catch (err) {\n      console.error('Mapping approve failed:', err)\n      toast.show('Mapping approval failed. You can retry or map later from the editor.', 'error')\n      addAssistantMessage(SESSION_KEY, `Mapping approval encountered an error: ${err.message || err}. You can try again or skip to map later.`)\n    } finally {\n      setMappingApproving(false)\n    }\n  }, [savedTemplateId, savedTemplateKind, savedTemplateName, wizardConnectionId, lastUsedConnectionId, toast, addAssistantMessage, navigateToTemplate])\n\n  // Handle \"Skip — Map Later\"\n  const handleMappingSkip = useCallback(() => {\n    if (!savedTemplateId) return\n    toast.show(`Template \"${savedTemplateName}\" saved. You can configure mapping from the editor.`, 'info')\n    navigateToTemplate(savedTemplateId, savedTemplateName, savedTemplateKind)\n  }, [savedTemplateId, savedTemplateName, savedTemplateKind, toast, navigateToTemplate])\n\n  // Handle \"Queue & Continue\" — fire-and-forget the approval and navigate away\n  const handleMappingQueue = useCallback(() => {\n    if (!savedTemplateId) return\n    const connId = selectedConnectionId || wizardConnectionId || lastUsedConnectionId\n    // Fire the approval in the background — don't await\n    mappingApprove(savedTemplateId, mappingPreviewData?.mapping || {}, {\n      connectionId: connId,\n      kind: savedTemplateKind,\n    }).then(() => {\n      // Silently succeeds in background\n    }).catch((err) => {\n      console.warn('Background mapping approval failed:', err)\n    })\n    toast.show(`Mapping approval queued for \"${savedTemplateName}\". You can check progress from the template editor.`, 'info')\n    navigateToTemplate(savedTemplateId, savedTemplateName, savedTemplateKind)\n  }, [savedTemplateId, savedTemplateName, savedTemplateKind, wizardConnectionId, lastUsedConnectionId, mappingPreviewData, toast, navigateToTemplate])\n\n  // Wrap the chatApi to match (messages, html) signature, passing sample PDF and kind\n  const chatApi = useCallback((messages, html) => {\n    return chatTemplateCreate(messages, html, samplePdf?.file || null, templateKind)\n  }, [samplePdf, templateKind])\n\n  return (\n    <Box sx={{ display: 'flex', flexDirection: 'column', flex: '1 1 0', minHeight: 0, overflow: 'hidden' }}>\n      {/* Breadcrumb */}\n      <Box sx={{ mb: 1, flexShrink: 0 }}>\n        <Breadcrumbs separator={<NavigateNextIcon fontSize=\"small\" />} aria-label=\"breadcrumb\">\n          <Link\n            component={RouterLink}\n            to=\"/templates\"\n            underline=\"hover\"\n            color=\"text.secondary\"\n            sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}\n          >\n            Templates\n          </Link>\n          <Typography color=\"text.primary\" fontWeight={600}>\n            Create with AI\n          </Typography>\n        </Breadcrumbs>\n      </Box>\n\n      <Surface sx={{ gap: { xs: 1.5, md: 2 }, flex: '1 1 0', minHeight: 0, overflow: 'hidden' }}>\n        {/* Header */}\n        <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\" spacing={1.5} sx={{ flexShrink: 0 }}>\n          <Stack direction=\"row\" spacing={1} alignItems=\"center\" sx={{ minWidth: 0 }}>\n            <AutoAwesomeIcon sx={{ color: 'text.secondary', fontSize: 20 }} />\n            <Typography variant=\"h6\" fontWeight={600}>\n              Create Template with AI\n            </Typography>\n          </Stack>\n\n          <Stack direction=\"row\" spacing={1.5} alignItems=\"center\">\n            <ConnectionSelector\n              value={selectedConnectionId}\n              onChange={(connId) => {\n                setSelectedConnectionId(connId)\n                setActiveConnectionId(connId)\n              }}\n              label=\"Data Source\"\n              size=\"small\"\n              fullWidth={false}\n              sx={{ minWidth: 200 }}\n            />\n            <Button\n              variant=\"contained\"\n              onClick={handleOpenNameDialog}\n              disabled={!currentHtml}\n              startIcon={<SaveIcon />}\n              sx={{\n                textTransform: 'none',\n                fontWeight: 600,\n                bgcolor: neutral[900],\n                '&:hover': { bgcolor: neutral[700] },\n                '&.Mui-disabled': { bgcolor: neutral[300], color: neutral[500] },\n              }}\n            >\n              Save Template\n            </Button>\n            <Button\n              variant=\"outlined\"\n              onClick={handleBack}\n              startIcon={<ArrowBackIcon />}\n              sx={{ textTransform: 'none', fontWeight: 600 }}\n            >\n              Back\n            </Button>\n          </Stack>\n        </Stack>\n\n        {/* Sample PDF Upload — compact */}\n        {samplePdf ? (\n          <Paper\n            variant=\"outlined\"\n            sx={{\n              px: 1.5, py: 0.75,\n              display: 'flex',\n              alignItems: 'center',\n              gap: 1,\n              borderColor: 'primary.main',\n              bgcolor: 'primary.50',\n              flexShrink: 0,\n            }}\n          >\n            <PictureAsPdfIcon sx={{ color: 'error.main', fontSize: 20 }} />\n            <Typography variant=\"body2\" fontWeight={600} noWrap sx={{ flex: 1, minWidth: 0 }}>\n              {samplePdf.name}\n            </Typography>\n            <Chip label=\"Sample PDF\" size=\"small\" color=\"primary\" variant=\"outlined\" />\n            <IconButton size=\"small\" onClick={handleRemovePdf} title=\"Remove sample PDF\">\n              <CloseIcon fontSize=\"small\" />\n            </IconButton>\n          </Paper>\n        ) : (\n          <Paper\n            variant=\"outlined\"\n            onDrop={handleDrop}\n            onDragOver={handleDragOver}\n            onClick={() => fileInputRef.current?.click()}\n            sx={{\n              px: 1.5, py: 0.75,\n              display: 'flex',\n              alignItems: 'center',\n              gap: 1,\n              cursor: 'pointer',\n              borderStyle: 'dashed',\n              borderColor: 'divider',\n              '&:hover': { borderColor: 'primary.main', bgcolor: 'action.hover' },\n              transition: 'all 0.15s',\n              flexShrink: 0,\n            }}\n          >\n            <UploadFileIcon sx={{ color: 'text.secondary' }} />\n            <Box sx={{ flex: 1 }}>\n              <Typography variant=\"body2\" fontWeight={600}>\n                {templateKind === 'excel' ? 'Have a sample PDF or Excel file?' : 'Have a sample PDF?'}\n              </Typography>\n              <Typography variant=\"caption\" color=\"text.secondary\">\n                {templateKind === 'excel'\n                  ? 'Drop a PDF or Excel file here or click to upload. The AI will use it as a visual reference.'\n                  : 'Drop a PDF here or click to upload. The AI will use it as a visual reference for layout and styling.'}\n              </Typography>\n            </Box>\n            <Chip label=\"Optional\" size=\"small\" variant=\"outlined\" />\n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              accept={templateKind === 'excel' ? 'application/pdf,.xlsx,.xls' : 'application/pdf'}\n              hidden\n              onChange={(e) => handleFileSelect(e.target.files?.[0])}\n            />\n          </Paper>\n        )}\n\n        {/* Main content: Preview + Chat — fills remaining Surface space */}\n        <Box\n          sx={{\n            display: 'grid',\n            gridTemplateColumns: { xs: '1fr', md: '7fr 5fr' },\n            gap: 2,\n            flex: 1,\n            minHeight: 0,      /* allow shrinking within flex parent */\n          }}\n        >\n          {/* Left: Preview — full-width iframe with vertical scroll */}\n          <Box\n            sx={{\n              border: '1px solid',\n              borderColor: 'divider',\n              borderRadius: 1,\n              overflow: 'hidden',\n              bgcolor: 'background.paper',\n              display: 'flex',\n              flexDirection: 'column',\n              minHeight: 0,\n            }}\n          >\n            <Box\n              sx={{\n                p: 1.5,\n                borderBottom: '1px solid',\n                borderColor: 'divider',\n                bgcolor: 'background.default',\n                flexShrink: 0,\n              }}\n            >\n              <Typography variant=\"caption\" fontWeight={600} color=\"text.secondary\">\n                Template Preview\n              </Typography>\n            </Box>\n            <Box sx={{ flex: 1, minHeight: 0, overflow: 'auto' }}>\n              {previewUrl ? (\n                <iframe\n                  src={previewUrl}\n                  title=\"Template Preview\"\n                  style={{\n                    width: '100%',\n                    height: '100%',\n                    border: 'none',\n                    display: 'block',\n                    minHeight: 600,\n                  }}\n                />\n              ) : (\n                <Box\n                  sx={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    height: '100%',\n                    p: 4,\n                  }}\n                >\n                  <Alert severity=\"info\" variant=\"outlined\" sx={{ maxWidth: 400 }}>\n                    Start a conversation to generate a template. The preview will appear here as the AI creates your template.\n                  </Alert>\n                </Box>\n              )}\n            </Box>\n          </Box>\n\n          {/* Right: Chat — only this panel scrolls internally */}\n          <TemplateChatEditor\n            templateId={SESSION_KEY}\n            templateName=\"New Template\"\n            currentHtml={currentHtml}\n            onHtmlUpdate={handleHtmlUpdate}\n            onApplySuccess={handleApplySuccess}\n            onRequestSave={handleOpenNameDialog}\n            mappingPreviewData={mappingPreviewData}\n            mappingApproving={mappingApproving}\n            onMappingApprove={handleMappingApprove}\n            onMappingSkip={handleMappingSkip}\n            onMappingQueue={handleMappingQueue}\n            mode=\"create\"\n            chatApi={chatApi}\n          />\n        </Box>\n      </Surface>\n\n      {/* Name Dialog */}\n      <Dialog\n        open={nameDialogOpen}\n        onClose={handleCloseNameDialog}\n        maxWidth=\"sm\"\n        fullWidth\n        PaperProps={{ sx: { borderRadius: 2 } }}\n      >\n        <DialogTitle sx={{ fontWeight: 600 }}>\n          Name Your Template\n        </DialogTitle>\n        <DialogContent>\n          <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\n            Give your template a descriptive name. You can change this later.\n          </Typography>\n          <ToggleButtonGroup\n            value={templateKind}\n            exclusive\n            onChange={(_, newKind) => newKind && setTemplateKind(newKind)}\n            size=\"small\"\n            sx={{ mb: 2 }}\n          >\n            <ToggleButton value=\"pdf\">\n              <PictureAsPdfIcon sx={{ mr: 1, fontSize: 18 }} /> PDF Report\n            </ToggleButton>\n            <ToggleButton value=\"excel\">\n              <TableChartIcon sx={{ mr: 1, fontSize: 18 }} /> Excel Report\n            </ToggleButton>\n          </ToggleButtonGroup>\n          <TextField\n            autoFocus\n            fullWidth\n            label=\"Template Name\"\n            placeholder=\"e.g., Monthly Sales Invoice\"\n            value={templateName}\n            onChange={(e) => setTemplateName(e.target.value)}\n            onKeyDown={(e) => {\n              if (e.key === 'Enter' && templateName.trim()) {\n                handleCreateTemplate()\n              }\n            }}\n            disabled={creating}\n          />\n        </DialogContent>\n        <DialogActions sx={{ px: 3, pb: 2 }}>\n          <Button onClick={handleCloseNameDialog} disabled={creating}>\n            Cancel\n          </Button>\n          <Button\n            variant=\"contained\"\n            onClick={handleCreateTemplate}\n            disabled={!templateName.trim() || creating}\n            sx={{\n              bgcolor: neutral[900],\n              '&:hover': { bgcolor: neutral[700] },\n            }}\n          >\n            {creating ? 'Creating...' : 'Create Template'}\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </Box>\n  )\n}\n","import { useInteraction } from '@/components/ux/governance'\nimport TemplateChatCreateContainer from '@/features/templates/containers/TemplateChatCreateContainer'\n\nexport default function TemplateChatCreatePage() {\n  useInteraction()\n  return <TemplateChatCreateContainer />\n}\n"],"names":["MAX_PDF_SIZE_MB","SESSION_KEY","TemplateChatCreateContainer","navigate","useNavigateInteraction","toast","useToast","execute","useInteraction","addTemplate","useAppStore","s","setTemplateId","lastUsedConnectionId","activeConnection","setActiveConnectionId","deleteSession","useTemplateChatStore","searchParams","useSearchParams","fromWizard","wizardConnectionId","selectedConnectionId","setSelectedConnectionId","useState","addAssistantMessage","currentHtml","setCurrentHtml","previewUrl","setPreviewUrl","nameDialogOpen","setNameDialogOpen","templateName","setTemplateName","creating","setCreating","samplePdf","setSamplePdf","templateKind","setTemplateKind","fileInputRef","useRef","savedTemplateId","setSavedTemplateId","savedTemplateKind","setSavedTemplateKind","savedTemplateName","setSavedTemplateName","mappingPreviewData","setMappingPreviewData","mappingApproving","setMappingApproving","handleFileSelect","useCallback","file","pdfTypes","excelTypes","allowedTypes","isExcelExt","handleDrop","handleDragOver","handleRemovePdf","useEffect","blob","url","handleHtmlUpdate","html","handleApplySuccess","result","handleBack","InteractionType","Reversibility","handleOpenNameDialog","handleCloseNameDialog","handleCreateTemplate","name","createTemplateFromChat","templateId","kind","connId","preview","mappingPreview","mapping","navigateToTemplate","mapErr","err","wizardRaw","wizardData","handleMappingApprove","finalMapping","mappingApprove","handleMappingSkip","handleMappingQueue","chatApi","messages","chatTemplateCreate","jsxs","Box","jsx","Breadcrumbs","NavigateNextIcon","Link","RouterLink","Typography","Surface","Stack","AutoAwesomeIcon","ConnectionSelector","Button","SaveIcon","neutral","ArrowBackIcon","Paper","PictureAsPdfIcon","Chip","IconButton","CloseIcon","UploadFileIcon","Alert","TemplateChatEditor","Dialog","DialogTitle","DialogContent","ToggleButtonGroup","_","newKind","ToggleButton","TableChartIcon","TextField","DialogActions","TemplateChatCreatePage"],"mappings":"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"}