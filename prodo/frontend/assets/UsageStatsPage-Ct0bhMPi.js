import{bi as w,b5 as $e,r as P,e as me,d as Ge,u as Ne,b as Ye,a4 as Xe,h as qe,bv as Ze,bu as Qe,R as ke,I as Ae,k as s,j as t,B as _,as as Ce,T,S as K,ai as et,aj as tt,a3 as at,ah as rt,q as nt,W as xe,t as it,D as q,w as st,p as y,v as ot,O as lt,x as Se,Z as ct,J as G,an as dt,s as pt,o as ut,bw as Z,K as We}from"./index-B8Eu23bA.js";import{T as mt}from"./TrendingUp-ByVNVmvX.js";import{T as xt}from"./TrendingDown-BOjgHPM1.js";import{C as we}from"./BarChart-ClLuOAaO.js";import{G as A}from"./Grid-5L9Rvqba.js";import{a as he,T as ht}from"./Tabs-D_BhmpzR.js";import{a as Q,L as ne,x as ce,y as ae,C as fe,A as ft,b as ee,d as Oe,z as yt,c as Pe,h as bt,e as vt,u as gt,i as ve,G as jt,g as Te,j as ze,D as kt,o as At,X as de,Y as pe,p as Ct,R as ie,r as De,s as ye,T as se,v as be,P as Ee,w as Re,n as Le,t as Ie}from"./PieChart-BVneXJBn.js";import{a as Fe,C as St}from"./CardContent-xJVpuEbT.js";import"./KeyboardArrowRight-BOQXGjwe.js";import"./index-B21QI1NW.js";import"./index-Chjiymov.js";var wt=["layout","type","stroke","connectNulls","isRange","ref"],Ot=["key"],Ke;function re(e){"@babel/helpers - typeof";return re=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},re(e)}function Ue(e,r){if(e==null)return{};var n=Pt(e,r),a,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)a=l[i],!(r.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Pt(e,r){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(r.indexOf(a)>=0)continue;n[a]=e[a]}return n}function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Y.apply(this,arguments)}function _e(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function H(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?_e(Object(n),!0).forEach(function(a){N(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Tt(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Be(e,r){for(var n=0;n<r.length;n++){var a=r[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,Ve(a.key),a)}}function zt(e,r,n){return r&&Be(e.prototype,r),n&&Be(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dt(e,r,n){return r=ue(r),Et(e,Je()?Reflect.construct(r,n||[],ue(e).constructor):r.apply(e,n))}function Et(e,r){if(r&&(re(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rt(e)}function Rt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Je(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Je=function(){return!!e})()}function ue(e){return ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ue(e)}function Lt(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&ge(e,r)}function ge(e,r){return ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,i){return a.__proto__=i,a},ge(e,r)}function N(e,r,n){return r=Ve(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function Ve(e){var r=It(e,"string");return re(r)=="symbol"?r:r+""}function It(e,r){if(re(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(re(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var U=(function(e){function r(){var n;Tt(this,r);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return n=Dt(this,r,[].concat(i)),N(n,"state",{isAnimationFinished:!0}),N(n,"id",gt("recharts-area-")),N(n,"handleAnimationEnd",function(){var c=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),ve(c)&&c()}),N(n,"handleAnimationStart",function(){var c=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),ve(c)&&c()}),n}return Lt(r,e),zt(r,[{key:"renderDots",value:function(a,i,l){var c=this.props.isAnimationActive,o=this.state.isAnimationFinished;if(c&&!o)return null;var u=this.props,d=u.dot,h=u.points,x=u.dataKey,f=Q(this.props,!1),z=Q(d,!0),C=h.map(function(b,R){var O=H(H(H({key:"dot-".concat(R),r:3},f),z),{},{index:R,cx:b.x,cy:b.y,dataKey:x,value:b.value,payload:b.payload,points:h});return r.renderDotItem(d,O)}),E={clipPath:a?"url(#clipPath-".concat(i?"":"dots-").concat(l,")"):null};return w.createElement(ne,Y({className:"recharts-area-dots"},E),C)}},{key:"renderHorizontalRect",value:function(a){var i=this.props,l=i.baseLine,c=i.points,o=i.strokeWidth,u=c[0].x,d=c[c.length-1].x,h=a*Math.abs(u-d),x=ce(c.map(function(f){return f.y||0}));return ae(l)&&typeof l=="number"?x=Math.max(l,x):l&&Array.isArray(l)&&l.length&&(x=Math.max(ce(l.map(function(f){return f.y||0})),x)),ae(x)?w.createElement("rect",{x:u<d?u:u-h,y:0,width:h,height:Math.floor(x+(o?parseInt("".concat(o),10):1))}):null}},{key:"renderVerticalRect",value:function(a){var i=this.props,l=i.baseLine,c=i.points,o=i.strokeWidth,u=c[0].y,d=c[c.length-1].y,h=a*Math.abs(u-d),x=ce(c.map(function(f){return f.x||0}));return ae(l)&&typeof l=="number"?x=Math.max(l,x):l&&Array.isArray(l)&&l.length&&(x=Math.max(ce(l.map(function(f){return f.x||0})),x)),ae(x)?w.createElement("rect",{x:0,y:u<d?u:u-h,width:x+(o?parseInt("".concat(o),10):1),height:Math.floor(h)}):null}},{key:"renderClipRect",value:function(a){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(a):this.renderHorizontalRect(a)}},{key:"renderAreaStatically",value:function(a,i,l,c){var o=this.props,u=o.layout,d=o.type,h=o.stroke,x=o.connectNulls,f=o.isRange;o.ref;var z=Ue(o,wt);return w.createElement(ne,{clipPath:l?"url(#clipPath-".concat(c,")"):null},w.createElement(fe,Y({},Q(z,!0),{points:a,connectNulls:x,type:d,baseLine:i,layout:u,stroke:"none",className:"recharts-area-area"})),h!=="none"&&w.createElement(fe,Y({},Q(this.props,!1),{className:"recharts-area-curve",layout:u,type:d,connectNulls:x,fill:"none",points:a})),h!=="none"&&f&&w.createElement(fe,Y({},Q(this.props,!1),{className:"recharts-area-curve",layout:u,type:d,connectNulls:x,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(a,i){var l=this,c=this.props,o=c.points,u=c.baseLine,d=c.isAnimationActive,h=c.animationBegin,x=c.animationDuration,f=c.animationEasing,z=c.animationId,C=this.state,E=C.prevPoints,b=C.prevBaseLine;return w.createElement(ft,{begin:h,duration:x,isActive:d,easing:f,from:{t:0},to:{t:1},key:"area-".concat(z),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(R){var O=R.t;if(E){var $=E.length/o.length,g=o.map(function(v,L){var W=Math.floor(L*$);if(E[W]){var M=E[W],J=ee(M.x,v.x),V=ee(M.y,v.y);return H(H({},v),{},{x:J(O),y:V(O)})}return v}),S;if(ae(u)&&typeof u=="number"){var j=ee(b,u);S=j(O)}else if(Oe(u)||yt(u)){var B=ee(b,0);S=B(O)}else S=u.map(function(v,L){var W=Math.floor(L*$);if(b[W]){var M=b[W],J=ee(M.x,v.x),V=ee(M.y,v.y);return H(H({},v),{},{x:J(O),y:V(O)})}return v});return l.renderAreaStatically(g,S,a,i)}return w.createElement(ne,null,w.createElement("defs",null,w.createElement("clipPath",{id:"animationClipPath-".concat(i)},l.renderClipRect(O))),w.createElement(ne,{clipPath:"url(#animationClipPath-".concat(i,")")},l.renderAreaStatically(o,u,a,i)))})}},{key:"renderArea",value:function(a,i){var l=this.props,c=l.points,o=l.baseLine,u=l.isAnimationActive,d=this.state,h=d.prevPoints,x=d.prevBaseLine,f=d.totalLength;return u&&c&&c.length&&(!h&&f>0||!Pe(h,c)||!Pe(x,o))?this.renderAreaWithAnimation(a,i):this.renderAreaStatically(c,o,a,i)}},{key:"render",value:function(){var a,i=this.props,l=i.hide,c=i.dot,o=i.points,u=i.className,d=i.top,h=i.left,x=i.xAxis,f=i.yAxis,z=i.width,C=i.height,E=i.isAnimationActive,b=i.id;if(l||!o||!o.length)return null;var R=this.state.isAnimationFinished,O=o.length===1,$=$e("recharts-area",u),g=x&&x.allowDataOverflow,S=f&&f.allowDataOverflow,j=g||S,B=Oe(b)?this.id:b,v=(a=Q(c,!1))!==null&&a!==void 0?a:{r:3,strokeWidth:2},L=v.r,W=L===void 0?3:L,M=v.strokeWidth,J=M===void 0?2:M,V=bt(c)?c:{},F=V.clipDot,le=F===void 0?!0:F,X=W*2+J;return w.createElement(ne,{className:$},g||S?w.createElement("defs",null,w.createElement("clipPath",{id:"clipPath-".concat(B)},w.createElement("rect",{x:g?h:h-z/2,y:S?d:d-C/2,width:g?z:z*2,height:S?C:C*2})),!le&&w.createElement("clipPath",{id:"clipPath-dots-".concat(B)},w.createElement("rect",{x:h-X/2,y:d-X/2,width:z+X,height:C+X}))):null,O?null:this.renderArea(j,B),(c||O)&&this.renderDots(j,le,B),(!E||R)&&vt.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(a,i){return a.animationId!==i.prevAnimationId?{prevAnimationId:a.animationId,curPoints:a.points,curBaseLine:a.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:a.points!==i.curPoints||a.baseLine!==i.curBaseLine?{curPoints:a.points,curBaseLine:a.baseLine}:null}}])})(P.PureComponent);Ke=U;N(U,"displayName","Area");N(U,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!jt.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});N(U,"getBaseValue",function(e,r,n,a){var i=e.layout,l=e.baseValue,c=r.props.baseValue,o=c??l;if(ae(o)&&typeof o=="number")return o;var u=i==="horizontal"?a:n,d=u.scale.domain();if(u.type==="number"){var h=Math.max(d[0],d[1]),x=Math.min(d[0],d[1]);return o==="dataMin"?x:o==="dataMax"||h<0?h:Math.max(Math.min(d[0],d[1]),0)}return o==="dataMin"?d[0]:o==="dataMax"?d[1]:d[0]});N(U,"getComposedData",function(e){var r=e.props,n=e.item,a=e.xAxis,i=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,o=e.bandSize,u=e.dataKey,d=e.stackedData,h=e.dataStartIndex,x=e.displayedData,f=e.offset,z=r.layout,C=d&&d.length,E=Ke.getBaseValue(r,n,a,i),b=z==="horizontal",R=!1,O=x.map(function(g,S){var j;C?j=d[h+S]:(j=Te(g,u),Array.isArray(j)?R=!0:j=[E,j]);var B=j[1]==null||C&&Te(g,u)==null;return b?{x:ze({axis:a,ticks:l,bandSize:o,entry:g,index:S}),y:B?null:i.scale(j[1]),value:j,payload:g}:{x:B?null:a.scale(j[1]),y:ze({axis:i,ticks:c,bandSize:o,entry:g,index:S}),value:j,payload:g}}),$;return C||R?$=O.map(function(g){var S=Array.isArray(g.value)?g.value[0]:null;return b?{x:g.x,y:S!=null&&g.y!=null?i.scale(S):null}:{x:S!=null?a.scale(S):null,y:g.y}}):$=b?i.scale(E):a.scale(E),H({points:O,baseLine:$,layout:z,isRange:R},f)});N(U,"renderDotItem",function(e,r){var n;if(w.isValidElement(e))n=w.cloneElement(e,r);else if(ve(e))n=e(r);else{var a=$e("recharts-area-dot",typeof e!="boolean"?e.className:""),i=r.key,l=Ue(r,Ot);n=w.createElement(kt,Y({},l,{key:i,className:a}))}return n});var _t=At({chartName:"AreaChart",GraphicalChild:U,axisComponents:[{axisType:"xAxis",AxisComp:de},{axisType:"yAxis",AxisComp:pe}],formatAxisMap:Ct});const je=We`
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
`;We`
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); }
`;const Me=G(_)(({theme:e})=>({padding:e.spacing(3),maxWidth:1400,margin:"0 auto",width:"100%",minHeight:"100vh",backgroundColor:e.palette.background.default})),Bt=G(K)(({theme:e})=>({marginBottom:e.spacing(3),animation:`${je} 0.5s ease-out`})),Mt=G(dt)(({theme:e})=>({minWidth:160,"& .MuiOutlinedInput-root":{borderRadius:12,backgroundColor:y(e.palette.background.paper,.6),backdropFilter:"blur(8px)",transition:"all 0.2s ease","&:hover":{backgroundColor:y(e.palette.background.paper,.8)},"&.Mui-focused":{backgroundColor:e.palette.background.paper,boxShadow:`0 0 0 3px ${y(e.palette.text.primary,.08)}`},"& .MuiOutlinedInput-notchedOutline":{borderColor:y(e.palette.divider,.15)}},"& .MuiInputLabel-root":{color:e.palette.text.secondary}})),$t=G(pt)(({theme:e})=>({borderRadius:12,textTransform:"none",fontWeight:500,borderColor:y(e.palette.divider,.2),transition:"all 0.2s ease","&:hover":{borderColor:e.palette.mode==="dark"?s[1e3]:s[1100],backgroundColor:e.palette.mode==="dark"?y(e.palette.text.primary,.08):s[300]}})),Nt=G(ut)(({theme:e})=>({borderRadius:12,transition:"all 0.2s ease","&:hover":{backgroundColor:e.palette.mode==="dark"?y(e.palette.text.primary,.1):s[300],transform:"rotate(180deg)"}})),Wt=G(ht)(({theme:e})=>({marginBottom:e.spacing(3),"& .MuiTab-root":{color:e.palette.mode==="dark"?e.palette.text.secondary:Z.darkText,textTransform:"none",minWidth:100,fontWeight:500,transition:"all 0.2s ease",padding:"8px 32px","&.Mui-selected":{color:e.palette.mode==="dark"?e.palette.text.primary:Z.greenText,backgroundColor:e.palette.mode==="dark"?y(e.palette.text.primary,.08):Z.greenBackground},"&:hover":{color:e.palette.mode==="dark"?e.palette.text.primary:Z.greenText,backgroundColor:e.palette.mode==="dark"?y(e.palette.text.primary,.04):y(Z.greenBackground,.5)}},"& .MuiTabs-indicator":{backgroundColor:e.palette.mode==="dark"?s[1e3]:Z.primaryGreen,height:2}})),He=G(St)(({theme:e})=>({backgroundColor:y(e.palette.background.paper,.8),backdropFilter:"blur(20px)",border:`1px solid ${y(e.palette.divider,.1)}`,borderRadius:8,boxShadow:`0 8px 32px ${y(e.palette.common.black,.08)}`,transition:"all 0.3s ease","&:hover":{boxShadow:`0 12px 48px ${y(e.palette.common.black,.12)}`,transform:"translateY(-2px)"}})),Ft=G(Fe)(({theme:e})=>({padding:e.spacing(2.5),"&:last-child":{paddingBottom:e.spacing(2.5)}})),Kt=[{value:"day",label:"Last 24 hours"},{value:"week",label:"Last 7 days"},{value:"month",label:"Last 30 days"}],Ut=e=>[e.palette.mode==="dark"?s[1e3]:s[1100],e.palette.mode==="dark"?s[900]:s[1e3],e.palette.mode==="dark"?s[600]:s[900],e.palette.mode==="dark"?s[1100]:s[1200],e.palette.mode==="dark"?s[700]:s[600],e.palette.text.secondary],Jt=e=>({completed:e.palette.mode==="dark"?s[1e3]:s[1100],failed:e.palette.mode==="dark"?s[1100]:s[1200],pending:e.palette.mode==="dark"?s[600]:s[900],running:e.palette.mode==="dark"?s[900]:s[1e3],cancelled:e.palette.text.secondary});function I({title:e,value:r,subtitle:n,icon:a,trend:i,color:l,onClick:c}){const o=me(),d=i>0?mt:xt,h=o.palette.text.secondary,x=l||(o.palette.mode==="dark"?s[1e3]:s[1100]);return t.jsx(He,{onClick:c,sx:{height:"100%",cursor:c?"pointer":"default",animation:`${je} 0.5s ease-out`,"&:active":c?{transform:"scale(0.98)"}:{}},children:t.jsxs(Ft,{children:[t.jsxs(K,{direction:"row",alignItems:"flex-start",justifyContent:"space-between",children:[t.jsxs(_,{children:[t.jsx(T,{sx:{fontSize:"0.75rem",fontWeight:500,color:o.palette.text.secondary,textTransform:"uppercase",letterSpacing:"0.05em",mb:.5},children:e}),t.jsx(T,{sx:{fontSize:"1.75rem",fontWeight:600,color:o.palette.text.primary,lineHeight:1.2},children:r}),n&&t.jsx(T,{sx:{fontSize:"0.75rem",color:o.palette.text.secondary,mt:.5},children:n})]}),t.jsx(_,{sx:{width:40,height:40,borderRadius:2.5,bgcolor:y(x,.15),display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(a,{sx:{fontSize:20,color:x}})})]}),i!=null&&t.jsxs(K,{direction:"row",alignItems:"center",spacing:.5,sx:{mt:1.5},children:[t.jsx(d,{sx:{fontSize:14,color:h}}),t.jsxs(T,{sx:{fontSize:"0.75rem",color:h,fontWeight:500},children:[Math.abs(i),"%"]}),t.jsx(T,{sx:{fontSize:"0.75rem",color:o.palette.text.secondary},children:"vs previous period"})]})]})})}function te({title:e,subtitle:r,children:n,height:a=280,actions:i}){const l=me();return t.jsx(He,{sx:{height:"100%",animation:`${je} 0.5s ease-out 0.2s both`},children:t.jsxs(Fe,{sx:{p:2.5,height:"100%",display:"flex",flexDirection:"column"},children:[t.jsxs(K,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",sx:{mb:2},children:[t.jsxs(_,{children:[t.jsx(T,{sx:{fontSize:"0.875rem",fontWeight:600,color:l.palette.text.primary},children:e}),r&&t.jsx(T,{sx:{fontSize:"0.75rem",color:l.palette.text.secondary,mt:.25},children:r})]}),i]}),t.jsx(_,{sx:{flex:1,minHeight:a},children:n})]})})}function oe({active:e,payload:r,label:n}){const a=me();return!e||!r?.length?null:t.jsxs(_,{sx:{bgcolor:y(a.palette.background.paper,.95),backdropFilter:"blur(8px)",border:`1px solid ${y(a.palette.divider,.1)}`,borderRadius:1,p:1.5,boxShadow:`0 4px 12px ${y(a.palette.common.black,.15)}`},children:[t.jsx(T,{sx:{fontSize:"0.75rem",fontWeight:600,color:a.palette.text.primary,mb:.5},children:n}),r.map((i,l)=>t.jsxs(K,{direction:"row",alignItems:"center",spacing:1,children:[t.jsx(_,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:i.color}}),t.jsxs(T,{sx:{fontSize:"0.6875rem",color:a.palette.text.secondary},children:[i.name,": ",i.value]})]},l))]})}const Vt={overview:0,jobs:1,templates:2},Ht=["overview","jobs","templates"];function Gt(){const e=me(),r=Ge(),{execute:n}=Ne(),a=Ye(),[i,l]=Xe(),c=P.useRef(!1),o=P.useCallback((p,m,k={})=>a(p,{label:m,intent:{from:"stats",...k}}),[a]),u=i.get("tab")||"overview",d=Vt[u]??0,[h,x]=P.useState(!0),[f,z]=P.useState(i.get("period")||"week"),[C,E]=P.useState(null),[b,R]=P.useState(null),[O,$]=P.useState(null),g=P.useMemo(()=>Ut(e),[e]),S=P.useMemo(()=>Jt(e),[e]),j=P.useCallback(async()=>{x(!0);try{const[p,m,k]=await Promise.all([qe(),Ze(f),Qe({limit:100})]);E(p),R(m),$(k)}catch(p){r.show(p.message||"Failed to load statistics","error")}finally{x(!1)}},[f,r]),B=P.useCallback(()=>n({type:Ae.EXECUTE,label:"Refresh usage statistics",reversibility:ke.FULLY_REVERSIBLE,suppressSuccessToast:!0,intent:{period:f},action:j}),[n,j,f]);P.useEffect(()=>{c.current||(c.current=!0,j())},[j]),P.useEffect(()=>{c.current&&j()},[f,j]);const v=C?.summary||{},L=C?.metrics||{},W=C?.jobsTrend||[],M=C?.topTemplates||[],J=P.useMemo(()=>{const p=b?.byStatus||{};return Object.entries(p).map(([m,k])=>({name:m.charAt(0).toUpperCase()+m.slice(1),value:k,color:S[m]||e.palette.text.secondary}))},[b,S,e]),V=P.useMemo(()=>{const p=b?.byKind||{};return Object.entries(p).map(([m,k])=>({name:m.toUpperCase(),value:k,color:m==="pdf"?e.palette.mode==="dark"?s[1100]:s[1200]:e.palette.mode==="dark"?s[1e3]:s[1100]}))},[b,e]),F=P.useMemo(()=>{const p=b?.templateBreakdown||[];return p.length>0?p:M.slice(0,6).map(m=>({name:m.name||m.id?.slice(0,12),count:m.runCount||0,kind:m.kind||"pdf"}))},[b,M]),le=P.useMemo(()=>{const p=O?.history||[],m={};return p.forEach(k=>{const D=k.createdAt?.split("T")[0];D&&(m[D]||(m[D]={date:D,completed:0,failed:0,total:0}),m[D].total+=1,k.status==="completed"?m[D].completed+=1:k.status==="failed"&&(m[D].failed+=1))}),Object.values(m).sort((k,D)=>k.date.localeCompare(D.date)).slice(-14)},[O]),X=P.useCallback(()=>n({type:Ae.DOWNLOAD,label:"Export usage statistics",reversibility:ke.FULLY_REVERSIBLE,intent:{period:f},action:async()=>{const p={exportedAt:new Date().toISOString(),period:f,dashboard:C,usage:b,historyCount:O?.total||0},m=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),k=URL.createObjectURL(m),D=document.createElement("a");D.href=k,D.download=`neurareport-stats-${f}-${Date.now()}.json`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(k)}}),[n,f,C,b,O]);return h&&!C?t.jsx(Me,{children:t.jsxs(_,{sx:{py:8,textAlign:"center"},children:[t.jsx(Ce,{size:40}),t.jsx(T,{sx:{mt:2,color:e.palette.text.secondary},children:"Loading statistics..."})]})}):t.jsxs(Me,{children:[t.jsxs(Bt,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[t.jsxs(_,{children:[t.jsx(T,{variant:"h5",fontWeight:600,sx:{color:e.palette.text.primary},children:"Usage Statistics"}),t.jsx(T,{variant:"body2",sx:{color:e.palette.text.secondary},children:"Detailed analytics and insights for your workspace"})]}),t.jsxs(K,{direction:"row",spacing:2,alignItems:"center",children:[t.jsxs(Mt,{size:"small",children:[t.jsx(et,{children:"Time Period"}),t.jsx(tt,{value:f,onChange:p=>{const m=p.target.value;z(m);const k=new URLSearchParams(i);k.set("period",m),l(k,{replace:!0})},label:"Time Period",children:Kt.map(p=>t.jsx(at,{value:p.value,children:p.label},p.value))})]}),t.jsx($t,{variant:"outlined",size:"small",startIcon:t.jsx(rt,{sx:{fontSize:16}}),onClick:X,children:"Export"}),t.jsx(Nt,{onClick:B,disabled:h,sx:{color:e.palette.text.secondary},children:h?t.jsx(Ce,{size:20}):t.jsx(nt,{})})]})]}),t.jsxs(A,{container:!0,spacing:2,sx:{mb:3},children:[t.jsx(A,{size:{xs:12,sm:6,md:3},children:t.jsx(I,{title:"Total Jobs",value:v.totalJobs||0,subtitle:`${L.jobsThisWeek||0} this week`,icon:xe,color:e.palette.mode==="dark"?s[900]:s[1e3],onClick:()=>o("/jobs","Open jobs")})}),t.jsx(A,{size:{xs:12,sm:6,md:3},children:t.jsx(I,{title:"Success Rate",value:`${(L.successRate||0).toFixed(1)}%`,subtitle:`${v.completedJobs||0} completed`,icon:it,color:e.palette.mode==="dark"?s[1e3]:s[1100],onClick:()=>o("/history","Open history")})}),t.jsx(A,{size:{xs:12,sm:6,md:3},children:t.jsx(I,{title:"Templates",value:v.totalTemplates||0,subtitle:`${v.approvedTemplates||0} approved`,icon:q,color:e.palette.mode==="dark"?s[600]:s[900],onClick:()=>o("/templates","Open templates")})}),t.jsx(A,{size:{xs:12,sm:6,md:3},children:t.jsx(I,{title:"Connections",value:v.totalConnections||0,subtitle:`${v.activeConnections||0} active`,icon:st,color:e.palette.mode==="dark"?s[700]:s[600],onClick:()=>o("/connections","Open connections")})})]}),t.jsxs(Wt,{value:d,onChange:(p,m)=>{const k=new URLSearchParams(i);k.set("tab",Ht[m]),l(k,{replace:!0})},children:[t.jsx(he,{label:"Overview",icon:t.jsx(we,{sx:{fontSize:18}}),iconPosition:"start"}),t.jsx(he,{label:"Jobs",icon:t.jsx(xe,{sx:{fontSize:18}}),iconPosition:"start"}),t.jsx(he,{label:"Templates",icon:t.jsx(q,{sx:{fontSize:18}}),iconPosition:"start"})]}),d===0&&t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{size:{xs:12,lg:8},children:t.jsx(te,{title:"Jobs Trend",subtitle:"Daily job completions over the past week",children:t.jsx(ie,{width:"100%",height:"100%",children:t.jsxs(De,{data:W,children:[t.jsx(ye,{strokeDasharray:"3 3",stroke:y(e.palette.divider,.3)}),t.jsx(de,{dataKey:"label",tick:{fill:e.palette.text.secondary,fontSize:11},axisLine:{stroke:y(e.palette.divider,.3)}}),t.jsx(pe,{tick:{fill:e.palette.text.secondary,fontSize:11},axisLine:{stroke:y(e.palette.divider,.3)}}),t.jsx(se,{content:t.jsx(oe,{})}),t.jsx(be,{dataKey:"completed",name:"Completed",fill:e.palette.mode==="dark"?s[1e3]:s[1100],radius:[4,4,0,0]}),t.jsx(be,{dataKey:"failed",name:"Failed",fill:e.palette.mode==="dark"?s[1100]:s[1200],radius:[4,4,0,0]})]})})})}),t.jsx(A,{size:{xs:12,lg:4},children:t.jsx(te,{title:"Job Status",subtitle:"Distribution by status",children:t.jsx(ie,{width:"100%",height:"100%",children:t.jsxs(Ee,{children:[t.jsx(Re,{data:J,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:2,dataKey:"value",children:J.map((p,m)=>t.jsx(Le,{fill:p.color},`cell-${m}`))}),t.jsx(se,{content:t.jsx(oe,{})}),t.jsx(Ie,{verticalAlign:"bottom",height:36,formatter:p=>t.jsx("span",{style:{color:e.palette.text.secondary,fontSize:"0.75rem"},children:p})})]})})})}),t.jsx(A,{size:{xs:12,md:6},children:t.jsx(te,{title:"Template Types",subtitle:"PDF vs Excel usage",children:t.jsx(ie,{width:"100%",height:"100%",children:t.jsxs(Ee,{children:[t.jsx(Re,{data:V,cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",label:({name:p,percent:m})=>`${p} ${(m*100).toFixed(0)}%`,labelLine:{stroke:e.palette.text.secondary},children:V.map((p,m)=>t.jsx(Le,{fill:p.color},`cell-${m}`))}),t.jsx(se,{content:t.jsx(oe,{})})]})})})}),t.jsx(A,{size:{xs:12,md:6},children:t.jsx(te,{title:"Top Templates",subtitle:"Most used templates",children:F.length===0?t.jsx(_,{sx:{py:6,textAlign:"center"},children:t.jsx(T,{sx:{color:e.palette.text.secondary,fontSize:"0.875rem"},children:"No template usage data"})}):t.jsx(K,{spacing:1.5,children:F.map((p,m)=>t.jsxs(_,{children:[t.jsxs(K,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:.5},children:[t.jsxs(K,{direction:"row",alignItems:"center",spacing:1,children:[t.jsx(T,{sx:{fontSize:"0.8125rem",color:e.palette.text.primary},children:p.name}),t.jsx(ot,{label:p.kind?.toUpperCase(),size:"small",sx:{height:18,fontSize:"0.5625rem",bgcolor:e.palette.mode==="dark"?y(e.palette.text.primary,.08):s[300],color:"text.secondary",borderRadius:1}})]}),t.jsxs(T,{sx:{fontSize:"0.75rem",color:e.palette.text.secondary},children:[p.count," runs"]})]}),t.jsx(lt,{variant:"determinate",value:F[0]?.count?p.count/F[0].count*100:0,sx:{height:6,borderRadius:3,bgcolor:y(e.palette.divider,.15),"& .MuiLinearProgress-bar":{bgcolor:g[m%g.length],borderRadius:3}}})]},m))})})})]}),d===1&&t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{size:12,children:t.jsx(te,{title:"Jobs History",subtitle:"Job executions over the past 2 weeks",height:320,children:t.jsx(ie,{width:"100%",height:"100%",children:t.jsxs(_t,{data:le,children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"colorCompleted",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:e.palette.mode==="dark"?s[1e3]:s[1100],stopOpacity:.3}),t.jsx("stop",{offset:"95%",stopColor:e.palette.mode==="dark"?s[1e3]:s[1100],stopOpacity:0})]}),t.jsxs("linearGradient",{id:"colorFailed",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:e.palette.mode==="dark"?s[1100]:s[1200],stopOpacity:.3}),t.jsx("stop",{offset:"95%",stopColor:e.palette.mode==="dark"?s[1100]:s[1200],stopOpacity:0})]})]}),t.jsx(ye,{strokeDasharray:"3 3",stroke:y(e.palette.divider,.3)}),t.jsx(de,{dataKey:"date",tick:{fill:e.palette.text.secondary,fontSize:10},axisLine:{stroke:y(e.palette.divider,.3)},tickFormatter:p=>p.slice(5)}),t.jsx(pe,{tick:{fill:e.palette.text.secondary,fontSize:11},axisLine:{stroke:y(e.palette.divider,.3)}}),t.jsx(se,{content:t.jsx(oe,{})}),t.jsx(U,{type:"monotone",dataKey:"completed",name:"Completed",stroke:e.palette.mode==="dark"?s[1e3]:s[1100],fill:"url(#colorCompleted)",strokeWidth:2}),t.jsx(U,{type:"monotone",dataKey:"failed",name:"Failed",stroke:e.palette.mode==="dark"?s[1100]:s[1200],fill:"url(#colorFailed)",strokeWidth:2}),t.jsx(Ie,{verticalAlign:"top",height:36,formatter:p=>t.jsx("span",{style:{color:e.palette.text.secondary,fontSize:"0.75rem"},children:p})})]})})})}),t.jsx(A,{size:{xs:12,sm:6,md:3},children:t.jsx(I,{title:"Jobs Today",value:L.jobsToday||0,icon:Se,color:e.palette.mode==="dark"?s[900]:s[1e3],onClick:()=>o("/jobs","Open jobs")})}),t.jsx(A,{size:{xs:12,sm:6,md:3},children:t.jsx(I,{title:"Jobs This Week",value:L.jobsThisWeek||0,icon:xe,color:e.palette.mode==="dark"?s[1e3]:s[1100],onClick:()=>o("/jobs","Open jobs")})}),t.jsx(A,{size:{xs:12,sm:6,md:3},children:t.jsx(I,{title:"Jobs This Month",value:L.jobsThisMonth||0,icon:we,color:e.palette.mode==="dark"?s[600]:s[900],onClick:()=>o("/jobs","Open jobs")})}),t.jsx(A,{size:{xs:12,sm:6,md:3},children:t.jsx(I,{title:"Failed Jobs",value:v.failedJobs||0,icon:ct,color:e.palette.mode==="dark"?s[1100]:s[1200],onClick:()=>o("/history?status=failed","Open failed history",{status:"failed"})})})]}),d===2&&t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{size:{xs:12,sm:6,md:3},children:t.jsx(I,{title:"Total Templates",value:v.totalTemplates||0,icon:q,color:e.palette.mode==="dark"?s[900]:s[1e3],onClick:()=>o("/templates","Open templates")})}),t.jsx(A,{size:{xs:12,sm:6,md:3},children:t.jsx(I,{title:"PDF Templates",value:v.pdfTemplates||0,icon:q,color:e.palette.mode==="dark"?s[1100]:s[1200],onClick:()=>o("/templates?kind=pdf","Open PDF templates",{kind:"pdf"})})}),t.jsx(A,{size:{xs:12,sm:6,md:3},children:t.jsx(I,{title:"Excel Templates",value:v.excelTemplates||0,icon:q,color:e.palette.mode==="dark"?s[1e3]:s[1100],onClick:()=>o("/templates?kind=excel","Open Excel templates",{kind:"excel"})})}),t.jsx(A,{size:{xs:12,sm:6,md:3},children:t.jsx(I,{title:"Active Schedules",value:v.activeSchedules||0,icon:Se,color:e.palette.mode==="dark"?s[600]:s[900],onClick:()=>o("/schedules","Open schedules")})}),t.jsx(A,{size:12,children:t.jsx(te,{title:"Template Usage Breakdown",subtitle:"Jobs per template",height:400,children:F.length===0?t.jsxs(_,{sx:{py:8,textAlign:"center"},children:[t.jsx(q,{sx:{fontSize:48,color:e.palette.text.disabled,mb:2}}),t.jsx(T,{sx:{color:e.palette.text.secondary,fontSize:"0.875rem"},children:"No template usage data available"})]}):t.jsx(ie,{width:"100%",height:"100%",children:t.jsxs(De,{data:F,layout:"vertical",children:[t.jsx(ye,{strokeDasharray:"3 3",stroke:y(e.palette.divider,.3)}),t.jsx(de,{type:"number",tick:{fill:e.palette.text.secondary,fontSize:11},axisLine:{stroke:y(e.palette.divider,.3)}}),t.jsx(pe,{type:"category",dataKey:"name",tick:{fill:e.palette.text.secondary,fontSize:11},axisLine:{stroke:y(e.palette.divider,.3)},width:120}),t.jsx(se,{content:t.jsx(oe,{})}),t.jsx(be,{dataKey:"count",name:"Jobs",fill:e.palette.mode==="dark"?s[1e3]:s[1100],radius:[0,4,4,0]})]})})})})]})]})}function sa(){return Ne(),t.jsx(Gt,{})}export{sa as default};
