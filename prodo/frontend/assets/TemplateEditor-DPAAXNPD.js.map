{"version":3,"file":"TemplateEditor-DPAAXNPD.js","sources":["../../node_modules/@mui/material/esm/AlertTitle/alertTitleClasses.js","../../node_modules/@mui/material/esm/AlertTitle/AlertTitle.js","../../node_modules/@mui/icons-material/esm/DeleteOutline.js","../../node_modules/@mui/icons-material/esm/FullscreenExit.js","../../node_modules/@mui/icons-material/esm/KeyboardArrowUp.js","../../node_modules/@mui/icons-material/esm/Remove.js","../../node_modules/@mui/icons-material/esm/UnfoldLess.js","../../node_modules/@mui/icons-material/esm/UnfoldMore.js","../../src/utils/templateMeta.js","../../src/features/generate/components/EnhancedDiffViewer.jsx","../../src/features/generate/components/EditHistoryTimeline.jsx","../../src/features/generate/components/EditorSkeleton.jsx","../../src/features/generate/hooks/useEditorKeyboardShortcuts.js","../../src/features/generate/components/KeyboardShortcutsPanel.jsx","../../src/features/generate/components/DraftRecoveryBanner.jsx","../../src/features/generate/hooks/useEditorDraft.js","../../src/features/generate/containers/TemplateEditor.jsx","../../src/pages/Generate/TemplateEditor.jsx"],"sourcesContent":["import generateUtilityClasses from '@mui/utils/generateUtilityClasses';\nimport generateUtilityClass from '@mui/utils/generateUtilityClass';\nexport function getAlertTitleUtilityClass(slot) {\n  return generateUtilityClass('MuiAlertTitle', slot);\n}\nconst alertTitleClasses = generateUtilityClasses('MuiAlertTitle', ['root']);\nexport default alertTitleClasses;","'use client';\n\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport composeClasses from '@mui/utils/composeClasses';\nimport { styled } from \"../zero-styled/index.js\";\nimport memoTheme from \"../utils/memoTheme.js\";\nimport { useDefaultProps } from \"../DefaultPropsProvider/index.js\";\nimport Typography from \"../Typography/index.js\";\nimport { getAlertTitleUtilityClass } from \"./alertTitleClasses.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nconst useUtilityClasses = ownerState => {\n  const {\n    classes\n  } = ownerState;\n  const slots = {\n    root: ['root']\n  };\n  return composeClasses(slots, getAlertTitleUtilityClass, classes);\n};\nconst AlertTitleRoot = styled(Typography, {\n  name: 'MuiAlertTitle',\n  slot: 'Root'\n})(memoTheme(({\n  theme\n}) => {\n  return {\n    fontWeight: theme.typography.fontWeightMedium,\n    marginTop: -2\n  };\n}));\nconst AlertTitle = /*#__PURE__*/React.forwardRef(function AlertTitle(inProps, ref) {\n  const props = useDefaultProps({\n    props: inProps,\n    name: 'MuiAlertTitle'\n  });\n  const {\n    className,\n    ...other\n  } = props;\n  const ownerState = props;\n  const classes = useUtilityClasses(ownerState);\n  return /*#__PURE__*/_jsx(AlertTitleRoot, {\n    gutterBottom: true,\n    component: \"div\",\n    ownerState: ownerState,\n    ref: ref,\n    className: clsx(classes.root, className),\n    ...other\n  });\n});\nprocess.env.NODE_ENV !== \"production\" ? AlertTitle.propTypes /* remove-proptypes */ = {\n  // ┌────────────────────────────── Warning ──────────────────────────────┐\n  // │ These PropTypes are generated from the TypeScript type definitions. │\n  // │    To update them, edit the d.ts file and run `pnpm proptypes`.     │\n  // └─────────────────────────────────────────────────────────────────────┘\n  /**\n   * The content of the component.\n   */\n  children: PropTypes.node,\n  /**\n   * Override or extend the styles applied to the component.\n   */\n  classes: PropTypes.object,\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n  /**\n   * The system prop that allows defining system overrides as well as additional CSS styles.\n   */\n  sx: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.func, PropTypes.object, PropTypes.bool])), PropTypes.func, PropTypes.object])\n} : void 0;\nexport default AlertTitle;","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z\"\n}), 'DeleteOutline');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M5 16h3v3h2v-5H5zm3-8H5v2h5V5H8zm6 11h2v-3h3v-2h-5zm2-11V5h-2v5h5V8z\"\n}), 'FullscreenExit');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z\"\n}), 'KeyboardArrowUp');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M19 13H5v-2h14z\"\n}), 'Remove');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M7.41 18.59 8.83 20 12 16.83 15.17 20l1.41-1.41L12 14zm9.18-13.18L15.17 4 12 7.17 8.83 4 7.41 5.41 12 10z\"\n}), 'UnfoldLess');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M12 5.83 15.17 9l1.41-1.41L12 3 7.41 7.59 8.83 9zm0 12.34L8.83 15l-1.41 1.41L12 21l4.59-4.59L15.17 15z\"\n}), 'UnfoldMore');","const LAST_EDIT_TYPE_LABELS = {\n  manual: 'Manual edit',\n  ai: 'AI edit',\n  undo: 'Undo',\n}\n\nconst LAST_EDIT_TYPE_COLORS = {\n  manual: 'primary',\n  ai: 'secondary',\n  undo: 'warning',\n}\n\nconst LAST_EDIT_TYPE_VARIANTS = {\n  manual: 'filled',\n  ai: 'filled',\n  undo: 'outlined',\n}\n\nconst pad = (value) => String(value).padStart(2, '0')\n\nexport const formatLastEditTimestamp = (isoString) => {\n  if (!isoString) return null\n  const date = new Date(isoString)\n  if (Number.isNaN(date.getTime())) return null\n  return `${date.getFullYear()}-${pad(date.getMonth() + 1)}-${pad(date.getDate())} ${pad(\n    date.getHours(),\n  )}:${pad(date.getMinutes())}`\n}\n\nexport const buildLastEditInfo = (source) => {\n  if (!source || typeof source !== 'object') return null\n  const rawType =\n    typeof source.lastEditType === 'string' ? source.lastEditType.trim().toLowerCase() : null\n  const type = rawType === 'manual' || rawType === 'ai' || rawType === 'undo' ? rawType : null\n  const typeLabel = type ? LAST_EDIT_TYPE_LABELS[type] : null\n  const timestampLabel = formatLastEditTimestamp(source.lastEditAt)\n  if (!typeLabel && !timestampLabel) {\n    return null\n  }\n  const chipLabel = typeLabel && timestampLabel\n    ? `${typeLabel} \\u00B7 ${timestampLabel}`\n    : typeLabel || (timestampLabel ? `Edited ${timestampLabel}` : null)\n  return {\n    type,\n    typeLabel,\n    timestampLabel,\n    chipLabel,\n    color: (type && LAST_EDIT_TYPE_COLORS[type]) || 'default',\n    variant: (type && LAST_EDIT_TYPE_VARIANTS[type]) || 'outlined',\n  }\n}\n","import { useState, useMemo } from 'react'\nimport { sanitizeCodeHighlight } from '@/utils/sanitize'\nimport {\n  Box,\n  Stack,\n  Typography,\n  IconButton,\n  Chip,\n  Collapse,\n  Tooltip,\n  ToggleButtonGroup,\n  ToggleButton,\n  alpha,\n} from '@mui/material'\nimport { neutral, palette, secondary } from '@/app/theme'\nimport UnfoldLessIcon from '@mui/icons-material/UnfoldLess'\nimport UnfoldMoreIcon from '@mui/icons-material/UnfoldMore'\nimport AddIcon from '@mui/icons-material/Add'\nimport RemoveIcon from '@mui/icons-material/Remove'\nimport CompareArrowsIcon from '@mui/icons-material/CompareArrows'\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp'\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown'\n\n// HTML escaping for safe dangerouslySetInnerHTML usage\nconst escapeHtml = (str) =>\n  str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;')\n\n// Simple HTML syntax highlighting\nfunction highlightHtml(text) {\n  if (!text) return null\n\n  text = escapeHtml(text)\n\n  // Replace HTML tags\n  const highlighted = text\n    .replace(/(&lt;|<)(\\/?)([\\w-]+)/g, (match, bracket, slash, tag) => {\n      return `<span class=\"html-bracket\">&lt;</span><span class=\"html-slash\">${slash}</span><span class=\"html-tag\">${tag}</span>`\n    })\n    .replace(/(\\s)([\\w-]+)(=)/g, (match, space, attr, eq) => {\n      return `${space}<span class=\"html-attr\">${attr}</span><span class=\"html-eq\">=</span>`\n    })\n    .replace(/(\"[^\"]*\"|'[^']*')/g, '<span class=\"html-string\">$1</span>')\n    .replace(/(>)/g, '<span class=\"html-bracket\">$1</span>')\n    .replace(/(\\{[^}]+\\})/g, '<span class=\"html-token\">$1</span>')\n\n  return <span dangerouslySetInnerHTML={{ __html: sanitizeCodeHighlight(highlighted) }} />\n}\n\n// Compute diff using LCS algorithm for better accuracy\nfunction computeDiff(beforeText, afterText, contextLines = 3) {\n  const beforeLines = (beforeText || '').split('\\n')\n  const afterLines = (afterText || '').split('\\n')\n\n  const result = []\n  let beforeIdx = 0\n  let afterIdx = 0\n\n  // Simple line-by-line diff\n  const maxLen = Math.max(beforeLines.length, afterLines.length)\n\n  let unchangedStart = null\n  const unchangedBuffer = []\n\n  for (let i = 0; i < maxLen; i++) {\n    const beforeLine = beforeLines[i] ?? null\n    const afterLine = afterLines[i] ?? null\n\n    if (beforeLine === afterLine && beforeLine !== null) {\n      // Unchanged line\n      if (unchangedStart === null) {\n        unchangedStart = i\n      }\n      unchangedBuffer.push({\n        type: 'unchanged',\n        lineNumber: { before: i + 1, after: i + 1 },\n        content: beforeLine,\n      })\n    } else {\n      // Flush unchanged buffer with context\n      if (unchangedBuffer.length > 0) {\n        if (unchangedBuffer.length <= contextLines * 2 + 1) {\n          // Show all if small\n          result.push(...unchangedBuffer)\n        } else {\n          // Show context + collapsed\n          result.push(...unchangedBuffer.slice(0, contextLines))\n          result.push({\n            type: 'collapsed',\n            count: unchangedBuffer.length - contextLines * 2,\n            startLine: unchangedStart + contextLines + 1,\n          })\n          result.push(...unchangedBuffer.slice(-contextLines))\n        }\n        unchangedBuffer.length = 0\n        unchangedStart = null\n      }\n\n      // Handle changed lines\n      if (beforeLine !== null && afterLine !== null) {\n        result.push({\n          type: 'modified',\n          lineNumber: { before: i + 1, after: i + 1 },\n          beforeContent: beforeLine,\n          afterContent: afterLine,\n        })\n      } else if (beforeLine !== null) {\n        result.push({\n          type: 'removed',\n          lineNumber: { before: i + 1, after: null },\n          content: beforeLine,\n        })\n      } else if (afterLine !== null) {\n        result.push({\n          type: 'added',\n          lineNumber: { before: null, after: i + 1 },\n          content: afterLine,\n        })\n      }\n    }\n  }\n\n  // Flush remaining unchanged\n  if (unchangedBuffer.length > 0) {\n    if (unchangedBuffer.length <= contextLines) {\n      result.push(...unchangedBuffer)\n    } else {\n      result.push(...unchangedBuffer.slice(0, contextLines))\n      if (unchangedBuffer.length > contextLines) {\n        result.push({\n          type: 'collapsed',\n          count: unchangedBuffer.length - contextLines,\n          startLine: unchangedStart + contextLines + 1,\n        })\n      }\n    }\n  }\n\n  return result\n}\n\nfunction DiffLine({ item, viewMode, expanded, onToggleExpand, syntaxHighlight }) {\n  const lineNumberSx = {\n    width: 48,\n    minWidth: 48,\n    px: 1,\n    py: 0.5,\n    bgcolor: 'action.hover',\n    color: 'text.disabled',\n    fontFamily: 'monospace',\n    fontSize: '0.75rem',\n    textAlign: 'right',\n    userSelect: 'none',\n    borderRight: '1px solid',\n    borderColor: 'divider',\n  }\n\n  const contentSx = {\n    flex: 1,\n    px: 1.5,\n    py: 0.5,\n    fontFamily: 'monospace',\n    fontSize: '12px',\n    whiteSpace: 'pre-wrap',\n    wordBreak: 'break-all',\n    minHeight: 24,\n    '& .html-tag': { color: secondary.cyan[600] },\n    '& .html-attr': { color: secondary.teal[500] },\n    '& .html-string': { color: secondary.rose[400] },\n    '& .html-bracket': { color: neutral[500] },\n    '& .html-slash': { color: neutral[500] },\n    '& .html-eq': { color: neutral[300] },\n    '& .html-token': { color: secondary.emerald[400], fontWeight: 600 },\n  }\n\n  if (item.type === 'collapsed') {\n    return (\n      <Box\n        sx={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          py: 0.5,\n          px: 2,\n          bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.04) : neutral[50],\n          borderTop: '1px dashed',\n          borderBottom: '1px dashed',\n          borderColor: 'divider',\n          cursor: 'pointer',\n          '&:hover': {\n            bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n          },\n        }}\n        onClick={() => onToggleExpand?.(item.startLine)}\n      >\n        <UnfoldMoreIcon fontSize=\"small\" sx={{ mr: 1, color: 'text.secondary' }} />\n        <Typography variant=\"caption\" color=\"text.secondary\">\n          {item.count} unchanged lines (click to expand)\n        </Typography>\n      </Box>\n    )\n  }\n\n  if (item.type === 'unchanged') {\n    return (\n      <Box sx={{ display: 'flex', bgcolor: 'transparent' }}>\n        <Box sx={lineNumberSx}>{item.lineNumber.before}</Box>\n        {viewMode === 'split' && <Box sx={lineNumberSx}>{item.lineNumber.after}</Box>}\n        <Box sx={contentSx}>\n          {syntaxHighlight ? highlightHtml(item.content) : item.content}\n        </Box>\n      </Box>\n    )\n  }\n\n  if (item.type === 'removed') {\n    return (\n      <Box sx={{ display: 'flex', bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.04) : neutral[50] }}>\n        <Box sx={{ ...lineNumberSx, bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100] }}>\n          {item.lineNumber.before}\n        </Box>\n        {viewMode === 'split' && <Box sx={lineNumberSx} />}\n        <Box sx={{ ...contentSx, color: 'text.secondary', textDecoration: 'line-through' }}>\n          <RemoveIcon sx={{ fontSize: 14, mr: 0.5, verticalAlign: 'middle' }} />\n          {syntaxHighlight ? highlightHtml(item.content) : item.content}\n        </Box>\n      </Box>\n    )\n  }\n\n  if (item.type === 'added') {\n    return (\n      <Box sx={{ display: 'flex', bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.06) : neutral[200] }}>\n        <Box sx={lineNumberSx} />\n        {viewMode === 'split' && (\n          <Box sx={{ ...lineNumberSx, bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.1) : neutral[200] }}>\n            {item.lineNumber.after}\n          </Box>\n        )}\n        <Box sx={{ ...contentSx, color: 'text.primary' }}>\n          <AddIcon sx={{ fontSize: 14, mr: 0.5, verticalAlign: 'middle' }} />\n          {syntaxHighlight ? highlightHtml(item.content) : item.content}\n        </Box>\n      </Box>\n    )\n  }\n\n  if (item.type === 'modified') {\n    if (viewMode === 'split') {\n      return (\n        <>\n          <Box sx={{ display: 'flex', bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.04) : neutral[50] }}>\n            <Box sx={{ ...lineNumberSx, bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100] }}>\n              {item.lineNumber.before}\n            </Box>\n            <Box sx={{ ...contentSx, color: 'text.secondary', textDecoration: 'line-through', flex: 0.5 }}>\n              {syntaxHighlight ? highlightHtml(item.beforeContent) : item.beforeContent}\n            </Box>\n            <Box sx={{ ...lineNumberSx, bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.1) : neutral[200] }}>\n              {item.lineNumber.after}\n            </Box>\n            <Box sx={{ ...contentSx, color: 'text.primary', flex: 0.5 }}>\n              {syntaxHighlight ? highlightHtml(item.afterContent) : item.afterContent}\n            </Box>\n          </Box>\n        </>\n      )\n    }\n\n    return (\n      <>\n        <Box sx={{ display: 'flex', bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.04) : neutral[50] }}>\n          <Box sx={{ ...lineNumberSx, bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100] }}>\n            {item.lineNumber.before}\n          </Box>\n          <Box sx={{ ...contentSx, color: 'text.secondary', textDecoration: 'line-through' }}>\n            <RemoveIcon sx={{ fontSize: 14, mr: 0.5, verticalAlign: 'middle' }} />\n            {syntaxHighlight ? highlightHtml(item.beforeContent) : item.beforeContent}\n          </Box>\n        </Box>\n        <Box sx={{ display: 'flex', bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.06) : neutral[200] }}>\n          <Box sx={{ ...lineNumberSx, bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.1) : neutral[200] }}>\n            {item.lineNumber.after}\n          </Box>\n          <Box sx={{ ...contentSx, color: 'text.primary' }}>\n            <AddIcon sx={{ fontSize: 14, mr: 0.5, verticalAlign: 'middle' }} />\n            {syntaxHighlight ? highlightHtml(item.afterContent) : item.afterContent}\n          </Box>\n        </Box>\n      </>\n    )\n  }\n\n  return null\n}\n\nexport default function EnhancedDiffViewer({ beforeText, afterText, contextLines = 3 }) {\n  const [viewMode, setViewMode] = useState('unified') // 'unified' | 'split'\n  const [syntaxHighlight, setSyntaxHighlight] = useState(true)\n  const [expandedSections, setExpandedSections] = useState(new Set())\n  const [currentDiffIndex, setCurrentDiffIndex] = useState(0)\n\n  const diff = useMemo(\n    () => computeDiff(beforeText, afterText, contextLines),\n    [beforeText, afterText, contextLines]\n  )\n\n  const stats = useMemo(() => {\n    let added = 0\n    let removed = 0\n    let modified = 0\n    diff.forEach((item) => {\n      if (item.type === 'added') added++\n      if (item.type === 'removed') removed++\n      if (item.type === 'modified') modified++\n    })\n    return { added, removed, modified, total: added + removed + modified }\n  }, [diff])\n\n  const diffIndices = useMemo(() => {\n    return diff\n      .map((item, idx) => (item.type !== 'unchanged' && item.type !== 'collapsed' ? idx : null))\n      .filter((idx) => idx !== null)\n  }, [diff])\n\n  const handleToggleExpand = (startLine) => {\n    setExpandedSections((prev) => {\n      const next = new Set(prev)\n      if (next.has(startLine)) {\n        next.delete(startLine)\n      } else {\n        next.add(startLine)\n      }\n      return next\n    })\n  }\n\n  const navigateDiff = (direction) => {\n    if (diffIndices.length === 0) return\n    let newIndex = currentDiffIndex + direction\n    if (newIndex < 0) newIndex = diffIndices.length - 1\n    if (newIndex >= diffIndices.length) newIndex = 0\n    setCurrentDiffIndex(newIndex)\n    // Scroll to the diff - would need ref in real implementation\n  }\n\n  if (!beforeText && !afterText) {\n    return (\n      <Box sx={{ p: 3, textAlign: 'center' }}>\n        <Typography color=\"text.secondary\">No content to compare</Typography>\n      </Box>\n    )\n  }\n\n  if (beforeText === afterText) {\n    return (\n      <Box sx={{ p: 3, textAlign: 'center' }}>\n        <Typography color=\"text.secondary\">No differences found</Typography>\n      </Box>\n    )\n  }\n\n  return (\n    <Box sx={{ display: 'flex', flexDirection: 'column', height: '100%' }}>\n      {/* Toolbar */}\n      <Stack\n        direction=\"row\"\n        spacing={2}\n        alignItems=\"center\"\n        justifyContent=\"space-between\"\n        sx={{ px: 2, py: 1, borderBottom: '1px solid', borderColor: 'divider' }}\n      >\n        <Stack direction=\"row\" spacing={1} alignItems=\"center\">\n          <Chip\n            size=\"small\"\n            icon={<AddIcon />}\n            label={`+${stats.added}`}\n            variant=\"outlined\"\n            sx={{ borderColor: (theme) => alpha(theme.palette.divider, 0.3), color: 'text.secondary' }}\n          />\n          <Chip\n            size=\"small\"\n            icon={<RemoveIcon />}\n            label={`-${stats.removed}`}\n            variant=\"outlined\"\n            sx={{ borderColor: (theme) => alpha(theme.palette.divider, 0.3), color: 'text.secondary' }}\n          />\n          {stats.modified > 0 && (\n            <Chip\n              size=\"small\"\n              icon={<CompareArrowsIcon />}\n              label={`~${stats.modified}`}\n              variant=\"outlined\"\n              sx={{ borderColor: (theme) => alpha(theme.palette.divider, 0.3), color: 'text.secondary' }}\n            />\n          )}\n        </Stack>\n\n        <Stack direction=\"row\" spacing={1} alignItems=\"center\">\n          {diffIndices.length > 0 && (\n            <>\n              <Typography variant=\"caption\" color=\"text.secondary\">\n                {currentDiffIndex + 1} / {diffIndices.length}\n              </Typography>\n              <Tooltip title=\"Previous change\">\n                <IconButton size=\"small\" onClick={() => navigateDiff(-1)} aria-label=\"Previous change\">\n                  <KeyboardArrowUpIcon fontSize=\"small\" />\n                </IconButton>\n              </Tooltip>\n              <Tooltip title=\"Next change\">\n                <IconButton size=\"small\" onClick={() => navigateDiff(1)} aria-label=\"Next change\">\n                  <KeyboardArrowDownIcon fontSize=\"small\" />\n                </IconButton>\n              </Tooltip>\n            </>\n          )}\n\n          <ToggleButtonGroup\n            size=\"small\"\n            value={viewMode}\n            exclusive\n            onChange={(e, v) => v && setViewMode(v)}\n          >\n            <ToggleButton value=\"unified\">\n              <Tooltip title=\"Unified view\">\n                <UnfoldLessIcon fontSize=\"small\" />\n              </Tooltip>\n            </ToggleButton>\n            <ToggleButton value=\"split\">\n              <Tooltip title=\"Split view\">\n                <CompareArrowsIcon fontSize=\"small\" />\n              </Tooltip>\n            </ToggleButton>\n          </ToggleButtonGroup>\n        </Stack>\n      </Stack>\n\n      {/* Diff content */}\n      <Box\n        sx={{\n          flex: 1,\n          overflow: 'auto',\n          bgcolor: 'background.default',\n          '& > *:nth-of-type(even)': {\n            bgcolor: (theme) => alpha(theme.palette.action.hover, 0.3),\n          },\n        }}\n      >\n        {diff.map((item, idx) => (\n          <DiffLine\n            key={idx}\n            item={item}\n            viewMode={viewMode}\n            syntaxHighlight={syntaxHighlight}\n            onToggleExpand={handleToggleExpand}\n          />\n        ))}\n      </Box>\n    </Box>\n  )\n}\n","import { useState, useMemo } from 'react'\nimport {\n  Box,\n  Stack,\n  Typography,\n  Chip,\n  IconButton,\n  Tooltip,\n  Collapse,\n  ToggleButtonGroup,\n  ToggleButton,\n  alpha,\n} from '@mui/material'\nimport { neutral, palette } from '@/app/theme'\nimport HistoryIcon from '@mui/icons-material/History'\nimport EditIcon from '@mui/icons-material/Edit'\nimport SmartToyIcon from '@mui/icons-material/SmartToy'\nimport UndoIcon from '@mui/icons-material/Undo'\nimport ChatIcon from '@mui/icons-material/Chat'\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore'\nimport ExpandLessIcon from '@mui/icons-material/ExpandLess'\nimport FilterListIcon from '@mui/icons-material/FilterList'\nimport AccessTimeIcon from '@mui/icons-material/AccessTime'\n\nconst EDIT_TYPE_CONFIG = {\n  manual: {\n    icon: EditIcon,\n    label: 'Manual',\n    color: 'default',\n  },\n  ai: {\n    icon: SmartToyIcon,\n    label: 'AI',\n    color: 'default',\n  },\n  chat: {\n    icon: ChatIcon,\n    label: 'Chat AI',\n    color: 'default',\n  },\n  undo: {\n    icon: UndoIcon,\n    label: 'Undo',\n    color: 'default',\n  },\n  default: {\n    icon: HistoryIcon,\n    label: 'Edit',\n    color: 'default',\n  },\n}\n\nfunction formatRelativeTime(timestamp) {\n  if (!timestamp) return 'Unknown time'\n\n  const date = new Date(timestamp)\n  const now = new Date()\n  const diff = now - date\n  const seconds = Math.floor(diff / 1000)\n  const minutes = Math.floor(seconds / 60)\n  const hours = Math.floor(minutes / 60)\n  const days = Math.floor(hours / 24)\n\n  if (seconds < 60) return 'Just now'\n  if (minutes < 60) return `${minutes}m ago`\n  if (hours < 24) return `${hours}h ago`\n  if (days < 7) return `${days}d ago`\n\n  return date.toLocaleDateString(undefined, {\n    month: 'short',\n    day: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit',\n  })\n}\n\nfunction HistoryEntry({ entry, isLatest }) {\n  const config = EDIT_TYPE_CONFIG[entry.type] || EDIT_TYPE_CONFIG.default\n  const Icon = config.icon\n\n  return (\n    <Box\n      sx={{\n        display: 'flex',\n        gap: 1.5,\n        py: 1,\n        px: 1.5,\n        borderRadius: 1,\n        bgcolor: isLatest ? (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.04) : neutral[50] : 'transparent',\n        '&:hover': {\n          bgcolor: 'action.hover',\n        },\n      }}\n    >\n      {/* Timeline indicator */}\n      <Box\n        sx={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          pt: 0.5,\n        }}\n      >\n        <Box\n          sx={{\n            width: 28,\n            height: 28,\n            borderRadius: '50%',\n            bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n          }}\n        >\n          <Icon\n            sx={{\n              fontSize: 16,\n              color: 'text.secondary',\n            }}\n          />\n        </Box>\n        <Box\n          sx={{\n            width: 2,\n            flex: 1,\n            mt: 0.5,\n            bgcolor: 'divider',\n            minHeight: 8,\n          }}\n        />\n      </Box>\n\n      {/* Content */}\n      <Box sx={{ flex: 1, minWidth: 0 }}>\n        <Stack direction=\"row\" spacing={1} alignItems=\"center\" sx={{ mb: 0.25 }}>\n          <Chip\n            label={config.label}\n            size=\"small\"\n            variant=\"outlined\"\n            sx={{\n              height: 20,\n              fontSize: '12px',\n              borderColor: (theme) => alpha(theme.palette.divider, 0.3),\n              color: 'text.secondary',\n            }}\n          />\n          {isLatest && (\n            <Chip\n              label=\"Latest\"\n              size=\"small\"\n              sx={{\n                height: 20,\n                fontSize: '12px',\n                bgcolor: (theme) => theme.palette.mode === 'dark' ? neutral[700] : neutral[900],\n                color: 'common.white',\n              }}\n            />\n          )}\n        </Stack>\n\n        {entry.notes && (\n          <Typography\n            variant=\"body2\"\n            color=\"text.primary\"\n            sx={{\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n              whiteSpace: 'nowrap',\n              maxWidth: '100%',\n            }}\n          >\n            {entry.notes}\n          </Typography>\n        )}\n\n        <Stack direction=\"row\" spacing={0.5} alignItems=\"center\" sx={{ mt: 0.5 }}>\n          <AccessTimeIcon sx={{ fontSize: 12, color: 'text.disabled' }} />\n          <Typography variant=\"caption\" color=\"text.disabled\">\n            {formatRelativeTime(entry.timestamp)}\n          </Typography>\n        </Stack>\n      </Box>\n    </Box>\n  )\n}\n\nconst MAX_HISTORY_ENTRIES = 500\n\nexport default function EditHistoryTimeline({ history = [], maxVisible = 5 }) {\n  const [expanded, setExpanded] = useState(false)\n  const [filter, setFilter] = useState('all')\n\n  const filteredHistory = useMemo(() => {\n    if (!Array.isArray(history)) return []\n    // Cap to prevent rendering unbounded entries\n    const capped = history.length > MAX_HISTORY_ENTRIES\n      ? history.slice(-MAX_HISTORY_ENTRIES)\n      : history\n    let filtered = [...capped].reverse() // Most recent first\n    if (filter !== 'all') {\n      filtered = filtered.filter((entry) => entry.type === filter)\n    }\n    return filtered\n  }, [history, filter])\n\n  const visibleHistory = expanded\n    ? filteredHistory\n    : filteredHistory.slice(0, maxVisible)\n\n  const hasMore = filteredHistory.length > maxVisible\n\n  const editTypes = useMemo(() => {\n    const types = new Set(['all'])\n    history.forEach((entry) => {\n      if (entry.type) types.add(entry.type)\n    })\n    return Array.from(types)\n  }, [history])\n\n  if (!history || history.length === 0) {\n    return (\n      <Box sx={{ py: 2, px: 1.5, textAlign: 'center' }}>\n        <HistoryIcon sx={{ fontSize: 32, color: 'text.disabled', mb: 1 }} />\n        <Typography variant=\"body2\" color=\"text.secondary\">\n          No edit history yet\n        </Typography>\n        <Typography variant=\"caption\" color=\"text.disabled\">\n          Your changes will appear here\n        </Typography>\n      </Box>\n    )\n  }\n\n  return (\n    <Box>\n      {/* Header with filter */}\n      <Stack\n        direction=\"row\"\n        justifyContent=\"space-between\"\n        alignItems=\"center\"\n        sx={{ mb: 1 }}\n      >\n        <Stack direction=\"row\" spacing={0.5} alignItems=\"center\">\n          <HistoryIcon fontSize=\"small\" color=\"action\" />\n          <Typography variant=\"subtitle2\">\n            History\n          </Typography>\n          <Chip\n            label={filteredHistory.length}\n            size=\"small\"\n            sx={{ height: 18, fontSize: '12px' }}\n          />\n        </Stack>\n\n        {editTypes.length > 2 && (\n          <ToggleButtonGroup\n            size=\"small\"\n            value={filter}\n            exclusive\n            onChange={(e, v) => v && setFilter(v)}\n            sx={{\n              '& .MuiToggleButton-root': {\n                py: 0.25,\n                px: 0.75,\n                fontSize: '12px',\n              },\n            }}\n          >\n            <ToggleButton value=\"all\">\n              <Tooltip title=\"All edits\">\n                <FilterListIcon sx={{ fontSize: 14 }} />\n              </Tooltip>\n            </ToggleButton>\n            {editTypes.filter((t) => t !== 'all').map((type) => {\n              const config = EDIT_TYPE_CONFIG[type] || EDIT_TYPE_CONFIG.default\n              const TypeIcon = config.icon\n              return (\n                <ToggleButton key={type} value={type}>\n                  <Tooltip title={config.label}>\n                    <TypeIcon sx={{ fontSize: 14 }} />\n                  </Tooltip>\n                </ToggleButton>\n              )\n            })}\n          </ToggleButtonGroup>\n        )}\n      </Stack>\n\n      {/* Timeline */}\n      <Box\n        sx={{\n          borderRadius: 1.5,\n          border: '1px solid',\n          borderColor: 'divider',\n          bgcolor: 'background.paper',\n          overflow: 'hidden',\n        }}\n      >\n        {visibleHistory.map((entry, idx) => (\n          <HistoryEntry\n            key={`${entry.timestamp}-${idx}`}\n            entry={entry}\n            isLatest={idx === 0}\n          />\n        ))}\n\n        {/* Show more / less */}\n        {hasMore && (\n          <Box\n            sx={{\n              borderTop: '1px solid',\n              borderColor: 'divider',\n              py: 0.75,\n              textAlign: 'center',\n            }}\n          >\n            <IconButton\n              size=\"small\"\n              onClick={() => setExpanded(!expanded)}\n              sx={{ fontSize: '12px' }}\n            >\n              {expanded ? (\n                <>\n                  <ExpandLessIcon fontSize=\"small\" />\n                  <Typography variant=\"caption\" sx={{ ml: 0.5 }}>\n                    Show less\n                  </Typography>\n                </>\n              ) : (\n                <>\n                  <ExpandMoreIcon fontSize=\"small\" />\n                  <Typography variant=\"caption\" sx={{ ml: 0.5 }}>\n                    Show {filteredHistory.length - maxVisible} more\n                  </Typography>\n                </>\n              )}\n            </IconButton>\n          </Box>\n        )}\n      </Box>\n    </Box>\n  )\n}\n","import { Box, Stack, Skeleton, alpha } from '@mui/material'\nimport Grid from '@mui/material/Grid2'\n\nexport default function EditorSkeleton({ mode = 'manual' }) {\n  return (\n    <Grid container spacing={2.5} sx={{ alignItems: 'stretch' }}>\n      {/* Preview Panel */}\n      <Grid size={{ xs: 12, md: mode === 'chat' ? 5 : 6 }} sx={{ minWidth: 0 }}>\n        <Stack spacing={1.5} sx={{ height: '100%' }}>\n          <Skeleton variant=\"text\" width={80} height={28} />\n          <Box\n            sx={{\n              borderRadius: 1.5,\n              border: '1px solid',\n              borderColor: 'divider',\n              bgcolor: 'background.paper',\n              p: 1.5,\n              minHeight: mode === 'chat' ? 400 : 200,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n            }}\n          >\n            <Skeleton\n              variant=\"rectangular\"\n              width=\"80%\"\n              height={mode === 'chat' ? 350 : 180}\n              sx={{ borderRadius: 1 }}\n            />\n          </Box>\n          <Skeleton variant=\"text\" width={150} height={20} />\n        </Stack>\n      </Grid>\n\n      {/* Editor Panel */}\n      <Grid size={{ xs: 12, md: mode === 'chat' ? 7 : 6 }} sx={{ minWidth: 0 }}>\n        {mode === 'chat' ? (\n          <Box\n            sx={{\n              height: 600,\n              borderRadius: 1,  // Figma spec: 8px\n              border: '1px solid',\n              borderColor: 'divider',\n              overflow: 'hidden',\n              display: 'flex',\n              flexDirection: 'column',\n            }}\n          >\n            {/* Chat header skeleton */}\n            <Box sx={{ p: 2, borderBottom: '1px solid', borderColor: 'divider' }}>\n              <Skeleton variant=\"text\" width={180} height={28} />\n              <Skeleton variant=\"text\" width={250} height={18} />\n            </Box>\n\n            {/* Chat messages skeleton */}\n            <Box sx={{ flex: 1, p: 2 }}>\n              <Stack spacing={2}>\n                {[1, 2, 3].map((i) => (\n                  <Stack key={i} direction=\"row\" spacing={1.5}>\n                    <Skeleton variant=\"circular\" width={32} height={32} />\n                    <Box sx={{ flex: 1 }}>\n                      <Skeleton variant=\"text\" width={80} height={18} />\n                      <Skeleton\n                        variant=\"rectangular\"\n                        width=\"80%\"\n                        height={60}\n                        sx={{ borderRadius: 1, mt: 0.5 }}\n                      />\n                    </Box>\n                  </Stack>\n                ))}\n              </Stack>\n            </Box>\n\n            {/* Chat input skeleton */}\n            <Box sx={{ p: 2, borderTop: '1px solid', borderColor: 'divider' }}>\n              <Skeleton variant=\"rectangular\" height={56} sx={{ borderRadius: 1 }} />\n            </Box>\n          </Box>\n        ) : (\n          <Stack spacing={1.5} sx={{ height: '100%' }}>\n            <Skeleton variant=\"text\" width={150} height={28} />\n\n            {/* HTML textarea skeleton */}\n            <Skeleton\n              variant=\"rectangular\"\n              height={260}\n              sx={{ borderRadius: 1 }}\n            />\n\n            {/* AI instructions skeleton */}\n            <Skeleton\n              variant=\"rectangular\"\n              height={100}\n              sx={{ borderRadius: 1 }}\n            />\n\n            {/* Buttons skeleton */}\n            <Stack direction=\"row\" spacing={1.5}>\n              <Skeleton variant=\"rectangular\" width={100} height={36} sx={{ borderRadius: 1 }} />\n              <Skeleton variant=\"rectangular\" width={120} height={36} sx={{ borderRadius: 1 }} />\n              <Skeleton variant=\"rectangular\" width={130} height={36} sx={{ borderRadius: 1 }} />\n              <Skeleton variant=\"rectangular\" width={90} height={36} sx={{ borderRadius: 1 }} />\n            </Stack>\n\n            <Skeleton variant=\"text\" width={350} height={18} />\n\n            {/* History skeleton */}\n            <Box>\n              <Skeleton variant=\"text\" width={80} height={24} />\n              <Stack spacing={0.5} sx={{ mt: 1 }}>\n                {[1, 2, 3].map((i) => (\n                  <Skeleton key={i} variant=\"text\" width={`${90 - i * 10}%`} height={18} />\n                ))}\n              </Stack>\n            </Box>\n          </Stack>\n        )}\n      </Grid>\n    </Grid>\n  )\n}\n","import { useEffect, useCallback } from 'react'\n\n/**\n * Hook for handling keyboard shortcuts in the template editor.\n *\n * Shortcuts:\n * - Ctrl/Cmd + S: Save\n * - Ctrl/Cmd + Z: Undo\n * - Ctrl/Cmd + Shift + Z: Redo (future)\n * - Ctrl/Cmd + Enter: Apply AI (when in manual mode with instructions)\n * - Escape: Close dialog/modal\n */\nexport function useEditorKeyboardShortcuts({\n  onSave,\n  onUndo,\n  onRedo,\n  onApplyAi,\n  onEscape,\n  enabled = true,\n  dirty = false,\n  hasInstructions = false,\n}) {\n  const handleKeyDown = useCallback(\n    (event) => {\n      if (!enabled) return\n\n      const isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0\n      const modKey = isMac ? event.metaKey : event.ctrlKey\n      const shiftKey = event.shiftKey\n\n      // Ctrl/Cmd + S: Save\n      if (modKey && event.key === 's') {\n        event.preventDefault()\n        if (dirty && onSave) {\n          onSave()\n        }\n        return\n      }\n\n      // Ctrl/Cmd + Z: Undo (without shift)\n      if (modKey && event.key === 'z' && !shiftKey) {\n        event.preventDefault()\n        if (onUndo) {\n          onUndo()\n        }\n        return\n      }\n\n      // Ctrl/Cmd + Shift + Z: Redo\n      if (modKey && event.key === 'z' && shiftKey) {\n        event.preventDefault()\n        if (onRedo) {\n          onRedo()\n        }\n        return\n      }\n\n      // Ctrl/Cmd + Enter: Apply AI\n      if (modKey && event.key === 'Enter' && hasInstructions) {\n        event.preventDefault()\n        if (onApplyAi) {\n          onApplyAi()\n        }\n        return\n      }\n\n      // Escape: Close dialog/cancel\n      if (event.key === 'Escape') {\n        if (onEscape) {\n          onEscape()\n        }\n        return\n      }\n    },\n    [enabled, dirty, hasInstructions, onSave, onUndo, onRedo, onApplyAi, onEscape]\n  )\n\n  useEffect(() => {\n    if (!enabled) return\n\n    window.addEventListener('keydown', handleKeyDown)\n    return () => {\n      window.removeEventListener('keydown', handleKeyDown)\n    }\n  }, [enabled, handleKeyDown])\n}\n\n/**\n * Get keyboard shortcut display string based on platform.\n */\nexport function getShortcutDisplay(shortcut) {\n  const isMac =\n    typeof navigator !== 'undefined' &&\n    navigator.platform.toUpperCase().indexOf('MAC') >= 0\n\n  const modKey = isMac ? '⌘' : 'Ctrl'\n\n  const shortcuts = {\n    save: `${modKey}+S`,\n    undo: `${modKey}+Z`,\n    redo: `${modKey}+Shift+Z`,\n    applyAi: `${modKey}+Enter`,\n  }\n\n  return shortcuts[shortcut] || shortcut\n}\n\nexport const EDITOR_SHORTCUTS = [\n  { key: 'save', label: 'Save HTML', description: 'Save current changes' },\n  { key: 'undo', label: 'Undo', description: 'Revert to previous version' },\n  { key: 'applyAi', label: 'Apply AI', description: 'Apply AI instructions (when filled)' },\n]\n\nexport default useEditorKeyboardShortcuts\n","import { Box, Stack, Typography, Chip, alpha } from '@mui/material'\nimport KeyboardIcon from '@mui/icons-material/Keyboard'\nimport { getShortcutDisplay, EDITOR_SHORTCUTS } from '../hooks/useEditorKeyboardShortcuts'\nimport { neutral, palette } from '@/app/theme'\n\nfunction ShortcutKey({ children }) {\n  return (\n    <Box\n      component=\"kbd\"\n      sx={{\n        display: 'inline-flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        px: 0.75,\n        py: 0.25,\n        minWidth: 24,\n        height: 22,\n        borderRadius: 0.5,\n        bgcolor: 'background.paper',\n        border: '1px solid',\n        borderColor: 'divider',\n        boxShadow: (theme) => `0 1px 0 ${alpha(theme.palette.common.black, 0.1)}`,\n        fontFamily: 'monospace',\n        fontSize: '12px',\n        fontWeight: 600,\n        color: 'text.secondary',\n      }}\n    >\n      {children}\n    </Box>\n  )\n}\n\nfunction ShortcutDisplay({ shortcutKey }) {\n  const display = getShortcutDisplay(shortcutKey)\n  const parts = display.split('+')\n\n  return (\n    <Stack direction=\"row\" spacing={0.5} alignItems=\"center\">\n      {parts.map((part, idx) => (\n        <ShortcutKey key={idx}>{part}</ShortcutKey>\n      ))}\n    </Stack>\n  )\n}\n\nexport default function KeyboardShortcutsPanel({ compact = false }) {\n  if (compact) {\n    return (\n      <Stack\n        direction=\"row\"\n        spacing={2}\n        sx={{\n          py: 1,\n          px: 1.5,\n          borderRadius: 1,\n          bgcolor: (theme) => theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.04) : neutral[50],\n          border: '1px solid',\n          borderColor: (theme) => alpha(theme.palette.divider, 0.1),\n        }}\n      >\n        <Stack direction=\"row\" spacing={0.5} alignItems=\"center\">\n          <KeyboardIcon sx={{ fontSize: 14, color: 'text.disabled' }} />\n          <Typography variant=\"caption\" color=\"text.disabled\">\n            Shortcuts:\n          </Typography>\n        </Stack>\n        {EDITOR_SHORTCUTS.slice(0, 3).map((shortcut) => (\n          <Stack key={shortcut.key} direction=\"row\" spacing={0.5} alignItems=\"center\">\n            <ShortcutDisplay shortcutKey={shortcut.key} />\n            <Typography variant=\"caption\" color=\"text.secondary\">\n              {shortcut.label}\n            </Typography>\n          </Stack>\n        ))}\n      </Stack>\n    )\n  }\n\n  return (\n    <Box\n      sx={{\n        p: 2,\n        borderRadius: 1.5,\n        bgcolor: 'background.paper',\n        border: '1px solid',\n        borderColor: 'divider',\n      }}\n    >\n      <Stack direction=\"row\" spacing={1} alignItems=\"center\" sx={{ mb: 2 }}>\n        <KeyboardIcon fontSize=\"small\" color=\"action\" />\n        <Typography variant=\"subtitle2\">Keyboard Shortcuts</Typography>\n      </Stack>\n\n      <Stack spacing={1.5}>\n        {EDITOR_SHORTCUTS.map((shortcut) => (\n          <Stack\n            key={shortcut.key}\n            direction=\"row\"\n            justifyContent=\"space-between\"\n            alignItems=\"center\"\n          >\n            <Box>\n              <Typography variant=\"body2\">{shortcut.label}</Typography>\n              <Typography variant=\"caption\" color=\"text.secondary\">\n                {shortcut.description}\n              </Typography>\n            </Box>\n            <ShortcutDisplay shortcutKey={shortcut.key} />\n          </Stack>\n        ))}\n      </Stack>\n    </Box>\n  )\n}\n","import { Box, Stack, Typography, Button, Alert, AlertTitle, Collapse, alpha } from '@mui/material'\nimport RestoreIcon from '@mui/icons-material/Restore'\nimport DeleteOutlineIcon from '@mui/icons-material/DeleteOutline'\nimport AccessTimeIcon from '@mui/icons-material/AccessTime'\n\nfunction formatTimeAgo(timestamp) {\n  if (!timestamp) return 'Unknown time'\n\n  const date = new Date(timestamp)\n  const now = new Date()\n  const diff = now - date\n  const minutes = Math.floor(diff / 60000)\n  const hours = Math.floor(minutes / 60)\n\n  if (minutes < 1) return 'Just now'\n  if (minutes < 60) return `${minutes} minute${minutes > 1 ? 's' : ''} ago`\n  if (hours < 24) return `${hours} hour${hours > 1 ? 's' : ''} ago`\n\n  return date.toLocaleDateString(undefined, {\n    month: 'short',\n    day: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit',\n  })\n}\n\nexport default function DraftRecoveryBanner({\n  show,\n  draftData,\n  onRestore,\n  onDiscard,\n  restoring = false,\n}) {\n  if (!show || !draftData) return null\n\n  return (\n    <Collapse in={show}>\n      <Alert\n        severity=\"info\"\n        icon={<RestoreIcon />}\n        sx={{\n          mb: 2,\n          borderRadius: 1,  // Figma spec: 8px\n          '& .MuiAlert-message': { width: '100%' },\n        }}\n        action={\n          <Stack direction=\"row\" spacing={1}>\n            <Button\n              size=\"small\"\n              variant=\"contained\"\n              startIcon={<RestoreIcon />}\n              onClick={onRestore}\n              disabled={restoring}\n            >\n              {restoring ? 'Restoring...' : 'Restore'}\n            </Button>\n            <Button\n              size=\"small\"\n              variant=\"outlined\"\n              color=\"inherit\"\n              startIcon={<DeleteOutlineIcon />}\n              onClick={onDiscard}\n              disabled={restoring}\n            >\n              Discard\n            </Button>\n          </Stack>\n        }\n      >\n        <AlertTitle sx={{ fontWeight: 600 }}>Unsaved Draft Found</AlertTitle>\n        <Stack direction=\"row\" spacing={2} alignItems=\"center\">\n          <Typography variant=\"body2\">\n            You have unsaved changes from a previous session.\n          </Typography>\n          <Stack direction=\"row\" spacing={0.5} alignItems=\"center\">\n            <AccessTimeIcon sx={{ fontSize: 14, color: 'text.secondary' }} />\n            <Typography variant=\"caption\" color=\"text.secondary\">\n              {formatTimeAgo(draftData.savedAt)}\n            </Typography>\n          </Stack>\n        </Stack>\n      </Alert>\n    </Collapse>\n  )\n}\n\nexport function AutoSaveIndicator({ lastSaved, dirty }) {\n  if (!lastSaved && !dirty) return null\n\n  return (\n    <Stack\n      direction=\"row\"\n      spacing={0.5}\n      alignItems=\"center\"\n      sx={{\n        py: 0.5,\n        px: 1,\n        borderRadius: 1,\n        bgcolor: (theme) =>\n          dirty\n            ? alpha(theme.palette.text.primary, 0.05)\n            : alpha(theme.palette.text.primary, 0.05),\n      }}\n    >\n      <Box\n        sx={{\n          width: 6,\n          height: 6,\n          borderRadius: '50%',\n          bgcolor: 'text.secondary',\n        }}\n      />\n      <Typography variant=\"caption\" color=\"text.secondary\">\n        {dirty\n          ? 'Unsaved changes'\n          : lastSaved\n          ? `Draft saved ${formatTimeAgo(lastSaved)}`\n          : 'All changes saved'}\n      </Typography>\n    </Stack>\n  )\n}\n","import { useState, useEffect, useCallback, useRef } from 'react'\n\nconst DRAFT_PREFIX = 'neura-template-draft-'\nconst DRAFT_EXPIRY_MS = 24 * 60 * 60 * 1000 // 24 hours\n\n/**\n * Hook for auto-saving template drafts to localStorage.\n *\n * Features:\n * - Auto-saves drafts periodically when content changes\n * - Detects and restores unsaved drafts on load\n * - Cleans up old/expired drafts\n * - Provides manual save/discard controls\n */\nexport function useEditorDraft(templateId, { autoSaveInterval = 10000, enabled = true } = {}) {\n  const [hasDraft, setHasDraft] = useState(false)\n  const [draftData, setDraftData] = useState(null)\n  const [lastSaved, setLastSaved] = useState(null)\n  const autoSaveTimerRef = useRef(null)\n  const pendingContentRef = useRef(null)\n\n  const storageKey = `${DRAFT_PREFIX}${templateId}`\n\n  // Load draft on mount\n  useEffect(() => {\n    if (!templateId || !enabled) return\n\n    try {\n      const stored = localStorage.getItem(storageKey)\n      if (stored) {\n        const parsed = JSON.parse(stored)\n        const age = Date.now() - (parsed.savedAt || 0)\n\n        if (age < DRAFT_EXPIRY_MS) {\n          setHasDraft(true)\n          setDraftData(parsed)\n        } else {\n          // Expired draft, clean up\n          localStorage.removeItem(storageKey)\n        }\n      }\n    } catch (err) {\n      console.warn('Failed to load draft:', err)\n    }\n  }, [templateId, storageKey, enabled])\n\n  // Clean up old drafts on mount\n  useEffect(() => {\n    if (!enabled) return\n\n    try {\n      const keys = Object.keys(localStorage).filter((k) => k.startsWith(DRAFT_PREFIX))\n      keys.forEach((key) => {\n        try {\n          const stored = localStorage.getItem(key)\n          if (stored) {\n            const parsed = JSON.parse(stored)\n            const age = Date.now() - (parsed.savedAt || 0)\n            if (age >= DRAFT_EXPIRY_MS) {\n              localStorage.removeItem(key)\n            }\n          }\n        } catch {\n          // Invalid draft, remove it\n          localStorage.removeItem(key)\n        }\n      })\n    } catch (err) {\n      console.warn('Failed to clean up drafts:', err)\n    }\n  }, [enabled])\n\n  // Save draft to localStorage\n  const saveDraft = useCallback(\n    (html, instructions = '') => {\n      if (!templateId || !enabled) return false\n\n      try {\n        const draft = {\n          html,\n          instructions,\n          savedAt: Date.now(),\n          templateId,\n        }\n        localStorage.setItem(storageKey, JSON.stringify(draft))\n        setLastSaved(new Date())\n        return true\n      } catch (err) {\n        console.warn('Failed to save draft:', err)\n        return false\n      }\n    },\n    [templateId, storageKey, enabled]\n  )\n\n  // Discard draft\n  const discardDraft = useCallback(() => {\n    if (!templateId) return\n\n    try {\n      localStorage.removeItem(storageKey)\n      setHasDraft(false)\n      setDraftData(null)\n    } catch (err) {\n      console.warn('Failed to discard draft:', err)\n    }\n  }, [templateId, storageKey])\n\n  // Auto-save with debounce\n  const scheduleAutoSave = useCallback(\n    (html, instructions = '') => {\n      if (!enabled) return\n\n      pendingContentRef.current = { html, instructions }\n\n      if (autoSaveTimerRef.current) {\n        clearTimeout(autoSaveTimerRef.current)\n      }\n\n      autoSaveTimerRef.current = setTimeout(() => {\n        if (pendingContentRef.current) {\n          saveDraft(pendingContentRef.current.html, pendingContentRef.current.instructions)\n        }\n      }, autoSaveInterval)\n    },\n    [enabled, autoSaveInterval, saveDraft]\n  )\n\n  // Flush pending draft and cleanup timer on unmount\n  useEffect(() => {\n    return () => {\n      if (autoSaveTimerRef.current) {\n        clearTimeout(autoSaveTimerRef.current)\n      }\n      // Flush any pending content before unmount\n      if (pendingContentRef.current) {\n        try {\n          const draft = {\n            html: pendingContentRef.current.html,\n            instructions: pendingContentRef.current.instructions,\n            savedAt: Date.now(),\n            templateId,\n          }\n          localStorage.setItem(storageKey, JSON.stringify(draft))\n        } catch {\n          // Best-effort flush on unmount\n        }\n      }\n    }\n  }, [templateId, storageKey])\n\n  // Clear draft when it's been applied (i.e., saved to server)\n  const clearDraftAfterSave = useCallback(() => {\n    discardDraft()\n  }, [discardDraft])\n\n  return {\n    // State\n    hasDraft,\n    draftData,\n    lastSaved,\n\n    // Actions\n    saveDraft,\n    discardDraft,\n    scheduleAutoSave,\n    clearDraftAfterSave,\n  }\n}\n\nexport default useEditorDraft\n","import Grid from '@mui/material/Grid2'\nimport {\n  Box,\n  Stack,\n  Typography,\n  Button,\n  TextField,\n  CircularProgress,\n  Divider,\n  Alert,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Breadcrumbs,\n  Link,\n  ToggleButton,\n  ToggleButtonGroup,\n  Tooltip,\n  IconButton,\n  Collapse,\n} from '@mui/material'\nimport NavigateNextIcon from '@mui/icons-material/NavigateNext'\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack'\nimport CodeIcon from '@mui/icons-material/Code'\nimport ChatIcon from '@mui/icons-material/Chat'\nimport SaveIcon from '@mui/icons-material/Save'\nimport UndoIcon from '@mui/icons-material/Undo'\nimport AutoFixHighIcon from '@mui/icons-material/AutoFixHigh'\nimport CompareArrowsIcon from '@mui/icons-material/CompareArrows'\nimport FullscreenIcon from '@mui/icons-material/Fullscreen'\nimport FullscreenExitIcon from '@mui/icons-material/FullscreenExit'\nimport KeyboardIcon from '@mui/icons-material/Keyboard'\nimport CloseIcon from '@mui/icons-material/Close'\nimport { forwardRef, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react'\nimport { useParams, useLocation, Link as RouterLink, UNSAFE_NavigationContext } from 'react-router-dom'\n\nimport ScaledIframePreview from '@/components/ScaledIframePreview.jsx'\nimport Surface from '@/components/layout/Surface.jsx'\nimport { useToast } from '@/components/ToastProvider.jsx'\nimport { useInteraction, InteractionType, Reversibility, useNavigateInteraction } from '@/components/ux/governance'\nimport { useAppStore } from '@/stores'\nimport { buildLastEditInfo } from '@/utils/templateMeta'\nimport {\n  getTemplateHtml,\n  editTemplateManual,\n  editTemplateAi,\n  undoTemplateEdit,\n} from '@/api/client'\n\n// New components\nimport TemplateChatEditor from './TemplateChatEditor.jsx'\nimport EnhancedDiffViewer from '../components/EnhancedDiffViewer.jsx'\nimport EditHistoryTimeline from '../components/EditHistoryTimeline.jsx'\nimport EditorSkeleton from '../components/EditorSkeleton.jsx'\nimport KeyboardShortcutsPanel from '../components/KeyboardShortcutsPanel.jsx'\nimport DraftRecoveryBanner, { AutoSaveIndicator } from '../components/DraftRecoveryBanner.jsx'\nimport ConfirmModal from '@/components/Modal/ConfirmModal'\nimport AiUsageNotice from '@/components/ai/AiUsageNotice.jsx'\n\n// Hooks\nimport { useEditorKeyboardShortcuts, getShortcutDisplay } from '../hooks/useEditorKeyboardShortcuts.js'\nimport { useEditorDraft } from '../hooks/useEditorDraft.js'\n\nconst surfaceStackSx = {\n  gap: { xs: 2, md: 2.5 },\n}\n\nconst FixedTextarea = forwardRef(function FixedTextarea(props, ref) {\n  return <textarea {...props} ref={ref} />\n})\n\nexport default function TemplateEditor() {\n  const { templateId } = useParams()\n  const navigate = useNavigateInteraction()\n  const location = useLocation()\n  const toast = useToast()\n  const { execute } = useInteraction()\n  const templates = useAppStore((state) => state.templates)\n  const updateTemplateEntry = useAppStore((state) => state.updateTemplate)\n\n  // Track where user came from for proper back navigation\n  const referrer = location.state?.from || '/generate'\n\n  const template = useMemo(\n    () => templates.find((t) => t.id === templateId) || null,\n    [templates, templateId],\n  )\n\n  // Core editor state\n  const [loading, setLoading] = useState(true)\n  const [html, setHtml] = useState('')\n  const [initialHtml, setInitialHtml] = useState('')\n  const [instructions, setInstructions] = useState('')\n  const [previewUrl, setPreviewUrl] = useState(null)\n  const [saving, setSaving] = useState(false)\n  const [aiBusy, setAiBusy] = useState(false)\n  const [undoBusy, setUndoBusy] = useState(false)\n  const [serverMeta, setServerMeta] = useState(null)\n  const [diffSummary, setDiffSummary] = useState(null)\n  const [history, setHistory] = useState([])\n  const [error, setError] = useState(null)\n\n  // UI state\n  const [editMode, setEditMode] = useState('manual') // 'manual' | 'chat'\n  const [diffOpen, setDiffOpen] = useState(false)\n  const [shortcutsOpen, setShortcutsOpen] = useState(false)\n  const [previewFullscreen, setPreviewFullscreen] = useState(false)\n  const [modeSwitchConfirm, setModeSwitchConfirm] = useState({ open: false, nextMode: null })\n\n  const dirty = html !== initialHtml\n  const hasInstructions = (instructions || '').trim().length > 0\n\n  // Block in-app navigation when there are unsaved changes (BrowserRouter-compatible)\n  const { navigator } = useContext(UNSAFE_NavigationContext)\n  const dirtyRef = useRef(dirty)\n  dirtyRef.current = dirty\n\n  useEffect(() => {\n    const originalPush = navigator.push\n    const originalReplace = navigator.replace\n\n    navigator.push = (...args) => {\n      if (dirtyRef.current && !window.confirm('You have unsaved changes in the template editor. Leave without saving?')) {\n        return\n      }\n      originalPush.apply(navigator, args)\n    }\n    navigator.replace = (...args) => {\n      if (dirtyRef.current && !window.confirm('You have unsaved changes in the template editor. Leave without saving?')) {\n        return\n      }\n      originalReplace.apply(navigator, args)\n    }\n\n    return () => {\n      navigator.push = originalPush\n      navigator.replace = originalReplace\n    }\n  }, [navigator])\n\n  // Draft auto-save\n  const {\n    hasDraft,\n    draftData,\n    lastSaved,\n    scheduleAutoSave,\n    discardDraft,\n    clearDraftAfterSave,\n    saveDraft,\n  } = useEditorDraft(templateId, { enabled: editMode === 'manual' })\n\n  // Auto-save when content changes\n  useEffect(() => {\n    if (dirty && editMode === 'manual') {\n      scheduleAutoSave(html, instructions)\n    }\n  }, [html, instructions, dirty, editMode, scheduleAutoSave])\n\n  const syncTemplateMetadata = useCallback(\n    (metadata) => {\n      if (!metadata || !templateId || typeof updateTemplateEntry !== 'function') return\n      updateTemplateEntry(templateId, (tpl) => {\n        if (!tpl) return tpl\n        const prevGenerator = tpl.generator || {}\n        const prevSummary = prevGenerator.summary || {}\n        const nextSummary = { ...prevSummary }\n        const fields = ['lastEditType', 'lastEditAt', 'lastEditNotes']\n        let summaryChanged = false\n        fields.forEach((field) => {\n          if (Object.prototype.hasOwnProperty.call(metadata, field) && metadata[field] !== undefined) {\n            if (nextSummary[field] !== metadata[field]) {\n              nextSummary[field] = metadata[field]\n              summaryChanged = true\n            }\n          }\n        })\n        if (!summaryChanged) {\n          return tpl\n        }\n        return {\n          ...tpl,\n          generator: {\n            ...prevGenerator,\n            summary: nextSummary,\n          },\n        }\n      })\n    },\n    [templateId, updateTemplateEntry],\n  )\n\n  const loadTemplate = useCallback(async () => {\n    if (!templateId) return\n    setLoading(true)\n    setError(null)\n    try {\n      const data = await getTemplateHtml(templateId)\n      if (!data || typeof data !== 'object' || typeof data.html !== 'string') {\n        throw new Error('Template not found or returned invalid data')\n      }\n      const nextHtml = data.html\n      setHtml(nextHtml)\n      setInitialHtml(nextHtml)\n      setServerMeta(data?.metadata || null)\n      setDiffSummary(data?.diff_summary || null)\n      setHistory(Array.isArray(data?.history) ? data.history : [])\n      if (data?.metadata) {\n        syncTemplateMetadata(data.metadata)\n      }\n    } catch (err) {\n      setError(String(err?.message || err))\n      toast.show(String(err), 'error')\n    } finally {\n      setLoading(false)\n    }\n  }, [templateId, toast, syncTemplateMetadata])\n\n  useEffect(() => {\n    loadTemplate()\n  }, [loadTemplate])\n\n  useEffect(() => {\n    if (!html) {\n      setPreviewUrl(null)\n      return\n    }\n    const blob = new Blob([html], { type: 'text/html' })\n    const url = URL.createObjectURL(blob)\n    setPreviewUrl(url)\n    return () => {\n      URL.revokeObjectURL(url)\n    }\n  }, [html])\n\n  useEffect(() => {\n    const handleBeforeUnload = (event) => {\n      if (!dirty) return\n      event.preventDefault()\n      event.returnValue = ''\n    }\n    window.addEventListener('beforeunload', handleBeforeUnload)\n    return () => {\n      window.removeEventListener('beforeunload', handleBeforeUnload)\n    }\n  }, [dirty])\n\n  const handleSave = useCallback(async () => {\n    if (!templateId) return\n    await execute({\n      type: InteractionType.UPDATE,\n      label: 'Save template',\n      reversibility: Reversibility.SYSTEM_MANAGED,\n      suppressSuccessToast: true,\n      suppressErrorToast: true,\n      intent: {\n        templateId,\n        action: 'edit_manual',\n      },\n      action: async () => {\n        setSaving(true)\n        try {\n          const data = await editTemplateManual(templateId, html)\n          const nextHtml = typeof data?.html === 'string' ? data.html : html\n          setHtml(nextHtml)\n          setInitialHtml(nextHtml)\n          setServerMeta(data?.metadata || null)\n          setDiffSummary(data?.diff_summary || null)\n          setHistory(Array.isArray(data?.history) ? data.history : history)\n          if (data?.metadata) {\n            syncTemplateMetadata(data.metadata)\n          }\n          clearDraftAfterSave()\n          toast.show('Template HTML saved.', 'success')\n          return data\n        } catch (err) {\n          toast.show(String(err), 'error')\n          throw err\n        } finally {\n          setSaving(false)\n        }\n      },\n    })\n  }, [templateId, html, toast, syncTemplateMetadata, clearDraftAfterSave, history, execute])\n\n  const handleApplyAi = useCallback(async () => {\n    if (!templateId) return\n    const text = (instructions || '').trim()\n    if (!text) {\n      toast.show('Enter AI instructions before applying.', 'info')\n      return\n    }\n    await execute({\n      type: InteractionType.GENERATE,\n      label: 'Apply AI edit',\n      reversibility: Reversibility.FULLY_REVERSIBLE,\n      suppressSuccessToast: true,\n      suppressErrorToast: true,\n      intent: {\n        templateId,\n        action: 'edit_ai',\n      },\n      action: async () => {\n        setAiBusy(true)\n        try {\n          const data = await editTemplateAi(templateId, text, html)\n          const nextHtml = typeof data?.html === 'string' ? data.html : html\n          setHtml(nextHtml)\n          setInitialHtml(nextHtml)\n          setServerMeta(data?.metadata || null)\n          setDiffSummary(data?.diff_summary || null)\n          setHistory(Array.isArray(data?.history) ? data.history : history)\n          if (data?.metadata) {\n            syncTemplateMetadata(data.metadata)\n          }\n          setInstructions('')\n          clearDraftAfterSave()\n          const changes = Array.isArray(data?.summary) ? data.summary : []\n          if (changes.length) {\n            toast.show(`AI updated template: ${changes.join('; ')}`, 'success')\n          } else {\n            toast.show('AI updated the template HTML.', 'success')\n          }\n          return data\n        } catch (err) {\n          toast.show(String(err), 'error')\n          throw err\n        } finally {\n          setAiBusy(false)\n        }\n      },\n    })\n  }, [templateId, html, instructions, toast, syncTemplateMetadata, clearDraftAfterSave, history, execute])\n\n  const handleUndo = useCallback(async () => {\n    if (!templateId) return\n    await execute({\n      type: InteractionType.UPDATE,\n      label: 'Undo template edit',\n      reversibility: Reversibility.SYSTEM_MANAGED,\n      suppressSuccessToast: true,\n      suppressErrorToast: true,\n      intent: {\n        templateId,\n        action: 'undo_edit',\n      },\n      action: async () => {\n        setUndoBusy(true)\n        try {\n          const data = await undoTemplateEdit(templateId)\n          const nextHtml = typeof data?.html === 'string' ? data.html : html\n          setHtml(nextHtml)\n          setInitialHtml(nextHtml)\n          setServerMeta(data?.metadata || null)\n          setDiffSummary(data?.diff_summary || null)\n          setHistory(Array.isArray(data?.history) ? data.history : history)\n          if (data?.metadata) {\n            syncTemplateMetadata(data.metadata)\n          }\n          toast.show('Reverted to the previous template version.', 'success')\n          return data\n        } catch (err) {\n          toast.show(String(err), 'error')\n          throw err\n        } finally {\n          setUndoBusy(false)\n        }\n      },\n    })\n  }, [templateId, html, toast, syncTemplateMetadata, history, execute])\n\n  const handleBack = () => {\n    if (dirty && typeof window !== 'undefined') {\n      const confirmed = window.confirm(\n        'You have unsaved changes. Leave the editor and discard them?',\n      )\n      if (!confirmed) return\n    }\n    navigate(referrer, {\n      label: 'Back to templates',\n      intent: { referrer },\n    })\n  }\n\n  const handleEditModeChange = (event, newMode) => {\n    if (newMode !== null) {\n      if (dirty && newMode === 'chat') {\n        setModeSwitchConfirm({ open: true, nextMode: newMode })\n        return\n      }\n      setEditMode(newMode)\n    }\n  }\n\n  const handleChatHtmlUpdate = useCallback((newHtml) => {\n    setHtml(newHtml)\n    setInitialHtml(newHtml)\n  }, [])\n\n  const handleChatApplySuccess = useCallback((result) => {\n    if (result?.metadata) {\n      setServerMeta(result.metadata)\n      syncTemplateMetadata(result.metadata)\n    }\n    if (result?.diff_summary) {\n      setDiffSummary(result.diff_summary)\n    }\n    if (Array.isArray(result?.history)) {\n      setHistory(result.history)\n    }\n  }, [syncTemplateMetadata])\n\n  const handleRestoreDraft = useCallback(() => {\n    if (draftData) {\n      setHtml(draftData.html || '')\n      if (draftData.instructions) {\n        setInstructions(draftData.instructions)\n      }\n      discardDraft()\n      toast.show('Draft restored successfully.', 'success')\n    }\n  }, [draftData, discardDraft, toast])\n\n  // Keyboard shortcuts\n  useEditorKeyboardShortcuts({\n    onSave: handleSave,\n    onUndo: handleUndo,\n    onApplyAi: handleApplyAi,\n    onEscape: () => {\n      if (diffOpen) setDiffOpen(false)\n      if (shortcutsOpen) setShortcutsOpen(false)\n    },\n    enabled: editMode === 'manual' && !loading,\n    dirty,\n    hasInstructions,\n  })\n\n  const lastEditInfo = buildLastEditInfo(serverMeta)\n  const breadcrumbLabel = referrer === '/' ? 'Setup' : 'Generate'\n\n  return (\n    <>\n      {/* Breadcrumb Navigation */}\n      <Box sx={{ mb: 2 }}>\n        <Breadcrumbs\n          separator={<NavigateNextIcon fontSize=\"small\" />}\n          aria-label=\"breadcrumb\"\n        >\n          <Link\n            component={RouterLink}\n            to={referrer}\n            underline=\"hover\"\n            color=\"text.secondary\"\n            sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}\n          >\n            {breadcrumbLabel}\n          </Link>\n            <Typography color=\"text.primary\" fontWeight={600}>\n              Edit Design\n            </Typography>\n        </Breadcrumbs>\n      </Box>\n\n      <Surface sx={surfaceStackSx}>\n        {/* Header */}\n        <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"flex-start\" spacing={1.5} flexWrap=\"wrap\">\n          <Box sx={{ minWidth: 0, flex: 1 }}>\n            <Stack direction=\"row\" spacing={1.5} alignItems=\"center\" flexWrap=\"wrap\">\n              <Typography variant=\"h5\" fontWeight={600}>\n                {template?.name || 'Design Editor'}\n              </Typography>\n              <AutoSaveIndicator lastSaved={lastSaved} dirty={dirty} />\n            </Stack>\n            <Typography variant=\"body2\" color=\"text.secondary\">\n              {templateId ? `ID: ${templateId}` : 'No template selected'}\n            </Typography>\n            {lastEditInfo && (\n              <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block', mt: 0.5 }}>\n                Last edit: {lastEditInfo.chipLabel}\n              </Typography>\n            )}\n            {diffSummary && (\n              <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block' }}>\n                Recent change: {diffSummary}\n              </Typography>\n            )}\n          </Box>\n\n          <Stack direction=\"row\" spacing={1.5} alignItems=\"center\" flexWrap=\"wrap\">\n            {/* Edit mode toggle */}\n            <ToggleButtonGroup\n              value={editMode}\n              exclusive\n              onChange={handleEditModeChange}\n              size=\"small\"\n              aria-label=\"Edit mode\"\n            >\n              <ToggleButton value=\"manual\" aria-label=\"Manual edit mode\">\n                <Tooltip title=\"Code Editor - Edit HTML directly with AI assistance\">\n                  <Stack direction=\"row\" spacing={0.5} alignItems=\"center\">\n                    <CodeIcon fontSize=\"small\" />\n                    <Typography variant=\"body2\" sx={{ display: { xs: 'none', sm: 'block' } }}>\n                      Code\n                    </Typography>\n                  </Stack>\n                </Tooltip>\n              </ToggleButton>\n              <ToggleButton value=\"chat\" aria-label=\"Chat edit mode\">\n                <Tooltip title=\"Chat Editor - Conversational AI editing\">\n                  <Stack direction=\"row\" spacing={0.5} alignItems=\"center\">\n                    <ChatIcon fontSize=\"small\" />\n                    <Typography variant=\"body2\" sx={{ display: { xs: 'none', sm: 'block' } }}>\n                      Chat\n                    </Typography>\n                  </Stack>\n                </Tooltip>\n              </ToggleButton>\n            </ToggleButtonGroup>\n\n            {/* Keyboard shortcuts button */}\n            <Tooltip title=\"Keyboard shortcuts\">\n              <IconButton size=\"small\" onClick={() => setShortcutsOpen(true)} aria-label=\"Keyboard shortcuts\">\n                <KeyboardIcon fontSize=\"small\" />\n              </IconButton>\n            </Tooltip>\n\n            <Button\n              variant=\"outlined\"\n              onClick={handleBack}\n              startIcon={<ArrowBackIcon />}\n              sx={{ textTransform: 'none', fontWeight: 600 }}\n            >\n              Back to {breadcrumbLabel}\n            </Button>\n          </Stack>\n        </Stack>\n\n        <AiUsageNotice\n          dense\n          title=\"AI editing\"\n          description=\"AI edits apply to this report design. Review changes before saving.\"\n          chips={[\n            { label: 'Source: Design + instructions', color: 'info', variant: 'outlined' },\n            { label: 'Confidence: Review required', color: 'warning', variant: 'outlined' },\n            { label: 'Undo available', color: 'success', variant: 'outlined' },\n          ]}\n          sx={{ mb: 1 }}\n        />\n\n        {/* Draft recovery banner */}\n        <DraftRecoveryBanner\n          show={hasDraft && !loading && editMode === 'manual'}\n          draftData={draftData}\n          onRestore={handleRestoreDraft}\n          onDiscard={discardDraft}\n        />\n\n        {/* Error display — show not-found with back link when template fails to load */}\n        {error && (\n          <Alert\n            severity=\"error\"\n            action={\n              <Button color=\"inherit\" size=\"small\" component={RouterLink} to={referrer}>\n                Back\n              </Button>\n            }\n          >\n            {error}\n          </Alert>\n        )}\n\n        {/* Main content — or not-found state when template fails to load */}\n        {!loading && error && !html ? (\n          <Box sx={{ textAlign: 'center', py: 8 }}>\n            <Typography variant=\"h6\" color=\"text.secondary\" gutterBottom>\n              Template Not Found\n            </Typography>\n            <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 3 }}>\n              The template &ldquo;{templateId}&rdquo; could not be loaded. It may have been deleted or the ID is invalid.\n            </Typography>\n            <Button variant=\"contained\" component={RouterLink} to=\"/templates\">\n              Go to Templates\n            </Button>\n          </Box>\n        ) : loading ? (\n          <>\n            <Divider />\n            <EditorSkeleton mode={editMode} />\n          </>\n        ) : editMode === 'chat' ? (\n          <>\n            <Divider />\n            <Grid container spacing={2.5} sx={{ alignItems: 'stretch' }}>\n              {/* Preview Panel */}\n              <Grid size={{ xs: 12, md: previewFullscreen ? 12 : 5 }} sx={{ minWidth: 0 }}>\n                <Stack spacing={1.5} sx={{ height: '100%' }}>\n                  <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\">\n                    <Typography variant=\"subtitle1\">Preview</Typography>\n                    <Tooltip title={previewFullscreen ? 'Exit fullscreen' : 'Fullscreen preview'}>\n                      <IconButton size=\"small\" onClick={() => setPreviewFullscreen(!previewFullscreen)} aria-label={previewFullscreen ? 'Exit fullscreen' : 'Fullscreen preview'}>\n                        {previewFullscreen ? <FullscreenExitIcon fontSize=\"small\" /> : <FullscreenIcon fontSize=\"small\" />}\n                      </IconButton>\n                    </Tooltip>\n                  </Stack>\n                  {previewUrl ? (\n                    <Box\n                      sx={{\n                        borderRadius: 1.5,\n                        border: '1px solid',\n                        borderColor: 'divider',\n                        bgcolor: 'background.paper',\n                        p: 1.5,\n                        minHeight: previewFullscreen ? 600 : 400,\n                        transition: 'min-height 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n                      }}\n                    >\n                      <ScaledIframePreview\n                        src={previewUrl}\n                        title={`Template preview for ${templateId}`}\n                        fit=\"contain\"\n                        pageShadow\n                        frameAspectRatio=\"210 / 297\"\n                        clampToParentHeight\n                      />\n                    </Box>\n                  ) : (\n                    <Box\n                      sx={{\n                        borderRadius: 1.5,\n                        border: '1px dashed',\n                        borderColor: 'divider',\n                        bgcolor: 'background.default',\n                        p: 2,\n                        minHeight: 400,\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                      }}\n                    >\n                      <Typography variant=\"body2\" color=\"text.secondary\">\n                        No HTML loaded yet.\n                      </Typography>\n                    </Box>\n                  )}\n                </Stack>\n              </Grid>\n\n              {/* Chat Editor */}\n              {!previewFullscreen && (\n                <Grid size={{ xs: 12, md: 7 }} sx={{ minWidth: 0 }}>\n                  <Box sx={{ height: 600 }}>\n                    <TemplateChatEditor\n                      templateId={templateId}\n                      templateName={template?.name || 'Template'}\n                      currentHtml={html}\n                      onHtmlUpdate={handleChatHtmlUpdate}\n                      onApplySuccess={handleChatApplySuccess}\n                    />\n                  </Box>\n                </Grid>\n              )}\n            </Grid>\n          </>\n        ) : (\n          <>\n            <Divider />\n            <Grid container spacing={2.5} sx={{ alignItems: 'stretch' }}>\n              {/* Preview Panel */}\n              <Grid size={{ xs: 12, md: previewFullscreen ? 12 : 6 }} sx={{ minWidth: 0 }}>\n                <Stack spacing={1.5} sx={{ height: '100%' }}>\n                  <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\">\n                    <Typography variant=\"subtitle1\">Preview</Typography>\n                    <Tooltip title={previewFullscreen ? 'Exit fullscreen' : 'Fullscreen preview'}>\n                      <IconButton size=\"small\" onClick={() => setPreviewFullscreen(!previewFullscreen)} aria-label={previewFullscreen ? 'Exit fullscreen' : 'Fullscreen preview'}>\n                        {previewFullscreen ? <FullscreenExitIcon fontSize=\"small\" /> : <FullscreenIcon fontSize=\"small\" />}\n                      </IconButton>\n                    </Tooltip>\n                  </Stack>\n                  {previewUrl ? (\n                    <Box\n                      sx={{\n                        borderRadius: 1.5,\n                        border: '1px solid',\n                        borderColor: 'divider',\n                        bgcolor: 'background.paper',\n                        p: 1.5,\n                        minHeight: previewFullscreen ? 500 : 200,\n                        flex: 1,\n                        transition: 'min-height 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n                      }}\n                    >\n                      <ScaledIframePreview\n                        src={previewUrl}\n                        title={`Template preview for ${templateId}`}\n                        fit=\"contain\"\n                        pageShadow\n                        frameAspectRatio=\"210 / 297\"\n                        clampToParentHeight\n                      />\n                    </Box>\n                  ) : (\n                    <Box\n                      sx={{\n                        borderRadius: 1.5,\n                        border: '1px dashed',\n                        borderColor: 'divider',\n                        bgcolor: 'background.default',\n                        p: 2,\n                        minHeight: 200,\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                      }}\n                    >\n                      <Typography variant=\"body2\" color=\"text.secondary\">\n                        No HTML loaded yet.\n                      </Typography>\n                    </Box>\n                  )}\n                </Stack>\n              </Grid>\n\n              {/* Editor Panel */}\n              {!previewFullscreen && (\n                <Grid size={{ xs: 12, md: 6 }} sx={{ minWidth: 0 }}>\n                  <Stack spacing={1.5} sx={{ height: '100%' }}>\n                    <Typography variant=\"subtitle1\">HTML &amp; AI Guidance</Typography>\n\n                    {/* HTML Editor */}\n                    <TextField\n                      label=\"Design HTML\"\n                      value={html}\n                      onChange={(e) => setHtml(e.target.value)}\n                      inputProps={{ 'aria-label': 'Template HTML' }}\n                      multiline\n                      minRows={10}\n                      maxRows={24}\n                      fullWidth\n                      variant=\"outlined\"\n                      size=\"small\"\n                      error={dirty}\n                      helperText={\n                        dirty\n                          ? `Unsaved changes. Press ${getShortcutDisplay('save')} to save.`\n                          : 'HTML is in sync with the saved template.'\n                      }\n                      InputLabelProps={{ shrink: true }}\n                      sx={{\n                        '& .MuiInputBase-input': {\n                          fontFamily: 'monospace',\n                          fontSize: '14px',\n                        },\n                      }}\n                    />\n\n                    {/* AI Instructions */}\n                    <TextField\n                      label=\"AI Instructions\"\n                      value={instructions}\n                      onChange={(e) => setInstructions(e.target.value)}\n                      multiline\n                      rows={3}\n                      InputProps={{ inputComponent: FixedTextarea }}\n                      fullWidth\n                      variant=\"outlined\"\n                      size=\"small\"\n                      placeholder=\"Describe how the template should change. AI will preserve tokens and structure unless you ask otherwise.\"\n                      helperText={\n                        hasInstructions\n                          ? `Press ${getShortcutDisplay('applyAi')} or click Apply to run AI.`\n                          : 'Enter instructions to enable AI editing.'\n                      }\n                      InputLabelProps={{ shrink: true }}\n                    />\n\n                    {/* Action Buttons */}\n                    <Stack direction=\"row\" spacing={1} flexWrap=\"wrap\" sx={{ gap: 1 }}>\n                      <Button\n                        variant=\"contained\"\n                        color=\"primary\"\n                        onClick={handleSave}\n                        disabled={saving || loading || !dirty || aiBusy}\n                        startIcon={saving ? <CircularProgress size={16} /> : <SaveIcon />}\n                        sx={{ minWidth: 110 }}\n                      >\n                        {saving ? 'Saving...' : 'Save'}\n                      </Button>\n                      <Button\n                        variant=\"outlined\"\n                        onClick={handleApplyAi}\n                        disabled={aiBusy || loading || !hasInstructions}\n                        startIcon={aiBusy ? <CircularProgress size={16} /> : <AutoFixHighIcon />}\n                        sx={{ minWidth: 130, color: 'text.secondary', borderColor: 'divider' }}\n                      >\n                        {aiBusy ? 'Applying...' : 'Apply AI'}\n                      </Button>\n                      <Button\n                        variant=\"text\"\n                        color=\"inherit\"\n                        onClick={handleUndo}\n                        disabled={undoBusy || loading}\n                        startIcon={undoBusy ? <CircularProgress size={16} /> : <UndoIcon />}\n                      >\n                        {undoBusy ? 'Undoing...' : 'Undo'}\n                      </Button>\n                      <Button\n                        variant=\"text\"\n                        onClick={() => setDiffOpen(true)}\n                        disabled={loading || !dirty}\n                        startIcon={<CompareArrowsIcon />}\n                        sx={{ color: 'text.secondary' }}\n                      >\n                        View Diff\n                      </Button>\n                    </Stack>\n\n                    <Typography variant=\"caption\" color=\"text.secondary\">\n                      AI edits are generated and may need review before use in production runs.\n                    </Typography>\n\n                    {/* Keyboard shortcuts hint */}\n                    <KeyboardShortcutsPanel compact />\n\n                    {/* Edit History */}\n                    <EditHistoryTimeline history={history} maxVisible={5} />\n                  </Stack>\n                </Grid>\n              )}\n            </Grid>\n          </>\n        )}\n      </Surface>\n\n      {/* Enhanced Diff Dialog */}\n      <Dialog\n        open={diffOpen}\n        onClose={() => setDiffOpen(false)}\n        maxWidth=\"lg\"\n        fullWidth\n        PaperProps={{\n          sx: { height: '80vh', maxHeight: 800 },\n        }}\n      >\n        <DialogTitle sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n          <Box>\n            <Typography variant=\"h6\">HTML Changes</Typography>\n            <Typography variant=\"caption\" color=\"text.secondary\">\n              Compare saved version with current edits\n            </Typography>\n          </Box>\n          <Tooltip title=\"Close\">\n            <IconButton onClick={() => setDiffOpen(false)} aria-label=\"Close dialog\">\n              <CloseIcon />\n            </IconButton>\n          </Tooltip>\n        </DialogTitle>\n        <DialogContent dividers sx={{ p: 0, display: 'flex', flexDirection: 'column' }}>\n          <EnhancedDiffViewer beforeText={initialHtml} afterText={html} contextLines={3} />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setDiffOpen(false)}>Close</Button>\n          <Button\n            variant=\"contained\"\n            onClick={() => {\n              handleSave()\n              setDiffOpen(false)\n            }}\n            disabled={saving || !dirty}\n          >\n            Save Changes\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* Keyboard Shortcuts Dialog */}\n      <Dialog\n        open={shortcutsOpen}\n        onClose={() => setShortcutsOpen(false)}\n        maxWidth=\"xs\"\n        fullWidth\n      >\n        <DialogTitle sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n          Keyboard Shortcuts\n          <Tooltip title=\"Close\">\n            <IconButton onClick={() => setShortcutsOpen(false)} aria-label=\"Close dialog\">\n              <CloseIcon />\n            </IconButton>\n          </Tooltip>\n        </DialogTitle>\n        <DialogContent>\n          <KeyboardShortcutsPanel />\n        </DialogContent>\n      </Dialog>\n\n      <ConfirmModal\n        open={modeSwitchConfirm.open}\n        onClose={() => setModeSwitchConfirm({ open: false, nextMode: null })}\n        onConfirm={() => {\n          if (dirty) {\n            saveDraft(html, instructions)\n          }\n          setModeSwitchConfirm({ open: false, nextMode: null })\n          setEditMode(modeSwitchConfirm.nextMode || 'chat')\n          toast.show('Draft saved. Your current edits are still available in chat and manual modes.', 'info')\n        }}\n        title=\"Switch to Chat Mode\"\n        message=\"Switching to chat mode keeps your current edits and saves a draft for manual mode.\"\n        confirmLabel=\"Switch\"\n        severity=\"warning\"\n      />\n    </>\n  )\n}\n","import { useInteraction } from '@/components/ux/governance'\nimport TemplateEditorContainer from '@/features/generate/containers/TemplateEditor'\n\nexport default function TemplateEditor() {\n  useInteraction()\n  return <TemplateEditorContainer />\n}\n"],"names":["getAlertTitleUtilityClass","slot","generateUtilityClass","generateUtilityClasses","useUtilityClasses","ownerState","classes","composeClasses","AlertTitleRoot","styled","Typography","memoTheme","theme","AlertTitle","React.forwardRef","inProps","ref","props","useDefaultProps","className","other","clsx","DeleteOutlineIcon","createSvgIcon","_jsx","FullscreenExitIcon","KeyboardArrowUpIcon","RemoveIcon","UnfoldLessIcon","UnfoldMoreIcon","LAST_EDIT_TYPE_LABELS","LAST_EDIT_TYPE_COLORS","LAST_EDIT_TYPE_VARIANTS","pad","value","formatLastEditTimestamp","isoString","date","buildLastEditInfo","source","rawType","type","typeLabel","timestampLabel","chipLabel","escapeHtml","str","highlightHtml","text","highlighted","match","bracket","slash","tag","space","attr","eq","jsx","sanitizeCodeHighlight","computeDiff","beforeText","afterText","contextLines","beforeLines","afterLines","result","maxLen","unchangedStart","unchangedBuffer","i","beforeLine","afterLine","DiffLine","item","viewMode","expanded","onToggleExpand","syntaxHighlight","lineNumberSx","contentSx","secondary","neutral","jsxs","Box","alpha","AddIcon","Fragment","EnhancedDiffViewer","setViewMode","useState","setSyntaxHighlight","expandedSections","setExpandedSections","currentDiffIndex","setCurrentDiffIndex","diff","useMemo","stats","added","removed","modified","diffIndices","idx","handleToggleExpand","startLine","prev","next","navigateDiff","direction","newIndex","Stack","Chip","CompareArrowsIcon","Tooltip","IconButton","KeyboardArrowDownIcon","ToggleButtonGroup","e","v","ToggleButton","EDIT_TYPE_CONFIG","EditIcon","SmartToyIcon","ChatIcon","UndoIcon","HistoryIcon","formatRelativeTime","timestamp","seconds","minutes","hours","days","HistoryEntry","entry","isLatest","config","Icon","AccessTimeIcon","MAX_HISTORY_ENTRIES","EditHistoryTimeline","history","maxVisible","setExpanded","filter","setFilter","filteredHistory","filtered","visibleHistory","hasMore","editTypes","types","FilterListIcon","t","TypeIcon","ExpandLessIcon","ExpandMoreIcon","EditorSkeleton","mode","Grid","Skeleton","useEditorKeyboardShortcuts","onSave","onUndo","onRedo","onApplyAi","onEscape","enabled","dirty","hasInstructions","handleKeyDown","useCallback","event","modKey","shiftKey","useEffect","getShortcutDisplay","shortcut","EDITOR_SHORTCUTS","ShortcutKey","children","ShortcutDisplay","shortcutKey","parts","part","KeyboardShortcutsPanel","compact","KeyboardIcon","formatTimeAgo","DraftRecoveryBanner","show","draftData","onRestore","onDiscard","restoring","Collapse","Alert","RestoreIcon","Button","AutoSaveIndicator","lastSaved","DRAFT_PREFIX","DRAFT_EXPIRY_MS","useEditorDraft","templateId","autoSaveInterval","hasDraft","setHasDraft","setDraftData","setLastSaved","autoSaveTimerRef","useRef","pendingContentRef","storageKey","stored","parsed","err","k","key","saveDraft","html","instructions","draft","discardDraft","scheduleAutoSave","clearDraftAfterSave","surfaceStackSx","FixedTextarea","forwardRef","TemplateEditor","useParams","navigate","useNavigateInteraction","location","useLocation","toast","useToast","execute","useInteraction","templates","useAppStore","state","updateTemplateEntry","referrer","template","loading","setLoading","setHtml","initialHtml","setInitialHtml","setInstructions","previewUrl","setPreviewUrl","saving","setSaving","aiBusy","setAiBusy","undoBusy","setUndoBusy","serverMeta","setServerMeta","diffSummary","setDiffSummary","setHistory","error","setError","editMode","setEditMode","diffOpen","setDiffOpen","shortcutsOpen","setShortcutsOpen","previewFullscreen","setPreviewFullscreen","modeSwitchConfirm","setModeSwitchConfirm","navigator","useContext","UNSAFE_NavigationContext","dirtyRef","originalPush","originalReplace","args","syncTemplateMetadata","metadata","tpl","prevGenerator","nextSummary","fields","summaryChanged","field","loadTemplate","data","getTemplateHtml","nextHtml","blob","url","handleBeforeUnload","handleSave","InteractionType","Reversibility","editTemplateManual","handleApplyAi","editTemplateAi","changes","handleUndo","undoTemplateEdit","handleBack","handleEditModeChange","newMode","handleChatHtmlUpdate","newHtml","handleChatApplySuccess","handleRestoreDraft","lastEditInfo","breadcrumbLabel","Breadcrumbs","NavigateNextIcon","Link","RouterLink","Surface","CodeIcon","ArrowBackIcon","AiUsageNotice","Divider","FullscreenIcon","ScaledIframePreview","TemplateChatEditor","TextField","CircularProgress","SaveIcon","AutoFixHighIcon","Dialog","DialogTitle","CloseIcon","DialogContent","DialogActions","ConfirmModal","TemplateEditorContainer"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7]}