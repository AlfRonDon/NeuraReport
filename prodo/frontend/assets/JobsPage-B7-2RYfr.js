import{g as nt,j as t,u as lt,v as it,w as ct,a as Re,r as s,R as D,I as R,aK as dt,aL as ut,aM as pt,aN as bt,aO as T,aP as ft,$ as ye,aQ as Ce,aR as re,aS as xt,a0 as gt,o as S,B as w,T as V,a4 as le,A as Ie,X as mt,E as ht,aT as Y,aU as G,aV as je,aW as ke,aX as yt,ag as Ct,q as jt,N as x,p as Te,f as d,n as m,a5 as we,a6 as kt,a7 as wt,aY as St,aZ as vt,e as Ee,a_ as Dt,O as Me,M as Rt,ah as It,aj as Tt,al as Et,ak as Mt,am as At,K as zt}from"./index-COTlR4Mk.js";import{M as Lt}from"./MoreVert-C6fI3_5K.js";import{P as _t}from"./Visibility-BrMHOUUu.js";import{D as Jt}from"./DataTable-DCTRUeN1.js";import{C as se}from"./ConfirmModal-BKTCaXkL.js";import"./KeyboardArrowDown-CbAvUKjN.js";import"./FilterList-B2nv-Yj9.js";import"./Check-JruGOof3.js";import"./TableRow-9uVWzbJ3.js";import"./TableContainer-BGfNH4cD.js";import"./KeyboardArrowRight-C1lIa1Bi.js";import"./CheckCircleOutline-KPLvK3qz.js";import"./WarningAmber-Ua-LQj3f.js";const Se=nt(t.jsx("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"})),$t=x(w)(({theme:e})=>({padding:e.spacing(3),maxWidth:1400,margin:"0 auto",width:"100%",minHeight:"100vh",backgroundColor:e.palette.background.default})),Pt=x(Dt)(({theme:e})=>({"& .MuiPaper-root":{backgroundColor:d(e.palette.background.paper,.95),backdropFilter:"blur(20px)",border:`1px solid ${d(e.palette.divider,.1)}`,borderRadius:8,boxShadow:`0 8px 32px ${d(e.palette.common.black,.15)}`,minWidth:180,animation:`${Me} 0.2s ease-out`}})),H=x(Rt)(({theme:e})=>({borderRadius:8,margin:e.spacing(.5,1),padding:e.spacing(1,1.5),fontSize:"14px",transition:"all 0.15s cubic-bezier(0.22, 1, 0.36, 1)","&:hover":{backgroundColor:e.palette.mode==="dark"?d(e.palette.text.primary,.08):m[100]},"& .MuiListItemIcon-root":{minWidth:32}})),Bt=x(It)(({theme:e})=>({"& .MuiBackdrop-root":{backgroundColor:d(e.palette.common.black,.6),backdropFilter:"blur(8px)"},"& .MuiDialog-paper":{backgroundColor:d(e.palette.background.paper,.95),backdropFilter:"blur(20px)",border:`1px solid ${d(e.palette.divider,.1)}`,borderRadius:8,boxShadow:`0 24px 64px ${d(e.palette.common.black,.25)}`,animation:`${Me} 0.3s ease-out`}})),Nt=x(Tt)(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"space-between",padding:e.spacing(2.5,3),fontSize:"1.125rem",fontWeight:600})),Ot=x(Ee)(({theme:e})=>({width:32,height:32,borderRadius:8,color:e.palette.text.secondary,transition:"all 0.2s cubic-bezier(0.22, 1, 0.36, 1)","&:hover":{backgroundColor:e.palette.mode==="dark"?d(e.palette.text.primary,.08):m[100],color:e.palette.text.primary,transform:"rotate(90deg)"}})),Ft=x(Et)(({theme:e})=>({padding:e.spacing(0,3,3),borderTop:`1px solid ${d(e.palette.divider,.08)}`,borderBottom:`1px solid ${d(e.palette.divider,.08)}`})),Wt=x(At)(({theme:e})=>({padding:e.spacing(2,3),gap:e.spacing(1)})),E=x(S)(({theme:e})=>({fontSize:"12px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",color:e.palette.text.secondary,marginBottom:e.spacing(.5)})),ae=x(S)(({theme:e})=>({fontSize:"14px",color:e.palette.text.primary})),ne=x(S)(({theme:e})=>({fontFamily:"var(--font-mono, monospace)",fontSize:"0.75rem",color:e.palette.text.secondary,whiteSpace:"nowrap"})),ve=x(Te,{shouldForwardProp:e=>!["statusColor","statusBg"].includes(e)})(({theme:e,statusColor:n,statusBg:I})=>({borderRadius:8,fontWeight:600,fontSize:"12px",backgroundColor:I,color:n,"& .MuiChip-icon":{marginLeft:e.spacing(.5),color:n}})),Ut=x(Te)(({theme:e})=>({borderRadius:8,fontWeight:500,fontSize:"12px",textTransform:"capitalize",backgroundColor:d(e.palette.text.primary,.08),color:e.palette.text.secondary})),Vt=x(vt)(({theme:e})=>({borderRadius:4,height:6,backgroundColor:e.palette.mode==="dark"?d(e.palette.text.primary,.1):m[100],"& .MuiLinearProgress-bar":{borderRadius:4,background:e.palette.mode==="dark"?m[500]:m[700]}})),X=x(zt)(({theme:e})=>({borderRadius:8,textTransform:"none",fontWeight:500,fontSize:"14px",padding:e.spacing(.75,2),transition:"all 0.2s cubic-bezier(0.22, 1, 0.36, 1)"}));x(X)(({theme:e})=>({background:e.palette.mode==="dark"?m[700]:m[900],color:e.palette.common.white,boxShadow:`0 4px 14px ${d(e.palette.common.black,.15)}`,"&:hover":{background:e.palette.mode==="dark"?m[500]:m[700],boxShadow:`0 6px 20px ${d(e.palette.common.black,.2)}`,transform:"translateY(-1px)"}}));const Yt=x(w)(({theme:e})=>({marginTop:e.spacing(1),padding:e.spacing(1.5),backgroundColor:d(e.palette.background.paper,.4),borderRadius:8,border:`1px solid ${d(e.palette.divider,.1)}`,fontFamily:"var(--font-mono, monospace)",fontSize:"0.75rem",whiteSpace:"pre-wrap",color:e.palette.text.secondary,maxHeight:260,overflow:"auto","&::-webkit-scrollbar":{width:6},"&::-webkit-scrollbar-track":{background:"transparent"},"&::-webkit-scrollbar-thumb":{background:d(e.palette.text.primary,.2),borderRadius:1}})),M=x(Mt)(({theme:e})=>({borderColor:d(e.palette.divider,.08),margin:e.spacing(2,0)})),Gt=x(Ie)(({theme:e})=>({borderRadius:8,backgroundColor:e.palette.mode==="dark"?d(e.palette.text.primary,.08):m[100],border:`1px solid ${d(e.palette.divider,.2)}`,"& .MuiAlert-icon":{color:e.palette.text.secondary}})),Ht=x(Ee)(({theme:e})=>({color:e.palette.text.secondary,transition:"all 0.2s cubic-bezier(0.22, 1, 0.36, 1)","&:hover":{color:e.palette.text.primary,backgroundColor:e.palette.mode==="dark"?d(e.palette.text.primary,.08):m[100]}})),De=(e,n)=>{const I={pending:{icon:we,color:e.palette.text.secondary,bgColor:e.palette.mode==="dark"?d(e.palette.text.primary,.05):m[50],label:"Pending"},running:{icon:St,color:e.palette.text.secondary,bgColor:e.palette.mode==="dark"?d(e.palette.text.primary,.1):m[100],label:"Running"},completed:{icon:wt,color:e.palette.text.secondary,bgColor:e.palette.mode==="dark"?d(e.palette.text.primary,.1):m[100],label:"Completed"},failed:{icon:kt,color:e.palette.text.secondary,bgColor:e.palette.mode==="dark"?d(e.palette.text.primary,.05):m[100],label:"Failed"},cancelled:{icon:le,color:e.palette.text.secondary,bgColor:e.palette.mode==="dark"?d(e.palette.text.primary,.05):m[50],label:"Cancelled"},cancelling:{icon:we,color:e.palette.text.secondary,bgColor:e.palette.mode==="dark"?d(e.palette.text.primary,.05):m[50],label:"Cancelling..."}};return I[n]||I.pending};function Xt(){const e=lt(),n=it(),I=ct(),{execute:h}=Re(),Ae=s.useCallback((o,r,a={})=>I(o,{label:r,intent:{from:"jobs",...a}}),[I]),u=s.useCallback((o,r,a={})=>h({type:R.EXECUTE,label:o,reversibility:D.FULLY_REVERSIBLE,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{from:"jobs",...a},action:r}),[h]),$=s.useCallback((o,r,a={})=>h({type:R.DOWNLOAD,label:o,reversibility:D.FULLY_REVERSIBLE,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{from:"jobs",...a},action:r}),[h]),[j,A]=s.useState([]),[ze,P]=s.useState(!1),[Le,K]=s.useState(!1),[_,ie]=s.useState(null),[ce,de]=s.useState(null),[b,ue]=s.useState(null),[_e,q]=s.useState(!1),[l,Je]=s.useState(null),[B,N]=s.useState(!1),[g,pe]=s.useState([]),[$e,O]=s.useState(!1),[Pe,J]=s.useState(!1),[F,W]=s.useState(!1),[be,Be]=s.useState(()=>dt().autoRefreshJobs??!0),Q=s.useRef(null),z=s.useRef(null),Z=s.useRef(!0),k=s.useRef(!1),L=s.useRef(null);s.useEffect(()=>ut(r=>{Be(r?.autoRefreshJobs??!0)}),[]);const y=s.useCallback(async(o=!1)=>{if(!(!o&&k.current)){L.current&&L.current.abort(),L.current=new AbortController;try{const r=await pt({limit:50,signal:L.current.signal});if(Z.current&&(o||!k.current)){const a=Array.isArray(r.jobs)?r.jobs.map(c=>bt(c)):[];A(a)}}catch(r){r.name!=="AbortError"&&console.error("Failed to fetch jobs:",r)}}},[]);s.useEffect(()=>(Z.current=!0,P(!0),y(!0).finally(()=>P(!1)),be&&(Q.current=setInterval(()=>y(!1),5e3)),()=>{Z.current=!1,Q.current&&clearInterval(Q.current),L.current&&L.current.abort()}),[y,be]);const fe=s.useCallback((o,r)=>{de(o),ue(r)},[]),v=s.useCallback(()=>{de(null),ue(null)},[]),U=s.useCallback(o=>{Je(o),q(!0)},[]),xe=s.useCallback(()=>{q(!1)},[]),Ne=s.useCallback((o,r)=>{o.stopPropagation();const a=o.currentTarget;return u("Open job actions",()=>fe(a,r),{jobId:r?.id})},[u,fe]),Oe=s.useCallback(()=>u("Close job actions",()=>v()),[u,v]),ge=s.useCallback(()=>h({type:R.EXECUTE,label:"Refresh jobs",reversibility:D.FULLY_REVERSIBLE,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{from:"jobs",action:"refresh_jobs"},action:async()=>{P(!0);try{await y(),n.show("Progress updated","info")}finally{P(!1)}}}),[h,y,n]),Fe=s.useCallback(()=>{if(b)return u("Review cancel job",()=>{ie(b),K(!0),v()},{jobId:b.id})},[u,b,v]),We=s.useCallback(async()=>{_&&await h({type:R.UPDATE,label:"Cancel job",reversibility:D.SYSTEM_MANAGED,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{jobId:_.id,action:"cancel_job"},action:async()=>{k.current=!0,A(o=>o.map(r=>r.id===_.id?{...r,status:T.CANCELLING}:r)),K(!1);try{await ft(_.id),n.show("Job cancelled","success")}catch(o){throw n.show(o.message||"Failed to cancel job","error"),o}finally{ie(null),k.current=!1,y(!0)}}})},[_,n,y,h]),Ue=s.useCallback(()=>$("Download job output",()=>{b?.artifacts?.html_url?window.open(ye(b.artifacts.html_url),"_blank"):n.show("Download not available","warning"),v()},{jobId:b?.id,format:"html"}),[$,b,n,v]),Ve=s.useCallback(()=>{if(b)return u("Open job details",()=>{U(b),v()},{jobId:b.id})},[u,b,U,v]),Ye=s.useCallback(o=>u("Open job details",()=>U(o),{jobId:o?.id,source:"jobs-table"}),[u,U]),Ge=s.useCallback(async()=>{b&&await h({type:R.UPDATE,label:"Retry job",reversibility:D.SYSTEM_MANAGED,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{jobId:b.id,action:"retry_job"},action:async()=>{k.current=!0,N(!0),v();try{await Ce(b.id),n.show("Job restarted successfully","success")}catch(o){throw n.show(o.message||"Failed to retry job","error"),o}finally{N(!1),k.current=!1,y(!0)}}})},[b,n,y,v,h]),me=s.useCallback(()=>{if(g.length)return u("Review cancel jobs",()=>{if(!g.some(r=>{const a=j.find(c=>c.id===r);return re(a?.status)})){n.show("Select running or pending jobs to cancel","warning");return}O(!0)},{count:g.length})},[u,j,g,n]),He=s.useCallback(async()=>{const o=g.filter(r=>{const a=j.find(c=>c.id===r);return re(a?.status)});if(!o.length){n.show("Select running or pending jobs to cancel","warning"),O(!1);return}await h({type:R.UPDATE,label:"Cancel selected jobs",reversibility:D.SYSTEM_MANAGED,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{jobIds:o,action:"bulk_cancel_jobs"},action:async()=>{k.current=!0;const r=new Set(o);A(a=>a.map(c=>r.has(c.id)?{...c,status:T.CANCELLING}:c)),O(!1),W(!0);try{const a=await xt(o),c=a?.cancelledCount??a?.cancelled?.length??0,i=a?.failedCount??a?.failed?.length??0;return i>0?n.show(`Cancelled ${c} job${c!==1?"s":""}, ${i} failed`,"warning"):n.show(`Cancelled ${c} job${c!==1?"s":""}`,"success"),a}catch(a){throw n.show(a.message||"Failed to cancel jobs","error"),a}finally{W(!1),k.current=!1,y(!0)}}})},[g,j,n,y,h]),Xe=s.useCallback(()=>{if(g.length)return u("Review delete jobs",()=>J(!0),{count:g.length})},[u,g]),Ke=s.useCallback(o=>u("Select jobs",()=>pe(o),{count:o.length}),[u]),qe=s.useCallback(()=>u("Close cancel confirmation",()=>K(!1)),[u]),Qe=s.useCallback(()=>u("Close bulk cancel",()=>O(!1)),[u]),Ze=s.useCallback(()=>u("Close bulk delete",()=>J(!1)),[u]),ee=s.useCallback(()=>u("Close job details",()=>xe()),[u,xe]),et=s.useCallback(()=>$("Download job output",()=>{const o=l?.artifacts?.html_url;o?window.open(ye(o),"_blank"):n.show("Download not available","warning")},{jobId:l?.id,format:"html"}),[$,l,n]),tt=s.useCallback(()=>{if(l)return h({type:R.UPDATE,label:"Retry job",reversibility:D.SYSTEM_MANAGED,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{jobId:l.id,action:"retry_job",source:"details"},action:async()=>{N(!0);try{await Ce(l.id),n.show("Job restarted successfully","success"),q(!1),y()}catch(o){throw n.show(o.message||"Failed to retry job","error"),o}finally{N(!1)}}})},[l,n,y,h]),ot=s.useCallback(async()=>{if(!g.length){J(!1);return}const o=[...g],r=j.filter(i=>o.includes(i.id));if(!r.length){J(!1);return}J(!1),pe([]),z.current?.timeoutId&&(clearTimeout(z.current.timeoutId),z.current=null),k.current=!0,A(i=>i.filter(p=>!o.includes(p.id)));let a=!1;const c=setTimeout(async()=>{a||await h({type:R.DELETE,label:"Delete jobs",reversibility:D.SYSTEM_MANAGED,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{jobIds:o,action:"bulk_delete_jobs"},action:async()=>{W(!0);try{const i=await gt(o),p=i?.deletedCount??i?.deleted?.length??0,C=i?.failedCount??i?.failed?.length??0;return C>0?n.show(`Removed ${p} job${p!==1?"s":""}, ${C} failed`,"warning"):n.show(`Removed ${p} job${p!==1?"s":""}`,"success"),i}catch(i){throw A(p=>{const C=new Set(p.map(oe=>oe.id)),f=r.filter(oe=>!C.has(oe.id));return f.length?[...p,...f]:p}),n.show(i.message||"Failed to delete jobs","error"),i}finally{W(!1),k.current=!1,z.current=null,y(!0)}}})},5e3);z.current={timeoutId:c,ids:o,jobs:r},n.showWithUndo(`Removed ${o.length} job${o.length!==1?"s":""} from history`,()=>{a=!0,clearTimeout(c),z.current=null,A(i=>{const p=new Set(i.map(f=>f.id)),C=r.filter(f=>!p.has(f.id));return C.length?[...i,...C]:i}),k.current=!1,n.show("Jobs restored","success")},{severity:"info"})},[g,j,n,y,h]),rt=s.useMemo(()=>[{field:"id",headerName:"Job ID",width:160,renderCell:o=>t.jsxs(ne,{children:[o?.slice(0,12),"..."]})},{field:"type",headerName:"Type",width:140,renderCell:o=>{const a={run_report:"Report Run",verify_template:"Verify Design",verify_excel:"Verify Excel",recommend_templates:"Recommendations",summary_generate:"Summary",summary_report:"Report Summary",chart_analyze:"Chart Analyze",chart_generate:"Chart Generate"}[o]||(o||"report").replace(/_/g," ");return t.jsx(Ut,{label:a,size:"small"})}},{field:"templateName",headerName:"Design",width:220,renderCell:(o,r)=>t.jsx(S,{sx:{fontSize:"14px",color:"text.secondary",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:200},children:o||r.templateId?.slice(0,12)||"-"})},{field:"status",headerName:"Status",width:140,renderCell:o=>{const r=De(e,o),a=r.icon;return t.jsx(ve,{icon:t.jsx(a,{sx:{fontSize:14}}),label:r.label,size:"small",statusColor:r.color,statusBg:r.bgColor})}},{field:"progress",headerName:"Progress",width:150,renderCell:(o,r)=>{if(r.status===T.COMPLETED)return t.jsx(S,{sx:{fontSize:"0.75rem",color:"text.secondary",fontWeight:600},children:"100%"});if(r.status===T.FAILED||r.status===T.CANCELLED)return t.jsx(S,{sx:{fontSize:"0.75rem",color:"text.disabled"},children:"-"});const a=o||0;return t.jsxs(w,{sx:{width:"100%",display:"flex",alignItems:"center",gap:1},children:[t.jsx(Vt,{variant:"determinate",value:a,sx:{flex:1}}),t.jsxs(S,{sx:{fontSize:"0.75rem",color:"text.secondary",minWidth:32},children:[a,"%"]})]})}},{field:"createdAt",headerName:"Started",width:160,renderCell:o=>{if(!o)return t.jsx(S,{sx:{fontSize:"14px",color:"text.disabled"},children:"-"});const r=new Date(o),c=new Date-r,i=Math.floor(c/6e4),p=Math.floor(c/36e5),C=Math.floor(c/864e5);let f;return i<1?f="Just now":i<60?f=`${i}m ago`:p<24?f=`${p}h ago`:C<7?f=`${C}d ago`:f=r.toLocaleDateString(),t.jsx(V,{title:r.toLocaleString(),arrow:!0,children:t.jsx(S,{sx:{fontSize:"14px",color:"text.secondary",cursor:"default"},children:f})})}},{field:"finishedAt",headerName:"Completed",width:160,renderCell:o=>{if(!o)return t.jsx(S,{sx:{fontSize:"14px",color:"text.disabled"},children:"-"});const r=new Date(o),c=new Date-r,i=Math.floor(c/6e4),p=Math.floor(c/36e5),C=Math.floor(c/864e5);let f;return i<1?f="Just now":i<60?f=`${i}m ago`:p<24?f=`${p}h ago`:C<7?f=`${C}d ago`:f=r.toLocaleDateString(),t.jsx(V,{title:r.toLocaleString(),arrow:!0,children:t.jsx(S,{sx:{fontSize:"14px",color:"text.secondary",cursor:"default"},children:f})})}}],[e]),st=s.useMemo(()=>[{key:"status",label:"Status",options:[{value:"pending",label:"Pending"},{value:"running",label:"Running"},{value:"completed",label:"Completed"},{value:"failed",label:"Failed"},{value:"cancelled",label:"Cancelled"}]},{key:"type",label:"Type",options:[{value:"run_report",label:"Report"},{value:"verify_template",label:"Verify Template"},{value:"verify_excel",label:"Verify Excel"},{value:"recommend_templates",label:"Recommendations"},{value:"summary_generate",label:"Summary"},{value:"summary_report",label:"Report Summary"},{value:"chart_analyze",label:"Chart Analyze"},{value:"chart_generate",label:"Chart Generate"}]}],[]),he=s.useMemo(()=>{const o=new Set(["running","pending"]),r=new Map(j.map(a=>[a.id,a.status]));return g.filter(a=>o.has(r.get(a))).length},[j,g]),at=s.useMemo(()=>[{label:"Cancel",icon:t.jsx(le,{sx:{fontSize:16}}),onClick:me,disabled:F}],[F,me]),te=s.useMemo(()=>j.filter(o=>re(o.status)).length,[j]);return t.jsxs($t,{children:[t.jsx(Ie,{severity:"info",sx:{mb:2,borderRadius:1},children:"Jobs track background report runs. Removing a job only clears it from this list; downloaded files remain in History."}),t.jsx(Jt,{title:"Report Progress",subtitle:te>0?`${te} report${te>1?"s":""} generating`:"All reports complete",columns:rt,data:j,loading:ze,searchPlaceholder:"Search reports...",filters:st,selectable:!0,onSelectionChange:Ke,onRowClick:Ye,bulkActions:at,onBulkDelete:Xe,actions:[{label:"Refresh",icon:t.jsx(ht,{sx:{fontSize:18}}),variant:"outlined",onClick:ge}],onRefresh:ge,rowActions:o=>t.jsx(V,{title:"More actions",children:t.jsx(Ht,{size:"small",onClick:r=>Ne(r,o),"aria-label":"More actions",children:t.jsx(Lt,{sx:{fontSize:18}})})}),emptyState:{icon:mt,title:"No reports in progress",description:"When you create a report, you can track its progress here.",actionLabel:"Create Report",onAction:()=>Ae("/reports","Open reports")}}),t.jsxs(Pt,{anchorEl:ce,open:!!ce,onClose:Oe,children:[t.jsxs(H,{onClick:Ve,children:[t.jsx(Y,{children:t.jsx(_t,{sx:{fontSize:16}})}),t.jsx(G,{primaryTypographyProps:{fontSize:"14px"},children:"View Details"})]}),b?.status===T.COMPLETED&&b?.artifacts?.html_url&&t.jsxs(H,{onClick:Ue,children:[t.jsx(Y,{children:t.jsx(je,{sx:{fontSize:16}})}),t.jsx(G,{primaryTypographyProps:{fontSize:"14px"},children:"Download"})]}),ke(b?.status)&&t.jsxs(H,{onClick:Ge,disabled:B,children:[t.jsx(Y,{children:t.jsx(Se,{sx:{fontSize:16}})}),t.jsx(G,{primaryTypographyProps:{fontSize:"14px"},children:B?"Retrying...":"Retry"})]}),yt(b?.status)&&t.jsxs(H,{onClick:Fe,sx:{color:"text.secondary"},children:[t.jsx(Y,{children:t.jsx(le,{sx:{fontSize:16,color:"text.secondary"}})}),t.jsx(G,{primaryTypographyProps:{fontSize:"14px"},children:"Cancel"})]})]}),t.jsx(se,{open:Le,onClose:qe,onConfirm:We,title:"Cancel Job",message:"Are you sure you want to cancel this job? This action cannot be undone.",confirmLabel:"Cancel Job",severity:"warning"}),t.jsx(se,{open:$e,onClose:Qe,onConfirm:He,title:"Cancel Jobs",message:`Cancel ${he} running job${he!==1?"s":""}?`,confirmLabel:"Cancel Jobs",severity:"warning",loading:F}),t.jsx(se,{open:Pe,onClose:Ze,onConfirm:ot,title:"Delete Jobs",message:(()=>{const a=j.filter(p=>g.includes(p.id)).slice(0,3).map(p=>p.templateName||p.id?.slice(0,8)||"Unknown").join(", "),c=g.length-3,i=c>0?` and ${c} more`:"";return`Remove ${g.length} job${g.length!==1?"s":""} (${a}${i}) from history? You can undo within a few seconds. Downloaded files are not affected.`})(),confirmLabel:"Delete Jobs",severity:"error",loading:F}),t.jsxs(Bt,{open:_e,onClose:ee,maxWidth:"sm",fullWidth:!0,children:[t.jsxs(Nt,{children:["Job Details",t.jsx(V,{title:"Close",children:t.jsx(Ot,{size:"small",onClick:ee,"aria-label":"Close dialog",children:t.jsx(Ct,{sx:{fontSize:18}})})})]}),t.jsx(Ft,{children:l&&t.jsxs(jt,{spacing:2,sx:{pt:2},children:[t.jsxs(w,{children:[t.jsx(E,{children:"Job ID"}),t.jsx(ne,{sx:{fontSize:"14px"},children:l.id})]}),t.jsx(M,{}),t.jsxs(w,{children:[t.jsx(E,{children:"Status"}),t.jsx(w,{sx:{mt:.5},children:(()=>{const o=De(e,l.status),r=o.icon;return t.jsx(ve,{icon:t.jsx(r,{sx:{fontSize:14}}),label:o.label,size:"small",statusColor:o.color,statusBg:o.bgColor})})()})]}),t.jsx(M,{}),t.jsxs(w,{children:[t.jsx(E,{children:"Template"}),t.jsx(ae,{children:l.templateName||l.templateId||l.template_id||"-"})]}),(l.connectionId||l.connection_id)&&t.jsxs(t.Fragment,{children:[t.jsx(M,{}),t.jsxs(w,{children:[t.jsx(E,{children:"Connection ID"}),t.jsx(ne,{children:l.connectionId||l.connection_id})]})]}),t.jsx(M,{}),t.jsxs(w,{children:[t.jsx(E,{children:"Created"}),t.jsx(ae,{children:l.createdAt?new Date(l.createdAt).toLocaleString():"-"})]}),(l.finishedAt||l.completed_at)&&t.jsxs(t.Fragment,{children:[t.jsx(M,{}),t.jsxs(w,{children:[t.jsx(E,{children:"Completed"}),t.jsx(ae,{children:new Date(l.finishedAt||l.completed_at).toLocaleString()})]})]}),l.error&&t.jsxs(t.Fragment,{children:[t.jsx(M,{}),t.jsx(Gt,{severity:"error",children:l.error})]}),(()=>{const o=l?.result&&Object.keys(l.result||{}).length?l.result:null;if(!o)return null;const a=(typeof o.summary=="string"?o.summary:null)||JSON.stringify(o,null,2);return t.jsxs(t.Fragment,{children:[t.jsx(M,{}),t.jsxs(w,{children:[t.jsx(E,{children:"Result"}),t.jsx(Yt,{component:"pre",children:a})]})]})})()]})}),t.jsxs(Wt,{children:[l?.status===T.COMPLETED&&l?.artifacts?.html_url&&t.jsx(X,{variant:"outlined",size:"small",startIcon:t.jsx(je,{sx:{fontSize:16}}),onClick:et,children:"Download"}),ke(l?.status)&&t.jsx(X,{variant:"outlined",size:"small",startIcon:t.jsx(Se,{sx:{fontSize:16}}),disabled:B,onClick:tt,children:B?"Retrying...":"Retry"}),t.jsx(X,{onClick:ee,children:"Close"})]})]})]})}function co(){return Re(),t.jsx(Xt,{})}export{co as default};
