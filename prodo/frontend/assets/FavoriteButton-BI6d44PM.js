import{u as R,a as j,r,c as g,b as C,d as F,R as L,I as b,j as i,T as w,e as z,n,C as B,f as A}from"./index-COTlR4Mk.js";import{D}from"./Star-Ct4JJ-ai.js";import{S as T}from"./StarBorder-X-7SSBaM.js";function N({entityType:t,entityId:a,initialFavorite:o,onToggle:v,size:p="small"}){const s=R(),{execute:x}=j(),[c,f]=r.useState(o??!1),[u,h]=r.useState(!1),[E,d]=r.useState(o!==void 0);r.useEffect(()=>{if(E||!a)return;let l=!1;return g(t,a).then(e=>{l||(f(e.isFavorite),d(!0))}).catch(()=>{l||d(!0)}),()=>{l=!0}},[t,a,E]),r.useEffect(()=>{o!==void 0&&(f(o),d(!0))},[o]);const S=r.useCallback(async l=>{if(l.stopPropagation(),u||!a)return;h(!0);const e=!c;f(e);try{await x({type:e?b.CREATE:b.DELETE,label:e?"Add favorite":"Remove favorite",reversibility:L.FULLY_REVERSIBLE,suppressSuccessToast:!0,suppressErrorToast:!0,blocksNavigation:!1,intent:{entityType:t,entityId:a,action:e?"favorite_add":"favorite_remove"},action:async()=>{try{e?await C(t,a):await F(t,a),v?.(e)}catch(k){throw f(!e),k}}})}finally{h(!1)}},[t,a,c,u,v,x]),m=p==="small"?18:22;return i.jsx(w,{title:c?"Remove from favorites":"Add to favorites",children:i.jsx(z,{size:p,onClick:S,disabled:u,"data-testid":"favorite-button",sx:{color:c?s.palette.mode==="dark"?n[300]:n[900]:s.palette.text.secondary,transition:"all 0.2s cubic-bezier(0.22, 1, 0.36, 1)","&:hover":{color:s.palette.mode==="dark"?n[300]:n[900],bgcolor:s.palette.mode==="dark"?A(s.palette.text.primary,.08):n[100],transform:"scale(1.1)"}},children:u?i.jsx(B,{size:m-4,sx:{color:s.palette.text.secondary}}):c?i.jsx(D,{sx:{fontSize:m}}):i.jsx(T,{sx:{fontSize:m}})})})}export{N as F};
