import{g as Xe,j as e,u as Ft,w as Bt,Z as Ut,v as Wt,a as et,r as n,l as le,bp as Ot,bq as Nt,bk as _t,R as $,I as M,br as Vt,bs as Yt,bt as Ht,bu as Kt,bv as Zt,bw as qt,bx as Gt,by as Qt,bz as Jt,B as T,o as h,q as I,T as fe,D as Xt,s as ye,a1 as ea,aT as U,bo as ta,aU as W,U as aa,aV as sa,G as na,H as Ke,m as Ze,S as qe,M as A,p as se,n as m,f as i,a2 as oa,N as g,bn as O,e as ra,a_ as ia,O as tt,ah as la,aj as da,al as ca,aJ as pa,am as ua,aZ as ga,Q as xa,K as ma}from"./index-DeRHNZar.js";import{M as ha}from"./MoreVert-BjEJop_-.js";import{C as fa}from"./ContentCopy-DTU7Akp1.js";import{U as ba}from"./UploadFile-Bs_zgstl.js";import{P as ya}from"./PictureAsPdf-5BCEcUNz.js";import{D as Ca}from"./DataTable-DeFvC17i.js";import{C as Ge}from"./ConfirmModal-BHWqBz2Z.js";import{F as Sa}from"./FavoriteButton-Uw5VgZ0j.js";import{R as ka}from"./ReportGlossaryNotice-D0noZChz.js";import"./KeyboardArrowDown-Bu4MpLhn.js";import"./FilterList-D07PuMFv.js";import"./Check-D18rRUYU.js";import"./TableRow-8TKLtwpY.js";import"./TableContainer-BIUEnX5e.js";import"./KeyboardArrowRight-B-zFI2kH.js";import"./CheckCircleOutline-BoLve1SG.js";import"./WarningAmber-Bt52ndVT.js";import"./Star-C_pOy7CQ.js";import"./StarBorder-BmHtYBmF.js";import"./Article-qoKRFYGy.js";const ja=Xe(e.jsx("path",{d:"m20.54 5.23-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.16.55L3.46 5.23C3.17 5.57 3 6.02 3 6.5V19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.48-.17-.93-.46-1.27M12 17.5 6.5 12H10v-2h4v2h3.5zM5.12 5l.81-1h12l.94 1z"})),va=Xe(e.jsx("path",{d:"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12z"})),wa=g(T)(({theme:a})=>({padding:a.spacing(3),maxWidth:1400,margin:"0 auto",width:"100%",minHeight:"100vh",backgroundColor:a.palette.background.default})),Qe=g(se)(({theme:a})=>({borderRadius:8,backgroundColor:i(a.palette.text.primary,.08),color:a.palette.text.secondary,fontSize:"0.75rem","& .MuiChip-deleteIcon":{color:a.palette.text.secondary,"&:hover":{color:a.palette.text.primary}}})),Ta=g(ia)(({theme:a})=>({"& .MuiPaper-root":{backgroundColor:i(a.palette.background.paper,.95),backdropFilter:"blur(20px)",border:`1px solid ${i(a.palette.divider,.1)}`,borderRadius:8,boxShadow:`0 8px 32px ${i(a.palette.common.black,.15)}`,minWidth:180,animation:`${tt} 0.2s ease-out`}})),N=g(A)(({theme:a})=>({borderRadius:8,margin:a.spacing(.5,1),padding:a.spacing(1,1.5),fontSize:"14px",transition:"all 0.15s cubic-bezier(0.22, 1, 0.36, 1)","&:hover":{backgroundColor:a.palette.mode==="dark"?i(a.palette.text.primary,.08):m[100]},"& .MuiListItemIcon-root":{minWidth:32}})),J=g(la)(({theme:a})=>({"& .MuiBackdrop-root":{backgroundColor:i(a.palette.common.black,.6),backdropFilter:"blur(8px)"},"& .MuiDialog-paper":{backgroundColor:i(a.palette.background.paper,.95),backdropFilter:"blur(20px)",border:`1px solid ${i(a.palette.divider,.1)}`,borderRadius:8,boxShadow:`0 24px 64px ${i(a.palette.common.black,.25)}`,animation:`${tt} 0.3s ease-out`}})),X=g(da)(({theme:a})=>({display:"flex",alignItems:"center",justifyContent:"space-between",padding:a.spacing(2.5,3),fontSize:"1.125rem",fontWeight:600})),ee=g(ca)(({theme:a})=>({padding:a.spacing(0,3,3)})),te=g(ua)(({theme:a})=>({padding:a.spacing(2,3),gap:a.spacing(1)})),ae=g(pa)(({theme:a})=>({"& .MuiOutlinedInput-root":{borderRadius:8,backgroundColor:i(a.palette.background.paper,.6),transition:"all 0.2s cubic-bezier(0.22, 1, 0.36, 1)","&:hover":{backgroundColor:i(a.palette.background.paper,.8)},"&.Mui-focused":{backgroundColor:a.palette.background.paper,boxShadow:`0 0 0 3px ${i(a.palette.text.primary,.08)}`}}})),at=g(ma)(({theme:a})=>({borderRadius:8,textTransform:"none",fontWeight:500,fontSize:"0.875rem",padding:a.spacing(1,2.5),transition:"all 0.2s cubic-bezier(0.22, 1, 0.36, 1)"})),de=g(at)(({theme:a})=>({background:a.palette.mode==="dark"?m[700]:m[900],color:a.palette.common.white,boxShadow:`0 4px 14px ${i(a.palette.common.black,.15)}`,"&:hover":{background:a.palette.mode==="dark"?m[500]:m[700],boxShadow:`0 6px 20px ${i(a.palette.common.black,.2)}`,transform:"translateY(-1px)"},"&:disabled":{background:a.palette.action.disabledBackground,color:a.palette.action.disabled,boxShadow:"none"}})),_=g(at)(({theme:a})=>({borderColor:i(a.palette.divider,.3),"&:hover":{borderColor:a.palette.mode==="dark"?m[500]:m[700],backgroundColor:a.palette.mode==="dark"?i(a.palette.text.primary,.04):m[50]}})),Je=g(T,{shouldForwardProp:a=>a!=="iconColor"})(({theme:a})=>({width:36,height:36,borderRadius:10,backgroundColor:a.palette.mode==="dark"?i(a.palette.text.primary,.08):m[100],display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s cubic-bezier(0.22, 1, 0.36, 1)"})),Da=g(se,{shouldForwardProp:a=>!["kindColor","kindBg"].includes(a)})(({theme:a,kindColor:k,kindBg:b})=>({borderRadius:8,fontWeight:600,fontSize:"12px",backgroundColor:b,color:k})),Ia=g(se,{shouldForwardProp:a=>!["statusColor","statusBg"].includes(a)})(({theme:a,statusColor:k,statusBg:b})=>({borderRadius:8,fontWeight:600,fontSize:"12px",textTransform:"capitalize",backgroundColor:b,color:k})),Aa=g(se)(({theme:a})=>({borderRadius:6,fontSize:"12px",backgroundColor:i(a.palette.text.primary,.08),color:a.palette.text.secondary})),za=g(ra)(({theme:a})=>({color:a.palette.text.secondary,transition:"all 0.2s cubic-bezier(0.22, 1, 0.36, 1)","&:hover":{color:a.palette.text.primary,backgroundColor:a.palette.mode==="dark"?i(a.palette.text.primary,.08):m[100]}})),La=g(ga)(({theme:a})=>({borderRadius:4,height:6,backgroundColor:i(a.palette.text.primary,.1),"& .MuiLinearProgress-bar":{borderRadius:4,background:a.palette.mode==="dark"?m[500]:m[900]}})),$a=g(T)(({theme:a})=>({padding:a.spacing(2),borderRadius:8,border:`1px solid ${i(a.palette.divider,.1)}`,cursor:"pointer",transition:"all 0.2s cubic-bezier(0.22, 1, 0.36, 1)","&:hover":{borderColor:a.palette.mode==="dark"?m[500]:m[700],backgroundColor:a.palette.mode==="dark"?i(a.palette.text.primary,.04):m[50],transform:"translateX(4px)"}})),Ma=g(ye)(({theme:a})=>({color:a.palette.text.secondary,animation:`${xa} 2s infinite ease-in-out`})),be=(a,k)=>{const b={pdf:{icon:ya,color:a.palette.text.secondary,bgColor:a.palette.mode==="dark"?i(a.palette.text.primary,.1):m[100]},excel:{icon:oa,color:a.palette.text.secondary,bgColor:a.palette.mode==="dark"?i(a.palette.text.primary,.1):m[100]}};return b[k]||b.pdf},Ra=(a,k)=>{const b=(k||"").toLowerCase(),V={approved:{color:O.success,bgColor:i(O.success,.1)},failed:{color:O.destructive,bgColor:i(O.destructive,.1)},pending:{color:O.warning,bgColor:i(O.warning,.1)},draft:{color:a.palette.text.secondary,bgColor:a.palette.mode==="dark"?i(a.palette.text.primary,.08):m[50]},archived:{color:a.palette.text.secondary,bgColor:i(a.palette.text.secondary,.08)}};return V[b]||V.approved};function Ea(){const a=Ft(),k=Bt(),[b,V]=Ut(),l=Wt(),{execute:f}=et(),j=n.useCallback((t,s,o={})=>k(t,{label:s,intent:{from:"templates",...o}}),[k]),E=le(t=>t.templates),D=le(t=>t.setTemplates),Ce=le(t=>t.removeTemplate),Se=le(t=>t.updateTemplate),[ke,je]=n.useState(!1),[st,ce]=n.useState(!1),[Y,ve]=n.useState(null),[we,Te]=n.useState(null),[c,De]=n.useState(null),[Ie,Ae]=n.useState(!1),[nt,ne]=n.useState(!1),[H,ot]=n.useState(null),[S,K]=n.useState({name:"",description:"",tags:"",status:"approved"}),[pe,ze]=n.useState(!1),[rt,oe]=n.useState(!1),[z,Le]=n.useState(null),[re,$e]=n.useState(""),[R,Me]=n.useState(!1),[Re,ue]=n.useState(0),[ge,it]=n.useState([]),[x,Ee]=n.useState([]),[lt,Z]=n.useState(!1),[dt,q]=n.useState(!1),[xe,ct]=n.useState("approved"),[pt,G]=n.useState(!1),[me,Pe]=n.useState(""),[v,P]=n.useState(!1),Q=n.useRef(null),Fe=n.useRef(!1),[ut,ie]=n.useState(!1),[Be,gt]=n.useState(null),[Ue,We]=n.useState([]),[xt,Oe]=n.useState(!1),[Ne,_e]=n.useState(new Set),F=b.get("kind")||"",B=b.get("status")||"",mt=n.useMemo(()=>{let t=E;return F&&(t=t.filter(s=>(s.kind||"").toLowerCase()===F.toLowerCase())),B&&(t=t.filter(s=>(s.status||"").toLowerCase()===B.toLowerCase())),t},[E,F,B]),Ve=n.useCallback(t=>{const s=new URLSearchParams(b);s.delete(t),V(s,{replace:!0})},[b,V]),C=n.useCallback(async()=>{je(!0);try{const[t,s,o]=await Promise.all([Ot(),Nt(),_t().catch(()=>({templates:[]}))]);D(t),it(s.tags||[]);const r=(o.templates||[]).map(p=>p.id);_e(new Set(r))}catch(t){l.show(t.message||"Failed to load designs","error")}finally{je(!1)}},[D,l]),Ye=n.useCallback((t,s)=>{_e(o=>{const r=new Set(o);return s?r.add(t):r.delete(t),r})},[]);n.useEffect(()=>{Fe.current||(Fe.current=!0,C())},[C]);const ht=n.useCallback((t,s)=>{t.stopPropagation(),Te(t.currentTarget),De(s)},[]),y=n.useCallback(()=>{Te(null),De(null)},[]),ft=n.useCallback(()=>{j("/setup/wizard","Open setup wizard")},[j]),He=n.useCallback(()=>{j("/templates/new/chat","Create template with AI")},[j]),bt=n.useCallback(()=>{c&&j(`/templates/${c.id}/edit`,"Edit template",{templateId:c.id}),y()},[c,j,y]),yt=n.useCallback(()=>{ve(c),ce(!0),y()},[c,y]),Ct=n.useCallback(async()=>{if(!Y)return;const t=Y,s=E.find(o=>o.id===t.id);ce(!1),ve(null),f({type:M.DELETE,label:`Delete design "${t.name||t.id}"`,reversibility:$.PARTIALLY_REVERSIBLE,action:async()=>{Ce(t.id);let o=!1;const r=setTimeout(async()=>{if(!o)try{await Vt(t.id)}catch(p){throw s&&D(d=>[...d,s]),p}},5e3);l.showWithUndo(`"${t.name||t.id}" removed`,()=>{o=!0,clearTimeout(r),s&&D(p=>[...p,s]),l.show("Design restored","success")},{severity:"info"})}})},[Y,E,Ce,D,l,f]),St=n.useCallback(async()=>{if(!c)return;const t=c;y(),f({type:M.DOWNLOAD,label:`Export design "${t.name||t.id}"`,reversibility:$.SYSTEM_MANAGED,successMessage:"Design exported",errorMessage:"Failed to export design",action:async()=>{await Yt(t.id)}})},[c,y,f]),kt=n.useCallback(async()=>{if(!c)return;const t=c;y(),f({type:M.CREATE,label:`Duplicate design "${t.name||t.id}"`,reversibility:$.FULLY_REVERSIBLE,errorMessage:"Failed to copy design",action:async()=>{Ae(!0);try{const o=(await Ht(t.id))?.name||(t.name?`${t.name} (Copy)`:"Design (Copy)");await C(),l.show(`Design copied as "${o}"`,"success")}finally{Ae(!1)}}})},[c,l,y,C,f]),jt=n.useCallback(()=>{c&&(ot(c),K({name:c.name||"",description:c.description||"",tags:Array.isArray(c.tags)?c.tags.join(", "):"",status:c.status||"approved"}),ne(!0),y())},[c,y]),vt=n.useCallback(async()=>{if(c){gt(c),ie(!0),Oe(!0),We([]),y();try{const t=await Kt(c.id);We(t.similar||[])}catch(t){console.error("Failed to fetch similar designs:",t),l.show("Failed to load similar designs","error")}finally{Oe(!1)}}},[c,y,l]),wt=n.useCallback(t=>{ie(!1),j(`/reports?template=${t.id}`,"Open reports",{templateId:t.id})},[j]),Tt=n.useCallback(async()=>{if(!H)return;const t=S.name.trim();if(!t){l.show("Design name is required","error");return}if(t.length>200){l.show("Design name must be 200 characters or less","error");return}const s=S.tags?S.tags.split(",").map(p=>p.trim()).filter(Boolean):[],o=s.find(p=>p.length>50);if(o){l.show(`Tag "${o.slice(0,20)}..." exceeds 50 character limit`,"error");return}const r={name:t,description:S.description.trim()||void 0,status:S.status,tags:s};f({type:M.UPDATE,label:`Update design details "${t}"`,reversibility:$.FULLY_REVERSIBLE,successMessage:"Design details updated",errorMessage:"Failed to update design details",action:async()=>{ze(!0);try{const d=(await Zt(H.id,r))?.template||{...H,...r};Se(H.id,u=>({...u,...d})),ne(!1)}finally{ze(!1)}}})},[H,S,Se,f]),Dt=n.useCallback(()=>{oe(!0)},[]),It=n.useCallback(async()=>{if(!z){l.show("Select a design backup file first","error");return}const t=z.name||"";if(t.toLowerCase().split(".").pop()!=="zip"){l.show("Invalid file type. Please select a .zip file","error");return}const o=50*1024*1024;if(z.size>o){l.show("File too large. Maximum size is 50MB","error");return}f({type:M.UPLOAD,label:`Import design "${re.trim()||t}"`,reversibility:$.FULLY_REVERSIBLE,blocksNavigation:!0,successMessage:"Design imported",errorMessage:"Failed to import design",action:async()=>{Me(!0),ue(0);try{await qt({file:z,name:re.trim()||void 0,onUploadProgress:r=>ue(r)}),await C(),oe(!1),Le(null),$e("")}finally{Me(!1),ue(0)}}})},[z,re,C,f]),At=n.useCallback(()=>{x.length&&Z(!0)},[x]),zt=n.useCallback(async()=>{if(!x.length){Z(!1);return}const t=[...x],s=t.length,o=E.filter(r=>t.includes(r.id));if(!o.length){Z(!1);return}Z(!1),Ee([]),Q.current?.timeoutId&&(clearTimeout(Q.current.timeoutId),Q.current=null),f({type:M.DELETE,label:`Delete ${s} design${s!==1?"s":""}`,reversibility:$.PARTIALLY_REVERSIBLE,errorMessage:"Failed to remove designs",action:async()=>{D(d=>d.filter(u=>!t.includes(u.id)));let r=!1;const p=setTimeout(async()=>{if(!r){P(!0);try{const d=await Gt(t),u=d?.deletedCount??d?.deleted?.length??0,w=d?.failedCount??d?.failed?.length??0;w>0?l.show(`Removed ${u} design${u!==1?"s":""}, ${w} failed`,"warning"):l.show(`Removed ${u} design${u!==1?"s":""}`,"success"),await C()}catch(d){throw D(u=>{const w=new Set(u.map(he=>he.id)),L=o.filter(he=>!w.has(he.id));return L.length?[...u,...L]:u}),d}finally{P(!1)}}},5e3);Q.current={timeoutId:p,ids:t,templates:o},l.showWithUndo(`Removed ${s} design${s!==1?"s":""}`,()=>{r=!0,clearTimeout(p),Q.current=null,D(d=>{const u=new Set(d.map(L=>L.id)),w=o.filter(L=>!u.has(L.id));return w.length?[...d,...w]:d}),l.show("Designs restored","success")},{severity:"info"})}})},[x,E,l,C,f,D]),Lt=n.useCallback(async()=>{if(!x.length){q(!1);return}const t=x.length;q(!1),f({type:M.UPDATE,label:`Update status for ${t} design${t!==1?"s":""}`,reversibility:$.FULLY_REVERSIBLE,errorMessage:"Failed to update status",action:async()=>{P(!0);try{const s=await Qt(x,xe),o=s?.updatedCount??s?.updated?.length??0,r=s?.failedCount??s?.failed?.length??0;r>0?l.show(`Updated ${o} design${o!==1?"s":""}, ${r} failed`,"warning"):l.show(`Updated ${o} design${o!==1?"s":""}`,"success"),await C()}finally{P(!1)}}})},[x,xe,l,C,f]),$t=n.useCallback(async()=>{if(!x.length){G(!1);return}const t=me.split(",").map(r=>r.trim()).filter(Boolean);if(!t.length){l.show("Enter at least one tag","error");return}const s=t.find(r=>r.length>50);if(s){l.show(`Tag "${s.slice(0,20)}..." exceeds 50 character limit`,"error");return}const o=x.length;G(!1),f({type:M.UPDATE,label:`Add tags to ${o} design${o!==1?"s":""}`,reversibility:$.FULLY_REVERSIBLE,errorMessage:"Failed to add tags",action:async()=>{P(!0);try{const r=await Jt(x,t),p=r?.updatedCount??r?.updated?.length??0,d=r?.failedCount??r?.failed?.length??0;d>0?l.show(`Tagged ${p} design${p!==1?"s":""}, ${d} failed`,"warning"):l.show(`Tagged ${p} design${p!==1?"s":""}`,"success"),await C(),Pe("")}finally{P(!1)}}})},[x,me,l,C,f]),Mt=n.useCallback(t=>{j(`/reports?template=${t.id}`,"Open reports",{templateId:t.id})},[j]),Rt=n.useMemo(()=>[{field:"name",headerName:"Design",minWidth:200,flex:1,renderCell:(t,s)=>{const r=be(a,s.kind).icon;return e.jsxs(T,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Sa,{entityType:"templates",entityId:s.id,initialFavorite:Ne.has(s.id),onToggle:p=>Ye(s.id,p)}),e.jsx(Je,{children:e.jsx(r,{sx:{color:"text.secondary",fontSize:18}})}),e.jsxs(T,{sx:{minWidth:0,overflow:"hidden"},children:[e.jsx(h,{sx:{fontWeight:500,fontSize:"14px",color:"text.primary",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t||s.id}),e.jsx(h,{sx:{fontSize:"0.75rem",color:"text.secondary",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s.description||`${s.kind?.toUpperCase()||"PDF"} Design`})]})]})}},{field:"kind",headerName:"Type",width:100,renderCell:t=>{const s=be(a,t);return e.jsx(Da,{label:t?.toUpperCase()||"PDF",size:"small",kindColor:s.color,kindBg:s.bgColor})}},{field:"status",headerName:"Status",width:120,renderCell:t=>{const s=Ra(a,t);return e.jsx(Ia,{label:t||"approved",size:"small",statusColor:s.color,statusBg:s.bgColor})}},{field:"mappingKeys",headerName:"Fields",width:80,renderCell:(t,s)=>{const o=Array.isArray(t)?t.length:Array.isArray(s.mappingKeys)?s.mappingKeys.length:s.tokens_count;return e.jsx(h,{sx:{fontSize:"14px",color:"text.secondary"},children:o||"-"})}},{field:"tags",headerName:"Tags",width:180,renderCell:t=>{const s=Array.isArray(t)?t:[];return s.length?e.jsxs(I,{direction:"row",spacing:.5,sx:{flexWrap:"wrap"},children:[s.slice(0,2).map(o=>e.jsx(Aa,{label:o,size:"small"},o)),s.length>2&&e.jsxs(h,{variant:"caption",color:"text.secondary",children:["+",s.length-2]})]}):e.jsx(h,{sx:{fontSize:"0.75rem",color:"text.disabled"},children:"-"})}},{field:"createdAt",headerName:"Created",width:120,renderCell:(t,s)=>{const o=t||s.created_at;if(!o)return e.jsx(h,{sx:{fontSize:"14px",color:"text.disabled"},children:"-"});const r=new Date(o),d=Math.floor((new Date-r)/864e5),u=d<1?"Today":d<2?"Yesterday":d<7?`${d}d ago`:r.toLocaleDateString();return e.jsx(fe,{title:r.toLocaleString(),arrow:!0,children:e.jsx(h,{sx:{fontSize:"14px",color:"text.secondary",cursor:"default"},children:u})})}},{field:"lastRunAt",headerName:"Last Run",width:120,renderCell:(t,s)=>{const o=t||s.last_run_at;if(!o)return e.jsx(h,{sx:{fontSize:"14px",color:"text.disabled"},children:"-"});const r=new Date(o),d=new Date-r,u=Math.floor(d/36e5),w=Math.floor(d/864e5),L=u<1?"Just now":u<24?`${u}h ago`:w<7?`${w}d ago`:r.toLocaleDateString();return e.jsx(fe,{title:r.toLocaleString(),arrow:!0,children:e.jsx(h,{sx:{fontSize:"14px",color:"text.secondary",cursor:"default"},children:L})})}},{field:"updatedAt",headerName:"Updated",width:140,renderCell:(t,s)=>{const o=t||s.updated_at;return e.jsx(h,{sx:{fontSize:"14px",color:"text.secondary"},children:o?new Date(o).toLocaleDateString():"-"})}}],[a,Ne,Ye]),Et=n.useMemo(()=>{const t=[{key:"kind",label:"Type",options:[{value:"pdf",label:"PDF"},{value:"excel",label:"Excel"}]},{key:"status",label:"Status",options:[{value:"approved",label:"Approved"},{value:"pending",label:"Pending"},{value:"draft",label:"Draft"},{value:"archived",label:"Archived"}]}];return ge.length>0&&t.push({key:"tags",label:"Tag",options:ge.map(s=>({value:s,label:s})),matchFn:(s,o)=>(Array.isArray(s.tags)?s.tags:[]).includes(o)}),t},[ge]),Pt=n.useMemo(()=>[{label:"Update Status",icon:e.jsx(ja,{sx:{fontSize:16}}),onClick:()=>q(!0),disabled:v},{label:"Add Tags",icon:e.jsx(va,{sx:{fontSize:16}}),onClick:()=>G(!0),disabled:v}],[v]);return e.jsxs(wa,{children:[(F||B)&&e.jsxs(I,{direction:"row",spacing:1,sx:{mb:1.5,flexWrap:"wrap"},children:[F&&e.jsx(Qe,{label:`Type: ${F.toUpperCase()}`,onDelete:()=>Ve("kind"),size:"small"}),B&&e.jsx(Qe,{label:`Status: ${B}`,onDelete:()=>Ve("status"),size:"small"})]}),e.jsx(T,{sx:{mb:2},children:e.jsx(ka,{})}),e.jsx(Ca,{title:"Report Designs",subtitle:"Upload and manage your report designs",columns:Rt,data:mt,loading:ke,searchPlaceholder:"Search designs...",filters:Et,actions:[{label:"Create with AI",icon:e.jsx(ye,{sx:{fontSize:18}}),variant:"contained",onClick:He},{label:"Upload Design",icon:e.jsx(ea,{sx:{fontSize:18}}),variant:"outlined",onClick:ft},{label:"Import Backup",icon:e.jsx(ba,{sx:{fontSize:18}}),variant:"outlined",onClick:Dt}],selectable:!0,onSelectionChange:Ee,bulkActions:Pt,onBulkDelete:At,onRowClick:Mt,rowActions:t=>e.jsx(fe,{title:"More actions",children:e.jsx(za,{size:"small",onClick:s=>ht(s,t),"aria-label":"More actions",children:e.jsx(ha,{sx:{fontSize:18}})})}),emptyState:{icon:Xt,title:"No report designs yet",description:"Create a template with AI or upload a PDF/Excel file.",actionLabel:"Create with AI",onAction:He}}),e.jsxs(Ta,{anchorEl:we,open:!!we,onClose:y,children:[e.jsxs(N,{onClick:bt,children:[e.jsx(U,{children:e.jsx(ta,{sx:{fontSize:16}})}),e.jsx(W,{primaryTypographyProps:{fontSize:"14px"},children:"Edit"})]}),e.jsxs(N,{onClick:jt,children:[e.jsx(U,{children:e.jsx(aa,{sx:{fontSize:16}})}),e.jsx(W,{primaryTypographyProps:{fontSize:"14px"},children:"Edit Details"})]}),e.jsxs(N,{onClick:St,children:[e.jsx(U,{children:e.jsx(sa,{sx:{fontSize:16}})}),e.jsx(W,{primaryTypographyProps:{fontSize:"14px"},children:"Export"})]}),e.jsxs(N,{onClick:kt,disabled:Ie,children:[e.jsx(U,{children:e.jsx(fa,{sx:{fontSize:16}})}),e.jsx(W,{primaryTypographyProps:{fontSize:"14px"},children:Ie?"Duplicating...":"Duplicate"})]}),e.jsxs(N,{onClick:vt,children:[e.jsx(U,{children:e.jsx(ye,{sx:{fontSize:16}})}),e.jsx(W,{primaryTypographyProps:{fontSize:"14px"},children:"View Similar"})]}),e.jsxs(N,{onClick:yt,sx:{color:"text.primary"},children:[e.jsx(U,{children:e.jsx(na,{sx:{fontSize:16,color:"text.secondary"}})}),e.jsx(W,{primaryTypographyProps:{fontSize:"14px"},children:"Delete"})]})]}),e.jsx(Ge,{open:st,onClose:()=>ce(!1),onConfirm:Ct,title:"Remove Design",message:`Remove "${Y?.name||Y?.id}"? Past report files remain in History. You can undo this within a few seconds.`,confirmLabel:"Remove",severity:"error",loading:ke}),e.jsx(Ge,{open:lt,onClose:()=>Z(!1),onConfirm:zt,title:"Remove Designs",message:`Remove ${x.length} design${x.length!==1?"s":""}? Past report files remain in History. You can undo this within a few seconds.`,confirmLabel:"Remove",severity:"error",loading:v}),e.jsxs(J,{open:nt,onClose:()=>ne(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(X,{children:"Edit Design Details"}),e.jsx(ee,{children:e.jsxs(I,{spacing:2,sx:{mt:1},children:[e.jsx(ae,{label:"Name",value:S.name,onChange:t=>K(s=>({...s,name:t.target.value})),fullWidth:!0}),e.jsx(ae,{label:"Description",value:S.description,onChange:t=>K(s=>({...s,description:t.target.value})),multiline:!0,minRows:2,fullWidth:!0}),e.jsx(ae,{label:"Tags",value:S.tags,onChange:t=>K(s=>({...s,tags:t.target.value})),helperText:"Comma-separated (e.g. finance, monthly, ops)",fullWidth:!0}),e.jsxs(Ke,{fullWidth:!0,children:[e.jsx(Ze,{children:"Status"}),e.jsxs(qe,{value:S.status,label:"Status",onChange:t=>K(s=>({...s,status:t.target.value})),children:[e.jsx(A,{value:"approved",children:"Approved"}),e.jsx(A,{value:"pending",children:"Pending"}),e.jsx(A,{value:"draft",children:"Draft"}),e.jsx(A,{value:"archived",children:"Archived"})]})]})]})}),e.jsxs(te,{children:[e.jsx(_,{variant:"outlined",onClick:()=>ne(!1),disabled:pe,children:"Cancel"}),e.jsx(de,{onClick:Tt,disabled:pe||!S.name.trim(),children:pe?"Saving...":"Save"})]})]}),e.jsxs(J,{open:dt,onClose:()=>q(!1),maxWidth:"xs",fullWidth:!0,children:[e.jsx(X,{children:"Update Status"}),e.jsx(ee,{children:e.jsxs(I,{spacing:2,sx:{mt:1},children:[e.jsxs(h,{sx:{fontSize:"14px",color:"text.secondary"},children:["Update ",x.length," design",x.length!==1?"s":""," to:"]}),e.jsxs(Ke,{fullWidth:!0,children:[e.jsx(Ze,{children:"Status"}),e.jsxs(qe,{value:xe,label:"Status",onChange:t=>ct(t.target.value),children:[e.jsx(A,{value:"approved",children:"Approved"}),e.jsx(A,{value:"pending",children:"Pending"}),e.jsx(A,{value:"draft",children:"Draft"}),e.jsx(A,{value:"archived",children:"Archived"})]})]})]})}),e.jsxs(te,{children:[e.jsx(_,{variant:"outlined",onClick:()=>q(!1),disabled:v,children:"Cancel"}),e.jsx(de,{onClick:Lt,disabled:v,children:v?"Updating...":"Update"})]})]}),e.jsxs(J,{open:pt,onClose:()=>G(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(X,{children:"Add Tags"}),e.jsx(ee,{children:e.jsxs(I,{spacing:2,sx:{mt:1},children:[e.jsxs(h,{sx:{fontSize:"14px",color:"text.secondary"},children:["Add tags to ",x.length," design",x.length!==1?"s":"","."]}),e.jsx(ae,{label:"Tags",value:me,onChange:t=>Pe(t.target.value),helperText:"Comma-separated (e.g. finance, monthly, ops)",fullWidth:!0})]})}),e.jsxs(te,{children:[e.jsx(_,{variant:"outlined",onClick:()=>G(!1),disabled:v,children:"Cancel"}),e.jsx(de,{onClick:$t,disabled:v,children:v?"Updating...":"Add Tags"})]})]}),e.jsxs(J,{open:rt,onClose:()=>!R&&oe(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(X,{children:"Import Design Backup"}),e.jsx(ee,{children:e.jsxs(I,{spacing:2,sx:{mt:1},children:[e.jsxs(_,{variant:"outlined",component:"label",disabled:R,children:[z?z.name:"Choose backup file (.zip)",e.jsx("input",{type:"file",hidden:!0,accept:".zip",onChange:t=>Le(t.target.files?.[0]||null)})]}),e.jsx(ae,{label:"Design Name (optional)",value:re,onChange:t=>$e(t.target.value),fullWidth:!0,disabled:R}),R&&e.jsxs(T,{sx:{width:"100%"},children:[e.jsxs(h,{variant:"body2",color:"text.secondary",sx:{mb:1},children:["Uploading... ",Re,"%"]}),e.jsx(La,{variant:"determinate",value:Re})]})]})}),e.jsxs(te,{children:[e.jsx(_,{variant:"outlined",onClick:()=>oe(!1),disabled:R,children:"Cancel"}),e.jsx(de,{onClick:It,disabled:R||!z,children:R?"Importing...":"Import"})]})]}),e.jsxs(J,{open:ut,onClose:()=>ie(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(X,{children:e.jsxs(I,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(Ma,{}),e.jsx("span",{children:"Similar Designs"})]})}),e.jsxs(ee,{children:[e.jsxs(h,{variant:"body2",color:"text.secondary",sx:{mb:2},children:['Designs similar to "',Be?.name||Be?.id,'"']}),xt?e.jsx(T,{sx:{py:4,textAlign:"center"},children:e.jsx(h,{color:"text.secondary",children:"Loading similar designs..."})}):Ue.length===0?e.jsx(T,{sx:{py:4,textAlign:"center"},children:e.jsx(h,{color:"text.secondary",children:"No similar designs found."})}):e.jsx(I,{spacing:1,children:Ue.map(t=>{const o=be(a,t.kind).icon;return e.jsx($a,{onClick:()=>wt(t),children:e.jsxs(I,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(Je,{children:e.jsx(o,{sx:{color:"text.secondary",fontSize:18}})}),e.jsxs(T,{sx:{flex:1},children:[e.jsx(h,{variant:"subtitle2",children:t.name||t.id}),e.jsx(h,{variant:"caption",color:"text.secondary",children:t.description||`${t.kind?.toUpperCase()||"PDF"} Design`})]}),t.similarity_score&&e.jsx(se,{label:`${Math.round(t.similarity_score*100)}% match`,size:"small",variant:"outlined",sx:{borderRadius:8,bgcolor:r=>r.palette.mode==="dark"?i(r.palette.text.primary,.1):m[200],color:"text.secondary"}})]})},t.id)})})]}),e.jsx(te,{children:e.jsx(_,{variant:"outlined",onClick:()=>ie(!1),children:"Close"})})]})]})}function as(){return et(),e.jsx(Ea,{})}export{as as default};
