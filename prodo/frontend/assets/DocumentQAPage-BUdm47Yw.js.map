{"version":3,"file":"DocumentQAPage-BUdm47Yw.js","sources":["../../../home/rohith/desktop/NeuraReport/frontend/node_modules/@mui/icons-material/esm/AttachFile.js","../../../home/rohith/desktop/NeuraReport/frontend/node_modules/@mui/icons-material/esm/ThumbDown.js","../../../home/rohith/desktop/NeuraReport/frontend/node_modules/@mui/icons-material/esm/ThumbUp.js","../../../home/rohith/desktop/NeuraReport/frontend/src/api/docqa.js","../../../home/rohith/desktop/NeuraReport/frontend/src/stores/docqaStore.js","../../../home/rohith/desktop/NeuraReport/frontend/src/components/feedback/LoadingState.jsx","../../../home/rohith/desktop/NeuraReport/frontend/src/features/docqa/containers/DocumentQAPageContainer.jsx","../../../home/rohith/desktop/NeuraReport/frontend/src/pages/docqa/DocumentQAPage.jsx"],"sourcesContent":["\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6z\"\n}), 'AttachFile');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2m4 0v12h4V3z\"\n}), 'ThumbDown');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M1 21h4V9H1zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73z\"\n}), 'ThumbUp');","/**\n * Document Q&A Chat API Client\n */\nimport apiClient from './client';\n\nfunction asArray(payload, keys = []) {\n  if (Array.isArray(payload)) return payload;\n  if (!payload || typeof payload !== 'object') return [];\n  for (const key of keys) {\n    if (Array.isArray(payload[key])) return payload[key];\n  }\n  return [];\n}\n\n/**\n * Create a Q&A session\n */\nexport async function createSession(name) {\n  const response = await apiClient.post('/docqa/sessions', { name });\n  return response.data;\n}\n\n/**\n * List all Q&A sessions\n */\nexport async function listSessions({ limit, offset } = {}) {\n  const params = {};\n  if (limit != null) params.limit = limit;\n  if (offset != null) params.offset = offset;\n  const response = await apiClient.get('/docqa/sessions', { params });\n  const payload = response.data;\n  if (Array.isArray(payload)) {\n    return { sessions: payload, total: payload.length };\n  }\n  if (payload && typeof payload === 'object') {\n    const sessions = asArray(payload, ['sessions', 'items', 'results']);\n    return { ...payload, sessions, total: payload.total ?? sessions.length };\n  }\n  return { sessions: [], total: 0 };\n}\n\n/**\n * Get a Q&A session\n */\nexport async function getSession(sessionId) {\n  const response = await apiClient.get(`/docqa/sessions/${sessionId}`);\n  return response.data;\n}\n\n/**\n * Delete a Q&A session\n */\nexport async function deleteSession(sessionId) {\n  const response = await apiClient.delete(`/docqa/sessions/${sessionId}`);\n  return response.data;\n}\n\n/**\n * Add document to session\n */\nexport async function addDocument(sessionId, { name, content, pageCount }) {\n  const response = await apiClient.post(`/docqa/sessions/${sessionId}/documents`, {\n    name,\n    content,\n    page_count: pageCount,\n  });\n  return response.data;\n}\n\n/**\n * Remove document from session\n */\nexport async function removeDocument(sessionId, documentId) {\n  const response = await apiClient.delete(`/docqa/sessions/${sessionId}/documents/${documentId}`);\n  return response.data;\n}\n\n/**\n * Ask a question\n */\nexport async function askQuestion(sessionId, { question, includeCitations = true, maxResponseLength = 2000 }) {\n  const response = await apiClient.post(`/docqa/sessions/${sessionId}/ask`, {\n    question,\n    include_citations: includeCitations,\n    max_response_length: maxResponseLength,\n  });\n  return response.data;\n}\n\n/**\n * Get chat history\n */\nexport async function getChatHistory(sessionId, limit = 50) {\n  const response = await apiClient.get(`/docqa/sessions/${sessionId}/history`, {\n    params: { limit },\n  });\n  return response.data;\n}\n\n/**\n * Clear chat history\n */\nexport async function clearHistory(sessionId) {\n  const response = await apiClient.delete(`/docqa/sessions/${sessionId}/history`);\n  return response.data;\n}\n\n/**\n * Submit feedback for a message\n * @param {string} sessionId - Session ID\n * @param {string} messageId - Message ID\n * @param {object} feedback - Feedback data { feedbackType: 'helpful' | 'not_helpful', comment?: string }\n */\nexport async function submitFeedback(sessionId, messageId, { feedbackType, comment }) {\n  const response = await apiClient.post(\n    `/docqa/sessions/${sessionId}/messages/${messageId}/feedback`,\n    {\n      feedback_type: feedbackType,\n      comment,\n    }\n  );\n  return response.data;\n}\n\n/**\n * Regenerate a response for a message\n * @param {string} sessionId - Session ID\n * @param {string} messageId - Message ID\n * @param {object} options - Options { includeCitations?: boolean, maxResponseLength?: number }\n */\nexport async function regenerateResponse(sessionId, messageId, { includeCitations = true, maxResponseLength = 2000 } = {}) {\n  const response = await apiClient.post(\n    `/docqa/sessions/${sessionId}/messages/${messageId}/regenerate`,\n    {\n      include_citations: includeCitations,\n      max_response_length: maxResponseLength,\n    }\n  );\n  return response.data;\n}\n\nexport default {\n  createSession,\n  listSessions,\n  getSession,\n  deleteSession,\n  addDocument,\n  removeDocument,\n  askQuestion,\n  getChatHistory,\n  clearHistory,\n  submitFeedback,\n  regenerateResponse,\n};\n","/**\n * Document Q&A Chat Store\n */\nimport { create } from 'zustand';\nimport * as docqaApi from '../api/docqa';\n\nconst useDocQAStore = create((set, get) => ({\n  // State\n  sessions: [],\n  currentSession: null,\n  messages: [],\n  loading: false,\n  asking: false,\n  error: null,\n\n  // Actions\n  setLoading: (loading) => set({ loading }),\n  setError: (error) => set({ error }),\n\n  // Fetch all sessions\n  fetchSessions: async () => {\n    set({ loading: true, error: null });\n    try {\n      const response = await docqaApi.listSessions();\n      set({ sessions: response.sessions || [], loading: false });\n    } catch (err) {\n      set({ error: err.message, loading: false });\n    }\n  },\n\n  // Create session\n  createSession: async (name) => {\n    set({ loading: true, error: null });\n    try {\n      const response = await docqaApi.createSession(name);\n      const session = response.session;\n      set((state) => ({\n        sessions: [...state.sessions, session].slice(0, 100),\n        currentSession: session,\n        messages: [],\n        loading: false,\n      }));\n      return session;\n    } catch (err) {\n      set({ error: err.message, loading: false });\n      return null;\n    }\n  },\n\n  // Get session\n  getSession: async (sessionId) => {\n    set({ loading: true, error: null });\n    try {\n      const response = await docqaApi.getSession(sessionId);\n      let messages = response.session?.messages || [];\n      try {\n        const history = await docqaApi.getChatHistory(sessionId, 50);\n        if (Array.isArray(history?.messages)) {\n          messages = history.messages;\n        }\n      } catch {\n        // Fall back to session messages if history lookup fails.\n      }\n      set({\n        currentSession: response.session,\n        messages,\n        loading: false,\n      });\n      return response.session;\n    } catch (err) {\n      set({ error: err.message, loading: false });\n      return null;\n    }\n  },\n\n  // Delete session\n  deleteSession: async (sessionId) => {\n    set({ loading: true, error: null });\n    try {\n      await docqaApi.deleteSession(sessionId);\n      set((state) => ({\n        sessions: state.sessions.filter((s) => s.id !== sessionId),\n        currentSession: state.currentSession?.id === sessionId ? null : state.currentSession,\n        messages: state.currentSession?.id === sessionId ? [] : state.messages,\n        loading: false,\n      }));\n      return true;\n    } catch (err) {\n      set({ error: err.message, loading: false });\n      return false;\n    }\n  },\n\n  // Add document\n  addDocument: async (sessionId, documentData) => {\n    set({ loading: true, error: null });\n    try {\n      const response = await docqaApi.addDocument(sessionId, documentData);\n      await get().getSession(sessionId);\n      set({ loading: false });\n      return response.document;\n    } catch (err) {\n      set({ error: err.message, loading: false });\n      return null;\n    }\n  },\n\n  // Remove document\n  removeDocument: async (sessionId, documentId) => {\n    set({ loading: true, error: null });\n    try {\n      await docqaApi.removeDocument(sessionId, documentId);\n      await get().getSession(sessionId);\n      set({ loading: false });\n      return true;\n    } catch (err) {\n      set({ error: err.message, loading: false });\n      return false;\n    }\n  },\n\n  // Ask question\n  askQuestion: async (sessionId, question, options = {}) => {\n    // Add user message optimistically\n    const userMessage = {\n      id: `temp-${Date.now()}`,\n      role: 'user',\n      content: question,\n      timestamp: new Date().toISOString(),\n      citations: [],\n    };\n\n    set((state) => ({\n      messages: [...state.messages, userMessage].slice(-500),\n      asking: true,\n      error: null,\n    }));\n\n    try {\n      const response = await docqaApi.askQuestion(sessionId, {\n        question,\n        ...options,\n      });\n\n      // Replace temp message with actual and add assistant response\n      set((state) => ({\n        messages: [\n          ...state.messages.filter((m) => m.id !== userMessage.id),\n          { ...userMessage, id: response.response?.message?.id || userMessage.id },\n          response.response?.message,\n        ].filter(Boolean),\n        asking: false,\n      }));\n\n      return response.response;\n    } catch (err) {\n      set((state) => ({\n        messages: state.messages.filter((m) => m.id !== userMessage.id),\n        error: err.message,\n        asking: false,\n      }));\n      return null;\n    }\n  },\n\n  // Clear history\n  clearHistory: async (sessionId) => {\n    set({ loading: true, error: null });\n    try {\n      await docqaApi.clearHistory(sessionId);\n      set({ messages: [], loading: false });\n      return true;\n    } catch (err) {\n      set({ error: err.message, loading: false });\n      return false;\n    }\n  },\n\n  // Submit feedback for a message\n  submitFeedback: async (sessionId, messageId, feedbackType, comment = null) => {\n    try {\n      const response = await docqaApi.submitFeedback(sessionId, messageId, {\n        feedbackType,\n        comment,\n      });\n\n      // Update the message in state with feedback\n      set((state) => ({\n        messages: state.messages.map((msg) =>\n          msg.id === messageId\n            ? { ...msg, feedback: response.message?.feedback }\n            : msg\n        ),\n      }));\n\n      return response.message;\n    } catch (err) {\n      set({ error: err.message });\n      return null;\n    }\n  },\n\n  // Regenerate a response\n  regenerateResponse: async (sessionId, messageId, options = {}) => {\n    set({ asking: true, error: null });\n    try {\n      const response = await docqaApi.regenerateResponse(sessionId, messageId, options);\n\n      // Update the message in state with regenerated content\n      set((state) => ({\n        messages: state.messages.map((msg) =>\n          msg.id === messageId ? response.response?.message : msg\n        ),\n        asking: false,\n      }));\n\n      return response.response;\n    } catch (err) {\n      set({ error: err.message, asking: false });\n      return null;\n    }\n  },\n\n  // Reset state\n  reset: () => set({\n    currentSession: null,\n    messages: [],\n    error: null,\n  }),\n}));\n\nexport default useDocQAStore;\n","/**\n * Enhanced Loading State Component\n * Provides consistent loading feedback across the application\n *\n * UX Laws Addressed:\n * - Make system state always visible\n * - Ongoing state visibility (loading / progress / pending)\n * - Optimize perceived speed\n */\nimport {\n  LinearProgress,\n  Stack,\n  Typography,\n  Box,\n  CircularProgress,\n  Fade,\n  useTheme,\n  alpha,\n  keyframes,\n} from '@mui/material'\nimport { shimmer } from '@/styles'\n\n// Local pulse — differs from shared version (opacity-based, not scale-based)\nconst pulse = keyframes`\n  0%, 100% { opacity: 1; }\n  50% { opacity: 0.5; }\n`\n\n/**\n * Primary Loading State Component\n */\nexport default function LoadingState({\n  label = 'Loading…',\n  description,\n  progress = null,\n  inline = false,\n  dense = false,\n  color = 'primary',\n  variant = 'linear', // 'linear' | 'circular' | 'skeleton'\n  size = 'medium', // 'small' | 'medium' | 'large'\n  centered = false,\n  sx = [],\n  ...props\n}) {\n  const theme = useTheme()\n  const sxArray = Array.isArray(sx) ? sx : [sx]\n  const spacing = inline || dense ? 0.75 : 1.5\n  const width = inline ? 'auto' : '100%'\n\n  // Size configurations\n  const sizeConfig = {\n    small: { circular: 20, text: 'caption' },\n    medium: { circular: 32, text: 'body2' },\n    large: { circular: 48, text: 'body1' },\n  }[size]\n\n  // Circular variant\n  if (variant === 'circular') {\n    return (\n      <Fade in>\n        <Stack\n          direction={inline ? 'row' : 'column'}\n          spacing={spacing}\n          alignItems=\"center\"\n          justifyContent={centered ? 'center' : 'flex-start'}\n          role=\"status\"\n          aria-live=\"polite\"\n          sx={[{ width: centered ? '100%' : width }, ...sxArray]}\n          {...props}\n        >\n          <Box sx={{ position: 'relative', display: 'inline-flex' }}>\n            <CircularProgress\n              size={sizeConfig.circular}\n              color={color}\n              variant={progress != null ? 'determinate' : 'indeterminate'}\n              value={progress ?? undefined}\n            />\n            {progress != null && (\n              <Box\n                sx={{\n                  position: 'absolute',\n                  inset: 0,\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                }}\n              >\n                <Typography variant=\"caption\" fontWeight={600}>\n                  {Math.round(progress)}%\n                </Typography>\n              </Box>\n            )}\n          </Box>\n          {label && (\n            <Typography variant={sizeConfig.text} color=\"text.secondary\">\n              {label}\n            </Typography>\n          )}\n        </Stack>\n      </Fade>\n    )\n  }\n\n  // Default linear variant\n  return (\n    <Fade in>\n      <Stack\n        direction=\"column\"\n        spacing={spacing}\n        role=\"status\"\n        aria-live=\"polite\"\n        sx={[\n          {\n            width,\n            maxWidth: inline ? '100%' : 440,\n          },\n          ...sxArray,\n        ]}\n        {...props}\n      >\n        <Typography variant={sizeConfig.text} color=\"text.secondary\">\n          {label}\n        </Typography>\n        <LinearProgress\n          variant={progress == null ? 'indeterminate' : 'determinate'}\n          value={progress ?? undefined}\n          color={color}\n          aria-label={label}\n          sx={{ borderRadius: 1, height: size === 'small' ? 3 : size === 'large' ? 6 : 4 }}  // Figma spec: 8px\n        />\n        {description && (\n          <Typography variant=\"caption\" color=\"text.secondary\">\n            {description}\n          </Typography>\n        )}\n      </Stack>\n    </Fade>\n  )\n}\n\n/**\n * Skeleton Loader Component\n * Shows placeholder content while loading\n */\nexport function Skeleton({\n  variant = 'text', // 'text' | 'circular' | 'rectangular' | 'rounded'\n  width,\n  height,\n  lines = 1,\n  animation = 'shimmer', // 'shimmer' | 'pulse' | 'none'\n  sx = [],\n  ...props\n}) {\n  const theme = useTheme()\n  const sxArray = Array.isArray(sx) ? sx : [sx]\n\n  const animationStyle = {\n    shimmer: {\n      background: `linear-gradient(90deg,\n        ${alpha(theme.palette.text.primary, 0.06)} 25%,\n        ${alpha(theme.palette.text.primary, 0.12)} 50%,\n        ${alpha(theme.palette.text.primary, 0.06)} 75%)`,\n      backgroundSize: '200% 100%',\n      animation: `${shimmer} 1.5s infinite`,\n    },\n    pulse: {\n      bgcolor: alpha(theme.palette.text.primary, 0.08),\n      animation: `${pulse} 1.5s infinite`,\n    },\n    none: {\n      bgcolor: alpha(theme.palette.text.primary, 0.08),\n    },\n  }[animation]\n\n  if (variant === 'text') {\n    return (\n      <Box sx={[{ display: 'flex', flexDirection: 'column', gap: 1 }, ...sxArray]} {...props}>\n        {Array.from({ length: lines }).map((_, i) => (\n          <Box\n            key={i}\n            sx={{\n              height: height || 16,\n              width: i === lines - 1 && lines > 1 ? '60%' : width || '100%',\n              borderRadius: 1,\n              ...animationStyle,\n            }}\n          />\n        ))}\n      </Box>\n    )\n  }\n\n  if (variant === 'circular') {\n    return (\n      <Box\n        sx={[\n          {\n            width: width || 40,\n            height: height || 40,\n            borderRadius: '50%',\n            ...animationStyle,\n          },\n          ...sxArray,\n        ]}\n        {...props}\n      />\n    )\n  }\n\n  if (variant === 'rounded') {\n    return (\n      <Box\n        sx={[\n          {\n            width: width || '100%',\n            height: height || 120,\n            borderRadius: 1,  // Figma spec: 8px\n            ...animationStyle,\n          },\n          ...sxArray,\n        ]}\n        {...props}\n      />\n    )\n  }\n\n  // rectangular\n  return (\n    <Box\n      sx={[\n        {\n          width: width || '100%',\n          height: height || 120,\n          ...animationStyle,\n        },\n        ...sxArray,\n      ]}\n      {...props}\n    />\n  )\n}\n\n/**\n * Content Skeleton - Pre-built skeleton patterns\n */\nexport function ContentSkeleton({ type = 'card', count = 1 }) {\n  const items = Array.from({ length: count })\n\n  if (type === 'card') {\n    return (\n      <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\n        {items.map((_, i) => (\n          <Box key={i} sx={{ p: 2, border: '1px solid', borderColor: 'divider', borderRadius: 1 }}>  {/* Figma spec: 8px */}\n            <Box sx={{ display: 'flex', gap: 2, mb: 2 }}>\n              <Skeleton variant=\"circular\" width={48} height={48} />\n              <Box sx={{ flex: 1 }}>\n                <Skeleton variant=\"text\" width=\"60%\" height={20} />\n                <Skeleton variant=\"text\" width=\"40%\" height={16} sx={{ mt: 1 }} />\n              </Box>\n            </Box>\n            <Skeleton variant=\"text\" lines={3} />\n          </Box>\n        ))}\n      </Box>\n    )\n  }\n\n  if (type === 'list') {\n    return (\n      <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n        {items.map((_, i) => (\n          <Box key={i} sx={{ display: 'flex', alignItems: 'center', gap: 2, py: 1 }}>\n            <Skeleton variant=\"circular\" width={40} height={40} />\n            <Box sx={{ flex: 1 }}>\n              <Skeleton variant=\"text\" width=\"70%\" />\n              <Skeleton variant=\"text\" width=\"50%\" height={14} sx={{ mt: 0.5 }} />\n            </Box>\n          </Box>\n        ))}\n      </Box>\n    )\n  }\n\n  if (type === 'table') {\n    return (\n      <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n        <Skeleton variant=\"rectangular\" height={48} />\n        {items.map((_, i) => (\n          <Skeleton key={i} variant=\"rectangular\" height={52} />\n        ))}\n      </Box>\n    )\n  }\n\n  if (type === 'chat') {\n    return (\n      <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\n        {items.map((_, i) => (\n          <Box\n            key={i}\n            sx={{\n              display: 'flex',\n              gap: 2,\n              alignSelf: i % 2 === 0 ? 'flex-start' : 'flex-end',\n              maxWidth: '70%',\n            }}\n          >\n            {i % 2 === 0 && <Skeleton variant=\"circular\" width={36} height={36} />}\n            <Skeleton variant=\"rounded\" width={200 + Math.random() * 100} height={60 + Math.random() * 40} />\n            {i % 2 !== 0 && <Skeleton variant=\"circular\" width={36} height={36} />}\n          </Box>\n        ))}\n      </Box>\n    )\n  }\n\n  return <Skeleton variant=\"rectangular\" />\n}\n\n/**\n * Inline Loading Indicator\n * For use within buttons or inline content\n */\nexport function InlineLoading({ size = 16, color = 'inherit', sx = [] }) {\n  const sxArray = Array.isArray(sx) ? sx : [sx]\n  return (\n    <CircularProgress\n      size={size}\n      color={color}\n      sx={[{ ml: 1 }, ...sxArray]}\n    />\n  )\n}\n\n","/**\n * Premium Document Q&A Chat Interface\n * Sophisticated AI-powered document analysis with elegant design\n */\nimport React, { useState, useEffect, useRef, useCallback } from 'react'\nimport {\n  Box,\n  Typography,\n  Button,\n  TextField,\n  Chip,\n  Alert,\n  IconButton,\n  Tooltip,\n  Divider,\n  List,\n  ListItem,\n  ListItemText,\n  ListItemIcon,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Avatar,\n  InputAdornment,\n  Fade,\n  Zoom,\n  Collapse,\n  Badge,\n  useTheme,\n  alpha,\n  styled,\n} from '@mui/material'\nimport {\n  Add as AddIcon,\n  Delete as DeleteIcon,\n  CloudUpload as UploadIcon,\n  Description as DocIcon,\n  Send as SendIcon,\n  Person as UserIcon,\n  AutoAwesome as AIIcon,\n  QuestionAnswer as QAIcon,\n  FormatQuote as QuoteIcon,\n  Clear as ClearIcon,\n  Folder as FolderIcon,\n  InsertDriveFile as FileIcon,\n  ContentCopy as CopyIcon,\n  ThumbUp as ThumbUpIcon,\n  ThumbDown as ThumbDownIcon,\n  Refresh as RefreshIcon,\n  MoreVert as MoreIcon,\n  Search as SearchIcon,\n  KeyboardArrowDown as ArrowDownIcon,\n  Circle as CircleIcon,\n  Psychology as ThinkIcon,\n  AttachFile as AttachIcon,\n  Mic as MicIcon,\n  Stop as StopIcon,\n  Close as CloseIcon,\n  Article as ArticleIcon,\n} from '@mui/icons-material'\nimport { listReportRuns } from '@/api/client'\nimport useDocQAStore from '@/stores/docqaStore'\nimport useSharedData from '@/hooks/useSharedData'\nimport useIncomingTransfer from '@/hooks/useIncomingTransfer'\nimport useCrossPageActions from '@/hooks/useCrossPageActions'\nimport ImportFromMenu from '@/components/common/ImportFromMenu'\nimport ConnectionSelector from '@/components/common/ConnectionSelector'\nimport { TransferAction, FeatureKey } from '@/utils/crossPageTypes'\nimport { neutral, palette } from '@/app/theme'\nimport { slideInLeft, slideInRight, typing, pulse, float } from '@/styles'\nimport ConfirmModal from '@/components/Modal/ConfirmModal'\nimport { useToast } from '@/components/ToastProvider'\n// UX Components for premium interactions\nimport DisabledTooltip, { DisabledReasons } from '@/components/ux/DisabledTooltip'\nimport { useOperationHistory, OperationType } from '@/components/ux/OperationHistoryProvider'\nimport { ValidatedTextField, ValidationRules, CharacterCounter } from '@/components/ux/InlineValidator'\nimport { ContentSkeleton } from '@/components/feedback/LoadingState'\nimport AiUsageNotice from '@/components/ai/AiUsageNotice'\n// UX Governance - Enforced interaction API\nimport {\n  useInteraction,\n  InteractionType,\n  Reversibility,\n  useConfirmedAction,\n  IrreversibleActions,\n} from '@/components/ux/governance'\n\n// =============================================================================\n// STYLED COMPONENTS\n// =============================================================================\n\nconst PageContainer = styled(Box)(({ theme }) => ({\n  display: 'flex',\n  height: 'calc(100vh - 64px)',\n  backgroundColor: 'transparent',\n  position: 'relative',\n  overflow: 'hidden',\n}))\n\nconst Sidebar = styled(Box)(({ theme }) => ({\n  width: 300,\n  flexShrink: 0,\n  display: 'flex',\n  flexDirection: 'column',\n  background: alpha(theme.palette.background.paper, 0.6),\n  backdropFilter: 'blur(20px)',\n  borderRight: `1px solid ${alpha(theme.palette.divider, 0.1)}`,\n  position: 'relative',\n  '&::before': {\n    content: '\"\"',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    height: 200,\n    background: `linear-gradient(180deg, ${alpha(theme.palette.text.primary, 0.03)} 0%, transparent 100%)`,\n    pointerEvents: 'none',\n  },\n}))\n\nconst SidebarHeader = styled(Box)(({ theme }) => ({\n  padding: theme.spacing(3),\n  position: 'relative',\n  zIndex: 1,\n}))\n\nconst SessionList = styled(Box)(({ theme }) => ({\n  flex: 1,\n  overflow: 'auto',\n  padding: theme.spacing(0, 2, 2),\n  '&::-webkit-scrollbar': {\n    width: 6,\n  },\n  '&::-webkit-scrollbar-track': {\n    backgroundColor: 'transparent',\n  },\n  '&::-webkit-scrollbar-thumb': {\n    backgroundColor: alpha(theme.palette.text.primary, 0.1),\n    borderRadius: 1,  // Figma spec: 8px\n    '&:hover': {\n      backgroundColor: alpha(theme.palette.text.primary, 0.2),\n    },\n  },\n}))\n\nconst SessionCard = styled(Box, {\n  shouldForwardProp: (prop) => prop !== 'selected',\n})(({ theme, selected }) => ({\n  padding: theme.spacing(1.5),\n  borderRadius: 8,  // Figma spec: 8px\n  cursor: 'pointer',\n  marginBottom: theme.spacing(1),\n  backgroundColor: selected\n    ? (theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.1) : neutral[100])\n    : alpha(theme.palette.background.paper, 0.4),\n  border: `1px solid ${selected ? alpha(theme.palette.divider, 0.3) : 'transparent'}`,\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  position: 'relative',\n  overflow: 'hidden',\n  '&:hover': {\n    backgroundColor: selected\n      ? (theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.12) : neutral[200])\n      : (theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.05) : neutral[50]),\n    transform: 'translateX(4px)',\n  },\n  '&::before': selected\n    ? {\n        content: '\"\"',\n        position: 'absolute',\n        left: 0,\n        top: '50%',\n        transform: 'translateY(-50%)',\n        width: 3,\n        height: '60%',\n        background: theme.palette.mode === 'dark' ? neutral[500] : neutral[900],\n        borderRadius: '0 4px 4px 0',\n      }\n    : {},\n}))\n\nconst DocumentChip = styled(Chip)(({ theme }) => ({\n  height: 24,\n  fontSize: 12,\n  backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n  color: theme.palette.text.secondary,\n  border: `1px solid ${alpha(theme.palette.divider, 0.2)}`,\n  '& .MuiChip-icon': {\n    fontSize: 14,\n  },\n}))\n\nconst ChatArea = styled(Box)(({ theme }) => ({\n  flex: 1,\n  display: 'flex',\n  flexDirection: 'column',\n  backgroundColor: 'transparent',\n  position: 'relative',\n}))\n\nconst ChatHeader = styled(Box)(({ theme }) => ({\n  padding: theme.spacing(2, 3),\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'space-between',\n  background: alpha(theme.palette.background.paper, 0.4),\n  backdropFilter: 'blur(10px)',\n  borderBottom: `1px solid ${alpha(theme.palette.divider, 0.1)}`,\n}))\n\nconst MessagesContainer = styled(Box)(({ theme }) => ({\n  flex: 1,\n  overflow: 'auto',\n  padding: theme.spacing(3),\n  display: 'flex',\n  flexDirection: 'column',\n  gap: theme.spacing(2),\n  '&::-webkit-scrollbar': {\n    width: 8,\n  },\n  '&::-webkit-scrollbar-track': {\n    backgroundColor: 'transparent',\n  },\n  '&::-webkit-scrollbar-thumb': {\n    backgroundColor: alpha(theme.palette.text.primary, 0.1),\n    borderRadius: 4,\n    '&:hover': {\n      backgroundColor: alpha(theme.palette.text.primary, 0.2),\n    },\n  },\n}))\n\nconst MessageBubble = styled(Box, {\n  shouldForwardProp: (prop) => !['isUser', 'index'].includes(prop),\n})(({ theme, isUser, index }) => ({\n  maxWidth: '75%',\n  alignSelf: isUser ? 'flex-end' : 'flex-start',\n  animation: `${isUser ? slideInRight : slideInLeft} 0.4s ease-out`,\n  animationDelay: `${index * 0.05}s`,\n  animationFillMode: 'both',\n}))\n\nconst BubbleContent = styled(Box, {\n  shouldForwardProp: (prop) => prop !== 'isUser',\n})(({ theme, isUser }) => ({\n  padding: theme.spacing(2, 2.5),\n  borderRadius: isUser ? '20px 20px 4px 20px' : '20px 20px 20px 4px',\n  backgroundColor: isUser\n    ? (theme.palette.mode === 'dark' ? neutral[700] : neutral[900])\n    : alpha(theme.palette.background.paper, 0.8),\n  color: isUser ? theme.palette.common.white : theme.palette.text.primary,\n  backdropFilter: isUser ? 'none' : 'blur(10px)',\n  border: isUser ? 'none' : `1px solid ${alpha(theme.palette.divider, 0.1)}`,\n  position: 'relative',\n  boxShadow: isUser\n    ? `0 4px 20px ${alpha(theme.palette.common.black, 0.2)}`\n    : `0 4px 20px ${alpha(theme.palette.common.black, 0.05)}`,\n}))\n\nconst AvatarStyled = styled(Avatar, {\n  shouldForwardProp: (prop) => prop !== 'isUser',\n})(({ theme, isUser }) => ({\n  width: 36,\n  height: 36,\n  background: isUser\n    ? (theme.palette.mode === 'dark' ? neutral[700] : neutral[900])\n    : (theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.1) : neutral[100]),\n  border: `2px solid ${alpha(theme.palette.background.paper, 0.8)}`,\n  boxShadow: `0 2px 10px ${alpha(theme.palette.common.black, 0.1)}`,\n  '& svg': {\n    fontSize: 18,\n    color: isUser ? theme.palette.common.white : theme.palette.text.secondary,\n  },\n}))\n\nconst CitationBox = styled(Box)(({ theme }) => ({\n  marginTop: theme.spacing(2),\n  padding: theme.spacing(1.5),\n  backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.04) : neutral[50],\n  borderRadius: 8,  // Figma spec: 8px\n  border: `1px solid ${alpha(theme.palette.divider, 0.1)}`,\n}))\n\nconst CitationItem = styled(Box)(({ theme }) => ({\n  display: 'flex',\n  alignItems: 'flex-start',\n  gap: theme.spacing(1),\n  padding: theme.spacing(1),\n  borderRadius: 8,\n  backgroundColor: alpha(theme.palette.background.paper, 0.5),\n  marginTop: theme.spacing(1),\n  cursor: 'pointer',\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  '&:hover': {\n    backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.05) : neutral[50],\n  },\n}))\n\nconst FollowUpChip = styled(Chip)(({ theme }) => ({\n  borderRadius: 20,\n  backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n  border: `1px solid ${alpha(theme.palette.divider, 0.2)}`,\n  color: theme.palette.text.primary,\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  '&:hover': {\n    backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.12) : neutral[200],\n    transform: 'translateY(-2px)',\n    boxShadow: `0 4px 12px ${alpha(theme.palette.common.black, 0.1)}`,\n  },\n}))\n\nconst InputArea = styled(Box)(({ theme }) => ({\n  padding: theme.spacing(2, 3, 3),\n  background: `linear-gradient(180deg, transparent 0%, ${alpha(theme.palette.background.paper, 0.6)} 30%)`,\n  backdropFilter: 'blur(10px)',\n}))\n\nconst InputContainer = styled(Box)(({ theme }) => ({\n  display: 'flex',\n  alignItems: 'flex-end',\n  gap: theme.spacing(1.5),\n  padding: theme.spacing(1.5),\n  backgroundColor: alpha(theme.palette.background.paper, 0.8),\n  borderRadius: 24,\n  border: `1px solid ${alpha(theme.palette.divider, 0.15)}`,\n  boxShadow: `0 4px 20px ${alpha(theme.palette.common.black, 0.05)}`,\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  '&:focus-within': {\n    borderColor: alpha(theme.palette.divider, 0.4),\n    boxShadow: `0 4px 30px ${alpha(theme.palette.common.black, 0.08)}`,\n  },\n}))\n\nconst StyledTextField = styled(TextField)(({ theme }) => ({\n  '& .MuiOutlinedInput-root': {\n    backgroundColor: 'transparent',\n    fontSize: 16,\n    '& fieldset': {\n      border: 'none',\n    },\n  },\n  '& .MuiInputBase-input': {\n    padding: theme.spacing(1, 0),\n    '&::placeholder': {\n      color: alpha(theme.palette.text.secondary, 0.6),\n    },\n  },\n}))\n\nconst SendButton = styled(IconButton)(({ theme }) => ({\n  width: 44,\n  height: 44,\n  background: theme.palette.mode === 'dark' ? neutral[700] : neutral[900],\n  color: theme.palette.common.white,\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  '&:hover': {\n    transform: 'scale(1.05)',\n    background: theme.palette.mode === 'dark' ? neutral[500] : neutral[700],\n    boxShadow: `0 4px 20px ${alpha(theme.palette.common.black, 0.2)}`,\n  },\n  '&:disabled': {\n    background: alpha(theme.palette.text.primary, 0.1),\n    color: alpha(theme.palette.text.primary, 0.3),\n  },\n}))\n\nconst TypingIndicator = styled(Box)(({ theme }) => ({\n  display: 'flex',\n  alignItems: 'center',\n  gap: 6,\n  padding: theme.spacing(2),\n  '& span': {\n    width: 8,\n    height: 8,\n    borderRadius: '50%',\n    backgroundColor: theme.palette.text.secondary,\n    animation: `${typing} 1.4s infinite ease-in-out`,\n    '&:nth-of-type(1)': { animationDelay: '0s' },\n    '&:nth-of-type(2)': { animationDelay: '0.2s' },\n    '&:nth-of-type(3)': { animationDelay: '0.4s' },\n  },\n}))\n\nconst ThinkingBox = styled(Box)(({ theme }) => ({\n  display: 'flex',\n  alignItems: 'center',\n  gap: theme.spacing(1.5),\n  padding: theme.spacing(1.5, 2),\n  backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n  borderRadius: 8,  // Figma spec: 8px\n  marginBottom: theme.spacing(1),\n  animation: `${pulse} 2s infinite ease-in-out`,\n}))\n\nconst EmptyState = styled(Box)(({ theme }) => ({\n  flex: 1,\n  display: 'flex',\n  flexDirection: 'column',\n  alignItems: 'center',\n  justifyContent: 'center',\n  padding: theme.spacing(4),\n  textAlign: 'center',\n}))\n\nconst EmptyIcon = styled(Box)(({ theme }) => ({\n  width: 120,\n  height: 120,\n  borderRadius: '50%',\n  background: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n  marginBottom: theme.spacing(3),\n  animation: `${float} 3s infinite ease-in-out`,\n  '& svg': {\n    fontSize: 56,\n    color: theme.palette.text.secondary,\n  },\n}))\n\nconst SuggestionCard = styled(Box)(({ theme }) => ({\n  padding: theme.spacing(2),\n  borderRadius: 8,  // Figma spec: 8px\n  backgroundColor: alpha(theme.palette.background.paper, 0.6),\n  border: `1px solid ${alpha(theme.palette.divider, 0.1)}`,\n  cursor: 'pointer',\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  '&:hover': {\n    backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.05) : neutral[50],\n    borderColor: alpha(theme.palette.divider, 0.2),\n    transform: 'translateY(-2px)',\n  },\n}))\n\nconst ActionButton = styled(IconButton)(({ theme }) => ({\n  width: 28,\n  height: 28,\n  color: alpha(theme.palette.text.secondary, 0.6),\n  '&:hover': {\n    color: theme.palette.text.primary,\n    backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n  },\n}))\n\nconst NewSessionButton = styled(Button)(({ theme }) => ({\n  borderRadius: 8,  // Figma spec: 8px\n  padding: theme.spacing(1.5, 2),\n  background: theme.palette.mode === 'dark' ? neutral[700] : neutral[900],\n  color: theme.palette.common.white,\n  fontWeight: 600,\n  textTransform: 'none',\n  boxShadow: `0 4px 20px ${alpha(theme.palette.common.black, 0.15)}`,\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  '&:hover': {\n    transform: 'translateY(-2px)',\n    background: theme.palette.mode === 'dark' ? neutral[500] : neutral[700],\n    boxShadow: `0 6px 28px ${alpha(theme.palette.common.black, 0.2)}`,\n  },\n}))\n\nconst DocumentsSection = styled(Box)(({ theme }) => ({\n  padding: theme.spacing(2),\n  borderTop: `1px solid ${alpha(theme.palette.divider, 0.1)}`,\n  backgroundColor: alpha(theme.palette.background.paper, 0.3),\n}))\n\nconst LoadingOverlay = styled(Box)(({ theme }) => ({\n  position: 'absolute',\n  top: 0,\n  left: 0,\n  right: 0,\n  bottom: 0,\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n  backgroundColor: alpha(theme.palette.background.default, 0.8),\n  backdropFilter: 'blur(8px)',\n  zIndex: 10,\n}))\n\nconst LoadingSpinner = styled(Box)(({ theme }) => ({\n  width: 48,\n  height: 48,\n  borderRadius: '50%',\n  background: `conic-gradient(from 0deg, transparent, ${theme.palette.text.secondary})`,\n  animation: 'spin 1s linear infinite',\n  '@keyframes spin': {\n    to: { transform: 'rotate(360deg)' },\n  },\n  '&::before': {\n    content: '\"\"',\n    position: 'absolute',\n    inset: 4,\n    borderRadius: '50%',\n    backgroundColor: theme.palette.background.paper,\n  },\n}))\n\nconst GlassDialog = styled(Dialog)(({ theme }) => ({\n  '& .MuiDialog-paper': {\n    backgroundColor: alpha(theme.palette.background.paper, 0.9),\n    backdropFilter: 'blur(20px)',\n    borderRadius: 8,  // Figma spec: 8px\n    border: `1px solid ${alpha(theme.palette.divider, 0.1)}`,\n  },\n}))\n\n// =============================================================================\n// MAIN COMPONENT\n// =============================================================================\n\nconst MAX_DOC_SIZE = 5 * 1024 * 1024\nconst MIN_DOC_LENGTH = 10\nconst MAX_NAME_LENGTH = 200\nconst MIN_QUESTION_LENGTH = 3\nconst MAX_QUESTION_LENGTH = 2000\n\nexport default function DocumentQAPage() {\n  const theme = useTheme()\n  const {\n    sessions,\n    currentSession,\n    messages,\n    loading,\n    asking,\n    error,\n    fetchSessions,\n    createSession,\n    getSession,\n    deleteSession,\n    addDocument,\n    removeDocument,\n    askQuestion,\n    clearHistory,\n    submitFeedback,\n    regenerateResponse,\n    reset,\n  } = useDocQAStore()\n\n  const { connections, templates } = useSharedData()\n\n  // Cross-page: accept incoming documents from other features\n  useIncomingTransfer(FeatureKey.DOCQA, {\n    [TransferAction.CHAT_WITH]: async (payload) => {\n      const session = await createSession(payload.title ? `Q&A: ${payload.title}` : 'Q&A: Imported')\n      if (session) {\n        await addDocument(session.id, {\n          name: payload.title || 'Imported Document',\n          content: typeof payload.content === 'string' ? payload.content : JSON.stringify(payload.content),\n        })\n      }\n    },\n    [TransferAction.ADD_TO]: async (payload) => {\n      if (currentSession) {\n        await addDocument(currentSession.id, {\n          name: payload.title || 'Imported Document',\n          content: typeof payload.content === 'string' ? payload.content : JSON.stringify(payload.content),\n        })\n      }\n    },\n  })\n\n  const [createDialogOpen, setCreateDialogOpen] = useState(false)\n  const [addDocDialogOpen, setAddDocDialogOpen] = useState(false)\n  const [reportPickerOpen, setReportPickerOpen] = useState(false)\n  const [availableRuns, setAvailableRuns] = useState([])\n  const [runsLoading, setRunsLoading] = useState(false)\n  const [newSessionName, setNewSessionName] = useState('')\n  const [docName, setDocName] = useState('')\n  const [docContent, setDocContent] = useState('')\n  const [question, setQuestion] = useState('')\n  const messagesEndRef = useRef(null)\n  const [deleteSessionConfirm, setDeleteSessionConfirm] = useState({\n    open: false,\n    sessionId: null,\n    sessionName: '',\n  })\n  const [removeDocConfirm, setRemoveDocConfirm] = useState({\n    open: false,\n    docId: null,\n    docName: '',\n  })\n  const [clearChatConfirm, setClearChatConfirm] = useState({\n    open: false,\n    sessionId: null,\n    sessionName: '',\n    messageCount: 0,\n  })\n  const [searchQuery, setSearchQuery] = useState('')\n  const [selectedConnectionId, setSelectedConnectionId] = useState('')\n  const toast = useToast()\n  const [initialLoading, setInitialLoading] = useState(true)\n  const inputRef = useRef(null)\n  const docCount = currentSession?.documents?.length || 0\n  // UX Governance: Enforced interaction API - ALL user actions flow through this\n  const { execute } = useInteraction()\n  // UX: Confirmed action for irreversible delete operations\n  const confirmDeleteSession = useConfirmedAction('DELETE_SESSION')\n\n  useEffect(() => {\n    const init = async () => {\n      setInitialLoading(true)\n      await fetchSessions()\n      setInitialLoading(false)\n    }\n    init()\n    return () => reset()\n  }, [fetchSessions, reset])\n\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' })\n  }, [messages])\n\n  const handleCreateSession = () => {\n    if (!newSessionName) return\n    if (newSessionName.length > MAX_NAME_LENGTH) {\n      toast.show(`Session name must be ${MAX_NAME_LENGTH} characters or less`, 'error')\n      return\n    }\n    // UX Governance: All actions flow through enforced interaction API\n    execute({\n      type: InteractionType.CREATE,\n      label: `Create session \"${newSessionName}\"`,\n      reversibility: Reversibility.FULLY_REVERSIBLE,\n      successMessage: 'Session created successfully',\n      action: async () => {\n        await createSession(newSessionName)\n        setCreateDialogOpen(false)\n        setNewSessionName('')\n      },\n    })\n  }\n\n  const handleAddDocument = () => {\n    if (!currentSession || !docName || !docContent) return\n    if (docName.length > MAX_NAME_LENGTH) {\n      toast.show(`Document name must be ${MAX_NAME_LENGTH} characters or less`, 'error')\n      return\n    }\n    if (docContent.trim().length < MIN_DOC_LENGTH) {\n      toast.show(`Document content must be at least ${MIN_DOC_LENGTH} characters`, 'error')\n      return\n    }\n    if (docContent.length > MAX_DOC_SIZE) {\n      toast.show('Document content exceeds 5MB limit', 'error')\n      return\n    }\n    // UX Governance: Upload action with tracking\n    execute({\n      type: InteractionType.UPLOAD,\n      label: `Add document \"${docName}\"`,\n      reversibility: Reversibility.FULLY_REVERSIBLE,\n      successMessage: 'Document added successfully',\n      action: async () => {\n        await addDocument(currentSession.id, {\n          name: docName,\n          content: docContent,\n        })\n        setAddDocDialogOpen(false)\n        setDocName('')\n        setDocContent('')\n      },\n    })\n  }\n\n  const handleFileUpload = (event) => {\n    const file = event.target.files[0]\n    if (!file) return\n    if (file.name.length > MAX_NAME_LENGTH) {\n      toast.show(`File name must be ${MAX_NAME_LENGTH} characters or less`, 'error')\n      event.target.value = ''\n      return\n    }\n\n    const allowedExtensions = ['.txt', '.md', '.json', '.csv']\n    const fileName = file.name.toLowerCase()\n    const hasValidExtension = allowedExtensions.some((ext) =>\n      fileName.endsWith(ext)\n    )\n\n    if (!hasValidExtension) {\n      toast.show(\n        `Invalid file type. Supported formats: ${allowedExtensions.join(', ')}`,\n        'error'\n      )\n      event.target.value = ''\n      return\n    }\n\n    if (file.size > MAX_DOC_SIZE) {\n      toast.show('File size exceeds 5MB limit', 'error')\n      event.target.value = ''\n      return\n    }\n\n    const reader = new FileReader()\n    reader.onload = (e) => {\n      const content = e.target.result\n      if (content.includes('\\0')) {\n        toast.show('File appears to be binary. Please upload a text file.', 'error')\n        event.target.value = ''\n        return\n      }\n      setDocName(file.name)\n      setDocContent(content)\n    }\n    reader.onerror = () => {\n      toast.show('Failed to read file', 'error')\n      event.target.value = ''\n    }\n    reader.readAsText(file)\n  }\n\n  const handleOpenReportPicker = async () => {\n    setReportPickerOpen(true)\n    setRunsLoading(true)\n    try {\n      const runs = await listReportRuns({ limit: 50 })\n      setAvailableRuns(runs.filter((r) => r.status === 'succeeded'))\n    } catch {\n      toast.show('Failed to load reports', 'error')\n    } finally {\n      setRunsLoading(false)\n    }\n  }\n\n  const handleSelectReport = (run) => {\n    if (!currentSession) return\n    execute({\n      type: InteractionType.UPLOAD,\n      label: `Add report \"${run.templateName}\"`,\n      reversibility: Reversibility.FULLY_REVERSIBLE,\n      successMessage: `Report \"${run.templateName}\" added`,\n      action: async () => {\n        await addDocument(currentSession.id, {\n          name: `${run.templateName} (${run.startDate} – ${run.endDate})`,\n          content: [\n            `Report: ${run.templateName}`,\n            `Period: ${run.startDate} to ${run.endDate}`,\n            `Connection: ${run.connectionName}`,\n            `Generated: ${new Date(run.createdAt).toLocaleString()}`,\n            `Status: ${run.status}`,\n            run.artifacts?.html_url ? `HTML: ${run.artifacts.html_url}` : '',\n            run.artifacts?.pdf_url ? `PDF: ${run.artifacts.pdf_url}` : '',\n          ].filter(Boolean).join('\\n'),\n        })\n        setReportPickerOpen(false)\n      },\n    })\n  }\n\n  const handleAskQuestion = () => {\n    if (!currentSession || !question.trim()) return\n    const trimmedQuestion = question.trim()\n    if (trimmedQuestion.length < MIN_QUESTION_LENGTH) {\n      toast.show(`Question must be at least ${MIN_QUESTION_LENGTH} characters`, 'error')\n      return\n    }\n    if (trimmedQuestion.length > MAX_QUESTION_LENGTH) {\n      toast.show(`Question must be ${MAX_QUESTION_LENGTH} characters or less`, 'error')\n      return\n    }\n    const q = trimmedQuestion\n    // UX Governance: Analyze action with navigation safety\n    execute({\n      type: InteractionType.ANALYZE,\n      label: 'Analyzing documents...',\n      reversibility: Reversibility.SYSTEM_MANAGED,\n      blocksNavigation: true,\n      action: async () => {\n        setQuestion('')\n        await askQuestion(currentSession.id, q)\n      },\n    })\n  }\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault()\n      handleAskQuestion()\n    }\n  }\n\n  const handleCopyMessage = (content) => {\n    navigator.clipboard.writeText(content)\n    toast.show('Copied to clipboard', 'success')\n  }\n\n  const handleCitationClick = useCallback(async (citation) => {\n    const text = citation?.quote || citation?.document_name\n    if (!text) return\n    if (!navigator?.clipboard?.writeText) {\n      toast.show('Clipboard not available', 'warning')\n      return\n    }\n    try {\n      await navigator.clipboard.writeText(text)\n      toast.show('Citation copied', 'success')\n    } catch (err) {\n      toast.show(err.message || 'Failed to copy citation', 'error')\n    }\n  }, [toast])\n\n  const handleFeedback = async (messageId, feedbackType) => {\n    if (!currentSession) return\n    const result = await submitFeedback(currentSession.id, messageId, feedbackType)\n    if (result) {\n      toast.show(feedbackType === 'helpful' ? 'Thanks for the feedback!' : 'Thanks for letting us know', 'success')\n    }\n  }\n\n  const handleRegenerate = (messageId) => {\n    if (!currentSession) return\n    // UX Governance: Regenerate action with tracking\n    execute({\n      type: InteractionType.GENERATE,\n      label: 'Regenerating response...',\n      reversibility: Reversibility.SYSTEM_MANAGED,\n      successMessage: 'Response regenerated',\n      errorMessage: 'Failed to regenerate response',\n      blocksNavigation: true,\n      action: async () => {\n        const result = await regenerateResponse(currentSession.id, messageId)\n        if (!result) throw new Error('Regenerate failed')\n      },\n    })\n  }\n\n  const filteredSessions = sessions.filter((session) =>\n    session.name.toLowerCase().includes(searchQuery.toLowerCase())\n  )\n\n  const suggestedQuestions = [\n    'What are the main topics covered in these documents?',\n    'Can you summarize the key findings?',\n    'What are the most important insights?',\n    'Are there any conflicting information?',\n  ]\n\n  // Loading state\n  if (initialLoading) {\n    return (\n      <PageContainer>\n        <LoadingOverlay>\n          <Box sx={{ textAlign: 'center' }}>\n            <Box sx={{ position: 'relative', width: 48, height: 48, mx: 'auto', mb: 2 }}>\n              <LoadingSpinner />\n            </Box>\n            <Typography variant=\"body2\" color=\"text.secondary\">\n              Loading your sessions...\n            </Typography>\n          </Box>\n        </LoadingOverlay>\n      </PageContainer>\n    )\n  }\n\n  return (\n    <PageContainer>\n      {/* Sidebar */}\n      <Sidebar>\n        <SidebarHeader>\n          <Box sx={{ display: 'flex', alignItems: 'center', gap: 1.5, mb: 2 }}>\n            <Box\n              sx={{\n                width: 40,\n                height: 40,\n                borderRadius: 1,  // Figma spec: 8px\n                background: theme.palette.mode === 'dark' ? neutral[700] : neutral[900],\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n              }}\n            >\n              <QAIcon sx={{ color: 'common.white', fontSize: 24 }} />\n            </Box>\n            <Box>\n              <Typography variant=\"h6\" sx={{ fontWeight: 600, lineHeight: 1.2 }}>\n                Document Q&A\n              </Typography>\n              <Typography variant=\"caption\" color=\"text.secondary\">\n                AI-powered analysis\n              </Typography>\n            </Box>\n          </Box>\n\n          <NewSessionButton\n            fullWidth\n            startIcon={<AddIcon />}\n            onClick={() => setCreateDialogOpen(true)}\n          >\n            New Session\n          </NewSessionButton>\n\n          <TextField\n            fullWidth\n            size=\"small\"\n            placeholder=\"Search sessions...\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            sx={{ mt: 2 }}\n            InputProps={{\n              startAdornment: (\n                <InputAdornment position=\"start\">\n                  <SearchIcon sx={{ fontSize: 18, color: 'text.secondary' }} />\n                </InputAdornment>\n              ),\n              sx: {\n                borderRadius: 1,  // Figma spec: 8px\n                backgroundColor: alpha(theme.palette.background.paper, 0.5),\n                '& fieldset': {\n                  borderColor: alpha(theme.palette.divider, 0.1),\n                },\n              },\n            }}\n          />\n        </SidebarHeader>\n\n        <SessionList>\n          <Typography\n            variant=\"overline\"\n            sx={{ color: 'text.secondary', px: 1, display: 'block', mb: 1 }}\n          >\n            Sessions ({filteredSessions.length})\n          </Typography>\n\n          {filteredSessions.length === 0 ? (\n            <Box sx={{ textAlign: 'center', py: 4 }}>\n              <FolderIcon sx={{ fontSize: 40, color: 'text.disabled', mb: 1 }} />\n              <Typography variant=\"body2\" color=\"text.secondary\">\n                {searchQuery ? 'No matching sessions' : 'No sessions yet'}\n              </Typography>\n            </Box>\n          ) : (\n            filteredSessions.map((session, index) => (\n              <Fade in key={session.id} style={{ transitionDelay: `${index * 50}ms` }}>\n                <SessionCard\n                  selected={currentSession?.id === session.id}\n                  onClick={() => getSession(session.id)}\n                >\n                  <Box sx={{ display: 'flex', alignItems: 'flex-start', justifyContent: 'space-between' }}>\n                    <Box sx={{ flex: 1, minWidth: 0, pl: 1 }}>\n                      <Typography\n                        variant=\"subtitle2\"\n                        sx={{\n                          fontWeight: currentSession?.id === session.id ? 600 : 500,\n                          overflow: 'hidden',\n                          textOverflow: 'ellipsis',\n                          whiteSpace: 'nowrap',\n                        }}\n                      >\n                        {session.name}\n                      </Typography>\n                      <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mt: 0.5 }}>\n                        <DocumentChip\n                          size=\"small\"\n                          icon={<FileIcon />}\n                          label={`${session.documents?.length || 0} docs`}\n                        />\n                      </Box>\n                    </Box>\n                    <IconButton\n                      size=\"small\"\n                      onClick={(e) => {\n                        e.stopPropagation()\n                        setDeleteSessionConfirm({\n                          open: true,\n                          sessionId: session.id,\n                          sessionName: session.name,\n                        })\n                      }}\n                      sx={{\n                        opacity: 0.5,\n                        '&:hover': { opacity: 1, color: 'text.primary' },\n                      }}\n                    >\n                      <DeleteIcon fontSize=\"small\" />\n                    </IconButton>\n                  </Box>\n                </SessionCard>\n              </Fade>\n            ))\n          )}\n        </SessionList>\n\n        {/* Documents section for current session */}\n        {currentSession && (\n          <DocumentsSection>\n            <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', mb: 1 }}>\n              <Typography variant=\"overline\" sx={{ color: 'text.secondary' }}>\n                Documents\n              </Typography>\n              <Box sx={{ display: 'flex', gap: 0.5 }}>\n                <ImportFromMenu\n                  currentFeature={FeatureKey.DOCQA}\n                  onImport={(output) => {\n                    if (currentSession) {\n                      addDocument(currentSession.id, {\n                        name: output.title || 'Imported',\n                        content: typeof output.data === 'string' ? output.data : JSON.stringify(output.data),\n                      })\n                    }\n                  }}\n                  size=\"small\"\n                />\n                <Tooltip title=\"Add document\">\n                  <IconButton\n                    size=\"small\"\n                    onClick={() => setAddDocDialogOpen(true)}\n                    aria-label=\"Add document\"\n                    sx={{\n                      bgcolor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n                      '&:hover': { bgcolor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.12) : neutral[200] },\n                    }}\n                  >\n                    <AddIcon fontSize=\"small\" />\n                  </IconButton>\n                </Tooltip>\n              </Box>\n            </Box>\n            <Box sx={{ display: 'flex', flexDirection: 'column', gap: 0.5 }}>\n              {currentSession.documents?.map((doc) => (\n                <Box\n                  key={doc.id}\n                  sx={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: 1,\n                    p: 1,\n                    borderRadius: 1.5,\n                    bgcolor: alpha(theme.palette.background.paper, 0.5),\n                    '&:hover': { bgcolor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.05) : neutral[50] },\n                  }}\n                >\n                  <DocIcon sx={{ fontSize: 18, color: 'text.secondary' }} />\n                  <Typography\n                    variant=\"caption\"\n                    sx={{ flex: 1, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}\n                  >\n                    {doc.name}\n                  </Typography>\n                  <IconButton\n                    size=\"small\"\n                    onClick={() => setRemoveDocConfirm({ open: true, docId: doc.id, docName: doc.name })}\n                    sx={{ opacity: 0.5, '&:hover': { opacity: 1, color: 'text.primary' } }}\n                  >\n                    <CloseIcon sx={{ fontSize: 14 }} />\n                  </IconButton>\n                </Box>\n              ))}\n              {(!currentSession.documents || currentSession.documents.length === 0) && (\n                <Typography variant=\"caption\" color=\"text.secondary\" sx={{ textAlign: 'center', py: 2 }}>\n                  No documents added yet\n                </Typography>\n              )}\n            </Box>\n          </DocumentsSection>\n        )}\n\n        {/* Database connection for enriched Q&A */}\n        <Box sx={{ p: 2, borderTop: `1px solid ${alpha(theme.palette.divider, 0.1)}` }}>\n          <ConnectionSelector\n            value={selectedConnectionId}\n            onChange={setSelectedConnectionId}\n            label=\"Enrich with Database (Optional)\"\n            size=\"small\"\n            showStatus\n            fullWidth\n          />\n        </Box>\n      </Sidebar>\n\n      {/* Chat Area */}\n      <ChatArea>\n        {currentSession ? (\n          <>\n            {/* Chat Header */}\n            <ChatHeader>\n              <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\n                <Box\n                  sx={{\n                    width: 36,\n                    height: 36,\n                    borderRadius: 1,  // Figma spec: 8px\n                    bgcolor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                  }}\n                >\n                  <QAIcon sx={{ color: 'text.secondary', fontSize: 20 }} />\n                </Box>\n                <Box>\n                  <Typography variant=\"subtitle1\" sx={{ fontWeight: 600 }}>\n                    {currentSession.name}\n                  </Typography>\n                  <Typography variant=\"caption\" color=\"text.secondary\">\n                    {currentSession.documents?.length || 0} documents •{' '}\n                    {messages.length} messages •{' '}\n                    {connections.length} connections available\n                  </Typography>\n                </Box>\n              </Box>\n              {messages.length > 0 && (\n                <Button\n                  size=\"small\"\n                  startIcon={<ClearIcon />}\n                  onClick={() => setClearChatConfirm({\n                    open: true,\n                    sessionId: currentSession.id,\n                    sessionName: currentSession.name,\n                    messageCount: messages.length,\n                  })}\n                  sx={{\n                    borderRadius: 1,  // Figma spec: 8px\n                    textTransform: 'none',\n                    color: 'text.secondary',\n                  }}\n                >\n                  Clear Chat\n                </Button>\n              )}\n            </ChatHeader>\n\n            <Box sx={{ px: 3, pt: 2 }}>\n              <AiUsageNotice\n                title=\"AI answers\"\n                description=\"Responses are generated from documents in this session. Review citations before sharing.\"\n                chips={[\n                  { label: `Source: ${docCount} document${docCount === 1 ? '' : 's'}`, color: 'info', variant: 'outlined' },\n                  { label: 'Confidence: Verify citations', color: 'warning', variant: 'outlined' },\n                  { label: 'Reversible: No source changes', color: 'success', variant: 'outlined' },\n                ]}\n                dense\n              />\n            </Box>\n\n            {/* Messages */}\n            <MessagesContainer>\n              {messages.length === 0 ? (\n                <EmptyState>\n                  <EmptyIcon>\n                    <AIIcon />\n                  </EmptyIcon>\n                  <Typography variant=\"h5\" sx={{ fontWeight: 600, mb: 1 }}>\n                    {currentSession.documents?.length > 0\n                      ? 'Ready to answer your questions'\n                      : 'Add documents to get started'}\n                  </Typography>\n                  <Typography color=\"text.secondary\" sx={{ mb: 4, maxWidth: 400 }}>\n                    {currentSession.documents?.length > 0\n                      ? 'Ask anything about your documents. I\\'ll analyze them and provide accurate answers with citations.'\n                      : 'Upload documents to this session, then ask questions about their content.'}\n                  </Typography>\n\n                  {currentSession.documents?.length > 0 && (\n                    <Box sx={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 2, maxWidth: 600 }}>\n                      {suggestedQuestions.map((q, idx) => (\n                        <SuggestionCard key={idx} onClick={() => setQuestion(q)}>\n                          <Typography variant=\"body2\" sx={{ fontWeight: 500 }}>\n                            {q}\n                          </Typography>\n                        </SuggestionCard>\n                      ))}\n                    </Box>\n                  )}\n\n                  {!currentSession.documents?.length && (\n                    <Box sx={{ display: 'flex', gap: 2 }}>\n                      <Button\n                        variant=\"outlined\"\n                        startIcon={<UploadIcon />}\n                        onClick={() => setAddDocDialogOpen(true)}\n                        sx={{\n                          borderRadius: 1,\n                          textTransform: 'none',\n                          px: 4,\n                          py: 1.5,\n                        }}\n                      >\n                        Upload Document\n                      </Button>\n                      <Button\n                        variant=\"contained\"\n                        startIcon={<ArticleIcon />}\n                        onClick={handleOpenReportPicker}\n                        sx={{\n                          borderRadius: 1,\n                          textTransform: 'none',\n                          px: 4,\n                          py: 1.5,\n                          background: theme.palette.mode === 'dark' ? neutral[700] : neutral[900],\n                        }}\n                      >\n                        Select Existing Report\n                      </Button>\n                    </Box>\n                  )}\n\n                  {connections.length > 0 && (\n                    <Box sx={{ mt: 3, textAlign: 'center' }}>\n                      <Typography variant=\"caption\" color=\"text.secondary\">\n                        {connections.length} database connection{connections.length !== 1 ? 's' : ''} and {templates.length} template{templates.length !== 1 ? 's' : ''} available\n                      </Typography>\n                    </Box>\n                  )}\n                </EmptyState>\n              ) : (\n                <>\n                  {messages.map((msg, idx) => (\n                    <MessageBubble key={idx} isUser={msg.role === 'user'} index={idx}>\n                      <Box\n                        sx={{\n                          display: 'flex',\n                          gap: 1.5,\n                          flexDirection: msg.role === 'user' ? 'row-reverse' : 'row',\n                          alignItems: 'flex-start',\n                        }}\n                      >\n                        <AvatarStyled isUser={msg.role === 'user'}>\n                          {msg.role === 'user' ? <UserIcon /> : <AIIcon />}\n                        </AvatarStyled>\n\n                        <Box sx={{ flex: 1 }}>\n                          <BubbleContent isUser={msg.role === 'user'}>\n                            <Typography\n                              variant=\"body2\"\n                              sx={{\n                                whiteSpace: 'pre-wrap',\n                                lineHeight: 1.6,\n                              }}\n                            >\n                              {msg.content}\n                            </Typography>\n                          </BubbleContent>\n\n                          {/* Citations */}\n                          {msg.citations?.length > 0 && (\n                            <CitationBox>\n                              <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mb: 1 }}>\n                                <QuoteIcon sx={{ fontSize: 16, color: 'text.secondary' }} />\n                                <Typography variant=\"caption\" sx={{ fontWeight: 600, color: 'text.secondary' }}>\n                                  Sources ({msg.citations.length})\n                                </Typography>\n                              </Box>\n                              {msg.citations.map((cit, cidx) => (\n                                <CitationItem key={cidx} onClick={() => handleCitationClick(cit)}>\n                                  <FileIcon sx={{ fontSize: 16, color: 'text.secondary', mt: 0.25 }} />\n                                  <Box>\n                                    <Typography variant=\"caption\" sx={{ fontWeight: 600, display: 'block' }}>\n                                      {cit.document_name}\n                                    </Typography>\n                                    <Typography\n                                      variant=\"caption\"\n                                      color=\"text.secondary\"\n                                      sx={{ fontStyle: 'italic' }}\n                                    >\n                                      \"{cit.quote?.substring(0, 120)}...\"\n                                    </Typography>\n                                  </Box>\n                                </CitationItem>\n                              ))}\n                            </CitationBox>\n                          )}\n\n                          {/* Follow-up questions */}\n                          {msg.metadata?.follow_up_questions?.length > 0 && (\n                            <Box sx={{ mt: 2 }}>\n                              <Typography variant=\"caption\" color=\"text.secondary\" sx={{ mb: 1, display: 'block' }}>\n                                Related questions\n                              </Typography>\n                              <Box sx={{ display: 'flex', gap: 1, flexWrap: 'wrap' }}>\n                                {msg.metadata.follow_up_questions.map((fq, fqidx) => (\n                                  <FollowUpChip\n                                    key={fqidx}\n                                    label={fq}\n                                    size=\"small\"\n                                    clickable\n                                    onClick={() => setQuestion(fq)}\n                                  />\n                                ))}\n                              </Box>\n                            </Box>\n                          )}\n\n                          {/* Message actions */}\n                          {msg.role === 'assistant' && (\n                            <Box sx={{ display: 'flex', gap: 0.5, mt: 1.5 }}>\n                              <Tooltip title=\"Copy\">\n                                <ActionButton size=\"small\" onClick={() => handleCopyMessage(msg.content)}>\n                                  <CopyIcon sx={{ fontSize: 16 }} />\n                                </ActionButton>\n                              </Tooltip>\n                              <Tooltip title={msg.feedback?.feedback_type === 'helpful' ? 'Marked as helpful' : 'Helpful'}>\n                                <ActionButton\n                                  size=\"small\"\n                                  onClick={() => handleFeedback(msg.id, 'helpful')}\n                                  sx={{\n                                    color: msg.feedback?.feedback_type === 'helpful'\n                                      ? 'text.primary'\n                                      : undefined,\n                                    bgcolor: msg.feedback?.feedback_type === 'helpful'\n                                      ? (theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.1) : neutral[100])\n                                      : undefined,\n                                  }}\n                                >\n                                  <ThumbUpIcon sx={{ fontSize: 16 }} />\n                                </ActionButton>\n                              </Tooltip>\n                              <Tooltip title={msg.feedback?.feedback_type === 'not_helpful' ? 'Marked as not helpful' : 'Not helpful'}>\n                                <ActionButton\n                                  size=\"small\"\n                                  onClick={() => handleFeedback(msg.id, 'not_helpful')}\n                                  sx={{\n                                    color: msg.feedback?.feedback_type === 'not_helpful'\n                                      ? 'text.primary'\n                                      : undefined,\n                                    bgcolor: msg.feedback?.feedback_type === 'not_helpful'\n                                      ? (theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.1) : neutral[100])\n                                      : undefined,\n                                  }}\n                                >\n                                  <ThumbDownIcon sx={{ fontSize: 16 }} />\n                                </ActionButton>\n                              </Tooltip>\n                              <Tooltip title=\"Regenerate response\">\n                                <ActionButton\n                                  size=\"small\"\n                                  onClick={() => handleRegenerate(msg.id)}\n                                  disabled={asking}\n                                >\n                                  <RefreshIcon sx={{ fontSize: 16 }} />\n                                </ActionButton>\n                              </Tooltip>\n                            </Box>\n                          )}\n                        </Box>\n                      </Box>\n                    </MessageBubble>\n                  ))}\n\n                  {/* Typing indicator */}\n                  {asking && (\n                    <MessageBubble isUser={false} index={messages.length}>\n                      <Box sx={{ display: 'flex', gap: 1.5, alignItems: 'flex-start' }}>\n                        <AvatarStyled isUser={false}>\n                          <AIIcon />\n                        </AvatarStyled>\n                        <Box>\n                          <ThinkingBox>\n                            <ThinkIcon sx={{ fontSize: 18, color: 'text.secondary' }} />\n                            <Typography variant=\"caption\" sx={{ fontWeight: 500 }}>\n                              Analyzing documents...\n                            </Typography>\n                          </ThinkingBox>\n                          <BubbleContent isUser={false}>\n                            <TypingIndicator>\n                              <span />\n                              <span />\n                              <span />\n                            </TypingIndicator>\n                          </BubbleContent>\n                        </Box>\n                      </Box>\n                    </MessageBubble>\n                  )}\n                </>\n              )}\n              <div ref={messagesEndRef} />\n            </MessagesContainer>\n\n            {/* Input Area */}\n            <InputArea>\n              {error && (\n                <Alert\n                  severity=\"error\"\n                  onClose={() => reset()}\n                  sx={{ mb: 2, borderRadius: 1 }}\n                >\n                  {error}\n                </Alert>\n              )}\n              <InputContainer>\n                <Tooltip title=\"Attach file\">\n                  <IconButton\n                    size=\"small\"\n                    onClick={() => setAddDocDialogOpen(true)}\n                    sx={{ color: 'text.secondary' }}\n                  >\n                    <AttachIcon />\n                  </IconButton>\n                </Tooltip>\n                <StyledTextField\n                  ref={inputRef}\n                  fullWidth\n                  placeholder={\n                    currentSession.documents?.length\n                      ? 'Ask a question about your documents...'\n                      : 'Add documents to start asking questions...'\n                  }\n                  value={question}\n                  onChange={(e) => setQuestion(e.target.value)}\n                  onKeyDown={handleKeyDown}\n                  disabled={asking || !currentSession.documents?.length}\n                  multiline\n                  maxRows={4}\n                  inputProps={{ maxLength: MAX_QUESTION_LENGTH }}\n                />\n                {/* UX: DisabledTooltip explains WHY the button is disabled */}\n                <DisabledTooltip\n                  disabled={\n                    !question.trim()\n                    || question.trim().length < MIN_QUESTION_LENGTH\n                    || question.trim().length > MAX_QUESTION_LENGTH\n                    || asking\n                    || !currentSession.documents?.length\n                  }\n                  reason={\n                    asking\n                      ? 'Please wait for the current question to complete'\n                      : !currentSession.documents?.length\n                        ? 'Add at least one document first'\n                        : !question.trim()\n                          ? 'Enter a question to ask'\n                          : question.trim().length < MIN_QUESTION_LENGTH\n                            ? `Question must be at least ${MIN_QUESTION_LENGTH} characters`\n                            : question.trim().length > MAX_QUESTION_LENGTH\n                              ? `Question exceeds ${MAX_QUESTION_LENGTH} character limit`\n                              : undefined\n                  }\n                  hint={\n                    !currentSession.documents?.length\n                      ? 'Click the attach button or drag a file'\n                      : !question.trim()\n                        ? 'Type your question in the field above'\n                        : undefined\n                  }\n                >\n                  <SendButton\n                    onClick={handleAskQuestion}\n                    disabled={\n                      !question.trim()\n                      || question.trim().length < MIN_QUESTION_LENGTH\n                      || question.trim().length > MAX_QUESTION_LENGTH\n                      || asking\n                      || !currentSession.documents?.length\n                    }\n                  >\n                    {asking ? (\n                      <Box\n                        sx={{\n                          width: 20,\n                          height: 20,\n                          border: '2px solid',\n                          borderColor: 'rgba(255,255,255,0.3)',\n                          borderTopColor: 'common.white',\n                          borderRadius: '50%',\n                          animation: 'spin 0.8s linear infinite',\n                        }}\n                      />\n                    ) : (\n                      <SendIcon />\n                    )}\n                  </SendButton>\n                </DisabledTooltip>\n              </InputContainer>\n            </InputArea>\n          </>\n        ) : (\n          <EmptyState>\n            <EmptyIcon>\n              <QAIcon />\n            </EmptyIcon>\n            <Typography variant=\"h5\" sx={{ fontWeight: 600, mb: 1 }}>\n              Document Intelligence\n            </Typography>\n            <Typography color=\"text.secondary\" sx={{ mb: 4, maxWidth: 450 }}>\n              Create a session, upload your documents, and start asking questions.\n              Our AI will analyze and provide accurate answers with citations.\n            </Typography>\n            <NewSessionButton\n              startIcon={<AddIcon />}\n              onClick={() => setCreateDialogOpen(true)}\n              sx={{ px: 4, py: 1.5 }}\n            >\n              Create Your First Session\n            </NewSessionButton>\n          </EmptyState>\n        )}\n      </ChatArea>\n\n      {/* Create Session Dialog */}\n      <GlassDialog\n        open={createDialogOpen}\n        onClose={() => setCreateDialogOpen(false)}\n        maxWidth=\"xs\"\n        fullWidth\n      >\n        <DialogTitle sx={{ pb: 1 }}>\n          <Typography variant=\"h6\" sx={{ fontWeight: 600 }}>\n            Create Q&A Session\n          </Typography>\n          <Typography variant=\"body2\" color=\"text.secondary\">\n            Start a new document analysis workspace\n          </Typography>\n        </DialogTitle>\n        <DialogContent>\n          <TextField\n            fullWidth\n            label=\"Session Name\"\n            placeholder=\"e.g., Research Papers Analysis\"\n            value={newSessionName}\n            onChange={(e) => setNewSessionName(e.target.value)}\n            sx={{ mt: 2 }}\n            inputProps={{ maxLength: MAX_NAME_LENGTH }}\n            InputProps={{\n              sx: { borderRadius: 1 },\n            }}\n          />\n        </DialogContent>\n        <DialogActions sx={{ px: 3, pb: 3 }}>\n          <Button\n            onClick={() => setCreateDialogOpen(false)}\n            sx={{ borderRadius: 1, textTransform: 'none' }}\n          >\n            Cancel\n          </Button>\n          <Button\n            variant=\"contained\"\n            onClick={handleCreateSession}\n            disabled={!newSessionName}\n            sx={{\n              borderRadius: 1,  // Figma spec: 8px\n              textTransform: 'none',\n              px: 3,\n              background: theme.palette.mode === 'dark' ? neutral[700] : neutral[900],\n            }}\n          >\n            Create Session\n          </Button>\n        </DialogActions>\n      </GlassDialog>\n\n      {/* Add Document Dialog */}\n      <GlassDialog\n        open={addDocDialogOpen}\n        onClose={() => setAddDocDialogOpen(false)}\n        maxWidth=\"md\"\n        fullWidth\n      >\n        <DialogTitle sx={{ pb: 1 }}>\n          <Typography variant=\"h6\" sx={{ fontWeight: 600 }}>\n            Add Document\n          </Typography>\n          <Typography variant=\"body2\" color=\"text.secondary\">\n            Upload or paste document content for analysis\n          </Typography>\n        </DialogTitle>\n        <DialogContent>\n          <Box\n            sx={{\n              mt: 2,\n              p: 4,\n              border: `2px dashed ${alpha(theme.palette.divider, 0.4)}`,\n              borderRadius: 1,  // Figma spec: 8px\n              textAlign: 'center',\n              cursor: 'pointer',\n              transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n              bgcolor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.02) : neutral[50],\n              '&:hover': {\n                borderColor: theme.palette.mode === 'dark' ? neutral[500] : neutral[700],\n                bgcolor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.05) : neutral[100],\n              },\n            }}\n            component=\"label\"\n          >\n            <UploadIcon sx={{ fontSize: 40, color: 'text.secondary', mb: 1 }} />\n            <Typography variant=\"body1\" sx={{ fontWeight: 500, mb: 0.5 }}>\n              Drop your file here or click to browse\n            </Typography>\n            <Typography variant=\"caption\" color=\"text.secondary\">\n              Supports TXT, MD, JSON, CSV (max 5MB)\n            </Typography>\n            <input\n              type=\"file\"\n              hidden\n              onChange={handleFileUpload}\n              accept=\".txt,.md,.json,.csv\"\n            />\n          </Box>\n\n          <Divider sx={{ my: 3 }}>\n            <Typography variant=\"caption\" color=\"text.secondary\">\n              OR\n            </Typography>\n          </Divider>\n\n          <TextField\n            fullWidth\n            label=\"Document Name\"\n            value={docName}\n            onChange={(e) => setDocName(e.target.value)}\n            sx={{ mb: 2 }}\n            inputProps={{ maxLength: MAX_NAME_LENGTH }}\n            InputProps={{ sx: { borderRadius: 1 } }}\n          />\n          <TextField\n            fullWidth\n            multiline\n            rows={10}\n            label=\"Document Content\"\n            value={docContent}\n            onChange={(e) => setDocContent(e.target.value)}\n            placeholder=\"Paste your document content here...\"\n            inputProps={{ maxLength: MAX_DOC_SIZE }}\n            InputProps={{ sx: { borderRadius: 1 } }}\n          />\n        </DialogContent>\n        <DialogActions sx={{ px: 3, pb: 3 }}>\n          <Button\n            onClick={() => setAddDocDialogOpen(false)}\n            sx={{ borderRadius: 1, textTransform: 'none' }}\n          >\n            Cancel\n          </Button>\n          <Button\n            variant=\"contained\"\n            onClick={handleAddDocument}\n            disabled={!docName || !docContent}\n            sx={{\n              borderRadius: 1,  // Figma spec: 8px\n              textTransform: 'none',\n              px: 3,\n              background: theme.palette.mode === 'dark' ? neutral[700] : neutral[900],\n            }}\n          >\n            Add Document\n          </Button>\n        </DialogActions>\n      </GlassDialog>\n\n      {/* Select Existing Report Dialog */}\n      <GlassDialog\n        open={reportPickerOpen}\n        onClose={() => setReportPickerOpen(false)}\n        maxWidth=\"sm\"\n        fullWidth\n      >\n        <DialogTitle sx={{ pb: 1 }}>\n          <Typography variant=\"h6\" sx={{ fontWeight: 600 }}>\n            Select Existing Report\n          </Typography>\n          <Typography variant=\"body2\" color=\"text.secondary\">\n            Choose a generated report to add to this session\n          </Typography>\n        </DialogTitle>\n        <DialogContent>\n          {runsLoading ? (\n            <Box sx={{ display: 'flex', justifyContent: 'center', py: 4 }}>\n              <ContentSkeleton rows={3} />\n            </Box>\n          ) : availableRuns.length === 0 ? (\n            <Box sx={{ textAlign: 'center', py: 4 }}>\n              <ArticleIcon sx={{ fontSize: 48, color: 'text.disabled', mb: 1 }} />\n              <Typography color=\"text.secondary\">\n                No generated reports found\n              </Typography>\n              <Typography variant=\"caption\" color=\"text.secondary\">\n                Generate a report first, then come back to analyze it here.\n              </Typography>\n            </Box>\n          ) : (\n            <List sx={{ pt: 1 }}>\n              {availableRuns.map((run) => (\n                <ListItem\n                  key={run.id}\n                  button\n                  onClick={() => handleSelectReport(run)}\n                  sx={{\n                    borderRadius: 1,\n                    mb: 0.5,\n                    border: `1px solid ${alpha(theme.palette.divider, 0.1)}`,\n                    '&:hover': {\n                      bgcolor: theme.palette.mode === 'dark'\n                        ? alpha(theme.palette.text.primary, 0.06)\n                        : neutral[50],\n                    },\n                  }}\n                >\n                  <ListItemIcon sx={{ minWidth: 40 }}>\n                    <ArticleIcon sx={{ color: 'text.secondary' }} />\n                  </ListItemIcon>\n                  <ListItemText\n                    primary={run.templateName || run.id}\n                    secondary={`${run.startDate} – ${run.endDate} · ${run.connectionName || 'Unknown source'}`}\n                    primaryTypographyProps={{ variant: 'body2', fontWeight: 600 }}\n                    secondaryTypographyProps={{ variant: 'caption' }}\n                  />\n                  <Typography variant=\"caption\" color=\"text.secondary\" sx={{ whiteSpace: 'nowrap', ml: 1 }}>\n                    {new Date(run.createdAt).toLocaleDateString()}\n                  </Typography>\n                </ListItem>\n              ))}\n            </List>\n          )}\n        </DialogContent>\n        <DialogActions sx={{ px: 3, pb: 3 }}>\n          <Button\n            onClick={() => setReportPickerOpen(false)}\n            sx={{ borderRadius: 1, textTransform: 'none' }}\n          >\n            Cancel\n          </Button>\n        </DialogActions>\n      </GlassDialog>\n\n      {/* Confirm Modals */}\n      <ConfirmModal\n        open={deleteSessionConfirm.open}\n        onClose={() =>\n          setDeleteSessionConfirm({ open: false, sessionId: null, sessionName: '' })\n        }\n        onConfirm={() => {\n          const sessionId = deleteSessionConfirm.sessionId\n          const sessionName = deleteSessionConfirm.sessionName\n          setDeleteSessionConfirm({ open: false, sessionId: null, sessionName: '' })\n\n          // UX Governance: Irreversible delete action with full tracking\n          execute({\n            type: InteractionType.DELETE,\n            label: `Delete session \"${sessionName}\"`,\n            reversibility: Reversibility.IRREVERSIBLE,\n            successMessage: `Session \"${sessionName}\" deleted`,\n            errorMessage: 'Failed to delete session',\n            action: async () => {\n              const success = await deleteSession(sessionId)\n              if (!success) throw new Error('Delete failed')\n            },\n          })\n        }}\n        title=\"Delete Session\"\n        message={`Are you sure you want to delete \"${deleteSessionConfirm.sessionName}\"? All documents and chat history will be permanently removed.`}\n        confirmLabel=\"Delete\"\n        severity=\"error\"\n      />\n\n      <ConfirmModal\n        open={removeDocConfirm.open}\n        onClose={() =>\n          setRemoveDocConfirm({ open: false, docId: null, docName: '' })\n        }\n        onConfirm={() => {\n          const docId = removeDocConfirm.docId\n          const docName = removeDocConfirm.docName\n          setRemoveDocConfirm({ open: false, docId: null, docName: '' })\n\n          // UX Governance: Delete action with tracking\n          execute({\n            type: InteractionType.DELETE,\n            label: `Remove document \"${docName}\"`,\n            reversibility: Reversibility.PARTIALLY_REVERSIBLE,\n            successMessage: `Document \"${docName}\" removed`,\n            errorMessage: 'Failed to remove document',\n            action: async () => {\n              const success = await removeDocument(currentSession?.id, docId)\n              if (!success) throw new Error('Remove failed')\n            },\n          })\n        }}\n        title=\"Remove Document\"\n        message={`Are you sure you want to remove \"${removeDocConfirm.docName}\" from this session?`}\n        confirmLabel=\"Remove\"\n        severity=\"warning\"\n      />\n\n      {/* Clear Chat Confirmation */}\n      <ConfirmModal\n        open={clearChatConfirm.open}\n        onClose={() =>\n          setClearChatConfirm({ open: false, sessionId: null, sessionName: '', messageCount: 0 })\n        }\n        onConfirm={() => {\n          const sessionId = clearChatConfirm.sessionId\n          const sessionName = clearChatConfirm.sessionName\n          setClearChatConfirm({ open: false, sessionId: null, sessionName: '', messageCount: 0 })\n\n          // UX Governance: Clear action with tracking\n          execute({\n            type: InteractionType.DELETE,\n            label: `Clear chat history for \"${sessionName}\"`,\n            reversibility: Reversibility.PARTIALLY_REVERSIBLE,\n            successMessage: 'Chat history cleared',\n            errorMessage: 'Failed to clear chat history',\n            action: async () => {\n              await clearHistory(sessionId)\n            },\n          })\n        }}\n        title=\"Clear Chat History\"\n        message={`Are you sure you want to clear all ${clearChatConfirm.messageCount} messages from \"${clearChatConfirm.sessionName}\"? This action cannot be undone.`}\n        confirmLabel=\"Clear History\"\n        severity=\"warning\"\n      />\n    </PageContainer>\n  )\n}\n","import { useInteraction } from '@/components/ux/governance'\nimport DocumentQAPageContainer from '@/features/docqa/containers/DocumentQAPageContainer'\n\nexport default function DocumentQAPage() {\n  useInteraction()\n  return <DocumentQAPageContainer />\n}\n"],"names":["AttachIcon","createSvgIcon","_jsx","ThumbDownIcon","ThumbUpIcon","asArray","payload","keys","key","createSession","name","apiClient","listSessions","limit","offset","params","sessions","getSession","sessionId","deleteSession","addDocument","content","pageCount","removeDocument","documentId","askQuestion","question","includeCitations","maxResponseLength","getChatHistory","clearHistory","submitFeedback","messageId","feedbackType","comment","regenerateResponse","useDocQAStore","create","set","get","loading","error","response","docqaApi.listSessions","err","session","docqaApi.createSession","state","docqaApi.getSession","messages","history","docqaApi.getChatHistory","docqaApi.deleteSession","s","documentData","docqaApi.addDocument","docqaApi.removeDocument","options","userMessage","docqaApi.askQuestion","m","docqaApi.clearHistory","docqaApi.submitFeedback","msg","docqaApi.regenerateResponse","pulse","keyframes","Skeleton","variant","width","height","lines","animation","sx","props","theme","useTheme","sxArray","animationStyle","alpha","shimmer","jsx","Box","_","i","ContentSkeleton","type","count","items","jsxs","PageContainer","styled","Sidebar","SidebarHeader","SessionList","SessionCard","prop","selected","neutral","DocumentChip","Chip","ChatArea","ChatHeader","MessagesContainer","MessageBubble","isUser","index","slideInRight","slideInLeft","BubbleContent","AvatarStyled","Avatar","CitationBox","CitationItem","FollowUpChip","InputArea","InputContainer","StyledTextField","TextField","SendButton","IconButton","TypingIndicator","typing","ThinkingBox","EmptyState","EmptyIcon","float","SuggestionCard","ActionButton","NewSessionButton","Button","DocumentsSection","LoadingOverlay","LoadingSpinner","GlassDialog","Dialog","MAX_DOC_SIZE","MIN_DOC_LENGTH","MAX_NAME_LENGTH","MIN_QUESTION_LENGTH","MAX_QUESTION_LENGTH","DocumentQAPage","currentSession","asking","fetchSessions","reset","connections","templates","useSharedData","useIncomingTransfer","FeatureKey","TransferAction","createDialogOpen","setCreateDialogOpen","useState","addDocDialogOpen","setAddDocDialogOpen","reportPickerOpen","setReportPickerOpen","availableRuns","setAvailableRuns","runsLoading","setRunsLoading","newSessionName","setNewSessionName","docName","setDocName","docContent","setDocContent","setQuestion","messagesEndRef","useRef","deleteSessionConfirm","setDeleteSessionConfirm","removeDocConfirm","setRemoveDocConfirm","clearChatConfirm","setClearChatConfirm","searchQuery","setSearchQuery","selectedConnectionId","setSelectedConnectionId","toast","useToast","initialLoading","setInitialLoading","inputRef","docCount","execute","useInteraction","useConfirmedAction","useEffect","handleCreateSession","InteractionType","Reversibility","handleAddDocument","handleFileUpload","event","file","allowedExtensions","fileName","ext","reader","e","handleOpenReportPicker","runs","listReportRuns","r","handleSelectReport","run","handleAskQuestion","trimmedQuestion","q","handleKeyDown","handleCopyMessage","handleCitationClick","useCallback","citation","text","handleFeedback","handleRegenerate","filteredSessions","suggestedQuestions","Typography","QAIcon","AddIcon","InputAdornment","SearchIcon","FolderIcon","Fade","FileIcon","DeleteIcon","ImportFromMenu","output","Tooltip","doc","DocIcon","CloseIcon","ConnectionSelector","Fragment","ClearIcon","AiUsageNotice","AIIcon","idx","UploadIcon","ArticleIcon","UserIcon","QuoteIcon","cit","cidx","fq","fqidx","CopyIcon","RefreshIcon","ThinkIcon","Alert","DisabledTooltip","SendIcon","DialogTitle","DialogContent","DialogActions","Divider","List","ListItem","ListItemIcon","ListItemText","ConfirmModal","sessionName","docId","DocumentQAPageContainer"],"mappings":"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","x_google_ignoreList":[0,1,2]}