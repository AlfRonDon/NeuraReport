{"version":3,"file":"HistoryPage-BFE8Ln9R.js","sources":["../../src/features/history/containers/HistoryPageContainer.jsx","../../src/pages/history/HistoryPage.jsx"],"sourcesContent":["/**\n * Premium History Page\n * Sophisticated report history with glassmorphism and animations\n */\nimport { useState, useCallback, useEffect, useRef } from 'react'\nimport { useSearchParams } from 'react-router-dom'\nimport {\n  Box,\n  Typography,\n  Stack,\n  IconButton,\n  Chip,\n  Select,\n  MenuItem,\n  InputLabel,\n  CircularProgress,\n  Button,\n  Alert,\n  Tooltip,\n  useTheme,\n  alpha,\n  styled,\n} from '@mui/material'\nimport RefreshIcon from '@mui/icons-material/Refresh'\nimport HistoryIcon from '@mui/icons-material/History'\nimport DownloadIcon from '@mui/icons-material/Download'\nimport DeleteIcon from '@mui/icons-material/Delete'\nimport VisibilityIcon from '@mui/icons-material/Visibility'\nimport PictureAsPdfIcon from '@mui/icons-material/PictureAsPdf'\nimport TableChartIcon from '@mui/icons-material/TableChart'\nimport ArticleIcon from '@mui/icons-material/Article'\nimport CheckCircleIcon from '@mui/icons-material/CheckCircle'\nimport ErrorIcon from '@mui/icons-material/Error'\nimport HourglassEmptyIcon from '@mui/icons-material/HourglassEmpty'\nimport CancelIcon from '@mui/icons-material/Cancel'\nimport AddIcon from '@mui/icons-material/Add'\nimport { DataTable } from '@/components/DataTable'\nimport { ConfirmModal } from '@/components/Modal'\nimport { useToast } from '@/components/ToastProvider'\nimport { useInteraction, InteractionType, Reversibility, useNavigateInteraction } from '@/components/ux/governance'\nimport { useAppStore } from '@/stores'\nimport * as api from '@/api/client'\nimport { neutral, palette } from '@/app/theme'\nimport { fadeInUp, float, StyledFormControl, RefreshButton } from '@/styles'\n\n// =============================================================================\n// STYLED COMPONENTS\n// =============================================================================\n\nconst PageContainer = styled(Box)(({ theme }) => ({\n  padding: theme.spacing(3),\n  maxWidth: 1400,\n  margin: '0 auto',\n  width: '100%',\n  minHeight: '100vh',\n  backgroundColor: theme.palette.background.default,\n}))\n\nconst PageHeader = styled(Box)(({ theme }) => ({\n  marginBottom: theme.spacing(3),\n  animation: `${fadeInUp} 0.5s ease-out`,\n}))\n\nconst PageTitle = styled(Typography)(({ theme }) => ({\n  fontSize: '1.75rem',\n  fontWeight: 600,\n  letterSpacing: '-0.02em',\n  color: theme.palette.mode === 'dark' ? neutral[100] : neutral[900],\n}))\n\nconst FilterContainer = styled(Stack)(({ theme }) => ({\n  marginBottom: theme.spacing(3),\n  animation: `${fadeInUp} 0.5s ease-out 0.1s both`,\n}))\n\nconst TableContainer = styled(Box)(({ theme }) => ({\n  backgroundColor: alpha(theme.palette.background.paper, 0.8),\n  backdropFilter: 'blur(20px)',\n  borderRadius: 8,  // Figma spec: 8px\n  border: `1px solid ${alpha(theme.palette.divider, 0.1)}`,\n  boxShadow: `0 8px 32px ${alpha(theme.palette.common.black, 0.08)}`,\n  overflow: 'hidden',\n  animation: `${fadeInUp} 0.6s ease-out 0.2s both`,\n}))\n\nconst EmptyStateContainer = styled(Box)(({ theme }) => ({\n  padding: theme.spacing(8, 4),\n  textAlign: 'center',\n  display: 'flex',\n  flexDirection: 'column',\n  alignItems: 'center',\n}))\n\nconst EmptyIcon = styled(HistoryIcon)(({ theme }) => ({\n  fontSize: 64,\n  color: alpha(theme.palette.text.secondary, 0.3),\n  marginBottom: theme.spacing(2),\n  animation: `${float} 3s ease-in-out infinite`,\n}))\n\nconst PrimaryButton = styled(Button)(({ theme }) => ({\n  borderRadius: 8,  // Figma spec: 8px\n  textTransform: 'none',\n  fontWeight: 600,\n  fontSize: '0.875rem',\n  padding: theme.spacing(1, 2.5),\n  background: theme.palette.mode === 'dark' ? neutral[700] : neutral[900],\n  color: theme.palette.common.white,\n  boxShadow: `0 4px 14px ${alpha(theme.palette.common.black, 0.15)}`,\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  '&:hover': {\n    background: theme.palette.mode === 'dark' ? neutral[500] : neutral[700],\n    boxShadow: `0 6px 20px ${alpha(theme.palette.common.black, 0.2)}`,\n    transform: 'translateY(-2px)',\n  },\n}))\n\nconst SecondaryButton = styled(Button)(({ theme }) => ({\n  borderRadius: 8,  // Figma spec: 8px\n  textTransform: 'none',\n  fontWeight: 500,\n  fontSize: '0.875rem',\n  borderColor: alpha(theme.palette.divider, 0.3),\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  '&:hover': {\n    borderColor: theme.palette.mode === 'dark' ? neutral[500] : neutral[700],\n    backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.04) : neutral[50],\n  },\n}))\n\nconst KindIconContainer = styled(Box, {\n  shouldForwardProp: (prop) => prop !== 'iconColor',\n})(({ theme }) => ({\n  width: 36,\n  height: 36,\n  borderRadius: 8,  // Figma spec: 8px\n  backgroundColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[100],\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n}))\n\nconst StatusChip = styled(Chip, {\n  shouldForwardProp: (prop) => !['statusColor', 'statusBg'].includes(prop),\n})(({ theme, statusColor, statusBg }) => ({\n  borderRadius: 8,\n  fontWeight: 600,\n  fontSize: '12px',\n  backgroundColor: statusBg,\n  color: statusColor,\n  '& .MuiChip-icon': {\n    marginLeft: theme.spacing(0.5),\n    color: statusColor,\n  },\n}))\n\nconst ArtifactButton = styled(IconButton)(({ theme }) => ({\n  transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',\n  '&:hover': {\n    transform: 'translateY(-2px)',\n  },\n}))\n\n// =============================================================================\n// STATUS AND KIND CONFIG HELPERS\n// =============================================================================\n\nconst getStatusConfig = (theme, status) => {\n  const configs = {\n    completed: {\n      icon: CheckCircleIcon,\n      color: theme.palette.text.secondary,\n      bgColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.1) : neutral[100],\n      label: 'Completed',\n    },\n    failed: {\n      icon: ErrorIcon,\n      color: theme.palette.text.secondary,\n      bgColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.1) : neutral[100],\n      label: 'Failed',\n    },\n    running: {\n      icon: HourglassEmptyIcon,\n      color: theme.palette.text.secondary,\n      bgColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.1) : neutral[100],\n      label: 'Running',\n    },\n    pending: {\n      icon: HourglassEmptyIcon,\n      color: theme.palette.text.secondary,\n      bgColor: theme.palette.mode === 'dark' ? alpha(theme.palette.text.primary, 0.08) : neutral[50],\n      label: 'Pending',\n    },\n    cancelled: {\n      icon: CancelIcon,\n      color: theme.palette.text.secondary,\n      bgColor: alpha(theme.palette.text.secondary, 0.08),\n      label: 'Cancelled',\n    },\n  }\n  return configs[status] || configs.pending\n}\n\nconst getKindConfig = (theme, kind) => {\n  const configs = {\n    pdf: { icon: PictureAsPdfIcon, color: theme.palette.text.secondary },\n    excel: { icon: TableChartIcon, color: theme.palette.text.secondary },\n  }\n  return configs[kind] || configs.pdf\n}\n\n// =============================================================================\n// MAIN COMPONENT\n// =============================================================================\n\nexport default function HistoryPage() {\n  const theme = useTheme()\n  const navigate = useNavigateInteraction()\n  const [searchParams, setSearchParams] = useSearchParams()\n  const toast = useToast()\n  const { execute } = useInteraction()\n  const handleNavigate = useCallback(\n    (path, label, intent = {}) =>\n      navigate(path, { label, intent: { from: 'history', ...intent } }),\n    [navigate]\n  )\n  const executeUI = useCallback((label, action, intent = {}) => {\n    return execute({\n      type: InteractionType.EXECUTE,\n      label,\n      reversibility: Reversibility.FULLY_REVERSIBLE,\n      suppressSuccessToast: true,\n      suppressErrorToast: true,\n      intent: { from: 'history', ...intent },\n      action,\n    })\n  }, [execute])\n\n  const executeDownload = useCallback((label, action, intent = {}) => {\n    return execute({\n      type: InteractionType.DOWNLOAD,\n      label,\n      reversibility: Reversibility.FULLY_REVERSIBLE,\n      suppressSuccessToast: true,\n      suppressErrorToast: true,\n      intent: { from: 'history', ...intent },\n      action,\n    })\n  }, [execute])\n  const templates = useAppStore((s) => s.templates)\n  const didLoadRef = useRef(false)\n  const bulkDeleteUndoRef = useRef(null)\n\n  const initialStatus = searchParams.get('status') || ''\n  const initialTemplate = searchParams.get('template') || ''\n\n  const [history, setHistory] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [total, setTotal] = useState(0)\n  const [page, setPage] = useState(0)\n  const [rowsPerPage, setRowsPerPage] = useState(25)\n  const [statusFilter, setStatusFilter] = useState(initialStatus)\n  const [templateFilter, setTemplateFilter] = useState(initialTemplate)\n  const [selectedIds, setSelectedIds] = useState([])\n  const [bulkDeleteOpen, setBulkDeleteOpen] = useState(false)\n  const [bulkDeleting, setBulkDeleting] = useState(false)\n\n  const fetchHistory = useCallback(async () => {\n    setLoading(true)\n    try {\n      const data = await api.getReportHistory({\n        limit: rowsPerPage,\n        offset: page * rowsPerPage,\n        status: statusFilter || undefined,\n        templateId: templateFilter || undefined,\n      })\n      setHistory(data?.history || [])\n      setTotal(data?.total || 0)\n    } catch (err) {\n      toast.show(err.message || 'Failed to load report history', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }, [page, rowsPerPage, statusFilter, templateFilter, toast])\n\n  useEffect(() => {\n    if (didLoadRef.current) return\n    didLoadRef.current = true\n    fetchHistory()\n  }, [fetchHistory])\n\n  useEffect(() => {\n    const nextStatus = searchParams.get('status') || ''\n    const nextTemplate = searchParams.get('template') || ''\n    if (nextStatus !== statusFilter) setStatusFilter(nextStatus)\n    if (nextTemplate !== templateFilter) setTemplateFilter(nextTemplate)\n  }, [searchParams, statusFilter, templateFilter])\n\n  useEffect(() => {\n    if (!didLoadRef.current) return\n    fetchHistory()\n  }, [page, rowsPerPage, statusFilter, templateFilter, fetchHistory])\n\n  const syncParams = useCallback((nextStatus, nextTemplate) => {\n    const next = new URLSearchParams(searchParams)\n    if (nextStatus) next.set('status', nextStatus)\n    else next.delete('status')\n    if (nextTemplate) next.set('template', nextTemplate)\n    else next.delete('template')\n    setSearchParams(next, { replace: true })\n  }, [searchParams, setSearchParams])\n\n  const handleDownload = useCallback((report, format) => {\n    return executeDownload('Download report output', () => {\n      const artifacts = report.artifacts || {}\n      let url = null\n\n      if (format === 'pdf' && artifacts.pdf_url) url = artifacts.pdf_url\n      else if (format === 'html' && artifacts.html_url) url = artifacts.html_url\n      else if (format === 'docx' && artifacts.docx_url) url = artifacts.docx_url\n      else if (format === 'xlsx' && artifacts.xlsx_url) url = artifacts.xlsx_url\n\n      if (url) {\n        window.open(api.withBase(url), '_blank')\n      } else {\n        toast.show('Download not available', 'warning')\n      }\n    }, { reportId: report?.id, format })\n  }, [executeDownload, toast])\n\n  const handleDownloadClick = useCallback((event, report, format) => {\n    event.stopPropagation()\n    handleDownload(report, format)\n  }, [handleDownload])\n\n  const handleRowClick = useCallback((row) => {\n    const artifacts = row.artifacts || {}\n    if (artifacts.html_url || artifacts.pdf_url) {\n      const url = artifacts.html_url || artifacts.pdf_url\n      return executeDownload('Open report output', () => {\n        window.open(api.withBase(url), '_blank')\n      }, { reportId: row?.id, format: artifacts.html_url ? 'html' : 'pdf' })\n    }\n    return handleNavigate('/jobs', 'Open jobs', { reportId: row?.id })\n  }, [executeDownload, handleNavigate])\n\n  const handleBulkDeleteConfirm = useCallback(async () => {\n    if (!selectedIds.length) return\n    const idsToDelete = [...selectedIds]\n    const removedRecords = history.filter((record) => idsToDelete.includes(record.id))\n    const prevHistory = history\n    const prevTotal = total\n    if (!removedRecords.length) {\n      setBulkDeleteOpen(false)\n      return\n    }\n\n    setBulkDeleteOpen(false)\n    setSelectedIds([])\n\n    if (bulkDeleteUndoRef.current?.timeoutId) {\n      clearTimeout(bulkDeleteUndoRef.current.timeoutId)\n      bulkDeleteUndoRef.current = null\n    }\n\n    setHistory((prev) => prev.filter((record) => !idsToDelete.includes(record.id)))\n    setTotal((prev) => Math.max(0, prev - removedRecords.length))\n\n    let undone = false\n    const timeoutId = setTimeout(async () => {\n      if (undone) return\n      await execute({\n        type: InteractionType.DELETE,\n        label: 'Delete history records',\n        reversibility: Reversibility.SYSTEM_MANAGED,\n        suppressSuccessToast: true,\n        suppressErrorToast: true,\n        intent: {\n          jobIds: idsToDelete,\n          action: 'bulk_delete_history',\n        },\n        action: async () => {\n          setBulkDeleting(true)\n          try {\n            const result = await api.bulkDeleteJobs(idsToDelete)\n            const deletedCount = result?.deletedCount ?? result?.deleted?.length ?? 0\n            const failedCount = result?.failedCount ?? result?.failed?.length ?? 0\n            if (failedCount > 0) {\n              toast.show(\n                `Removed ${deletedCount} record${deletedCount !== 1 ? 's' : ''}, ${failedCount} failed`,\n                'warning'\n              )\n            } else {\n              toast.show(`Removed ${deletedCount} history record${deletedCount !== 1 ? 's' : ''}`, 'success')\n            }\n            fetchHistory()\n            return result\n          } catch (err) {\n            setHistory(prevHistory)\n            setTotal(prevTotal)\n            toast.show(err.message || 'Failed to delete history records', 'error')\n            throw err\n          } finally {\n            setBulkDeleting(false)\n            bulkDeleteUndoRef.current = null\n          }\n        },\n      })\n    }, 5000)\n\n    bulkDeleteUndoRef.current = { timeoutId, ids: idsToDelete, records: removedRecords }\n\n    toast.showWithUndo(\n      `Removed ${idsToDelete.length} history record${idsToDelete.length !== 1 ? 's' : ''}`,\n      () => {\n        undone = true\n        clearTimeout(timeoutId)\n        bulkDeleteUndoRef.current = null\n        setHistory(prevHistory)\n        setTotal(prevTotal)\n        toast.show('History restored', 'success')\n      },\n      { severity: 'info' }\n    )\n  }, [selectedIds, history, total, toast, fetchHistory, execute])\n\n  const handleBulkDeleteOpen = useCallback(() => {\n    if (!selectedIds.length) return undefined\n    return executeUI('Review delete history', () => setBulkDeleteOpen(true), { count: selectedIds.length })\n  }, [executeUI, selectedIds])\n\n  const handleBulkDeleteClose = useCallback(() => {\n    return executeUI('Close delete history', () => setBulkDeleteOpen(false))\n  }, [executeUI])\n\n  const handleSelectionChange = useCallback((nextSelection) => {\n    return executeUI('Select history entries', () => setSelectedIds(nextSelection), { count: nextSelection.length })\n  }, [executeUI])\n\n  const handleStatusFilterChange = useCallback((nextStatus) => {\n    return executeUI('Filter history by status', () => {\n      setStatusFilter(nextStatus)\n      setPage(0)\n      syncParams(nextStatus, templateFilter)\n    }, { status: nextStatus })\n  }, [executeUI, syncParams, templateFilter])\n\n  const handleTemplateFilterChange = useCallback((nextTemplate) => {\n    return executeUI('Filter history by template', () => {\n      setTemplateFilter(nextTemplate)\n      setPage(0)\n      syncParams(statusFilter, nextTemplate)\n    }, { templateId: nextTemplate })\n  }, [executeUI, syncParams, statusFilter])\n\n  const handleRefresh = useCallback(() => {\n    return execute({\n      type: InteractionType.EXECUTE,\n      label: 'Refresh history',\n      reversibility: Reversibility.FULLY_REVERSIBLE,\n      suppressSuccessToast: true,\n      suppressErrorToast: true,\n      intent: { from: 'history', action: 'refresh_history' },\n      action: async () => {\n        await fetchHistory()\n      },\n    })\n  }, [execute, fetchHistory])\n\n  const handlePageChange = useCallback((nextPage) => {\n    return executeUI('Change history page', () => setPage(nextPage), { page: nextPage })\n  }, [executeUI])\n\n  const handleRowsPerPageChange = useCallback((nextRows) => {\n    return executeUI('Change history page size', () => {\n      setRowsPerPage(nextRows)\n      setPage(0)\n    }, { rowsPerPage: nextRows })\n  }, [executeUI])\n\n  const bulkActions = [\n    {\n      label: 'Delete Selected',\n      icon: <DeleteIcon sx={{ fontSize: 16 }} />,\n      color: 'error',\n      onClick: handleBulkDeleteOpen,\n    },\n  ]\n\n  const columns = [\n    {\n      field: 'templateName',\n      headerName: 'Design',\n      renderCell: (value, row) => {\n        const kind = row.templateKind || 'pdf'\n        const cfg = getKindConfig(theme, kind)\n        const Icon = cfg.icon\n        return (\n          <Stack direction=\"row\" alignItems=\"center\" spacing={1.5}>\n            <KindIconContainer>\n              <Icon sx={{ fontSize: 18, color: 'text.secondary' }} />\n            </KindIconContainer>\n            <Box>\n              <Typography sx={{ fontSize: '14px', fontWeight: 500, color: 'text.primary' }}>\n                {value || 'Unknown'}\n              </Typography>\n              <Typography sx={{ fontSize: '12px', color: 'text.secondary' }}>\n                {kind.toUpperCase()}\n              </Typography>\n            </Box>\n          </Stack>\n        )\n      },\n    },\n    {\n      field: 'status',\n      headerName: 'Status',\n      width: 130,\n      renderCell: (value) => {\n        const cfg = getStatusConfig(theme, value)\n        const Icon = cfg.icon\n        return (\n          <StatusChip\n            icon={<Icon sx={{ fontSize: 14 }} />}\n            label={cfg.label}\n            size=\"small\"\n            statusColor={cfg.color}\n            statusBg={cfg.bgColor}\n          />\n        )\n      },\n    },\n    {\n      field: 'createdAt',\n      headerName: 'Started',\n      width: 160,\n      renderCell: (value) => (\n        <Typography sx={{ fontSize: '14px', color: 'text.secondary' }}>\n          {value ? new Date(value).toLocaleString() : '-'}\n        </Typography>\n      ),\n    },\n    {\n      field: 'completedAt',\n      headerName: 'Completed',\n      width: 160,\n      renderCell: (value) => (\n        <Typography sx={{ fontSize: '14px', color: 'text.secondary' }}>\n          {value ? new Date(value).toLocaleString() : '-'}\n        </Typography>\n      ),\n    },\n    {\n      field: 'artifacts',\n      headerName: 'Downloads',\n      width: 150,\n      renderCell: (value, row) => {\n        const artifacts = value || {}\n        const hasAny = artifacts.pdf_url || artifacts.html_url || artifacts.docx_url || artifacts.xlsx_url\n        if (!hasAny) {\n          return (\n            <Typography sx={{ fontSize: '0.75rem', color: 'text.disabled' }}>\n              {row.status === 'completed' ? 'No files' : '-'}\n            </Typography>\n          )\n        }\n        return (\n          <Stack direction=\"row\" spacing={0.5}>\n            {artifacts.pdf_url && (\n              <Tooltip title=\"Download PDF\">\n                <ArtifactButton\n                  size=\"small\"\n                  onClick={(e) => handleDownloadClick(e, row, 'pdf')}\n                  sx={{ color: 'text.secondary' }}\n                  aria-label=\"Download PDF\"\n                >\n                  <PictureAsPdfIcon sx={{ fontSize: 18 }} />\n                </ArtifactButton>\n              </Tooltip>\n            )}\n            {artifacts.html_url && (\n              <Tooltip title=\"View HTML\">\n                <ArtifactButton\n                  size=\"small\"\n                  onClick={(e) => handleDownloadClick(e, row, 'html')}\n                  sx={{ color: 'text.secondary' }}\n                  aria-label=\"View HTML\"\n                >\n                  <VisibilityIcon sx={{ fontSize: 18 }} />\n                </ArtifactButton>\n              </Tooltip>\n            )}\n            {artifacts.docx_url && (\n              <Tooltip title=\"Download DOCX\">\n                <ArtifactButton\n                  size=\"small\"\n                  onClick={(e) => handleDownloadClick(e, row, 'docx')}\n                  sx={{ color: 'text.secondary' }}\n                  aria-label=\"Download DOCX\"\n                >\n                  <ArticleIcon sx={{ fontSize: 18 }} />\n                </ArtifactButton>\n              </Tooltip>\n            )}\n            {artifacts.xlsx_url && (\n              <Tooltip title=\"Download XLSX\">\n                <ArtifactButton\n                  size=\"small\"\n                  onClick={(e) => handleDownloadClick(e, row, 'xlsx')}\n                  sx={{ color: 'text.secondary' }}\n                  aria-label=\"Download XLSX\"\n                >\n                  <TableChartIcon sx={{ fontSize: 18 }} />\n                </ArtifactButton>\n              </Tooltip>\n            )}\n          </Stack>\n        )\n      },\n    },\n  ]\n\n  const filters = [\n    {\n      key: 'status',\n      label: 'Status',\n      options: [\n        { value: 'completed', label: 'Completed' },\n        { value: 'failed', label: 'Failed' },\n        { value: 'running', label: 'Running' },\n        { value: 'cancelled', label: 'Cancelled' },\n      ],\n    },\n  ]\n\n  return (\n    <PageContainer>\n      {/* Header */}\n      <PageHeader>\n        <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\">\n          <Box>\n            <PageTitle>Report History</PageTitle>\n            <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 0.5 }}>\n              View and download previously generated reports\n            </Typography>\n          </Box>\n          <Stack direction=\"row\" spacing={1.5}>\n            <Tooltip title=\"Refresh history\">\n              <span>\n                <RefreshButton\n                  onClick={handleRefresh}\n                  disabled={loading}\n                  aria-label=\"Refresh history\"\n                >\n                  {loading ? <CircularProgress size={20} /> : <RefreshIcon />}\n                </RefreshButton>\n              </span>\n            </Tooltip>\n            <PrimaryButton\n              onClick={() => handleNavigate('/reports', 'Open reports')}\n              startIcon={<AddIcon />}\n            >\n              Generate New\n            </PrimaryButton>\n          </Stack>\n        </Stack>\n      </PageHeader>\n\n      <Alert severity=\"info\" sx={{ mb: 2, borderRadius: 1 }}>\n        History lists completed report outputs. Deleting a history record only removes the entry here; downloaded files\n        are not affected.\n      </Alert>\n\n      {/* Filters */}\n      <FilterContainer direction=\"row\" spacing={2}>\n        <StyledFormControl size=\"small\">\n          <InputLabel>Status</InputLabel>\n          <Select\n            value={statusFilter}\n            onChange={(e) => {\n              const nextStatus = e.target.value\n              handleStatusFilterChange(nextStatus)\n            }}\n            label=\"Status\"\n          >\n            <MenuItem value=\"\">All</MenuItem>\n            <MenuItem value=\"completed\">Completed</MenuItem>\n            <MenuItem value=\"failed\">Failed</MenuItem>\n            <MenuItem value=\"running\">Running</MenuItem>\n            <MenuItem value=\"cancelled\">Cancelled</MenuItem>\n          </Select>\n        </StyledFormControl>\n        <StyledFormControl size=\"small\" sx={{ minWidth: 200 }}>\n          <InputLabel>Design</InputLabel>\n          <Select\n            value={templateFilter}\n            onChange={(e) => {\n              const nextTemplate = e.target.value\n              handleTemplateFilterChange(nextTemplate)\n            }}\n            label=\"Design\"\n          >\n            <MenuItem value=\"\">All Designs</MenuItem>\n            {templates.map((tpl) => (\n              <MenuItem key={tpl.id} value={tpl.id}>\n                {tpl.name || tpl.id.slice(0, 12)}\n              </MenuItem>\n            ))}\n          </Select>\n        </StyledFormControl>\n      </FilterContainer>\n\n      {/* History Table */}\n      <TableContainer>\n        {loading && history.length === 0 ? (\n          <EmptyStateContainer>\n            <CircularProgress size={40} />\n            <Typography sx={{ mt: 2, fontSize: '0.875rem', color: 'text.secondary' }}>\n              Loading history...\n            </Typography>\n          </EmptyStateContainer>\n        ) : history.length === 0 ? (\n          <EmptyStateContainer>\n            <EmptyIcon />\n            <Typography sx={{ fontSize: '1rem', fontWeight: 600, color: 'text.secondary' }}>\n              No report history found\n            </Typography>\n            <Typography sx={{ fontSize: '0.875rem', color: 'text.disabled', mt: 0.5 }}>\n              Generate reports to see them here\n            </Typography>\n            <SecondaryButton\n              variant=\"outlined\"\n              onClick={() => handleNavigate('/reports', 'Open reports')}\n              sx={{ mt: 3 }}\n              startIcon={<AddIcon />}\n            >\n              Generate Report\n            </SecondaryButton>\n          </EmptyStateContainer>\n        ) : (\n          <DataTable\n            columns={columns}\n            data={history}\n            loading={loading}\n            searchPlaceholder=\"Search reports...\"\n            onRowClick={handleRowClick}\n            selectable\n            onSelectionChange={handleSelectionChange}\n            bulkActions={bulkActions}\n            pagination={{\n              page,\n              rowsPerPage,\n              total,\n              onPageChange: handlePageChange,\n              onRowsPerPageChange: handleRowsPerPageChange,\n            }}\n          />\n        )}\n      </TableContainer>\n\n      <ConfirmModal\n        open={bulkDeleteOpen}\n        onClose={handleBulkDeleteClose}\n        onConfirm={handleBulkDeleteConfirm}\n        title=\"Delete History Records\"\n        message={`Remove ${selectedIds.length} history record${selectedIds.length !== 1 ? 's' : ''}? You can undo within a few seconds. Downloaded files are not affected.`}\n        confirmLabel=\"Delete\"\n        severity=\"error\"\n        loading={bulkDeleting}\n      />\n    </PageContainer>\n  )\n}\n","import { useInteraction } from '@/components/ux/governance'\nimport HistoryPageContainer from '@/features/history/containers/HistoryPageContainer'\n\nexport default function HistoryPage() {\n  useInteraction()\n  return <HistoryPageContainer />\n}\n"],"names":["PageContainer","styled","Box","theme","PageHeader","fadeInUp","PageTitle","Typography","neutral","FilterContainer","Stack","TableContainer","alpha","EmptyStateContainer","EmptyIcon","HistoryIcon","float","PrimaryButton","Button","SecondaryButton","KindIconContainer","prop","StatusChip","Chip","statusColor","statusBg","ArtifactButton","IconButton","getStatusConfig","status","configs","CheckCircleIcon","ErrorIcon","HourglassEmptyIcon","CancelIcon","getKindConfig","kind","PictureAsPdfIcon","TableChartIcon","HistoryPage","useTheme","navigate","useNavigateInteraction","searchParams","setSearchParams","useSearchParams","toast","useToast","execute","useInteraction","handleNavigate","useCallback","path","label","intent","executeUI","action","InteractionType","Reversibility","executeDownload","templates","useAppStore","s","didLoadRef","useRef","bulkDeleteUndoRef","initialStatus","initialTemplate","history","setHistory","useState","loading","setLoading","total","setTotal","page","setPage","rowsPerPage","setRowsPerPage","statusFilter","setStatusFilter","templateFilter","setTemplateFilter","selectedIds","setSelectedIds","bulkDeleteOpen","setBulkDeleteOpen","bulkDeleting","setBulkDeleting","fetchHistory","data","api.getReportHistory","err","useEffect","nextStatus","nextTemplate","syncParams","next","handleDownload","report","format","artifacts","url","api.withBase","handleDownloadClick","event","handleRowClick","row","handleBulkDeleteConfirm","idsToDelete","removedRecords","record","prevHistory","prevTotal","prev","undone","timeoutId","result","api.bulkDeleteJobs","deletedCount","failedCount","handleBulkDeleteOpen","handleBulkDeleteClose","handleSelectionChange","nextSelection","handleStatusFilterChange","handleTemplateFilterChange","handleRefresh","handlePageChange","nextPage","handleRowsPerPageChange","nextRows","bulkActions","jsx","DeleteIcon","columns","value","Icon","cfg","jsxs","Tooltip","e","VisibilityIcon","ArticleIcon","RefreshButton","CircularProgress","RefreshIcon","AddIcon","Alert","StyledFormControl","InputLabel","Select","MenuItem","tpl","DataTable","ConfirmModal","HistoryPageContainer"],"mappings":"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"}