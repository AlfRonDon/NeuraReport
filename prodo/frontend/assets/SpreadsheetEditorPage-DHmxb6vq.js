import{g as B2,j as te,dD as y_,bJ as _n,dz as Mk,cV as W2,u as u0,r as Ae,N as ei,B as fr,n as Zr,f as yn,o as ps,T as Nh,e as Xl,q as C_,ag as $2,dw as S_,bP as IA,bQ as R_,dx as MA,aU as dm,aJ as hv,p as h0,v as G2,a as Ok,dE as j2,R as Vs,I as Us,a1 as OS,C as z2,aT as Y2,a2 as E_,G as K2,di as q2,ak as X2,aV as Q2,s as _S,ah as xS,aj as PS,al as LS,am as DS,K as Ch,a_ as Z2,M as HS,A as J2}from"./index-DeRHNZar.js";import{u as ez}from"./useSharedData-BAHlW-1G.js";import{u as tz,I as nz}from"./ImportFromMenu-BlfjbaAe.js";import{T as rz,F as b_}from"./useCrossPageActions-BCB3hlt6.js";import{C as iz}from"./ConnectionSelector-DMISq3nq.js";import{C as sz}from"./Check-D18rRUYU.js";import{R as oz}from"./Redo-DFHBhA-s.js";import{U as T_}from"./Upload-ChXFybIs.js";import{S as az}from"./Save-RFjharp-.js";import"./SummarizeRounded-qHrdYjfR.js";const lz=B2(te.jsx("path",{d:"M18 4H6v2l6.5 6L6 18v2h12v-3h-7l5-5-5-5h7z"}));var A_={},hf,N_;function Mr(){if(N_)return hf;N_=1;var n=function(e){return e&&e.Math===Math&&e};return hf=n(typeof globalThis=="object"&&globalThis)||n(typeof window=="object"&&window)||n(typeof self=="object"&&self)||n(typeof y_=="object"&&y_)||n(typeof hf=="object"&&hf)||(function(){return this})()||Function("return this")(),hf}var FS={},kS,I_;function Vr(){return I_||(I_=1,kS=function(n){try{return!!n()}catch{return!0}}),kS}var VS,M_;function So(){if(M_)return VS;M_=1;var n=Vr();return VS=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),VS}var US,O_;function pC(){if(O_)return US;O_=1;var n=Vr();return US=!n(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),US}var BS,__;function Ro(){if(__)return BS;__=1;var n=pC(),e=Function.prototype.call;return BS=n?e.bind(e):function(){return e.apply(e,arguments)},BS}var WS={},x_;function uz(){if(x_)return WS;x_=1;var n={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,t=e&&!n.call({1:2},1);return WS.f=t?function(i){var s=e(this,i);return!!s&&s.enumerable}:n,WS}var $S,P_;function wC(){return P_||(P_=1,$S=function(n,e){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:e}}),$S}var GS,L_;function sr(){if(L_)return GS;L_=1;var n=pC(),e=Function.prototype,t=e.call,r=n&&e.bind.bind(t,t);return GS=n?r:function(i){return function(){return t.apply(i,arguments)}},GS}var jS,D_;function ec(){if(D_)return jS;D_=1;var n=sr(),e=n({}.toString),t=n("".slice);return jS=function(r){return t(e(r),8,-1)},jS}var zS,H_;function hz(){if(H_)return zS;H_=1;var n=sr(),e=Vr(),t=ec(),r=Object,i=n("".split);return zS=e(function(){return!r("z").propertyIsEnumerable(0)})?function(s){return t(s)==="String"?i(s,""):r(s)}:r,zS}var YS,F_;function c0(){return F_||(F_=1,YS=function(n){return n==null}),YS}var KS,k_;function Pg(){if(k_)return KS;k_=1;var n=c0(),e=TypeError;return KS=function(t){if(n(t))throw new e("Can't call method on "+t);return t},KS}var qS,V_;function vC(){if(V_)return qS;V_=1;var n=hz(),e=Pg();return qS=function(t){return n(e(t))},qS}var XS,U_;function ti(){if(U_)return XS;U_=1;var n=typeof document=="object"&&document.all;return XS=typeof n>"u"&&n!==void 0?function(e){return typeof e=="function"||e===n}:function(e){return typeof e=="function"},XS}var QS,B_;function Ds(){if(B_)return QS;B_=1;var n=ti();return QS=function(e){return typeof e=="object"?e!==null:n(e)},QS}var ZS,W_;function Kd(){if(W_)return ZS;W_=1;var n=Mr(),e=ti(),t=function(r){return e(r)?r:void 0};return ZS=function(r,i){return arguments.length<2?t(n[r]):n[r]&&n[r][i]},ZS}var JS,$_;function yC(){if($_)return JS;$_=1;var n=sr();return JS=n({}.isPrototypeOf),JS}var eR,G_;function CC(){if(G_)return eR;G_=1;var n=Mr(),e=n.navigator,t=e&&e.userAgent;return eR=t?String(t):"",eR}var tR,j_;function cz(){if(j_)return tR;j_=1;var n=Mr(),e=CC(),t=n.process,r=n.Deno,i=t&&t.versions||r&&r.version,s=i&&i.v8,o,a;return s&&(o=s.split("."),a=o[0]>0&&o[0]<4?1:+(o[0]+o[1])),!a&&e&&(o=e.match(/Edge\/(\d+)/),(!o||o[1]>=74)&&(o=e.match(/Chrome\/(\d+)/),o&&(a=+o[1]))),tR=a,tR}var nR,z_;function d0(){if(z_)return nR;z_=1;var n=cz(),e=Vr(),t=Mr(),r=t.String;return nR=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&n&&n<41}),nR}var rR,Y_;function _k(){if(Y_)return rR;Y_=1;var n=d0();return rR=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol",rR}var iR,K_;function f0(){if(K_)return iR;K_=1;var n=Kd(),e=ti(),t=yC(),r=_k(),i=Object;return iR=r?function(s){return typeof s=="symbol"}:function(s){var o=n("Symbol");return e(o)&&t(o.prototype,i(s))},iR}var sR,q_;function SC(){if(q_)return sR;q_=1;var n=String;return sR=function(e){try{return n(e)}catch{return"Object"}},sR}var oR,X_;function Lg(){if(X_)return oR;X_=1;var n=ti(),e=SC(),t=TypeError;return oR=function(r){if(n(r))return r;throw new t(e(r)+" is not a function")},oR}var aR,Q_;function RC(){if(Q_)return aR;Q_=1;var n=Lg(),e=c0();return aR=function(t,r){var i=t[r];return e(i)?void 0:n(i)},aR}var lR,Z_;function dz(){if(Z_)return lR;Z_=1;var n=Ro(),e=ti(),t=Ds(),r=TypeError;return lR=function(i,s){var o,a;if(s==="string"&&e(o=i.toString)&&!t(a=n(o,i))||e(o=i.valueOf)&&!t(a=n(o,i))||s!=="string"&&e(o=i.toString)&&!t(a=n(o,i)))return a;throw new r("Can't convert object to primitive value")},lR}var uR={exports:{}},hR,J_;function m0(){return J_||(J_=1,hR=!1),hR}var cR,ex;function g0(){if(ex)return cR;ex=1;var n=Mr(),e=Object.defineProperty;return cR=function(t,r){try{e(n,t,{value:r,configurable:!0,writable:!0})}catch{n[t]=r}return r},cR}var tx;function p0(){if(tx)return uR.exports;tx=1;var n=m0(),e=Mr(),t=g0(),r="__core-js_shared__",i=uR.exports=e[r]||t(r,{});return(i.versions||(i.versions=[])).push({version:"3.48.0",mode:n?"pure":"global",copyright:"© 2013–2025 Denis Pushkarev (zloirock.ru), 2025–2026 CoreJS Company (core-js.io). All rights reserved.",license:"https://github.com/zloirock/core-js/blob/v3.48.0/LICENSE",source:"https://github.com/zloirock/core-js"}),uR.exports}var dR,nx;function xk(){if(nx)return dR;nx=1;var n=p0();return dR=function(e,t){return n[e]||(n[e]=t||{})},dR}var fR,rx;function Dg(){if(rx)return fR;rx=1;var n=Pg(),e=Object;return fR=function(t){return e(n(t))},fR}var mR,ix;function Eo(){if(ix)return mR;ix=1;var n=sr(),e=Dg(),t=n({}.hasOwnProperty);return mR=Object.hasOwn||function(i,s){return t(e(i),s)},mR}var gR,sx;function w0(){if(sx)return gR;sx=1;var n=sr(),e=0,t=Math.random(),r=n(1.1.toString);return gR=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+t,36)},gR}var pR,ox;function Ru(){if(ox)return pR;ox=1;var n=Mr(),e=xk(),t=Eo(),r=w0(),i=d0(),s=_k(),o=n.Symbol,a=e("wks"),l=s?o.for||o:o&&o.withoutSetter||r;return pR=function(u){return t(a,u)||(a[u]=i&&t(o,u)?o[u]:l("Symbol."+u)),a[u]},pR}var wR,ax;function fz(){if(ax)return wR;ax=1;var n=Ro(),e=Ds(),t=f0(),r=RC(),i=dz(),s=Ru(),o=TypeError,a=s("toPrimitive");return wR=function(l,u){if(!e(l)||t(l))return l;var h=r(l,a),c;if(h){if(u===void 0&&(u="default"),c=n(h,l,u),!e(c)||t(c))return c;throw new o("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},wR}var vR,lx;function Pk(){if(lx)return vR;lx=1;var n=fz(),e=f0();return vR=function(t){var r=n(t,"string");return e(r)?r:r+""},vR}var yR,ux;function v0(){if(ux)return yR;ux=1;var n=Mr(),e=Ds(),t=n.document,r=e(t)&&e(t.createElement);return yR=function(i){return r?t.createElement(i):{}},yR}var CR,hx;function Lk(){if(hx)return CR;hx=1;var n=So(),e=Vr(),t=v0();return CR=!n&&!e(function(){return Object.defineProperty(t("div"),"a",{get:function(){return 7}}).a!==7}),CR}var cx;function Dk(){if(cx)return FS;cx=1;var n=So(),e=Ro(),t=uz(),r=wC(),i=vC(),s=Pk(),o=Eo(),a=Lk(),l=Object.getOwnPropertyDescriptor;return FS.f=n?l:function(h,c){if(h=i(h),c=s(c),a)try{return l(h,c)}catch{}if(o(h,c))return r(!e(t.f,h,c),h[c])},FS}var SR={},RR,dx;function Hk(){if(dx)return RR;dx=1;var n=So(),e=Vr();return RR=n&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),RR}var ER,fx;function wl(){if(fx)return ER;fx=1;var n=Ds(),e=String,t=TypeError;return ER=function(r){if(n(r))return r;throw new t(e(r)+" is not an object")},ER}var mx;function tc(){if(mx)return SR;mx=1;var n=So(),e=Lk(),t=Hk(),r=wl(),i=Pk(),s=TypeError,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",h="writable";return SR.f=n?t?function(d,f,m){if(r(d),f=i(f),r(m),typeof d=="function"&&f==="prototype"&&"value"in m&&h in m&&!m[h]){var p=a(d,f);p&&p[h]&&(d[f]=m.value,m={configurable:u in m?m[u]:p[u],enumerable:l in m?m[l]:p[l],writable:!1})}return o(d,f,m)}:o:function(d,f,m){if(r(d),f=i(f),r(m),e)try{return o(d,f,m)}catch{}if("get"in m||"set"in m)throw new s("Accessors not supported");return"value"in m&&(d[f]=m.value),d},SR}var bR,gx;function Hg(){if(gx)return bR;gx=1;var n=So(),e=tc(),t=wC();return bR=n?function(r,i,s){return e.f(r,i,t(1,s))}:function(r,i,s){return r[i]=s,r},bR}var TR={exports:{}},AR,px;function mz(){if(px)return AR;px=1;var n=So(),e=Eo(),t=Function.prototype,r=n&&Object.getOwnPropertyDescriptor,i=e(t,"name"),s=i&&(function(){}).name==="something",o=i&&(!n||n&&r(t,"name").configurable);return AR={EXISTS:i,PROPER:s,CONFIGURABLE:o},AR}var NR,wx;function gz(){if(wx)return NR;wx=1;var n=sr(),e=ti(),t=p0(),r=n(Function.toString);return e(t.inspectSource)||(t.inspectSource=function(i){return r(i)}),NR=t.inspectSource,NR}var IR,vx;function pz(){if(vx)return IR;vx=1;var n=Mr(),e=ti(),t=n.WeakMap;return IR=e(t)&&/native code/.test(String(t)),IR}var MR,yx;function Fk(){if(yx)return MR;yx=1;var n=xk(),e=w0(),t=n("keys");return MR=function(r){return t[r]||(t[r]=e(r))},MR}var OR,Cx;function y0(){return Cx||(Cx=1,OR={}),OR}var _R,Sx;function kk(){if(Sx)return _R;Sx=1;var n=pz(),e=Mr(),t=Ds(),r=Hg(),i=Eo(),s=p0(),o=Fk(),a=y0(),l="Object already initialized",u=e.TypeError,h=e.WeakMap,c,d,f,m=function(S){return f(S)?d(S):c(S,{})},p=function(S){return function(R){var T;if(!t(R)||(T=d(R)).type!==S)throw new u("Incompatible receiver, "+S+" required");return T}};if(n||s.state){var v=s.state||(s.state=new h);v.get=v.get,v.has=v.has,v.set=v.set,c=function(S,R){if(v.has(S))throw new u(l);return R.facade=S,v.set(S,R),R},d=function(S){return v.get(S)||{}},f=function(S){return v.has(S)}}else{var y=o("state");a[y]=!0,c=function(S,R){if(i(S,y))throw new u(l);return R.facade=S,r(S,y,R),R},d=function(S){return i(S,y)?S[y]:{}},f=function(S){return i(S,y)}}return _R={set:c,get:d,has:f,enforce:m,getterFor:p},_R}var Rx;function wz(){if(Rx)return TR.exports;Rx=1;var n=sr(),e=Vr(),t=ti(),r=Eo(),i=So(),s=mz().CONFIGURABLE,o=gz(),a=kk(),l=a.enforce,u=a.get,h=String,c=Object.defineProperty,d=n("".slice),f=n("".replace),m=n([].join),p=i&&!e(function(){return c(function(){},"length",{value:8}).length!==8}),v=String(String).split("String"),y=TR.exports=function(S,R,T){d(h(R),0,7)==="Symbol("&&(R="["+f(h(R),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),T&&T.getter&&(R="get "+R),T&&T.setter&&(R="set "+R),(!r(S,"name")||s&&S.name!==R)&&(i?c(S,"name",{value:R,configurable:!0}):S.name=R),p&&T&&r(T,"arity")&&S.length!==T.arity&&c(S,"length",{value:T.arity});try{T&&r(T,"constructor")&&T.constructor?i&&c(S,"prototype",{writable:!1}):S.prototype&&(S.prototype=void 0)}catch{}var I=l(S);return r(I,"source")||(I.source=m(v,typeof R=="string"?R:"")),S};return Function.prototype.toString=y(function(){return t(this)&&u(this).source||o(this)},"toString"),TR.exports}var xR,Ex;function vz(){if(Ex)return xR;Ex=1;var n=ti(),e=tc(),t=wz(),r=g0();return xR=function(i,s,o,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:s;if(n(o)&&t(o,u,a),a.global)l?i[s]=o:r(s,o);else{try{a.unsafe?i[s]&&(l=!0):delete i[s]}catch{}l?i[s]=o:e.f(i,s,{value:o,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},xR}var PR={},LR,bx;function yz(){if(bx)return LR;bx=1;var n=Math.ceil,e=Math.floor;return LR=Math.trunc||function(r){var i=+r;return(i>0?e:n)(i)},LR}var DR,Tx;function Fg(){if(Tx)return DR;Tx=1;var n=yz();return DR=function(e){var t=+e;return t!==t||t===0?0:n(t)},DR}var HR,Ax;function Cz(){if(Ax)return HR;Ax=1;var n=Fg(),e=Math.max,t=Math.min;return HR=function(r,i){var s=n(r);return s<0?e(s+i,0):t(s,i)},HR}var FR,Nx;function Sz(){if(Nx)return FR;Nx=1;var n=Fg(),e=Math.min;return FR=function(t){var r=n(t);return r>0?e(r,9007199254740991):0},FR}var kR,Ix;function kg(){if(Ix)return kR;Ix=1;var n=Sz();return kR=function(e){return n(e.length)},kR}var VR,Mx;function Rz(){if(Mx)return VR;Mx=1;var n=vC(),e=Cz(),t=kg(),r=function(i){return function(s,o,a){var l=n(s),u=t(l);if(u===0)return!i&&-1;var h=e(a,u),c;if(i&&o!==o){for(;u>h;)if(c=l[h++],c!==c)return!0}else for(;u>h;h++)if((i||h in l)&&l[h]===o)return i||h||0;return!i&&-1}};return VR={includes:r(!0),indexOf:r(!1)},VR}var UR,Ox;function Vk(){if(Ox)return UR;Ox=1;var n=sr(),e=Eo(),t=vC(),r=Rz().indexOf,i=y0(),s=n([].push);return UR=function(o,a){var l=t(o),u=0,h=[],c;for(c in l)!e(i,c)&&e(l,c)&&s(h,c);for(;a.length>u;)e(l,c=a[u++])&&(~r(h,c)||s(h,c));return h},UR}var BR,_x;function C0(){return _x||(_x=1,BR=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),BR}var xx;function Ez(){if(xx)return PR;xx=1;var n=Vk(),e=C0(),t=e.concat("length","prototype");return PR.f=Object.getOwnPropertyNames||function(i){return n(i,t)},PR}var WR={},Px;function bz(){return Px||(Px=1,WR.f=Object.getOwnPropertySymbols),WR}var $R,Lx;function Tz(){if(Lx)return $R;Lx=1;var n=Kd(),e=sr(),t=Ez(),r=bz(),i=wl(),s=e([].concat);return $R=n("Reflect","ownKeys")||function(a){var l=t.f(i(a)),u=r.f;return u?s(l,u(a)):l},$R}var GR,Dx;function Uk(){if(Dx)return GR;Dx=1;var n=Eo(),e=Tz(),t=Dk(),r=tc();return GR=function(i,s,o){for(var a=e(s),l=r.f,u=t.f,h=0;h<a.length;h++){var c=a[h];!n(i,c)&&!(o&&n(o,c))&&l(i,c,u(s,c))}},GR}var jR,Hx;function Az(){if(Hx)return jR;Hx=1;var n=Vr(),e=ti(),t=/#|\.prototype\./,r=function(l,u){var h=s[i(l)];return h===a?!0:h===o?!1:e(u)?n(u):!!u},i=r.normalize=function(l){return String(l).replace(t,".").toLowerCase()},s=r.data={},o=r.NATIVE="N",a=r.POLYFILL="P";return jR=r,jR}var zR,Fx;function Ur(){if(Fx)return zR;Fx=1;var n=Mr(),e=Dk().f,t=Hg(),r=vz(),i=g0(),s=Uk(),o=Az();return zR=function(a,l){var u=a.target,h=a.global,c=a.stat,d,f,m,p,v,y;if(h?f=n:c?f=n[u]||i(u,{}):f=n[u]&&n[u].prototype,f)for(m in l){if(v=l[m],a.dontCallGetSet?(y=e(f,m),p=y&&y.value):p=f[m],d=o(h?m:u+(c?".":"#")+m,a.forced),!d&&p!==void 0){if(typeof v==typeof p)continue;s(v,p)}(a.sham||p&&p.sham)&&t(v,"sham",!0),r(f,m,v,a)}},zR}var YR,kx;function EC(){if(kx)return YR;kx=1;var n=pC(),e=Function.prototype,t=e.apply,r=e.call;return YR=typeof Reflect=="object"&&Reflect.apply||(n?r.bind(t):function(){return r.apply(t,arguments)}),YR}var KR,Vx;function Bk(){if(Vx)return KR;Vx=1;var n=sr(),e=Lg();return KR=function(t,r,i){try{return n(e(Object.getOwnPropertyDescriptor(t,r)[i]))}catch{}},KR}var qR,Ux;function Nz(){if(Ux)return qR;Ux=1;var n=Ds();return qR=function(e){return n(e)||e===null},qR}var XR,Bx;function Iz(){if(Bx)return XR;Bx=1;var n=Nz(),e=String,t=TypeError;return XR=function(r){if(n(r))return r;throw new t("Can't set "+e(r)+" as a prototype")},XR}var QR,Wx;function Wk(){if(Wx)return QR;Wx=1;var n=Bk(),e=Ds(),t=Pg(),r=Iz();return QR=Object.setPrototypeOf||("__proto__"in{}?(function(){var i=!1,s={},o;try{o=n(Object.prototype,"__proto__","set"),o(s,[]),i=s instanceof Array}catch{}return function(l,u){return t(l),r(u),e(l)&&(i?o(l,u):l.__proto__=u),l}})():void 0),QR}var ZR,$x;function Mz(){if($x)return ZR;$x=1;var n=tc().f;return ZR=function(e,t,r){r in e||n(e,r,{configurable:!0,get:function(){return t[r]},set:function(i){t[r]=i}})},ZR}var JR,Gx;function Oz(){if(Gx)return JR;Gx=1;var n=ti(),e=Ds(),t=Wk();return JR=function(r,i,s){var o,a;return t&&n(o=i.constructor)&&o!==s&&e(a=o.prototype)&&a!==s.prototype&&t(r,a),r},JR}var eE,jx;function _z(){if(jx)return eE;jx=1;var n=Ru(),e=n("toStringTag"),t={};return t[e]="z",eE=String(t)==="[object z]",eE}var tE,zx;function $k(){if(zx)return tE;zx=1;var n=_z(),e=ti(),t=ec(),r=Ru(),i=r("toStringTag"),s=Object,o=t((function(){return arguments})())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return tE=n?t:function(l){var u,h,c;return l===void 0?"Undefined":l===null?"Null":typeof(h=a(u=s(l),i))=="string"?h:o?t(u):(c=t(u))==="Object"&&e(u.callee)?"Arguments":c},tE}var nE,Yx;function bC(){if(Yx)return nE;Yx=1;var n=$k(),e=String;return nE=function(t){if(n(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(t)},nE}var rE,Kx;function xz(){if(Kx)return rE;Kx=1;var n=bC();return rE=function(e,t){return e===void 0?arguments.length<2?"":t:n(e)},rE}var iE,qx;function Pz(){if(qx)return iE;qx=1;var n=Ds(),e=Hg();return iE=function(t,r){n(r)&&"cause"in r&&e(t,"cause",r.cause)},iE}var sE,Xx;function Lz(){if(Xx)return sE;Xx=1;var n=sr(),e=Error,t=n("".replace),r=(function(o){return String(new e(o).stack)})("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,s=i.test(r);return sE=function(o,a){if(s&&typeof o=="string"&&!e.prepareStackTrace)for(;a--;)o=t(o,i,"");return o},sE}var oE,Qx;function Dz(){if(Qx)return oE;Qx=1;var n=Vr(),e=wC();return oE=!n(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",e(1,7)),t.stack!==7):!0}),oE}var aE,Zx;function Hz(){if(Zx)return aE;Zx=1;var n=Hg(),e=Lz(),t=Dz(),r=Error.captureStackTrace;return aE=function(i,s,o,a){t&&(r?r(i,s):n(i,"stack",e(o,a)))},aE}var lE,Jx;function Fz(){if(Jx)return lE;Jx=1;var n=Kd(),e=Eo(),t=Hg(),r=yC(),i=Wk(),s=Uk(),o=Mz(),a=Oz(),l=xz(),u=Pz(),h=Hz(),c=So(),d=m0();return lE=function(f,m,p,v){var y="stackTraceLimit",S=v?2:1,R=f.split("."),T=R[R.length-1],I=n.apply(null,R);if(I){var H=I.prototype;if(!d&&e(H,"cause")&&delete H.cause,!p)return I;var k=n("Error"),W=m(function(Y,$){var q=l(v?$:Y,void 0),J=v?new I(Y):new I;return q!==void 0&&t(J,"message",q),h(J,W,J.stack,2),this&&r(H,this)&&a(J,this,W),arguments.length>S&&u(J,arguments[S]),J});if(W.prototype=H,T!=="Error"?i?i(W,k):s(W,k,{name:!0}):c&&y in I&&(o(W,I,y),o(W,I,"prepareStackTrace")),s(W,I),!d)try{H.name!==T&&t(H,"name",T),H.constructor=W}catch{}return W}},lE}var eP;function kz(){if(eP)return A_;eP=1;var n=Ur(),e=Mr(),t=EC(),r=Fz(),i="WebAssembly",s=e[i],o=new Error("e",{cause:7}).cause!==7,a=function(u,h){var c={};c[u]=r(u,h,o),n({global:!0,constructor:!0,arity:1,forced:o},c)},l=function(u,h){if(s&&s[u]){var c={};c[u]=r(i+"."+u,h,o),n({target:i,stat:!0,constructor:!0,arity:1,forced:o},c)}};return a("Error",function(u){return function(c){return t(u,this,arguments)}}),a("EvalError",function(u){return function(c){return t(u,this,arguments)}}),a("RangeError",function(u){return function(c){return t(u,this,arguments)}}),a("ReferenceError",function(u){return function(c){return t(u,this,arguments)}}),a("SyntaxError",function(u){return function(c){return t(u,this,arguments)}}),a("TypeError",function(u){return function(c){return t(u,this,arguments)}}),a("URIError",function(u){return function(c){return t(u,this,arguments)}}),l("CompileError",function(u){return function(c){return t(u,this,arguments)}}),l("LinkError",function(u){return function(c){return t(u,this,arguments)}}),l("RuntimeError",function(u){return function(c){return t(u,this,arguments)}}),A_}kz();var tP={},uE,nP;function Gk(){if(nP)return uE;nP=1;var n=ec();return uE=Array.isArray||function(t){return n(t)==="Array"},uE}var hE,rP;function jk(){if(rP)return hE;rP=1;var n=So(),e=Gk(),t=TypeError,r=Object.getOwnPropertyDescriptor,i=n&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(s){return s instanceof TypeError}})();return hE=i?function(s,o){if(e(s)&&!r(s,"length").writable)throw new t("Cannot set read only .length");return s.length=o}:function(s,o){return s.length=o},hE}var cE,iP;function zk(){if(iP)return cE;iP=1;var n=TypeError,e=9007199254740991;return cE=function(t){if(t>e)throw n("Maximum allowed index exceeded");return t},cE}var sP;function Vz(){if(sP)return tP;sP=1;var n=Ur(),e=Dg(),t=kg(),r=jk(),i=zk(),s=Vr(),o=s(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=o||!a();return n({target:"Array",proto:!0,arity:1,forced:l},{push:function(h){var c=e(this),d=t(c),f=arguments.length;i(d+f);for(var m=0;m<f;m++)c[d]=arguments[m],d++;return r(c,d),d}}),tP}Vz();var oP={},dE,aP;function Ca(){if(aP)return dE;aP=1;var n=sr(),e=Set.prototype;return dE={Set,add:n(e.add),has:n(e.has),remove:n(e.delete),proto:e},dE}var fE,lP;function nc(){if(lP)return fE;lP=1;var n=Ca().has;return fE=function(e){return n(e),e},fE}var mE,uP;function rc(){if(uP)return mE;uP=1;var n=Ro();return mE=function(e,t,r){for(var i=r?e:e.iterator,s=e.next,o,a;!(o=n(s,i)).done;)if(a=t(o.value),a!==void 0)return a},mE}var gE,hP;function Vg(){if(hP)return gE;hP=1;var n=sr(),e=rc(),t=Ca(),r=t.Set,i=t.proto,s=n(i.forEach),o=n(i.keys),a=o(new r).next;return gE=function(l,u,h){return h?e({iterator:o(l),next:a},u):s(l,u)},gE}var pE,cP;function S0(){if(cP)return pE;cP=1;var n=Ca(),e=Vg(),t=n.Set,r=n.add;return pE=function(i){var s=new t;return e(i,function(o){r(s,o)}),s},pE}var wE,dP;function Ug(){if(dP)return wE;dP=1;var n=Bk(),e=Ca();return wE=n(e.proto,"size","get")||function(t){return t.size},wE}var vE,fP;function Uz(){return fP||(fP=1,vE=function(n){return{iterator:n,next:n.next,done:!1}}),vE}var yE,mP;function ic(){if(mP)return yE;mP=1;var n=Lg(),e=wl(),t=Ro(),r=Fg(),i=Uz(),s="Invalid size",o=RangeError,a=TypeError,l=Math.max,u=function(h,c){this.set=h,this.size=l(c,0),this.has=n(h.has),this.keys=n(h.keys)};return u.prototype={getIterator:function(){return i(e(t(this.keys,this.set)))},includes:function(h){return t(this.has,this.set,h)}},yE=function(h){e(h);var c=+h.size;if(c!==c)throw new a(s);var d=r(c);if(d<0)throw new o(s);return new u(h,d)},yE}var CE,gP;function Bz(){if(gP)return CE;gP=1;var n=nc(),e=Ca(),t=S0(),r=Ug(),i=ic(),s=Vg(),o=rc(),a=e.has,l=e.remove;return CE=function(h){var c=n(this),d=i(h),f=t(c);return r(c)<=d.size?s(c,function(m){d.includes(m)&&l(f,m)}):o(d.getIterator(),function(m){a(f,m)&&l(f,m)}),f},CE}var SE,pP;function sc(){if(pP)return SE;pP=1;var n=Kd(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},t=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return SE=function(r,i){var s=n("Set");try{new s()[r](e(0));try{return new s()[r](e(-1)),!1}catch{if(!i)return!0;try{return new s()[r](t(-1/0)),!1}catch{var o=new s([1,2]);return i(o[r](t(1/0)))}}}catch{return!1}},SE}var wP;function Wz(){if(wP)return oP;wP=1;var n=Ur(),e=Bz(),t=Vr(),r=sc(),i=!r("difference",function(o){return o.size===0}),s=i||t(function(){var o={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(o).size!==3});return n({target:"Set",proto:!0,real:!0,forced:s},{difference:e}),oP}Wz();var vP={},RE,yP;function $z(){if(yP)return RE;yP=1;var n=nc(),e=Ca(),t=Ug(),r=ic(),i=Vg(),s=rc(),o=e.Set,a=e.add,l=e.has;return RE=function(h){var c=n(this),d=r(h),f=new o;return t(c)>d.size?s(d.getIterator(),function(m){l(c,m)&&a(f,m)}):i(c,function(m){d.includes(m)&&a(f,m)}),f},RE}var CP;function Gz(){if(CP)return vP;CP=1;var n=Ur(),e=Vr(),t=$z(),r=sc(),i=!r("intersection",function(s){return s.size===2&&s.has(1)&&s.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return n({target:"Set",proto:!0,real:!0,forced:i},{intersection:t}),vP}Gz();var SP={},EE,RP;function R0(){if(RP)return EE;RP=1;var n=Ro(),e=wl(),t=RC();return EE=function(r,i,s){var o,a;e(r);try{if(o=t(r,"return"),!o){if(i==="throw")throw s;return s}o=n(o,r)}catch(l){a=!0,o=l}if(i==="throw")throw s;if(a)throw o;return e(o),s},EE}var bE,EP;function jz(){if(EP)return bE;EP=1;var n=nc(),e=Ca().has,t=Ug(),r=ic(),i=Vg(),s=rc(),o=R0();return bE=function(l){var u=n(this),h=r(l);if(t(u)<=h.size)return i(u,function(d){if(h.includes(d))return!1},!0)!==!1;var c=h.getIterator();return s(c,function(d){if(e(u,d))return o(c,"normal",!1)})!==!1},bE}var bP;function zz(){if(bP)return SP;bP=1;var n=Ur(),e=jz(),t=sc(),r=!t("isDisjointFrom",function(i){return!i});return n({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),SP}zz();var TP={},TE,AP;function Yz(){if(AP)return TE;AP=1;var n=nc(),e=Ug(),t=Vg(),r=ic();return TE=function(s){var o=n(this),a=r(s);return e(o)>a.size?!1:t(o,function(l){if(!a.includes(l))return!1},!0)!==!1},TE}var NP;function Kz(){if(NP)return TP;NP=1;var n=Ur(),e=Yz(),t=sc(),r=!t("isSubsetOf",function(i){return i});return n({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),TP}Kz();var IP={},AE,MP;function qz(){if(MP)return AE;MP=1;var n=nc(),e=Ca().has,t=Ug(),r=ic(),i=rc(),s=R0();return AE=function(a){var l=n(this),u=r(a);if(t(l)<u.size)return!1;var h=u.getIterator();return i(h,function(c){if(!e(l,c))return s(h,"normal",!1)})!==!1},AE}var OP;function Xz(){if(OP)return IP;OP=1;var n=Ur(),e=qz(),t=sc(),r=!t("isSupersetOf",function(i){return!i});return n({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),IP}Xz();var _P={},NE,xP;function Qz(){if(xP)return NE;xP=1;var n=nc(),e=Ca(),t=S0(),r=ic(),i=rc(),s=e.add,o=e.has,a=e.remove;return NE=function(u){var h=n(this),c=r(u).getIterator(),d=t(h);return i(c,function(f){o(h,f)?a(d,f):s(d,f)}),d},NE}var IE,PP;function Yk(){return PP||(PP=1,IE=function(n){try{var e=new Set,t={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[n](t);return r.size===1&&r.values().next().value===4}catch{return!1}}),IE}var LP;function Zz(){if(LP)return _P;LP=1;var n=Ur(),e=Qz(),t=Yk(),r=sc(),i=!r("symmetricDifference")||!t("symmetricDifference");return n({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),_P}Zz();var DP={},ME,HP;function Jz(){if(HP)return ME;HP=1;var n=nc(),e=Ca().add,t=S0(),r=ic(),i=rc();return ME=function(o){var a=n(this),l=r(o).getIterator(),u=t(a);return i(l,function(h){e(u,h)}),u},ME}var FP;function eY(){if(FP)return DP;FP=1;var n=Ur(),e=Jz(),t=Yk(),r=sc(),i=!r("union")||!t("union");return n({target:"Set",proto:!0,real:!0,forced:i},{union:e}),DP}eY();var kP={},VP={},OE,UP;function tY(){if(UP)return OE;UP=1;var n=ec(),e=sr();return OE=function(t){if(n(t)==="Function")return e(t)},OE}var _E,BP;function Kk(){if(BP)return _E;BP=1;var n=tY(),e=Lg(),t=pC(),r=n(n.bind);return _E=function(i,s){return e(i),s===void 0?i:t?r(i,s):function(){return i.apply(s,arguments)}},_E}var xE,WP;function qk(){if(WP)return xE;WP=1;var n=Kd();return xE=n("document","documentElement"),xE}var PE,$P;function E0(){if($P)return PE;$P=1;var n=sr();return PE=n([].slice),PE}var LE,GP;function Xk(){if(GP)return LE;GP=1;var n=TypeError;return LE=function(e,t){if(e<t)throw new n("Not enough arguments");return e},LE}var DE,jP;function nY(){if(jP)return DE;jP=1;var n=CC();return DE=/(?:ipad|iphone|ipod).*applewebkit/i.test(n),DE}var HE,zP;function Qk(){if(zP)return HE;zP=1;var n=Mr(),e=CC(),t=ec(),r=function(i){return e.slice(0,i.length)===i};return HE=(function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":n.Bun&&typeof Bun.version=="string"?"BUN":n.Deno&&typeof Deno.version=="object"?"DENO":t(n.process)==="process"?"NODE":n.window&&n.document?"BROWSER":"REST"})(),HE}var FE,YP;function rY(){if(YP)return FE;YP=1;var n=Qk();return FE=n==="NODE",FE}var kE,KP;function Zk(){if(KP)return kE;KP=1;var n=Mr(),e=EC(),t=Kk(),r=ti(),i=Eo(),s=Vr(),o=qk(),a=E0(),l=v0(),u=Xk(),h=nY(),c=rY(),d=n.setImmediate,f=n.clearImmediate,m=n.process,p=n.Dispatch,v=n.Function,y=n.MessageChannel,S=n.String,R=0,T={},I="onreadystatechange",H,k,W,Y;s(function(){H=n.location});var $=function(ie){if(i(T,ie)){var ae=T[ie];delete T[ie],ae()}},q=function(ie){return function(){$(ie)}},J=function(ie){$(ie.data)},re=function(ie){n.postMessage(S(ie),H.protocol+"//"+H.host)};return(!d||!f)&&(d=function(ae){u(arguments.length,1);var Ve=r(ae)?ae:v(ae),De=a(arguments,1);return T[++R]=function(){e(Ve,void 0,De)},k(R),R},f=function(ae){delete T[ae]},c?k=function(ie){m.nextTick(q(ie))}:p&&p.now?k=function(ie){p.now(q(ie))}:y&&!h?(W=new y,Y=W.port2,W.port1.onmessage=J,k=t(Y.postMessage,Y)):n.addEventListener&&r(n.postMessage)&&!n.importScripts&&H&&H.protocol!=="file:"&&!s(re)?(k=re,n.addEventListener("message",J,!1)):I in l("script")?k=function(ie){o.appendChild(l("script"))[I]=function(){o.removeChild(this),$(ie)}}:k=function(ie){setTimeout(q(ie),0)}),kE={set:d,clear:f},kE}var qP;function iY(){if(qP)return VP;qP=1;var n=Ur(),e=Mr(),t=Zk().clear;return n({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==t},{clearImmediate:t}),VP}var XP={},VE,QP;function sY(){if(QP)return VE;QP=1;var n=Mr(),e=EC(),t=ti(),r=Qk(),i=CC(),s=E0(),o=Xk(),a=n.Function,l=/MSIE .\./.test(i)||r==="BUN"&&(function(){var u=n.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")})();return VE=function(u,h){var c=h?2:1;return l?function(d,f){var m=o(arguments.length,1)>c,p=t(d)?d:a(d),v=m?s(arguments,c):[],y=m?function(){e(p,this,v)}:p;return h?u(y,f):u(y)}:u},VE}var ZP;function oY(){if(ZP)return XP;ZP=1;var n=Ur(),e=Mr(),t=Zk().set,r=sY(),i=e.setImmediate?r(t,!1):t;return n({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),XP}var JP;function aY(){return JP||(JP=1,iY(),oY()),kP}aY();function Ql(n){"@babel/helpers - typeof";return Ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ql(n)}function OA(n,e){return OA=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},OA(n,e)}function lY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cv(n,e,t){return lY()?cv=Reflect.construct:cv=function(i,s,o){var a=[null];a.push.apply(a,s);var l=Function.bind.apply(i,a),u=new l;return o&&OA(u,o.prototype),u},cv.apply(null,arguments)}function Qs(n){return uY(n)||hY(n)||cY(n)||dY()}function uY(n){if(Array.isArray(n))return _A(n)}function hY(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function cY(n,e){if(n){if(typeof n=="string")return _A(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _A(n,e)}}function _A(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function dY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var fY=Object.hasOwnProperty,e1=Object.setPrototypeOf,mY=Object.isFrozen,gY=Object.getPrototypeOf,pY=Object.getOwnPropertyDescriptor,fi=Object.freeze,Ms=Object.seal,wY=Object.create,Jk=typeof Reflect<"u"&&Reflect,Yv=Jk.apply,xA=Jk.construct;Yv||(Yv=function(e,t,r){return e.apply(t,r)});fi||(fi=function(e){return e});Ms||(Ms=function(e){return e});xA||(xA=function(e,t){return cv(e,Qs(t))});var vY=Os(Array.prototype.forEach),t1=Os(Array.prototype.pop),cf=Os(Array.prototype.push),dv=Os(String.prototype.toLowerCase),UE=Os(String.prototype.toString),n1=Os(String.prototype.match),Bs=Os(String.prototype.replace),yY=Os(String.prototype.indexOf),CY=Os(String.prototype.trim),Pr=Os(RegExp.prototype.test),BE=SY(TypeError);function Os(n){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return Yv(n,e,r)}}function SY(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return xA(n,t)}}function wt(n,e,t){var r;t=(r=t)!==null&&r!==void 0?r:dv,e1&&e1(n,null);for(var i=e.length;i--;){var s=e[i];if(typeof s=="string"){var o=t(s);o!==s&&(mY(e)||(e[i]=o),s=o)}n[s]=!0}return n}function _u(n){var e=wY(null),t;for(t in n)Yv(fY,n,[t])===!0&&(e[t]=n[t]);return e}function fp(n,e){for(;n!==null;){var t=pY(n,e);if(t){if(t.get)return Os(t.get);if(typeof t.value=="function")return Os(t.value)}n=gY(n)}function r(i){return console.warn("fallback value for",i),null}return r}var r1=fi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),WE=fi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$E=fi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),RY=fi(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),GE=fi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),EY=fi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),i1=fi(["#text"]),s1=fi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),jE=fi(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),o1=fi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),mp=fi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),bY=Ms(/\{\{[\w\W]*|[\w\W]*\}\}/gm),TY=Ms(/<%[\w\W]*|[\w\W]*%>/gm),AY=Ms(/\${[\w\W]*}/gm),NY=Ms(/^data-[\-\w.\u00B7-\uFFFF]+$/),IY=Ms(/^aria-[\-\w]+$/),MY=Ms(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),OY=Ms(/^(?:\w+script|data):/i),_Y=Ms(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),xY=Ms(/^html$/i),PY=Ms(/^[a-z][.\w]*(-[.\w]+)+$/i),LY=function(){return typeof window>"u"?null:window},DY=function(e,t){if(Ql(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(i)&&(r=t.currentScript.getAttribute(i));var s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function eV(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:LY(),e=function(U){return eV(U)};if(e.version="2.5.8",e.removed=[],!n||!n.document||n.document.nodeType!==9)return e.isSupported=!1,e;var t=n.document,r=n.document,i=n.DocumentFragment,s=n.HTMLTemplateElement,o=n.Node,a=n.Element,l=n.NodeFilter,u=n.NamedNodeMap,h=u===void 0?n.NamedNodeMap||n.MozNamedAttrMap:u,c=n.HTMLFormElement,d=n.DOMParser,f=n.trustedTypes,m=a.prototype,p=fp(m,"cloneNode"),v=fp(m,"nextSibling"),y=fp(m,"childNodes"),S=fp(m,"parentNode");if(typeof s=="function"){var R=r.createElement("template");R.content&&R.content.ownerDocument&&(r=R.content.ownerDocument)}var T=DY(f,t),I=T?T.createHTML(""):"",H=r,k=H.implementation,W=H.createNodeIterator,Y=H.createDocumentFragment,$=H.getElementsByTagName,q=t.importNode,J={};try{J=_u(r).documentMode?r.documentMode:{}}catch{}var re={};e.isSupported=typeof S=="function"&&k&&k.createHTMLDocument!==void 0&&J!==9;var ie=bY,ae=TY,Ve=AY,De=NY,Se=IY,pe=OY,ze=_Y,w=PY,C=MY,b=null,P=wt({},[].concat(Qs(r1),Qs(WE),Qs($E),Qs(GE),Qs(i1))),L=null,G=wt({},[].concat(Qs(s1),Qs(jE),Qs(o1),Qs(mp))),ee=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ne=null,he=null,we=!0,oe=!0,We=!1,Ke=!0,Q=!1,Qe=!0,et=!1,ht=!1,Ze=!1,ke=!1,A=!1,O=!1,x=!0,z=!1,F="user-content-",X=!0,B=!1,V={},K=null,j=wt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Z=null,me=wt({},["audio","video","img","source","image","track"]),be=null,Ue=wt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),nt="http://www.w3.org/1998/Math/MathML",Rt="http://www.w3.org/2000/svg",ut="http://www.w3.org/1999/xhtml",qe=ut,Ct=!1,pn=null,Tl=wt({},[nt,Rt,ut],UE),Bi,Al=["application/xhtml+xml","text/html"],wi="text/html",cn,jn=null,se=r.createElement("form"),Te=function(U){return U instanceof RegExp||U instanceof Function},ln=function(U){jn&&jn===U||((!U||Ql(U)!=="object")&&(U={}),U=_u(U),Bi=Al.indexOf(U.PARSER_MEDIA_TYPE)===-1?Bi=wi:Bi=U.PARSER_MEDIA_TYPE,cn=Bi==="application/xhtml+xml"?UE:dv,b="ALLOWED_TAGS"in U?wt({},U.ALLOWED_TAGS,cn):P,L="ALLOWED_ATTR"in U?wt({},U.ALLOWED_ATTR,cn):G,pn="ALLOWED_NAMESPACES"in U?wt({},U.ALLOWED_NAMESPACES,UE):Tl,be="ADD_URI_SAFE_ATTR"in U?wt(_u(Ue),U.ADD_URI_SAFE_ATTR,cn):Ue,Z="ADD_DATA_URI_TAGS"in U?wt(_u(me),U.ADD_DATA_URI_TAGS,cn):me,K="FORBID_CONTENTS"in U?wt({},U.FORBID_CONTENTS,cn):j,ne="FORBID_TAGS"in U?wt({},U.FORBID_TAGS,cn):{},he="FORBID_ATTR"in U?wt({},U.FORBID_ATTR,cn):{},V="USE_PROFILES"in U?U.USE_PROFILES:!1,we=U.ALLOW_ARIA_ATTR!==!1,oe=U.ALLOW_DATA_ATTR!==!1,We=U.ALLOW_UNKNOWN_PROTOCOLS||!1,Ke=U.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Q=U.SAFE_FOR_TEMPLATES||!1,Qe=U.SAFE_FOR_XML!==!1,et=U.WHOLE_DOCUMENT||!1,ke=U.RETURN_DOM||!1,A=U.RETURN_DOM_FRAGMENT||!1,O=U.RETURN_TRUSTED_TYPE||!1,Ze=U.FORCE_BODY||!1,x=U.SANITIZE_DOM!==!1,z=U.SANITIZE_NAMED_PROPS||!1,X=U.KEEP_CONTENT!==!1,B=U.IN_PLACE||!1,C=U.ALLOWED_URI_REGEXP||C,qe=U.NAMESPACE||ut,ee=U.CUSTOM_ELEMENT_HANDLING||{},U.CUSTOM_ELEMENT_HANDLING&&Te(U.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ee.tagNameCheck=U.CUSTOM_ELEMENT_HANDLING.tagNameCheck),U.CUSTOM_ELEMENT_HANDLING&&Te(U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ee.attributeNameCheck=U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),U.CUSTOM_ELEMENT_HANDLING&&typeof U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ee.allowCustomizedBuiltInElements=U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Q&&(oe=!1),A&&(ke=!0),V&&(b=wt({},Qs(i1)),L=[],V.html===!0&&(wt(b,r1),wt(L,s1)),V.svg===!0&&(wt(b,WE),wt(L,jE),wt(L,mp)),V.svgFilters===!0&&(wt(b,$E),wt(L,jE),wt(L,mp)),V.mathMl===!0&&(wt(b,GE),wt(L,o1),wt(L,mp))),U.ADD_TAGS&&(b===P&&(b=_u(b)),wt(b,U.ADD_TAGS,cn)),U.ADD_ATTR&&(L===G&&(L=_u(L)),wt(L,U.ADD_ATTR,cn)),U.ADD_URI_SAFE_ATTR&&wt(be,U.ADD_URI_SAFE_ATTR,cn),U.FORBID_CONTENTS&&(K===j&&(K=_u(K)),wt(K,U.FORBID_CONTENTS,cn)),X&&(b["#text"]=!0),et&&wt(b,["html","head","body"]),b.table&&(wt(b,["tbody"]),delete ne.tbody),fi&&fi(U),jn=U)},Ot=wt({},["mi","mo","mn","ms","mtext"]),kt=wt({},["annotation-xml"]),Kt=wt({},["title","style","font","a","script"]),$t=wt({},WE);wt($t,$E),wt($t,RY);var Or=wt({},GE);wt(Or,EY);var Aa=function(U){var fe=S(U);(!fe||!fe.tagName)&&(fe={namespaceURI:qe,tagName:"template"});var Ee=dv(U.tagName),Vt=dv(fe.tagName);return pn[U.namespaceURI]?U.namespaceURI===Rt?fe.namespaceURI===ut?Ee==="svg":fe.namespaceURI===nt?Ee==="svg"&&(Vt==="annotation-xml"||Ot[Vt]):!!$t[Ee]:U.namespaceURI===nt?fe.namespaceURI===ut?Ee==="math":fe.namespaceURI===Rt?Ee==="math"&&kt[Vt]:!!Or[Ee]:U.namespaceURI===ut?fe.namespaceURI===Rt&&!kt[Vt]||fe.namespaceURI===nt&&!Ot[Vt]?!1:!Or[Ee]&&(Kt[Ee]||!$t[Ee]):!!(Bi==="application/xhtml+xml"&&pn[U.namespaceURI]):!1},_r=function(U){cf(e.removed,{element:U});try{U.parentNode.removeChild(U)}catch{try{U.outerHTML=I}catch{U.remove()}}},Na=function(U,fe){try{cf(e.removed,{attribute:fe.getAttributeNode(U),from:fe})}catch{cf(e.removed,{attribute:null,from:fe})}if(fe.removeAttribute(U),U==="is"&&!L[U])if(ke||A)try{_r(fe)}catch{}else try{fe.setAttribute(U,"")}catch{}},dp=function(U){var fe,Ee;if(Ze)U="<remove></remove>"+U;else{var Vt=n1(U,/^[\r\n\t ]+/);Ee=Vt&&Vt[0]}Bi==="application/xhtml+xml"&&qe===ut&&(U='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+U+"</body></html>");var vi=T?T.createHTML(U):U;if(qe===ut)try{fe=new d().parseFromString(vi,Bi)}catch{}if(!fe||!fe.documentElement){fe=k.createDocument(qe,"template",null);try{fe.documentElement.innerHTML=Ct?I:vi}catch{}}var Wr=fe.body||fe.documentElement;return U&&Ee&&Wr.insertBefore(r.createTextNode(Ee),Wr.childNodes[0]||null),qe===ut?$.call(fe,et?"html":"body")[0]:et?fe.documentElement:Wr},f_=function(U){return W.call(U.ownerDocument||U,U,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null,!1)},IS=function(U){return U instanceof c&&(typeof U.nodeName!="string"||typeof U.textContent!="string"||typeof U.removeChild!="function"||!(U.attributes instanceof h)||typeof U.removeAttribute!="function"||typeof U.setAttribute!="function"||typeof U.namespaceURI!="string"||typeof U.insertBefore!="function"||typeof U.hasChildNodes!="function")},uf=function(U){return Ql(o)==="object"?U instanceof o:U&&Ql(U)==="object"&&typeof U.nodeType=="number"&&typeof U.nodeName=="string"},Ia=function(U,fe,Ee){re[U]&&vY(re[U],function(Vt){Vt.call(e,fe,Ee,jn)})},m_=function(U){var fe;if(Ia("beforeSanitizeElements",U,null),IS(U)||Pr(/[\u0080-\uFFFF]/,U.nodeName))return _r(U),!0;var Ee=cn(U.nodeName);if(Ia("uponSanitizeElement",U,{tagName:Ee,allowedTags:b}),U.hasChildNodes()&&!uf(U.firstElementChild)&&(!uf(U.content)||!uf(U.content.firstElementChild))&&Pr(/<[/\w]/g,U.innerHTML)&&Pr(/<[/\w]/g,U.textContent)||Ee==="select"&&Pr(/<template/i,U.innerHTML)||U.nodeType===7||Qe&&U.nodeType===8&&Pr(/<[/\w]/g,U.data))return _r(U),!0;if(!b[Ee]||ne[Ee]){if(!ne[Ee]&&p_(Ee)&&(ee.tagNameCheck instanceof RegExp&&Pr(ee.tagNameCheck,Ee)||ee.tagNameCheck instanceof Function&&ee.tagNameCheck(Ee)))return!1;if(X&&!K[Ee]){var Vt=S(U)||U.parentNode,vi=y(U)||U.childNodes;if(vi&&Vt)for(var Wr=vi.length,xr=Wr-1;xr>=0;--xr){var Ou=p(vi[xr],!0);Ou.__removalCount=(U.__removalCount||0)+1,Vt.insertBefore(Ou,v(U))}}return _r(U),!0}return U instanceof a&&!Aa(U)||(Ee==="noscript"||Ee==="noembed"||Ee==="noframes")&&Pr(/<\/no(script|embed|frames)/i,U.innerHTML)?(_r(U),!0):(Q&&U.nodeType===3&&(fe=U.textContent,fe=Bs(fe,ie," "),fe=Bs(fe,ae," "),fe=Bs(fe,Ve," "),U.textContent!==fe&&(cf(e.removed,{element:U.cloneNode()}),U.textContent=fe)),Ia("afterSanitizeElements",U,null),!1)},g_=function(U,fe,Ee){if(x&&(fe==="id"||fe==="name")&&(Ee in r||Ee in se))return!1;if(!(oe&&!he[fe]&&Pr(De,fe))){if(!(we&&Pr(Se,fe))){if(!L[fe]||he[fe]){if(!(p_(U)&&(ee.tagNameCheck instanceof RegExp&&Pr(ee.tagNameCheck,U)||ee.tagNameCheck instanceof Function&&ee.tagNameCheck(U))&&(ee.attributeNameCheck instanceof RegExp&&Pr(ee.attributeNameCheck,fe)||ee.attributeNameCheck instanceof Function&&ee.attributeNameCheck(fe))||fe==="is"&&ee.allowCustomizedBuiltInElements&&(ee.tagNameCheck instanceof RegExp&&Pr(ee.tagNameCheck,Ee)||ee.tagNameCheck instanceof Function&&ee.tagNameCheck(Ee))))return!1}else if(!be[fe]){if(!Pr(C,Bs(Ee,ze,""))){if(!((fe==="src"||fe==="xlink:href"||fe==="href")&&U!=="script"&&yY(Ee,"data:")===0&&Z[U])){if(!(We&&!Pr(pe,Bs(Ee,ze,"")))){if(Ee)return!1}}}}}}return!0},p_=function(U){return U!=="annotation-xml"&&n1(U,w)},w_=function(U){var fe,Ee,Vt,vi;Ia("beforeSanitizeAttributes",U,null);var Wr=U.attributes;if(!(!Wr||IS(U))){var xr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:L};for(vi=Wr.length;vi--;){fe=Wr[vi];var Ou=fe,ar=Ou.name,MS=Ou.namespaceURI;if(Ee=ar==="value"?fe.value:CY(fe.value),Vt=cn(ar),xr.attrName=Vt,xr.attrValue=Ee,xr.keepAttr=!0,xr.forceKeepAttr=void 0,Ia("uponSanitizeAttribute",U,xr),Ee=xr.attrValue,!xr.forceKeepAttr&&(Na(ar,U),!!xr.keepAttr)){if(!Ke&&Pr(/\/>/i,Ee)){Na(ar,U);continue}Q&&(Ee=Bs(Ee,ie," "),Ee=Bs(Ee,ae," "),Ee=Bs(Ee,Ve," "));var v_=cn(U.nodeName);if(g_(v_,Vt,Ee)){if(z&&(Vt==="id"||Vt==="name")&&(Na(ar,U),Ee=F+Ee),Qe&&Pr(/((--!?|])>)|<\/(style|title)/i,Ee)){Na(ar,U);continue}if(T&&Ql(f)==="object"&&typeof f.getAttributeType=="function"&&!MS)switch(f.getAttributeType(v_,Vt)){case"TrustedHTML":{Ee=T.createHTML(Ee);break}case"TrustedScriptURL":{Ee=T.createScriptURL(Ee);break}}try{MS?U.setAttributeNS(MS,ar,Ee):U.setAttribute(ar,Ee),IS(U)?_r(U):t1(e.removed)}catch{}}}}Ia("afterSanitizeAttributes",U,null)}},U2=function $e(U){var fe,Ee=f_(U);for(Ia("beforeSanitizeShadowDOM",U,null);fe=Ee.nextNode();)Ia("uponSanitizeShadowNode",fe,null),m_(fe),w_(fe),fe.content instanceof i&&$e(fe.content);Ia("afterSanitizeShadowDOM",U,null)};return e.sanitize=function($e){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},fe,Ee,Vt,vi,Wr;if(Ct=!$e,Ct&&($e="<!-->"),typeof $e!="string"&&!uf($e))if(typeof $e.toString=="function"){if($e=$e.toString(),typeof $e!="string")throw BE("dirty is not a string, aborting")}else throw BE("toString is not a function");if(!e.isSupported){if(Ql(n.toStaticHTML)==="object"||typeof n.toStaticHTML=="function"){if(typeof $e=="string")return n.toStaticHTML($e);if(uf($e))return n.toStaticHTML($e.outerHTML)}return $e}if(ht||ln(U),e.removed=[],typeof $e=="string"&&(B=!1),B){if($e.nodeName){var xr=cn($e.nodeName);if(!b[xr]||ne[xr])throw BE("root node is forbidden and cannot be sanitized in-place")}}else if($e instanceof o)fe=dp("<!---->"),Ee=fe.ownerDocument.importNode($e,!0),Ee.nodeType===1&&Ee.nodeName==="BODY"||Ee.nodeName==="HTML"?fe=Ee:fe.appendChild(Ee);else{if(!ke&&!Q&&!et&&$e.indexOf("<")===-1)return T&&O?T.createHTML($e):$e;if(fe=dp($e),!fe)return ke?null:O?I:""}fe&&Ze&&_r(fe.firstChild);for(var Ou=f_(B?$e:fe);Vt=Ou.nextNode();)Vt.nodeType===3&&Vt===vi||(m_(Vt),w_(Vt),Vt.content instanceof i&&U2(Vt.content),vi=Vt);if(vi=null,B)return $e;if(ke){if(A)for(Wr=Y.call(fe.ownerDocument);fe.firstChild;)Wr.appendChild(fe.firstChild);else Wr=fe;return(L.shadowroot||L.shadowrootmod)&&(Wr=q.call(t,Wr,!0)),Wr}var ar=et?fe.outerHTML:fe.innerHTML;return et&&b["!doctype"]&&fe.ownerDocument&&fe.ownerDocument.doctype&&fe.ownerDocument.doctype.name&&Pr(xY,fe.ownerDocument.doctype.name)&&(ar="<!DOCTYPE "+fe.ownerDocument.doctype.name+`>
`+ar),Q&&(ar=Bs(ar,ie," "),ar=Bs(ar,ae," "),ar=Bs(ar,Ve," ")),T&&O?T.createHTML(ar):ar},e.setConfig=function($e){ln($e),ht=!0},e.clearConfig=function(){jn=null,ht=!1},e.isValidAttribute=function($e,U,fe){jn||ln({});var Ee=cn($e),Vt=cn(U);return g_(Ee,Vt,fe)},e.addHook=function($e,U){typeof U=="function"&&(re[$e]=re[$e]||[],cf(re[$e],U))},e.removeHook=function($e){if(re[$e])return t1(re[$e])},e.removeHooks=function($e){re[$e]&&(re[$e]=[])},e.removeAllHooks=function(){re={}},e}var HY=eV();var tV;function le(){return tV.apply(null,arguments)}function FY(n){tV=n}function wo(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function Fh(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function Ht(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function b0(n){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(n).length===0;var e;for(e in n)if(Ht(n,e))return!1;return!0}function Ai(n){return n===void 0}function dl(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function Bg(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function nV(n,e){var t=[],r,i=n.length;for(r=0;r<i;++r)t.push(e(n[r],r));return t}function nu(n,e){for(var t in e)Ht(e,t)&&(n[t]=e[t]);return Ht(e,"toString")&&(n.toString=e.toString),Ht(e,"valueOf")&&(n.valueOf=e.valueOf),n}function Sa(n,e,t,r){return TV(n,e,t,r,!0).utc()}function kY(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ct(n){return n._pf==null&&(n._pf=kY()),n._pf}var PA;Array.prototype.some?PA=Array.prototype.some:PA=function(n){var e=Object(this),t=e.length>>>0,r;for(r=0;r<t;r++)if(r in e&&n.call(this,e[r],r,e))return!0;return!1};function T0(n){var e=null,t=!1,r=n._d&&!isNaN(n._d.getTime());if(r&&(e=ct(n),t=PA.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t),n._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(n))n._isValid=r;else return r;return n._isValid}function TC(n){var e=Sa(NaN);return n!=null?nu(ct(e),n):ct(e).userInvalidated=!0,e}var a1=le.momentProperties=[],zE=!1;function A0(n,e){var t,r,i,s=a1.length;if(Ai(e._isAMomentObject)||(n._isAMomentObject=e._isAMomentObject),Ai(e._i)||(n._i=e._i),Ai(e._f)||(n._f=e._f),Ai(e._l)||(n._l=e._l),Ai(e._strict)||(n._strict=e._strict),Ai(e._tzm)||(n._tzm=e._tzm),Ai(e._isUTC)||(n._isUTC=e._isUTC),Ai(e._offset)||(n._offset=e._offset),Ai(e._pf)||(n._pf=ct(e)),Ai(e._locale)||(n._locale=e._locale),s>0)for(t=0;t<s;t++)r=a1[t],i=e[r],Ai(i)||(n[r]=i);return n}function Wg(n){A0(this,n),this._d=new Date(n._d!=null?n._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),zE===!1&&(zE=!0,le.updateOffset(this),zE=!1)}function vo(n){return n instanceof Wg||n!=null&&n._isAMomentObject!=null}function rV(n){le.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+n)}function Hs(n,e){var t=!0;return nu(function(){if(le.deprecationHandler!=null&&le.deprecationHandler(null,n),t){var r=[],i,s,o,a=arguments.length;for(s=0;s<a;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(o in arguments[0])Ht(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[s];r.push(i)}rV(n+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var l1={};function iV(n,e){le.deprecationHandler!=null&&le.deprecationHandler(n,e),l1[n]||(rV(e),l1[n]=!0)}le.suppressDeprecationWarnings=!1;le.deprecationHandler=null;function Ra(n){return typeof Function<"u"&&n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function VY(n){var e,t;for(t in n)Ht(n,t)&&(e=n[t],Ra(e)?this[t]=e:this["_"+t]=e);this._config=n,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function LA(n,e){var t=nu({},n),r;for(r in e)Ht(e,r)&&(Fh(n[r])&&Fh(e[r])?(t[r]={},nu(t[r],n[r]),nu(t[r],e[r])):e[r]!=null?t[r]=e[r]:delete t[r]);for(r in n)Ht(n,r)&&!Ht(e,r)&&Fh(n[r])&&(t[r]=nu({},t[r]));return t}function N0(n){n!=null&&this.set(n)}var DA;Object.keys?DA=Object.keys:DA=function(n){var e,t=[];for(e in n)Ht(n,e)&&t.push(e);return t};var UY={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function BY(n,e,t){var r=this._calendar[n]||this._calendar.sameElse;return Ra(r)?r.call(e,t):r}function ga(n,e,t){var r=""+Math.abs(n),i=e-r.length,s=n>=0;return(s?t?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var I0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,gp=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,YE={},Rd={};function Ye(n,e,t,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),n&&(Rd[n]=i),e&&(Rd[e[0]]=function(){return ga(i.apply(this,arguments),e[1],e[2])}),t&&(Rd[t]=function(){return this.localeData().ordinal(i.apply(this,arguments),n)})}function WY(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function $Y(n){var e=n.match(I0),t,r;for(t=0,r=e.length;t<r;t++)Rd[e[t]]?e[t]=Rd[e[t]]:e[t]=WY(e[t]);return function(i){var s="",o;for(o=0;o<r;o++)s+=Ra(e[o])?e[o].call(i,n):e[o];return s}}function fv(n,e){return n.isValid()?(e=sV(e,n.localeData()),YE[e]=YE[e]||$Y(e),YE[e](n)):n.localeData().invalidDate()}function sV(n,e){var t=5;function r(i){return e.longDateFormat(i)||i}for(gp.lastIndex=0;t>=0&&gp.test(n);)n=n.replace(gp,r),gp.lastIndex=0,t-=1;return n}var GY={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function jY(n){var e=this._longDateFormat[n],t=this._longDateFormat[n.toUpperCase()];return e||!t?e:(this._longDateFormat[n]=t.match(I0).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[n])}var zY="Invalid date";function YY(){return this._invalidDate}var KY="%d",qY=/\d{1,2}/;function XY(n){return this._ordinal.replace("%d",n)}var QY={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function ZY(n,e,t,r){var i=this._relativeTime[t];return Ra(i)?i(n,e,t,r):i.replace(/%d/i,n)}function JY(n,e){var t=this._relativeTime[n>0?"future":"past"];return Ra(t)?t(e):t.replace(/%s/i,e)}var u1={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Fs(n){return typeof n=="string"?u1[n]||u1[n.toLowerCase()]:void 0}function M0(n){var e={},t,r;for(r in n)Ht(n,r)&&(t=Fs(r),t&&(e[t]=n[r]));return e}var eK={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function tK(n){var e=[],t;for(t in n)Ht(n,t)&&e.push({unit:t,priority:eK[t]});return e.sort(function(r,i){return r.priority-i.priority}),e}var oV=/\d/,ss=/\d\d/,aV=/\d{3}/,O0=/\d{4}/,AC=/[+-]?\d{6}/,Sn=/\d\d?/,lV=/\d\d\d\d?/,uV=/\d\d\d\d\d\d?/,NC=/\d{1,3}/,_0=/\d{1,4}/,IC=/[+-]?\d{1,6}/,qd=/\d+/,MC=/[+-]?\d+/,nK=/Z|[+-]\d\d:?\d\d/gi,OC=/Z|[+-]\d\d(?::?\d\d)?/gi,rK=/[+-]?\d+(\.\d{1,3})?/,$g=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Xd=/^[1-9]\d?/,x0=/^([1-9]\d|\d)/,Kv;Kv={};function xe(n,e,t){Kv[n]=Ra(e)?e:function(r,i){return r&&t?t:e}}function iK(n,e){return Ht(Kv,n)?Kv[n](e._strict,e._locale):new RegExp(sK(n))}function sK(n){return ll(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,r,i,s){return t||r||i||s}))}function ll(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Es(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function Nt(n){var e=+n,t=0;return e!==0&&isFinite(e)&&(t=Es(e)),t}var HA={};function an(n,e){var t,r=e,i;for(typeof n=="string"&&(n=[n]),dl(e)&&(r=function(s,o){o[e]=Nt(s)}),i=n.length,t=0;t<i;t++)HA[n[t]]=r}function Gg(n,e){an(n,function(t,r,i,s){i._w=i._w||{},e(t,i._w,i,s)})}function oK(n,e,t){e!=null&&Ht(HA,n)&&HA[n](e,t._a,t,n)}function _C(n){return n%4===0&&n%100!==0||n%400===0}var Jr=0,tl=1,sa=2,mr=3,ho=4,nl=5,Ih=6,aK=7,lK=8;Ye("Y",0,0,function(){var n=this.year();return n<=9999?ga(n,4):"+"+n});Ye(0,["YY",2],0,function(){return this.year()%100});Ye(0,["YYYY",4],0,"year");Ye(0,["YYYYY",5],0,"year");Ye(0,["YYYYYY",6,!0],0,"year");xe("Y",MC);xe("YY",Sn,ss);xe("YYYY",_0,O0);xe("YYYYY",IC,AC);xe("YYYYYY",IC,AC);an(["YYYYY","YYYYYY"],Jr);an("YYYY",function(n,e){e[Jr]=n.length===2?le.parseTwoDigitYear(n):Nt(n)});an("YY",function(n,e){e[Jr]=le.parseTwoDigitYear(n)});an("Y",function(n,e){e[Jr]=parseInt(n,10)});function Em(n){return _C(n)?366:365}le.parseTwoDigitYear=function(n){return Nt(n)+(Nt(n)>68?1900:2e3)};var hV=Qd("FullYear",!0);function uK(){return _C(this.year())}function Qd(n,e){return function(t){return t!=null?(cV(this,n,t),le.updateOffset(this,e),this):ng(this,n)}}function ng(n,e){if(!n.isValid())return NaN;var t=n._d,r=n._isUTC;switch(e){case"Milliseconds":return r?t.getUTCMilliseconds():t.getMilliseconds();case"Seconds":return r?t.getUTCSeconds():t.getSeconds();case"Minutes":return r?t.getUTCMinutes():t.getMinutes();case"Hours":return r?t.getUTCHours():t.getHours();case"Date":return r?t.getUTCDate():t.getDate();case"Day":return r?t.getUTCDay():t.getDay();case"Month":return r?t.getUTCMonth():t.getMonth();case"FullYear":return r?t.getUTCFullYear():t.getFullYear();default:return NaN}}function cV(n,e,t){var r,i,s,o,a;if(!(!n.isValid()||isNaN(t))){switch(r=n._d,i=n._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(t):r.setMilliseconds(t));case"Seconds":return void(i?r.setUTCSeconds(t):r.setSeconds(t));case"Minutes":return void(i?r.setUTCMinutes(t):r.setMinutes(t));case"Hours":return void(i?r.setUTCHours(t):r.setHours(t));case"Date":return void(i?r.setUTCDate(t):r.setDate(t));case"FullYear":break;default:return}s=t,o=n.month(),a=n.date(),a=a===29&&o===1&&!_C(s)?28:a,i?r.setUTCFullYear(s,o,a):r.setFullYear(s,o,a)}}function hK(n){return n=Fs(n),Ra(this[n])?this[n]():this}function cK(n,e){if(typeof n=="object"){n=M0(n);var t=tK(n),r,i=t.length;for(r=0;r<i;r++)this[t[r].unit](n[t[r].unit])}else if(n=Fs(n),Ra(this[n]))return this[n](e);return this}function dK(n,e){return(n%e+e)%e}var qn;Array.prototype.indexOf?qn=Array.prototype.indexOf:qn=function(n){var e;for(e=0;e<this.length;++e)if(this[e]===n)return e;return-1};function P0(n,e){if(isNaN(n)||isNaN(e))return NaN;var t=dK(e,12);return n+=(e-t)/12,t===1?_C(n)?29:28:31-t%7%2}Ye("M",["MM",2],"Mo",function(){return this.month()+1});Ye("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});Ye("MMMM",0,0,function(n){return this.localeData().months(this,n)});xe("M",Sn,Xd);xe("MM",Sn,ss);xe("MMM",function(n,e){return e.monthsShortRegex(n)});xe("MMMM",function(n,e){return e.monthsRegex(n)});an(["M","MM"],function(n,e){e[tl]=Nt(n)-1});an(["MMM","MMMM"],function(n,e,t,r){var i=t._locale.monthsParse(n,r,t._strict);i!=null?e[tl]=i:ct(t).invalidMonth=n});var fK="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),dV="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),fV=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,mK=$g,gK=$g;function pK(n,e){return n?wo(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||fV).test(e)?"format":"standalone"][n.month()]:wo(this._months)?this._months:this._months.standalone}function wK(n,e){return n?wo(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[fV.test(e)?"format":"standalone"][n.month()]:wo(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function vK(n,e,t){var r,i,s,o=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)s=Sa([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(s,"").toLocaleLowerCase();return t?e==="MMM"?(i=qn.call(this._shortMonthsParse,o),i!==-1?i:null):(i=qn.call(this._longMonthsParse,o),i!==-1?i:null):e==="MMM"?(i=qn.call(this._shortMonthsParse,o),i!==-1?i:(i=qn.call(this._longMonthsParse,o),i!==-1?i:null)):(i=qn.call(this._longMonthsParse,o),i!==-1?i:(i=qn.call(this._shortMonthsParse,o),i!==-1?i:null))}function yK(n,e,t){var r,i,s;if(this._monthsParseExact)return vK.call(this,n,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Sa([2e3,r]),t&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!t&&!this._monthsParse[r]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(s.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[r].test(n))return r;if(t&&e==="MMM"&&this._shortMonthsParse[r].test(n))return r;if(!t&&this._monthsParse[r].test(n))return r}}function mV(n,e){if(!n.isValid())return n;if(typeof e=="string"){if(/^\d+$/.test(e))e=Nt(e);else if(e=n.localeData().monthsParse(e),!dl(e))return n}var t=e,r=n.date();return r=r<29?r:Math.min(r,P0(n.year(),t)),n._isUTC?n._d.setUTCMonth(t,r):n._d.setMonth(t,r),n}function gV(n){return n!=null?(mV(this,n),le.updateOffset(this,!0),this):ng(this,"Month")}function CK(){return P0(this.year(),this.month())}function SK(n){return this._monthsParseExact?(Ht(this,"_monthsRegex")||pV.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(Ht(this,"_monthsShortRegex")||(this._monthsShortRegex=mK),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function RK(n){return this._monthsParseExact?(Ht(this,"_monthsRegex")||pV.call(this),n?this._monthsStrictRegex:this._monthsRegex):(Ht(this,"_monthsRegex")||(this._monthsRegex=gK),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function pV(){function n(l,u){return u.length-l.length}var e=[],t=[],r=[],i,s,o,a;for(i=0;i<12;i++)s=Sa([2e3,i]),o=ll(this.monthsShort(s,"")),a=ll(this.months(s,"")),e.push(o),t.push(a),r.push(a),r.push(o);e.sort(n),t.sort(n),r.sort(n),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function EK(n,e,t,r,i,s,o){var a;return n<100&&n>=0?(a=new Date(n+400,e,t,r,i,s,o),isFinite(a.getFullYear())&&a.setFullYear(n)):a=new Date(n,e,t,r,i,s,o),a}function rg(n){var e,t;return n<100&&n>=0?(t=Array.prototype.slice.call(arguments),t[0]=n+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(n)):e=new Date(Date.UTC.apply(null,arguments)),e}function qv(n,e,t){var r=7+e-t,i=(7+rg(n,0,r).getUTCDay()-e)%7;return-i+r-1}function wV(n,e,t,r,i){var s=(7+t-r)%7,o=qv(n,r,i),a=1+7*(e-1)+s+o,l,u;return a<=0?(l=n-1,u=Em(l)+a):a>Em(n)?(l=n+1,u=a-Em(n)):(l=n,u=a),{year:l,dayOfYear:u}}function ig(n,e,t){var r=qv(n.year(),e,t),i=Math.floor((n.dayOfYear()-r-1)/7)+1,s,o;return i<1?(o=n.year()-1,s=i+ul(o,e,t)):i>ul(n.year(),e,t)?(s=i-ul(n.year(),e,t),o=n.year()+1):(o=n.year(),s=i),{week:s,year:o}}function ul(n,e,t){var r=qv(n,e,t),i=qv(n+1,e,t);return(Em(n)-r+i)/7}Ye("w",["ww",2],"wo","week");Ye("W",["WW",2],"Wo","isoWeek");xe("w",Sn,Xd);xe("ww",Sn,ss);xe("W",Sn,Xd);xe("WW",Sn,ss);Gg(["w","ww","W","WW"],function(n,e,t,r){e[r.substr(0,1)]=Nt(n)});function bK(n){return ig(n,this._week.dow,this._week.doy).week}var TK={dow:0,doy:6};function AK(){return this._week.dow}function NK(){return this._week.doy}function IK(n){var e=this.localeData().week(this);return n==null?e:this.add((n-e)*7,"d")}function MK(n){var e=ig(this,1,4).week;return n==null?e:this.add((n-e)*7,"d")}Ye("d",0,"do","day");Ye("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)});Ye("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)});Ye("dddd",0,0,function(n){return this.localeData().weekdays(this,n)});Ye("e",0,0,"weekday");Ye("E",0,0,"isoWeekday");xe("d",Sn);xe("e",Sn);xe("E",Sn);xe("dd",function(n,e){return e.weekdaysMinRegex(n)});xe("ddd",function(n,e){return e.weekdaysShortRegex(n)});xe("dddd",function(n,e){return e.weekdaysRegex(n)});Gg(["dd","ddd","dddd"],function(n,e,t,r){var i=t._locale.weekdaysParse(n,r,t._strict);i!=null?e.d=i:ct(t).invalidWeekday=n});Gg(["d","e","E"],function(n,e,t,r){e[r]=Nt(n)});function OK(n,e){return typeof n!="string"?n:isNaN(n)?(n=e.weekdaysParse(n),typeof n=="number"?n:null):parseInt(n,10)}function _K(n,e){return typeof n=="string"?e.weekdaysParse(n)%7||7:isNaN(n)?null:n}function L0(n,e){return n.slice(e,7).concat(n.slice(0,e))}var xK="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),vV="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),PK="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),LK=$g,DK=$g,HK=$g;function FK(n,e){var t=wo(this._weekdays)?this._weekdays:this._weekdays[n&&n!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return n===!0?L0(t,this._week.dow):n?t[n.day()]:t}function kK(n){return n===!0?L0(this._weekdaysShort,this._week.dow):n?this._weekdaysShort[n.day()]:this._weekdaysShort}function VK(n){return n===!0?L0(this._weekdaysMin,this._week.dow):n?this._weekdaysMin[n.day()]:this._weekdaysMin}function UK(n,e,t){var r,i,s,o=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)s=Sa([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(s,"").toLocaleLowerCase();return t?e==="dddd"?(i=qn.call(this._weekdaysParse,o),i!==-1?i:null):e==="ddd"?(i=qn.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=qn.call(this._minWeekdaysParse,o),i!==-1?i:null):e==="dddd"?(i=qn.call(this._weekdaysParse,o),i!==-1||(i=qn.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=qn.call(this._minWeekdaysParse,o),i!==-1?i:null)):e==="ddd"?(i=qn.call(this._shortWeekdaysParse,o),i!==-1||(i=qn.call(this._weekdaysParse,o),i!==-1)?i:(i=qn.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=qn.call(this._minWeekdaysParse,o),i!==-1||(i=qn.call(this._weekdaysParse,o),i!==-1)?i:(i=qn.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function BK(n,e,t){var r,i,s;if(this._weekdaysParseExact)return UK.call(this,n,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Sa([2e3,1]).day(r),t&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(s.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[r].test(n))return r;if(t&&e==="ddd"&&this._shortWeekdaysParse[r].test(n))return r;if(t&&e==="dd"&&this._minWeekdaysParse[r].test(n))return r;if(!t&&this._weekdaysParse[r].test(n))return r}}function WK(n){if(!this.isValid())return n!=null?this:NaN;var e=ng(this,"Day");return n!=null?(n=OK(n,this.localeData()),this.add(n-e,"d")):e}function $K(n){if(!this.isValid())return n!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return n==null?e:this.add(n-e,"d")}function GK(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var e=_K(n,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function jK(n){return this._weekdaysParseExact?(Ht(this,"_weekdaysRegex")||D0.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(Ht(this,"_weekdaysRegex")||(this._weekdaysRegex=LK),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function zK(n){return this._weekdaysParseExact?(Ht(this,"_weekdaysRegex")||D0.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ht(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=DK),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function YK(n){return this._weekdaysParseExact?(Ht(this,"_weekdaysRegex")||D0.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ht(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=HK),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function D0(){function n(h,c){return c.length-h.length}var e=[],t=[],r=[],i=[],s,o,a,l,u;for(s=0;s<7;s++)o=Sa([2e3,1]).day(s),a=ll(this.weekdaysMin(o,"")),l=ll(this.weekdaysShort(o,"")),u=ll(this.weekdays(o,"")),e.push(a),t.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(n),t.sort(n),r.sort(n),i.sort(n),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function H0(){return this.hours()%12||12}function KK(){return this.hours()||24}Ye("H",["HH",2],0,"hour");Ye("h",["hh",2],0,H0);Ye("k",["kk",2],0,KK);Ye("hmm",0,0,function(){return""+H0.apply(this)+ga(this.minutes(),2)});Ye("hmmss",0,0,function(){return""+H0.apply(this)+ga(this.minutes(),2)+ga(this.seconds(),2)});Ye("Hmm",0,0,function(){return""+this.hours()+ga(this.minutes(),2)});Ye("Hmmss",0,0,function(){return""+this.hours()+ga(this.minutes(),2)+ga(this.seconds(),2)});function yV(n,e){Ye(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}yV("a",!0);yV("A",!1);function CV(n,e){return e._meridiemParse}xe("a",CV);xe("A",CV);xe("H",Sn,x0);xe("h",Sn,Xd);xe("k",Sn,Xd);xe("HH",Sn,ss);xe("hh",Sn,ss);xe("kk",Sn,ss);xe("hmm",lV);xe("hmmss",uV);xe("Hmm",lV);xe("Hmmss",uV);an(["H","HH"],mr);an(["k","kk"],function(n,e,t){var r=Nt(n);e[mr]=r===24?0:r});an(["a","A"],function(n,e,t){t._isPm=t._locale.isPM(n),t._meridiem=n});an(["h","hh"],function(n,e,t){e[mr]=Nt(n),ct(t).bigHour=!0});an("hmm",function(n,e,t){var r=n.length-2;e[mr]=Nt(n.substr(0,r)),e[ho]=Nt(n.substr(r)),ct(t).bigHour=!0});an("hmmss",function(n,e,t){var r=n.length-4,i=n.length-2;e[mr]=Nt(n.substr(0,r)),e[ho]=Nt(n.substr(r,2)),e[nl]=Nt(n.substr(i)),ct(t).bigHour=!0});an("Hmm",function(n,e,t){var r=n.length-2;e[mr]=Nt(n.substr(0,r)),e[ho]=Nt(n.substr(r))});an("Hmmss",function(n,e,t){var r=n.length-4,i=n.length-2;e[mr]=Nt(n.substr(0,r)),e[ho]=Nt(n.substr(r,2)),e[nl]=Nt(n.substr(i))});function qK(n){return(n+"").toLowerCase().charAt(0)==="p"}var XK=/[ap]\.?m?\.?/i,QK=Qd("Hours",!0);function ZK(n,e,t){return n>11?t?"pm":"PM":t?"am":"AM"}var SV={calendar:UY,longDateFormat:GY,invalidDate:zY,ordinal:KY,dayOfMonthOrdinalParse:qY,relativeTime:QY,months:fK,monthsShort:dV,week:TK,weekdays:xK,weekdaysMin:PK,weekdaysShort:vV,meridiemParse:XK},bn={},df={},sg;function JK(n,e){var t,r=Math.min(n.length,e.length);for(t=0;t<r;t+=1)if(n[t]!==e[t])return t;return r}function h1(n){return n&&n.toLowerCase().replace("_","-")}function e3(n){for(var e=0,t,r,i,s;e<n.length;){for(s=h1(n[e]).split("-"),t=s.length,r=h1(n[e+1]),r=r?r.split("-"):null;t>0;){if(i=xC(s.slice(0,t).join("-")),i)return i;if(r&&r.length>=t&&JK(s,r)>=t-1)break;t--}e++}return sg}function t3(n){return!!(n&&n.match("^[^/\\\\]*$"))}function xC(n){var e=null,t;if(bn[n]===void 0&&typeof module<"u"&&module&&module.exports&&t3(n))try{e=sg._abbr,t=require,t("./locale/"+n),cu(e)}catch{bn[n]=null}return bn[n]}function cu(n,e){var t;return n&&(Ai(e)?t=vl(n):t=F0(n,e),t?sg=t:typeof console<"u"&&console.warn&&console.warn("Locale "+n+" not found. Did you forget to load it?")),sg._abbr}function F0(n,e){if(e!==null){var t,r=SV;if(e.abbr=n,bn[n]!=null)iV("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=bn[n]._config;else if(e.parentLocale!=null)if(bn[e.parentLocale]!=null)r=bn[e.parentLocale]._config;else if(t=xC(e.parentLocale),t!=null)r=t._config;else return df[e.parentLocale]||(df[e.parentLocale]=[]),df[e.parentLocale].push({name:n,config:e}),null;return bn[n]=new N0(LA(r,e)),df[n]&&df[n].forEach(function(i){F0(i.name,i.config)}),cu(n),bn[n]}else return delete bn[n],null}function n3(n,e){if(e!=null){var t,r,i=SV;bn[n]!=null&&bn[n].parentLocale!=null?bn[n].set(LA(bn[n]._config,e)):(r=xC(n),r!=null&&(i=r._config),e=LA(i,e),r==null&&(e.abbr=n),t=new N0(e),t.parentLocale=bn[n],bn[n]=t),cu(n)}else bn[n]!=null&&(bn[n].parentLocale!=null?(bn[n]=bn[n].parentLocale,n===cu()&&cu(n)):bn[n]!=null&&delete bn[n]);return bn[n]}function vl(n){var e;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return sg;if(!wo(n)){if(e=xC(n),e)return e;n=[n]}return e3(n)}function r3(){return DA(bn)}function k0(n){var e,t=n._a;return t&&ct(n).overflow===-2&&(e=t[tl]<0||t[tl]>11?tl:t[sa]<1||t[sa]>P0(t[Jr],t[tl])?sa:t[mr]<0||t[mr]>24||t[mr]===24&&(t[ho]!==0||t[nl]!==0||t[Ih]!==0)?mr:t[ho]<0||t[ho]>59?ho:t[nl]<0||t[nl]>59?nl:t[Ih]<0||t[Ih]>999?Ih:-1,ct(n)._overflowDayOfYear&&(e<Jr||e>sa)&&(e=sa),ct(n)._overflowWeeks&&e===-1&&(e=aK),ct(n)._overflowWeekday&&e===-1&&(e=lK),ct(n).overflow=e),n}var i3=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,s3=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,o3=/Z|[+-]\d\d(?::?\d\d)?/,pp=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],KE=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],a3=/^\/?Date\((-?\d+)/i,l3=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,u3={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function RV(n){var e,t,r=n._i,i=i3.exec(r)||s3.exec(r),s,o,a,l,u=pp.length,h=KE.length;if(i){for(ct(n).iso=!0,e=0,t=u;e<t;e++)if(pp[e][1].exec(i[1])){o=pp[e][0],s=pp[e][2]!==!1;break}if(o==null){n._isValid=!1;return}if(i[3]){for(e=0,t=h;e<t;e++)if(KE[e][1].exec(i[3])){a=(i[2]||" ")+KE[e][0];break}if(a==null){n._isValid=!1;return}}if(!s&&a!=null){n._isValid=!1;return}if(i[4])if(o3.exec(i[4]))l="Z";else{n._isValid=!1;return}n._f=o+(a||"")+(l||""),U0(n)}else n._isValid=!1}function h3(n,e,t,r,i,s){var o=[c3(n),dV.indexOf(e),parseInt(t,10),parseInt(r,10),parseInt(i,10)];return s&&o.push(parseInt(s,10)),o}function c3(n){var e=parseInt(n,10);return e<=49?2e3+e:e<=999?1900+e:e}function d3(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function f3(n,e,t){if(n){var r=vV.indexOf(n),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return ct(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function m3(n,e,t){if(n)return u3[n];if(e)return 0;var r=parseInt(t,10),i=r%100,s=(r-i)/100;return s*60+i}function EV(n){var e=l3.exec(d3(n._i)),t;if(e){if(t=h3(e[4],e[3],e[2],e[5],e[6],e[7]),!f3(e[1],t,n))return;n._a=t,n._tzm=m3(e[8],e[9],e[10]),n._d=rg.apply(null,n._a),n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),ct(n).rfc2822=!0}else n._isValid=!1}function g3(n){var e=a3.exec(n._i);if(e!==null){n._d=new Date(+e[1]);return}if(RV(n),n._isValid===!1)delete n._isValid;else return;if(EV(n),n._isValid===!1)delete n._isValid;else return;n._strict?n._isValid=!1:le.createFromInputFallback(n)}le.createFromInputFallback=Hs("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))});function ed(n,e,t){return n??e??t}function p3(n){var e=new Date(le.now());return n._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function V0(n){var e,t,r=[],i,s,o;if(!n._d){for(i=p3(n),n._w&&n._a[sa]==null&&n._a[tl]==null&&w3(n),n._dayOfYear!=null&&(o=ed(n._a[Jr],i[Jr]),(n._dayOfYear>Em(o)||n._dayOfYear===0)&&(ct(n)._overflowDayOfYear=!0),t=rg(o,0,n._dayOfYear),n._a[tl]=t.getUTCMonth(),n._a[sa]=t.getUTCDate()),e=0;e<3&&n._a[e]==null;++e)n._a[e]=r[e]=i[e];for(;e<7;e++)n._a[e]=r[e]=n._a[e]==null?e===2?1:0:n._a[e];n._a[mr]===24&&n._a[ho]===0&&n._a[nl]===0&&n._a[Ih]===0&&(n._nextDay=!0,n._a[mr]=0),n._d=(n._useUTC?rg:EK).apply(null,r),s=n._useUTC?n._d.getUTCDay():n._d.getDay(),n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),n._nextDay&&(n._a[mr]=24),n._w&&typeof n._w.d<"u"&&n._w.d!==s&&(ct(n).weekdayMismatch=!0)}}function w3(n){var e,t,r,i,s,o,a,l,u;e=n._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,t=ed(e.GG,n._a[Jr],ig(Cn(),1,4).year),r=ed(e.W,1),i=ed(e.E,1),(i<1||i>7)&&(l=!0)):(s=n._locale._week.dow,o=n._locale._week.doy,u=ig(Cn(),s,o),t=ed(e.gg,n._a[Jr],u.year),r=ed(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(l=!0)):i=s),r<1||r>ul(t,s,o)?ct(n)._overflowWeeks=!0:l!=null?ct(n)._overflowWeekday=!0:(a=wV(t,r,i,s,o),n._a[Jr]=a.year,n._dayOfYear=a.dayOfYear)}le.ISO_8601=function(){};le.RFC_2822=function(){};function U0(n){if(n._f===le.ISO_8601){RV(n);return}if(n._f===le.RFC_2822){EV(n);return}n._a=[],ct(n).empty=!0;var e=""+n._i,t,r,i,s,o,a=e.length,l=0,u,h;for(i=sV(n._f,n._locale).match(I0)||[],h=i.length,t=0;t<h;t++)s=i[t],r=(e.match(iK(s,n))||[])[0],r&&(o=e.substr(0,e.indexOf(r)),o.length>0&&ct(n).unusedInput.push(o),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Rd[s]?(r?ct(n).empty=!1:ct(n).unusedTokens.push(s),oK(s,r,n)):n._strict&&!r&&ct(n).unusedTokens.push(s);ct(n).charsLeftOver=a-l,e.length>0&&ct(n).unusedInput.push(e),n._a[mr]<=12&&ct(n).bigHour===!0&&n._a[mr]>0&&(ct(n).bigHour=void 0),ct(n).parsedDateParts=n._a.slice(0),ct(n).meridiem=n._meridiem,n._a[mr]=v3(n._locale,n._a[mr],n._meridiem),u=ct(n).era,u!==null&&(n._a[Jr]=n._locale.erasConvertYear(u,n._a[Jr])),V0(n),k0(n)}function v3(n,e,t){var r;return t==null?e:n.meridiemHour!=null?n.meridiemHour(e,t):(n.isPM!=null&&(r=n.isPM(t),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function y3(n){var e,t,r,i,s,o,a=!1,l=n._f.length;if(l===0){ct(n).invalidFormat=!0,n._d=new Date(NaN);return}for(i=0;i<l;i++)s=0,o=!1,e=A0({},n),n._useUTC!=null&&(e._useUTC=n._useUTC),e._f=n._f[i],U0(e),T0(e)&&(o=!0),s+=ct(e).charsLeftOver,s+=ct(e).unusedTokens.length*10,ct(e).score=s,a?s<r&&(r=s,t=e):(r==null||s<r||o)&&(r=s,t=e,o&&(a=!0));nu(n,t||e)}function C3(n){if(!n._d){var e=M0(n._i),t=e.day===void 0?e.date:e.day;n._a=nV([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),V0(n)}}function S3(n){var e=new Wg(k0(bV(n)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function bV(n){var e=n._i,t=n._f;return n._locale=n._locale||vl(n._l),e===null||t===void 0&&e===""?TC({nullInput:!0}):(typeof e=="string"&&(n._i=e=n._locale.preparse(e)),vo(e)?new Wg(k0(e)):(Bg(e)?n._d=e:wo(t)?y3(n):t?U0(n):R3(n),T0(n)||(n._d=null),n))}function R3(n){var e=n._i;Ai(e)?n._d=new Date(le.now()):Bg(e)?n._d=new Date(e.valueOf()):typeof e=="string"?g3(n):wo(e)?(n._a=nV(e.slice(0),function(t){return parseInt(t,10)}),V0(n)):Fh(e)?C3(n):dl(e)?n._d=new Date(e):le.createFromInputFallback(n)}function TV(n,e,t,r,i){var s={};return(e===!0||e===!1)&&(r=e,e=void 0),(t===!0||t===!1)&&(r=t,t=void 0),(Fh(n)&&b0(n)||wo(n)&&n.length===0)&&(n=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=t,s._i=n,s._f=e,s._strict=r,S3(s)}function Cn(n,e,t,r){return TV(n,e,t,r,!1)}var E3=Hs("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=Cn.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:TC()}),b3=Hs("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=Cn.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:TC()});function AV(n,e){var t,r;if(e.length===1&&wo(e[0])&&(e=e[0]),!e.length)return Cn();for(t=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][n](t))&&(t=e[r]);return t}function T3(){var n=[].slice.call(arguments,0);return AV("isBefore",n)}function A3(){var n=[].slice.call(arguments,0);return AV("isAfter",n)}var N3=function(){return Date.now?Date.now():+new Date},ff=["year","quarter","month","week","day","hour","minute","second","millisecond"];function I3(n){var e,t=!1,r,i=ff.length;for(e in n)if(Ht(n,e)&&!(qn.call(ff,e)!==-1&&(n[e]==null||!isNaN(n[e]))))return!1;for(r=0;r<i;++r)if(n[ff[r]]){if(t)return!1;parseFloat(n[ff[r]])!==Nt(n[ff[r]])&&(t=!0)}return!0}function M3(){return this._isValid}function O3(){return bo(NaN)}function PC(n){var e=M0(n),t=e.year||0,r=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,h=e.millisecond||0;this._isValid=I3(e),this._milliseconds=+h+u*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+i+r*3+t*12,this._data={},this._locale=vl(),this._bubble()}function mv(n){return n instanceof PC}function FA(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function _3(n,e,t){var r=Math.min(n.length,e.length),i=Math.abs(n.length-e.length),s=0,o;for(o=0;o<r;o++)Nt(n[o])!==Nt(e[o])&&s++;return s+i}function NV(n,e){Ye(n,0,0,function(){var t=this.utcOffset(),r="+";return t<0&&(t=-t,r="-"),r+ga(~~(t/60),2)+e+ga(~~t%60,2)})}NV("Z",":");NV("ZZ","");xe("Z",OC);xe("ZZ",OC);an(["Z","ZZ"],function(n,e,t){t._useUTC=!0,t._tzm=B0(OC,n)});var x3=/([\+\-]|\d\d)/gi;function B0(n,e){var t=(e||"").match(n),r,i,s;return t===null?null:(r=t[t.length-1]||[],i=(r+"").match(x3)||["-",0,0],s=+(i[1]*60)+Nt(i[2]),s===0?0:i[0]==="+"?s:-s)}function W0(n,e){var t,r;return e._isUTC?(t=e.clone(),r=(vo(n)||Bg(n)?n.valueOf():Cn(n).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+r),le.updateOffset(t,!1),t):Cn(n).local()}function kA(n){return-Math.round(n._d.getTimezoneOffset())}le.updateOffset=function(){};function P3(n,e,t){var r=this._offset||0,i;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=B0(OC,n),n===null)return this}else Math.abs(n)<16&&!t&&(n=n*60);return!this._isUTC&&e&&(i=kA(this)),this._offset=n,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==n&&(!e||this._changeInProgress?OV(this,bo(n-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,le.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:kA(this)}function L3(n,e){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,e),this):-this.utcOffset()}function D3(n){return this.utcOffset(0,n)}function H3(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(kA(this),"m")),this}function F3(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var n=B0(nK,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function k3(n){return this.isValid()?(n=n?Cn(n).utcOffset():0,(this.utcOffset()-n)%60===0):!1}function V3(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function U3(){if(!Ai(this._isDSTShifted))return this._isDSTShifted;var n={},e;return A0(n,this),n=bV(n),n._a?(e=n._isUTC?Sa(n._a):Cn(n._a),this._isDSTShifted=this.isValid()&&_3(n._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function B3(){return this.isValid()?!this._isUTC:!1}function W3(){return this.isValid()?this._isUTC:!1}function IV(){return this.isValid()?this._isUTC&&this._offset===0:!1}var $3=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,G3=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function bo(n,e){var t=n,r=null,i,s,o;return mv(n)?t={ms:n._milliseconds,d:n._days,M:n._months}:dl(n)||!isNaN(+n)?(t={},e?t[e]=+n:t.milliseconds=+n):(r=$3.exec(n))?(i=r[1]==="-"?-1:1,t={y:0,d:Nt(r[sa])*i,h:Nt(r[mr])*i,m:Nt(r[ho])*i,s:Nt(r[nl])*i,ms:Nt(FA(r[Ih]*1e3))*i}):(r=G3.exec(n))?(i=r[1]==="-"?-1:1,t={y:xu(r[2],i),M:xu(r[3],i),w:xu(r[4],i),d:xu(r[5],i),h:xu(r[6],i),m:xu(r[7],i),s:xu(r[8],i)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(o=j3(Cn(t.from),Cn(t.to)),t={},t.ms=o.milliseconds,t.M=o.months),s=new PC(t),mv(n)&&Ht(n,"_locale")&&(s._locale=n._locale),mv(n)&&Ht(n,"_isValid")&&(s._isValid=n._isValid),s}bo.fn=PC.prototype;bo.invalid=O3;function xu(n,e){var t=n&&parseFloat(n.replace(",","."));return(isNaN(t)?0:t)*e}function c1(n,e){var t={};return t.months=e.month()-n.month()+(e.year()-n.year())*12,n.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+n.clone().add(t.months,"M"),t}function j3(n,e){var t;return n.isValid()&&e.isValid()?(e=W0(e,n),n.isBefore(e)?t=c1(n,e):(t=c1(e,n),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function MV(n,e){return function(t,r){var i,s;return r!==null&&!isNaN(+r)&&(iV(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=t,t=r,r=s),i=bo(t,r),OV(this,i,n),this}}function OV(n,e,t,r){var i=e._milliseconds,s=FA(e._days),o=FA(e._months);n.isValid()&&(r=r??!0,o&&mV(n,ng(n,"Month")+o*t),s&&cV(n,"Date",ng(n,"Date")+s*t),i&&n._d.setTime(n._d.valueOf()+i*t),r&&le.updateOffset(n,s||o))}var z3=MV(1,"add"),Y3=MV(-1,"subtract");function _V(n){return typeof n=="string"||n instanceof String}function K3(n){return vo(n)||Bg(n)||_V(n)||dl(n)||X3(n)||q3(n)||n===null||n===void 0}function q3(n){var e=Fh(n)&&!b0(n),t=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,o=r.length;for(i=0;i<o;i+=1)s=r[i],t=t||Ht(n,s);return e&&t}function X3(n){var e=wo(n),t=!1;return e&&(t=n.filter(function(r){return!dl(r)&&_V(n)}).length===0),e&&t}function Q3(n){var e=Fh(n)&&!b0(n),t=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<r.length;i+=1)s=r[i],t=t||Ht(n,s);return e&&t}function Z3(n,e){var t=n.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function J3(n,e){arguments.length===1&&(arguments[0]?K3(arguments[0])?(n=arguments[0],e=void 0):Q3(arguments[0])&&(e=arguments[0],n=void 0):(n=void 0,e=void 0));var t=n||Cn(),r=W0(t,this).startOf("day"),i=le.calendarFormat(this,r)||"sameElse",s=e&&(Ra(e[i])?e[i].call(this,t):e[i]);return this.format(s||this.localeData().calendar(i,this,Cn(t)))}function eq(){return new Wg(this)}function tq(n,e){var t=vo(n)?n:Cn(n);return this.isValid()&&t.isValid()?(e=Fs(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function nq(n,e){var t=vo(n)?n:Cn(n);return this.isValid()&&t.isValid()?(e=Fs(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function rq(n,e,t,r){var i=vo(n)?n:Cn(n),s=vo(e)?e:Cn(e);return this.isValid()&&i.isValid()&&s.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,t):!this.isBefore(i,t))&&(r[1]===")"?this.isBefore(s,t):!this.isAfter(s,t))):!1}function iq(n,e){var t=vo(n)?n:Cn(n),r;return this.isValid()&&t.isValid()?(e=Fs(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(r=t.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function sq(n,e){return this.isSame(n,e)||this.isAfter(n,e)}function oq(n,e){return this.isSame(n,e)||this.isBefore(n,e)}function aq(n,e,t){var r,i,s;if(!this.isValid())return NaN;if(r=W0(n,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Fs(e),e){case"year":s=gv(this,r)/12;break;case"month":s=gv(this,r);break;case"quarter":s=gv(this,r)/3;break;case"second":s=(this-r)/1e3;break;case"minute":s=(this-r)/6e4;break;case"hour":s=(this-r)/36e5;break;case"day":s=(this-r-i)/864e5;break;case"week":s=(this-r-i)/6048e5;break;default:s=this-r}return t?s:Es(s)}function gv(n,e){if(n.date()<e.date())return-gv(e,n);var t=(e.year()-n.year())*12+(e.month()-n.month()),r=n.clone().add(t,"months"),i,s;return e-r<0?(i=n.clone().add(t-1,"months"),s=(e-r)/(r-i)):(i=n.clone().add(t+1,"months"),s=(e-r)/(i-r)),-(t+s)||0}le.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";le.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function lq(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function uq(n){if(!this.isValid())return null;var e=n!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?fv(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ra(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",fv(t,"Z")):fv(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function hq(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var n="moment",e="",t,r,i,s;return this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+n+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(t+r+i+s)}function cq(n){n||(n=this.isUtc()?le.defaultFormatUtc:le.defaultFormat);var e=fv(this,n);return this.localeData().postformat(e)}function dq(n,e){return this.isValid()&&(vo(n)&&n.isValid()||Cn(n).isValid())?bo({to:this,from:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function fq(n){return this.from(Cn(),n)}function mq(n,e){return this.isValid()&&(vo(n)&&n.isValid()||Cn(n).isValid())?bo({from:this,to:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function gq(n){return this.to(Cn(),n)}function xV(n){var e;return n===void 0?this._locale._abbr:(e=vl(n),e!=null&&(this._locale=e),this)}var PV=Hs("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===void 0?this.localeData():this.locale(n)});function LV(){return this._locale}var Xv=1e3,Ed=60*Xv,Qv=60*Ed,DV=(365*400+97)*24*Qv;function bd(n,e){return(n%e+e)%e}function HV(n,e,t){return n<100&&n>=0?new Date(n+400,e,t)-DV:new Date(n,e,t).valueOf()}function FV(n,e,t){return n<100&&n>=0?Date.UTC(n+400,e,t)-DV:Date.UTC(n,e,t)}function pq(n){var e,t;if(n=Fs(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?FV:HV,n){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=bd(e+(this._isUTC?0:this.utcOffset()*Ed),Qv);break;case"minute":e=this._d.valueOf(),e-=bd(e,Ed);break;case"second":e=this._d.valueOf(),e-=bd(e,Xv);break}return this._d.setTime(e),le.updateOffset(this,!0),this}function wq(n){var e,t;if(n=Fs(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?FV:HV,n){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Qv-bd(e+(this._isUTC?0:this.utcOffset()*Ed),Qv)-1;break;case"minute":e=this._d.valueOf(),e+=Ed-bd(e,Ed)-1;break;case"second":e=this._d.valueOf(),e+=Xv-bd(e,Xv)-1;break}return this._d.setTime(e),le.updateOffset(this,!0),this}function vq(){return this._d.valueOf()-(this._offset||0)*6e4}function yq(){return Math.floor(this.valueOf()/1e3)}function Cq(){return new Date(this.valueOf())}function Sq(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function Rq(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function Eq(){return this.isValid()?this.toISOString():null}function bq(){return T0(this)}function Tq(){return nu({},ct(this))}function Aq(){return ct(this).overflow}function Nq(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ye("N",0,0,"eraAbbr");Ye("NN",0,0,"eraAbbr");Ye("NNN",0,0,"eraAbbr");Ye("NNNN",0,0,"eraName");Ye("NNNNN",0,0,"eraNarrow");Ye("y",["y",1],"yo","eraYear");Ye("y",["yy",2],0,"eraYear");Ye("y",["yyy",3],0,"eraYear");Ye("y",["yyyy",4],0,"eraYear");xe("N",$0);xe("NN",$0);xe("NNN",$0);xe("NNNN",kq);xe("NNNNN",Vq);an(["N","NN","NNN","NNNN","NNNNN"],function(n,e,t,r){var i=t._locale.erasParse(n,r,t._strict);i?ct(t).era=i:ct(t).invalidEra=n});xe("y",qd);xe("yy",qd);xe("yyy",qd);xe("yyyy",qd);xe("yo",Uq);an(["y","yy","yyy","yyyy"],Jr);an(["yo"],function(n,e,t,r){var i;t._locale._eraYearOrdinalRegex&&(i=n.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[Jr]=t._locale.eraYearOrdinalParse(n,i):e[Jr]=parseInt(n,10)});function Iq(n,e){var t,r,i,s=this._eras||vl("en")._eras;for(t=0,r=s.length;t<r;++t)switch(typeof s[t].since==="string"&&(i=le(s[t].since).startOf("day"),s[t].since=i.valueOf()),typeof s[t].until){case"undefined":s[t].until=1/0;break;case"string":i=le(s[t].until).startOf("day").valueOf(),s[t].until=i.valueOf();break}return s}function Mq(n,e,t){var r,i,s=this.eras(),o,a,l;for(n=n.toUpperCase(),r=0,i=s.length;r<i;++r)if(o=s[r].name.toUpperCase(),a=s[r].abbr.toUpperCase(),l=s[r].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(a===n)return s[r];break;case"NNNN":if(o===n)return s[r];break;case"NNNNN":if(l===n)return s[r];break}else if([o,a,l].indexOf(n)>=0)return s[r]}function Oq(n,e){var t=n.since<=n.until?1:-1;return e===void 0?le(n.since).year():le(n.since).year()+(e-n.offset)*t}function _q(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].name;return""}function xq(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].narrow;return""}function Pq(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].abbr;return""}function Lq(){var n,e,t,r,i=this.localeData().eras();for(n=0,e=i.length;n<e;++n)if(t=i[n].since<=i[n].until?1:-1,r=this.clone().startOf("day").valueOf(),i[n].since<=r&&r<=i[n].until||i[n].until<=r&&r<=i[n].since)return(this.year()-le(i[n].since).year())*t+i[n].offset;return this.year()}function Dq(n){return Ht(this,"_erasNameRegex")||G0.call(this),n?this._erasNameRegex:this._erasRegex}function Hq(n){return Ht(this,"_erasAbbrRegex")||G0.call(this),n?this._erasAbbrRegex:this._erasRegex}function Fq(n){return Ht(this,"_erasNarrowRegex")||G0.call(this),n?this._erasNarrowRegex:this._erasRegex}function $0(n,e){return e.erasAbbrRegex(n)}function kq(n,e){return e.erasNameRegex(n)}function Vq(n,e){return e.erasNarrowRegex(n)}function Uq(n,e){return e._eraYearOrdinalRegex||qd}function G0(){var n=[],e=[],t=[],r=[],i,s,o,a,l,u=this.eras();for(i=0,s=u.length;i<s;++i)o=ll(u[i].name),a=ll(u[i].abbr),l=ll(u[i].narrow),e.push(o),n.push(a),t.push(l),r.push(o),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}Ye(0,["gg",2],0,function(){return this.weekYear()%100});Ye(0,["GG",2],0,function(){return this.isoWeekYear()%100});function LC(n,e){Ye(0,[n,n.length],0,e)}LC("gggg","weekYear");LC("ggggg","weekYear");LC("GGGG","isoWeekYear");LC("GGGGG","isoWeekYear");xe("G",MC);xe("g",MC);xe("GG",Sn,ss);xe("gg",Sn,ss);xe("GGGG",_0,O0);xe("gggg",_0,O0);xe("GGGGG",IC,AC);xe("ggggg",IC,AC);Gg(["gggg","ggggg","GGGG","GGGGG"],function(n,e,t,r){e[r.substr(0,2)]=Nt(n)});Gg(["gg","GG"],function(n,e,t,r){e[r]=le.parseTwoDigitYear(n)});function Bq(n){return kV.call(this,n,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Wq(n){return kV.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function $q(){return ul(this.year(),1,4)}function Gq(){return ul(this.isoWeekYear(),1,4)}function jq(){var n=this.localeData()._week;return ul(this.year(),n.dow,n.doy)}function zq(){var n=this.localeData()._week;return ul(this.weekYear(),n.dow,n.doy)}function kV(n,e,t,r,i){var s;return n==null?ig(this,r,i).year:(s=ul(n,r,i),e>s&&(e=s),Yq.call(this,n,e,t,r,i))}function Yq(n,e,t,r,i){var s=wV(n,e,t,r,i),o=rg(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Ye("Q",0,"Qo","quarter");xe("Q",oV);an("Q",function(n,e){e[tl]=(Nt(n)-1)*3});function Kq(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}Ye("D",["DD",2],"Do","date");xe("D",Sn,Xd);xe("DD",Sn,ss);xe("Do",function(n,e){return n?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});an(["D","DD"],sa);an("Do",function(n,e){e[sa]=Nt(n.match(Sn)[0])});var VV=Qd("Date",!0);Ye("DDD",["DDDD",3],"DDDo","dayOfYear");xe("DDD",NC);xe("DDDD",aV);an(["DDD","DDDD"],function(n,e,t){t._dayOfYear=Nt(n)});function qq(n){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?e:this.add(n-e,"d")}Ye("m",["mm",2],0,"minute");xe("m",Sn,x0);xe("mm",Sn,ss);an(["m","mm"],ho);var Xq=Qd("Minutes",!1);Ye("s",["ss",2],0,"second");xe("s",Sn,x0);xe("ss",Sn,ss);an(["s","ss"],nl);var Qq=Qd("Seconds",!1);Ye("S",0,0,function(){return~~(this.millisecond()/100)});Ye(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ye(0,["SSS",3],0,"millisecond");Ye(0,["SSSS",4],0,function(){return this.millisecond()*10});Ye(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ye(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ye(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ye(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ye(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});xe("S",NC,oV);xe("SS",NC,ss);xe("SSS",NC,aV);var ru,UV;for(ru="SSSS";ru.length<=9;ru+="S")xe(ru,qd);function Zq(n,e){e[Ih]=Nt(("0."+n)*1e3)}for(ru="S";ru.length<=9;ru+="S")an(ru,Zq);UV=Qd("Milliseconds",!1);Ye("z",0,0,"zoneAbbr");Ye("zz",0,0,"zoneName");function Jq(){return this._isUTC?"UTC":""}function e6(){return this._isUTC?"Coordinated Universal Time":""}var de=Wg.prototype;de.add=z3;de.calendar=J3;de.clone=eq;de.diff=aq;de.endOf=wq;de.format=cq;de.from=dq;de.fromNow=fq;de.to=mq;de.toNow=gq;de.get=hK;de.invalidAt=Aq;de.isAfter=tq;de.isBefore=nq;de.isBetween=rq;de.isSame=iq;de.isSameOrAfter=sq;de.isSameOrBefore=oq;de.isValid=bq;de.lang=PV;de.locale=xV;de.localeData=LV;de.max=b3;de.min=E3;de.parsingFlags=Tq;de.set=cK;de.startOf=pq;de.subtract=Y3;de.toArray=Sq;de.toObject=Rq;de.toDate=Cq;de.toISOString=uq;de.inspect=hq;typeof Symbol<"u"&&Symbol.for!=null&&(de[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});de.toJSON=Eq;de.toString=lq;de.unix=yq;de.valueOf=vq;de.creationData=Nq;de.eraName=_q;de.eraNarrow=xq;de.eraAbbr=Pq;de.eraYear=Lq;de.year=hV;de.isLeapYear=uK;de.weekYear=Bq;de.isoWeekYear=Wq;de.quarter=de.quarters=Kq;de.month=gV;de.daysInMonth=CK;de.week=de.weeks=IK;de.isoWeek=de.isoWeeks=MK;de.weeksInYear=jq;de.weeksInWeekYear=zq;de.isoWeeksInYear=$q;de.isoWeeksInISOWeekYear=Gq;de.date=VV;de.day=de.days=WK;de.weekday=$K;de.isoWeekday=GK;de.dayOfYear=qq;de.hour=de.hours=QK;de.minute=de.minutes=Xq;de.second=de.seconds=Qq;de.millisecond=de.milliseconds=UV;de.utcOffset=P3;de.utc=D3;de.local=H3;de.parseZone=F3;de.hasAlignedHourOffset=k3;de.isDST=V3;de.isLocal=B3;de.isUtcOffset=W3;de.isUtc=IV;de.isUTC=IV;de.zoneAbbr=Jq;de.zoneName=e6;de.dates=Hs("dates accessor is deprecated. Use date instead.",VV);de.months=Hs("months accessor is deprecated. Use month instead",gV);de.years=Hs("years accessor is deprecated. Use year instead",hV);de.zone=Hs("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",L3);de.isDSTShifted=Hs("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",U3);function t6(n){return Cn(n*1e3)}function n6(){return Cn.apply(null,arguments).parseZone()}function BV(n){return n}var Ft=N0.prototype;Ft.calendar=BY;Ft.longDateFormat=jY;Ft.invalidDate=YY;Ft.ordinal=XY;Ft.preparse=BV;Ft.postformat=BV;Ft.relativeTime=ZY;Ft.pastFuture=JY;Ft.set=VY;Ft.eras=Iq;Ft.erasParse=Mq;Ft.erasConvertYear=Oq;Ft.erasAbbrRegex=Hq;Ft.erasNameRegex=Dq;Ft.erasNarrowRegex=Fq;Ft.months=pK;Ft.monthsShort=wK;Ft.monthsParse=yK;Ft.monthsRegex=RK;Ft.monthsShortRegex=SK;Ft.week=bK;Ft.firstDayOfYear=NK;Ft.firstDayOfWeek=AK;Ft.weekdays=FK;Ft.weekdaysMin=VK;Ft.weekdaysShort=kK;Ft.weekdaysParse=BK;Ft.weekdaysRegex=jK;Ft.weekdaysShortRegex=zK;Ft.weekdaysMinRegex=YK;Ft.isPM=qK;Ft.meridiem=ZK;function Zv(n,e,t,r){var i=vl(),s=Sa().set(r,e);return i[t](s,n)}function WV(n,e,t){if(dl(n)&&(e=n,n=void 0),n=n||"",e!=null)return Zv(n,e,t,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Zv(n,r,t,"month");return i}function j0(n,e,t,r){typeof n=="boolean"?(dl(e)&&(t=e,e=void 0),e=e||""):(e=n,t=e,n=!1,dl(e)&&(t=e,e=void 0),e=e||"");var i=vl(),s=n?i._week.dow:0,o,a=[];if(t!=null)return Zv(e,(t+s)%7,r,"day");for(o=0;o<7;o++)a[o]=Zv(e,(o+s)%7,r,"day");return a}function r6(n,e){return WV(n,e,"months")}function i6(n,e){return WV(n,e,"monthsShort")}function s6(n,e,t){return j0(n,e,t,"weekdays")}function o6(n,e,t){return j0(n,e,t,"weekdaysShort")}function a6(n,e,t){return j0(n,e,t,"weekdaysMin")}cu("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var e=n%10,t=Nt(n%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return n+t}});le.lang=Hs("moment.lang is deprecated. Use moment.locale instead.",cu);le.langData=Hs("moment.langData is deprecated. Use moment.localeData instead.",vl);var Ma=Math.abs;function l6(){var n=this._data;return this._milliseconds=Ma(this._milliseconds),this._days=Ma(this._days),this._months=Ma(this._months),n.milliseconds=Ma(n.milliseconds),n.seconds=Ma(n.seconds),n.minutes=Ma(n.minutes),n.hours=Ma(n.hours),n.months=Ma(n.months),n.years=Ma(n.years),this}function $V(n,e,t,r){var i=bo(e,t);return n._milliseconds+=r*i._milliseconds,n._days+=r*i._days,n._months+=r*i._months,n._bubble()}function u6(n,e){return $V(this,n,e,1)}function h6(n,e){return $V(this,n,e,-1)}function d1(n){return n<0?Math.floor(n):Math.ceil(n)}function c6(){var n=this._milliseconds,e=this._days,t=this._months,r=this._data,i,s,o,a,l;return n>=0&&e>=0&&t>=0||n<=0&&e<=0&&t<=0||(n+=d1(VA(t)+e)*864e5,e=0,t=0),r.milliseconds=n%1e3,i=Es(n/1e3),r.seconds=i%60,s=Es(i/60),r.minutes=s%60,o=Es(s/60),r.hours=o%24,e+=Es(o/24),l=Es(GV(e)),t+=l,e-=d1(VA(l)),a=Es(t/12),t%=12,r.days=e,r.months=t,r.years=a,this}function GV(n){return n*4800/146097}function VA(n){return n*146097/4800}function d6(n){if(!this.isValid())return NaN;var e,t,r=this._milliseconds;if(n=Fs(n),n==="month"||n==="quarter"||n==="year")switch(e=this._days+r/864e5,t=this._months+GV(e),n){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round(VA(this._months)),n){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+n)}}function yl(n){return function(){return this.as(n)}}var jV=yl("ms"),f6=yl("s"),m6=yl("m"),g6=yl("h"),p6=yl("d"),w6=yl("w"),v6=yl("M"),y6=yl("Q"),C6=yl("y"),S6=jV;function R6(){return bo(this)}function E6(n){return n=Fs(n),this.isValid()?this[n+"s"]():NaN}function oc(n){return function(){return this.isValid()?this._data[n]:NaN}}var b6=oc("milliseconds"),T6=oc("seconds"),A6=oc("minutes"),N6=oc("hours"),I6=oc("days"),M6=oc("months"),O6=oc("years");function _6(){return Es(this.days()/7)}var Ya=Math.round,dd={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function x6(n,e,t,r,i){return i.relativeTime(e||1,!!t,n,r)}function P6(n,e,t,r){var i=bo(n).abs(),s=Ya(i.as("s")),o=Ya(i.as("m")),a=Ya(i.as("h")),l=Ya(i.as("d")),u=Ya(i.as("M")),h=Ya(i.as("w")),c=Ya(i.as("y")),d=s<=t.ss&&["s",s]||s<t.s&&["ss",s]||o<=1&&["m"]||o<t.m&&["mm",o]||a<=1&&["h"]||a<t.h&&["hh",a]||l<=1&&["d"]||l<t.d&&["dd",l];return t.w!=null&&(d=d||h<=1&&["w"]||h<t.w&&["ww",h]),d=d||u<=1&&["M"]||u<t.M&&["MM",u]||c<=1&&["y"]||["yy",c],d[2]=e,d[3]=+n>0,d[4]=r,x6.apply(null,d)}function L6(n){return n===void 0?Ya:typeof n=="function"?(Ya=n,!0):!1}function D6(n,e){return dd[n]===void 0?!1:e===void 0?dd[n]:(dd[n]=e,n==="s"&&(dd.ss=e-1),!0)}function H6(n,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,r=dd,i,s;return typeof n=="object"&&(e=n,n=!1),typeof n=="boolean"&&(t=n),typeof e=="object"&&(r=Object.assign({},dd,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),s=P6(this,!t,r,i),t&&(s=i.pastFuture(+this,s)),i.postformat(s)}var qE=Math.abs;function dc(n){return(n>0)-(n<0)||+n}function DC(){if(!this.isValid())return this.localeData().invalidDate();var n=qE(this._milliseconds)/1e3,e=qE(this._days),t=qE(this._months),r,i,s,o,a=this.asSeconds(),l,u,h,c;return a?(r=Es(n/60),i=Es(r/60),n%=60,r%=60,s=Es(t/12),t%=12,o=n?n.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=dc(this._months)!==dc(a)?"-":"",h=dc(this._days)!==dc(a)?"-":"",c=dc(this._milliseconds)!==dc(a)?"-":"",l+"P"+(s?u+s+"Y":"")+(t?u+t+"M":"")+(e?h+e+"D":"")+(i||r||n?"T":"")+(i?c+i+"H":"")+(r?c+r+"M":"")+(n?c+o+"S":"")):"P0D"}var Lt=PC.prototype;Lt.isValid=M3;Lt.abs=l6;Lt.add=u6;Lt.subtract=h6;Lt.as=d6;Lt.asMilliseconds=jV;Lt.asSeconds=f6;Lt.asMinutes=m6;Lt.asHours=g6;Lt.asDays=p6;Lt.asWeeks=w6;Lt.asMonths=v6;Lt.asQuarters=y6;Lt.asYears=C6;Lt.valueOf=S6;Lt._bubble=c6;Lt.clone=R6;Lt.get=E6;Lt.milliseconds=b6;Lt.seconds=T6;Lt.minutes=A6;Lt.hours=N6;Lt.days=I6;Lt.weeks=_6;Lt.months=M6;Lt.years=O6;Lt.humanize=H6;Lt.toISOString=DC;Lt.toString=DC;Lt.toJSON=DC;Lt.locale=xV;Lt.localeData=LV;Lt.toIsoString=Hs("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",DC);Lt.lang=PV;Ye("X",0,0,"unix");Ye("x",0,0,"valueOf");xe("x",MC);xe("X",rK);an("X",function(n,e,t){t._d=new Date(parseFloat(n)*1e3)});an("x",function(n,e,t){t._d=new Date(Nt(n))});le.version="2.30.1";FY(Cn);le.fn=de;le.min=T3;le.max=A3;le.now=N3;le.utc=Sa;le.unix=t6;le.months=r6;le.isDate=Bg;le.locale=cu;le.invalid=TC;le.duration=bo;le.isMoment=vo;le.weekdays=s6;le.parseZone=n6;le.localeData=vl;le.isDuration=mv;le.monthsShort=i6;le.weekdaysMin=a6;le.defineLocale=F0;le.updateLocale=n3;le.locales=r3;le.weekdaysShort=o6;le.normalizeUnits=Fs;le.relativeTimeRounding=L6;le.relativeTimeThreshold=D6;le.calendarFormat=Z3;le.prototype=de;le.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function F6(n){const e=n.length;let t=0;for(;t<e;)n[t]=[n[t]],t+=1}function f1(n,e){const t=e.length;let r=0;for(;r<t;)n.push(e[r]),r+=1}function pv(n){const e=[];if(!n||n.length===0||!n[0]||n[0].length===0)return e;const t=n.length,r=n[0].length;for(let i=0;i<t;i++)for(let s=0;s<r;s++)e[s]||(e[s]=[]),e[s][i]=n[i][s];return e}function gi(n,e,t,r){let i=-1,s=n,o=t;Array.isArray(n)||(s=Array.from(n));const a=s.length;for(i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function vu(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length,s=[];let o=-1;for(;t<i;){const a=r[t];e(a,t,r)&&(o+=1,s[o]=a),t+=1}return s}function bt(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length,s=[];let o=-1;for(;t<i;){const a=r[t];o+=1,s[o]=e(a,t,r),t+=1}return s}function D(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length;for(;t<i&&e(r[t],t,r)!==!1;)t+=1;return n}function zV(n){const e=[];return D(n,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function m1(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[r,...i]=[...e];let s=r;return D(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function g1(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return n.split(e)}function Yt(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return gi(n,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),u=t[a]?t[a]:"";return s+l+u},"").trim()}function Zn(n){let e;switch(typeof n){case"string":case"number":e=`${n}`;break;case"object":e=n===null?"":n.toString();break;case"undefined":e="";break;default:e=n.toString();break}return e}function _e(n){return typeof n<"u"}function mn(n){return typeof n>"u"}function Gn(n){return n===null||n===""||mn(n)}function k6(n){return Object.prototype.toString.call(n)==="[object RegExp]"}const fm="length",bm=n=>parseInt(n,16),p1=n=>parseInt(n,10),Jv=(n,e,t)=>n.substr(e,t),Tm=n=>n.codePointAt(0)-65,UA=n=>`${n}`.replace(/\-/g,""),V6=n=>bm(Jv(UA(n),bm("12"),Tm("F")))/(bm(Jv(UA(n),Tm("B"),~~![][fm]))||9),U6=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let w1=!1;const v1={invalid:()=>Yt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return Yt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Yt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},y1={invalid:()=>Yt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return Yt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Yt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function B6(n,e){const t=!Gn(n),r=typeof n=="string"&&n.toLowerCase()==="non-commercial-and-evaluation",i="14.6.2";let s,o="invalid",a="invalid";n=UA(n||"");const l=W6(n);if(t||r||l)if(l){const u=le("10/02/2025","DD/MM/YYYY"),h=Math.floor(u.toDate().getTime()/864e5),c=V6(n);s=le((c+1)*864e5,"x").format("MMMM DD, YYYY"),h>c?(o="expired",a="expired"):(o="valid",a="valid")}else r?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(U6()&&(o="valid",a="valid"),!w1&&o!=="valid"&&(v1[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](v1[o]({keyValidityDate:s,hotVersion:i})),w1=!0),a!=="valid"&&e.parentNode&&y1[a]({keyValidityDate:s,hotVersion:i})){const h=document.createElement("div");h.className="hot-display-license-info",h.innerHTML=y1[a]({keyValidityDate:s,hotVersion:i}),e.parentNode.insertBefore(h,e.nextSibling)}}function W6(n){let e=[][fm],t=e;if(n[fm]!==Tm("Z"))return!1;for(let r="",i="B<H4P+".split(""),s=Tm(i.shift());s;s=Tm(i.shift()||"A"))--s<""[fm]?t=t|(p1(`${p1(bm(r)+(bm(Jv(n,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Jv(n,s,s?i[fm]===1?9:8:6);return t===e}function yo(n){return n[0].toUpperCase()+n.substr(1)}function YV(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function KV(n){return/^([0-9][0-9]?%$)|(^100%$)/.test(n)}function qV(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${n}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,r)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[r]===void 0?"":e[r])}function C1(n){return z0(`${n}`,{ALLOWED_TAGS:[]})}function z0(n,e){return HY.sanitize(n,e)}const Zd=n=>["tabindex",n],$6=()=>["role","treegrid"],ua=()=>["role","presentation"],G6=()=>["role","gridcell"],j6=()=>["role","rowheader"],XV=()=>["role","rowgroup"],z6=()=>["role","columnheader"],BA=()=>["role","row"],Y6=()=>["role","menu"],K6=()=>["role","menuitem"],q6=()=>["role","menuitemcheckbox"],X6=()=>["role","combobox"],QV=()=>["role","listbox"],Q6=()=>["role","option"],Z6=()=>["role","checkbox"],J6=()=>["scope","col"],e4=()=>["scope","row"],t4=()=>["type","text"],ey=n=>["aria-label",n],ac=()=>["aria-hidden","true"],n4=()=>["aria-disabled","true"],r4=()=>["aria-multiselectable","true"],ZV=n=>["aria-haspopup",n],JV=n=>["aria-rowcount",n],HC=n=>["aria-colcount",n],eU=n=>["aria-rowindex",n],Y0=n=>["aria-colindex",n],Ns=n=>["aria-expanded",n],i4=n=>["aria-sort",n],S1=()=>["aria-readonly","true"],R1=()=>["aria-invalid","true"],tU=n=>["aria-checked",n],K0=()=>["aria-selected","true"],s4=()=>["aria-autocomplete","list"],o4=n=>["aria-controls",n],a4=n=>["aria-activedescendant",n],l4=n=>["aria-live",n],u4=n=>["aria-relevant",n],h4=n=>["aria-setsize",n],c4=n=>["aria-posinset",n];function d4(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,r=null,i=n;for(;i!==null;){if(t===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(t+=1,i=i.parentNode)}return r}function f4(n,e){const t=n.closest(".handsontable");return!!t&&(t.parentNode===e||t===e)}function m4(n){return Object.getPrototypeOf(n.parent)&&n.frameElement}function Hd(n){return m4(n)&&n.parent}function Bh(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=n;for(;s!=null&&s!==t;){const{nodeType:o,nodeName:a}=s;if(o===r&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function wp(n,e,t){const r=[];let i=n;for(;i&&(i=Bh(i,e,t),!(!i||t&&!t.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=r.length;return s?r[s-1]:null}function kh(n,e){let t=n.parentNode,r=[];for(typeof e=="string"?n.defaultView?r=Array.prototype.slice.call(n.querySelectorAll(e),0):r=Array.prototype.slice.call(n.ownerDocument.querySelectorAll(e),0):r.push(e);t!==null;){if(r.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function g4(n){let e=0,t=n;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function Pu(n,e,t){const r=t.parentElement.querySelector(`.ht_clone_${n}`);return r?r.contains(e):null}function nU(n){return!n||!n.length?[]:n.filter(e=>!!e)}function rU(n,e){if(!n||!n.length)return{regexFree:[],regexes:[]};const t=[],r=[];return r.push(...n.filter(i=>{const s=i instanceof RegExp;return s&&e&&t.push(i),!s})),{regexFree:r,regexes:t}}function Je(n,e){return n.classList===void 0||typeof e!="string"||e===""?!1:n.classList.contains(e)}function ue(n,e){typeof e=="string"&&(e=e.split(" ")),e=nU(e),e.length>0&&n.classList.add(...e)}function rt(n,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:t,regexes:r}=rU(e,!0);t=nU(t),t.length>0&&n.classList.remove(...t),r.forEach(i=>{n.classList.forEach(s=>{i.test(s)&&n.classList.remove(s)})})}function Xe(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,t]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&n.setAttribute(...r)})}function Jd(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:t,regexes:r}=rU(e,!0);t.forEach(i=>{i!==""&&n.removeAttribute(i)}),r.forEach(i=>{n.getAttributeNames().forEach(s=>{i.test(s)&&n.removeAttribute(s)})})}function iU(n){if(n.nodeType===3)n.parentNode.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1){const e=n.childNodes;for(let t=e.length-1;t>=0;t--)iU(e[t])}}function pa(n){let e;for(;e=n.lastChild;)n.removeChild(e)}const p4=/(<(.*)>|&(.*);)/;function ef(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p4.test(e)?n.innerHTML=t?z0(e):e:Wh(n,e)}function Wh(n,e){const t=n.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(pa(n),n.appendChild(n.ownerDocument.createTextNode(e)))}function Fd(n){const e=n.ownerDocument.documentElement;let t=n;for(;t!==e;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return Fd(t.host.impl);if(t.host)return Fd(t.host);throw new Error("Lost in Web Components world")}else return!1;else if(fl(t).display==="none")return!1;t=t.parentNode}return!0}function br(n){const e=n.ownerDocument,t=e.defaultView,r=e.documentElement;let i=n,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=t.pageXOffset||r.scrollLeft,o+=t.pageYOffset||r.scrollTop),{left:s,top:o}}function sU(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function q0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function X0(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?sU(e):n.scrollTop}function oU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?q0(e):n.scrollLeft}function ty(n){let e=n.ownerDocument,t=e?e.defaultView:void 0;e||(e=n.document?n.document:n,t=e.defaultView);const r=["auto","scroll"];let i=n.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=t.getComputedStyle(i),r.includes(s)||r.includes(o)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(s))||i.clientWidth<=i.scrollWidth+1&&(r.includes(o)||r.includes(s)))return i;i=i.parentNode}return t}function w4(n){return n.scrollHeight-n.clientHeight}function v4(n){return n.scrollWidth-n.clientWidth}function kd(n){const e=n.ownerDocument,t=e.defaultView;let r=n.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=fl(r,t),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return r;r=r.parentNode}return t}function og(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(n){if(n===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const r=n.style[e];if(r!==""&&r!==void 0)return r;const i=fl(n,t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function fl(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n.currentStyle||e.getComputedStyle(n)}function gn(n){return n.offsetWidth}function er(n){return n.offsetHeight}function fd(n){return n.clientHeight||n.innerHeight}function aU(n){return n.clientWidth||n.innerWidth}function lU(n){return n.selectionStart?n.selectionStart:0}function y4(n){return n.selectionEnd?n.selectionEnd:0}function E1(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;n.getSelection&&(n.getSelection().empty?n.getSelection().empty():n.getSelection().removeAllRanges&&n.getSelection().removeAllRanges())}function FC(n,e,t){if(t===void 0&&(t=e),n.setSelectionRange){n.focus();try{n.setSelectionRange(e,t)}catch{const i=n.parentNode,s=i.style.display;i.style.display="block",n.setSelectionRange(e,t),i.style.display=s}}}let XE;function C4(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=n.createElement("div");e.style.height="200px",e.style.width="100%";const t=n.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(n.body||n.documentElement).appendChild(t);const r=e.offsetWidth;t.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=t.clientWidth),(n.body||n.documentElement).removeChild(t),r-i}function Tr(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return XE===void 0&&(XE=C4(n)),XE}function S4(n){return n.offsetWidth!==n.clientWidth}function R4(n){return n.offsetHeight!==n.clientHeight}function Q0(n,e,t){n.style.transform=`translate3d(${e},${t},0)`}function kC(n){n.style.transform&&n.style.transform!==""&&(n.style.transform="")}function wv(n){return n&&(["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true")}function uU(n){return wv(n)&&n.hasAttribute("data-hot-input")===!1}function hU(n){return!n.parentNode}function E4(n,e){new IntersectionObserver((r,i)=>{r.forEach(s=>{s.isIntersecting&&n.offsetParent!==null&&(e(),i.unobserve(n))})},{root:n.ownerDocument.body}).observe(n)}function cU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=n.ownerDocument,i=r.createRange(),s=r.defaultView.getSelection();Xe(n,"contenteditable",!0),t&&Xe(n,...ac()),e&&ue(n,"invisibleSelection"),i.selectNodeContents(n),s.removeAllRanges(),s.addRange(i)}function dU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const t=n.ownerDocument.defaultView.getSelection();n.hasAttribute("aria-hidden")&&n.removeAttribute("aria-hidden"),t.removeAllRanges(),e&&rt(n,"invisibleSelection"),n.removeAttribute("contenteditable")}function b4(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;cU(n,t),e(),dU(n,t)}function fn(n){return typeof n=="function"}function Z0(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,r;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t&&clearTimeout(t),t=setTimeout(()=>{r=n.apply(this,o)},e),r}return i}function fU(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.apply(this,t.concat(o))}}function T4(n){const e=n.length;function t(r){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=r.concat(o);let u;return l.length>=e?u=n.apply(this,l):u=t(l),u}}return t([])}function WA(n,e,t,r,i,s,o,a){return _e(a)?n.call(e,t,r,i,s,o,a):_e(o)?n.call(e,t,r,i,s,o):_e(s)?n.call(e,t,r,i,s):_e(i)?n.call(e,t,r,i):_e(r)?n.call(e,t,r):_e(t)?n.call(e,t):n.call(e)}var b1={},QE,T1;function A4(){if(T1)return QE;T1=1;var n=Ds(),e=kk().get;return QE=function(r){if(!n(r))return!1;var i=e(r);return!!i&&i.type==="RawJSON"},QE}var ZE,A1;function N4(){if(A1)return ZE;A1=1;var n=sr(),e=Eo(),t=SyntaxError,r=parseInt,i=String.fromCharCode,s=n("".charAt),o=n("".slice),a=n(/./.exec),l={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},u=/^[\da-f]{4}$/i,h=/^[\u0000-\u001F]$/;return ZE=function(c,d){for(var f=!0,m="";d<c.length;){var p=s(c,d);if(p==="\\"){var v=o(c,d,d+2);if(e(l,v))m+=l[v],d+=2;else if(v==="\\u"){d+=2;var y=o(c,d,d+4);if(!a(u,y))throw new t("Bad Unicode escape at: "+d);m+=i(r(y,16)),d+=4}else throw new t('Unknown escape sequence: "'+v+'"')}else if(p==='"'){f=!1,d++;break}else{if(a(h,p))throw new t("Bad control character in string literal at: "+d);m+=p,d++}}if(f)throw new t("Unterminated string at: "+d);return{value:m,end:d}},ZE}var JE,N1;function I4(){if(N1)return JE;N1=1;var n=Vr();return JE=!n(function(){var e="9007199254740993",t=JSON.rawJSON(e);return!JSON.isRawJSON(t)||JSON.stringify(t)!==e}),JE}var I1;function M4(){if(I1)return b1;I1=1;var n=Ur(),e=Kd(),t=EC(),r=Ro(),i=sr(),s=Vr(),o=Gk(),a=ti(),l=A4(),u=f0(),h=ec(),c=bC(),d=E0(),f=N4(),m=w0(),p=d0(),v=I4(),y=String,S=e("JSON","stringify"),R=i(/./.exec),T=i("".charAt),I=i("".charCodeAt),H=i("".replace),k=i("".slice),W=i([].push),Y=i(1.1.toString),$=/[\uD800-\uDFFF]/g,q=/^[\uD800-\uDBFF]$/,J=/^[\uDC00-\uDFFF]$/,re=m(),ie=re.length,ae=!p||s(function(){var ze=e("Symbol")("stringify detection");return S([ze])!=="[null]"||S({a:ze})!=="{}"||S(Object(ze))!=="{}"}),Ve=s(function(){return S("\uDF06\uD834")!=='"\\udf06\\ud834"'||S("\uDEAD")!=='"\\udead"'}),De=ae?function(ze,w){var C=d(arguments),b=pe(w);if(!(!a(b)&&(ze===void 0||u(ze))))return C[1]=function(P,L){if(a(b)&&(L=r(b,this,y(P),L)),!u(L))return L},t(S,null,C)}:S,Se=function(ze,w,C){var b=T(C,w-1),P=T(C,w+1);return R(q,ze)&&!R(J,P)||R(J,ze)&&!R(q,b)?"\\u"+Y(I(ze,0),16):ze},pe=function(ze){if(a(ze))return ze;if(o(ze)){for(var w=ze.length,C=[],b=0;b<w;b++){var P=ze[b];typeof P=="string"?W(C,P):(typeof P=="number"||h(P)==="Number"||h(P)==="String")&&W(C,c(P))}var L=C.length,G=!0;return function(ee,ne){if(G)return G=!1,ne;if(o(this))return ne;for(var he=0;he<L;he++)if(C[he]===ee)return ne}}};return S&&n({target:"JSON",stat:!0,arity:3,forced:ae||Ve||!v},{stringify:function(w,C,b){var P=pe(C),L=[],G=De(w,function(Ke,Q){var Qe=a(P)?r(P,this,y(Ke),Q):Q;return!v&&l(Qe)?re+(W(L,Qe.rawJSON)-1):Qe},b);if(typeof G!="string"||(Ve&&(G=H(G,$,Se)),v))return G;for(var ee="",ne=G.length,he=0;he<ne;he++){var we=T(G,he);if(we==='"'){var oe=f(G,++he).end-1,We=k(G,he,oe);ee+=k(We,0,ie)===re?L[k(We,ie)]:'"'+We+'"',he=oe}else ee+=we}return ee}}),b1}M4();function ag(n){let e;return Array.isArray(n)?e=n.length?new Array(n.length).fill(null):[]:(e={},gt(n,(t,r)=>{r!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[r]=ag(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[r]=[ag(t[0])]:e[r]=[]:e[r]=null)})),e}function Ea(n,e){return e.prototype.constructor=e,n.prototype=new e,n.prototype.constructor=n,n}function ir(n,e,t){const r=Array.isArray(t);return gt(e,(i,s)=>{(r===!1||t.includes(s))&&(n[s]=i)}),n}function VC(n,e){gt(e,(t,r)=>{e[r]&&typeof e[r]=="object"?(n[r]||(Array.isArray(e[r])?n[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?n[r]=e[r]:n[r]={}),VC(n[r],e[r])):n[r]=e[r]})}function mi(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n}function wa(n){const e={};return gt(n,(t,r)=>{e[r]=t}),e}function en(n){n.MIXINS||(n.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return D(t,i=>{n.MIXINS.push(i.MIXIN_NAME),gt(i,(s,o)=>{if(n.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")n.prototype[o]=s;else{const a=function(h,c){const d=`_${h}`,f=m=>{let p=m;return(Array.isArray(p)||mt(p))&&(p=mi(p)),p};return function(){return this[d]===void 0&&(this[d]=f(c)),this[d]}},l=function(h){const c=`_${h}`;return function(d){this[c]=d}};Object.defineProperty(n.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),n}function J0(n,e){return JSON.stringify(n)===JSON.stringify(e)}function mt(n){return Object.prototype.toString.call(n)==="[object Object]"}function Cl(n,e,t,r){r.value=t,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(n,e,r)}function gt(n,e){for(const t in n)if((!n.hasOwnProperty||n.hasOwnProperty&&Object.prototype.hasOwnProperty.call(n,t))&&e(n[t],t,n)===!1)break;return n}function O4(n,e){const t=e.split(".");let r=n;return gt(t,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function eb(n,e,t){const r=e.split(".");let i=n;r.forEach((s,o)=>{o!==r.length-1?(Ln(i,s)||(i[s]={}),i=i[s]):i[s]=t})}function eI(n){if(!mt(n))return 0;const e=function(t){let r=0;return mt(t)?gt(t,(i,s)=>{s!=="__children"&&(r+=e(i))}):r+=1,r};return e(n)}function co(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,r={_touched:!1,[t]:n,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[t]},set(i){this._touched=!0,this[t]=i},enumerable:!0,configurable:!0}),r}function Ln(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function tI(n){return window.requestAnimationFrame(n)}function ny(n){window.cancelAnimationFrame(n)}function mU(){return"ontouchstart"in window}function _4(){return typeof window<"u"}let fc;function x4(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return fc||(typeof Intl=="object"?fc=new Intl.Collator(n,e).compare:typeof String.prototype.localeCompare=="function"?fc=(t,r)=>`${t}`.localeCompare(r):fc=(t,r)=>t===r?0:t>r?-1:1,fc)}const ws=n=>{const e={value:!1};return e.test=(t,r)=>{e.value=n(t,r)},e},Eu={chrome:ws((n,e)=>/Chrome/.test(n)&&/Google/.test(e)),chromeWebKit:ws(n=>/CriOS/.test(n)),edge:ws(n=>/Edge/.test(n)),edgeWebKit:ws(n=>/EdgiOS/.test(n)),firefox:ws(n=>/Firefox/.test(n)),firefoxWebKit:ws(n=>/FxiOS/.test(n)),mobile:ws(n=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)),safari:ws((n,e)=>/Safari/.test(n)&&/Apple Computer/.test(e))},jg={mac:ws(n=>/^Mac/.test(n)),win:ws(n=>/^Win/.test(n)),linux:ws(n=>/^Linux/.test(n)),ios:ws(n=>/iPhone|iPad|iPod/i.test(n))};function P4(){let{userAgent:n=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};gt(Eu,t=>{let{test:r}=t;r(n,e)})}function L4(){let{platform:n=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};gt(jg,e=>{let{test:t}=e;t(n)})}_4()&&(P4(),L4());function gU(){return Eu.chrome.value}function D4(){return Eu.chromeWebKit.value}function tb(){return Eu.firefox.value}function H4(){return Eu.firefoxWebKit.value}function pU(){return Eu.safari.value}function F4(){return Eu.edge.value}function iu(){return Eu.mobile.value}function wU(){return jg.ios.value}function vU(){let{maxTouchPoints:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return n>2&&jg.mac.value}function M1(){return jg.win.value}function $A(){return jg.mac.value}const Be={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:tb()?182:174,AUDIO_MUTE:tb()?181:173,AUDIO_UP:tb()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},k4=[Be.ALT,Be.ARROW_DOWN,Be.ARROW_LEFT,Be.ARROW_RIGHT,Be.ARROW_UP,Be.AUDIO_DOWN,Be.AUDIO_MUTE,Be.AUDIO_UP,Be.BACKSPACE,Be.CAPS_LOCK,Be.DELETE,Be.END,Be.ENTER,Be.ESCAPE,Be.F1,Be.F2,Be.F3,Be.F4,Be.F5,Be.F6,Be.F7,Be.F8,Be.F9,Be.F10,Be.F11,Be.F12,Be.F13,Be.F14,Be.F15,Be.F16,Be.F17,Be.F18,Be.F19,Be.HOME,Be.INSERT,Be.MEDIA_NEXT,Be.MEDIA_PLAY_PAUSE,Be.MEDIA_PREV,Be.MEDIA_STOP,Be.NULL,Be.NUM_LOCK,Be.PAGE_DOWN,Be.PAGE_UP,Be.PAUSE,Be.SCROLL_LOCK,Be.SHIFT,Be.TAB];function V4(n){return n===32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function yU(n){return k4.includes(n)}function U4(n){return[Be.CONTROL,Be.COMMAND_LEFT,Be.COMMAND_RIGHT,Be.COMMAND_FIREFOX].includes(n)}function zg(n,e){const t=e.split("|");let r=!1;return D(t,i=>{if(n===Be[i])return r=!0,!1}),r}function To(n){n.isImmediatePropagationEnabled=!1,n.cancelBubble=!0}function bh(n){return n.isImmediatePropagationEnabled===!1}function $h(n){return n.button===2}function nI(n){return n.button===0}function B4(n){return n instanceof TouchEvent}function W4(n,e){const t={x:n.offsetX,y:n.offsetY};let r=n.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return t;for(;r!==e;)t.x+=r.offsetLeft,t.y+=r.offsetTop,r=r.offsetParent;return t}var O1={},nb={},rb,_1;function $4(){if(_1)return rb;_1=1;var n=Vk(),e=C0();return rb=Object.keys||function(r){return n(r,e)},rb}var x1;function G4(){if(x1)return nb;x1=1;var n=So(),e=Hk(),t=tc(),r=wl(),i=vC(),s=$4();return nb.f=n&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),h=s(l),c=h.length,d=0,f;c>d;)t.f(a,f=h[d++],u[f]);return a},nb}var ib,P1;function j4(){if(P1)return ib;P1=1;var n=wl(),e=G4(),t=C0(),r=y0(),i=qk(),s=v0(),o=Fk(),a=">",l="<",u="prototype",h="script",c=o("IE_PROTO"),d=function(){},f=function(S){return l+h+a+S+l+"/"+h+a},m=function(S){S.write(f("")),S.close();var R=S.parentWindow.Object;return S=null,R},p=function(){var S=s("iframe"),R="java"+h+":",T;return S.style.display="none",i.appendChild(S),S.src=String(R),T=S.contentWindow.document,T.open(),T.write(f("document.F=Object")),T.close(),T.F},v,y=function(){try{v=new ActiveXObject("htmlfile")}catch{}y=typeof document<"u"?document.domain&&v?m(v):p():m(v);for(var S=t.length;S--;)delete y[u][t[S]];return y()};return r[c]=!0,ib=Object.create||function(R,T){var I;return R!==null?(d[u]=n(R),I=new d,d[u]=null,I[c]=R):I=y(),T===void 0?I:e.f(I,T)},ib}var sb,L1;function rI(){if(L1)return sb;L1=1;var n=Ru(),e=j4(),t=tc().f,r=n("unscopables"),i=Array.prototype;return i[r]===void 0&&t(i,r,{configurable:!0,value:e(null)}),sb=function(s){i[r][s]=!0},sb}var D1;function z4(){if(D1)return O1;D1=1;var n=rI();return n("flatMap"),O1}z4();function zt(){_e(console)&&console.warn(...arguments)}function iI(){_e(console)&&console.error(...arguments)}function Y4(n,e,t){return(e=K4(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function K4(n){var e=q4(n,"string");return typeof e=="symbol"?e:e+""}function q4(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const mc=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],X4=Yt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,ob=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),ab=new Map([[]]),vp=new WeakMap;class Ie{static getSingleton(){return Z4()}constructor(){Y4(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return D(mc,t=>{e[t]=[],this.initOrderMap(e,t)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;if(Array.isArray(t))D(t,s=>this.add(e,s,r));else{ob.has(e)&&zt(qV(X4,{hookName:e,removedInVersion:ob.get(e)})),ab.has(e)&&zt(ab.get(e));const s=this.getBucket(r);if(typeof s[e]>"u"&&(this.register(e),s[e]=[],this.initOrderMap(s,e)),t.skip=!1,s[e].indexOf(t)===-1){let o=!1;t.initialHook&&D(s[e],(a,l)=>{if(a.initialHook)return s[e][l]=t,o=!0,!1}),o||s[e].push(t)}this.setCallbackOrderIndex(s,e,t,i),this.orderBucketByOrderIndex(s,e)}return this}once(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;Array.isArray(t)?D(t,s=>this.once(e,s,r)):(t.runOnce=!0,this.add(e,t,r,i))}remove(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(t);return!!(r[e]!==void 0&&r[e].length)}run(e,t,r,i,s,o,a,l){{const u=this.globalBucket[t],h=u?u.length:0;let c=0;if(h)for(;c<h;){if(!u[c]||u[c].skip){c+=1;continue}const d=WA(u[c],e,r,i,s,o,a,l);d!==void 0&&(r=d),u[c]&&u[c].runOnce&&this.remove(t,u[c]),c+=1}}{const u=this.getBucket(e)[t],h=u?u.length:0;let c=0;if(h)for(;c<h;){if(!u[c]||u[c].skip){c+=1;continue}const d=WA(u[c],e,r,i,s,o,a,l);d!==void 0&&(r=d),u[c]&&u[c].runOnce&&this.remove(t,u[c],e),c+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;gt(this.getBucket(e),(t,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||mc.push(e)}deregister(e){this.isRegistered(e)&&mc.splice(mc.indexOf(e),1)}isDeprecated(e){return ab.has(e)||ob.has(e)}isRegistered(e){return mc.indexOf(e)>=0}getRegistered(){return mc}setCallbackOrderIndex(e,t,r,i){const s=Number.isInteger(i)?i:0,o=this.getCallbackOrderMap(e,t);o.set(s,[...o.get(s)||[],r])}orderBucketByOrderIndex(e,t){const r=this.getCallbackOrderMap(e,t);r===void 0||r.size===0||r.size===1&&r.has(0)||(e[t]=[...r].sort((i,s)=>i[0]-s[0]).flatMap(i=>{let[,s]=i;return s}))}initOrderMap(e,t){vp.has(e)||vp.set(e,[]),vp.get(e)[t]=new Map}getCallbackOrderMap(e,t){return vp.get(e)[t]}}const Q4=new Ie;function Z4(){return Q4}const lb=new Map;function Ao(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";lb.has(n)||lb.set(n,new Map);const e=lb.get(n);function t(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function s(){return[...e.keys()]}function o(){return[...e.values()]}return{register:t,getItem:r,hasItem:i,getNames:s,getValues:o}}const GA=new WeakMap,{register:J4,getItem:CU,hasItem:SU,getNames:PCe,getValues:LCe}=Ao("editors");function eX(n){const e={},t=n;this.getConstructor=function(){return n},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new t(r)),e[r.guid]},Ie.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function RU(n,e){let t;if(typeof n=="function")GA.get(n)||zi(null,n),t=GA.get(n);else if(typeof n=="string")t=CU(n);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${n}"`);return t.getInstance(e)}function jA(n){if(typeof n=="function")return n;if(!SU(n))throw Error(`No registered editor found under "${n}" name`);return CU(n).getConstructor()}function zi(n,e){n&&typeof n!="string"&&(e=n,n=e.EDITOR_TYPE);const t=new eX(e);typeof n=="string"&&J4(n,t),GA.set(e,t)}function tX(n,e,t){return(e=nX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nX(n){var e=rX(n,"string");return typeof e=="symbol"?e:e+""}function rX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Co{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;tX(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){r.call(this,iX(o))}return this.context.eventListeners.push({element:e,event:t,callback:r,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(t,s,i),()=>{this.removeEventListener(e,t,r)}}removeEventListener(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===t&&o.element===e){if(r&&r!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const r=this.context.eventListeners[t];e&&r.eventManager!==this||(this.context.eventListeners.splice(t,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const s={bubbles:!0,cancelable:t!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let o;r.createEvent?(o=r.createEvent("MouseEvents"),o.initMouseEvent(t,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,r.body.parentNode)):o=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${t}`,o)}}function iX(n){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=function(){e.apply(this),To(this)},n}function sX(n,e){oX(n,e),e.add(n)}function oX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lu(n,e,t){return(e=aX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aX(n){var e=lX(n,"string");return typeof e=="symbol"?e:e+""}function lX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function H1(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ub=new WeakSet;class zA{constructor(e,t,r){sX(this,ub),Lu(this,"hot",void 0),Lu(this,"tableMeta",void 0),Lu(this,"selection",void 0),Lu(this,"eventManager",void 0),Lu(this,"destroyed",!1),Lu(this,"activeEditor",void 0),Lu(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=r,this.eventManager=new Co(e),this.hot.addHook("afterDocumentKeyDown",i=>H1(ub,this,uX).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,s,o)=>H1(ub,this,hX).call(this,i,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||t.isHeader())return;const{row:r,col:i}=t,s=this.hot.runHooks("modifyGetCellCoords",r,i);let o=r,a=i;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),h=this.hot.colToProp(a),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=RU(u,this.hot),this.activeEditor.prepare(r,i,h,l,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,t,r);if(t instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,r){this.activeEditor?this.activeEditor.finishEditing(e,t,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(r))||o.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!t||a)}moveSelectionAfterEnter(e){const t={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function uX(n){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||bh(n))return;const{keyCode:t}=n,r=(n.ctrlKey||n.metaKey)&&!n.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!yU(t)&&!U4(t)&&!r&&!this.isEditorOpened()&&this.openEditor("",n)}function hX(n,e){e.isCell()&&this.openEditor(null,n,!0)}const F1=new WeakMap;zA.getInstance=function(n,e,t){let r=F1.get(n);return r||(r=new zA(n,e,t),F1.set(n,r)),r};function cX(n,e){EU(n,e),e.add(n)}function mf(n,e,t){EU(n,e),e.set(n,t)}function EU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rn(n,e){return n.get(el(n,e))}function gf(n,e,t){return n.set(el(n,e),t),t}function el(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Td=Object.freeze({CELL:"cell",MIXED:"mixed"});var Cr=new WeakMap,yp=new WeakMap,Cp=new WeakMap,Sp=new WeakMap,Rp=new WeakMap,Wl=new WeakSet;class dX{constructor(e){var t=this;cX(this,Wl),mf(this,Cr,void 0),mf(this,yp,void 0),mf(this,Cp,1),mf(this,Sp,null),mf(this,Rp,new Map);const r=e.getSettings();gf(Cr,this,e),gf(yp,this,r.imeFastEdit?Td.MIXED:Td.CELL),Rn(Cr,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return el(Wl,t,mX).call(t,...s)}),Rn(Cr,this).addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return el(Wl,t,k1).call(t,...s)}),Rn(Cr,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return el(Wl,t,k1).call(t,...s)}),Rn(Cr,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return el(Wl,t,fX).call(t,...s)})}getFocusMode(){return Rn(yp,this)}setFocusMode(e){Object.values(Td).includes(e)?gf(yp,this,e):zt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Rn(Cp,this)}setRefocusDelay(e){gf(Cp,this,e)}setRefocusElementGetter(e){gf(Sp,this,e)}getRefocusElement(){if(typeof Rn(Sp,this)=="function")return Rn(Sp,this).call(this);var e;return(e=Rn(Cr,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=r=>{var i,s;const o=(i=Rn(Cr,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!o)return;let a=Rn(Cr,this).runHooks("modifyFocusedElement",o.row,o.col,r);a instanceof HTMLElement||(a=r),a&&!((s=Rn(Cr,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?t(e):el(Wl,this,sI).call(this,r=>t(r))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Rn(Cp,this);const r=this.getRefocusElement();Rn(Cr,this).getSettings().imeFastEdit&&!((e=Rn(Cr,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(Rn(Rp,this).has(t)||Rn(Rp,this).set(t,Z0(()=>{r.select()},t)),Rn(Rp,this).get(t)())}}function sI(n){var e;const t=(e=Rn(Cr,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||!Rn(Cr,this).selection.isCellVisible(t)){n(null);return}const r=Rn(Cr,this).getCell(t.row,t.col,!0);r===null?Rn(Cr,this).addHookOnce("afterScroll",()=>{n(Rn(Cr,this).getCell(t.row,t.col,!0))}):n(r)}function k1(){el(Wl,this,sI).call(this,n=>{const{activeElement:e}=Rn(Cr,this).rootDocument;e&&uU(e)&&e.blur(),this.focusOnHighlightedCell(n)})}function fX(){el(Wl,this,sI).call(this,n=>{this.getFocusMode()===Td.MIXED&&n.nodeName==="TD"&&this.refocusToEditorTextarea()})}function mX(n){typeof n.imeFastEdit=="boolean"&&this.setFocusMode(n.imeFastEdit?Td.MIXED:Td.CELL)}var V1={},hb,U1;function gX(){if(U1)return hb;U1=1;var n=Ds(),e=ec(),t=Ru(),r=t("match");return hb=function(i){var s;return n(i)&&((s=i[r])!==void 0?!!s:e(i)==="RegExp")},hb}var cb,B1;function pX(){if(B1)return cb;B1=1;var n=Mr(),e=Vr(),t=n.RegExp,r=!e(function(){var i=!0;try{t(".","d")}catch{i=!1}var s={},o="",a=i?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(s,d,{get:function(){return o+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var h in u)l(h,u[h]);var c=Object.getOwnPropertyDescriptor(t.prototype,"flags").get.call(s);return c!==a||o!==a});return cb={correct:r},cb}var db,W1;function wX(){if(W1)return db;W1=1;var n=wl();return db=function(){var e=n(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},db}var fb,$1;function vX(){if($1)return fb;$1=1;var n=Ro(),e=Eo(),t=yC(),r=pX(),i=wX(),s=RegExp.prototype;return fb=r.correct?function(o){return o.flags}:function(o){return!r.correct&&t(s,o)&&!e(o,"flags")?n(i,o):o.flags},fb}var mb,G1;function yX(){if(G1)return mb;G1=1;var n=sr(),e=Dg(),t=Math.floor,r=n("".charAt),i=n("".replace),s=n("".slice),o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return mb=function(l,u,h,c,d,f){var m=h+l.length,p=c.length,v=a;return d!==void 0&&(d=e(d),v=o),i(f,v,function(y,S){var R;switch(r(S,0)){case"$":return"$";case"&":return l;case"`":return s(u,0,h);case"'":return s(u,m);case"<":R=d[s(S,1,-1)];break;default:var T=+S;if(T===0)return y;if(T>p){var I=t(T/10);return I===0?y:I<=p?c[I-1]===void 0?r(S,1):c[I-1]+r(S,1):y}R=c[T-1]}return R===void 0?"":R})},mb}var j1;function CX(){if(j1)return V1;j1=1;var n=Ur(),e=Ro(),t=sr(),r=Pg(),i=ti(),s=Ds(),o=gX(),a=bC(),l=RC(),u=vX(),h=yX(),c=Ru(),d=m0(),f=c("replace"),m=TypeError,p=t("".indexOf),v=t("".replace),y=t("".slice),S=Math.max;return n({target:"String",proto:!0},{replaceAll:function(T,I){var H=r(this),k,W,Y,$,q,J,re,ie,ae,Ve,De=0,Se="";if(s(T)){if(k=o(T),k&&(W=a(r(u(T))),!~p(W,"g")))throw new m("`.replaceAll` does not allow non-global regexes");if(Y=l(T,f),Y)return e(Y,T,H,I);if(d&&k)return v(a(H),T,I)}for($=a(H),q=a(T),J=i(I),J||(I=a(I)),re=q.length,ie=S(1,re),ae=p($,q);ae!==-1;)Ve=J?a(I(q,ae,$)):h(q,$,ae,[],void 0,I),Se+=y($,De,ae)+Ve,De=ae+re,ae=ae+ie>$.length?-1:p($,q,ae+ie);return De<$.length&&(Se+=y($,De)),Se}}),V1}CX();const bU={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},SX=new RegExp(Object.keys(bU).map(n=>`(${n})`).join("|"),"gi");function RX(n){return(n&&n.nodeName||"")==="TABLE"}function z1(n){const e=n.hasColHeaders(),t=n.hasRowHeaders(),r=[e?-1:0,t?-1:0,n.countRows()-1,n.countCols()-1],i=n.getData(...r),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],h=t?1:0,c=e?1:0;for(let d=0;d<s;d+=1){const f=e&&d===0,m=[];for(let v=0;v<o;v+=1){const y=!f&&t&&v===0;let S="";if(f)S=`<th>${n.getColHeader(v-h)}</th>`;else if(y)S=`<th>${n.getRowHeader(d-c)}</th>`;else{const R=i[d][v],{hidden:T,rowspan:I,colspan:H}=n.getCellMeta(d-c,v-h);if(!T){const k=[];if(I&&k.push(`rowspan="${I}"`),H&&k.push(`colspan="${H}"`),Gn(R))S=`<td ${k.join(" ")}></td>`;else{const W=R.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");S=`<td ${k.join(" ")}>${W}</td>`}}}m.push(S)}const p=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,p):u.splice(-1,0,p)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function Y1(n){const e=n.length,t=["<table>"];for(let r=0;r<e;r+=1){const i=n[r],s=i.length,o=[];r===0&&t.push("<tbody>");for(let a=0;a<s;a+=1){const l=i[a],u=Gn(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,h=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(h.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${u}</td>`)}t.push("<tr>",...o,"</tr>"),r+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function EX(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const t={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let s=n;if(typeof s=="string"){const R=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,T=>{const I=T.match(/<td\b[^>]*?>/g)[0],H=/<p.*?>/g,k=T.substring(I.length,T.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(H,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${I}${k}</td>`});i.insertAdjacentHTML("afterbegin",`${R}`),s=i.querySelector("table")}if(!s||!RX(s))return;const o=i.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),u=l?Array.from(l.cells).reduce((R,T)=>R+T.colSpan,0)-(a?1:0):0,h=s.tFoot&&Array.from(s.tFoot.rows)||[],c=[];let d=!1,f=0,m=0;if(s.tHead){const R=Array.from(s.tHead.rows).filter(T=>{const I=T.querySelector("td")!==null;return I&&c.push(T),!I});f=R.length,d=f>0,f>1?t.nestedHeaders=Array.from(R).reduce((T,I)=>{const H=Array.from(I.cells).reduce((k,W,Y)=>{if(a&&Y===0)return k;const{colSpan:$,innerHTML:q}=W,J=$>1?{label:q,colspan:$}:q;return k.push(J),k},[]);return T.push(H),T},[]):d&&(t.colHeaders=Array.from(R[0].children).reduce((T,I,H)=>(a&&H===0||T.push(I.innerHTML),T),[]))}c.length&&(t.fixedRowsTop=c.length),h.length&&(t.fixedRowsBottom=h.length);const p=[...c,...Array.from(s.tBodies).reduce((R,T)=>(R.push(...Array.from(T.rows)),R),[]),...h];m=p.length;const v=new Array(m);for(let R=0;R<m;R++)v[R]=new Array(u);const y=[],S=[];for(let R=0;R<m;R++){const T=p[R],I=Array.from(T.cells),H=I.length;for(let k=0;k<H;k++){const W=I[k],{nodeName:Y,innerHTML:$,rowSpan:q,colSpan:J}=W,re=v[R].findIndex(ie=>ie===void 0);if(Y==="TD"){if(q>1||J>1){for(let De=R;De<R+q;De++)if(De<m)for(let Se=re;Se<re+J;Se++)v[De][Se]=null;const ae=W.getAttribute("style");ae&&ae.includes("mso-ignore:colspan")||y.push({col:re,row:R,rowspan:q,colspan:J})}let ie="";o&&/excel/gi.test(o.content)?ie=$.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ie=$.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),v[R][re]=ie.replace(SX,ae=>bU[ae])}else S.push($)}}return y.length&&(t.mergeCells=y),S.length&&(t.rowHeaders=S),v.length&&(t.data=v),t}function ci(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof n;if(t==="number")return!isNaN(n)&&isFinite(n);if(t==="string"){if(n.length===0)return!1;if(n.length===1)return/\d/.test(n);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(n.trim())}else if(t==="object")return!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date);return!1}function bX(n){return ci(n,[","])}function He(n,e,t){let r=-1;for(typeof e=="function"?(t=e,e=n):r=n-1;++r<=e&&t(r)!==!1;);}function K1(n,e,t){let r=n+1;for(typeof e=="function"&&(t=e,e=0);--r>=e&&t(r)!==!1;);}function TU(n,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(n*e/100,10)}function Qt(n,e,t){return Math.min(n,e)===n?e:Math.max(n,t)===n?t:n}const YA="asc",TX="desc",q1=new Map([[YA,[-1,1]],[TX,[1,-1]]]),AX=n=>`The priority '${n}' is already declared in a map.`,NX=n=>`The priority '${n}' is not a number.`;function IX(){let{errorPriorityExists:n,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;n=fn(n)?n:AX,e=fn(e)?e:NX;function r(s,o){if(!ci(s))throw new Error(e(s));if(t.has(s))throw new Error(n(s));t.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:YA;const[o,a]=q1.get(s)||q1.get(YA);return[...t].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:r,getItems:i}}const MX=n=>`The id '${n}' is already declared in a map.`;function UC(){let{errorIdExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;n=fn(n)?n:MX;function t(u,h){if(l(u))throw new Error(n(u));e.set(u,h)}function r(u){return e.delete(u)}function i(){e.clear()}function s(u){const[h]=a().find(c=>{let[d,f]=c;return u===f?d:!1})||[null];return h}function o(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:t,clear:i,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:r}}const OX=n=>`'${n}' value is already declared in a unique set.`;function _X(){let{errorItemExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;n=fn(n)?n:OX;function t(s){if(e.has(s))throw new Error(n(s));e.add(s)}function r(){return[...e]}function i(){e.clear()}return{addItem:t,clear:i,getItems:r}}const oI=n=>`There is already registered "${n}" plugin.`,xX=n=>`There is already registered plugin on priority "${n}".`,PX=n=>`The priority "${n}" is not a number.`,AU=IX({errorPriorityExists:xX,errorPriorityNaN:PX}),NU=_X({errorItemExists:oI}),KA=UC({errorIdExists:oI});function IU(){return[...AU.getItems(),...NU.getItems()]}function aI(n){const e=yo(n);return KA.getItem(e)}function LX(n){return!!aI(n)}function Dt(n,e,t){[n,e,t]=HX(n,e,t),aI(n)===void 0&&DX(n,e,t)}function DX(n,e,t){const r=yo(n);if(KA.hasItem(r))throw new Error(oI(r));t===void 0?NU.addItem(r):AU.addItem(t,r),KA.addItem(r,e)}function HX(n,e,t){return typeof n=="function"&&(e=n,n=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[n,e,t]}const{register:FX,getItem:kX,hasItem:MU,getNames:DCe,getValues:HCe}=Ao("renderers");function qA(n){if(typeof n=="function")return n;if(!MU(n))throw Error(`No registered renderer found under "${n}" name`);return kX(n)}function fs(n,e){typeof n!="string"&&(e=n,n=e.RENDERER_TYPE),FX(n,e)}const{register:VX,getItem:UX,hasItem:OU,getNames:FCe,getValues:kCe}=Ao("validators");function BX(n){if(typeof n=="function")return n;if(!OU(n))throw Error(`No registered validator found under "${n}" name`);return UX(n)}function td(n,e){typeof n!="string"&&(e=n,n=e.VALIDATOR_TYPE),VX(n,e)}var X1={},Q1;function WX(){if(Q1)return X1;Q1=1;var n=Ur(),e=Dg(),t=kg(),r=Fg(),i=rI();return n({target:"Array",proto:!0},{at:function(o){var a=e(this),l=t(a),u=r(o),h=u>=0?u:l+u;return h<0||h>=l?void 0:a[h]}}),i("at"),X1}WX();var Z1={},J1;function $X(){if(J1)return Z1;J1=1;var n=Ur(),e=sr(),t=Pg(),r=Fg(),i=bC(),s=Vr(),o=e("".charAt),a=s(function(){return"𠮷".at(-2)!=="\uD842"});return n({target:"String",proto:!0,forced:a},{at:function(u){var h=i(t(this)),c=h.length,d=r(u),f=d>=0?d:c+d;return f<0||f>=c?void 0:o(h,f)}}),Z1}$X();function pf(n,e,t){return(e=GX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function GX(n){var e=jX(n,"string");return typeof e=="symbol"?e:e+""}function jX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class zX{constructor(){pf(this,"count",0),pf(this,"startColumn",null),pf(this,"endColumn",null),pf(this,"startPosition",null),pf(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:o}=t,a=i>0?s+1:s;r>=i&&r+o<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:h}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+h-u[this.startColumn-1];if(m<=i&&(this.startColumn-=1),m>=i)break}this.startPosition=(t=u[this.startColumn])!==null&&t!==void 0?t:null;const c=o>0?i+1:i,d=r+i-c,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*s||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function wf(n,e,t){return(e=YX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function YX(n){var e=KX(n,"string");return typeof e=="symbol"?e:e+""}function KX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class qX{constructor(){wf(this,"count",0),wf(this,"startRow",null),wf(this,"endRow",null),wf(this,"startPosition",null),wf(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:o}=t;r>=i&&r+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-s&&(this.startRow-=1),d>=i-s)break}this.startPosition=(t=l[this.startRow])!==null&&t!==void 0?t:null;const h=r+i-s,c=this.startRow===null?0:e.getRowHeight(this.startRow);h<c||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function vf(n,e,t){return(e=XX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XX(n){var e=QX(n,"string");return typeof e=="symbol"?e:e+""}function QX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class _U{constructor(){vf(this,"count",0),vf(this,"startColumn",null),vf(this,"endColumn",null),vf(this,"startPosition",null),vf(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:s}=t;r<=i&&(this.startColumn=e);const o=i>0?s+1:s;r>=i&&r<=i+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var t;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:h}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+h-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(t=u[this.startColumn])!==null&&t!==void 0?t:null;const c=o>0?i+1:i;r+i-c<-1*s||r>u.at(-1)+h||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function yf(n,e,t){return(e=ZX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ZX(n){var e=JX(n,"string");return typeof e=="symbol"?e:e+""}function JX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class xU{constructor(){yf(this,"count",0),yf(this,"startRow",null),yf(this,"endRow",null),yf(this,"startPosition",null),yf(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:s}=t;r<=i&&(this.startRow=e),r>=i&&r<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const c=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,c>=i-s)break}this.startPosition=(t=l[this.startRow])!==null&&t!==void 0?t:null,r+i-s<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Cf(n,e,t){return(e=e9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function e9(n){var e=t9(n,"string");return typeof e=="symbol"?e:e+""}function t9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class n9{constructor(){Cf(this,"count",0),Cf(this,"startColumn",0),Cf(this,"endColumn",0),Cf(this,"startPosition",0),Cf(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function Sf(n,e,t){return(e=r9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function r9(n){var e=i9(n,"string");return typeof e=="symbol"?e:e+""}function i9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class s9{constructor(){Sf(this,"count",0),Sf(this,"startRow",0),Sf(this,"endRow",0),Sf(this,"startPosition",0),Sf(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}class o9 extends _U{finalize(e){var t;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:s}=e;this.startColumn!==null&&typeof r=="function"&&r(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(t=s[this.startColumn])!==null&&t!==void 0?t:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}class a9 extends xU{finalize(e){var t;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:s}=e;this.startRow!==null&&typeof r=="function"&&r(this),this.startRow<0&&(this.startRow=0),this.startPosition=(t=s[this.startRow])!==null&&t!==void 0?t:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function eL(n,e,t){return(e=l9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function l9(n){var e=u9(n,"string");return typeof e=="symbol"?e:e+""}function u9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class PU{constructor(e){eL(this,"calculationTypes",[]),eL(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[r,i]=t;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,t){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,r]=t;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Ws(n,e,t){return(e=h9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function h9(n){var e=c9(n,"string");return typeof e=="symbol"?e:e+""}function c9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const BC=50;class d9 extends PU{constructor(e){let{calculationTypes:t,viewportWidth:r,scrollOffset:i,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(t),Ws(this,"viewportWidth",0),Ws(this,"scrollOffset",0),Ws(this,"zeroBasedScrollOffset",0),Ws(this,"totalColumns",0),Ws(this,"columnWidthFn",null),Ws(this,"columnWidth",0),Ws(this,"overrideFn",null),Ws(this,"inlineStartOffset",0),Ws(this,"totalCalculatedWidth",0),Ws(this,"startPositions",[]),Ws(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?BC:t}}function os(n,e,t){return(e=f9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function f9(n){var e=m9(n,"string");return typeof e=="symbol"?e:e+""}function m9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const LU=23;class g9 extends PU{constructor(e){let{calculationTypes:t,viewportHeight:r,scrollOffset:i,totalRows:s,rowHeightFn:o,overrideFn:a,horizontalScrollbarHeight:l}=e;super(t),os(this,"viewportHeight",0),os(this,"scrollOffset",0),os(this,"zeroBasedScrollOffset",0),os(this,"totalRows",0),os(this,"rowHeightFn",null),os(this,"rowHeight",0),os(this,"overrideFn",null),os(this,"horizontalScrollbarHeight",0),os(this,"innerViewportHeight",0),os(this,"totalCalculatedHeight",0),os(this,"startPositions",[]),os(this,"needReverse",!0),this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=o,this.overrideFn=a,this.horizontalScrollbarHeight=l??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?LU:t}}function p9(n,e,t){w9(n,e),e.set(n,t)}function w9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tL(n,e,t){return(e=v9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function v9(n){var e=y9(n,"string");return typeof e=="symbol"?e:e+""}function y9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function gc(n,e){return n.get(DU(n,e))}function nL(n,e,t){return n.set(DU(n,e),t),t}function DU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Oa=new WeakMap;class Gh{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;tL(this,"row",null),tL(this,"col",null),p9(this,Oa,!1),nL(Oa,this,r),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:r,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=t||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return gc(Oa,this)}isSouthEastOf(e){return this.row>=e.row&&(gc(Oa,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(gc(Oa,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(gc(Oa,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(gc(Oa,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof Gh&&nL(Oa,this,e.isRtl()),this}clone(){return new Gh(this.row,this.col,gc(Oa,this))}toObject(){return{row:this.row,col:this.col}}}function C9(n,e,t){S9(n,e),e.set(n,t)}function S9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gb(n,e,t){return(e=R9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function R9(n){var e=E9(n,"string");return typeof e=="symbol"?e:e+""}function E9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function as(n,e){return n.get(HU(n,e))}function b9(n,e,t){return n.set(HU(n,e),t),t}function HU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var yi=new WeakMap;class Yg{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;gb(this,"highlight",null),gb(this,"from",null),gb(this,"to",null),C9(this,yi,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=r.clone(),b9(yi,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:r}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=t&&s.row>=t&&i.col<=r&&s.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,o.row),u=Math.min(r.col,o.col),h=Math.max(i.row,a.row),c=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(h,c);return this.from=d,this.to=f,this.setDirection(s),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return as(yi,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return as(yi,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return as(yi,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return as(yi,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return as(yi,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return as(yi,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return as(yi,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return as(yi,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Gh))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return t.top===r.top&&i.push("top"),t.right===r.right&&i.push(as(yi,this)?"left":"right"),t.bottom===r.bottom&&i.push("bottom"),t.left===r.left&&i.push(as(yi,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=t.row;i++)for(let s=e.col;s<=t.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&r.push(this._createCellCoords(i,s));return r}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=t.row;i++)for(let s=e.col;s<=t.col;s++)e.row===i&&e.col===s?r.push(e):t.row===i&&t.col===s?r.push(t):r.push(this._createCellCoords(i,s));return r}forAll(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=t.row;i<=r.row;i++)for(let s=t.col;s<=r.col;s++)if(e(i,s)===!1)return}clone(){return new Yg(this.highlight,this.from,this.to,as(yi,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new Gh(e,t,as(yi,this))}}function Mo(n,e,t){T9(n,e),e.set(n,t)}function T9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fe(n,e){return n.get(FU(n,e))}function Nl(n,e,t){return n.set(FU(n,e),t),t}function FU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ls=new WeakMap,pb=new WeakMap,pr=new WeakMap,pc=new WeakMap,Ep=new WeakMap,$s=new WeakMap,wb=new WeakMap,Rf=new WeakMap,Du=new WeakMap,Oo=new WeakMap;let kU=class{constructor(e,t,r,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Mo(this,ls,void 0),Mo(this,pb,void 0),Mo(this,pr,void 0),Mo(this,pc,void 0),Mo(this,Ep,void 0),Mo(this,$s,void 0),Mo(this,wb,void 0),Mo(this,Rf,void 0),Mo(this,Du,[null,null]),Mo(this,Oo,[null,null]),Nl(ls,this,r),Nl(pb,this,t),Nl(pr,this,s),Nl(pc,this,o),Nl(Ep,this,a),Nl($s,this,i),Nl(wb,this,e),this.registerEvents()}registerEvents(){Fe($s,this).addEventListener(Fe(pr,this).holder,"contextmenu",r=>this.onContextMenu(r)),Fe($s,this).addEventListener(Fe(pr,this).TABLE,"mouseover",r=>this.onMouseOver(r)),Fe($s,this).addEventListener(Fe(pr,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{Fe($s,this).addEventListener(Fe(pr,this).holder,"touchstart",r=>this.onTouchStart(r)),Fe($s,this).addEventListener(Fe(pr,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),Fe($s,this).addEventListener(Fe(pr,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Fe(ls,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Fe(ls,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{Fe($s,this).addEventListener(Fe(pr,this).holder,"mouseup",r=>this.onMouseUp(r)),Fe($s,this).addEventListener(Fe(pr,this).holder,"mousedown",r=>this.onMouseDown(r))};iu()?e():(mU()&&e(),t())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(Fe(Rf,this)&&r){const[i,s]=[r.row,Fe(Rf,this).from.row],[o,a]=[r.col,Fe(Rf,this).from.col];return i===s&&o===a}return!1}parentCell(e){const t={},r=Fe(pr,this).TABLE,i=wp(e,["TD","TH"],r);return i?(t.coords=Fe(pr,this).getCoords(i),t.TD=i):Je(e,"wtBorder")&&Je(e,"current")?(t.coords=Fe(pc,this).getFocusSelection().cellRange.highlight,t.TD=Fe(pr,this).getCell(t.coords)):Je(e,"wtBorder")&&Je(e,"area")&&Fe(pc,this).getAreaSelection().cellRange&&(t.coords=Fe(pc,this).getAreaSelection().cellRange.to,t.TD=Fe(pr,this).getCell(t.coords)),t}onMouseDown(e){const t=Fe(pb,this).rootDocument.activeElement,r=fU(d4,e.target),i=e.target;if(!["TD","TH"].includes(t.nodeName)&&(i===t||r(0)===t||r(1)===t))return;const s=this.parentCell(i);Je(i,"corner")?Fe(ls,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&Fe(ls,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(Fe(Oo,this)[0]=s.TD,clearTimeout(Fe(Du,this)[0]),Fe(Du,this)[0]=setTimeout(()=>{Fe(Oo,this)[0]=null},1e3))}onContextMenu(e){if(Fe(ls,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!Fe(ls,this).has("onCellMouseOver"))return;const t=Fe(pr,this).TABLE,r=wp(e.target,["TD","TH"],t),i=Fe(Ep,this)||this;r&&r!==i.lastMouseOver&&kh(r,t)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,Fe(pr,this).getCoords(r),r))}onMouseOut(e){if(!Fe(ls,this).has("onCellMouseOut"))return;const t=Fe(pr,this).TABLE,r=wp(e.target,["TD","TH"],t),i=wp(e.relatedTarget,["TD","TH"],t),s=Fe(Ep,this)||this;r&&r!==i&&kh(r,t)&&(this.callListener("onCellMouseOut",e,Fe(pr,this).getCoords(r),r),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&Fe(ls,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),!(e.button!==0&&!this.touchApplied)&&(t.TD===Fe(Oo,this)[0]&&t.TD===Fe(Oo,this)[1]?(Je(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),Fe(Oo,this)[0]=null,Fe(Oo,this)[1]=null):t.TD===Fe(Oo,this)[0]&&(Fe(Oo,this)[1]=t.TD,clearTimeout(Fe(Du,this)[1]),Fe(Du,this)[1]=setTimeout(()=>{Fe(Oo,this)[1]=null},500)))}onTouchStart(e){Nl(Rf,this,Fe(pc,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const r=e.target,i=(t=this.parentCell(r))===null||t===void 0?void 0:t.coords,s=_e(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&Fe(ls,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];wU()&&(D4()||H4())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,r,i){const s=Fe(ls,this).getSettingPure(e);s&&s(t,r,i,Fe(wb,this).call(this))}destroy(){clearTimeout(Fe(Du,this)[0]),clearTimeout(Fe(Du,this)[1]),Fe($s,this).destroy()}};function vb(n,e,t){return(e=A9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function A9(n){var e=N9(n,"string");return typeof e=="symbol"?e:e+""}function N9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class I9{constructor(e,t,r){vb(this,"offset",void 0),vb(this,"total",void 0),vb(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function yb(n,e,t){return(e=M9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function M9(n){var e=O9(n,"string");return typeof e=="symbol"?e:e+""}function O9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class _9{constructor(e,t,r){yb(this,"offset",void 0),yb(this,"total",void 0),yb(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const x9=0,ry=1,iy=2;function bp(n,e,t){return(e=P9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function P9(n){var e=L9(n,"string");return typeof e=="symbol"?e:e+""}function L9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class rL{constructor(){bp(this,"currentSize",0),bp(this,"nextSize",0),bp(this,"currentOffset",0),bp(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Cb(n,e,t){return(e=D9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function D9(n){var e=H9(n,"string");return typeof e=="symbol"?e:e+""}function H9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class F9{constructor(){Cb(this,"size",new rL),Cb(this,"workingSpace",x9),Cb(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof rL}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=ry,e.workingSpace=iy,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=iy,e.workingSpace=ry,this.sharedSize=e.getViewSize()}}function wc(n,e,t){return(e=k9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function k9(n){var e=V9(n,"string");return typeof e=="symbol"?e:e+""}function V9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class VU{constructor(e,t,r){wc(this,"rootNode",void 0),wc(this,"nodesPool",void 0),wc(this,"sizeSet",new F9),wc(this,"childNodeType",void 0),wc(this,"visualIndex",0),wc(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(t.isPlaceOn(ry))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,r=this.isSharedViewSet(),{nextSize:i}=t.getViewSize();let s=this.getRenderedChildCount();for(;s<i;){const a=this.nodesPool();!r||r&&t.isPlaceOn(iy)?e.appendChild(a):e.insertBefore(a,e.firstChild),s+=1}const o=r&&t.isPlaceOn(ry);for(;s>i;)e.removeChild(o?e.firstChild:e.lastChild),s-=1}render(){const{rootNode:e,sizeSet:t}=this;let r=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(iy)&&(r+=t.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const s=this.nodesPool();e.replaceChild(s,i),i=s}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class UU extends VU{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function U9(n,e,t){return(e=B9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function B9(n){var e=W9(n,"string");return typeof e=="symbol"?e:e+""}function W9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class $9{constructor(e){U9(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Ef(n,e,t){return(e=G9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function G9(n){var e=j9(n,"string");return typeof e=="symbol"?e:e+""}function j9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Kg{constructor(e,t){Ef(this,"nodesPool",null),Ef(this,"nodeType",void 0),Ef(this,"rootNode",void 0),Ef(this,"table",null),Ef(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new $9(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function iL(n,e,t){return(e=z9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function z9(n){var e=Y9(n,"string");return typeof e=="symbol"?e:e+""}function Y9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class K9 extends Kg{constructor(){super("TH"),iL(this,"orderViews",new WeakMap),iL(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new UU(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:r,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(l),h=s.obtainOrderView(l);u.appendView(h).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let c=0;c<r;c++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Jd(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Xe(d,[j6(),e4(),Y0(c+1),Zd(-1)]),t[c](a,d,c)}u.end()}}}class q9 extends Kg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+t;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<s;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)r.removeChild(r.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&pa(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Xe(this.rootNode,[XV()]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Xe(o,[BA(),eU(t+1)]);for(let a=-1*s;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),Jd(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Xe(u,[Y0(a+1+this.table.rowHeadersCount),Zd(-1),z6(),...a>=0?[J6()]:[BA()]]),r[t](l,u,t)}}}}let sL=!1;class X9 extends Kg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,r=e+t;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!sL&&e>1e3&&(sL=!0,zt(Yt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<t;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[i+t].style.width=`${o}px`}const r=this.rootNode.firstChild;r&&ue(r,"rowHeader")}}function Q9(n,e,t){return(e=Z9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Z9(n){var e=J9(n,"string");return typeof e=="symbol"?e:e+""}function J9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Tp={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let oL=!1;class e5 extends Kg{constructor(e){super("TR",e),Q9(this,"orderView",void 0),this.orderView=new VU(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!oL&&e>1e3&&(oL=!0,zt(Yt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Xe(this.rootNode,[XV()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var t,r;Xe(s,[BA(),eU(o+((t=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}rt(s,[Tp.rowEven,Tp.rowOdd]),(o+1)%2===0?ue(s,Tp.rowEven):ue(s,Tp.rowOdd)}this.orderView.end()}}function aL(n,e,t){return(e=t5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function t5(n){var e=n5(n,"string");return typeof e=="symbol"?e:e+""}function n5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class r5 extends Kg{constructor(){super("TD"),aL(this,"orderViews",new WeakMap),aL(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new UU(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const h=this.obtainOrderView(u),c=i.obtainOrderView(u);h.prependView(c).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<t;d++){h.render();const f=h.getCurrentNode(),m=this.table.renderedColumnToSource(d);if(Je(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),Jd(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,m,f),this.table.isAriaEnabled()){var s,o;Xe(f,[...f.hasAttribute("role")?[]:[G6()],Zd(-1),Y0(m+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}h.end()}}}function lr(n,e,t){return(e=i5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function i5(n){var e=s5(n,"string");return typeof e=="symbol"?e:e+""}function s5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class o5{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};lr(this,"rootNode",void 0),lr(this,"rootDocument",void 0),lr(this,"rowHeaders",null),lr(this,"columnHeaders",null),lr(this,"colGroup",null),lr(this,"rows",null),lr(this,"cells",null),lr(this,"rowFilter",null),lr(this,"columnFilter",null),lr(this,"rowUtils",null),lr(this,"columnUtils",null),lr(this,"rowsToRender",0),lr(this,"columnsToRender",0),lr(this,"rowHeaderFunctions",[]),lr(this,"rowHeadersCount",0),lr(this,"columnHeaderFunctions",[]),lr(this,"columnHeadersCount",0),lr(this,"cellRenderer",void 0),lr(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:r,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),r.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=r,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let r=0;r<e;r++){const i=t.getRenderedNode(r);if(i.firstChild){const s=this.renderedRowToSource(r),o=this.rowUtils.getHeightByOverlayName(s,this.activeOverlayName);o?i.firstChild.style.height=`${o-1}px`:i.firstChild.style.height=""}}}}class a5{constructor(){let{TABLE:e,THEAD:t,COLGROUP:r,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new o5(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new K9,columnHeaders:new q9(t),colGroup:new X9(r),rows:new e5(i),cells:new r5}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function bf(n,e,t){l5(n,e),e.set(n,t)}function l5(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ap(n,e,t){return(e=u5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function u5(n){var e=h5(n,"string");return typeof e=="symbol"?e:e+""}function h5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $r(n,e){return n.get(BU(n,e))}function Tf(n,e,t){return n.set(BU(n,e),t),t}function BU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Np=new WeakMap,vc=new WeakMap,Af=new WeakMap,Ip=new WeakMap,Hu=new WeakMap;class c5{constructor(e){let{totalColumns:t,stretchMode:r,stretchingColumnWidthFn:i,columnWidthFn:s}=e;Ap(this,"stretchAllRatio",0),Ap(this,"stretchLastWidth",0),Ap(this,"stretchAllColumnsWidth",[]),bf(this,Np,0),Ap(this,"needVerifyLastColumnWidth",!0),bf(this,vc,()=>0),bf(this,Af,o=>o),bf(this,Ip,o=>o),bf(this,Hu,()=>"none"),Tf(vc,this,t),Tf(Hu,this,r),Tf(Af,this,i??$r(Af,this)),Tf(Ip,this,s??$r(Ip,this))}refreshStretching(e){if($r(Hu,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,Tf(Np,this,e);let t=0;for(let i=0;i<$r(vc,this).call(this);i++){const s=this._getColumnWidth(i),o=$r(Af,this).call(this,void 0,i);typeof o=="number"?e-=o:t+=s}const r=e-t;if($r(Hu,this).call(this)==="all"&&r>0)this.stretchAllRatio=e/t,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if($r(Hu,this).call(this)==="last"&&e!==1/0){const i=this._getColumnWidth($r(vc,this).call(this)-1),s=r+i;this.stretchLastWidth=s>=0?s:i}}getStretchedColumnWidth(e,t){let r=null;return $r(Hu,this).call(this)==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,t):$r(Hu,this).call(this)==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,t){let r=0;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(t*this.stretchAllRatio),s=$r(Af,this).call(this,i,e);s===void 0?this.stretchAllColumnsWidth[e]=i:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===$r(vc,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)r+=this.stretchAllColumnsWidth[i];r!==$r(Np,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=$r(Np,this)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===$r(vc,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=$r(Ip,this).call(this,e);return isNaN(t)&&(t=BC),t}}function Mp(n,e,t){return(e=d5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function d5(n){var e=f5(n,"string");return typeof e=="symbol"?e:e+""}function f5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class m5{constructor(e,t){Mp(this,"dataAccessObject",void 0),Mp(this,"wtSettings",void 0),Mp(this,"headerWidths",new Map),Mp(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=t,this.stretching=new c5({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(r,i)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",r,i),columnWidthFn:r=>this.dataAccessObject.wtTable.getColumnWidth(r)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let t=this.getWidth(e);const r=this.stretching.getStretchedColumnWidth(e,t);return r&&(t=r),t}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(t=t?Math.max(t,r):r),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:t,cloneSource:r}=this.dataAccessObject,i=r?r.wtTable.holder:e.holder,s=i.offsetHeight<i.scrollHeight?Tr():0;this.stretching.refreshStretching(t.getViewportWidth()-s)}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),t=e.getSetting("onModifyRowHeaderWidth",t),t!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<r;s++){let o=Array.isArray(t)?t[s]:t;o=o??i,this.headerWidths.set(s,o)}}}}function lL(n,e,t){return(e=g5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function g5(n){var e=p5(n,"string");return typeof e=="symbol"?e:e+""}function p5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class w5{constructor(e,t){lL(this,"dataAccessObject",void 0),lL(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(t=t===void 0?r:Math.max(t,r)),t}getHeightByOverlayName(e,t){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function _o(n,e,t){return(e=v5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function v5(n){var e=y5(n,"string");return typeof e=="symbol"?e:e+""}function y5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class tf{constructor(e,t,r,i,s){_o(this,"wtSettings",null),_o(this,"domBindings",void 0),_o(this,"TBODY",null),_o(this,"THEAD",null),_o(this,"COLGROUP",null),_o(this,"hasTableHeight",!0),_o(this,"hasTableWidth",!0),_o(this,"isTableVisible",!1),_o(this,"tableOffset",0),_o(this,"holderOffset",0),this.domBindings=r,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,iU(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new w5(this.dataAccessObject,this.wtSettings),this.columnUtils=new m5(this.dataAccessObject,this.wtSettings),this.tableRenderer=new a5({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Je(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",t&&t.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Xe(r,[ua()]),r}createHider(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Je(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",t&&t.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Xe(r,[ua()]),r}createHolder(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Je(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",t&&t.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Xe(r.parentNode,[ua()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Xe(r,[ua()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,s=t.getSetting("totalRows"),o=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),l=a.length,u=t.getSetting("columnHeaders"),h=u.length;let c=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=br(this.holder),c=i.createCalculators(c),l&&!t.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(c=!1)}if(c)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=br(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=s>0?this.getFirstRenderedRow():0,m=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new _9(f,s,h),this.columnFilter=new I9(m,o,l);let p=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const v={};this.wtSettings.getSetting("beforeDraw",!0,v),p=v.skipRender!==!0}if(p){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(oa)||this.is(du))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let v;if(this.isMaster&&(v=this.dataAccessObject.workspaceWidth,i.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(oa))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM();const y=gn(this.hider),S=gn(this.TABLE);y!==0&&S!==y&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),v!==i.getWorkspaceWidth()&&(i.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(oa)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(c),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,s=this.getColumnHeaderHeight(r),o=this.getColumnHeader(t,r),o&&(a=fd(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(r[s]){if(!t[s]||t[s].childNodes.length===0)return;t[s].childNodes[0].style.height=`${r[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(oa))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const s=this.rowFilter.renderedToSource(i);t.oversizedRows&&t.oversizedRows[s]&&(t.oversizedRows[s]=void 0)}}}getCell(e){let t=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",t,r);if(i&&Array.isArray(i)&&([t,r]=i),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const s=this.getRow(t);if(!s&&t>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!o&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let t=null,r=null;if(e<0){var i;t=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var s;t=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),r=this.TBODY}return t!==void 0&&r!==void 0?r.childNodes.length<t+1?!1:r.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[t];return r?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[r];s&&t.push(s)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(t>=r)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[s];return a?.childNodes[t]}getRowHeaders(e){const t=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s?.childNodes[i];o&&t.push(o)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=Bh(t,["TD","TH"])),t===null)return null;const r=t.parentNode,i=r.parentNode;let s=g4(r),o=t.cellIndex;return Pu(Yh,t,this.wtRootElement)||Pu(jh,t,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):Pu(du,t,this.wtRootElement)||Pu(oa,t,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s),Pu(Yh,t,this.wtRootElement)||Pu(zh,t,this.wtRootElement)||Pu(du,t,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),r=fd(this.TBODY)-1;let i,s,o,a,l;if(!(t===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,o=this.rowFilter.renderedToSource(e),i=this.getRowHeight(o),a=this.getTrForRow(o),l=a.querySelector("th"),l?s=fd(l):s=fd(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<s||i<s)&&(s+=1,this.dataAccessObject.wtViewport.oversizedRows[o]=s)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return gn(this.TABLE)}getHeight(){return er(this.TABLE)}getTotalWidth(){const e=gn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=er(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Fd(this.TABLE)}_modifyRowHeaderWidth(e){let t=fn(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const C5="stickyRowsBottom",lI={getFirstRenderedRow(){const n=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=n-e;return n===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Cl(lI,"MIXIN_NAME",C5,{writable:!1,enumerable:!1});const S5="stickyColumnsStart",WC={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const n=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),n)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Cl(WC,"MIXIN_NAME",S5,{writable:!1,enumerable:!1});class uI extends tf{constructor(e,t,r,i){super(e,t,r,i,du)}}en(uI,lI);en(uI,WC);const jh="top",oa="bottom",zh="inline_start",Yh="top_inline_start_corner",du="bottom_inline_start_corner",WU=[jh,oa,zh,Yh,du],R5=new Map([[jh,`ht_clone_${jh}`],[oa,`ht_clone_${oa}`],[zh,`ht_clone_${zh} ht_clone_left`],[Yh,`ht_clone_${Yh} ht_clone_top_left_corner`],[du,`ht_clone_${du} ht_clone_bottom_left_corner`]]);function E5(n,e){b5(n,e),e.add(n)}function b5(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function T5(n,e,t){return(e=A5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function A5(n){var e=N5(n,"string");return typeof e=="symbol"?e:e+""}function N5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Op(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Nf=new WeakSet;class I5{constructor(e){E5(this,Nf),T5(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,r,i,s){const o=this.scrollViewportHorizontally(e.col,r,s),a=this.scrollViewportVertically(e.row,t,i);return o||a}scrollViewportHorizontally(e,t,r){const{drawn:i,totalColumns:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=t===void 0&&r===void 0,{fixedColumnsStart:a,inlineStartOverlay:l}=this.dataAccessObject;if(o&&e<a||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>s))return!1;const u=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn();let c=!1;return(o&&(e<u||e>h)||!o)&&(c=l.scrollTo(e,o?e>=this.getLastPartiallyVisibleColumn():t)),c}scrollViewportVertically(e,t,r){const{drawn:i,totalRows:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=t===void 0&&r===void 0,{fixedRowsBottom:a,fixedRowsTop:l,topOverlay:u}=this.dataAccessObject;if(o&&(e<l||e>s-a-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>s))return!1;const h=this.getFirstVisibleRow(),c=this.getLastVisibleRow();let d=!1;return(o&&(e<h||e>c)||!o)&&(d=u.scrollTo(e,o?e>=this.getLastPartiallyVisibleRow():r)),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Op(Nf,this,hL).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Op(Nf,this,hL).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Op(Nf,this,uL).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Op(Nf,this,uL).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function uL(n){const{wtSettings:e,inlineStartOverlay:t,wtTable:r,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(t.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const h=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(h.right-d)}else l=br(r.wtRootElement).left;const u=Math.abs(oU(o,o));if(l>u){const h=aU(o);let c=i.getRowHeaderWidth();for(let d=1;d<=s;d++)if(c+=t.sumCellSizes(d-1,d),l+c-u>=h){n=d-2;break}}}return n}function hL(n){const{topOverlay:e,wtTable:t,wtViewport:r,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=br(t.wtRootElement),a=X0(s,s);if(o.top>a){const l=fd(s);let u=r.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(u+=e.sumCellSizes(h-1,h),o.top+u-a>=l){n=h-2;break}}}return n}function Gs(n,e,t){return(e=M5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function M5(n){var e=O5(n,"string");return typeof e=="symbol"?e:e+""}function O5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class hI{get eventManager(){return new Co(this)}constructor(e,t){Gs(this,"wtTable",void 0),Gs(this,"wtScroll",void 0),Gs(this,"wtViewport",void 0),Gs(this,"wtOverlays",void 0),Gs(this,"selectionManager",void 0),Gs(this,"wtEvent",void 0),Gs(this,"guid",`wt_${YV()}`),Gs(this,"drawInterrupted",!1),Gs(this,"drawn",!1),Gs(this,"domBindings",void 0),Gs(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new I5(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;t<r;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,r){Wh(r,e[t])}])}}createCellCoords(e,t){return new Gh(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,r){return new Yg(e,t,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=r-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,r,i,s){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,r,i,s)}scrollViewportHorizontally(e,t,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function cL(n,e,t){return(e=_5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _5(n){var e=x5(n,"string");return typeof e=="symbol"?e:e+""}function x5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class P5 extends hI{constructor(e,t,r){super(e,t),cL(this,"cloneSource",void 0),cL(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new kU(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function L5(n,e,t){return(e=D5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function D5(n){var e=H5(n,"string");return typeof e=="symbol"?e:e+""}function H5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class qg{constructor(e,t,r,i,s){L5(this,"wtSettings",null),Cl(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=t,this.wtSettings=i;const{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=h,this.trimmingContainer=kd(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=kd(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=ty(e.TABLE)}getRelativeCellPosition(e,t,r){if(this.clone.wtTable.holder.contains(e)===!1){zt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=r<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(e),top:e.offsetTop};let c=null;return i?c=this.getRelativeCellPositionWithinWindow(o,s,h,u):c=this.getRelativeCellPositionWithinHolder(o,a,s,h,u),c}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,r,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!t)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+Tr())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:r.start+o,top:r.top+a}}getRelativeCellPositionWithinHolder(e,t,r,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=o.horizontal-s.start),t){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(WU.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=r.createElement("div"),o=r.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${R5.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,t.getSetting("ariaTags")&&Xe(s,[ua()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===jh||u==="vertical"&&this.type===zh?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=ty(e.TABLE),new P5(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,r=e.style,i=t.style,s=e.parentNode.style;[r,i,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class F5 extends qg{constructor(e,t,r,i,s,o){super(e,t,du,r,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new uI(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${s}px`,t.style.bottom=`${o}px`}else kC(t),this.repositionOverlay();let r=er(this.clone.wtTable.TABLE);const i=gn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),t.style.height=`${r}px`,t.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;t.hasVerticalScroll()||(s+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(s+=Tr(r)),i.style.bottom=`${s}px`}}const k5="calculatedColumns",$C={getFirstRenderedColumn(){const n=this.dataAccessObject.startColumnRendered;return n===null?-1:n},getFirstVisibleColumn(){const n=this.dataAccessObject.startColumnVisible;return n===null?-1:n},getFirstPartiallyVisibleColumn(){const n=this.dataAccessObject.startColumnPartiallyVisible;return n===null?-1:n},getLastRenderedColumn(){const n=this.dataAccessObject.endColumnRendered;return n===null?-1:n},getLastVisibleColumn(){const n=this.dataAccessObject.endColumnVisible;return n===null?-1:n},getLastPartiallyVisibleColumn(){const n=this.dataAccessObject.endColumnPartiallyVisible;return n===null?-1:n},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Cl($C,"MIXIN_NAME",k5,{writable:!1,enumerable:!1});class cI extends tf{constructor(e,t,r,i){super(e,t,r,i,oa)}}en(cI,lI);en(cI,$C);function V5(n,e,t){return(e=U5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function U5(n){var e=B5(n,"string");return typeof e=="symbol"?e:e+""}function B5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class W5 extends qg{constructor(e,t,r,i){super(e,t,oa,r,i),V5(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new cI(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),t.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;t.hasVerticalScroll()||(s+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(s+=Tr(r)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.mainTableScrollableElement===t?(t.scrollTo(q0(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:r,wtSettings:i}=this.wot,s=i.getSetting("defaultRowHeight");let o=e,a=0;for(;o<t;){const l=r.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=Tr(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let h=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,e.wtRootElement.scrollWidth),a.width=`${h}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=er(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let r=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;t&&s.offsetHeight!==s.clientHeight&&(o=Tr(this.domBindings.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=o,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return X0(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==t,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((r||t===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=Je(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(ue(o,"innerBorderBottom"),s=!a):(rt(o,"innerBorderBottom"),s=a)}return s}}const $5="calculatedRows",dI={getFirstRenderedRow(){const n=this.dataAccessObject.startRowRendered;return n===null?-1:n},getFirstVisibleRow(){const n=this.dataAccessObject.startRowVisible;return n===null?-1:n},getFirstPartiallyVisibleRow(){const n=this.dataAccessObject.startRowPartiallyVisible;return n===null?-1:n},getLastRenderedRow(){const n=this.dataAccessObject.endRowRendered;return n===null?-1:n},getLastVisibleRow(){const n=this.dataAccessObject.endRowVisible;return n===null?-1:n},getLastPartiallyVisibleRow(){const n=this.dataAccessObject.endRowPartiallyVisible;return n===null?-1:n},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Cl(dI,"MIXIN_NAME",$5,{writable:!1,enumerable:!1});class fI extends tf{constructor(e,t,r,i){super(e,t,r,i,zh)}}en(fI,dI);en(fI,WC);const G5="localHooks",Br={_localHooks:Object.create(null),addLocalHook(n,e){return this._localHooks[n]||(this._localHooks[n]=[]),this._localHooks[n].push(e),this},runLocalHooks(n,e,t,r,i,s,o){if(this._localHooks[n]){const a=this._localHooks[n].length;for(let l=0;l<a;l++)WA(this._localHooks[n][l],this,e,t,r,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};Cl(Br,"MIXIN_NAME",G5,{writable:!1,enumerable:!1});let $U=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};en($U,Br);const GU="active-header",mI="header",gI="area",pI="focus",j5="fill",z5="row",Y5="column",K5="custom-selection",wI=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var dL={},fL;function q5(){if(fL)return dL;fL=1;var n=rI();return n("flat"),dL}q5();function X5(n,e){jU(n,e),e.add(n)}function mL(n,e,t){jU(n,e),e.set(n,t)}function jU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yn(n,e){return n.get(Am(n,e))}function gL(n,e,t){return n.set(Am(n,e),t),t}function Am(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var js=new WeakMap,bi=new WeakMap,_p=new WeakSet;class Q5{constructor(){X5(this,_p),mL(this,js,void 0),mL(this,bi,void 0)}setActiveOverlay(e){return gL(bi,this,e),this}setActiveSelection(e){return gL(js,this,e),this}scan(){const e=Yn(js,this).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r))):e==="area"?this.scanCellsRange(r=>t.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r)),this.scanCellsRange(r=>t.add(r))):e==="fill"?this.scanCellsRange(r=>t.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>t.add(r)),this.scanRowsInCellsRange(r=>t.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanColumnsInCellsRange(r=>t.add(r))),t}scanColumnsInHeadersRange(e){const[t,r,i,s]=Yn(js,this).getCorners(),{wtTable:o}=Yn(bi,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let u=0;for(let h=-o.getRowHeadersCount();h<a;h++){const c=o.columnFilter.renderedToSource(h);if(!(c<r||c>s)){for(let d=-l;d<0;d++){if(d<t||d>i)continue;const f=d+l;let m=o.getColumnHeader(c,f);const p=Yn(bi,this).getSetting("onBeforeHighlightingColumnHeader",c,f,{selectionType:Yn(js,this).settings.selectionType,columnCursor:u,selectionWidth:s-r+1});p!==null&&(p!==c&&(m=o.getColumnHeader(p,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[t,r,i,s]=Yn(js,this).getCorners(),{wtTable:o}=Yn(bi,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let u=0;for(let h=-o.getColumnHeadersCount();h<a;h++){const c=o.rowFilter.renderedToSource(h);if(!(c<t||c>i)){for(let d=-l;d<0;d++){if(d<r||d>s)continue;const f=d+l;let m=o.getRowHeader(c,f);const p=Yn(bi,this).getSetting("onBeforeHighlightingRowHeader",c,f,{selectionType:Yn(js,this).settings.selectionType,rowCursor:u,selectionHeight:i-t+1});p!==null&&(p!==c&&(m=o.getRowHeader(p,f)),e(m))}u+=1}}}scanCellsRange(e){const[t,r,i,s]=Yn(js,this).getCorners(),{wtTable:o}=Yn(bi,this);Am(_p,this,Sb).call(this,(a,l)=>{if(a>=t&&a<=i&&l>=r&&l<=s){const u=o.getCell(Yn(bi,this).createCellCoords(a,l)),h=Yn(bi,this).getSetting("onAfterDrawSelection",a,l,Yn(js,this).settings.layerLevel);typeof h=="string"&&ue(u,h),e(u)}})}scanRowsInCellsRange(e){const[t,,r]=Yn(js,this).getCorners(),{wtTable:i}=Yn(bi,this);Am(_p,this,Sb).call(this,(s,o)=>{if(s>=t&&s<=r){const a=i.getCell(Yn(bi,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,t,,r]=Yn(js,this).getCorners(),{wtTable:i}=Yn(bi,this);Am(_p,this,Sb).call(this,(s,o)=>{if(o>=t&&o<=r){const a=i.getCell(Yn(bi,this).createCellCoords(s,o));e(a)}})}}function Sb(n){const{wtTable:e}=Yn(bi,this),t=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<t;i+=1){const s=e.rowFilter.renderedToSource(i);for(let o=0;o<r;o+=1)n(s,e.columnFilter.renderedToSource(o))}}class pL{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=wI,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,r=this.main.childNodes.length;t<r;t++){const i=this.main.childNodes[t];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),To(e);const r=this,i=this.wot.rootDocument.body,s=t.getBoundingClientRect();t.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),t.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=t.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),iu()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=t.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};gt(i,(o,a)=>{this.selectionHandles.styles.bottomHitArea[a]=o,this.selectionHandles.styles.topHitArea[a]=o});const s={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};gt(s,(o,a)=>{this.selectionHandles.styles.bottom[a]=o,this.selectionHandles.styles.top[a]=o}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||t!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,r,i,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:h,bottom:c,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),p=parseInt(h.width,10),v=this.wot.wtTable.getWidth(),y=this.wot.wtTable.getHeight();u.top=`${parseInt(r-m-1,10)}px`,u[l]=`${parseInt(i-m-1,10)}px`,h.top=`${parseInt(r-p/4*3,10)}px`,h[l]=`${parseInt(i-p/4*3,10)}px`;const S=Math.min(parseInt(i+s,10),v-m-f*2),R=Math.min(parseInt(i+s-p/4,10),v-p-f*2);c[l]=`${S}px`,d[l]=`${R}px`;const T=Math.min(parseInt(r+o,10),y-m-f*2),I=Math.min(parseInt(r+o-p/4,10),y-p-f*2);c.top=`${T}px`,d.top=`${I}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",h.display="block",this.isPartRange(e,t)?(c.display="none",d.display="none"):(c.display="block",d.display="block")):(u.display="none",c.display="none",h.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",h.zIndex="9999"):(u.zIndex="",h.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:r,rootWindow:i}=this.wot;let s,o,a,l,u,h;const c=t.getRenderedRowsCount();for(let Se=0;Se<c;Se+=1){const pe=t.rowFilter.renderedToSource(Se);if(pe>=e[0]&&pe<=e[2]){s=pe,u=e[0];break}}for(let Se=c-1;Se>=0;Se-=1){const pe=t.rowFilter.renderedToSource(Se);if(pe>=e[0]&&pe<=e[2]){o=pe;break}}const d=t.getRenderedColumnsCount();for(let Se=0;Se<d;Se+=1){const pe=t.columnFilter.renderedToSource(Se);if(pe>=e[1]&&pe<=e[3]){a=pe,h=e[1];break}}for(let Se=d-1;Se>=0;Se-=1){const pe=t.columnFilter.renderedToSource(Se);if(pe>=e[1]&&pe<=e[3]){l=pe;break}}if(s===void 0||a===void 0){this.disappear();return}let f=t.getCell(this.wot.createCellCoords(s,a));const m=s!==o||a!==l,p=m?t.getCell(this.wot.createCellCoords(o,l)):f,v=br(f),y=m?br(p):v,S=br(t.TABLE),R=gn(t.TABLE),T=v.top,I=v.left,H=this.wot.wtSettings.getSetting("rtlMode");let k=0,W=0;if(H){const Se=gn(f),pe=i.innerWidth-S.left-R;W=I+Se-y.left,k=i.innerWidth-I-Se-pe-1}else W=y.left+gn(p)-I,k=I-S.left-1;if(this.isEntireColumnSelected(s,o)){const Se=this.getDimensionsFromHeader("columns",a,l,u,S);let pe=null;Se&&([pe,k,W]=Se),pe&&(f=pe)}let Y=T-S.top-1,$=y.top+er(p)-T;if(this.isEntireRowSelected(a,l)){const Se=this.getDimensionsFromHeader("rows",s,o,h,S);let pe=null;Se&&([pe,Y,$]=Se),pe&&(f=pe)}const q=fl(f,i);parseInt(q.borderTopWidth,10)>0&&(Y+=1,$=$>0?$-1:0),parseInt(q[H?"borderRightWidth":"borderLeftWidth"],10)>0&&(k+=1,W=W>0?W-1:0);const J=H?"right":"left";this.topStyle.top=`${Y}px`,this.topStyle[J]=`${k}px`,this.topStyle.width=`${W}px`,this.topStyle.display="block",this.startStyle.top=`${Y}px`,this.startStyle[J]=`${k}px`,this.startStyle.height=`${$}px`,this.startStyle.display="block";const re=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Y+$-re}px`,this.bottomStyle[J]=`${k}px`,this.bottomStyle.width=`${W}px`,this.bottomStyle.display="block",this.endStyle.top=`${Y}px`,this.endStyle[J]=`${k+W-re}px`,this.endStyle.height=`${$+1}px`,this.endStyle.display="block";let ie=this.settings.border.cornerVisible;ie=typeof ie=="function"?ie(this.settings.layerLevel):ie;const ae=this.wot.getSetting("onModifyGetCellCoords",o,l);let[Ve,De]=[o,l];if(ae&&Array.isArray(ae)&&([,,Ve,De]=ae),iu()||!ie||this.isPartRange(Ve,De))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Y+$+this.cornerCenterPointOffset-1}px`,this.cornerStyle[J]=`${k+W+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Se=kd(t.TABLE);const pe=Se===i;pe&&(Se=r.documentElement);const ze=parseInt(this.cornerDefaultStyle.width,10)/2,w=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const C=pe?p.getBoundingClientRect().left:p.offsetLeft;let b=!1,P=0;H?(P=C-parseInt(this.cornerDefaultStyle.width,10)/2,b=P<0):(P=C+gn(p)+parseInt(this.cornerDefaultStyle.width,10)/2,b=P>=aU(Se)),b&&(this.cornerStyle[J]=`${Math.floor(k+W+this.cornerCenterPointOffset-ze)}px`,this.cornerStyle[H?"borderLeftWidth":"borderRightWidth"]=0)}o===this.wot.getSetting("totalRows")-1&&(pe?p.getBoundingClientRect().top:p.offsetTop)+er(p)+parseInt(this.cornerDefaultStyle.height,10)/2>=fd(Se)&&(this.cornerStyle.top=`${Math.floor(Y+$+this.cornerCenterPointOffset-w)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}iu()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(o,l,Y,k,W,$)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,r,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,u=null,h=null,c=null,d=null,f=null,m=null,p=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return er(...arguments)},h="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return gn(...arguments)},h="ht__selection--columns",f="left";break}if(a.classList.contains(h)){const v=this.wot.getSetting("columnHeaders").length;if(m=l(t,v-i),p=l(r,v-i),!m||!p)return!1;const y=br(m),S=br(p);return m&&p&&(c=y[f]-s[f]-1,d=S[f]+u(p)-y[f]),[m,c,d]}return!1}changeBorderStyle(e,t){const r=this[e].style,i=t[e];!i||i.hide?ue(this[e],"hidden"):(Je(this[e],"hidden")&&rt(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},r=this[e].style;r.backgroundColor=t.color,r.width=`${t.width}px`,r.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?ue(this[e],"hidden"):rt(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",iu()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function Z5(n,e){zU(n,e),e.add(n)}function yc(n,e,t){zU(n,e),e.set(n,t)}function zU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(n,e){return n.get(vI(n,e))}function wL(n,e,t){return n.set(vI(n,e),t),t}function vI(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Yr=new WeakMap,Ni=new WeakMap,Rb=new WeakMap,mm=new WeakMap,Eb=new WeakMap,Fu=new WeakMap,vL=new WeakSet;class J5{constructor(e){Z5(this,vL),yc(this,Yr,void 0),yc(this,Ni,void 0),yc(this,Rb,new Q5),yc(this,mm,new WeakMap),yc(this,Eb,new WeakSet),yc(this,Fu,new Map),wL(Ni,this,e)}setActiveOverlay(e){return wL(Yr,this,e),vt(Rb,this).setActiveOverlay(vt(Yr,this)),vt(mm,this).has(vt(Yr,this))||vt(mm,this).set(vt(Yr,this),new Set),this}getFocusSelection(){return vt(Ni,this)!==null?vt(Ni,this).getFocus():null}getAreaSelection(){return vt(Ni,this)!==null?vt(Ni,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(vt(Fu,this).has(e)){const r=vt(Fu,this).get(e);if(r.has(vt(Yr,this)))return r.get(vt(Yr,this));const i=new pL(vt(Yr,this),e.settings);return r.set(vt(Yr,this),i),i}const t=new pL(vt(Yr,this),e.settings);return vt(Fu,this).set(e,new Map([[vt(Yr,this),t]])),t}getBorderInstances(e){var t,r;return Array.from((t=(r=vt(Fu,this).get(e))===null||r===void 0?void 0:r.values())!==null&&t!==void 0?t:[])}destroyBorders(e){vt(Fu,this).get(e).forEach(t=>t.destroy()),vt(Fu,this).delete(e)}render(e){if(vt(Ni,this)===null)return;e&&vI(vL,this,e8).call(this);const t=Array.from(vt(Ni,this)),r=new Map,i=new Map;for(let s=0;s<t.length;s++){const o=t[s],{className:a,headerAttributes:l,createLayers:u,selectionType:h}=o.settings;vt(Eb,this).has(o)||(vt(Eb,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const c=this.getBorderInstance(o);if(o.isEmpty()){c?.disappear();continue}a&&vt(Rb,this).setActiveSelection(o).scan().forEach(m=>{if(r.has(m)){const p=r.get(m);p.has(a)&&u===!0?p.set(a,p.get(a)+1):p.set(a,1)}else r.set(m,new Map([[a,1]]));l&&(i.has(m)||i.set(m,[]),m.nodeName==="TH"&&i.get(m).push(...l))});const d=o.getCorners();vt(Yr,this).getSetting("onBeforeDrawBorders",d,h),c?.appear(d)}r.forEach((s,o)=>{var a;const l=Array.from(s).map(u=>{let[h,c]=u;return c===1?h:[h,...Array.from({length:c-1},(d,f)=>`${h}-${f+1}`)]}).flat();l.forEach(u=>vt(mm,this).get(vt(Yr,this)).add(u)),ue(o,l),o.nodeName==="TD"&&Array.isArray((a=vt(Ni,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Xe(o,vt(Ni,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{Xe(s,[...i.get(s)])})}}function e8(){const n=vt(mm,this).get(vt(Yr,this)),e=vt(Yr,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let t=0;t<e.length;t++)n.add(e[t]);n.forEach(t=>{var r,i;const s=vt(Yr,this).wtTable.TABLE.querySelectorAll(`.${t}`);let o=[];Array.isArray((r=vt(Ni,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(o=vt(Ni,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=vt(Ni,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(o=[...o,...vt(Ni,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)rt(s[a],t),Jd(s[a],o)}),n.clear()}class t8 extends qg{constructor(e,t,r,i){super(e,t,zh,r,i)}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new fI(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===t&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),Q0(r,`${s}px`,"0px")):(s=this.getScrollPosition(),kC(r));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,sU(t)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<t;)s+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,i=Tr(t),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=gn(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(wI.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&i.length>0&&!Je(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),h=0;if(t){const c=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();c>d&&(t=!1)}return t&&a.offsetWidth!==a.clientWidth&&(h=Tr(this.domBindings.rootDocument)),t?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=h,v4(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(oU(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,r=this.wot.wtTable.holder.parentNode,i=t.getSetting("rowHeaders"),s=t.getSetting("fixedColumnsStart"),o=t.getSetting("totalRows"),a=t.getSetting("preventOverflow")==="vertical";o?rt(r,"emptyRows"):ue(r,"emptyRows");let l=!1;if(!a){if(s&&!i.length)ue(r,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const u=Je(r,"innerBorderInlineStart");e?(ue(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(rt(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const n8="stickyRowsTop",yI={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Cl(yI,"MIXIN_NAME",n8,{writable:!1,enumerable:!1});class CI extends tf{constructor(e,t,r,i){super(e,t,r,i,Yh)}}en(CI,yI);en(CI,WC);function yL(n,e,t){return(e=r8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function r8(n){var e=i8(n,"string");return typeof e=="symbol"?e:e+""}function i8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class s8 extends qg{constructor(e,t,r,i,s,o){super(e,t,Yh,r,i),yL(this,"topOverlay",void 0),yL(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new CI(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();Q0(e,`${i}px`,`${s}px`)}else kC(e);let t=er(this.clone.wtTable.TABLE);const r=gn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${r}px`,!1}}class SI extends tf{constructor(e,t,r,i){super(e,t,r,i,jh)}}en(SI,yI);en(SI,$C);function o8(n,e,t){return(e=a8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function a8(n){var e=l8(n,"string");return typeof e=="symbol"?e:e+""}function l8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class u8 extends qg{constructor(e,t,r,i){super(e,t,jh,r,i),o8(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new SI(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===t&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),h=e.offsetHeight;s=u===h,i=this.getOverlayOffset(),Q0(e,"0px",`${i}px`)}else i=this.getScrollPosition(),kC(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const t=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(q0(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,s=0;for(;i<t;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?r:o,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,i=Tr(t),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=er(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(wI.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:r,wtSettings:i}=this,o=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!Je(o.parentNode,"innerBorderTop")?1:0;let h=this.getTableParentOffset(),c=0;if(t){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(t=!1)}if(t&&o.offsetHeight!==o.clientHeight&&(c=Tr(this.domBindings.rootDocument)),t){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");h+=this.sumCellSizes(0,e+1),h-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),h+=1,h+=u}else h+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return h+=c,w4(this.mainTableScrollableElement)===h-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(h)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return X0(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,s=r.getSetting("totalColumns"),o=r.getSetting("preventOverflow")==="horizontal";s?rt(i,"emptyColumns"):ue(i,"emptyColumns");let a=!1;if(!t&&!o){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,h=r.getSetting("columnHeaders");if((u||l===0)&&h.length>0){const c=Je(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(ue(i,"innerBorderTop"),a=!c):(rt(i,"innerBorderTop"),a=c)}}return a}}function xp(n,e,t){h8(n,e),e.set(n,t)}function h8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _a(n,e,t){return(e=c8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function c8(n){var e=d8(n,"string");return typeof e=="symbol"?e:e+""}function d8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ku(n,e,t){return n.set(YU(n,e),t),t}function xa(n,e){return n.get(YU(n,e))}function YU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Cc=new WeakMap,Pp=new WeakMap,Sc=new WeakMap,Lp=new WeakMap;class f8{constructor(e,t,r,i,s,o){_a(this,"wot",null),xp(this,Cc,[]),_a(this,"topOverlay",null),_a(this,"bottomOverlay",null),_a(this,"inlineStartOverlay",null),_a(this,"topInlineStartCornerOverlay",null),_a(this,"bottomInlineStartCornerOverlay",null),_a(this,"browserLineHeight",void 0),_a(this,"wtSettings",null),xp(this,Pp,!1),xp(this,Sc,0),xp(this,Lp,null),_a(this,"resizeObserver",new ResizeObserver(h=>{tI(()=>{!Array.isArray(h)||!h.length||(ku(Sc,this,xa(Sc,this)+1),xa(Sc,this)===100&&(zt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),xa(Lp,this)!==null&&clearTimeout(xa(Lp,this)),ku(Lp,this,setTimeout(()=>{ku(Sc,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=t,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=Tr(a);const u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:ty(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[...xa(Cc,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,r=e.getComputedStyle(t.body),i=parseInt(r.lineHeight,10),s=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new u8(...e),this.bottomOverlay=new W5(...e),this.inlineStartOverlay=new t8(...e),this.topInlineStartCornerOverlay=new s8(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new F5(...e,this.bottomOverlay,this.inlineStartOverlay),ku(Cc,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){ku(Pp,this,xa(Cc,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),xa(Cc,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),xa(Cc,this).forEach(e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",c=>this.onKeyDown(c)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",c=>this.onTableScroll(c),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",c=>this.onTableScroll(c),{passive:!0});const s=t.devicePixelRatio&&t.devicePixelRatio>1,o=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!gU())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",c=>this.onCloneWheel(c,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(c=>{if(c&&c.needFullRender){const{holder:d}=c.clone.wtTable;this.eventManager.addEventListener(d,"wheel",f=>this.onCloneWheel(f,a),l)}});let h;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(h),h=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),ku(Sc,this,0)},200)}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==t&&s!==t&&!e.target.contains(i)||r!==t&&s!==t&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==r&&o!==r&&!o.contains(s),l=i!==r&&o!==r&&!o.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=zg(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,t+=t*this.browserLineHeight);const i=this.scrollVertically(t),s=this.scrollHorizontally(r);return i||s}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){if(!xa(Pp,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),ku(Pp,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=ty(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,r=e.clientHeight,i=t!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,h=a+this.inlineStartOverlay.sumCellSizes(0,s),d=t.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-t.holder.clientHeight),m=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,h-t.holder.clientWidth),p=f()?1:0,v=m()?1:0;if(d.width=`${h+v}px`,d.height=`${u+p}px`,this.scrollbarSize>0){const{scrollHeight:y,scrollWidth:S}=t.wtRootElement,{scrollHeight:R,scrollWidth:T}=t.holder;this.hasScrollbarRight=y<R,this.hasScrollbarBottom=S<T,this.hasScrollbarRight&&t.hider.scrollWidth+this.scrollbarSize>S?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&t.hider.scrollHeight+this.scrollbarSize>y&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return D(t,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];D(t,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function CL(n,e,t){return(e=m8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function m8(n){var e=g8(n,"string");return typeof e=="symbol"?e:e+""}function g8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class p8{constructor(e){CL(this,"settings",{}),CL(this,"defaults",Object.freeze(this.getDefaults())),gt(this.defaults,(t,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(t===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,r)=>{const i=this.getSetting("data",e,t);Wh(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return t===void 0?gt(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=t,this}getSetting(e,t,r,i,s){return typeof this.settings[e]=="function"?this.settings[e](t,r,i,s):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class RI extends tf{constructor(e,t,r,i){super(e,t,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=kd(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=og(e,"height",t),s=og(e,"overflow",t),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,h=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(s)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(fl(d,t).height,10);r.removeChild(d),f===0&&(h=0)}h=Math.min(h,l),o.height=i==="auto"?"auto":`${h}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:h>0,this.hasTableWidth=u>0}this.isTableVisible=Fd(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,r="master",s=e.getSetting("columnHeaders").length;if(s&&!t.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let h=-1*a;h<l;h++)this.markIfOversizedColumnHeader(h);t.hasOversizedColumnHeadersMarked[r]=!0}}}en(RI,dI);en(RI,$C);class w8{constructor(e,t,r,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=r,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new s9:new a9],["fullyVisible",()=>new qX],["partiallyVisible",()=>new xU]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new n9:new o9],["fullyVisible",()=>new zX],["partiallyVisible",()=>new _U]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return t===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=er(t)>0&&t.clientHeight>0?t.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=t.documentElement.offsetWidth,o=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),h=l?u.right-s:u.left,c=s-h;let d,f;if(a)return gn(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(c,s):d=Math.min(this.getContainerFillWidth(),c,s),i===r&&o>0&&this.sumColumnWidths(0,o-1)>d)return t.documentElement.clientWidth;if(i!==r&&(f=og(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),f==="scroll"||f==="hidden"||f==="auto"))return Math.max(d,i.clientWidth);const m=e.getSetting("stretchH");return m==="none"||!m?Math.max(d,gn(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let r=0,i=e;for(;i<t;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const r=t.offsetWidth;return this.containerWidth=r,e.removeChild(t),r}getWorkspaceOffset(){return br(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=er(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=t.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=t.length;i<s;i++)r?(this.rowHeaderWidth+=gn(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let i=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=t.getSetting("fixedRowsTop"),u=t.getSetting("fixedRowsBottom"),h=t.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(h-u,h),i-=o),r.holder.clientHeight===r.holder.offsetHeight?s=0:s=Tr(this.domBindings.rootDocument),new g9({calculationTypes:e.map(c=>[c,this.rowsCalculatorTypes.get(c)()]),viewportHeight:i,scrollOffset:a,totalRows:t.getSetting("totalRows"),rowHeightFn:c=>r.getRowHeight(c),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=t.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Tr(this.domBindings.rootDocument)),new d9({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:s,totalColumns:t.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const s=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!t.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:r}=e;if(t===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:s}=this.rowsRenderCalculator;return t<i||t===i&&t>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:r}=e;if(t===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:s}=this.columnsRenderCalculator;return t<i||t===i&&t>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){gt(this.hasOversizedColumnHeadersMarked,(e,t,r)=>{r[t]=void 0})}}class v8 extends hI{constructor(e,t){super(e,new p8(t));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new RI(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new w8(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new J5(this.wtSettings.getSetting("selections")),this.wtEvent=new kU(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new f8(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],r=[];gt(e,(i,s)=>{this.wtSettings.getSetting(s).length&&r.push(i),t.push(i)}),rt(this.wtTable.wtRootElement.parentNode,t),ue(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var t;if(!WU.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(t=this.wtOverlays[`${r}Overlay`])!==null&&t!==void 0?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class EI{constructor(e){e instanceof hI?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const r=new EI(t);return()=>r},this._wot=new v8(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,r){return this._wot.createCellRange(e,t,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,r,i,s){return this._wot.scrollViewport(e,t,r,i,s)}scrollViewportHorizontally(e,t,r){return this._wot.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wot.scrollViewportVertically(e,t,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,r,i,s){return this._wot.wtSettings.getSetting(e,t,r,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function SL(n){let{isShiftKey:e,isLeftClick:t,isRightClick:r,coords:i,selection:s,controller:o,cellCoordsFactory:a}=n;const l=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),h=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(u||h)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):h&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!u&&!h&&i.col<0||u&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!h&&i.row<0||h&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const c=!s.inInSelection(i),d=t||r&&c;i.row<0&&i.col>=0&&!o.column?d&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?d&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?d&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function y8(n){let{isLeftClick:e,coords:t,selection:r,controller:i,cellCoordsFactory:s}=n;if(!e)return;const o=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(s(u-1,t.col)):o&&!i.row?r.setRangeEnd(s(t.row,l-1)):i.cell||r.setRangeEnd(t),r.markEndSource()}const C8=new Map([["mousedown",SL],["mouseover",y8],["touchstart",SL]]);function RL(n,e){let{coords:t,selection:r,controller:i,cellCoordsFactory:s}=e;C8.get(n.type)({coords:t,selection:r,controller:i,cellCoordsFactory:s,isShiftKey:n.shiftKey,isLeftClick:nI(n)||n.type==="touchstart",isRightClick:$h(n)})}const KU=new WeakMap,bI=Symbol("rootInstance");function S8(n){KU.set(n,!0)}function R8(n){return n===bI}function vv(n){return KU.has(n)}function E8(n,e){qU(n,e),e.add(n)}function Vu(n,e,t){qU(n,e),e.set(n,t)}function qU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Il(n,e,t){return(e=b8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function b8(n){var e=T8(n,"string");return typeof e=="symbol"?e:e+""}function T8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function wr(n,e){return n.get(lg(n,e))}function us(n,e,t){return n.set(lg(n,e),t),t}function lg(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var bb=new WeakMap,Dp=new WeakMap,Hp=new WeakMap,Pa=new WeakMap,zs=new WeakMap,Tb=new WeakMap,Ab=new WeakMap,yv=new WeakSet;class A8{constructor(e){E8(this,yv),Il(this,"hot",void 0),Il(this,"eventManager",void 0),Il(this,"settings",void 0),Il(this,"THEAD",void 0),Il(this,"TBODY",void 0),Il(this,"_wt",void 0),Il(this,"activeWt",void 0),Vu(this,bb,0),Vu(this,Dp,0),Il(this,"postponedAdjustElementsSize",!1),Vu(this,Hp,!1),Vu(this,Pa,void 0),Vu(this,zs,void 0),Vu(this,Tb,0),Vu(this,Ab,0),this.hot=e,this.eventManager=new Co(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const r=this._wt.getCell(e,t);return r<0?null:r}scrollViewport(e,t,r,i,s){return this._wt.scrollViewport(e,t,r,i,s)}scrollViewportHorizontally(e,t,r){return this._wt.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wt.scrollViewportVertically(e,t,r)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),ue(e,"handsontable"),us(zs,this,t.createElement("TABLE")),ue(wr(zs,this),"htCore"),this.hot.getSettings().tableClassName&&ue(wr(zs,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Xe(wr(zs,this),[ua()]),Xe(e,[$6(),JV(-1),HC(this.hot.countCols()),r4()])),this.THEAD=t.createElement("THEAD"),wr(zs,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),wr(zs,this).appendChild(this.TBODY),this.hot.table=wr(zs,this),this.hot.container.insertBefore(wr(zs,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:r,rootWindow:i}=this.hot,s=t.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{us(Hp,this,!0),this.isTextSelectionAllowed(a.target)||(E1(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{us(Hp,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{wr(Hp,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&E1(i),a.preventDefault())}),this.eventManager.addEventListener(s,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(s,"mouseup",a=>{r.isInProgress()&&nI(a)&&r.finish(),us(Pa,this,!1);const l=uU(t.activeElement);wv(t.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!$h(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",a=>{r.isInProgress()&&$h(a)&&(r.finish(),us(Pa,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{r.isInProgress()&&r.finish(),us(Pa,this,!1)}),this.eventManager.addEventListener(s,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,h=a.y||a.clientY;let c=a.target;if(wr(Pa,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(c===d){const m=Tr(t);if(t.elementFromPoint(u+m,h)!==d||t.elementFromPoint(u,h+m)!==d)return}else for(;c!==s;){if(c===null){if(a.isTargetWebComponent)break;return}if(c===e)return;c=c.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=Hd(i);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=Hd(o);this.eventManager.addEventListener(wr(zs,this),"selectstart",a=>{this.settings.fragmentSelection||wv(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,r))}translateFromRenderableToVisualIndex(e,t){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return r===null&&(r=e),i===null&&(i=t),[r,i]}countRenderableIndexes(e,t){const r=Math.min(e.getNotTrimmedIndexesLength(),t),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,r,i){if(isNaN(e)||e<0)return 0;const s=r.getNearestNotHiddenIndex(e,t),o=r.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return t<0?a=o+1:t>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let r=0;for(let i=e;i<=t;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,t){let r=0;for(let i=e;i<=t;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:wr(zs,this),isDataViewInstance:()=>vv(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),us(Dp,this,s.length),this.hot.getSettings().ariaTags&&lg(yv,this,XU).call(this)===this.hot.countCols()&&lg(yv,this,N8).call(this,wr(Dp,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),us(bb,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.runHooks("modifyGetCellCoords",l,u);let c=l,d=u;Array.isArray(h)&&([c,d]=h);const f=this.hot.getCellMeta(c,d),m=this.hot.colToProp(d);let p=this.hot.getDataAtRowProp(c,m);this.hot.hasHook("beforeValueRender")&&(p=this.hot.runHooks("beforeValueRender",p,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,p,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,p,f),this.hot.runHooks("afterRenderer",a,l,u,m,p,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Fd(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),h={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,us(Pa,this,!0),this.hot.runHooks("beforeOnCellMouseDown",s,u,a,h),!bh(s)&&(RL(s,{coords:u,selection:this.hot.selection,controller:h,cellCoordsFactory:(c,d)=>this.hot._createCellCoords(c,d)}),this.hot.runHooks("afterOnCellMouseDown",s,u,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,us(Pa,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,u,a),!bh(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,u,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,u,a),!bh(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,u,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),h={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,u,a,h),!bh(s)&&(wr(Pa,this)&&RL(s,{coords:u,selection:this.hot.selection,controller:h,cellCoordsFactory:(c,d)=>this.hot._createCellCoords(c,d)}),this.hot.runHooks("afterOnCellMouseOver",s,u,a),this.activeWt=this._wt)},onCellMouseUp:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,u,a),!(bh(s)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",s,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:s=>{const o=this.hot.rowIndexMapper,a=s<0;let l=s;return!a&&(l=o.getVisualFromRenderableIndex(s),l===null)?s:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:s=>{const o=this.hot.columnIndexMapper,a=s<0;let l=s;return!a&&(l=o.getVisualFromRenderableIndex(s),l===null)?s:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=s<0;let h=s;u||(h=l.getVisualFromRenderableIndex(s));const c=this.hot.runHooks("beforeHighlightingRowHeader",h,o,a);return u?c:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(c,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,u=s<0;let h=s;u||(h=l.getVisualFromRenderableIndex(s));const c=this.hot.runHooks("beforeHighlightingColumnHeader",h,o,a);return u?c:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(c,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[u,h]=this.translateFromRenderableToVisualIndex(s,o),c=this.hot.selection.getSelectedRange();if(c.size()>0){const f=c.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,h,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,u,h]=s,c=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(h)];return this.hot.runHooks("beforeDrawBorders",c,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(s,o)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.runHooks("beforeStretchingColumnWidth",s,a)},onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,h=o>=0?u.getVisualFromRenderableIndex(o):o,c=s>=0?l.getVisualFromRenderableIndex(s):s,d=this.hot.runHooks("modifyGetCellCoords",c,h,a);if(Array.isArray(d)){const[f,m,p,v]=d;return[f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f,m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,p>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(p,-1)):p,v>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(v,-1)):v]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,u=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(u+o,a-1);else if(o==="auto"){const h=Math.ceil(u/a*12);s.startRow=Math.max(l-h,0),s.endRow=Math.min(u+h,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,u=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(u+o,a-1)),o==="auto"){const h=Math.ceil(u/a*6);s.startColumn=Math.max(l-h,0),s.endColumn=Math.min(u+h,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new EI(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(t,"mousedown",s=>{s.target===t&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",s=>{s.target===t&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(wv(e))return!0;const t=kh(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return wr(Pa,this)}isSelectedOnlyCell(){var e,t;return(e=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const r=t.firstChild;if(!Je(r,"relative")){pa(t),this.appendRowHeader(e,t);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,s=r.createElement("div"),o=r.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),t.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(t.firstChild){const o=t.firstChild;Je(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,r,i),o.className="",ue(o,["relative",...s()])):(pa(t),this.appendColHeader(e,t,r,i))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),u=s();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Xe(a,...ua()),Xe(l,...ua())),this.updateCellHeader(l,e,r,i),a.appendChild(l),t.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,t,i)}updateCellHeader(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=t;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Je(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(t):Je(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(t))),s>-1?ef(e,r(t,i)):(Wh(e," "),ue(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,t){us(Tb,this,e),us(Ab,this,t)}getLastSize(){return{width:wr(Tb,this),height:wr(Ab,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return wr(bb,this)}getRowHeadersCount(){return wr(Dp,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return((t=this._wt.wtOverlays.getParentOverlay(e))!==null&&t!==void 0?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function XU(){return parseInt(this.hot.rootElement.getAttribute(HC()[0]),10)}function N8(n){const e=lg(yv,this,XU).call(this)+n;Xe(this.hot.rootElement,...HC(e))}const I8="ABCDEFGHIJKLMNOPQRSTUVWXYZ",EL=I8.length;function M8(n){let e=n+1,t="",r;for(;e>0;)r=(e-1)%EL,t=String.fromCharCode(65+r)+t,e=parseInt((e-r)/EL,10);return t}function QU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=n;const r=[];return(!Array.isArray(n)||!Array.isArray(n[0]))&&(t=[n]),t.forEach((i,s)=>{Array.isArray(i)?i.forEach((o,a)=>{r.push([s+e,a,o])}):Object.keys(i).forEach(o=>{r.push([s+e,o,i[o]])})}),r}function ZU(n){let e=0;return Array.isArray(n)&&(n[0]&&Array.isArray(n[0])?e=n[0].length:n[0]&&mt(n[0])&&(e=eI(n[0]))),e}function O8(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>Array.isArray(e)))}function _8(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function If(n,e,t){return(e=x8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function x8(n){var e=P8(n,"string");return typeof e=="symbol"?e:e+""}function P8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class L8{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];If(this,"hot",void 0),If(this,"data",void 0),If(this,"dataType","array"),If(this,"colToProp",()=>{}),If(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return D(this.data,(r,i)=>{const s=this.getAtCell(i,e);t.push(s)}),t}getAtRow(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=t===void 0&&r===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((u,h)=>{l[h]=this.getAtPhysicalCell(e,h,a)}):He(t,r,u=>{l[u-t]=this.getAtPhysicalCell(e,u,a)});else if(mt(a)||fn(a))if(i?l=[]:l={},!s||i){const h=this.countFirstRowKeys()-1;He(0,h,c=>{const d=this.colToProp(c);if(c>=(t||0)&&c<=(r||h)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):o?eb(l,d,f):l[d]=f}})}else gt(a,(u,h)=>{const c=this.getAtPhysicalCell(e,h,a);o?eb(l,h,c):l[h]=c});return l}setAtCell(e,t,r){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=co(r);this.hot.runHooks("modifySourceData",e,t,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(t)?this.data[e][t]=r:eb(this.data[e],t,r)}}getAtPhysicalCell(e,t,r){let i=null;if(r)if(typeof t=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?O4(r,t):r[t]}else typeof t=="function"?i=t(r):i=r[t];if(this.hot.hasHook("modifySourceData")){const s=co(i);this.hot.runHooks("modifySourceData",e,t,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,t){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||t===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,t.row),o=Math.min(e.col,t.col),a=Math.max(e.row,t.row),l=Math.max(e.col,t.col));const u=[];return He(s,a,h=>{u.push(i?this.getAtRow(h,void 0,void 0,r):this.getAtRow(h,o,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return ZU(this.data)}destroy(){this.data=null,this.hot=null}}function bL(n,e,t){return(e=D8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function D8(n){var e=H8(n,"string");return typeof e=="symbol"?e:e+""}function H8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class lc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;bL(this,"indexedValues",[]),bL(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,fn(this.initValueOrFn)?He(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):He(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}en(lc,Br);function TI(n,e,t,r){const i=t.length?t[0]:void 0;return[...n.slice(0,i),...t.map((s,o)=>fn(r)?r(s,o):r),...i===void 0?[]:n.slice(i)]}function AI(n,e){return vu(n,(t,r)=>e.includes(r)===!1)}class bu extends lc{insert(e,t){this.indexedValues=TI(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=AI(this.indexedValues,e),super.remove(e)}}class GC extends bu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return gi(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}function NI(n,e,t){return[...n.slice(0,e),...t,...n.slice(e)]}function ug(n,e){return vu(n,t=>e.includes(t)===!1)}function II(n,e){return bt(n,t=>t-e.filter(r=>r<t).length)}function MI(n,e){const t=e[0],r=e.length;return bt(n,i=>i>=t?i+r:i)}function F8(n,e,t){return(e=k8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function k8(n){var e=V8(n,"string");return typeof e=="symbol"?e:e+""}function V8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class jC extends lc{constructor(){super(...arguments),F8(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=ug(this.orderOfIndexes,[e]),fn(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=TI(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=MI(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=AI(this.indexedValues,e),this.orderOfIndexes=ug(this.orderOfIndexes,e),this.orderOfIndexes=II(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Xg extends bu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return gi(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}const TL=new Map([["indexesSequence",{getListWithInsertedItems:NI,getListWithRemovedItems:ug}],["physicallyIndexed",{getListWithInsertedItems:TI,getListWithRemovedItems:AI}]]),JU=n=>{if(TL.has(n)===!1)throw new Error(`Alter strategy with ID '${n}' does not exist.`);return TL.get(n)};class eB extends lc{constructor(){super(e=>e)}insert(e,t){const r=MI(this.indexedValues,t);this.indexedValues=NI(r,e,t),super.insert(e,t)}remove(e){const t=ug(this.indexedValues,e);this.indexedValues=II(t,e),super.remove(e)}}const AL=new Map([["hiding",GC],["index",lc],["linkedPhysicalIndexToValue",jC],["physicalIndexToValue",bu],["trimming",Xg]]);function U8(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!AL.has(n))throw new Error(`The provided map type ("${n}") does not exist.`);return new(AL.get(n))(e)}function B8(n,e,t){return(e=W8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function W8(n){var e=$8(n,"string");return typeof e=="symbol"?e:e+""}function $8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class OI{constructor(){B8(this,"collection",new Map)}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)))}unregister(e){const t=this.collection.get(e);_e(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t))}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return mn(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(r=>{r.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}en(OI,Br);function Nb(n,e,t){return(e=G8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function G8(n){var e=j8(n,"string");return typeof e=="symbol"?e:e+""}function j8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class NL extends OI{constructor(e,t){super(),Nb(this,"mergedValuesCache",[]),Nb(this,"aggregationFunction",void 0),Nb(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=bt(this.get(),s=>s.getValues()),r=[],i=_e(t[0])&&t[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(t[a][s]);r.push(o)}return bt(r,this.aggregationFunction)}getMergedValueAtIndex(e,t){const r=this.getMergedValues(t)[e];return _e(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function z8(n,e,t){Y8(n,e),e.set(n,t)}function Y8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function K8(n,e,t){return n.set(tB(n,e),t),t}function q8(n,e){return n.get(tB(n,e))}function tB(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ib=new WeakMap;class nB{constructor(){z8(this,Ib,[])}subscribe(e){return this.addLocalHook("change",e),this._write(q8(Ib,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){K8(Ib,this,e)}}en(nB,Br);function IL(n,e){const t=[];let r=0,i=0;for(;r<n.length&&i<e.length;r++,i++)n[r]!==e[i]&&t.push({op:"replace",index:i,oldValue:n[r],newValue:e[i]});for(;r<e.length;r++)t.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<n.length;i++)t.push({op:"remove",index:i,oldValue:n[i],newValue:void 0});return t}function Mf(n,e,t){X8(n,e),e.set(n,t)}function X8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hs(n,e){return n.get(rB(n,e))}function Fp(n,e,t){return n.set(rB(n,e),t),t}function rB(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var kp=new WeakMap,Of=new WeakMap,Vp=new WeakMap,Up=new WeakMap,Bp=new WeakMap;class Q8{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Mf(this,kp,new Set),Mf(this,Of,[]),Mf(this,Vp,[]),Mf(this,Up,!1),Mf(this,Bp,!1),Fp(Bp,this,e??!1)}createObserver(){const e=new nB;return hs(kp,this).add(e),e.addLocalHook("unsubscribe",()=>{hs(kp,this).delete(e)}),e._writeInitialChanges(IL(hs(Of,this),hs(Vp,this))),e}emit(e){let t=hs(Vp,this);(!hs(Up,this)||hs(Of,this).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(hs(Bp,this)):Fp(Of,this,new Array(e.length).fill(hs(Bp,this))),hs(Up,this)||(Fp(Up,this,!0),t=hs(Of,this)));const r=IL(t,e);hs(kp,this).forEach(i=>i._write(r)),Fp(Vp,this,e)}}function ni(n,e,t){return(e=Z8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Z8(n){var e=J8(n,"string");return typeof e=="symbol"?e:e+""}function J8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class XA{constructor(){ni(this,"indexesSequence",new eB),ni(this,"trimmingMapsCollection",new NL(e=>e.some(t=>t===!0),!1)),ni(this,"hidingMapsCollection",new NL(e=>e.some(t=>t===!0),!1)),ni(this,"variousMapsCollection",new OI),ni(this,"hidingChangesObservable",new Q8({initialIndexValue:!1})),ni(this,"notTrimmedIndexesCache",[]),ni(this,"notHiddenIndexesCache",[]),ni(this,"isBatched",!1),ni(this,"indexesSequenceChanged",!1),ni(this,"indexesChangeSource",void 0),ni(this,"trimmedIndexesChanged",!1),ni(this,"hiddenIndexesChanged",!1),ni(this,"renderablePhysicalIndexesCache",[]),ni(this,"fromPhysicalToVisualIndexesCache",new Map),ni(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,r){return this.registerMap(e,U8(t,r))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof Xg?this.trimmingMapsCollection.register(e,t):t instanceof GC?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const r=this.getNumberOfIndexes();return r>0&&t.init(r),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return _e(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return _e(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return _e(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return _e(t)?t:null}getNearestNotHiddenIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return t>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?r?this.getNearestNotHiddenIndex(e,-t,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const r=bt(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=ug(this.getIndexesSequence(),r),a=o.filter(u=>this.isTrimmed(u)===!1);let l=o.indexOf(a[a.length-1])+1;if(t+s<i){const u=a[t];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(NI(o,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const r=this.getNotTrimmedIndexes()[e],i=_e(r)?r:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),o=bt(new Array(t).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,o),this.hidingMapsCollection.insertToEvery(s,o),this.variousMapsCollection.insertToEvery(s,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(r,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromRenderableIndex(t),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,t)}}}en(XA,Br);function e7(n,e){return gt(e,(t,r)=>{mn(n[r])&&(n[r]=t)}),n}function iB(n){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(n);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:n}function sB(n){_e(n)&&iI(Yt`Language with code "${n}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function t7(n,e){return Array.isArray(n)&&Number.isInteger(e)?n[e]:n}const{register:n7,getValues:r7}=Ao("phraseFormatters");function i7(n,e){n7(n,e)}function s7(){return r7()}i7("pluralize",t7);const oB="ContextMenu:items",ot=oB,_I=`${ot}.noItems`,xI=`${ot}.insertRowAbove`,PI=`${ot}.insertRowBelow`,LI=`${ot}.insertColumnOnTheLeft`,DI=`${ot}.insertColumnOnTheRight`,HI=`${ot}.removeRow`,FI=`${ot}.removeColumn`,kI=`${ot}.undo`,VI=`${ot}.redo`,sy=`${ot}.readOnly`,UI=`${ot}.clearColumn`,BI=`${ot}.copy`,WI=`${ot}.copyWithHeaders`,$I=`${ot}.copyWithGroupHeaders`,GI=`${ot}.copyHeadersOnly`,jI=`${ot}.cut`,zI=`${ot}.freezeColumn`,YI=`${ot}.unfreezeColumn`,KI=`${ot}.mergeCells`,qI=`${ot}.unmergeCells`,XI=`${ot}.addComment`,QI=`${ot}.editComment`,ZI=`${ot}.removeComment`,JI=`${ot}.readOnlyComment`,eM=`${ot}.align`,oy=`${ot}.align.left`,ay=`${ot}.align.center`,ly=`${ot}.align.right`,uy=`${ot}.align.justify`,hy=`${ot}.align.top`,cy=`${ot}.align.middle`,dy=`${ot}.align.bottom`,tM=`${ot}.borders`,nM=`${ot}.borders.top`,rM=`${ot}.borders.right`,iM=`${ot}.borders.bottom`,sM=`${ot}.borders.left`,oM=`${ot}.borders.remove`,aM=`${ot}.nestedHeaders.insertChildRow`,lM=`${ot}.nestedHeaders.detachFromParent`,uM=`${ot}.hideColumn`,hM=`${ot}.showColumn`,cM=`${ot}.hideRow`,dM=`${ot}.showRow`,pi="Filters:",Hn=`${pi}conditions`,zC=`${Hn}.none`,fM=`${Hn}.isEmpty`,mM=`${Hn}.isNotEmpty`,gM=`${Hn}.isEqualTo`,pM=`${Hn}.isNotEqualTo`,wM=`${Hn}.beginsWith`,vM=`${Hn}.endsWith`,yM=`${Hn}.contains`,CM=`${Hn}.doesNotContain`,o7=`${Hn}.byValue`,SM=`${Hn}.greaterThan`,RM=`${Hn}.greaterThanOrEqualTo`,EM=`${Hn}.lessThan`,bM=`${Hn}.lessThanOrEqualTo`,TM=`${Hn}.isBetween`,AM=`${Hn}.isNotBetween`,NM=`${Hn}.after`,IM=`${Hn}.before`,MM=`${Hn}.today`,OM=`${Hn}.tomorrow`,_M=`${Hn}.yesterday`,xM=`${pi}labels.filterByCondition`,PM=`${pi}labels.filterByValue`,LM=`${pi}labels.conjunction`,YC=`${pi}labels.disjunction`,fy=`${pi}values.blankCells`,DM=`${pi}buttons.selectAll`,HM=`${pi}buttons.clear`,FM=`${pi}buttons.ok`,kM=`${pi}buttons.cancel`,VM=`${pi}buttons.placeholder.search`,UM=`${pi}buttons.placeholder.value`,BM=`${pi}buttons.placeholder.secondValue`,WM="CheckboxRenderer:",$M=`${WM}checked`,GM=`${WM}unchecked`,a7=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:$M,CHECKBOX_RENDERER_NAMESPACE:WM,CHECKBOX_UNCHECKED:GM,CONTEXTMENU_ITEMS_ADD_COMMENT:XI,CONTEXTMENU_ITEMS_ALIGNMENT:eM,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:dy,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:ay,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:uy,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:oy,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:cy,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:ly,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:hy,CONTEXTMENU_ITEMS_BORDERS:tM,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:iM,CONTEXTMENU_ITEMS_BORDERS_LEFT:sM,CONTEXTMENU_ITEMS_BORDERS_RIGHT:rM,CONTEXTMENU_ITEMS_BORDERS_TOP:nM,CONTEXTMENU_ITEMS_CLEAR_COLUMN:UI,CONTEXTMENU_ITEMS_COPY:BI,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:GI,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:$I,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:WI,CONTEXTMENU_ITEMS_CUT:jI,CONTEXTMENU_ITEMS_EDIT_COMMENT:QI,CONTEXTMENU_ITEMS_FREEZE_COLUMN:zI,CONTEXTMENU_ITEMS_HIDE_COLUMN:uM,CONTEXTMENU_ITEMS_HIDE_ROW:cM,CONTEXTMENU_ITEMS_INSERT_LEFT:LI,CONTEXTMENU_ITEMS_INSERT_RIGHT:DI,CONTEXTMENU_ITEMS_MERGE_CELLS:KI,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:lM,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:aM,CONTEXTMENU_ITEMS_NO_ITEMS:_I,CONTEXTMENU_ITEMS_READ_ONLY:sy,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:JI,CONTEXTMENU_ITEMS_REDO:VI,CONTEXTMENU_ITEMS_REMOVE_BORDERS:oM,CONTEXTMENU_ITEMS_REMOVE_COLUMN:FI,CONTEXTMENU_ITEMS_REMOVE_COMMENT:ZI,CONTEXTMENU_ITEMS_REMOVE_ROW:HI,CONTEXTMENU_ITEMS_ROW_ABOVE:xI,CONTEXTMENU_ITEMS_ROW_BELOW:PI,CONTEXTMENU_ITEMS_SHOW_COLUMN:hM,CONTEXTMENU_ITEMS_SHOW_ROW:dM,CONTEXTMENU_ITEMS_UNDO:kI,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:YI,CONTEXTMENU_ITEMS_UNMERGE_CELLS:qI,CONTEXT_MENU_ITEMS_NAMESPACE:oB,FILTERS_BUTTONS_CANCEL:kM,FILTERS_BUTTONS_CLEAR:HM,FILTERS_BUTTONS_OK:FM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:VM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:BM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:UM,FILTERS_BUTTONS_SELECT_ALL:DM,FILTERS_CONDITIONS_AFTER:NM,FILTERS_CONDITIONS_BEFORE:IM,FILTERS_CONDITIONS_BEGINS_WITH:wM,FILTERS_CONDITIONS_BETWEEN:TM,FILTERS_CONDITIONS_BY_VALUE:o7,FILTERS_CONDITIONS_CONTAINS:yM,FILTERS_CONDITIONS_EMPTY:fM,FILTERS_CONDITIONS_ENDS_WITH:vM,FILTERS_CONDITIONS_EQUAL:gM,FILTERS_CONDITIONS_GREATER_THAN:SM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:RM,FILTERS_CONDITIONS_LESS_THAN:EM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:bM,FILTERS_CONDITIONS_NAMESPACE:Hn,FILTERS_CONDITIONS_NONE:zC,FILTERS_CONDITIONS_NOT_BETWEEN:AM,FILTERS_CONDITIONS_NOT_CONTAIN:CM,FILTERS_CONDITIONS_NOT_EMPTY:mM,FILTERS_CONDITIONS_NOT_EQUAL:pM,FILTERS_CONDITIONS_TODAY:MM,FILTERS_CONDITIONS_TOMORROW:OM,FILTERS_CONDITIONS_YESTERDAY:_M,FILTERS_DIVS_FILTER_BY_CONDITION:xM,FILTERS_DIVS_FILTER_BY_VALUE:PM,FILTERS_LABELS_CONJUNCTION:LM,FILTERS_LABELS_DISJUNCTION:YC,FILTERS_NAMESPACE:pi,FILTERS_VALUES_BLANK_CELLS:fy},Symbol.toStringTag,{value:"Module"}));const aB={languageCode:"en-US",[_I]:"No available options",[xI]:"Insert row above",[PI]:"Insert row below",[LI]:"Insert column left",[DI]:"Insert column right",[HI]:["Remove row","Remove rows"],[FI]:["Remove column","Remove columns"],[kI]:"Undo",[VI]:"Redo",[sy]:"Read only",[UI]:"Clear column",[eM]:"Alignment",[oy]:"Left",[ay]:"Center",[ly]:"Right",[uy]:"Justify",[hy]:"Top",[cy]:"Middle",[dy]:"Bottom",[zI]:"Freeze column",[YI]:"Unfreeze column",[tM]:"Borders",[nM]:"Top",[rM]:"Right",[iM]:"Bottom",[sM]:"Left",[oM]:"Remove border(s)",[XI]:"Add comment",[QI]:"Edit comment",[ZI]:"Delete comment",[JI]:"Read-only comment",[KI]:"Merge cells",[qI]:"Unmerge cells",[BI]:"Copy",[WI]:["Copy with header","Copy with headers"],[$I]:["Copy with group header","Copy with group headers"],[GI]:["Copy header only","Copy headers only"],[jI]:"Cut",[aM]:"Insert child row",[lM]:"Detach from parent",[uM]:["Hide column","Hide columns"],[hM]:["Show column","Show columns"],[cM]:["Hide row","Hide rows"],[dM]:["Show row","Show rows"],[zC]:"None",[fM]:"Is empty",[mM]:"Is not empty",[gM]:"Is equal to",[pM]:"Is not equal to",[wM]:"Begins with",[vM]:"Ends with",[yM]:"Contains",[CM]:"Does not contain",[SM]:"Greater than",[RM]:"Greater than or equal to",[EM]:"Less than",[bM]:"Less than or equal to",[TM]:"Is between",[AM]:"Is not between",[NM]:"After",[IM]:"Before",[MM]:"Today",[OM]:"Tomorrow",[_M]:"Yesterday",[fy]:"Blank cells",[xM]:"Filter by condition",[PM]:"Filter by value",[LM]:"And",[YC]:"Or",[DM]:"Select all",[HM]:"Clear",[FM]:"OK",[kM]:"Cancel",[VM]:"Search",[UM]:"Value",[BM]:"Second value",[$M]:"Checked",[GM]:"Unchecked"},l7=a7,QA=aB.languageCode,{register:u7,getItem:lB,hasItem:h7,getValues:c7}=Ao("languagesDictionaries");uB(aB);function uB(n,e){let t=n,r=e;return mt(n)&&(r=n,t=r.languageCode),d7(t,r),u7(t,mi(r)),mi(r)}function d7(n,e){n!==QA&&e7(e,lB(QA))}function hB(n){return jM(n)?mi(lB(n)):null}function jM(n){return h7(n)}function f7(){return c7()}function cB(n,e,t){const r=hB(n);if(r===null)return null;const i=r[e];if(mn(i))return null;const s=m7(i,t);return Array.isArray(s)?s[0]:s}function m7(n,e){let t=n;return D(s7(),r=>{t=r(n,e)}),t}function g7(n){let e=iB(n);return jM(e)||(e=QA,sB(n)),e}function p7(n,e,t){return(e=w7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function w7(n){var e=v7(n,"string");return typeof e=="symbol"?e:e+""}function v7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Sl extends $U{constructor(e,t){super(e,null),p7(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:r}=e,i=this.getNearestNotHiddenCoords(t,1),s=this.getNearestNotHiddenCoords(r,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=t,s=r),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,t,r){return t<0?t:e.getNearestNotHiddenIndex(t,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(t,r,i)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(t);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function Mb(n){let{activeHeaderClassName:e,...t}=n;return new Sl({className:e,...t,selectionType:GU})}function y7(n){let{areaCornerVisible:e,...t}=n;return new Sl({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...t,selectionType:gI})}function C7(n){let{...e}=n;return new Sl({className:"highlight",...e,selectionType:gI})}function S7(n){let{columnClassName:e,...t}=n;return new Sl({className:e,...t,selectionType:Y5})}function R7(n){let{cellCornerVisible:e,...t}=n;return new Sl({className:"current",headerAttributes:[K0()],border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:pI})}function E7(n){let{border:e,visualCellRange:t,...r}=n;return new Sl({...e,...r,selectionType:K5},t)}function b7(n){let{...e}=n;return new Sl({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:j5})}function ML(n){let{headerClassName:e,...t}=n;return new Sl({className:e,...t,selectionType:mI})}function T7(n){let{rowClassName:e,...t}=n;return new Sl({className:e,...t,selectionType:z5})}function A7(n,e){N7(n,e),e.add(n)}function N7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ci(n,e,t){return(e=I7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function I7(n){var e=M7(n,"string");return typeof e=="symbol"?e:e+""}function M7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function La(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var xo=new WeakSet;class O7{constructor(e){A7(this,xo),Ci(this,"options",void 0),Ci(this,"layerLevel",0),Ci(this,"focus",void 0),Ci(this,"fill",void 0),Ci(this,"layeredAreas",new Map),Ci(this,"areas",new Map),Ci(this,"rowHeaders",new Map),Ci(this,"columnHeaders",new Map),Ci(this,"activeRowHeaders",new Map),Ci(this,"activeColumnHeaders",new Map),Ci(this,"activeCornerHeaders",new Map),Ci(this,"rowHighlights",new Map),Ci(this,"columnHighlights",new Map),Ci(this,"customSelections",[]),this.options=e,this.focus=R7(e),this.fill=b7(e)}isEnabledFor(e,t){let r=e;e===pI&&(r="current");let i=this.options.disabledCellSelection(t.row,t.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return La(xo,this,Da).call(this,this.layeredAreas,y7)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return La(xo,this,Da).call(this,this.areas,C7)}getAreas(){return[...this.areas.values()]}createRowHeader(){return La(xo,this,Da).call(this,this.rowHeaders,ML)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return La(xo,this,Da).call(this,this.columnHeaders,ML)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return La(xo,this,Da).call(this,this.activeRowHeaders,Mb)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return La(xo,this,Da).call(this,this.activeColumnHeaders,Mb)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return La(xo,this,Da).call(this,this.activeCornerHeaders,Mb)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return La(xo,this,Da).call(this,this.rowHighlights,T7)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return La(xo,this,Da).call(this,this.columnHighlights,S7)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(E7({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),D(this.areas.values(),e=>{e.clear()}),D(this.layeredAreas.values(),e=>{e.clear()}),D(this.rowHeaders.values(),e=>{e.clear()}),D(this.columnHeaders.values(),e=>{e.clear()}),D(this.activeRowHeaders.values(),e=>{e.clear()}),D(this.activeColumnHeaders.values(),e=>{e.clear()}),D(this.activeCornerHeaders.values(),e=>{e.clear()}),D(this.rowHighlights.values(),e=>{e.clear()}),D(this.columnHighlights.values(),e=>{e.clear()})}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Da(n,e){const t=this.layerLevel;if(n.has(t))return n.get(t);const r=e({layerLevel:t,...this.options});return n.set(t,r),r}function OL(n,e,t){return(e=_7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _7(n){var e=x7(n,"string");return typeof e=="symbol"?e:e+""}function x7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class P7{constructor(e){OL(this,"ranges",[]),OL(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function L7(n,e){dB(n,e),e.add(n)}function Ob(n,e,t){dB(n,e),e.set(n,t)}function dB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xt(n,e){return n.get(nr(n,e))}function Wp(n,e,t){return n.set(nr(n,e),t),t}function nr(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var $p=new WeakMap,dn=new WeakMap,mo=new WeakMap,hr=new WeakSet;class ZA{constructor(e,t){L7(this,hr),Ob(this,$p,void 0),Ob(this,dn,void 0),Ob(this,mo,{x:0,y:0}),Wp($p,this,e),Wp(dn,this,t)}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=xt(dn,this).createCellCoords(e,t);let s=xt($p,this).current().highlight;const o=xt(dn,this).visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),o.row!==null&&o.col!==null){const{width:u,height:h}=nr(hr,this,fB).call(this),{row:c,col:d}=nr(hr,this,xL).call(this,s),f=xt(dn,this).fixedRowsBottom(),m=xt(dn,this).minSpareRows(),p=xt(dn,this).minSpareCols(),v=xt(dn,this).autoWrapRow(),y=xt(dn,this).autoWrapCol(),S=xt(dn,this).createCellCoords(c+i.row,d+i.col);if(S.row>=h){const I=co(r&&m>0&&f===0),H=S.col+1,k=xt(dn,this).createCellCoords(S.row-h,H>=u?H-u:H);this.runLocalHooks("beforeColumnWrap",I,nr(hr,this,Rc).call(this,k),H>=u),I.value?this.runLocalHooks("insertRowRequire",xt(dn,this).countRenderableRows()):y&&S.assign(k)}else if(S.row<0){const I=co(y),H=S.col-1,k=xt(dn,this).createCellCoords(h+S.row,H<0?u+H:H);this.runLocalHooks("beforeColumnWrap",I,nr(hr,this,Rc).call(this,k),H<0),y&&S.assign(k)}if(S.col>=u){const I=co(r&&p>0),H=S.row+1,k=xt(dn,this).createCellCoords(H>=h?H-h:H,S.col-u);this.runLocalHooks("beforeRowWrap",I,nr(hr,this,Rc).call(this,k),H>=h),I.value?this.runLocalHooks("insertColRequire",xt(dn,this).countRenderableColumns()):v&&S.assign(k)}else if(S.col<0){const I=co(v),H=S.row-1,k=xt(dn,this).createCellCoords(H<0?h+H:H,u+S.col);this.runLocalHooks("beforeRowWrap",I,nr(hr,this,Rc).call(this,k),H<0),v&&S.assign(k)}const{rowDir:R,colDir:T}=nr(hr,this,_L).call(this,S);a=R,l=T,s=nr(hr,this,Rc).call(this,S)}return this.runLocalHooks("afterTransformStart",s,a,l),s}transformEnd(e,t){const r=xt(dn,this).createCellCoords(e,t),i=xt($p,this).current(),s=xt(dn,this).visualToRenderableCoords(i.highlight),o=nr(hr,this,_b).call(this,i.to.row,i.from.row),a=nr(hr,this,xb).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,h=0;if(this.runLocalHooks("beforeTransformEnd",r),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:c,col:d}=nr(hr,this,xL).call(this,i.highlight),f=xt(dn,this).createCellCoords(o+r.row,a+r.col),m=i.getTopStartCorner(),p=i.getTopEndCorner(),v=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const T=f.col-d;f.col=nr(hr,this,xb).call(this,m.col,p.col)+T}else if(r.col>0&&a<=d&&f.col>d){const T=nr(hr,this,xb).call(this,p.col,m.col),I=Math.max(f.col-T,1);f.col=T+I}if(r.row<0&&o>=c&&f.row<c){const T=f.row-c;f.row=nr(hr,this,_b).call(this,m.row,v.row)+T}else if(r.row>0&&o<=c&&f.row>c){const T=nr(hr,this,_b).call(this,v.row,m.row),I=Math.max(f.row-T,1);f.row=T+I}const{rowDir:y,colDir:S}=nr(hr,this,_L).call(this,f);u=y,h=S;const R=nr(hr,this,Rc).call(this,f);r.row===0&&r.col!==0?l.col=R.col:r.row!==0&&r.col===0?l.row=R.row:(l.row=R.row,l.col=R.col)}return this.runLocalHooks("afterTransformEnd",l,u,h),l}setOffsetSize(e){let{x:t,y:r}=e;Wp(mo,this,{x:t,y:r})}resetOffsetSize(){Wp(mo,this,{x:0,y:0})}}function _L(n){const{width:e,height:t}=nr(hr,this,fB).call(this);let r=0,i=0;return n.row<0?(r=-1,n.row=0):n.row>0&&n.row>=t&&(r=1,n.row=t-1),n.col<0?(i=-1,n.col=0):n.col>0&&n.col>=e&&(i=1,n.col=e-1),{rowDir:r,colDir:i}}function fB(){return{width:xt(mo,this).x+xt(dn,this).countRenderableColumns(),height:xt(mo,this).y+xt(dn,this).countRenderableRows()}}function _b(n,e){const t=xt(dn,this).findFirstNonHiddenRenderableRow(n,e);return t===null?null:xt(mo,this).y+t}function xb(n,e){const t=xt(dn,this).findFirstNonHiddenRenderableColumn(n,e);return t===null?null:xt(mo,this).x+t}function xL(n){const{row:e,col:t}=xt(dn,this).visualToRenderableCoords(n);if(e===null||t===null)throw new Error("Renderable coords are not visible.");return xt(dn,this).createCellCoords(xt(mo,this).y+e,xt(mo,this).x+t)}function Rc(n){const e=n.clone();return e.col=n.col-xt(mo,this).x,e.row=n.row-xt(mo,this).y,xt(dn,this).renderableToVisualCoords(e)}en(ZA,Br);const KC=0,qC=1,mB=2,zM=3,D7=[zM,mB],H7=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Pb=Symbol("root"),PL=Symbol("child");function Vd(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pb;if(e!==Pb&&e!==PL)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(n),r=e===Pb;let i=KC;if(t){const s=n[0];n.length===0?i=qC:r&&s instanceof Yg?i=zM:r&&Array.isArray(s)?i=Vd(s,PL):n.length>=2&&n.length<=4&&!n.some((a,l)=>!H7[l].includes(typeof a))&&(i=mB)}return i}function hg(n){let{createCellCoords:e,createCellRange:t,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!D7.includes(n))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=n===zM;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],u=o?s.to.row:s[2],h=o?s.to.col:s[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof h=="string"&&(h=i(h))),mn(u)&&(u=a),mn(h)&&(h=l),!r){const f=a,m=l,p=u,v=h;a=Math.min(f,p),l=Math.min(m,v),u=Math.max(f,p),h=Math.max(m,v)}const c=e(a,l),d=e(u,h);return t(c,c,d)}}function F7(n){const e=Vd(n.getSelected());if(e===KC||e===qC)return[];const t=hg(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),r=new Set;D(n.getSelected(),o=>{const{from:a,to:l}=t(o),u=Math.max(a.col,0),h=l.col-u+1;D(Array.from(new Array(h),(c,d)=>u+d),c=>{r.has(c)||r.add(c)})});const i=Array.from(r).sort((o,a)=>o-a);return gi(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function k7(n){const e=Vd(n.getSelected());if(e===KC||e===qC)return[];const t=hg(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),r=new Set;D(n.getSelected(),o=>{const{from:a,to:l}=t(o),u=Math.max(a.row,0),h=l.row-u+1;D(Array.from(new Array(h),(c,d)=>u+d),c=>{r.has(c)||r.add(c)})});const i=Array.from(r).sort((o,a)=>o-a);return gi(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function Ec(n,e,t){V7(n,e),e.set(n,t)}function V7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uu(n,e,t){return(e=U7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function U7(n){var e=B7(n,"string");return typeof e=="symbol"?e:e+""}function B7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function wn(n,e){return n.get(gB(n,e))}function Po(n,e,t){return n.set(gB(n,e),t),t}function gB(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Gr=new WeakMap,Bu=new WeakMap,Gp=new WeakMap,_f=new WeakMap,jp=new WeakMap,xf=new WeakMap;class pB{constructor(e,t){var r=this;Uu(this,"settings",void 0),Uu(this,"tableProps",void 0),Uu(this,"inProgress",!1),Uu(this,"selectedRange",new P7((i,s,o)=>this.tableProps.createCellRange(i,s,o))),Uu(this,"highlight",void 0),Ec(this,Gr,void 0),Ec(this,Bu,void 0),Uu(this,"selectedByRowHeader",new Set),Uu(this,"selectedByColumnHeader",new Set),Ec(this,Gp,!1),Ec(this,_f,!1),Ec(this,jp,"unknown"),Ec(this,xf,-1),this.settings=e,this.tableProps=t,this.highlight=new O7({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[K0()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o)}),Po(Gr,this,new ZA(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Po(Bu,this,new ZA(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),wn(Gr,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformStart",...s)}),wn(Gr,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformStart",...s)}),wn(Gr,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformEnd",...s)}),wn(Gr,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformEnd",...s)}),wn(Gr,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertRowRequire",...s)}),wn(Gr,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertColRequire",...s)}),wn(Gr,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeRowWrap",...s)}),wn(Gr,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeColumnWrap",...s)}),wn(Bu,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformFocus",...s)}),wn(Bu,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){Po(jp,this,e)}markEndSource(){Po(jp,this,"unknown")}getSelectionSource(){return wn(jp,this)}setExpectedLayers(e){Po(xf,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Po(xf,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=mn(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,a=e.clone();Po(Gp,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!s||s&&!o&&mn(t))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&t.col<0&&!s||i===0&&t.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),u=o.getVerticalDirection(),h=this.isMultiple();o.setTo(t),h&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),h&&(u!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=wn(xf,this)===-1||this.selectedRange.size()===wn(xf,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();t<this.highlight.layerLevel&&(D(this.highlight.getAreas(),m=>{m.clear()}),D(this.highlight.getLayeredAreas(),m=>{m.clear()}),D(this.highlight.getRowHeaders(),m=>{m.clear()}),D(this.highlight.getColumnHeaders(),m=>{m.clear()}),D(this.highlight.getActiveRowHeaders(),m=>{m.clear()}),D(this.highlight.getActiveColumnHeaders(),m=>{m.clear()}),D(this.highlight.getActiveCornerHeaders(),m=>{m.clear()}),D(this.highlight.getRowHighlights(),m=>{m.clear()}),D(this.highlight.getColumnHighlights(),m=>{m.clear()})),this.highlight.useLayerLevel(t);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),c=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),u.clear(),h.clear(),c.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(gI,e.highlight)&&(this.isMultiple()||t>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),t===1)){const m=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(mI,e.highlight)){if(!e.isSingleHeader()){const v=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),y=this.tableProps.createCellCoords(e.to.row,-1),S=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),R=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(v).commit(),l.add(S).commit(),d.add(v).commit(),f.add(S).commit()):(a.add(v).add(y).commit(),l.add(S).add(R).commit(),d.add(v).add(y).commit(),f.add(S).add(R).commit())}const m=!wn(_f,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),p=!wn(_f,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),p&&h.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&p&&c.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(pI,t.highlight)&&r.add(t.highlight).commit().syncWith(t),this.inProgress||(Po(Gp,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?wn(Gr,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):wn(Gr,this).resetOffsetSize(),this.setRangeStart(wn(Gr,this).transformStart(e,t,r))}transformEnd(e,t){this.settings.navigableHeaders?wn(Gr,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):wn(Gr,this).resetOffsetSize(),this.setRangeEnd(wn(Gr,this).transformEnd(e,t))}transformFocus(e,t){const r=this.selectedRange.current(),{row:i,col:s}=r.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,s-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?wn(Bu,this).setOffsetSize({x:s<0?Math.abs(s):-o,y:i<0?Math.abs(i):-a}):wn(Bu,this).setOffsetSize({x:s<0?0:-o,y:i<0?0:-a});const l=wn(Bu,this).transformStart(e,t);this.setRangeFocus(l.normalize())}shiftRows(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:o}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),h=u?-1:0,c=u?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Qt(i.row+c,h,a-1),i.col),f=this.tableProps.createCellCoords(Qt(s.row+t,h,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Qt(o.row+t,0,a-1),o.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:o}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),h=l?-1:0,c=l?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Qt(i.col+c,h,a-1)),f=this.tableProps.createCellCoords(s.row,Qt(s.col+t,h,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(o.row,Qt(o.col+t,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=co(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&wn(Gp,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=i=>{const{col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>t(i));const r=this.selectedRange.peekByIndex(e);return r?t(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=i=>{const{row:s}=i.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>t(i));const r=this.selectedRange.peekByIndex(e);return r?t(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return t.row!==null&&t.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,h=t?-a:0;if(u===0&&h===0&&(s===0||o===0))return;let c=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;Po(_f,this,f),d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(c=this.tableProps.createCellCoords(Qt(d.row,u,s-1),Qt(d.col,h,o-1)));const m=this.tableProps.createCellCoords(u,h),p=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(m,void 0,c),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.finish(),Po(_f,this,!1)}selectCells(e){var t=this;const r=Vd(e);if(r===qC)return!1;if(r===KC)throw new Error(Yt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=hg(r,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),h=u.isValid(o);return!(h&&!u.containsHeaders()||h&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),D(e,l=>{const{from:u,to:h}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(h.clone())}),this.finish()),a}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof t=="string"?this.tableProps.propToCol(t):t,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,h=this.tableProps.createCellCoords(u,i),c=this.tableProps.createCellCoords(o-1,s),d=this.tableProps.createCellRange(h,h,c).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,m=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(f=Qt(r.row,u,o-1),m=Qt(r.col,Math.min(i,s),Math.max(i,s))):(f=Qt(r,u,o-1),m=i);const p=this.tableProps.createCellCoords(f,m),v=l===0?0:Qt(p.row,u,-1),y=o-1,S=this.tableProps.createCellCoords(v,i),R=this.tableProps.createCellCoords(y,s);this.runLocalHooks("beforeSelectColumns",S,R,p),S.row=v,R.row=y,this.setRangeStartOnly(S,void 0,p),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(R),this.runLocalHooks("afterSelectColumns",S,R,p),this.finish()}return d}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(t,s-1),h=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:s,countRowHeaders:o,countColHeaders:0});if(h){let c=0,d=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(c=Qt(r.row,Math.min(e,t),Math.max(e,t)),d=Qt(r.col,a,s-1)):(c=e,d=Qt(r,a,s-1));const f=this.tableProps.createCellCoords(c,d),m=o===0?0:Qt(f.col,a,-1),p=s-1,v=this.tableProps.createCellCoords(e,m),y=this.tableProps.createCellCoords(t,p);this.runLocalHooks("beforeSelectRows",v,y,f),v.col=m,y.col=p,this.setRangeStartOnly(v,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectRows",v,y,f),this.finish()}return h}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(e===0||t===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:s,highlight:o}=r;this.clear(),o.assign({row:Qt(o.row,-1/0,e-1),col:Qt(o.col,-1/0,t-1)}),i.assign({row:Qt(i.row,-1/0,e-1),col:Qt(i.col,-1/0,t-1)}),s.assign({row:Qt(s.row,0,e-1),col:Qt(s.col,0,t-1)}),this.selectedRange.ranges.push(r),this.highlight.getFocus().add(o).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const t=this.highlight.getFocus(),r=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),c=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),u.commit(),h.commit(),c.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(r)}}en(pB,Br);const LL=/^(\r\n|\n\r|\r|\n)/,W7=/^[^\t\r\n]+/,DL=/^\t/;function $7(n){const e=[[""]];if(n.length===0)return e;let t=0,r=0,i;for(;n.length>0&&i!==n.length;)if(i=n.length,n.match(DL))n=n.replace(DL,""),t+=1,e[r][t]="";else if(n.match(LL))n=n.replace(LL,""),t=0,r+=1,e[r]=[""];else{let s="";if(n.startsWith('"')){let o=0,a=!0;for(;a;){const l=n.slice(0,1);l==='"'&&(o+=1),s+=l,n=n.slice(1),(n.length===0||n.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=n.match(W7);s=o?o[0]:"",n=n.slice(s.length)}e[r][t]=s}return e}function Nm(n){let e,t,r,i,s="",o;for(e=0,t=n.length;e<t;e+=1){for(i=n[e].length,r=0;r<i;r+=1)r>0&&(s+="	"),o=n[e][r],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==t-1&&(s+=`
`)}return s}function Wu(n,e,t){return(e=G7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function G7(n){var e=j7(n,"string");return typeof e=="symbol"?e:e+""}function j7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class md{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,r){Wu(this,"hot",void 0),Wu(this,"metaManager",void 0),Wu(this,"tableMeta",void 0),Wu(this,"dataSource",void 0),Wu(this,"duckSchema",void 0),Wu(this,"colToPropCache",void 0),Wu(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,t){let i=0,s=0,o=!1;if(typeof t=="function"){const a=eI(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,t.length)}for(r=0;r<i;r++){const a=o?t(r):t[r];if(mt(a)){if(typeof a.data<"u"){const l=o?s:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return ZU(this.dataSource)}recursiveDuckColumns(e,t,r){let i=t,s=r,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&gt(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.hot.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&_e(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(_e(t))return this.hot.toVisualColumn(t);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?ag(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,t,r)===!1||o===null)return{delta:0};const h=this.tableMeta.maxRows,c=this.getSchema().length,d=[];for(;a<t&&s+a<h;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=mi(this.getSchema()):(m=[],He(c-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},VC(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,d);const f=this.hot.toVisualRow(o);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(o,t)),this.hot.runHooks("afterCreateRow",f,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:o}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,t,r)===!1)return{delta:0};let h=a;l<this.hot.countCols()&&(h=this.hot.toPhysicalColumn(l));const c=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,m=h;i==="end"&&(m=Math.min(m+1,a));const p=m;for(;f<t&&d<o;){if(typeof l!="number"||l>=d)if(c>0)for(let y=0;y<c;y+=1)typeof s[y]>"u"&&(s[y]=[]),s[y].push(null);else s.push([null]);else for(let y=0;y<c;y++)s[y].splice(m,0,null);f+=1,m+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(p,t));const v=this.hot.toVisualColumn(p);return this.hot.runHooks("afterCreateCol",v,f,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:p}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-t;const s=this.visualRowsToPhysical(i,t),o=this.hot.countSourceRows();if(i=(o+i)%o,this.hot.runHooks("beforeRemoveRow",i,s.length,s,r)===!1)return!1;const l=s.length;if(this.filterData(i,l,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const h=_e(this.tableMeta.columns)||_e(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&h===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((h,c)=>c-h).forEach(h=>{this.metaManager.removeRow(h,1)}),this.hot.runHooks("afterRemoveRow",i,l,s,r),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-t:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,t),o=s.slice(0).sort((c,d)=>d-c);if(this.hot.runHooks("beforeRemoveCol",i,t,s,r)===!1)return!1;let l=!0;const u=o.length,h=this.dataSource;for(let c=0;c<u;c++)l&&s[0]!==s[c]-c&&(l=!1);if(l)for(let c=0,d=this.hot.countSourceRows();c<d;c++)h[c].splice(s[0],t),c===0&&this.metaManager.removeColumn(s[0],t);else for(let c=0,d=this.hot.countSourceRows();c<d;c++)for(let f=0;f<u;f++)h[c].splice(o[f],1),c===0&&this.metaManager.removeColumn(o[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,t,s,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,r){const i=this.hot.getDataAtCol(e),s=i.slice(t,t+r),o=i.slice(t+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];f1(l,o);let h=0;for(;h<r;)l.push(null),h+=1;return F6(l),this.hot.populateFromArray(t,e,l,null,null,"spliceCol"),s}spliceRow(e,t,r){const i=this.hot.getSourceDataAtRow(e),s=i.slice(t,t+r),o=i.slice(t+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];f1(l,o);let h=0;for(;h<r;)l.push(null),h+=1;return this.hot.populateFromArray(e,t,[l],null,null,"spliceRow"),s}spliceData(e,t,r){if(this.hot.runHooks("beforeDataSplice",e,t,r)!==!1){const s=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,t,r){let i=this.hot.runHooks("filterData",e,t,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>r.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,t){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const s=this.hot.runHooks("modifyRowData",r);i=isNaN(s)?s:i;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Ln(i,t))a=i[t];else if(o&&typeof t=="string"&&t.indexOf(".")>-1){let l=i;if(!l)return null;const u=t.split(".");for(let h=0,c=u.length;h<c;h++)if(l=l[u[h]],typeof l>"u")return null;a=l}else typeof t=="function"&&(a=t(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=co(a);this.hot.runHooks("modifyData",r,this.propToCol(t),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,r){const i=this.hot.toPhysicalRow(e);let s=r,o=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const u=co(s);this.hot.runHooks("modifyData",i,this.propToCol(t),u,"set"),u.isTouched()&&(s=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&Ln(o,t))o[t]=s;else if(l&&typeof t=="string"&&t.indexOf(".")>-1){let u=o,h=0,c;const d=t.split(".");for(h=0,c=d.length-1;h<c;h++)typeof u[d[h]]>"u"&&(u[d[h]]={}),u=u[d[h]];u[d[h]]=s}else typeof t=="function"?t(this.dataSource.slice(i,i+1)[0],s):o[t]=s}visualRowsToPhysical(e,t){const r=this.hot.countSourceRows(),i=[];let s=(r+e)%r,o=t,a;for(;s<r&&o;)a=this.hot.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,t){const r=this.hot.countCols(),i=[];let s=(r+e)%r,o=t;for(;s<r&&o;){const a=this.hot.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,t,md.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,r){const i=[];let s,o,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const h=r===md.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,t.col));for(s=Math.min(e.row,t.row);s<=c;s++){a=[];const f=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,t.col);o<=d&&f!==null;o++)a.push(h.call(this,s,this.colToProp(o)));f!==null&&i.push(a)}return i}getText(e,t){return Nm(this.getRange(e,t,md.DESTINATION_RENDERER))}getCopyableText(e,t){return Nm(this.getRange(e,t,md.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:z7,getItem:Y7,hasItem:wB,getNames:BCe,getValues:WCe}=Ao("cellTypes");function K7(n){if(!wB(n))throw Error(`You declared cell type "${n}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Y7(n)}function Zs(n,e){typeof n!="string"&&(e=n,n=e.CELL_TYPE);const{editor:t,renderer:r,validator:i}=e;t&&zi(n,t),r&&fs(n,r),i&&td(n,i),z7(n,e)}function q7(n,e){var t;return n==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(n))||!Ln(e,n)}function XC(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=typeof e.type=="string"?K7(e.type):e.type;if(n._automaticallyAssignedMetaProps&&gt(e,(s,o)=>{n._automaticallyAssignedMetaProps.delete(o)}),!mt(r))return;t===n&&!n._automaticallyAssignedMetaProps&&(n._automaticallyAssignedMetaProps=new Set);const i={};gt(r,(s,o)=>{if(q7(o,t)){var a;i[o]=s,(a=n._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),ir(n,i)}function X7(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}Ea(t,n);for(let r=0;r<e.length;r++)t.prototype[e[r]]=void 0;return t}function Cv(n){return Number.isInteger(n)&&n>=0}function Sv(n,e){if(!n())throw new Error(`Assertion failed: ${e}`)}function zp(n){return n==null}const vB=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(n){let e,t,r;for(e=0,t=this.countRows();e<t;e++)if(r=this.getDataAtCell(e,n),Gn(r)===!1)return!1;return!0},isEmptyRow(n){let e,t,r,i;for(e=0,t=this.countCols();e<t;e++)if(r=this.getDataAtCell(n,e),Gn(r)===!1)return typeof r=="object"?(i=this.getCellMeta(n,e),J0(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function HL(n,e,t){return(e=Q7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Q7(n){var e=Z7(n,"string");return typeof e=="symbol"?e:e+""}function Z7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function J7(){return class{}}class eQ{constructor(e){HL(this,"metaCtor",J7()),HL(this,"meta",void 0),this.meta=this.metaCtor.prototype,ir(this.meta,vB()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;ir(this.meta,e),XC(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}function tQ(n,e,t){return(e=nQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nQ(n){var e=rQ(n,"string");return typeof e=="symbol"?e:e+""}function rQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class iQ{constructor(e){tQ(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){ir(this.meta,e),XC(this.meta,e,e)}}function Yp(n,e,t){return(e=sQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sQ(n){var e=oQ(n,"string");return typeof e=="symbol"?e:e+""}function oQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class my{constructor(e){Yp(this,"valueFactory",void 0),Yp(this,"data",[]),Yp(this,"index",[]),Yp(this,"holes",new Set),this.valueFactory=e}obtain(e){Sv(()=>Cv(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let r;if(t>=0)r=this.data[t],r===void 0&&(r=this.valueFactory(e),this.data[t]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Sv(()=>Cv(e)||zp(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let o=0;o<t;o++)r.push(i+o),this.data.push(void 0);const s=zp(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...r,...this.index.slice(s)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Sv(()=>Cv(e)||zp(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(zp(e)?this.index.length-t:e,t);for(let i=0;i<r.length;i++){const s=r[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return vu(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let t=0;return{next:()=>{if(t<e.length){const r=e[t];return t+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function FL(n,e,t){return(e=aQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aQ(n){var e=lQ(n,"string");return typeof e=="symbol"?e:e+""}function lQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const uQ=["data","width"];class hQ{constructor(e){FL(this,"globalMeta",void 0),FL(this,"metas",new my(()=>this._createMeta())),this.globalMeta=e,this.metas=new my(()=>this._createMeta())}updateMeta(e,t){const r=this.getMeta(e);ir(r,t),XC(r,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return X7(this.globalMeta.getMetaConstructor(),uQ).prototype}}function kL(n,e,t){return(e=cQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cQ(n){var e=dQ(n,"string");return typeof e=="symbol"?e:e+""}function dQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class fQ{constructor(e){kL(this,"columnMeta",void 0),kL(this,"metas",new my(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,r){const i=this.getMeta(e,t);ir(i,r),XC(i,r)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,t)}getMeta(e,t,r){const i=this.metas.obtain(e).obtain(t);return r===void 0?i:i[r]}setMeta(e,t,r,i){var s;const o=this.metas.obtain(e).obtain(t);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(r),o[r]=i}removeMeta(e,t,r){const i=this.metas.obtain(e).obtain(t);delete i[r]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let r=0;r<t.length;r++)_e(t[r])&&e.push(...t[r].values());return e}getMetasAtRow(e){Sv(()=>Cv(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new my(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class yB{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new eQ(e),this.tableMeta=new iQ(this.globalMeta),this.columnMeta=new hQ(this.globalMeta),this.cellMeta=new fQ(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,r){let{visualRow:i,visualColumn:s}=r;const o=this.cellMeta.getMeta(e,t);return o.visualRow=i,o.visualCol=s,o.row=e,o.col=t,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,t,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,r)}setCellMeta(e,t,r,i){this.cellMeta.setMeta(e,t,r,i)}updateCellMeta(e,t,r){this.cellMeta.updateMeta(e,t,r)}removeCellMeta(e,t,r){this.cellMeta.removeMeta(e,t,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}en(yB,Br);function VL(n,e,t,r){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:h}=r,c=yo(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":fn(d.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),n=i.runHooks(`before${c}`,n,h,l);const f=new md(i,n,u);if(e(f),typeof n=="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null){const m=f.getSchema();n=[];let p,v=0,y=0;for(v=0,y=d.startRows;v<y;v++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)p=mi(m),n.push(p);else if(i.dataType==="array")p=mi(m[0]),n.push(p);else{p=[];for(let S=0,R=d.startCols;S<R;S++)p.push(null);n.push(p)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof n} given)`);Array.isArray(n[0])&&(i.dataType="array"),d.data=n,f.dataSource=n,o.data=n,o.dataType=i.dataType,o.colToProp=f.colToProp.bind(f),o.propToCol=f.propToCol.bind(f),o.countCachedColumns=f.countCachedColumns.bind(f),t(f),i.runHooks(`after${c}`,n,h,l),h||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Xe(i.rootElement,[JV(-1),HC(i.countCols()+(i.view?i.countRowHeaders():0))])}function UL(n,e,t){return(e=mQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function mQ(n){var e=gQ(n,"string");return typeof e=="symbol"?e:e+""}function gQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class pQ{constructor(e){UL(this,"metaManager",void 0),UL(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),Ie.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:r,col:i}=e;if((t=this.metaSyncMemo.get(r))!==null&&t!==void 0&&t.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const u=Ln(e,"type")?e.type:null;let h=fn(e.cells)?e.cells(r,i,l):null;if(u)if(h){var c;h.type=(c=h.type)!==null&&c!==void 0?c:u}else h={type:u};h&&this.metaManager.updateCellMeta(r,i,h),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function wQ(n,e,t){vQ(n,e),e.set(n,t)}function vQ(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lb(n,e,t){return(e=yQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yQ(n){var e=CQ(n,"string");return typeof e=="symbol"?e:e+""}function CQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function SQ(n,e){return n.get(RQ(n,e))}function RQ(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var BL=new WeakMap;class EQ{constructor(e){Lb(this,"metaManager",void 0),Lb(this,"usageTracker",new Set),Lb(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),wQ(this,BL,(t,r,i)=>{if(!i)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{initOnly:r,target:i,onChange:s}=e,o=typeof i=="string",a=o?i:t,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(t,l,s),o&&this.installPropWatcher(i,l,s)):r&&(this.installPropWatcher(t,l,SQ(BL,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,s,o),this[t]=s},enumerable:!0,configurable:!0})}}const CB="gridDefault",Tu="editorManager.handlingEditor",bQ={name:"editorCloseAndSave",callback(n){n._getEditorManager().closeEditorAndSaveChanges()}},TQ="hooksRefRegisterer",SB={_hooksStorage:Object.create(null),addHook(n,e){return this._hooksStorage[n]||(this._hooksStorage[n]=[]),this.hot.addHook(n,e),this._hooksStorage[n].push(e),this},removeHooksByKey(n){D(this._hooksStorage[n]||[],e=>{this.hot.removeHook(n,e)})},clearHooks(){gt(this._hooksStorage,(n,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Cl(SB,"MIXIN_NAME",TQ,{writable:!1,enumerable:!1});function Ys(n,e,t){return(e=AQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AQ(n){var e=NQ(n,"string");return typeof e=="symbol"?e:e+""}function NQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const IQ="base",Bn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class nf{static get EDITOR_TYPE(){return IQ}constructor(e){Ys(this,"hot",void 0),Ys(this,"state",Bn.VIRGIN),Ys(this,"_opened",!1),Ys(this,"_fullEditMode",!1),Ys(this,"_closeCallback",null),Ys(this,"TD",null),Ys(this,"row",null),Ys(this,"col",null),Ys(this,"prop",null),Ys(this,"originalValue",null),Ys(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,r,i,s,o){this.TD=i,this.row=e,this.col=t,this.prop=r,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:Bn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let r,i,s,o;if(t){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),s=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[r,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,s,o,"edit")}beginEditing(e,t){if(this.state!==Bn.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,s)),this.state=Bn.EDITING,this.isInFullEditMode()){const o=typeof e=="string"?e:Zn(this.originalValue);this.setValue(o)}this.open(t),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,r){let i;if(r){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),r(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Bn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Bn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=Bn.WAITING,this.saveValue(i,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=Bn.FINISHED,this.discardEditor(o)}):(this.state=Bn.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Bn.FINISHED,this.discardEditor()}discardEditor(e){this.state===Bn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Bn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Bn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Bn.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=br(t),a=gn(t),l=br(this.hot.rootElement),u=gn(this.hot.rootElement),h=r.topOverlay.holder,c=r.inlineStartOverlay.holder,d=h!==s?h.scrollTop:0,f=c!==s?c.scrollLeft:0,m=s.innerWidth-l.left-u,{wtTable:p}=(e=r.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,v=p.name,y=["master","inline_start"].includes(v)?d:0,S=["master","top","bottom"].includes(v)?f:0,R=o.top===l.top?0:1;let T=o.top-l.top-R-y,I=0;this.hot.isRtl()?I=s.innerWidth-o.left-a-m-1+S:I=o.left-l.left-1-S,["top","top_inline_start_corner"].includes(v)&&(T+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(v)&&(I+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const H=this.hot.hasColHeaders(),k=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),W=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),$=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(H&&k<=0||k===$)&&(T+=1),W<=0&&(I+=1);const q=i.rowsRenderCalculator.startPosition,J=i.columnsRenderCalculator.startPosition,re=Math.abs(r.inlineStartOverlay.getScrollPosition()),ie=r.topOverlay.getScrollPosition(),ae=Tr(this.hot.rootDocument);let Ve=t.offsetTop;if(["inline_start","master"].includes(v)&&(Ve+=q-ie),["bottom","bottom_inline_start_corner"].includes(v)){const{wtViewport:ne,wtTable:he}=r.bottomOverlay.clone;Ve+=ne.getWorkspaceHeight()-he.getHeight()-ae}let De=t.offsetLeft;this.hot.isRtl()?(De>=0?De=p.getWidth()-t.offsetLeft:De=Math.abs(De),De+=J-re-a):["top","master","bottom"].includes(v)&&(De+=J-re);const Se=fl(this.TD,this.hot.rootWindow),pe=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",ze=parseInt(Se[pe],10)>0?0:1,w=parseInt(Se.borderTopWidth,10)>0?0:1,C=gn(t)+ze,b=er(t)+w,P=S4(h)?ae:0,L=R4(c)?ae:0,G=this.hot.view.maximumVisibleElementWidth(De)-P+ze,ee=Math.max(this.hot.view.maximumVisibleElementHeight(Ve)-L+w,23);return{top:T,start:I,height:b,maxHeight:ee,width:C,maxWidth:G}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}en(nf,SB);const MQ={name:"editorCloseAndSaveByArrowKeys",callback(n,e,t){const r=n._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Bn.EDITING||(r.closeEditorAndSaveChanges(),n.getSelected()&&(t.includes("arrowdown")?n.selection.transformStart(1,0):t.includes("arrowup")?n.selection.transformStart(-1,0):t.includes("arrowleft")?n.selection.transformStart(0,-1*n.getDirectionFactor()):t.includes("arrowright")&&n.selection.transformStart(0,n.getDirectionFactor())),e.preventDefault())}},OQ={name:"editorCloseAndSaveByEnter",callback(n,e){const t=n._getEditorManager();t.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),t.moveSelectionAfterEnter(e)}},_Q={name:"editorCloseWithoutSaving",callback(n){const e=n._getEditorManager();e.closeEditorAndRestoreOriginalValue(n.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},xQ={name:"editorFastOpen",callback(n,e){const{highlight:t}=n.getSelectedRangeLast();t.isHeader()||n._getEditorManager().openEditor(null,e,!0)}},PQ={name:"editorOpen",callback(n,e,t){const r=n._getEditorManager(),i=n.getSelectedRangeLast(),{highlight:s}=i;if(n.selection.isMultiple()&&!i.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0){const o=n.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;t.includes("shift")?n.selection.transformFocus(-a.row,-a.col):n.selection.transformFocus(a.row,a.col);return}s.isHeader()||(n.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),To(e))}};function LQ(){return[bQ,MQ,OQ,_Q,xQ,PQ]}const DQ={name:"extendCellsSelectionDown",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByColumnHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(1,0)}},HQ={name:"extendCellsSelectionDownByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.min(e.row+n.countVisibleRows(),n.countRows()-1),r=n.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(r!==null){const i=n._createCellCoords(r,e.col),s=e.row-n.view.getFirstFullyVisibleRow(),o=Math.min(i.row-s,n.countRows()-1);n.selection.setRangeEnd(i),n.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},FQ={name:"extendCellsSelectionLeft",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,-1*n.getDirectionFactor())}},kQ={name:"extendCellsSelectionRight",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,n.getDirectionFactor())}},VQ={name:"extendCellsSelectionToColumns",callback(n){const{highlight:e,from:t,to:r}=n.getSelectedRangeLast();n.selection.isSelectedByRowHeader()?n.selection.selectAll(!0,!0):n.selectColumns(t.col,r.col,e)}},UQ={name:"extendCellsSelectionToMostBottom",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast(),o=r.isHeader()&&n.selection.isSelectedByRowHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(n.countRows()-1,-1),l=i.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,s.col))}}},BQ={name:"extendCellsSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast();if(!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&r.isCell()){const o=t.getNearestNotHiddenIndex(n.countCols()-1,-1),a=i.clone();a.col=r.col,e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(n._createCellCoords(s.row,o))}}},WQ={name:"extendCellsSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast();if(!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&r.isCell()){const o=parseInt(n.getSettings().fixedColumnsStart,10),a=t.getNearestNotHiddenIndex(o,1),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(n._createCellCoords(s.row,a))}}},$Q={name:"extendCellsSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast(),o=r.isHeader()&&n.selection.isSelectedByColumnHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(s.row,a))}}},GQ={name:"extendCellsSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast(),o=r.isHeader()&&n.selection.isSelectedByColumnHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(s.row,a))}}},jQ={name:"extendCellsSelectionToMostTop",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast(),o=r.isHeader()&&n.selection.isSelectedByRowHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,s.col))}}},zQ={name:"extendCellsSelectionToRows",callback(n){const{highlight:e,from:t,to:r}=n.getSelectedRangeLast();n.selection.isSelectedByColumnHeader()?n.selection.selectAll(!0,!0):n.selectRows(t.row,r.row,e)}},YQ={name:"extendCellsSelectionUp",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByColumnHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(-1,0)}},KQ={name:"extendCellsSelectionUpByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.max(e.row-n.countVisibleRows(),0),r=n.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(r!==null){const i=n._createCellCoords(r,e.col),s=e.row-n.view.getFirstFullyVisibleRow(),o=Math.max(i.row-s,0);n.selection.setRangeEnd(i),n.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}};function qQ(){return[DQ,HQ,FQ,kQ,VQ,UQ,BQ,WQ,$Q,GQ,jQ,zQ,YQ,KQ]}const XQ={name:"moveCellSelectionDown",callback(n){let{selection:e}=n;e.transformStart(1,0)}},QQ={name:"moveCellSelectionDownByViewportHeight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:r}=n.getSelectedRangeLast().highlight;let i=n.countVisibleRows()+t;r===n.countRows()-1?i=1:r+i>n.countRows()&&(i=n.countRows()-r-1),n.selection.transformStart(i,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}},ZQ={name:"moveCellSelectionInlineEnd",callback(n,e){const t=n.getSettings(),r=n.getSelectedRangeLast(),i=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;n.selection.isMultiple()&&!r.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0?n.selection.transformFocus(-i.row,-i.col):n.selection.transformStart(-i.row,-i.col)}},JQ={name:"moveCellSelectionInlineStart",callback(n,e){const t=n.getSettings(),r=n.getSelectedRangeLast(),i=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;n.selection.isMultiple()&&!r.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0?n.selection.transformFocus(i.row,i.col):n.selection.transformStart(i.row,i.col)}},eZ={name:"moveCellSelectionLeft",callback(n){n.selection.transformStart(0,-1*n.getDirectionFactor())}},tZ={name:"moveCellSelectionRight",callback(n){n.selection.transformStart(0,n.getDirectionFactor())}},nZ={name:"moveCellSelectionToMostBottom",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(n.countRows()-1,-1);t===null&&(t=-1),n.selection.setRangeStart(n._createCellCoords(t,e))}},rZ={name:"moveCellSelectionToMostBottomInlineEnd",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:r}=n,i=parseInt(n.getSettings().fixedRowsBottom,10),s=t.getNearestNotHiddenIndex(n.countRows()-i-1,-1),o=r.getNearestNotHiddenIndex(n.countCols()-1,-1);e.setRangeStart(n._createCellCoords(s,o))}},iZ={name:"moveCellSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n;e.setRangeStart(n._createCellCoords(n.getSelectedRangeLast().highlight.row,t.getNearestNotHiddenIndex(n.countCols()-1,-1)))}},sZ={name:"moveCellSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,r=parseInt(n.getSettings().fixedColumnsStart,10),i=n.getSelectedRangeLast().highlight.row,s=t.getNearestNotHiddenIndex(r,1);e.setRangeStart(n._createCellCoords(i,s))}},oZ={name:"moveCellSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,r=n.getSelectedRangeLast().highlight.row;let i=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]);i===null&&(i=n.isRtl()?-1:-n.countRowHeaders()),e.setRangeStart(n._createCellCoords(r,i))}},aZ={name:"moveCellSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{row:r}=n.getSelectedRangeLast().highlight;let i=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]);i===null&&(i=n.isRtl()?-n.countRowHeaders():-1),e.setRangeStart(n._createCellCoords(r,i))}},lZ={name:"moveCellSelectionToMostTop",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(0,1);t===null&&(t=-n.countColHeaders()),n.selection.setRangeStart(n._createCellCoords(t,e))}},uZ={name:"moveCellSelectionToMostTopInlineStart",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:r}=n,i=parseInt(n.getSettings().fixedRowsTop,10),s=parseInt(n.getSettings().fixedColumnsStart,10),o=t.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(s,1);e.setRangeStart(n._createCellCoords(o,a))}},hZ={name:"moveCellSelectionUp",callback(n){let{selection:e}=n;e.transformStart(-1,0)}},cZ={name:"moveCellSelectionUpByViewportHight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:r}=n.getSelectedRangeLast().highlight;let i=-(n.countVisibleRows()+t);r===-t?i=-1:r+i<t&&(i=-(r+t)),n.selection.transformStart(i,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}};function dZ(){return[XQ,QQ,ZQ,JQ,eZ,tZ,nZ,rZ,iZ,sZ,oZ,aZ,lZ,uZ,hZ,cZ]}const fZ={name:"emptySelectedCells",callback(n){n.emptySelectedCells(),n._getEditorManager().prepareEditor()}},mZ={name:"scrollToFocusedCell",callback(n){const{highlight:e}=n.getSelectedRangeLast(),t=n.view.getFirstFullyVisibleRow()-1,r=n.view.getFirstFullyVisibleColumn()-1,i=n.view.getLastFullyVisibleRow()+1,s=n.view.getLastFullyVisibleColumn()+1,o=n._createCellCoords(t,r),a=n._createCellCoords(i,s);if(!n._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const h=Math.floor(n.countVisibleCols()/2);u.col=Math.max(e.col-h,0)}if(e.row>=0){const h=Math.floor(n.countVisibleRows()/2);u.row=Math.max(e.row-h,0)}n.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},gZ={name:"selectAllCells",callback(n){n.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},pZ={name:"selectAllCellsAndHeaders",callback(n){n.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},wZ={name:"populateSelectedCellsData",callback(n){const e=n.getSelectedRange(),{row:t,col:r}=e[e.length-1].highlight.normalize(),i=n.getDataAtCell(t,r),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==t||l!==r)){const{readOnly:u}=n.getCellMeta(a,l);u||s.set(`${a}x${l}`,[a,l,i])}});n.setDataAtCell(Array.from(s.values()))}},vZ=[...LQ(),...qQ(),...dZ(),fZ,mZ,gZ,pZ,wZ];function RB(n){const e={};return vZ.forEach(t=>{let{name:r,callback:i}=t;e[r]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i(n,...o)}}),e}function yZ(n){const e=n.getShortcutManager().addContext("editor"),t=RB(n),r={group:Tu};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>t.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>t.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:n.getShortcutManager().getContext("grid"),callback:(i,s)=>t.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>t.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>t.editorCloseWithoutSaving()}],r)}function CZ(n){const e=n.getShortcutManager().addContext("grid"),t=RB(n),r={runOnlyIf:()=>{const{navigableHeaders:i}=n.getSettings();return _e(n.getSelected())&&(i||!i&&n.countRenderedRows()>0&&n.countRenderedCols()>0)},group:CB};e.addShortcuts([{keys:[["F2"]],callback:i=>t.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>t.editorOpen(i,s)},{keys:[["Backspace"],["Delete"]],callback:()=>t.emptySelectedCells()}],{group:Tu,runOnlyIf:()=>_e(n.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>t.selectAllCells(),runOnlyIf:()=>{var i;return!((i=n.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=n.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>t.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>t.populateSelectedCellsData(),runOnlyIf:()=>{var i,s;return!((i=n.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((s=n.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>t.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>t.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>t.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>t.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>t.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>t.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>t.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>t.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>t.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>t.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>t.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>t.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>t.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>t.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>t.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>t.scrollToFocusedCell()}],r)}function SZ(n){[CZ,yZ].forEach(e=>e(n))}function RZ(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=n.rootElement,r=WL(n),i=WL(n);return r.addEventListener("focus",()=>e?.onFocusFromTop()),i.addEventListener("focus",()=>e?.onFocusFromBottom()),t.firstChild.before(r),t.lastChild.after(i),{activate(){n._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){n._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function WL(n){const t=n.rootDocument.createElement("input");return t.type="text",t.classList.add("htFocusCatcher"),n.getSettings().ariaTags&&Xe(t,[ua(),ac()]),t}function EZ(n){const e=bZ(n);let t;const{activate:r,deactivate:i}=RZ(n,{onFocusFromTop(){var c;const d=(c=e(t))!==null&&c!==void 0?c:JA(n);d&&(n.runHooks("modifyFocusOnTabNavigation","from_above",d),n.selectCell(d.row,d.col)),n.listen()},onFocusFromBottom(){var c;const d=(c=e(t))!==null&&c!==void 0?c:eN(n);d&&(n.runHooks("modifyFocusOnTabNavigation","from_below",d),n.selectCell(d.row,d.col)),n.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;n.addHook("afterListen",()=>i()),n.addHook("afterUnlisten",()=>r()),n.addHook("afterSelection",(c,d,f,m,p)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,p.value=!0),o){var v;t=(v=n.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight}}),n.addHook("beforeRowWrap",(c,d,f)=>{s.wrapped=!0,s.flipped=f});function u(){s.wrapped=!1,s.flipped=!1,n.deselectCell(),n.unlisten()}const h={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:CB,group:"focusCatcher"};n.getShortcutManager().getContext("grid").addShortcuts([{...h,callback:()=>{const{tabNavigation:c}=n.getSettings();a=!0,n.getSelectedRangeLast()&&!c&&(o=!1),c||(l=!0)},position:"before"},{...h,callback:c=>{const{tabNavigation:d,autoWrapRow:f}=n.getSettings();if(a=!1,o=!0,!d||!n.selection.isSelected()||f&&s.wrapped&&s.flipped||!f&&s.wrapped)return f&&s.wrapped&&s.flipped&&(t=c.shiftKey?JA(n):eN(n)),u(),!1;c.preventDefault()},position:"after"}])}function JA(n){const{rowIndexMapper:e,columnIndexMapper:t}=n,{navigableHeaders:r}=n.getSettings();let i=r&&n.countColHeaders()>0?-n.countColHeaders():0,s=r&&n.countRowHeaders()>0?-n.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=t.getVisualFromRenderableIndex(s)),i===null||s===null?null:n._createCellCoords(i,s)}function eN(n){var e,t;const{rowIndexMapper:r,columnIndexMapper:i}=n,{navigableHeaders:s}=n.getSettings();let o=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(o<0){if(!s||n.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||n.countColHeaders()===0)return null;a=-1}return n._createCellCoords((e=r.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(t=i.getVisualFromRenderableIndex(a))!==null&&t!==void 0?t:a)}function bZ(n){return e=>{if(!e)return null;const t=JA(n),r=eN(n);return e.col<t.col&&(e.col=t.col),e.col>r.col&&(e.col=r.col),e.row<t.row&&(e.row=t.row),e.row>r.row&&(e.row=r.row),e}}function TZ(n){return e=>{let{col:t}=e;n.scrollViewportTo({col:t})}}function AZ(){return()=>{}}function NZ(n){return e=>{n.scrollViewportTo(e.toObject())}}function IZ(n){return e=>{n.scrollViewportTo(e.toObject())}}function MZ(n){return e=>{n.scrollViewportTo(e.toObject())}}function OZ(n){return e=>{let{row:t}=e;n.scrollViewportTo({row:t})}}function _Z(n){return e=>{const t=n.selection.getSelectionSource(),{row:r,col:i}=e;if(r<0&&i>=0)n.scrollViewportTo({col:i});else if(i<0&&r>=0)n.scrollViewportTo({row:r});else{if(t==="mouse"&&(i===n.view.getLastPartiallyVisibleColumn()||r===n.view.getLastPartiallyVisibleRow()))return;n.scrollViewportTo({row:r,col:i})}}}function xZ(n){const{selection:e}=n;let t=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){t=!0},scrollTo(i){var s;if(t||r){t=!1;return}let o;e.isFocusSelectionChanged()?o=NZ(n):e.isSelectedByCorner()?o=AZ():e.isSelectedByRowHeader()?o=OZ(n):e.isSelectedByColumnHeader()?o=TZ(n):e.getSelectedRange().size()===1&&e.isMultiple()?o=IZ(n):e.getSelectedRange().size()===1&&!e.isMultiple()?o=_Z(n):e.getSelectedRange().size()>1&&(o=MZ(n)),(s=o)===null||s===void 0||s(i)}}}const $L=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Kp=n=>n.map(e=>{const t=e.toLowerCase();return $L.has(t)?$L.get(t):t}).sort().join("+"),PZ=n=>n.split("+"),GL=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Db=n=>{let{which:e,key:t}=n;if(GL.has(e))return GL.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:t.toLowerCase()},EB=Symbol("shortcut-context");function bB(n){return mt(n)&&n.__kindOf===EB}const LZ=n=>{const e=UC({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${n}" context.`}),t=function(){let{keys:l,callback:u,group:h,runOnlyIf:c=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:m=!1,relativeToGroup:p,position:v,forwardToContext:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(mn(h))throw new Error("You need to define the shortcut's group.");if(fn(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Yt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const S={callback:u,group:h,runOnlyIf:c,captureCtrl:d,preventDefault:f,stopPropagation:m};_e(p)&&(S.relativeToGroup=p,S.position=v),bB(y)&&(S.forwardToContext=y),l.forEach(R=>{const T=Kp(R);if(e.hasItem(T)){const H=e.getItem(T);let k=H.findIndex(W=>W.group===p);k!==-1?v==="before"?k-=1:k+=1:k=H.length,H.splice(k,0,S)}else e.addItem(T,[S])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(h=>{gt(u,(c,d)=>{Object.prototype.hasOwnProperty.call(h,d)===!1&&(h[d]=u[d])}),t(h)})},i=l=>{const u=Kp(l);e.removeItem(u)};return{__kindOf:EB,addShortcut:t,addShortcuts:r,getShortcuts:l=>{const u=Kp(l),h=e.getItem(u);return _e(h)?h.slice():[]},hasShortcut:l=>{const u=Kp(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(h=>{let[c,d]=h;const f=d.filter(m=>m.group!==l);f.length===0?i(PZ(c)):(d.length=0,d.push(...f))})}}};function DZ(){const n=new Set;return{press(e){n.add(e)},release(e){n.delete(e)},releaseAll(){n.clear()},isPressed(e){return n.has(e)}}}const HZ=["meta","alt","shift","control"],Pf=DZ(),Lf=[];let qp=0;function FZ(n,e,t,r,i){const s=f=>HZ.includes(f),o=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=[];return f.altKey&&p.push("alt"),m&&(f.ctrlKey||f.metaKey)?p.push("control/meta"):(f.ctrlKey&&p.push("control"),f.metaKey&&p.push("meta")),f.shiftKey&&p.push("shift"),p},a=f=>{if(e(f)===!1)return;const m=t(f);if(f.keyCode===229||m===!1||bh(f))return;const p=Db(f);let v=[];s(p)||(v=o(f));const y=[p].concat(v);!i(f,y)&&($A()&&v.includes("meta")||!$A()&&v.includes("control"))&&i(f,[p].concat(o(f,!0))),r(f)},l=f=>{if(f.key){const m=Db(f);s(m)&&Pf.press(m)}},u=f=>{if(f.key){const m=Db(f);s(m)&&Pf.release(m)}},h=()=>{Pf.releaseAll()};return{mount:()=>{let f=n;for(qp+=1;f;)qp===1&&(f.document.documentElement.addEventListener("keydown",l),Lf.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Lf.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",h),f=Hd(f)},unmount:()=>{let f=n;for(qp-=1;f;){if(qp===0){for(let m=0;m<Lf.length;m++){const{event:p,listener:v}=Lf[m];f.document.documentElement.removeEventListener(p,v)}Lf.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",h),f=Hd(f)}},isPressed:f=>Pf.isPressed(f),releasePressedKeys:()=>Pf.releaseAll()}}const kZ=n=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:r,afterKeyDown:i}=n;const s=UC({errorIdExists:m=>`The "${m}" context name is already registered.`});let o="grid";const a=m=>{const p=LZ(m);return s.addItem(m,p),p},l=()=>o,u=m=>s.getItem(m),h=m=>{if(!s.hasItem(m))throw new Error(Yt`You've tried to activate the "${m}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=m};let c=!1;const d=function(m,p){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const y=bB(v)?v:u(v);let S=!1;if(!y.hasShortcut(p))return S;const R=y.getShortcuts(p);for(let T=0;T<R.length;T++){const{callback:I,runOnlyIf:H,preventDefault:k,stopPropagation:W,captureCtrl:Y,forwardToContext:$}=R[T];if(H(m)===!0){if(c=Y,S=I(m,p)===!1,c=!1,k&&m.preventDefault(),W&&(To(m),m.stopPropagation()),S)break;$&&d(m,p,$)}}return S},f=FZ(e,t,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:h,isCtrlPressed:()=>!c&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};let Hb=null;const Fb=new Map;function TB(n,e){var t,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const o=new Co(s);let a,l,u,h,c,d,f=!0;R8(i)&&S8(this),this.rootElement=n,this.rootDocument=n.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=(t=e?.layoutDirection)!==null&&t!==void 0?t:"inherit",p=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return p==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=g7(e.language);const v=new yB(s,e,[pQ,EQ]),y=v.getTableMeta(),S=v.getGlobalMeta(),R=UC();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,n.insertBefore(this.container,n.firstChild),vv(this)&&B6(e.licenseKey,n),this.guid=`ht_${YV()}`,Fb.set(this.guid,this),this.columnIndexMapper=new XA,this.rowIndexMapper=new XA,this.columnIndexMapper.addLocalHook("indexesSequenceChange",w=>{s.runHooks("afterColumnSequenceChange",w)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",w=>{s.runHooks("afterRowSequenceChange",w)}),l=new L8(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const T=w=>{const{row:C,col:b}=w;return s._createCellCoords(C>=0?s.rowIndexMapper.getRenderableFromVisualIndex(C):C,b>=0?s.columnIndexMapper.getRenderableFromVisualIndex(b):b)},I=w=>{const{row:C,col:b}=w;return s._createCellCoords(C>=0?s.rowIndexMapper.getVisualFromRenderableIndex(C):C,b>=0?s.columnIndexMapper.getVisualFromRenderableIndex(b):b)},H=(w,C)=>{const b=C>w?1:-1,P=Math.min(w,C),L=Math.max(w,C),G=s.rowIndexMapper.getNearestNotHiddenIndex(w,b);return G===null||b===1&&G>L||b===-1&&G<P?null:G>=0?s.rowIndexMapper.getRenderableFromVisualIndex(G):G},k=(w,C)=>{const b=C>w?1:-1,P=Math.min(w,C),L=Math.max(w,C),G=s.columnIndexMapper.getNearestNotHiddenIndex(w,b);return G===null||b===1&&G>L||b===-1&&G<P?null:G>=0?s.columnIndexMapper.getRenderableFromVisualIndex(G):G};let W=new pB(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:w=>a.propToCol(w),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(w,C)=>s._createCellCoords(w,C),createCellRange:(w,C,b)=>s._createCellRange(w,C,b),visualToRenderableCoords:T,renderableToVisualCoords:I,findFirstNonHiddenRenderableRow:H,findFirstNonHiddenRenderableColumn:k,isDisabledCellSelection:(w,C)=>w<0||C<0?s.getSettings().disableVisualSelection:s.getCellMeta(w,C).disableVisualSelection});this.selection=W;const Y=w=>{let{hiddenIndexesChanged:C}=w;C&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Y),this.rowIndexMapper.addLocalHook("cacheUpdated",Y),this.selection.addLocalHook("afterSetRangeEnd",(w,C)=>{const b=co(!1),P=this.selection.getSelectedRange(),{from:L,to:G}=P.current(),ee=P.size()-1;this.runHooks("afterSelection",L.row,L.col,G.row,G.col,b,ee),this.runHooks("afterSelectionByProp",L.row,s.colToProp(L.col),G.row,s.colToProp(G.col),b,ee),C&&(!b.isTouched()||b.isTouched()&&!b.value)&&d.scrollTo(w);const ne=W.isSelectedByRowHeader(),he=W.isSelectedByColumnHeader();ne&&he?ue(this.rootElement,["ht__selection--rows","ht__selection--columns"]):ne?(rt(this.rootElement,"ht__selection--columns"),ue(this.rootElement,"ht__selection--rows")):he?(rt(this.rootElement,"ht__selection--rows"),ue(this.rootElement,"ht__selection--columns")):rt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),W.getSelectionSource()!=="shift"&&h.closeEditor(null),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",w=>{this.runHooks("beforeSelectionFocusSet",w.row,w.col)}),this.selection.addLocalHook("afterSetFocus",w=>{const C=co(!1);this.runHooks("afterSelectionFocusSet",w.row,w.col,C),(!C.isTouched()||C.isTouched()&&!C.value)&&d.scrollTo(w),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",w=>{const C=w.length-1,{from:b,to:P}=w[C];this.runHooks("afterSelectionEnd",b.row,b.col,P.row,P.col,C),this.runHooks("afterSelectionEndByProp",b.row,s.colToProp(b.col),P.row,s.colToProp(P.col),C)}),this.selection.addLocalHook("afterIsMultipleSelection",w=>{const C=this.runHooks("afterIsMultipleSelection",w.value);w.value&&(w.value=C)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),rt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeSetRangeStart",...C)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeSetRangeStartOnly",...C)}).addLocalHook("beforeSetRangeEnd",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeSetRangeEnd",...C)}).addLocalHook("beforeSelectColumns",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeSelectColumns",...C)}).addLocalHook("afterSelectColumns",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("afterSelectColumns",...C)}).addLocalHook("beforeSelectRows",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeSelectRows",...C)}).addLocalHook("afterSelectRows",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("afterSelectRows",...C)}).addLocalHook("beforeModifyTransformStart",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("modifyTransformStart",...C)}).addLocalHook("afterModifyTransformStart",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("afterModifyTransformStart",...C)}).addLocalHook("beforeModifyTransformFocus",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("modifyTransformFocus",...C)}).addLocalHook("afterModifyTransformFocus",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("afterModifyTransformFocus",...C)}).addLocalHook("beforeModifyTransformEnd",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("modifyTransformEnd",...C)}).addLocalHook("afterModifyTransformEnd",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("afterModifyTransformEnd",...C)}).addLocalHook("beforeRowWrap",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeRowWrap",...C)}).addLocalHook("beforeColumnWrap",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeColumnWrap",...C)}).addLocalHook("insertRowRequire",w=>this.alter("insert_row_above",w,1,"auto")).addLocalHook("insertColRequire",w=>this.alter("insert_col_start",w,1,"auto")),u={alter(w,C){var b,P;let L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,G=arguments.length>3?arguments[3]:void 0,ee=arguments.length>4?arguments[4]:void 0;const ne=he=>{if(he.length===0)return[];const we=[...he];return we.sort((We,Ke)=>{let[Q]=We,[Qe]=Ke;return Q===Qe?0:Q>Qe?1:-1}),gi(we,(We,Ke)=>{let[Q,Qe]=Ke;const et=We[We.length-1],[ht,Ze]=et,ke=ht+Ze;if(Q<=ke){const A=Math.max(Qe-(ke-Q),0);et[1]+=A}else We.push([Q,Qe]);return We},[we[0]])};switch(w){case"insert_row_below":case"insert_row_above":const he=s.countSourceRows();if(y.maxRows===he)return;const we=w==="insert_row_below"?"below":"above";C=(b=C)!==null&&b!==void 0?b:we==="below"?he:0;const{delta:oe,startPhysicalIndex:We}=a.createRow(C,L,{source:G,mode:we});W.shiftRows(s.toVisualRow(We),oe);break;case"insert_col_start":case"insert_col_end":const Ke=w==="insert_col_end"?"end":"start";C=(P=C)!==null&&P!==void 0?P:Ke==="end"?s.countSourceCols():0;const{delta:Q,startPhysicalIndex:Qe}=a.createCol(C,L,{source:G,mode:Ke});if(Q){if(Array.isArray(y.colHeaders)){const Ze=[s.toVisualColumn(Qe),0];Ze.length+=Q,Array.prototype.splice.apply(y.colHeaders,Ze)}W.shiftColumns(s.toVisualColumn(Qe),Q)}break;case"remove_row":const et=Ze=>{let ke=0;D(Ze,A=>{let[O,x]=A;const z=Gn(O)?s.countRows()-1:Math.max(O-ke,0);if(Number.isInteger(O)&&(O=Math.max(O-ke,0)),!a.removeRow(O,x,G))return;if(W.isSelected()){const{row:K}=s.getSelectedRangeLast().highlight;K>=O&&K<=O+x-1&&h.closeEditor(!0)}const X=s.countRows();X===0?W.deselect():G==="ContextMenu.removeRow"?W.refresh():W.shiftRows(O,-x);const B=y.fixedRowsTop;B>=z+1&&(y.fixedRowsTop-=Math.min(x,B-z));const V=y.fixedRowsBottom;V&&z>=X-V&&(y.fixedRowsBottom-=Math.min(x,V)),ke+=x})};Array.isArray(C)?et(ne(C)):et([[C,L]]);break;case"remove_col":const ht=Ze=>{let ke=0;D(Ze,A=>{let[O,x]=A;const z=Gn(O)?s.countCols()-1:Math.max(O-ke,0);let F=s.toPhysicalColumn(z);if(Number.isInteger(O)&&(O=Math.max(O-ke,0)),!a.removeCol(O,x,G))return;if(W.isSelected()){const{col:K}=s.getSelectedRangeLast().highlight;K>=O&&K<=O+x-1&&h.closeEditor(!0)}s.countCols()===0?W.deselect():G==="ContextMenu.removeColumn"?W.refresh():W.shiftColumns(O,-x);const V=y.fixedColumnsStart;V>=z+1&&(y.fixedColumnsStart-=Math.min(x,V-z)),Array.isArray(y.colHeaders)&&(typeof F>"u"&&(F=-1),y.colHeaders.splice(F,x)),ke+=x})};Array.isArray(C)?ht(ne(C)):ht([[C,L]]);break;default:throw new Error(`There is no such action "${w}"`)}s.view.render(),ee||u.adjustRowsAndCols()},adjustRowsAndCols(){const w=y.minRows,C=y.minSpareRows,b=y.minCols,P=y.minSpareCols;if(w){const L=s.countRows();L<w&&a.createRow(L,w-L,{source:"auto"})}if(C){const L=s.countEmptyRows(!0);if(L<C){const G=C-L,ee=Math.min(G,y.maxRows-s.countSourceRows());a.createRow(s.countRows(),ee,{source:"auto"})}}{let L;(b||P)&&(L=s.countEmptyCols(!0));let G=s.countCols();if(b&&!y.columns&&G<b){const ee=b-G;L+=ee,a.createCol(G,ee,{source:"auto"})}if(P&&!y.columns&&s.dataType==="array"&&L<P){G=s.countCols();const ee=P-L,ne=Math.min(ee,y.maxCols-G);a.createCol(G,ne,{source:"auto"})}}s.view&&s.view.adjustElementsSize()},populateFromArray(w,C,b,P,L){let G,ee,ne,he;const we=[],oe={},We=[],Ke=w.row,Q=w.col;if(ee=C.length,ee===0)return!1;let Qe=0,et=0;switch(mt(b)&&(Qe=b.col-Q+1,et=b.row-Ke+1),L){case"shift_down":const ht=pv(C),Ze=ht.length,ke=Math.max(Ze,Qe),A=s.getData().slice(Ke),O=pv(A).slice(Q,Q+ke);for(ne=0;ne<ke;ne+=1)if(ne<Ze){for(G=0,ee=ht[ne].length;G<et-ee;G+=1)ht[ne].push(ht[ne][G%ee]);ne<O.length?We.push(ht[ne].concat(O[ne])):We.push(ht[ne].concat(new Array(A.length).fill(null)))}else We.push(ht[ne%Ze].concat(O[ne]));s.populateFromArray(Ke,Q,pv(We));break;case"shift_right":const x=C.length,z=Math.max(x,et),F=s.getData().slice(Ke).map(be=>be.slice(Q));for(G=0;G<z;G+=1)if(G<x){for(ne=0,he=C[G].length;ne<Qe-he;ne+=1)C[G].push(C[G][ne%he]);if(G<F.length)for(let be=0;be<F[G].length;be+=1)C[G].push(F[G][be]);else C[G].push(...new Array(F[0].length).fill(null))}else C.push(C[G%ee].slice(0,z).concat(F[G]));s.populateFromArray(Ke,Q,C);break;default:oe.row=w.row,oe.col=w.col;let X=0,B=0,V=!0,K;const j=function(Ue){let nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Rt=C[Ue%C.length];return nt!==null?Rt[nt%Rt.length]:Rt},Z=C.length,me=b?b.row-w.row+1:0;for(b?ee=me:ee=Math.max(Z,me),G=0;G<ee&&!(b&&oe.row>b.row&&me>Z||!y.allowInsertRow&&oe.row>s.countRows()-1||oe.row>=y.maxRows);G++){const be=G-X,Ue=j(be).length,nt=b?b.col-w.col+1:0;if(b?he=nt:he=Math.max(Ue,nt),oe.col=w.col,K=s.getCellMeta(oe.row,oe.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&K.skipRowOnPaste){X+=1,oe.row+=1,ee+=1;continue}for(B=0,ne=0;ne<he&&!(b&&oe.col>b.col&&nt>Ue||!y.allowInsertColumn&&oe.col>s.countCols()-1||oe.col>=y.maxCols);ne++){if(K=s.getCellMeta(oe.row,oe.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&K.skipColumnOnPaste){B+=1,oe.col+=1,he+=1;continue}if(K.readOnly&&P!=="UndoRedo.undo"){oe.col+=1;continue}const Rt=ne-B;let ut=j(be,Rt),qe=s.getDataAtCell(oe.row,oe.col);if(ut!==null&&typeof ut=="object")if(Array.isArray(ut)&&qe===null&&(qe=[]),qe===null||typeof qe!="object")V=!1;else{const Ct=ag(Array.isArray(qe)?qe:qe[0]||qe),pn=ag(Array.isArray(ut)?ut:ut[0]||ut);J0(Ct,pn)||Array.isArray(Ct)&&Array.isArray(pn)?ut=mi(ut):V=!1}else qe!==null&&typeof qe=="object"&&(V=!1);V&&we.push([oe.row,oe.col,ut]),V=!0,oe.col+=1}oe.row+=1}s.setDataAtCell(we,null,null,P||"populateFromArray");break}}};function $(w){const C=iB(w);jM(C)?(s.runHooks("beforeLanguageChange",C),S.language=C,s.runHooks("afterLanguageChange",C)):sB(w)}function q(w,C){const b=w==="className"?s.rootElement:s.table;if(f)ue(b,C);else{let P=[],L=[];S[w]&&(P=Array.isArray(S[w])?S[w]:g1(S[w])),C&&(L=Array.isArray(C)?C:g1(C));const G=m1(P,L),ee=m1(L,P);G.length&&rt(b,G),ee.length&&ue(b,ee)}S[w]=C}this.init=function(){l.setData(y.data),s.runHooks("beforeInit"),(iu()||vU())&&ue(s.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new A8(this),h=zA.getInstance(s,y,W),d=xZ(s),c=new dX(s),vv(this)&&EZ(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&s.rootElement.offsetParent===null&&E4(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof f=="object"&&(s.runHooks("afterChange",f[0],f[1]),f=!1),s.runHooks("afterInit")};function J(){let w=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,w=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&w===!1&&(w=!0,this.onQueueEmpty(this.valid))}}}function re(w){const C=w.replace(",",".");return isNaN(parseFloat(C))===!1?parseFloat(C):w}function ie(w,C,b){if(!w.length){b();return}const P=s.getActiveEditor(),L=new J;let G=!0;L.onQueueEmpty=()=>{P&&G&&P.cancelChanges(),b()};for(let ee=w.length-1;ee>=0;ee--){const[ne,he,,we]=w[ee],oe=a.propToCol(he);let We;Number.isInteger(oe)?We=s.getCellMeta(ne,oe):We={...Object.getPrototypeOf(y),...y},We.type==="numeric"&&typeof we=="string"&&bX(we)&&(w[ee][3]=re(we)),s.getCellValidator(We)&&(L.addValidatorToQueue(),s.validateCell(w[ee][3],We,(function(Ke,Q){return function(Qe){if(typeof Qe!="boolean")throw new Error("Validation error: result is not boolean");Qe===!1&&Q.allowInvalid===!1&&(G=!1,w.splice(Ke,1),Q.valid=!0),L.removeValidatorFormQueue()}})(ee,We),C))}L.checkIfQueueIsEmpty()}function ae(w,C){for(let P=w.length-1;P>=0;P--){let L=!1;if(w[P]===null){w.splice(P,1);continue}if(!((w[P][2]===null||w[P][2]===void 0)&&(w[P][3]===null||w[P][3]===void 0))){if(y.allowInsertRow)for(;w[P][0]>s.countRows()-1;){const{delta:G}=a.createRow(void 0,void 0,{source:C});if(G===0){L=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;a.propToCol(w[P][1])>s.countCols()-1;){const{delta:G}=a.createCol(void 0,void 0,{source:C});if(G===0){L=!0;break}}L||a.set(w[P][0],w[P][1],w[P][3])}}const b=w.length>0;if(s.forceFullRender=!0,b){u.adjustRowsAndCols(),s.runHooks("beforeChangeRender",w,C),h.closeEditor(),s.view.render(),h.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",w,C||"edit");const P=s.getActiveEditor();P&&_e(P.refreshValue)&&P.refreshValue()}else s.view.render()}this._createCellCoords=function(w,C){return s.view._wt.createCellCoords(w,C)},this._createCellRange=function(w,C,b){return s.view._wt.createCellRange(w,C,b)},this.validateCell=function(w,C,b,P){let L=s.getCellValidator(C);function G(ee){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||C.hidden===!0){b(ee);return}const he=C.visualCol,we=C.visualRow,oe=s.getCell(we,he,!0);if(oe&&oe.nodeName!=="TH"){const We=s.rowIndexMapper.getRenderableFromVisualIndex(we),Ke=s.columnIndexMapper.getRenderableFromVisualIndex(he);s.view._wt.getSetting("cellRenderer",We,Ke,oe)}b(ee)}k6(L)&&(L=(function(ee){return function(ne,he){he(ee.test(ne))}})(L)),fn(L)?(w=s.runHooks("beforeValidate",w,C.visualRow,C.prop,P),s._registerImmediate(()=>{L.call(C,w,ee=>{s&&(ee=s.runHooks("afterValidate",ee,w,C.visualRow,C.prop,P),C.valid=ee,G(ee),s.runHooks("postAfterValidate",ee,w,C.visualRow,C.prop,P))})})):s._registerImmediate(()=>{C.valid=!0,G(C.valid,!1)})};function Ve(w,C,b){return Array.isArray(w)?w:[[w,C,b]]}function De(w,C){const b=s.getActiveEditor(),P=s.runHooks("beforeChange",w,C||"edit"),L=w.filter(G=>G!==null);return P===!1||L.length===0?(b&&b.cancelChanges(),[]):L}this.setDataAtCell=function(w,C,b,P){const L=Ve(w,C,b),G=[];let ee=P,ne,he,we;for(ne=0,he=L.length;ne<he;ne++){if(typeof L[ne]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof L[ne][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");L[ne][1]>=this.countCols()?we=L[ne][1]:we=a.colToProp(L[ne][1]),G.push([L[ne][0],we,l.getAtCell(this.toPhysicalRow(L[ne][0]),L[ne][1]),L[ne][2]])}!ee&&typeof w=="object"&&(ee=C);const oe=De(G,P);s.runHooks("afterSetDataAtCell",oe,ee),ie(oe,ee,()=>{ae(oe,ee)})},this.setDataAtRowProp=function(w,C,b,P){const L=Ve(w,C,b),G=[];let ee=P,ne,he;for(ne=0,he=L.length;ne<he;ne++)G.push([L[ne][0],L[ne][1],l.getAtCell(this.toPhysicalRow(L[ne][0]),L[ne][1]),L[ne][2]]);!ee&&typeof w=="object"&&(ee=C);const we=De(G,P);s.runHooks("afterSetDataAtRowProp",we,ee),ie(we,ee,()=>{ae(we,ee)})},this.listen=function(){s&&!s.isListening()&&(Fb.forEach(w=>{s!==w&&w.unlisten()}),Hb=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Hb=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Hb===s.guid},this.destroyEditor=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(w),s.view.render(),C&&W.isSelected()&&h.prepareEditor()},this.populateFromArray=function(w,C,b,P,L,G,ee){if(!(typeof b=="object"&&typeof b[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const ne=typeof P=="number"?s._createCellCoords(P,L):null;return u.populateFromArray(s._createCellCoords(w,C),b,ne,G,ee)},this.spliceCol=function(w,C,b){for(var P=arguments.length,L=new Array(P>3?P-3:0),G=3;G<P;G++)L[G-3]=arguments[G];return a.spliceCol(w,C,b,...L)},this.spliceRow=function(w,C,b){for(var P=arguments.length,L=new Array(P>3?P-3:0),G=3;G<P;G++)L[G-3]=arguments[G];return a.spliceRow(w,C,b,...L)},this.getSelected=function(){if(W.isSelected())return bt(W.getSelectedRange(),w=>{let{from:C,to:b}=w;return[C.row,C.col,b.row,b.col]})},this.getSelectedLast=function(){const w=this.getSelected();let C;return w&&w.length>0&&(C=w[w.length-1]),C},this.getSelectedRange=function(){if(W.isSelected())return Array.from(W.getSelectedRange())},this.getSelectedRangeLast=function(){const w=this.getSelectedRange();let C;return w&&w.length>0&&(C=w[w.length-1]),C},this.emptySelectedCells=function(w){if(!W.isSelected()||this.countRows()===0||this.countCols()===0)return;const C=[];D(W.getSelectedRange(),b=>{if(b.isSingleHeader())return;const P=b.getTopStartCorner(),L=b.getBottomEndCorner();He(P.row,L.row,G=>{He(P.col,L.col,ee=>{this.getCellMeta(G,ee).readOnly||C.push([G,ee,null])})})}),C.length>0&&this.setDataAtCell(C,w)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const w=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(w,0),!this.isRenderSuspended()&&w===this.renderSuspendedCounter&&(this.renderCall?this.render():s.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(w){this.suspendRender();const C=w();return this.resumeRender(),C},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(C,0),(!this.isExecutionSuspended()&&C===this.executionSuspendedCounter||w)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const b=w();return this.resumeExecution(C),b},this.batch=function(w){this.suspendRender(),this.suspendExecution();const C=w();return this.resumeExecution(),this.resumeRender(),C},this.refreshDimensions=function(){if(!s.view)return;const{width:w,height:C}=s.view.getLastSize(),{width:b,height:P}=s.rootElement.getBoundingClientRect(),L=b!==w||P!==C;s.runHooks("beforeRefreshDimensions",{width:w,height:C},{width:b,height:P},L)!==!1&&((L||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(b,P),s.render()),s.runHooks("afterRefreshDimensions",{width:w,height:C},{width:b,height:P},L))},this.updateData=function(w,C){VL(w,b=>{a=b},b=>{a=b,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),W.refresh()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:C,metaManager:v,firstRun:f})},this.loadData=function(w,C){VL(w,b=>{a=b},()=>{v.clearCellsCache(),s.initIndexMappers(),u.adjustRowsAndCols(),W.refresh(),f&&(f=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:C,metaManager:v,firstRun:f})},this.getInitialColumnCount=function(){const w=y.columns;let C=0;if(Array.isArray(w))C=w.length;else if(fn(w))if(s.dataType==="array"){const b=this.countSourceCols();for(let P=0;P<b;P+=1)w(P)&&(C+=1)}else(s.dataType==="object"||s.dataType==="function")&&(C=a.colToPropCache.length);else if(_e(y.dataSchema)){const b=a.getSchema();C=Array.isArray(b)?b.length:eI(b)}else C=this.countSourceCols();return C},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(w,C,b,P){return mn(w)?a.getAll():a.getRange(s._createCellCoords(w,C),s._createCellCoords(b,P),a.DESTINATION_RENDERER)},this.getCopyableText=function(w,C,b,P){return a.getCopyableText(s._createCellCoords(w,C),s._createCellCoords(b,P))},this.getCopyableData=function(w,C){return a.getCopyable(w,a.colToProp(C))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const b=(f?s.loadData:s.updateData).bind(this);let P=!1,L,G;if(_e(w.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(_e(w.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(_e(w.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(L in w)L==="data"||(L==="language"?$(w.language):L==="className"?q("className",w.className):L==="tableClassName"&&s.table?(q("tableClassName",w.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):Ie.getSingleton().isRegistered(L)||Ie.getSingleton().isDeprecated(L)?(fn(w[L])||Array.isArray(w[L]))&&(w[L].initialHook=!0,s.addHook(L,w[L])):!C&&Ln(w,L)&&(S[L]=w[L]));w.data===void 0&&y.data===void 0?b(null,"updateSettings"):w.data!==void 0?b(w.data,"updateSettings"):w.columns!==void 0&&(a.createMap(),s.initIndexMappers());const ee=s.countCols(),ne=y.columns;if(ne&&fn(ne)&&(P=!0),(w.cell!==void 0||w.cells!==void 0||w.columns!==void 0)&&v.clearCache(),ee>0)for(L=0,G=0;L<ee;L++){if(ne){const oe=P?ne(L):ne[G];oe&&v.updateColumnMeta(G,oe)}G+=1}_e(w.cell)&&gt(w.cell,oe=>{s.setCellMetaObject(oe.row,oe.col,oe)}),s.runHooks("afterCellMetaReset");let he=s.rootElement.style.height;he!==""&&(he=parseInt(s.rootElement.style.height,10));let we=w.height;if(fn(we)&&(we=we()),C&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),we===null){const oe=s.rootElement.getAttribute("data-initialstyle");oe&&(oe.indexOf("height")>-1||oe.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",oe):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else we!==void 0&&(s.rootElement.style.height=isNaN(we)?`${we}`:`${we}px`,s.rootElement.style.overflow="hidden");if(typeof w.width<"u"){let oe=w.width;fn(oe)&&(oe=oe()),s.rootElement.style.width=isNaN(oe)?`${oe}`:`${oe}px`}C||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",w)),u.adjustRowsAndCols(),s.view&&!f&&(s.forceFullRender=!0,s.view.render(),s.view._wt.wtOverlays.adjustElementsSize()),!C&&s.view&&(he===""||we===""||we===void 0)&&he!==we&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const w=s.getSelectedLast();if(y.getValue){if(fn(y.getValue))return y.getValue.call(s);if(w)return s.getData()[w[0][0]][y.getValue]}else if(w)return s.getDataAtCell(w[0],w[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(w,C,b,P,L){u.alter(w,C,b,P,L)},this.getCell=function(w,C){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,P=C,L=w;if(C>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(C)))return null;P=this.columnIndexMapper.getRenderableFromVisualIndex(C)}if(w>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(w)))return null;L=this.rowIndexMapper.getRenderableFromVisualIndex(w)}return L===null||P===null||L===void 0||P===void 0?null:s.view.getCellAtCoords(s._createCellCoords(L,P),b)},this.getCoords=function(w){const C=this.view._wt.wtTable.getCoords(w);if(C===null)return null;const{row:b,col:P}=C;let L=b,G=P;return b>=0&&(L=this.rowIndexMapper.getVisualFromRenderableIndex(b)),P>=0&&(G=this.columnIndexMapper.getVisualFromRenderableIndex(P)),s._createCellCoords(L,G)},this.colToProp=function(w){return a.colToProp(w)},this.propToCol=function(w){return a.propToCol(w)},this.toVisualRow=w=>this.rowIndexMapper.getVisualFromPhysicalIndex(w),this.toVisualColumn=w=>this.columnIndexMapper.getVisualFromPhysicalIndex(w),this.toPhysicalRow=w=>this.rowIndexMapper.getPhysicalFromVisualIndex(w),this.toPhysicalColumn=w=>this.columnIndexMapper.getPhysicalFromVisualIndex(w),this.getDataAtCell=function(w,C){return a.get(w,a.colToProp(C))},this.getDataAtRowProp=function(w,C){return a.get(w,C)},this.getDataAtCol=function(w){const C=[],b=a.getRange(s._createCellCoords(0,w),s._createCellCoords(y.data.length-1,w),a.DESTINATION_RENDERER);for(let P=0;P<b.length;P+=1)for(let L=0;L<b[P].length;L+=1)C.push(b[P][L]);return C},this.getDataAtProp=function(w){const C=[],b=a.getRange(s._createCellCoords(0,a.propToCol(w)),s._createCellCoords(y.data.length-1,a.propToCol(w)),a.DESTINATION_RENDERER);for(let P=0;P<b.length;P+=1)for(let L=0;L<b[P].length;L+=1)C.push(b[P][L]);return C},this.getSourceData=function(w,C,b,P){let L;return w===void 0?L=l.getData():L=l.getByRange(s._createCellCoords(w,C),s._createCellCoords(b,P)),L},this.getSourceDataArray=function(w,C,b,P){let L;return w===void 0?L=l.getData(!0):L=l.getByRange(s._createCellCoords(w,C),s._createCellCoords(b,P),!0),L},this.getSourceDataAtCol=function(w){return l.getAtColumn(w)},this.setSourceDataAtCell=function(w,C,b,P){const L=Ve(w,C,b),G=this.hasHook("afterSetSourceDataAtCell"),ee=[];G&&D(L,he=>{let[we,oe,We]=he;ee.push([we,oe,l.getAtCell(we,oe),We])}),D(L,he=>{let[we,oe,We]=he;l.setAtCell(we,oe,We)}),G&&this.runHooks("afterSetSourceDataAtCell",ee,P),this.render();const ne=s.getActiveEditor();ne&&_e(ne.refreshValue)&&ne.refreshValue()},this.getSourceDataAtRow=function(w){return l.getAtRow(w)},this.getSourceDataAtCell=function(w,C){return l.getAtCell(w,C)},this.getDataAtRow=function(w){return a.getRange(s._createCellCoords(w,0),s._createCellCoords(w,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(w,C,b,P){const L=w===void 0?[0,0,this.countRows(),this.countCols()]:[w,C,b,P],[G,ee]=L;let[,,ne,he]=L,we=null,oe=null;ne===void 0&&(ne=G),he===void 0&&(he=ee);let We="mixed";return He(Math.max(Math.min(G,ne),0),Math.max(G,ne),Ke=>{let Q=!0;return He(Math.max(Math.min(ee,he),0),Math.max(ee,he),Qe=>(oe=this.getCellMeta(Ke,Qe).type,we?Q=we===oe:we=oe,Q)),We=Q?oe:"mixed",Q}),We},this.removeCellMeta=function(w,C,b){const[P,L]=[this.toPhysicalRow(w),this.toPhysicalColumn(C)];let G=v.getCellMetaKeyValue(P,L,b);s.runHooks("beforeRemoveCellMeta",w,C,b,G)!==!1&&(v.removeCellMeta(P,L,b),s.runHooks("afterRemoveCellMeta",w,C,b,G)),G=null},this.spliceCellsMeta=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var b=arguments.length,P=new Array(b>2?b-2:0),L=2;L<b;L++)P[L-2]=arguments[L];if(P.length>0&&!Array.isArray(P[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");C>0&&v.removeRow(this.toPhysicalRow(w),C),P.length>0&&D(P.reverse(),G=>{v.createRow(this.toPhysicalRow(w)),D(G,(ee,ne)=>this.setCellMetaObject(w,ne,ee))}),s.render()},this.setCellMetaObject=function(w,C,b){typeof b=="object"&&gt(b,(P,L)=>{this.setCellMeta(w,C,L,P)})},this.setCellMeta=function(w,C,b,P){if(s.runHooks("beforeSetCellMeta",w,C,b,P)===!1)return;let G=w,ee=C;w<this.countRows()&&(G=this.toPhysicalRow(w)),C<this.countCols()&&(ee=this.toPhysicalColumn(C)),v.setCellMeta(G,ee,b,P),s.runHooks("afterSetCellMeta",w,C,b,P)},this.getCellsMeta=function(){return v.getCellsMeta()},this.getCellMeta=function(w,C){let b=this.toPhysicalRow(w),P=this.toPhysicalColumn(C);return b===null&&(b=w),P===null&&(P=C),v.getCellMeta(b,P,{visualRow:w,visualColumn:C})},this.getColumnMeta=function(w){return v.getColumnMeta(this.toPhysicalColumn(w))},this.getCellMetaAtRow=function(w){return v.getCellsMetaAtRow(w)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(w,C){const b=typeof w=="number"?s.getCellMeta(w,C).renderer:w.renderer;return typeof b=="string"?qA(b):mn(b)?qA("text"):b},this.getCellEditor=function(w,C){const b=typeof w=="number"?s.getCellMeta(w,C).editor:w.editor;return typeof b=="string"?jA(b):mn(b)?jA("text"):b},this.getCellValidator=function(w,C){const b=typeof w=="number"?s.getCellMeta(w,C).validator:w.validator;return typeof b=="string"?BX(b):b},this.validateCells=function(w){this._validateCells(w)},this.validateRows=function(w,C){if(!Array.isArray(w))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(C,w)},this.validateColumns=function(w,C){if(!Array.isArray(w))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(C,void 0,w)},this._validateCells=function(w,C,b){const P=new J;w&&(P.onQueueEmpty=w);let L=s.countRows()-1;for(;L>=0;){if(C!==void 0&&C.indexOf(L)===-1){L-=1;continue}let G=s.countCols()-1;for(;G>=0;){if(b!==void 0&&b.indexOf(G)===-1){G-=1;continue}P.addValidatorToQueue(),s.validateCell(s.getDataAtCell(L,G),s.getCellMeta(L,G),ee=>{if(typeof ee!="boolean")throw new Error("Validation error: result is not boolean");ee===!1&&(P.valid=!1),P.removeValidatorFormQueue()},"validateCells"),G-=1}L-=1}P.checkIfQueueIsEmpty()},this.getRowHeader=function(w){let C=y.rowHeaders,b=w;return b!==void 0&&(b=s.runHooks("modifyRowHeader",b)),b===void 0?(C=[],He(s.countRows()-1,P=>{C.push(s.getRowHeader(P))})):Array.isArray(C)&&C[b]!==void 0?C=C[b]:fn(C)?C=C(b):C&&typeof C!="string"&&typeof C!="number"&&(C=b+1),C},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let w=0,C=s.countCols();w<C;w++)if(s.getColHeader(w))return!0;return!1},this.getColHeader=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const b=s.runHooks("modifyColHeader",w);if(b===void 0){const ne=[],he=s.countCols();for(let we=0;we<he;we++)ne.push(s.getColHeader(we));return ne}let P=y.colHeaders;const L=function(ne){const he=[],we=s.countCols();let oe=0;for(;oe<we;oe++)fn(y.columns)&&y.columns(oe)&&he.push(oe);return he[ne]},G=s.toPhysicalColumn(b),ee=L(G);return y.colHeaders===!1?P=null:y.columns&&fn(y.columns)&&y.columns(ee)&&y.columns(ee).title?P=y.columns(ee).title:y.columns&&y.columns[G]&&y.columns[G].title?P=y.columns[G].title:Array.isArray(y.colHeaders)&&y.colHeaders[G]!==void 0?P=y.colHeaders[G]:fn(y.colHeaders)?P=y.colHeaders(G):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(P=M8(b)),P=s.runHooks("modifyColumnHeaderValue",P,w,C),P},this._getColWidthFromSettings=function(w){let C;if(w>=0&&(C=s.getCellMeta(0,w).width),(C===void 0||C===y.width)&&(C=y.colWidths),C!=null){switch(typeof C){case"object":C=C[w];break;case"function":C=C(w);break}typeof C=="string"&&(C=parseInt(C,10))}return C},this.getColWidth=function(w){let C=s._getColWidthFromSettings(w);return C=s.runHooks("modifyColWidth",C,w),C===void 0&&(C=BC),C},this._getRowHeightFromSettings=function(w){let C=y.rowHeights;if(C!=null){switch(typeof C){case"object":C=C[w];break;case"function":C=C(w);break}typeof C=="string"&&(C=parseInt(C,10))}return C},this.getRowHeight=function(w){let C=s._getRowHeightFromSettings(w);return C=s.runHooks("modifyRowHeight",C,w),C},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const w=y.maxCols,C=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(w,C)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=0;return K1(s.countRows()-1,b=>{if(s.isEmptyRow(b))C+=1;else if(w===!0)return!1}),C},this.countEmptyCols=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=0;return K1(s.countCols()-1,b=>{if(s.isEmptyCol(b))C+=1;else if(w===!0)return!1}),C},this.isEmptyRow=function(w){return y.isEmptyRow.call(s,w)},this.isEmptyCol=function(w){return y.isEmptyCol.call(s,w)},this.selectCell=function(w,C,b,P){let L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,G=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return mn(w)||mn(C)?!1:this.selectCells([[w,C,b,P]],L,G)},this.selectCells=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;C===!1&&d.suspend();const P=W.selectCells(w);return P&&b&&s.listen(),d.resume(),P},this.selectColumns=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,b=arguments.length>2?arguments[2]:void 0;return W.selectColumns(w,C,b)},this.selectRows=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,b=arguments.length>2?arguments[2]:void 0;return W.selectRows(w,C,b)},this.deselectCell=function(){W.deselect()},this.selectAll=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,b=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),W.selectAll(w,C,b)};const Se=(w,C)=>w.getNearestNotHiddenIndex(C,1,!0);this.scrollViewportTo=function(w){var C;if(typeof w=="number"){var b;w={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(b=arguments[4])!==null&&b!==void 0?b:!0}}const{row:P,col:L,verticalSnap:G,horizontalSnap:ee,considerHiddenIndexes:ne}=(C=w)!==null&&C!==void 0?C:{};let he,we,oe,We;G!==void 0&&(he=G==="top",we=!he),ee!==void 0&&(oe=ee==="start",We=!oe);let Ke=P,Q=L;if(ne===void 0||ne){const ht=Number.isInteger(P)&&P>=0,Ze=Number.isInteger(L)&&L>=0,ke=ht?Se(this.rowIndexMapper,P):void 0,A=Ze?Se(this.columnIndexMapper,L):void 0;if(ke===null||A===null)return!1;Ke=ht?s.rowIndexMapper.getRenderableFromVisualIndex(ke):P,Q=Ze?s.columnIndexMapper.getRenderableFromVisualIndex(A):L}const Qe=Number.isInteger(Ke),et=Number.isInteger(Q);return Qe&&Ke>=0&&et&&Q>=0?s.view.scrollViewport(s._createCellCoords(Ke,Q),he,We,we,oe):Qe&&Ke>=0&&(et&&Q<0||!et)?s.view.scrollViewportVertically(Ke,he,we):et&&Q>=0&&(Qe&&Ke<0||!Qe)?s.view.scrollViewportHorizontally(Q,We,oe):!1},this.scrollToFocusedCell=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",w);const{highlight:C}=this.getSelectedRangeLast();this.scrollViewportTo(C.toObject())?this.view.render():(this.removeHook("afterScroll",w),this._registerImmediate(()=>w()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),v.clearCache(),Fb.delete(this.guid),vv(s)){const w=this.rootDocument.querySelector(".hot-display-license-info");w&&w.parentNode.removeChild(w)}pa(s.rootElement),o.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),R.getItems().forEach(w=>{let[,C]=w;C.destroy()}),R.clear(),s.runHooks("afterDestroy")},!0),Ie.getSingleton().destroy(s),gt(s,(w,C,b)=>{fn(w)?b[C]=pe(C):C!=="guid"&&(b[C]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,u=null,W=null,h=null,s=null};function pe(w){return()=>{throw new Error(`The "${w}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(w){const C=yo(w);return C==="UndoRedo"?this.undoRedo:R.getItem(C)},this.getPluginName=function(w){return w===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:R.getId(w)},this.getInstance=function(){return s},this.addHook=function(w,C,b){Ie.getSingleton().add(w,C,s,b)},this.hasHook=function(w){return Ie.getSingleton().has(w,s)||Ie.getSingleton().has(w)},this.addHookOnce=function(w,C,b){Ie.getSingleton().once(w,C,s,b)},this.removeHook=function(w,C){Ie.getSingleton().remove(w,C,s)},this.runHooks=function(w,C,b,P,L,G,ee){return Ie.getSingleton().run(s,w,C,b,P,L,G,ee)},this.getTranslatedPhrase=function(w,C){return cB(y.language,w,C)},this.toHTML=()=>z1(this),this.toTableElement=()=>{const w=this.rootDocument.createElement("div");return w.insertAdjacentHTML("afterbegin",z1(this)),w.firstElementChild},this.timeouts=[],this._registerTimeout=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=w;typeof b=="function"&&(b=setTimeout(b,C)),this.timeouts.push(b)},this._clearTimeouts=function(){D(this.timeouts,w=>{clearTimeout(w)})},this.immediates=[],this._registerImmediate=function(w){this.immediates.push(setImmediate(w))},this._clearImmediates=function(){D(this.immediates,w=>{clearImmediate(w)})},this._getEditorManager=function(){return h},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const ze=kZ({handleEvent(){return s.isListening()},beforeKeyDown:w=>this.runHooks("beforeKeyDown",w),afterKeyDown:w=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",w)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",w=>{w.ctrlKey===!1&&w.metaKey===!1&&ze.releasePressedKeys()}),this.getShortcutManager=function(){return ze},this.getFocusManager=function(){return c},IU().forEach(w=>{const C=aI(w);R.addItem(w,new C(this))}),SZ(s),ze.setActiveContextName("grid"),Ie.getSingleton().run(s,"construct")}function jL(n,e,t){n.addEventListener(e,t,!1)}function zL(n,e,t){n.removeEventListener(e,t,!1)}function YL(n){return n.ownerDocument.defaultView.getComputedStyle(n)}function VZ(n){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t=n.body,r=n.createTextNode(""),i=n.createElement("span");let s;function o(){r.textContent=s.value,i.style.position="absolute",i.style.fontSize=YL(s).fontSize,i.style.fontFamily=YL(s).fontFamily,i.style.whiteSpace="pre",t.appendChild(i);const h=i.clientWidth+2;t.removeChild(i);const c=s.style;c.height=`${e.minHeight}px`,e.minWidth>h?c.width=`${e.minWidth}px`:h>e.maxWidth?c.width=`${e.maxWidth}px`:c.width=`${h}px`;const d=s.scrollHeight?s.scrollHeight-1:0;e.minHeight>d?c.height=`${e.minHeight}px`:e.maxHeight<d?(c.height=`${e.maxHeight}px`,c.overflowY="visible"):c.height=`${d}px`}function a(){n.defaultView.setTimeout(o,0)}function l(h){if(h&&h.minHeight)if(h.minHeight==="inherit")e.minHeight=s.clientHeight;else{const c=parseInt(h.minHeight,10);isNaN(c)||(e.minHeight=c)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")e.maxHeight=s.clientHeight;else{const c=parseInt(h.maxHeight,10);isNaN(c)||(e.maxHeight=c)}if(h&&h.minWidth)if(h.minWidth==="inherit")e.minWidth=s.clientWidth;else{const c=parseInt(h.minWidth,10);isNaN(c)||(e.minWidth=c)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")e.maxWidth=s.clientWidth;else{const c=parseInt(h.maxWidth,10);isNaN(c)||(e.maxWidth=c)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function u(h,c){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,l(c),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${e.minHeight}px`,s.style.minWidth=`${e.minWidth}px`,s.style.maxWidth=`${e.maxWidth}px`,s.style.overflowY="hidden"),d&&(jL(s,"input",o),jL(s,"keydown",a)),o()}return{init:u,resize:o,unObserve(){zL(s,"input",o),zL(s,"keydown",a)}}}function KL(n,e){const t=lU(e),r=e.value.split(`
`);let i=t,s=0;for(let o=0;o<r.length;o++){const a=r[o];o!==0&&(s+=r[o-1].length+1);const l=s+a.length;if(n==="home"?i=s:n==="end"&&(i=l),t<=l)break}FC(e,i)}function $u(n,e,t){return(e=UZ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function UZ(n){var e=BZ(n,"string");return typeof e=="symbol"?e:e+""}function BZ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const WZ="ht_editor_visible",Xp="ht_editor_hidden",qL="textEditor",$Z="text";class uc extends nf{static get EDITOR_TYPE(){return $Z}constructor(e){super(e),$u(this,"eventManager",new Co(this)),$u(this,"autoResize",VZ(this.hot.rootDocument)),$u(this,"TEXTAREA",void 0),$u(this,"textareaStyle",void 0),$u(this,"TEXTAREA_PARENT",void 0),$u(this,"textareaParentStyle",void 0),$u(this,"layerClass",void 0),this.eventManager=new Co(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),f4(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,r,i,s,o){const a=this.state;if(super.prepare(e,t,r,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Bn.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,t){this.state===Bn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),FC(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Xe(this.TEXTAREA,[["data-hot-input",""],Zd(-1)]),ue(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ue(this.TEXTAREA_PARENT,"handsontableInputHolder"),Je(this.TEXTAREA_PARENT,this.layerClass)&&rt(this.TEXTAREA_PARENT,this.layerClass),ue(this.TEXTAREA_PARENT,Xp),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){F4()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",rt(this.TEXTAREA_PARENT,this.layerClass),ue(this.TEXTAREA_PARENT,Xp)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;He(e.length-1,r=>{const i=e[r];if(Je(i,"handsontableEditor"))return t=!0,!1}),Je(this.TEXTAREA_PARENT,Xp)&&rt(this.TEXTAREA_PARENT,Xp),t?(this.layerClass=WZ,ue(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ue(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Bn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:r,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=fl(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=fl(this.TEXTAREA),h=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),c=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),d=i-h,f=o-c,m=s-h,p=a-c;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,m),minHeight:Math.min(f,p),maxWidth:m,maxHeight:p},!0)}bindEvents(){wU()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Bn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Bn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>_e(this.hot.getSelected()),group:qL},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;KL(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;KL(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(qL)}}const GZ="base";function Qg(n,e,t,r,i,s,o){const a=o.ariaTags,l=[],u=[],h=[],c=[];o.className&&ue(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&c.push(S1())):a&&h.push(S1()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&c.push(R1())):(u.push(o.invalidCellClassName),a&&h.push(R1()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),rt(e,u),ue(e,l),Jd(e,h),Xe(e,c)}Qg.RENDERER_TYPE=GZ;const jZ="text";function Rl(n,e,t,r,i,s,o){Qg.apply(this,[n,e,t,r,i,s,o]);let a=s;if(!a&&o.placeholder&&(a=o.placeholder),a=Zn(a),o.trimWhitespace&&(a=a.trim()),o.rendererTemplate){pa(e);const l=n.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=n.getSourceDataAtRow(t),e.appendChild(l)}else Wh(e,a)}Rl.RENDERER_TYPE=jZ;const zZ="text",AB={CELL_TYPE:zZ,editor:uc,renderer:Rl};Zs(AB);Et.editors={BaseEditor:nf};function Et(n,e){const t=new TB(n,e||{},bI);return t.init(),t}Et.Core=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new TB(n,e,bI)};Et.DefaultSettings=vB();Et.hooks=Ie.getSingleton();Et.CellCoords=Gh;Et.CellRange=Yg;Et.packageName="handsontable";Et.buildDate="07/02/2025 16:13:23";Et.version="14.6.2";Et.languages={dictionaryKeys:l7,getLanguageDictionary:hB,getLanguagesDictionaries:f7,registerLanguageDictionary:uB,getTranslatedPhrase:cB};function tN(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function YZ(n){if(Array.isArray(n))return tN(n)}function KZ(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function cg(n,e,t){return e=gy(e),tJ(n,NB()?Reflect.construct(e,t||[],gy(n).constructor):e.apply(n,t))}function Ud(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function XL(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,IB(r.key),r)}}function Bd(n,e,t){return e&&XL(n.prototype,e),t&&XL(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function qZ(n,e,t){return(e=IB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gy(n){return gy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gy(n)}function dg(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&nN(n,e)}function NB(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NB=function(){return!!n})()}function XZ(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function QZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QL(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function ZZ(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?QL(Object(t),!0).forEach(function(r){qZ(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):QL(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function JZ(n,e){if(n==null)return{};var t,r,i=eJ(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}function eJ(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.includes(r))continue;t[r]=n[r]}return t}function tJ(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KZ(n)}function nN(n,e){return nN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},nN(n,e)}function nJ(n){return YZ(n)||XZ(n)||iJ(n)||QZ()}function rJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function IB(n){var e=rJ(n,"string");return typeof e=="symbol"?e:e+""}function iJ(n,e){if(n){if(typeof n=="string")return tN(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?tN(n,e):void 0}}var kb=null,sJ="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",oJ="The Handsontable instance bound to this component was destroyed and cannot be used properly.",py="global",aJ="hot-wrapper-editor-container";function lJ(){if(typeof console<"u"){var n;(n=console).warn.apply(n,arguments)}}function rN(n,e){var t=_n.Children.toArray(n),r=_n.Children.count(n),i=null;return r!==0&&(r===1&&t[0].props[e]?i=t[0]:i=t.find(function(s){return s.props[e]!==void 0})),i||null}function MB(n){return n?n.type.WrappedComponent?n.type.WrappedComponent:n.type:null}function OB(n,e){if(typeof n>"u"||e===null)return null;var t=xB(e.props,!1);return t.className="".concat(aJ," ").concat(t.className),Mk.createPortal(_n.createElement("div",Object.assign({},t),e),n.body)}function _B(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:py,r=rN(n,"hot-editor"),i=MB(r);return r?_n.cloneElement(r,{emitEditorInstance:function(o,a){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(a??py,o)},editorColumnScope:t,isEditor:!0}):null}function uJ(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;t||(t=document),kb||(kb=t.createDocumentFragment());var s=i??t.createElement("DIV");kb.appendChild(s);var o=_n.cloneElement(n,ZZ({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:Mk.createPortal(o,s,r),portalContainer:s}}function xB(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:n.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:n.className||"",style:n.style||{}}}function hJ(){return typeof window<"u"}var PB=(function(){function n(){Ud(this,n)}return Bd(n,null,[{key:"getSettings",value:(function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=r.prevProps,s=i===void 0?{}:i,o=r.isInit,a=o===void 0?!1:o,l=r.initOnlySettingKeys,u=l===void 0?[]:l,h=function(v){return!a&&u.includes(v)?s[v]===t[v]:!1},c={};if(t.settings){var d=t.settings;for(var f in d)d.hasOwnProperty(f)&&!h(f)&&(c[f]=d[f])}for(var m in t)m!=="settings"&&m!=="children"&&!h(m)&&t.hasOwnProperty(m)&&(c[m]=t[m]);return c})}])})(),cJ=(function(n){function e(){return Ud(this,e),cg(this,e,arguments)}return dg(e,n),Bd(e,[{key:"getSettingsProps",value:(function(){var r=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!r.internalProps.includes(i)}).reduce(function(i,s){return i[s]=r.props[s],i},{})})},{key:"getLocalEditorElement",value:function(){return _B(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var r=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=PB.getSettings(this.getSettingsProps()),r!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(r),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),i!==null&&(this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var r=this.props._getOwnerDocument(),i=OB(r,this.getLocalEditorElement());return _n.createElement(_n.Fragment,null,i)}}])})(_n.Component),dJ=(function(n){function e(){var t;return Ud(this,e),t=cg(this,e,arguments),t.state={portals:[]},t}return dg(e,n),Bd(e,[{key:"render",value:function(){return _n.createElement(_n.Fragment,null,this.state.portals)}}])})(_n.Component),fJ="14.6.2";function mJ(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var LB={exports:{}},Vb,ZL;function gJ(){if(ZL)return Vb;ZL=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Vb=n,Vb}var Ub,JL;function pJ(){if(JL)return Ub;JL=1;var n=gJ();function e(){}function t(){}return t.resetWarningCache=e,Ub=function(){function i(a,l,u,h,c,d){if(d!==n){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}i.isRequired=i;function s(){return i}var o={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:s,element:i,elementType:i,instanceOf:s,node:i,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:t,resetWarningCache:e};return o.PropTypes=o,o},Ub}LB.exports=pJ()();var wJ=LB.exports,Bb=mJ(wJ),YM=(function(n){function e(){var t;return Ud(this,e),t=cg(this,e,arguments),t.id=null,t.__hotInstance=null,t.hotElementRef=null,t.columnSettings=[],t.renderersPortalManager=null,t.portalCache=new Map,t.portalContainerCache=new Map,t.renderedCellCache=new Map,t.editorCache=new Map,t.componentRendererColumns=new Map,t}return dg(e,n),Bd(e,[{key:"hotInstance",get:(function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(oJ),null)}),set:(function(r){this.__hotInstance=r})},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return hJ()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(r){this.hotElementRef=r}},{key:"getRendererWrapper",value:function(r){var i=this;return function(o,a,l,u,h,c,d){var f=i.getRenderedCellCache(),m=i.getPortalContainerCache(),p="".concat(l,"-").concat(u),v=o.guid,y="".concat(v,"-").concat(p),S="".concat(p,"-").concat(v);if(f.has(p)&&(a.innerHTML=f.get(p).innerHTML),a&&!a.getAttribute("ghost-table")){for(var R=i.portalCache.get(S),T=m.get(y);a.firstChild;)a.removeChild(a.firstChild);if(R&&T)a.appendChild(T);else{var I=uJ(r,{TD:a,row:l,col:u,prop:h,value:c,cellProperties:d,isRenderer:!0},a.ownerDocument,S,T),H=I.portal,k=I.portalContainer;m.set(y,k),a.appendChild(k),i.portalCache.set(S,H)}}return f.set(p,a),a}}},{key:"getEditorClass",value:function(r){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:py,o=MB(r),a=(i=this.getEditorCache().get(o))===null||i===void 0?void 0:i.get(s);return this.makeEditorClass(a)}},{key:"makeEditorClass",value:function(r){var i=(function(s){function o(a){var l;return Ud(this,o),l=cg(this,o,[a]),r.hotCustomEditorInstance=l,l.editorComponent=r,l}return dg(o,s),Bd(o,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])})(Et.editors.BaseEditor);return Object.getOwnPropertyNames(Et.editors.BaseEditor.prototype).forEach(function(s){s!=="constructor"&&(i.prototype[s]=function(){for(var o,a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return(o=r[s]).call.apply(o,[r].concat(l))})}),i}},{key:"getGlobalRendererElement",value:function(){return rN(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return _B(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var r,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this._isHotInstanceDestroyed()?[]:((r=this.hotInstance)===null||r===void 0||(r=r.getSettings())===null||r===void 0?void 0:r._initOnlySettings)||[],a=PB.getSettings(this.props,{prevProps:s,isInit:i,initOnlySettingKeys:o}),l=this.getGlobalRendererElement(),u=this.getGlobalEditorElement();if(a.columns=this.columnSettings.length?this.columnSettings:a.columns,u)a.editor=this.getEditorClass(u,py);else{var h;this.props.editor||(h=this.props.settings)!==null&&h!==void 0&&h.editor?a.editor=this.props.editor||this.props.settings.editor:a.editor=jA("text")}if(l)a.renderer=this.getRendererWrapper(l),this.componentRendererColumns.set("global",!0);else{var c;this.props.renderer||(c=this.props.settings)!==null&&c!==void 0&&c.renderer?a.renderer=this.props.renderer||this.props.settings.renderer:a.renderer=qA("text")}return a}},{key:"displayAutoSizeWarning",value:function(r){var i,s;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(s=this.hotInstance.getPlugin("autoColumnSize"))!==null&&s!==void 0&&s.enabled)&&this.componentRendererColumns.size>0&&lJ(sJ)}},{key:"setHotColumnSettings",value:function(r,i){this.columnSettings[i]=r}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:nJ(this.portalCache.values())})}},{key:"updateHot",value:function(r){this.hotInstance&&this.hotInstance.updateSettings(r,!1)}},{key:"setRenderersPortalManagerRef",value:function(r){this.renderersPortalManager=r}},{key:"componentDidMount",value:function(){var r=this,i=this.createNewGlobalSettings(!0);this.hotInstance=new Et.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(){return r.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return r.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentDidUpdate",value:function(r){this.clearCache();var i=this.createNewGlobalSettings(!1,r);this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var r=this,i=function(h){return h.type===cJ},s=_n.Children.toArray(this.props.children),o=s.filter(function(u){return i(u)}).map(function(u,h){return _n.cloneElement(u,{_componentRendererColumns:r.componentRendererColumns,_emitColumnSettings:r.setHotColumnSettings.bind(r),_columnIndex:h,_getChildElementByType:rN.bind(r),_getRendererWrapper:r.getRendererWrapper.bind(r),_getEditorClass:r.getEditorClass.bind(r),_getOwnerDocument:r.getOwnerDocument.bind(r),_getEditorCache:r.getEditorCache.bind(r),children:u.props.children})}),a=xB(this.props),l=OB(this.getOwnerDocument(),this.getGlobalEditorElement());return _n.createElement(_n.Fragment,null,_n.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},a),o),_n.createElement(dJ,{ref:this.setRenderersPortalManagerRef.bind(this)}),l)}}],[{key:"version",get:function(){return fJ}}])})(_n.Component);YM.propTypes={style:Bb.object,id:Bb.string,className:Bb.string};var vJ=["children"],DB=_n.forwardRef(function(n,e){var t,r=n.children,i=JZ(n,vJ),s=typeof _n.useId=="function"?_n.useId():void 0,o=(t=i.id)!==null&&t!==void 0?t:s;return _n.createElement(YM,Object.assign({id:o},i,{ref:e}),r)});DB.version=YM.version;_n.Component;const eD="handsontableEditor",yJ="handsontable";let KM=class extends uc{static get EDITOR_TYPE(){return yJ}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),FC(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,h){const c=this.getSourceData(h.row,h.col);c!==void 0&&a.setValue(c),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&ir(l,o.handsontable),this.htOptions=l}beginEditing(e,t){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,t,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:eD,relativeToGroup:Tu,position:"before"},i=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||a.flipped&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),To(o),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedLast()&&o.flipped?a=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),i(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedLast()&&!o.flipped)a=0;else if(o.getSelectedLast()){if(o.flipped)a=o.getSelectedLast()[0]+1;else if(!o.flipped){const u=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,s)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(eD)}};function CJ(n,e,t){SJ(n,e),e.set(n,t)}function SJ(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qp(n,e,t){return(e=RJ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function RJ(n){var e=EJ(n,"string");return typeof e=="symbol"?e:e+""}function EJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function tD(n,e){return n.get(bJ(n,e))}function bJ(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const TJ="autocomplete";var Wb=new WeakMap;class qM extends KM{constructor(){super(...arguments),Qp(this,"query",null),Qp(this,"strippedChoices",[]),Qp(this,"rawChoices",[]),CJ(this,Wb,this.hot.guid.slice(0,9)),Qp(this,"sortByRelevance",function(e,t,r){const i=[],s=[],o=e.length;let a=t.length,l,u,h,c;if(o===0){for(h=0;h<a;h++)s.push(h);return s}for(h=0;h<a;h++){if(u=C1(Zn(t[h])),r)c=u.indexOf(e);else{const d=this.cellProperties.locale;c=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}c!==-1&&(l=u.length-c-o,i.push({baseIndex:h,index:c,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),h=0,a=i.length;h<a;h++)s.push(i[h].baseIndex);return s})}static get EDITOR_TYPE(){return TJ}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return _e(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ue(this.htContainer,"autocompleteEditor"),ue(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Xe(this.TEXTAREA,[t4(),X6(),ZV("listbox"),s4()])}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o),this.hot.getSettings().ariaTags&&Xe(this.TEXTAREA,[Ns("false"),o4(`${tD(Wb,this)}-listbox-${e}-${t}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r?.length,{row:s,col:o}=this;this.showEditableElement(),this.focus();let a=Tr();a===0&&$A()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[gn(this.TEXTAREA)-2]:void 0,width:e?gn(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,h,c,d,f,m)=>{Rl(l,u,h,c,d,f,m);const{filteringCaseSensitive:p,allowHtml:v,locale:y}=this.cellProperties,S=this.query;let R=Zn(f),T,I;R&&!v&&(T=p===!0?R.indexOf(S):R.toLocaleLowerCase(y).indexOf(S.toLocaleLowerCase(y)),T!==-1&&(I=R.substr(T,S.length),R=R.replace(I,`<strong>${I}</strong>`))),t&&Xe(u,[Q6(),...r?[h4(i)]:[],...r?[c4(r.indexOf(f)+1)]:[],["id",`${this.htEditor.rootElement.id}_${h}-${c}`]]),u.innerHTML=R},afterSelectionEnd:(l,u)=>{if(t){const h=this.htEditor.getCell(l,u,!0);Xe(h,[K0()]),Xe(this.TEXTAREA,...a4(h.id))}}}),t&&(Xe(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...ua()),Xe(this.htEditor.rootElement,[QV(),l4("polite"),u4("text"),["id",`${tD(Wb,this)}-listbox-${s}-${o}`]]),Xe(this.TEXTAREA,...Ns("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Xe(this.TEXTAREA,[Ns("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=lU(this.TEXTAREA),r=y4(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;i&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(o)?o.length:0;if(s===!1)u&&(a=o[0]);else{const h=[];for(let c=0,d=l.length;c<d&&!(i&&u<=c);c++)u?h.push(l[o[c]]):h.push(l[c]);a=0,l=h}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(pv([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),FC(this.TEXTAREA,t,t===r?void 0:r)}flipDropdownIfNeeded(){const e=kd(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(t||!t&&(r||r==="horizontal"))return!1;const i=br(this.TEXTAREA),s=er(this.TEXTAREA),o=this.getDropdownHeight(),a=e.scrollTop,l=er(this.hot.view._wt.wtTable.THEAD),u=br(e),h=i.top-u.top-l+a,c=e.scrollHeight-h-l-s,d=o>c&&h>c;return d?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(d?h:c,o),d}limitDropdownIfNeeded(e,t){if(t>e){let r=0,i=0,s=0,o=null;do s=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=s,i+=1;while(r<e);o=r-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-o}px`),this.setDropdownHeight(r-s)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const e=this.htEditor.getColWidth(0)+Tr(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,r=bt(e,s=>Zn(s));return bt(r,s=>t?s:C1(s))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),r={row:t?t.from.row:-1};let i=!1;return e===Be.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===Be.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(V4(e.keyCode)||e.keyCode===Be.BACKSPACE||e.keyCode===Be.DELETE||e.keyCode===Be.INSERT){let t=10;if(e.keyCode===Be.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}}const AJ="checkbox";class HB extends nf{static get EDITOR_TYPE(){return AJ}beginEditing(e,t){if(t&&t.type==="mouseup"&&t.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');Je(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}const su=()=>window,Cs=()=>window.document,iN=(n,e)=>window.setTimeout(n,e),Ko=function(n,e,t,r){n.addEventListener(e,t,!!r)},Ha=function(n,e,t,r){n.removeEventListener(e,t,!!r)},NJ=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},ji=function(n,e){return(" "+n.className+" ").indexOf(" "+e+" ")!==-1},$b=function(n,e){ji(n,e)||(n.className=n.className===""?e:n.className+" "+e)},Gb=function(n,e){n.className=NJ((" "+n.className+" ").replace(" "+e+" "," "))},XM=function(n){return/Array/.test(Object.prototype.toString.call(n))},qi=function(n){return/Date/.test(Object.prototype.toString.call(n))&&!isNaN(n.getTime())},IJ=function(n){let e=n.getDay();return e===0||e===6},MJ=function(n){return n%4===0&&n%100!==0||n%400===0},nD=function(n,e){return[31,MJ(n)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Zp=function(n){qi(n)&&n.setHours(0,0,0,0)},Jp=function(n,e){return n.getTime()===e.getTime()},wy=function(n,e,t){let r,i;for(r in e)i=n[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?qi(e[r])?t&&(n[r]=new Date(e[r].getTime())):XM(e[r])?t&&(n[r]=e[r].slice(0)):n[r]=wy({},e[r],t):(t||!i)&&(n[r]=e[r]);return n},rD=function(n,e,t){let r=Cs().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=wy(r,t),n.dispatchEvent(r)},iD=function(n){return n.month<0&&(n.year-=Math.ceil(Math.abs(n.month)/12),n.month+=12),n.month>11&&(n.year+=Math.floor(Math.abs(n.month)/12),n.month-=12),n},Lo={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},sD=function(n,e,t){for(e+=n.firstDay;e>=7;)e-=7;return t?n.i18n.weekdaysShort[e]:n.i18n.weekdays[e]},OJ=function(n){let e=[],t="false";if(n.isEmpty)if(n.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),n.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return n.isDisabled&&e.push("is-disabled"),n.isToday&&e.push("is-today"),n.isSelected&&(e.push("is-selected"),t="true"),n.hasEvent&&e.push("has-event"),n.isInRange&&e.push("is-inrange"),n.isStartRange&&e.push("is-startrange"),n.isEndRange&&e.push("is-endrange"),'<td data-day="'+n.day+'" class="'+e.join(" ")+'" aria-selected="'+t+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n.year+'" data-pika-month="'+n.month+'" data-pika-day="'+n.day+'">'+n.day+"</button></td>"},_J=function(n,e){n.setHours(0,0,0,0);let t=n.getDate(),r=n.getDay(),i=e,s=i-1,o=7,a=function(d){return(d+o-1)%o};n.setDate(t+s-a(r));let l=new Date(n.getFullYear(),0,i),u=1440*60*1e3,h=(n.getTime()-l.getTime())/u;return 1+Math.round((h-s+a(l.getDay()))/o)},xJ=function(n,e,t,r,i){let s=new Date(r,t,e);return'<td class="pika-week">'+(n.hasMoment?n.moment(s).isoWeek():_J(s,i))+"</td>"},PJ=function(n,e,t,r){return'<tr class="pika-row'+(t?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?n.reverse():n).join("")+"</tr>"},LJ=function(n){return"<tbody>"+n.join("")+"</tbody>"},DJ=function(n){let e,t=[];for(n.showWeekNumber&&t.push("<th></th>"),e=0;e<7;e++)t.push('<th scope="col"><abbr title="'+sD(n,e)+'">'+sD(n,e,!0)+"</abbr></th>");return"<thead><tr>"+(n.isRTL?t.reverse():t).join("")+"</tr></thead>"},HJ=function(n,e,t,r,i,s){let o,a,l,u=n._o,h=t===u.minYear,c=t===u.maxYear,d='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',f,m,p=!0,v=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(t===i?o-e:12+o-e)+'"'+(o===r?' selected="selected"':"")+(h&&o<u.minMonth||c&&o>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[o]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",XM(u.yearRange)?(o=u.yearRange[0],a=u.yearRange[1]+1):(o=t-u.yearRange,a=1+t+u.yearRange),l=[];o<a&&o<=u.maxYear;o++)o>=u.minYear&&l.push('<option value="'+o+'"'+(o===t?' selected="selected"':"")+">"+o+"</option>");return m='<div class="pika-label">'+t+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,h&&(r===0||u.minMonth>=r)&&(p=!1),c&&(r===11||u.maxMonth<=r)&&(v=!1),e===0&&(d+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===n._o.numberOfMonths-1&&(d+='<button class="pika-next'+(v?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},FJ=function(n,e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+t+'">'+DJ(n)+LJ(e)+"</table>"};function sN(n){let e=this,t=e.config(n);e._onMouseDown=function(i){if(!e._v)return;i=i||su().event;let s=i.target||i.srcElement;if(s)if(ji(s,"is-disabled")||(ji(s,"pika-button")&&!ji(s,"is-empty")&&!ji(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),t.bound&&iN(function(){e.hide(),t.blurFieldOnSelect&&t.field&&t.field.blur()},100)):ji(s,"pika-prev")?e.prevMonth():ji(s,"pika-next")&&e.nextMonth()),ji(s,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||su().event;let s=i.target||i.srcElement;s&&(ji(s,"pika-select-month")?e.gotoMonth(s.value):ji(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(i){if(i=i||su().event,e.isVisible())switch(i.keyCode){case 13:case 27:t.field&&t.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(t.parse)return t.parse(t.field.value,t.format);if(this.hasMoment){let i=this.moment(t.field.value,t.format,t.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(t.field.value))},e._onInputChange=function(i){let s;i.firedBy!==e&&(s=e._parseFieldValue(),qi(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Cs().activeElement;do if(ji(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=iN(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||su().event;let s=i.target||i.srcElement,o=s;if(s){!hasEventListeners&&ji(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),Ko(s,"change",e._onChange)));do if(ji(o,"pika-single")||o===t.trigger)return;while(o=o.parentNode);e._v&&s!==t.trigger&&o!==t.trigger&&e.hide()}},e.el=Cs().createElement("div"),e.el.className="pika-single"+(t.isRTL?" is-rtl":"")+(t.theme?" "+t.theme:""),Ko(e.el,"mousedown",e._onMouseDown,!0),Ko(e.el,"touchend",e._onMouseDown,!0),Ko(e.el,"change",e._onChange),t.keyboardInput&&Ko(Cs(),"keydown",e._onKeyChange),t.field&&(t.container?t.container.appendChild(e.el):t.bound?Cs().body.appendChild(e.el):t.field.parentNode.insertBefore(e.el,t.field.nextSibling),Ko(t.field,"change",e._onInputChange),t.defaultDate||(t.defaultDate=e._parseFieldValue(),t.setDefaultDate=!0));let r=t.defaultDate;qi(r)?t.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),t.bound?(this.hide(),e.el.className+=" is-bound",Ko(t.trigger,"click",e._onInputClick),Ko(t.trigger,"focus",e._onInputFocus),Ko(t.trigger,"blur",e._onInputBlur)):this.show()}sN.prototype={config:function(n){this._o||(this._o=wy({},Lo,!0));let e=wy(this._o,n,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let t=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=t>4?4:t,qi(e.minDate)||(e.minDate=!1),qi(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),XM(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Lo.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return n=n||this._o.format,qi(this._d)?this._o.toString?this._o.toString(this._d,n):this.hasMoment?this.moment(this._d).format(n):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(n,e){this.hasMoment&&this.moment.isMoment(n)&&this.setDate(n.toDate(),e)},useMoment:function(n){this.hasMoment=!0,this.moment=n},getDate:function(){return qi(this._d)?new Date(this._d.getTime()):null},setDate:function(n,e){if(!n)return this._d=null,this._o.field&&(this._o.field.value="",rD(this._o.field,"change",{firedBy:this})),this.draw();if(typeof n=="string"&&(n=new Date(Date.parse(n))),!qi(n))return;let t=this._o.minDate,r=this._o.maxDate;qi(t)&&n<t?n=t:qi(r)&&n>r&&(n=r),this._d=new Date(n.getTime()),Zp(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),rD(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(n){let e=!0;if(qi(n)){if(this.calendars){let t=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=n.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<t.getTime()||r.getTime()<i}e&&(this.calendars=[{month:n.getMonth(),year:n.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,e){let t=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;n==="add"?i=new Date(t.valueOf()+r):n==="subtract"&&(i=new Date(t.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=iD(this.calendars[0]);for(let n=1;n<this._o.numberOfMonths;n++)this.calendars[n]=iD({month:this.calendars[0].month+n,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(n){isNaN(n)||(this.calendars[0].month=parseInt(n,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(n){isNaN(n)||(this.calendars[0].year=parseInt(n,10),this.adjustCalendars())},setMinDate:function(n){n instanceof Date?(Zp(n),this._o.minDate=n,this._o.minYear=n.getFullYear(),this._o.minMonth=n.getMonth()):(this._o.minDate=Lo.minDate,this._o.minYear=Lo.minYear,this._o.minMonth=Lo.minMonth,this._o.startRange=Lo.startRange),this.draw()},setMaxDate:function(n){n instanceof Date?(Zp(n),this._o.maxDate=n,this._o.maxYear=n.getFullYear(),this._o.maxMonth=n.getMonth()):(this._o.maxDate=Lo.maxDate,this._o.maxYear=Lo.maxYear,this._o.maxMonth=Lo.maxMonth,this._o.endRange=Lo.endRange),this.draw()},setStartRange:function(n){this._o.startRange=n},setEndRange:function(n){this._o.endRange=n},draw:function(n){if(!this._v&&!n)return;let e=this._o,t=e.minYear,r=e.maxYear,i=e.minMonth,s=e.maxMonth,o="",a;this._y<=t&&(this._y=t,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+HJ(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&iN(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let n,e,t,r,i,s,o,a,l,u,h;this._o.container||(this.el.style.position="absolute",n=this._o.trigger,e=this.el.offsetWidth,t=this.el.offsetHeight,r=su().innerWidth||Cs().documentElement.clientWidth,i=su().innerHeight||Cs().documentElement.clientHeight,s=Cs().body.scrollTop||Cs().documentElement.scrollTop,u=!0,h=!0,l=n.getBoundingClientRect(),o=l.left+su().pageXOffset,a=l.bottom+su().pageYOffset,(this._o.reposition&&o+e>r||this._o.position.indexOf("right")>-1&&o-e+n.offsetWidth>0)&&(o=o-e+n.offsetWidth,u=!1),(this._o.reposition&&a+t>i+s||this._o.position.indexOf("top")>-1&&a-t-n.offsetHeight>0)&&(a=a-t-n.offsetHeight,h=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",$b(this.el,u?"left-aligned":"right-aligned"),$b(this.el,h?"bottom-aligned":"top-aligned"),Gb(this.el,u?"right-aligned":"left-aligned"),Gb(this.el,h?"top-aligned":"bottom-aligned"))},render:function(n,e,t){let r=this._o,i=new Date,s=nD(n,e),o=new Date(n,e,1).getDay(),a=[],l=[];Zp(i),r.firstDay>0&&(o-=r.firstDay,o<0&&(o+=7));let u=e===0?11:e-1,h=e===11?0:e+1,c=e===0?n-1:n,d=e===11?n+1:n,f=nD(c,u),m=s+o,p=m;for(;p>7;)p-=7;m+=7-p;let v=!1;for(let y=0,S=0;y<m;y++){let R=new Date(n,e,1+(y-o)),T=qi(this._d)?Jp(R,this._d):!1,I=Jp(R,i),H=r.events.indexOf(R.toDateString())!==-1,k=y<o||y>=s+o,W=1+(y-o),Y=e,$=n,q=r.startRange&&Jp(r.startRange,R),J=r.endRange&&Jp(r.endRange,R),re=r.startRange&&r.endRange&&r.startRange<R&&R<r.endRange,ie=r.minDate&&R<r.minDate||r.maxDate&&R>r.maxDate||r.disableWeekends&&IJ(R)||r.disableDayFn&&r.disableDayFn(R);k&&(y<o?(W=f+W,Y=u,$=c):(W=W-s,Y=h,$=d));let ae={day:W,month:Y,year:$,hasEvent:H,isSelected:T,isToday:I,isDisabled:ie,isEmpty:k,isStartRange:q,isEndRange:J,isInRange:re,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&T&&(v=!0),l.push(OJ(ae)),++S===7&&(r.showWeekNumber&&l.unshift(xJ(this,y-o,e,n,r.firstWeekOfYearMinDays)),a.push(PJ(l,r.isRTL,r.pickWholeWeek,v)),l=[],S=0,v=!1)}return FJ(r,a,t)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Gb(this.el,"is-hidden"),this._o.bound&&(Ko(Cs(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let n=this._v;n!==!1&&(this._o.bound&&Ha(Cs(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),$b(this.el,"is-hidden"),this._v=!1,n!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let n=this._o;this.hide(),Ha(this.el,"mousedown",this._onMouseDown,!0),Ha(this.el,"touchend",this._onMouseDown,!0),Ha(this.el,"change",this._onChange),n.keyboardInput&&Ha(Cs(),"keydown",this._onKeyChange),n.field&&(Ha(n.field,"change",this._onInputChange),n.bound&&(Ha(n.trigger,"click",this._onInputClick),Ha(n.trigger,"focus",this._onInputFocus),Ha(n.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function jb(n,e,t){return(e=kJ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kJ(n){var e=VJ(n,"string");return typeof e=="symbol"?e:e+""}function VJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const FB="date",oD="dateEditor";class kB extends uc{constructor(){super(...arguments),jb(this,"defaultDateFormat","DD/MM/YYYY"),jb(this,"parentDestroyed",!1),jb(this,"$datePicker",null)}static get EDITOR_TYPE(){return FB}init(){if(typeof le!="function")throw new Error("You need to include moment.js to your project.");if(typeof sN!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ue(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Je(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:oD})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(oD),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,t)}showDatepicker(e){const t=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.hot.view.isMouseDown(),i=e?yU(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new sN(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(le),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,le(s,t,!0).isValid()&&this.$datePicker.setMoment(le(s,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,le(s,t,!0).isValid()&&this.$datePicker.setMoment(le(s,t),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&VC(t,this.cellProperties.datePickerConfig);const r=t.onSelect,i=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.keyboardInput=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=s=>{let o=s;isNaN(o.getTime())||(o=le(o).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(o),r&&r()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},t}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==Bn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(t=s.getParentOverlay(this.TD))!==null&&t!==void 0?t:this.hot.view._wt,a=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),h=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=h){const c=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+c.top+er(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=c.right-gn(this.datePicker):d+=c.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}const UJ="dropdown";class QM extends qM{static get EDITOR_TYPE(){return UJ}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}Ie.getSingleton().add("beforeValidate",function(n,e,t){const r=this.propToCol(t);if(Number.isInteger(r)){const i=this.getCellMeta(e,r);i.editor===QM&&i.strict===void 0&&(i.filter=!1,i.strict=!0)}});const BJ="numeric";class VB extends uc{static get EDITOR_TYPE(){return BJ}}const WJ="password";class UB extends uc{static get EDITOR_TYPE(){return WJ}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,pa(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const zb="ht_editor_visible",aD="selectEditor",$J="select";class BB extends nf{static get EDITOR_TYPE(){return $J}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",ue(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Je(this.select,zb)&&rt(this.select,zb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),pa(this.select),gt(l,(u,h)=>{const c=this.hot.rootDocument.createElement("OPTION");c.value=h,ef(c,u),this.select.appendChild(c)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)t[e[r]]=e[r];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Bn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:r,height:i}=this.getEditedCellRect(),s=this.select.style;s.height=`${i}px`,s.width=`${r}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${t}px`,s.margin="0px",ue(this.select,zb)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={group:aD};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(aD)}}const GJ="time";class WB extends uc{static get EDITOR_TYPE(){return GJ}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o),this.TEXTAREA.dir="ltr"}}function jJ(){zi(nf),zi(qM),zi(HB),zi(kB),zi(QM),zi(KM),zi(VB),zi(UB),zi(BB),zi(uc),zi(WB)}const zJ="html";function ZM(n,e,t,r,i,s,o){Qg.apply(this,[n,e,t,r,i,s,o]),ef(e,s??"",!1)}ZM.RENDERER_TYPE=zJ;const YJ="autocomplete";function rf(n,e,t,r,i,s,o){const{rootDocument:a}=n,l=o.allowHtml?ZM:Rl,u=a.createElement("DIV"),h=n.getSettings().ariaTags;if(u.className="htAutocompleteArrow",h&&u.setAttribute(...ac()),u.appendChild(a.createTextNode("▼")),l.apply(this,[n,e,t,r,i,s,o]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),ue(e,"htAutocomplete"),!n.acArrowListener){const c=new Co(n);n.acArrowListener=function(d){Je(d.target,"htAutocompleteArrow")&&n.view._wt.getSetting("onCellDblClick",null,n._createCellCoords(t,r),e)},c.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",()=>{c.destroy()})}}rf.RENDERER_TYPE=YJ;const KJ="dropdown";function JM(n,e,t,r,i,s,o){rf.apply(this,[n,e,t,r,i,s,o])}JM.RENDERER_TYPE=KJ;const lD=new WeakMap,uD=new WeakMap,qJ="htBadValue",Wd="data-row",$d="data-col",XJ="checkboxRenderer",$B="checkbox";Ie.getSingleton().add("modifyAutoColumnSizeSeed",function(n,e,t){const{label:r,type:i,row:s,column:o,prop:a}=e;if(i===$B){if(r){const{value:l,property:u}=r;let h=t;if(l)h=typeof l=="function"?l(s,o,a,t):l;else if(u){const c=this.getDataAtRowProp(s,u);h=c!==null?c:t}n=h}return n}});function eO(n,e,t,r,i,s,o){const{rootDocument:a}=n,l=n.getSettings().ariaTags;Qg.apply(this,[n,e,t,r,i,s,o]),QJ(n);let u=ZJ(a);const h=o.label;let c=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),pa(e),s===o.checkedTemplate||Zn(s).toLocaleLowerCase(o.locale)===Zn(o.checkedTemplate).toLocaleLowerCase(o.locale)?u.checked=!0:s===o.uncheckedTemplate||Zn(s).toLocaleLowerCase(o.locale)===Zn(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?u.checked=!1:Gn(s)?ue(u,"noValue"):(u.style.display="none",ue(u,qJ),c=!0),Xe(u,[[Wd,t],[$d,r]]),l&&Xe(u,[ey(u.checked?n.getTranslatedPhrase($M):n.getTranslatedPhrase(GM)),tU(u.checked),Z6()]),!c&&h){let p="";if(h.value)p=typeof h.value=="function"?h.value.call(this,t,r,i,s):h.value;else if(h.property){const y=n.getDataAtRowProp(t,h.property);p=y!==null?y:""}const v=JJ(a,p,h.separated!==!0);h.position==="before"?h.separated?(e.appendChild(v),e.appendChild(u)):(v.appendChild(u),u=v):(!h.position||h.position==="after")&&(h.separated?(e.appendChild(u),e.appendChild(v)):(v.insertBefore(u,v.firstChild),u=v))}(!h||h&&!h.separated)&&e.appendChild(u),c&&e.appendChild(a.createTextNode("#bad-value#")),lD.has(n)||(lD.set(n,!0),d());function d(){const v=n.getShortcutManager().getContext("grid"),y={group:XJ,relativeToGroup:Tu,position:"before"};v.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var S;return(S=n.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{const S=n.getSelectedRangeLast();return n.getSettings().enterBeginsEditing&&S?.isSingle()&&S.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var S;return(S=n.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight.isCell()}}],y)}function f(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const v=n.getSelectedRange(),y=[],S=new Map;let R=[],T=0;if(v){for(let I=0;I<v.length;I++){const{row:H,col:k}=v[I].getTopStartCorner(),{row:W,col:Y}=v[I].getBottomEndCorner();for(let $=H;$<=W;$+=1)for(let q=k;q<=Y;q+=1){const J=n.getCellMeta($,q),re={checkedTemplate:J.checkedTemplate,uncheckedTemplate:J.uncheckedTemplate};if(J.type!=="checkbox"){p===!0&&!J.readOnly&&(S.has(y.length)?S.set(y.length,[...S.get(y.length),[$,q,null]]):S.set(y.length,[[$,q,null]]));continue}if(J.readOnly===!0)continue;typeof J.checkedTemplate>"u"&&(J.checkedTemplate=!0),typeof J.uncheckedTemplate>"u"&&(J.uncheckedTemplate=!1);const ie=n.getDataAtCell($,q);p===!1?[J.checkedTemplate,J.checkedTemplate.toString()].includes(ie)?R.push([$,q,J.uncheckedTemplate,re]):[J.uncheckedTemplate,J.uncheckedTemplate.toString(),null,void 0].includes(ie)&&R.push([$,q,J.checkedTemplate,re]):R.push([$,q,J.uncheckedTemplate,re]),T+=1}y.push(T),T=0}R.every(I=>{let[,,H]=I;return H===R[0][2]})?R=R.map(I=>{let[H,k,W]=I;return[H,k,W]}):R=R.map(I=>{let[H,k,,W]=I;return[H,k,W.checkedTemplate]}),R.length>0&&y.forEach((I,H)=>{let k=R.splice(0,I);S.size&&S.has(H)&&(k=[...k,...S.get(H)]),n.setDataAtCell(k)})}}function m(){const p=n.getSelectedRange();if(p){for(let v=0;v<p.length;v++){const y=p[v].getTopStartCorner(),S=p[v].getBottomEndCorner();for(let R=y.row;R<=S.row;R++)for(let T=y.col;T<=S.col;T++){const I=n.getCellMeta(R,T),H=n.getCell(R,T);if(H==null)return!0;if(H.querySelectorAll("input[type=checkbox]").length>0&&!I.readOnly)return!0}}return!1}}}eO.RENDERER_TYPE=$B;function QJ(n){let e=uD.get(n);if(!e){const{rootElement:t}=n;e=new Co(n),e.addEventListener(t,"click",r=>tee(r,n)),e.addEventListener(t,"mouseup",r=>eee(r,n)),e.addEventListener(t,"change",r=>nee(r,n)),uD.set(n,e)}return e}function ZJ(n){const e=n.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function JJ(n,e,t){const r=n.createElement("label");return r.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`,r.appendChild(n.createTextNode(e)),r.cloneNode(!0)}function eee(n,e){const{target:t}=n;tO(t)&&(!t.hasAttribute(Wd)||!t.hasAttribute($d)||setTimeout(e.listen,10))}function tee(n,e){const{target:t}=n;if(!tO(t)||!t.hasAttribute(Wd)||!t.hasAttribute($d))return;const r=parseInt(t.getAttribute(Wd),10),i=parseInt(t.getAttribute($d),10);e.getCellMeta(r,i).readOnly&&n.preventDefault()}function nee(n,e){const{target:t}=n;if(!tO(t)||!t.hasAttribute(Wd)||!t.hasAttribute($d))return;const r=parseInt(t.getAttribute(Wd),10),i=parseInt(t.getAttribute($d),10),s=e.getCellMeta(r,i);if(!s.readOnly){let o=null;n.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(r,i,o)}}function tO(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}const ree="handsontable";function nO(n,e,t,r,i,s,o){rf.apply(this,[n,e,t,r,i,s,o])}nO.RENDERER_TYPE=ree;function ew(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Yb={exports:{}},hD;function iee(){return hD||(hD=1,(function(n,e){(function(t){n.exports=t()})(function(){return(function t(r,i,s){function o(u,h){if(!i[u]){if(!r[u]){var c=typeof ew=="function"&&ew;if(!h&&c)return c(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=i[u]={exports:{}};r[u][0].call(f.exports,function(m){return o(r[u][1][m]||m)},f,f.exports,t,r,i,s)}return i[u].exports}for(var a=typeof ew=="function"&&ew,l=0;l<s.length;l++)o(s[l]);return o})({1:[function(t,r,i){(function(s){var o,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,h="[BigNumber Error] ",c=h+"Number primitive has more than 15 significant digits: ",d=1e14,f=14,m=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],v=1e7,y=1e9;function S(Y){var $=0|Y;return 0<Y||Y===$?$:$-1}function R(Y){for(var $,q,J=1,re=Y.length,ie=Y[0]+"";J<re;){for($=Y[J++]+"",q=f-$.length;q--;$="0"+$);ie+=$}for(re=ie.length;ie.charCodeAt(--re)===48;);return ie.slice(0,re+1||1)}function T(Y,$){var q,J,re=Y.c,ie=$.c,ae=Y.s,Ve=$.s,De=Y.e,Se=$.e;if(!ae||!Ve)return null;if(q=re&&!re[0],J=ie&&!ie[0],q||J)return q?J?0:-Ve:ae;if(ae!=Ve)return ae;if(q=ae<0,J=De==Se,!re||!ie)return J?0:!re^q?1:-1;if(!J)return Se<De^q?1:-1;for(Ve=(De=re.length)<(Se=ie.length)?De:Se,ae=0;ae<Ve;ae++)if(re[ae]!=ie[ae])return re[ae]>ie[ae]^q?1:-1;return De==Se?0:Se<De^q?1:-1}function I(Y,$,q,J){if(Y<$||q<Y||Y!==(Y<0?l(Y):u(Y)))throw Error(h+(J||"Argument")+(typeof Y=="number"?Y<$||q<Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Y))}function H(Y){var $=Y.c.length-1;return S(Y.e/f)==$&&Y.c[$]%2!=0}function k(Y,$){return(1<Y.length?Y.charAt(0)+"."+Y.slice(1):Y)+($<0?"e":"e+")+$}function W(Y,$,q){var J,re;if($<0){for(re=q+".";++$;re+=q);Y=re+Y}else if(++$>(J=Y.length)){for(re=q,$-=J;--$;re+=q);Y+=re}else $<J&&(Y=Y.slice(0,$)+"."+Y.slice($));return Y}(o=(function Y($){var q,J,re,ie,ae,Ve,De,Se,pe,ze,w=Q.prototype={constructor:Q,toString:null,valueOf:null},C=new Q(1),b=20,P=4,L=-7,G=21,ee=-1e7,ne=1e7,he=!1,we=1,oe=0,We={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Ke="0123456789abcdefghijklmnopqrstuvwxyz";function Q(A,O){var x,z,F,X,B,V,K,j,Z=this;if(!(Z instanceof Q))return new Q(A,O);if(O==null){if(A instanceof Q)return Z.s=A.s,Z.e=A.e,void(Z.c=(A=A.c)?A.slice():A);if((V=typeof A=="number")&&0*A==0){if(Z.s=1/A<0?(A=-A,-1):1,A===~~A){for(X=0,B=A;10<=B;B/=10,X++);return Z.e=X,void(Z.c=[A])}j=String(A)}else{if(j=String(A),!a.test(j))return re(Z,j,V);Z.s=j.charCodeAt(0)==45?(j=j.slice(1),-1):1}-1<(X=j.indexOf("."))&&(j=j.replace(".","")),0<(B=j.search(/e/i))?(X<0&&(X=B),X+=+j.slice(B+1),j=j.substring(0,B)):X<0&&(X=j.length)}else{if(I(O,2,Ke.length,"Base"),j=String(A),O==10)return Ze(Z=new Q(A instanceof Q?A:j),b+Z.e+1,P);if(V=typeof A=="number"){if(0*A!=0)return re(Z,j,V,O);if(Z.s=1/A<0?(j=j.slice(1),-1):1,Q.DEBUG&&15<j.replace(/^0\.0*|\./,"").length)throw Error(c+A);V=!1}else Z.s=j.charCodeAt(0)===45?(j=j.slice(1),-1):1;for(x=Ke.slice(0,O),X=B=0,K=j.length;B<K;B++)if(x.indexOf(z=j.charAt(B))<0){if(z=="."){if(X<B){X=K;continue}}else if(!F&&(j==j.toUpperCase()&&(j=j.toLowerCase())||j==j.toLowerCase()&&(j=j.toUpperCase()))){F=!0,B=-1,X=0;continue}return re(Z,String(A),V,O)}-1<(X=(j=J(j,O,10,Z.s)).indexOf("."))?j=j.replace(".",""):X=j.length}for(B=0;j.charCodeAt(B)===48;B++);for(K=j.length;j.charCodeAt(--K)===48;);if(j=j.slice(B,++K)){if(K-=B,V&&Q.DEBUG&&15<K&&(m<A||A!==u(A)))throw Error(c+Z.s*A);if(ne<(X=X-B-1))Z.c=Z.e=null;else if(X<ee)Z.c=[Z.e=0];else{if(Z.e=X,Z.c=[],B=(X+1)%f,X<0&&(B+=f),B<K){for(B&&Z.c.push(+j.slice(0,B)),K-=f;B<K;)Z.c.push(+j.slice(B,B+=f));j=j.slice(B),B=f-j.length}else B-=K;for(;B--;j+="0");Z.c.push(+j)}}else Z.c=[Z.e=0]}function Qe(A,O,x,z){var F,X,B,V,K;if(x==null?x=P:I(x,0,8),!A.c)return A.toString();if(F=A.c[0],B=A.e,O==null)K=R(A.c),K=z==1||z==2&&(B<=L||G<=B)?k(K,B):W(K,B,"0");else if(X=(A=Ze(new Q(A),O,x)).e,V=(K=R(A.c)).length,z==1||z==2&&(O<=X||X<=L)){for(;V<O;K+="0",V++);K=k(K,X)}else if(O-=B,K=W(K,X,"0"),V<X+1){if(0<--O)for(K+=".";O--;K+="0");}else if(0<(O+=X-V))for(X+1==V&&(K+=".");O--;K+="0");return A.s<0&&F?"-"+K:K}function et(A,O){for(var x,z=1,F=new Q(A[0]);z<A.length;z++){if(!(x=new Q(A[z])).s){F=x;break}O.call(F,x)&&(F=x)}return F}function ht(A,O,x){for(var z=1,F=O.length;!O[--F];O.pop());for(F=O[0];10<=F;F/=10,z++);return(x=z+x*f-1)>ne?A.c=A.e=null:A.c=x<ee?[A.e=0]:(A.e=x,O),A}function Ze(A,O,x,z){var F,X,B,V,K,j,Z,me=A.c,be=p;if(me){e:{for(F=1,V=me[0];10<=V;V/=10,F++);if((X=O-F)<0)X+=f,B=O,Z=(K=me[j=0])/be[F-B-1]%10|0;else if((j=l((X+1)/f))>=me.length){if(!z)break e;for(;me.length<=j;me.push(0));K=Z=0,B=(X%=f)-f+(F=1)}else{for(K=V=me[j],F=1;10<=V;V/=10,F++);Z=(B=(X%=f)-f+F)<0?0:K/be[F-B-1]%10|0}if(z=z||O<0||me[j+1]!=null||(B<0?K:K%be[F-B-1]),z=x<4?(Z||z)&&(x==0||x==(A.s<0?3:2)):5<Z||Z==5&&(x==4||z||x==6&&(0<X?0<B?K/be[F-B]:0:me[j-1])%10&1||x==(A.s<0?8:7)),O<1||!me[0])return me.length=0,z?(O-=A.e+1,me[0]=be[(f-O%f)%f],A.e=-O||0):me[0]=A.e=0,A;if(X==0?(me.length=j,V=1,j--):(me.length=j+1,V=be[f-X],me[j]=0<B?u(K/be[F-B]%be[B])*V:0),z)for(;;){if(j==0){for(X=1,B=me[0];10<=B;B/=10,X++);for(B=me[0]+=V,V=1;10<=B;B/=10,V++);X!=V&&(A.e++,me[0]==d&&(me[0]=1));break}if(me[j]+=V,me[j]!=d)break;me[j--]=0,V=1}for(X=me.length;me[--X]===0;me.pop());}A.e>ne?A.c=A.e=null:A.e<ee&&(A.c=[A.e=0])}return A}function ke(A){var O,x=A.e;return x===null?A.toString():(O=R(A.c),O=x<=L||G<=x?k(O,x):W(O,x,"0"),A.s<0?"-"+O:O)}return Q.clone=Y,Q.ROUND_UP=0,Q.ROUND_DOWN=1,Q.ROUND_CEIL=2,Q.ROUND_FLOOR=3,Q.ROUND_HALF_UP=4,Q.ROUND_HALF_DOWN=5,Q.ROUND_HALF_EVEN=6,Q.ROUND_HALF_CEIL=7,Q.ROUND_HALF_FLOOR=8,Q.EUCLID=9,Q.config=Q.set=function(A){var O,x;if(A!=null){if(typeof A!="object")throw Error(h+"Object expected: "+A);if(A.hasOwnProperty(O="DECIMAL_PLACES")&&(I(x=A[O],0,y,O),b=x),A.hasOwnProperty(O="ROUNDING_MODE")&&(I(x=A[O],0,8,O),P=x),A.hasOwnProperty(O="EXPONENTIAL_AT")&&((x=A[O])&&x.pop?(I(x[0],-y,0,O),I(x[1],0,y,O),L=x[0],G=x[1]):(I(x,-y,y,O),L=-(G=x<0?-x:x))),A.hasOwnProperty(O="RANGE"))if((x=A[O])&&x.pop)I(x[0],-y,-1,O),I(x[1],1,y,O),ee=x[0],ne=x[1];else{if(I(x,-y,y,O),!x)throw Error(h+O+" cannot be zero: "+x);ee=-(ne=x<0?-x:x)}if(A.hasOwnProperty(O="CRYPTO")){if((x=A[O])!==!!x)throw Error(h+O+" not true or false: "+x);if(x){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw he=!x,Error(h+"crypto unavailable");he=x}else he=x}if(A.hasOwnProperty(O="MODULO_MODE")&&(I(x=A[O],0,9,O),we=x),A.hasOwnProperty(O="POW_PRECISION")&&(I(x=A[O],0,y,O),oe=x),A.hasOwnProperty(O="FORMAT")){if(typeof(x=A[O])!="object")throw Error(h+O+" not an object: "+x);We=x}if(A.hasOwnProperty(O="ALPHABET")){if(typeof(x=A[O])!="string"||/^.$|[+-.\s]|(.).*\1/.test(x))throw Error(h+O+" invalid: "+x);Ke=x}}return{DECIMAL_PLACES:b,ROUNDING_MODE:P,EXPONENTIAL_AT:[L,G],RANGE:[ee,ne],CRYPTO:he,MODULO_MODE:we,POW_PRECISION:oe,FORMAT:We,ALPHABET:Ke}},Q.isBigNumber=function(A){return A instanceof Q||A&&A._isBigNumber===!0||!1},Q.maximum=Q.max=function(){return et(arguments,w.lt)},Q.minimum=Q.min=function(){return et(arguments,w.gt)},Q.random=(ie=9007199254740992,ae=Math.random()*ie&2097151?function(){return u(Math.random()*ie)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(A){var O,x,z,F,X,B=0,V=[],K=new Q(C);if(A==null?A=b:I(A,0,y),F=l(A/f),he)if(crypto.getRandomValues){for(O=crypto.getRandomValues(new Uint32Array(F*=2));B<F;)9e15<=(X=131072*O[B]+(O[B+1]>>>11))?(x=crypto.getRandomValues(new Uint32Array(2)),O[B]=x[0],O[B+1]=x[1]):(V.push(X%1e14),B+=2);B=F/2}else{if(!crypto.randomBytes)throw he=!1,Error(h+"crypto unavailable");for(O=crypto.randomBytes(F*=7);B<F;)9e15<=(X=281474976710656*(31&O[B])+1099511627776*O[B+1]+4294967296*O[B+2]+16777216*O[B+3]+(O[B+4]<<16)+(O[B+5]<<8)+O[B+6])?crypto.randomBytes(7).copy(O,B):(V.push(X%1e14),B+=7);B=F/7}if(!he)for(;B<F;)(X=ae())<9e15&&(V[B++]=X%1e14);for(F=V[--B],A%=f,F&&A&&(X=p[f-A],V[B]=u(F/X)*X);V[B]===0;V.pop(),B--);if(B<0)V=[z=0];else{for(z=-1;V[0]===0;V.splice(0,1),z-=f);for(B=1,X=V[0];10<=X;X/=10,B++);B<f&&(z-=f-B)}return K.e=z,K.c=V,K}),Q.sum=function(){for(var A=1,O=arguments,x=new Q(O[0]);A<O.length;)x=x.plus(O[A++]);return x},J=(function(){var A="0123456789";function O(x,z,F,X){for(var B,V,K=[0],j=0,Z=x.length;j<Z;){for(V=K.length;V--;K[V]*=z);for(K[0]+=X.indexOf(x.charAt(j++)),B=0;B<K.length;B++)K[B]>F-1&&(K[B+1]==null&&(K[B+1]=0),K[B+1]+=K[B]/F|0,K[B]%=F)}return K.reverse()}return function(x,z,F,X,B){var V,K,j,Z,me,be,Ue,nt,Rt=x.indexOf("."),ut=b,qe=P;for(0<=Rt&&(Z=oe,oe=0,x=x.replace(".",""),be=(nt=new Q(z)).pow(x.length-Rt),oe=Z,nt.c=O(W(R(be.c),be.e,"0"),10,F,A),nt.e=nt.c.length),j=Z=(Ue=O(x,z,F,B?(V=Ke,A):(V=A,Ke))).length;Ue[--Z]==0;Ue.pop());if(!Ue[0])return V.charAt(0);if(Rt<0?--j:(be.c=Ue,be.e=j,be.s=X,Ue=(be=q(be,nt,ut,qe,F)).c,me=be.r,j=be.e),Rt=Ue[K=j+ut+1],Z=F/2,me=me||K<0||Ue[K+1]!=null,me=qe<4?(Rt!=null||me)&&(qe==0||qe==(be.s<0?3:2)):Z<Rt||Rt==Z&&(qe==4||me||qe==6&&1&Ue[K-1]||qe==(be.s<0?8:7)),K<1||!Ue[0])x=me?W(V.charAt(1),-ut,V.charAt(0)):V.charAt(0);else{if(Ue.length=K,me)for(--F;++Ue[--K]>F;)Ue[K]=0,K||(++j,Ue=[1].concat(Ue));for(Z=Ue.length;!Ue[--Z];);for(Rt=0,x="";Rt<=Z;x+=V.charAt(Ue[Rt++]));x=W(x,j,V.charAt(0))}return x}})(),q=(function(){function A(z,F,X){var B,V,K,j,Z=0,me=z.length,be=F%v,Ue=F/v|0;for(z=z.slice();me--;)Z=((V=be*(K=z[me]%v)+(B=Ue*K+(j=z[me]/v|0)*be)%v*v+Z)/X|0)+(B/v|0)+Ue*j,z[me]=V%X;return Z&&(z=[Z].concat(z)),z}function O(z,F,X,B){var V,K;if(X!=B)K=B<X?1:-1;else for(V=K=0;V<X;V++)if(z[V]!=F[V]){K=z[V]>F[V]?1:-1;break}return K}function x(z,F,X,B){for(var V=0;X--;)z[X]-=V,V=z[X]<F[X]?1:0,z[X]=V*B+z[X]-F[X];for(;!z[0]&&1<z.length;z.splice(0,1));}return function(z,F,X,B,V){var K,j,Z,me,be,Ue,nt,Rt,ut,qe,Ct,pn,Tl,Bi,Al,wi,cn,jn=z.s==F.s?1:-1,se=z.c,Te=F.c;if(!(se&&se[0]&&Te&&Te[0]))return new Q(z.s&&F.s&&(se?!Te||se[0]!=Te[0]:Te)?se&&se[0]==0||!Te?0*jn:jn/0:NaN);for(ut=(Rt=new Q(jn)).c=[],jn=X+(j=z.e-F.e)+1,V||(V=d,j=S(z.e/f)-S(F.e/f),jn=jn/f|0),Z=0;Te[Z]==(se[Z]||0);Z++);if(Te[Z]>(se[Z]||0)&&j--,jn<0)ut.push(1),me=!0;else{for(Bi=se.length,wi=Te.length,jn+=2,1<(be=u(V/(Te[Z=0]+1)))&&(Te=A(Te,be,V),se=A(se,be,V),wi=Te.length,Bi=se.length),Tl=wi,Ct=(qe=se.slice(0,wi)).length;Ct<wi;qe[Ct++]=0);cn=Te.slice(),cn=[0].concat(cn),Al=Te[0],Te[1]>=V/2&&Al++;do{if(be=0,(K=O(Te,qe,wi,Ct))<0){if(pn=qe[0],wi!=Ct&&(pn=pn*V+(qe[1]||0)),1<(be=u(pn/Al)))for(V<=be&&(be=V-1),nt=(Ue=A(Te,be,V)).length,Ct=qe.length;O(Ue,qe,nt,Ct)==1;)be--,x(Ue,wi<nt?cn:Te,nt,V),nt=Ue.length,K=1;else be==0&&(K=be=1),nt=(Ue=Te.slice()).length;if(nt<Ct&&(Ue=[0].concat(Ue)),x(qe,Ue,Ct,V),Ct=qe.length,K==-1)for(;O(Te,qe,wi,Ct)<1;)be++,x(qe,wi<Ct?cn:Te,Ct,V),Ct=qe.length}else K===0&&(be++,qe=[0]);ut[Z++]=be,qe[0]?qe[Ct++]=se[Tl]||0:(qe=[se[Tl]],Ct=1)}while((Tl++<Bi||qe[0]!=null)&&jn--);me=qe[0]!=null,ut[0]||ut.splice(0,1)}if(V==d){for(Z=1,jn=ut[0];10<=jn;jn/=10,Z++);Ze(Rt,X+(Rt.e=Z+j*f-1)+1,B,me)}else Rt.e=j,Rt.r=+me;return Rt}})(),Ve=/^(-?)0([xbo])(?=\w[\w.]*$)/i,De=/^([^.]+)\.$/,Se=/^\.([^.]+)$/,pe=/^-?(Infinity|NaN)$/,ze=/^\s*\+(?=[\w.])|^\s+|\s+$/g,re=function(A,O,x,z){var F,X=x?O:O.replace(ze,"");if(pe.test(X))A.s=isNaN(X)?null:X<0?-1:1,A.c=A.e=null;else{if(!x&&(X=X.replace(Ve,function(B,V,K){return F=(K=K.toLowerCase())=="x"?16:K=="b"?2:8,z&&z!=F?B:V}),z&&(F=z,X=X.replace(De,"$1").replace(Se,"0.$1")),O!=X))return new Q(X,F);if(Q.DEBUG)throw Error(h+"Not a"+(z?" base "+z:"")+" number: "+O);A.c=A.e=A.s=null}},w.absoluteValue=w.abs=function(){var A=new Q(this);return A.s<0&&(A.s=1),A},w.comparedTo=function(A,O){return T(this,new Q(A,O))},w.decimalPlaces=w.dp=function(A,O){var x,z,F;if(A!=null)return I(A,0,y),O==null?O=P:I(O,0,8),Ze(new Q(this),A+this.e+1,O);if(!(x=this.c))return null;if(z=((F=x.length-1)-S(this.e/f))*f,F=x[F])for(;F%10==0;F/=10,z--);return z<0&&(z=0),z},w.dividedBy=w.div=function(A,O){return q(this,new Q(A,O),b,P)},w.dividedToIntegerBy=w.idiv=function(A,O){return q(this,new Q(A,O),0,1)},w.exponentiatedBy=w.pow=function(A,O){var x,z,F,X,B,V,K,j,Z=this;if((A=new Q(A)).c&&!A.isInteger())throw Error(h+"Exponent not an integer: "+ke(A));if(O!=null&&(O=new Q(O)),B=14<A.e,!Z.c||!Z.c[0]||Z.c[0]==1&&!Z.e&&Z.c.length==1||!A.c||!A.c[0])return j=new Q(Math.pow(+ke(Z),B?2-H(A):+ke(A))),O?j.mod(O):j;if(V=A.s<0,O){if(O.c?!O.c[0]:!O.s)return new Q(NaN);(z=!V&&Z.isInteger()&&O.isInteger())&&(Z=Z.mod(O))}else{if(9<A.e&&(0<Z.e||Z.e<-1||(Z.e==0?1<Z.c[0]||B&&24e7<=Z.c[1]:Z.c[0]<8e13||B&&Z.c[0]<=9999975e7)))return X=Z.s<0&&H(A)?-0:0,-1<Z.e&&(X=1/X),new Q(V?1/X:X);oe&&(X=l(oe/f+2))}for(K=B?(x=new Q(.5),V&&(A.s=1),H(A)):(F=Math.abs(+ke(A)))%2,j=new Q(C);;){if(K){if(!(j=j.times(Z)).c)break;X?j.c.length>X&&(j.c.length=X):z&&(j=j.mod(O))}if(F){if((F=u(F/2))===0)break;K=F%2}else if(Ze(A=A.times(x),A.e+1,1),14<A.e)K=H(A);else{if((F=+ke(A))==0)break;K=F%2}Z=Z.times(Z),X?Z.c&&Z.c.length>X&&(Z.c.length=X):z&&(Z=Z.mod(O))}return z?j:(V&&(j=C.div(j)),O?j.mod(O):X?Ze(j,oe,P,void 0):j)},w.integerValue=function(A){var O=new Q(this);return A==null?A=P:I(A,0,8),Ze(O,O.e+1,A)},w.isEqualTo=w.eq=function(A,O){return T(this,new Q(A,O))===0},w.isFinite=function(){return!!this.c},w.isGreaterThan=w.gt=function(A,O){return 0<T(this,new Q(A,O))},w.isGreaterThanOrEqualTo=w.gte=function(A,O){return(O=T(this,new Q(A,O)))===1||O===0},w.isInteger=function(){return!!this.c&&S(this.e/f)>this.c.length-2},w.isLessThan=w.lt=function(A,O){return T(this,new Q(A,O))<0},w.isLessThanOrEqualTo=w.lte=function(A,O){return(O=T(this,new Q(A,O)))===-1||O===0},w.isNaN=function(){return!this.s},w.isNegative=function(){return this.s<0},w.isPositive=function(){return 0<this.s},w.isZero=function(){return!!this.c&&this.c[0]==0},w.minus=function(A,O){var x,z,F,X,B=this,V=B.s;if(O=(A=new Q(A,O)).s,!V||!O)return new Q(NaN);if(V!=O)return A.s=-O,B.plus(A);var K=B.e/f,j=A.e/f,Z=B.c,me=A.c;if(!K||!j){if(!Z||!me)return Z?(A.s=-O,A):new Q(me?B:NaN);if(!Z[0]||!me[0])return me[0]?(A.s=-O,A):new Q(Z[0]?B:P==3?-0:0)}if(K=S(K),j=S(j),Z=Z.slice(),V=K-j){for((F=(X=V<0)?(V=-V,Z):(j=K,me)).reverse(),O=V;O--;F.push(0));F.reverse()}else for(z=(X=(V=Z.length)<(O=me.length))?V:O,V=O=0;O<z;O++)if(Z[O]!=me[O]){X=Z[O]<me[O];break}if(X&&(F=Z,Z=me,me=F,A.s=-A.s),0<(O=(z=me.length)-(x=Z.length)))for(;O--;Z[x++]=0);for(O=d-1;V<z;){if(Z[--z]<me[z]){for(x=z;x&&!Z[--x];Z[x]=O);--Z[x],Z[z]+=d}Z[z]-=me[z]}for(;Z[0]==0;Z.splice(0,1),--j);return Z[0]?ht(A,Z,j):(A.s=P==3?-1:1,A.c=[A.e=0],A)},w.modulo=w.mod=function(A,O){var x,z,F=this;return A=new Q(A,O),!F.c||!A.s||A.c&&!A.c[0]?new Q(NaN):!A.c||F.c&&!F.c[0]?new Q(F):(we==9?(z=A.s,A.s=1,x=q(F,A,0,3),A.s=z,x.s*=z):x=q(F,A,0,we),(A=F.minus(x.times(A))).c[0]||we!=1||(A.s=F.s),A)},w.multipliedBy=w.times=function(A,O){var x,z,F,X,B,V,K,j,Z,me,be,Ue,nt,Rt,ut,qe=this,Ct=qe.c,pn=(A=new Q(A,O)).c;if(!(Ct&&pn&&Ct[0]&&pn[0]))return!qe.s||!A.s||Ct&&!Ct[0]&&!pn||pn&&!pn[0]&&!Ct?A.c=A.e=A.s=null:(A.s*=qe.s,Ct&&pn?(A.c=[0],A.e=0):A.c=A.e=null),A;for(z=S(qe.e/f)+S(A.e/f),A.s*=qe.s,(K=Ct.length)<(me=pn.length)&&(nt=Ct,Ct=pn,pn=nt,F=K,K=me,me=F),F=K+me,nt=[];F--;nt.push(0));for(Rt=d,ut=v,F=me;0<=--F;){for(x=0,be=pn[F]%ut,Ue=pn[F]/ut|0,X=F+(B=K);F<X;)x=((j=be*(j=Ct[--B]%ut)+(V=Ue*j+(Z=Ct[B]/ut|0)*be)%ut*ut+nt[X]+x)/Rt|0)+(V/ut|0)+Ue*Z,nt[X--]=j%Rt;nt[X]=x}return x?++z:nt.splice(0,1),ht(A,nt,z)},w.negated=function(){var A=new Q(this);return A.s=-A.s||null,A},w.plus=function(A,O){var x,z=this,F=z.s;if(O=(A=new Q(A,O)).s,!F||!O)return new Q(NaN);if(F!=O)return A.s=-O,z.minus(A);var X=z.e/f,B=A.e/f,V=z.c,K=A.c;if(!X||!B){if(!V||!K)return new Q(F/0);if(!V[0]||!K[0])return K[0]?A:new Q(V[0]?z:0*F)}if(X=S(X),B=S(B),V=V.slice(),F=X-B){for((x=0<F?(B=X,K):(F=-F,V)).reverse();F--;x.push(0));x.reverse()}for((F=V.length)-(O=K.length)<0&&(x=K,K=V,V=x,O=F),F=0;O;)F=(V[--O]=V[O]+K[O]+F)/d|0,V[O]=d===V[O]?0:V[O]%d;return F&&(V=[F].concat(V),++B),ht(A,V,B)},w.precision=w.sd=function(A,O){var x,z,F;if(A!=null&&A!==!!A)return I(A,1,y),O==null?O=P:I(O,0,8),Ze(new Q(this),A,O);if(!(x=this.c))return null;if(z=(F=x.length-1)*f+1,F=x[F]){for(;F%10==0;F/=10,z--);for(F=x[0];10<=F;F/=10,z++);}return A&&this.e+1>z&&(z=this.e+1),z},w.shiftedBy=function(A){return I(A,-m,m),this.times("1e"+A)},w.squareRoot=w.sqrt=function(){var A,O,x,z,F,X=this,B=X.c,V=X.s,K=X.e,j=b+4,Z=new Q("0.5");if(V!==1||!B||!B[0])return new Q(!V||V<0&&(!B||B[0])?NaN:B?X:1/0);if((x=(V=Math.sqrt(+ke(X)))==0||V==1/0?(((O=R(B)).length+K)%2==0&&(O+="0"),V=Math.sqrt(+O),K=S((K+1)/2)-(K<0||K%2),new Q(O=V==1/0?"1e"+K:(O=V.toExponential()).slice(0,O.indexOf("e")+1)+K)):new Q(V+"")).c[0]){for((V=(K=x.e)+j)<3&&(V=0);;)if(F=x,x=Z.times(F.plus(q(X,F,j,1))),R(F.c).slice(0,V)===(O=R(x.c)).slice(0,V)){if(x.e<K&&--V,(O=O.slice(V-3,V+1))!="9999"&&(z||O!="4999")){+O&&(+O.slice(1)||O.charAt(0)!="5")||(Ze(x,x.e+b+2,1),A=!x.times(x).eq(X));break}if(!z&&(Ze(F,F.e+b+2,0),F.times(F).eq(X))){x=F;break}j+=4,V+=4,z=1}}return Ze(x,x.e+b+1,P,A)},w.toExponential=function(A,O){return A!=null&&(I(A,0,y),A++),Qe(this,A,O,1)},w.toFixed=function(A,O){return A!=null&&(I(A,0,y),A=A+this.e+1),Qe(this,A,O)},w.toFormat=function(A,O,x){var z;if(x==null)A!=null&&O&&typeof O=="object"?(x=O,O=null):A&&typeof A=="object"?(x=A,A=O=null):x=We;else if(typeof x!="object")throw Error(h+"Argument not an object: "+x);if(z=this.toFixed(A,O),this.c){var F,X=z.split("."),B=+x.groupSize,V=+x.secondaryGroupSize,K=x.groupSeparator||"",j=X[0],Z=X[1],me=this.s<0,be=me?j.slice(1):j,Ue=be.length;if(V&&(F=B,B=V,Ue-=V=F),0<B&&0<Ue){for(F=Ue%B||B,j=be.substr(0,F);F<Ue;F+=B)j+=K+be.substr(F,B);0<V&&(j+=K+be.slice(F)),me&&(j="-"+j)}z=Z?j+(x.decimalSeparator||"")+((V=+x.fractionGroupSize)?Z.replace(new RegExp("\\d{"+V+"}\\B","g"),"$&"+(x.fractionGroupSeparator||"")):Z):j}return(x.prefix||"")+z+(x.suffix||"")},w.toFraction=function(A){var O,x,z,F,X,B,V,K,j,Z,me,be,Ue=this,nt=Ue.c;if(A!=null&&(!(V=new Q(A)).isInteger()&&(V.c||V.s!==1)||V.lt(C)))throw Error(h+"Argument "+(V.isInteger()?"out of range: ":"not an integer: ")+ke(V));if(!nt)return new Q(Ue);for(O=new Q(C),j=x=new Q(C),z=K=new Q(C),be=R(nt),X=O.e=be.length-Ue.e-1,O.c[0]=p[(B=X%f)<0?f+B:B],A=!A||0<V.comparedTo(O)?0<X?O:j:V,B=ne,ne=1/0,V=new Q(be),K.c[0]=0;Z=q(V,O,0,1),(F=x.plus(Z.times(z))).comparedTo(A)!=1;)x=z,z=F,j=K.plus(Z.times(F=j)),K=F,O=V.minus(Z.times(F=O)),V=F;return F=q(A.minus(x),z,0,1),K=K.plus(F.times(j)),x=x.plus(F.times(z)),K.s=j.s=Ue.s,me=q(j,z,X*=2,P).minus(Ue).abs().comparedTo(q(K,x,X,P).minus(Ue).abs())<1?[j,z]:[K,x],ne=B,me},w.toNumber=function(){return+ke(this)},w.toPrecision=function(A,O){return A!=null&&I(A,1,y),Qe(this,A,O,2)},w.toString=function(A){var O,x=this,z=x.s,F=x.e;return F===null?z?(O="Infinity",z<0&&(O="-"+O)):O="NaN":(O=A==null?F<=L||G<=F?k(R(x.c),F):W(R(x.c),F,"0"):A===10?W(R((x=Ze(new Q(x),b+F+1,P)).c),x.e,"0"):(I(A,2,Ke.length,"Base"),J(W(R(x.c),F,"0"),10,A,z,!0)),z<0&&x.c[0]&&(O="-"+O)),O},w.valueOf=w.toJSON=function(){return ke(this)},w._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(w[Symbol.toStringTag]="BigNumber",w[Symbol.for("nodejs.util.inspect.custom")]=w.valueOf),$!=null&&Q.set($),Q})()).default=o.BigNumber=o,r!==void 0&&r.exports?r.exports=o:(s||(s=typeof self<"u"&&self?self:window),s.BigNumber=o)})(this)},{}],2:[function(t,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(s){var o=s%10;return~~(s%100/10)==1?"th":o===1?"st":o===2?"nd":o===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,r,i){function s(S,R){return(function(T){if(Array.isArray(T))return T})(S)||(function(T,I){var H=[],k=!0,W=!1,Y=void 0;try{for(var $,q=T[Symbol.iterator]();!(k=($=q.next()).done)&&(H.push($.value),!I||H.length!==I);k=!0);}catch(J){W=!0,Y=J}finally{try{k||q.return==null||q.return()}finally{if(W)throw Y}}return H})(S,R)||(function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")})()}var o=t("./globalState"),a=t("./validating"),l=t("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],h={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(S){var R=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},T=2<arguments.length?arguments[2]:void 0;if(typeof R=="string"&&(R=l.parseFormat(R)),!a.validateFormat(R))return"ERROR: invalid format";var I=R.prefix||"",H=R.postfix||"",k=(function(W,Y,$){switch(Y.output){case"currency":return Y=y(Y,o.currentCurrencyDefaultFormat()),(function(Ke,Q,Qe){var et=Qe.currentCurrency(),ht=Object.assign({},c,Q),Ze=void 0,ke="",A=!!ht.totalLength||!!ht.forceAverage||ht.average,O=Q.currencyPosition||et.position,x=Q.currencySymbol||et.symbol;ht.spaceSeparated&&(ke=" "),O==="infix"&&(Ze=ke+x+ke);var z=v({instance:Ke,providedFormat:Q,state:Qe,decimalSeparator:Ze});return O==="prefix"&&(z=Ke._value<0&&ht.negative==="sign"?"-".concat(ke).concat(x).concat(z.slice(1)):x+ke+z),O&&O!=="postfix"||(z=z+(ke=A?"":ke)+x),z})(W,Y,o);case"percent":return Y=y(Y,o.currentPercentageDefaultFormat()),(function(Ke,Q,Qe,et){var ht=Q.prefixSymbol,Ze=v({instance:et(100*Ke._value),providedFormat:Q,state:Qe}),ke=Object.assign({},c,Q);return ht?"%".concat(ke.spaceSeparated?" ":"").concat(Ze):"".concat(Ze).concat(ke.spaceSeparated?" ":"","%")})(W,Y,o,$);case"byte":return Y=y(Y,o.currentByteDefaultFormat()),C=W,P=o,L=$,G=(b=Y).base||"binary",ee=h[G],ne=f(C._value,ee.suffixes,ee.scale),he=ne.value,we=ne.suffix,oe=v({instance:L(he),providedFormat:b,state:P,defaults:P.currentByteDefaultFormat()}),We=P.currentAbbreviations(),"".concat(oe).concat(We.spaced?" ":"").concat(we);case"time":return Y=y(Y,o.currentTimeDefaultFormat()),Se=W,pe=Math.floor(Se._value/60/60),ze=Math.floor((Se._value-60*pe*60)/60),w=Math.round(Se._value-60*pe*60-60*ze),"".concat(pe,":").concat(ze<10?"0":"").concat(ze,":").concat(w<10?"0":"").concat(w);case"ordinal":return Y=y(Y,o.currentOrdinalDefaultFormat()),q=W,J=Y,ie=(re=o).currentOrdinal(),ae=Object.assign({},c,J),Ve=v({instance:q,providedFormat:J,state:re}),De=ie(q._value),"".concat(Ve).concat(ae.spaceSeparated?" ":"").concat(De);default:return v({instance:W,providedFormat:Y})}var q,J,re,ie,ae,Ve,De,Se,pe,ze,w,C,b,P,L,G,ee,ne,he,we,oe,We})(S,R,T);return k=(k=I+k)+H}function f(S,R,T){var I=R[0],H=Math.abs(S);if(T<=H){for(var k=1;k<R.length;++k){var W=Math.pow(T,k),Y=Math.pow(T,k+1);if(W<=H&&H<Y){I=R[k],S/=W;break}}I===R[0]&&(S/=Math.pow(T,R.length-1),I=R[R.length-1])}return{value:S,suffix:I}}function m(S){for(var R="",T=0;T<S;T++)R+="0";return R}function p(S,R){return S.toString().indexOf("e")!==-1?(function(T,I){var H=T.toString(),k=s(H.split("e"),2),W=k[0],Y=k[1],$=s(W.split("."),2),q=$[0],J=$[1],re=J===void 0?"":J;if(0<+Y)H=q+re+m(Y-re.length);else{var ie=".";ie=+q<0?"-0".concat(ie):"0".concat(ie);var ae=(m(-Y-1)+Math.abs(q)+re).substr(0,I);ae.length<I&&(ae+=m(I-ae.length)),H=ie+ae}return 0<+Y&&0<I&&(H+=".".concat(m(I))),H})(S,R):(Math.round(+"".concat(S,"e+").concat(R))/Math.pow(10,R)).toFixed(R)}function v(S){var R=S.instance,T=S.providedFormat,I=S.state,H=I===void 0?o:I,k=S.decimalSeparator,W=S.defaults,Y=W===void 0?H.currentDefaults():W,$=R._value;if($===0&&H.hasZeroFormat())return H.getZeroFormat();if(!isFinite($))return $.toString();var q,J,re,ie,ae,Ve,De,Se,pe=Object.assign({},c,Y,T),ze=pe.totalLength,w=ze?0:pe.characteristic,C=pe.optionalCharacteristic,b=pe.forceAverage,P=!!ze||!!b||pe.average,L=ze?-1:P&&T.mantissa===void 0?0:pe.mantissa,G=!ze&&(T.optionalMantissa===void 0?L===-1:pe.optionalMantissa),ee=pe.trimMantissa,ne=pe.thousandSeparated,he=pe.spaceSeparated,we=pe.negative,oe=pe.forceSign,We=pe.exponential,Ke="";if(P){var Q=(function(A){var O=A.value,x=A.forceAverage,z=A.abbreviations,F=A.spaceSeparated,X=F!==void 0&&F,B=A.totalLength,V=B===void 0?0:B,K="",j=Math.abs(O),Z=-1;if(j>=Math.pow(10,12)&&!x||x==="trillion"?(K=z.trillion,O/=Math.pow(10,12)):j<Math.pow(10,12)&&j>=Math.pow(10,9)&&!x||x==="billion"?(K=z.billion,O/=Math.pow(10,9)):j<Math.pow(10,9)&&j>=Math.pow(10,6)&&!x||x==="million"?(K=z.million,O/=Math.pow(10,6)):(j<Math.pow(10,6)&&j>=Math.pow(10,3)&&!x||x==="thousand")&&(K=z.thousand,O/=Math.pow(10,3)),K&&(K=(X?" ":"")+K),V){var me=O.toString().split(".")[0];Z=Math.max(V-me.length,0)}return{value:O,abbreviation:K,mantissaPrecision:Z}})({value:$,forceAverage:b,abbreviations:H.currentAbbreviations(),spaceSeparated:he,totalLength:ze});$=Q.value,Ke+=Q.abbreviation,ze&&(L=Q.mantissaPrecision)}if(We){var Qe=(J=(q={value:$,characteristicPrecision:w}).value,re=q.characteristicPrecision,ie=re===void 0?0:re,ae=s(J.toExponential().split("e"),2),Ve=ae[0],De=ae[1],Se=+Ve,ie&&1<ie&&(Se*=Math.pow(10,ie-1),De=0<=(De=+De-(ie-1))?"+".concat(De):De),{value:Se,abbreviation:"e".concat(De)});$=Qe.value,Ke=Qe.abbreviation+Ke}var et,ht,Ze,ke=(function(A,O,x,z,F){if(z===-1)return A;var X=p(O,z),B=s(X.toString().split("."),2),V=B[0],K=B[1],j=K===void 0?"":K;if(j.match(/^0+$/)&&(x||F))return V;var Z=j.match(/0+$/);return F&&Z?"".concat(V,".").concat(j.toString().slice(0,Z.index)):X.toString()})($.toString(),$,G,L,ee);return ke=(function(A,O,x,z,F){var X=z.currentDelimiters(),B=X.thousands;F=F||X.decimal;var V=X.thousandsSize||3,K=A.toString(),j=K.split(".")[0],Z=K.split(".")[1];return x&&(O<0&&(j=j.slice(1)),(function(me,be){for(var Ue=[],nt=0,Rt=me;0<Rt;Rt--)nt===be&&(Ue.unshift(Rt),nt=0),nt++;return Ue})(j.length,V).forEach(function(me,be){j=j.slice(0,me+be)+B+j.slice(me+be)}),O<0&&(j="-".concat(j))),K=Z?j+F+Z:j})(ke=(function(A,O,x,z){var F=A,X=s(F.toString().split("."),2),B=X[0],V=X[1];if(B.match(/^-?0$/)&&x)return V?"".concat(B.replace("0",""),".").concat(V):B.replace("0","");if(B.length<z)for(var K=z-B.length,j=0;j<K;j++)F="0".concat(F);return F.toString()})(ke,0,C,w),$,ne,H,k),(P||We)&&(ke=ke+Ke),(oe||$<0)&&(et=ke,Ze=we,ke=(ht=$)===0?et:+et==0?et.replace("-",""):0<ht?"+".concat(et):Ze==="sign"?et:"(".concat(et.replace("-",""),")")),ke}function y(S,R){if(!S)return R;var T=Object.keys(S);return T.length===1&&T[0]==="output"?R:S}r.exports=function(S){return{format:function(){for(var R=arguments.length,T=new Array(R),I=0;I<R;I++)T[I]=arguments[I];return d.apply(void 0,T.concat([S]))},getByteUnit:function(){for(var R=arguments.length,T=new Array(R),I=0;I<R;I++)T[I]=arguments[I];return(function(H){var k=h.general;return f(H._value,k.suffixes,k.scale).suffix}).apply(void 0,T.concat([S]))},getBinaryByteUnit:function(){for(var R=arguments.length,T=new Array(R),I=0;I<R;I++)T[I]=arguments[I];return(function(H){var k=h.binary;return f(H._value,k.suffixes,k.scale).suffix}).apply(void 0,T.concat([S]))},getDecimalByteUnit:function(){for(var R=arguments.length,T=new Array(R),I=0;I<R;I++)T[I]=arguments[I];return(function(H){var k=h.decimal;return f(H._value,k.suffixes,k.scale).suffix}).apply(void 0,T.concat([S]))},formatOrDefault:y}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,r,i){var s=t("./en-US"),o=t("./validating"),a=t("./parsing"),l={},u=void 0,h={},c=null,d={};function f(p){u=p}function m(){return h[u]}l.languages=function(){return Object.assign({},h)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return m().currency},l.currentAbbreviations=function(){return m().abbreviations},l.currentDelimiters=function(){return m().delimiters},l.currentOrdinal=function(){return m().ordinal},l.currentDefaults=function(){return Object.assign({},m().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().timeFormat)},l.setDefaults=function(p){p=a.parseFormat(p),o.validateFormat(p)&&(d=p)},l.getZeroFormat=function(){return c},l.setZeroFormat=function(p){return c=typeof p=="string"?p:null},l.hasZeroFormat=function(){return c!==null},l.languageData=function(p){if(p){if(h[p])return h[p];throw new Error('Unknown tag "'.concat(p,'"'))}return m()},l.registerLanguage=function(p){var v=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!o.validateLanguage(p))throw new Error("Invalid language data");h[p.languageTag]=p,v&&f(p.languageTag)},l.setLanguage=function(p){var v=1<arguments.length&&arguments[1]!==void 0?arguments[1]:s.languageTag;if(!h[p]){var y=p.split("-")[0],S=Object.keys(h).find(function(R){return R.split("-")[0]===y});return h[S]?void f(S):void f(v)}f(p)},l.registerLanguage(s),u=s.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,r,i){r.exports=function(s){return{loadLanguagesInNode:function(o){return a=s,void o.forEach(function(l){var u=void 0;try{u=t("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(t,r,i){var s=t("bignumber.js");function o(a,l,u){var h=new s(a._value),c=l;return u.isNumbro(l)&&(c=l._value),c=new s(c),a._value=h.minus(c).toNumber(),a}r.exports=function(a){return{add:function(l,u){return c=u,d=a,f=new s((h=l)._value),m=c,d.isNumbro(c)&&(m=c._value),m=new s(m),h._value=f.plus(m).toNumber(),h;var h,c,d,f,m},subtract:function(l,u){return o(l,u,a)},multiply:function(l,u){return c=u,d=a,f=new s((h=l)._value),m=c,d.isNumbro(c)&&(m=c._value),m=new s(m),h._value=f.times(m).toNumber(),h;var h,c,d,f,m},divide:function(l,u){return c=u,d=a,f=new s((h=l)._value),m=c,d.isNumbro(c)&&(m=c._value),m=new s(m),h._value=f.dividedBy(m).toNumber(),h;var h,c,d,f,m},set:function(l,u){return h=l,d=c=u,a.isNumbro(c)&&(d=c._value),h._value=d,h;var h,c,d},difference:function(l,u){return h=u,o(d=(c=a)(l._value),h,c),Math.abs(d._value);var h,c,d}}}},{"bignumber.js":1}],7:[function(t,r,i){function s(v,y){for(var S=0;S<y.length;S++){var R=y[S];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(v,R.key,R)}}var o=t("./globalState"),a=t("./validating"),l=t("./loading")(p),u=t("./unformatting"),h=t("./formatting")(p),c=t("./manipulating")(p),d=t("./parsing"),f=(function(){function v(R){(function(T,I){if(!(T instanceof I))throw new TypeError("Cannot call a class as a function")})(this,v),this._value=R}var y,S;return y=v,(S=[{key:"clone",value:function(){return p(this._value)}},{key:"format",value:function(){var R=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return h.format(this,R)}},{key:"formatCurrency",value:function(R){return typeof R=="string"&&(R=d.parseFormat(R)),(R=h.formatOrDefault(R,o.currentCurrencyDefaultFormat())).output="currency",h.format(this,R)}},{key:"formatTime",value:function(){var R=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return R.output="time",h.format(this,R)}},{key:"binaryByteUnits",value:function(){return h.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return h.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return h.getByteUnit(this)}},{key:"difference",value:function(R){return c.difference(this,R)}},{key:"add",value:function(R){return c.add(this,R)}},{key:"subtract",value:function(R){return c.subtract(this,R)}},{key:"multiply",value:function(R){return c.multiply(this,R)}},{key:"divide",value:function(R){return c.divide(this,R)}},{key:"set",value:function(R){return c.set(this,m(R))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&s(y.prototype,S),v})();function m(v){var y=v;return p.isNumbro(v)?y=v._value:typeof v=="string"?y=p.unformat(v):isNaN(v)&&(y=NaN),y}function p(v){return new f(m(v))}p.version="2.1.2",p.isNumbro=function(v){return v instanceof f},p.language=o.currentLanguage,p.registerLanguage=o.registerLanguage,p.setLanguage=o.setLanguage,p.languages=o.languages,p.languageData=o.languageData,p.zeroFormat=o.setZeroFormat,p.defaultFormat=o.currentDefaults,p.setDefaults=o.setDefaults,p.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,p.validate=a.validate,p.loadLanguagesInNode=l.loadLanguagesInNode,p.unformat=u.unformat,r.exports=p},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,r,i){r.exports={parseFormat:function(s){var o,a,l,u,h,c,d,f,m,p,v,y,S,R,T,I,H,k,W,Y,$=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof s!="string"?s:(a=$,s=(l=(o=s).match(/^{([^}]*)}/))?(a.prefix=l[1],o.slice(l[0].length)):o,h=$,(function(q,J){if(q.indexOf("$")===-1){if(q.indexOf("%")===-1)return q.indexOf("bd")!==-1?(J.output="byte",J.base="general"):q.indexOf("b")!==-1?(J.output="byte",J.base="binary"):q.indexOf("d")!==-1?(J.output="byte",J.base="decimal"):q.indexOf(":")===-1?q.indexOf("o")!==-1&&(J.output="ordinal"):J.output="time";J.output="percent"}else J.output="currency"})(s=(c=(u=s).match(/{([^}]*)}$/))?(h.postfix=c[1],u.slice(0,-c[0].length)):u,$),d=$,(f=s.match(/[1-9]+[0-9]*/))&&(d.totalLength=+f[0]),m=$,(p=s.split(".")[0].match(/0+/))&&(m.characteristic=p[0].length),(function(q,J){if(q.indexOf(".")!==-1){var re=q.split(".")[0];J.optionalCharacteristic=re.indexOf("0")===-1}})(s,$),v=$,s.indexOf("a")!==-1&&(v.average=!0),S=$,(y=s).indexOf("K")!==-1?S.forceAverage="thousand":y.indexOf("M")!==-1?S.forceAverage="million":y.indexOf("B")!==-1?S.forceAverage="billion":y.indexOf("T")!==-1&&(S.forceAverage="trillion"),(function(q,J){var re=q.split(".")[1];if(re){var ie=re.match(/0+/);ie&&(J.mantissa=ie[0].length)}})(s,$),T=$,(R=s).match(/\[\.]/)?T.optionalMantissa=!0:R.match(/\./)&&(T.optionalMantissa=!1),I=$,s.indexOf(",")!==-1&&(I.thousandSeparated=!0),H=$,s.indexOf(" ")!==-1&&(H.spaceSeparated=!0),W=$,(k=s).match(/^\+?\([^)]*\)$/)&&(W.negative="parenthesis"),k.match(/^\+?-/)&&(W.negative="sign"),Y=$,s.match(/^\+/)&&(Y.forceSign=!0),$)}}},{}],9:[function(t,r,i){var s=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,f=5<arguments.length?arguments[5]:void 0,m=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:(function p(v,y){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",R=3<arguments.length?arguments[3]:void 0,T=4<arguments.length?arguments[4]:void 0,I=5<arguments.length?arguments[5]:void 0,H=6<arguments.length?arguments[6]:void 0;if(!isNaN(+v))return+v;var k="",W=v.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(W!==v)return-1*p(W,y,S,R,T,I,H);for(var Y=0;Y<s.length;Y++){var $=s[Y];if((k=v.replace($.key,""))!==v)return p(k,y,S,R,T,I,H)*$.factor}if((k=v.replace("%",""))!==v)return p(k,y,S,R,T,I,H)/100;var q=parseFloat(v);if(!isNaN(q)){var J=R(q);if(J&&J!=="."&&(k=v.replace(new RegExp("".concat(o(J),"$")),""))!==v)return p(k,y,S,R,T,I,H);var re={};Object.keys(I).forEach(function(ze){re[I[ze]]=ze});for(var ie=Object.keys(re).sort().reverse(),ae=ie.length,Ve=0;Ve<ae;Ve++){var De=ie[Ve],Se=re[De];if((k=v.replace(De,""))!==v){var pe=void 0;switch(Se){case"thousand":pe=Math.pow(10,3);break;case"million":pe=Math.pow(10,6);break;case"billion":pe=Math.pow(10,9);break;case"trillion":pe=Math.pow(10,12)}return p(k,y,S,R,T,I,H)*pe}}}})((function(p,v){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=p.replace(y,"");return S=(S=S.replace(new RegExp("([0-9])".concat(o(v.thousands),"([0-9])"),"g"),"$1$2")).replace(v.decimal,".")})(l,u,h),u,h,c,d,f,m)}r.exports={unformat:function(l,u){var h,c,d,f=t("./globalState"),m=f.currentDelimiters(),p=f.currentCurrency().symbol,v=f.currentOrdinal(),y=f.getZeroFormat(),S=f.currentAbbreviations(),R=void 0;if(typeof l=="string")R=(function(T,I){if(!T.indexOf(":")||I.thousands===":")return!1;var H=T.split(":");if(H.length!==3)return!1;var k=+H[0],W=+H[1],Y=+H[2];return!isNaN(k)&&!isNaN(W)&&!isNaN(Y)})(l,m)?(h=l.split(":"),c=+h[0],d=+h[1],+h[2]+60*d+3600*c):a(l,m,p,v,y,S,u);else{if(typeof l!="number")return;R=l}if(R!==void 0)return R}}},{"./globalState":4}],10:[function(t,r,i){function s(m){return(function(p){if(Array.isArray(p)){for(var v=0,y=new Array(p.length);v<p.length;v++)y[v]=p[v];return y}})(m)||(function(p){if(Symbol.iterator in Object(p)||Object.prototype.toString.call(p)==="[object Arguments]")return Array.from(p)})(m)||(function(){throw new TypeError("Invalid attempt to spread non-iterable instance")})()}function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(m)}var a=t("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(m,p){return p.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(m){return m.output==="byte"}},characteristic:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(m){return 0<=m},message:"value must be positive"},{restriction:function(m,p){return!p.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(m,p){return p.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},h={languageTag:{type:"string",mandatory:!0,restriction:function(m){return m.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(m){return!!a.unformat(m)}function d(m,p,v){var y=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(m).map(function(R){if(!p[R])return console.error("".concat(v," Invalid key: ").concat(R)),!1;var T=m[R],I=p[R];if(typeof I=="string"&&(I={type:I}),I.type==="format"){if(!d(T,u,"[Validate ".concat(R,"]"),!0))return!1}else if(o(T)!==I.type)return console.error("".concat(v," ").concat(R,' type mismatched: "').concat(I.type,'" expected, "').concat(o(T),'" provided')),!1;if(I.restrictions&&I.restrictions.length)for(var H=I.restrictions.length,k=0;k<H;k++){var W=I.restrictions[k],Y=W.restriction,$=W.message;if(!Y(T,m))return console.error("".concat(v," ").concat(R," invalid value: ").concat($)),!1}return I.restriction&&!I.restriction(T,m)?(console.error("".concat(v," ").concat(R," invalid value: ").concat(I.message)),!1):I.validValues&&I.validValues.indexOf(T)===-1?(console.error("".concat(v," ").concat(R," invalid value: must be among ").concat(JSON.stringify(I.validValues),', "').concat(T,'" provided')),!1):!(I.children&&!d(T,I.children,"[Validate ".concat(R,"]")))});return y||S.push.apply(S,s(Object.keys(p).map(function(R){var T=p[R];if(typeof T=="string"&&(T={type:T}),T.mandatory){var I=T.mandatory;if(typeof I=="function"&&(I=I(m)),I&&m[R]===void 0)return console.error("".concat(v,' Missing mandatory key "').concat(R,'"')),!1}return!0}))),S.reduce(function(R,T){return R&&T},!0)}function f(m){return d(m,u,"[Validate format]")}r.exports={validate:function(m,p){var v=c(m),y=f(p);return v&&y},validateFormat:f,validateInput:c,validateLanguage:function(m){return d(m,h,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(Yb)),Yb.exports}var see=iee();const Gu=W2(see),oee="numeric";function GB(n,e){if(ci(n)){const t=e.numericFormat,r=t&&t.culture||"-",i=t&&t.pattern;if(typeof r<"u"&&!Gu.languages()[r]){const s=r.replace("-",""),o=Gu.allLanguages?Gu.allLanguages[r]:Gu[s];o&&Gu.registerLanguage(o)}Gu.setLanguage(r),n=Gu(n).format(i||"0")}return n}function rO(n,e,t,r,i,s,o){let a=s;if(ci(a)){const l=o.className||"",u=l.length?l.split(" "):[];a=GB(a,o),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),o.className=u.join(" "),e.dir="ltr"}Rl(n,e,t,r,i,a,o)}rO.RENDERER_TYPE=oee;const aee="password";function iO(n,e,t,r,i,s,o){Rl.apply(this,[n,e,t,r,i,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let u="";He(a-1,()=>{u+=l}),ef(e,u)}iO.RENDERER_TYPE=aee;const lee="select";function sO(n,e,t,r,i,s,o){Rl.apply(this,[n,e,t,r,i,s,o])}sO.RENDERER_TYPE=lee;const uee="time";function oO(n,e,t,r,i,s,o){Rl.apply(this,[n,e,t,r,i,s,o]),e.dir="ltr"}oO.RENDERER_TYPE=uee;function hee(){fs(rf),fs(Qg),fs(eO),fs(JM),fs(nO),fs(ZM),fs(rO),fs(iO),fs(sO),fs(Rl),fs(oO)}const cee="autocomplete";function QC(n,e){let t=n;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,cD(t,e)):cD(t,e)(this.source):e(!0)}QC.VALIDATOR_TYPE=cee;function cD(n,e){const t=n;return function(r){let i=!1;for(let s=0,o=r.length;s<o;s++)if(t===r[s]){i=!0;break}e(i)}}function dee(n){const e=new Date(n);return isNaN(new Date(`${n}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const fee="date";function aO(n,e){const t=RU(FB,this.instance);let r=n,i=!0;r==null&&(r="");let s=le(r,this.dateFormat||t.defaultDateFormat,!0).isValid(),o=le(new Date(r)).isValid()||s;if(this.allowEmpty&&r===""&&(o=!0,s=!0),o||(i=!1),!o&&s&&(i=!0),o&&!s)if(this.correctFormat===!0){const a=mee(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}aO.VALIDATOR_TYPE=fee;function mee(n,e){const t=le(dee(n)),r=le(n,e),i=n.search(/[A-z]/g)>-1;let s;return t.isValid()&&t.format("x")===r.format("x")||!r.isValid()||i?s=t:s=r,s.format(e)}const gee="dropdown";function lO(n,e){QC.apply(this,[n,e])}lO.VALIDATOR_TYPE=gee;const pee="numeric";function uO(n,e){let t=n;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:ci(n))}uO.VALIDATOR_TYPE=pee;const wee=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],vee="time";function hO(n,e){const t=this.timeFormat||"h:mm:ss a";let r=!0,i=n;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const o=le(i,wee,!0).isValid()?le(i):le(i,t);let a=o.isValid(),l=le(i,t,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=o.format(t);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}hO.VALIDATOR_TYPE=vee;function yee(){td(QC),td(lO),td(aO),td(uO),td(hO)}const Cee="autocomplete",See={CELL_TYPE:Cee,editor:qM,renderer:rf,validator:QC},Ree="checkbox",Eee={CELL_TYPE:Ree,editor:HB,renderer:eO},bee="date";function jB(n,e,t,r,i,s,o){rf.apply(this,[n,e,t,r,i,s,o])}jB.RENDERER_TYPE=bee;const Tee="date",Aee={CELL_TYPE:Tee,editor:kB,renderer:jB,validator:aO},Nee="dropdown",Iee={CELL_TYPE:Nee,editor:QM,renderer:JM,validator:lO},Mee="handsontable",Oee={CELL_TYPE:Mee,editor:KM,renderer:nO},_ee="numeric",xee={CELL_TYPE:_ee,editor:VB,renderer:rO,validator:uO,dataType:"number"},Pee="password",Lee={CELL_TYPE:Pee,editor:UB,renderer:iO,copyable:!1},Dee="select",Hee={CELL_TYPE:Dee,editor:BB,renderer:sO},Fee="time",kee={CELL_TYPE:Fee,editor:WB,renderer:oO,validator:hO};function Vee(){Zs(See),Zs(Eee),Zs(Aee),Zs(Iee),Zs(Oee),Zs(xee),Zs(Lee),Zs(Hee),Zs(AB),Zs(kee)}function Uee(n,e){zB(n,e),e.add(n)}function Bee(n,e,t){zB(n,e),e.set(n,t)}function zB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bc(n,e,t){return(e=Wee(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Wee(n){var e=$ee(n,"string");return typeof e=="symbol"?e:e+""}function $ee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Tc(n,e){return n.get(YB(n,e))}function YB(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const dD=new Map([["plugin",LX],["cell-type",wB],["editor",SU],["renderer",MU],["validator",OU]]),Gee="base",Kb=[];let Do=null;var ju=new WeakMap,fD=new WeakSet;class Wt{static get PLUGIN_KEY(){return Gee}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){Uee(this,fD),bc(this,"eventManager",new Co(this)),bc(this,"pluginName",null),bc(this,"pluginsInitializedCallbacks",[]),bc(this,"isPluginsReady",!1),bc(this,"enabled",!1),bc(this,"initialized",!1),Bee(this,ju,{}),Cl(this,"hot",e,{writable:!1}),Do=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const i=[];if(t.forEach(s=>{const[o,a]=s.split(":");if(!dD.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);dD.get(o)(a)||i.push(` - ${a} (${o})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Kb.push(s)}}if(Do||(Do=IU()),Do.indexOf("UndoRedo")>=0&&Do.splice(Do.indexOf("UndoRedo"),1),Do.indexOf(this.pluginName)>=0&&Do.splice(Do.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Do.length===0){if(Kb.length>0){const i=[`${Kb.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t,r){Tc(ju,this)[e]=Tc(ju,this)[e]||[];const i=Tc(ju,this)[e];this.hot.addHook(e,t,r),i.push(t),Tc(ju,this)[e]=i}removeHooks(e){D(Tc(ju,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=Tc(ju,this);gt(e,(t,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){D(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=YB(fD,this,jee).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),gt(this,(t,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function jee(n){if(!n)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(n[e[t]]!==void 0)return!0;return!1}function zu(n,e,t){return(e=zee(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zee(n){var e=Yee(n,"string");return typeof e=="symbol"?e:e+""}function Yee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let KB=class{constructor(e){zu(this,"hot",null),zu(this,"container",null),zu(this,"injected",!1),zu(this,"rows",[]),zu(this,"columns",[]),zu(this,"samples",null),zu(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),D(this.rows,t=>{const{height:r}=t.table.getBoundingClientRect();e(t.row,Math.ceil(r)-1)})}getWidths(e){this.injected||this.injectTable(),D(this.columns,t=>{const{width:r}=t.table.getBoundingClientRect();e(t.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{D(r.strings,i=>{t.appendChild(this.createColElement(i.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(s=>{D(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),h=t.createElement("td");h.setAttribute("ghost-table",1),u(this.hot,h,e,a,this.hot.colToProp(a),o.value,l),r.appendChild(h)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),t.appendChild(i)}this.samples.forEach(i=>{D(i.strings,s=>{const o=s.col,a=e.createElement("th");r.push([o,a]),t.appendChild(a)})}),this.table.tHead.appendChild(t),D(r,i=>{const[s,o]=i;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment();return this.samples.forEach(i=>{D(i.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),u=t.createElement("td"),h=t.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,o,e,this.hot.colToProp(e),s.value,a),h.appendChild(u),r.appendChild(h)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const r=this.hot.rootDocument.createElement("col");let i=0;t>=0&&e>=0&&(i=this.hot.getCellMeta(t,e).colspan);let s=this.hot.getColWidth(e);if(i>1)for(let o=e+1;o<e+i;o++)s+=this.hot.getColWidth(o);return r.style.width=`${s}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("table"),s=t.createElement("thead"),o=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),u=t.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),s.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&o.appendChild(l),i.appendChild(o),ue(i,e),r.appendChild(i),{fragment:r,table:i,tHead:s,tBody:o,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return ue(i,s),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function tw(n,e,t){return(e=Kee(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Kee(n){var e=qee(n,"string");return typeof e=="symbol"?e:e+""}function qee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ZC{static get SAMPLE_COUNT(){return 3}constructor(e){tw(this,"samples",null),tw(this,"dataFactory",null),tw(this,"customSampleCount",null),tw(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:ZC.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,r){const i=new Map,{from:s,to:o}=typeof r=="number"?{from:r,to:r}:r;return He(s,o,a=>{const l=this.generateSample(e,t,a);i.set(a,l)}),i}generateSample(e,t,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",o=[];return He(t.from,t.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:h}=l,c=typeof h=="string"&&h.length>0;let d;c?d=h:mt(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Zn(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(o.indexOf(u)>-1)||this.allowDuplicates||c)&&(f.strings.push({value:u,[s]:a}),o.push(u),f.needed-=1)}),i}}function Xee(n,e){qB(n,e),e.add(n)}function mD(n,e,t){qB(n,e),e.set(n,t)}function qB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Df(n,e,t){return(e=Qee(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Qee(n){var e=Zee(n,"string");return typeof e=="symbol"?e:e+""}function Zee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Mh(n,e){return n.get(ea(n,e))}function cO(n,e,t){return n.set(ea(n,e),t),t}function ea(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ie.getSingleton().register("modifyAutoColumnSizeSeed");const Hf="autoColumnSize",Jee=10,ete="autoColumnSize";var nd=new WeakMap,Gd=new WeakMap,Ga=new WeakSet;class Im extends Wt{static get PLUGIN_KEY(){return Hf}static get PLUGIN_PRIORITY(){return Jee}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Xee(this,Ga),Df(this,"ghostTable",new KB(this.hot)),Df(this,"samplesGenerator",new ZC((t,r)=>{const i=this.hot.toPhysicalRow(t),s=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(t,r);let a="";o.spanned||(a=this.hot.getDataAtCell(t,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),Df(this,"inProgress",!1),Df(this,"measuredColumns",0),Df(this,"columnWidthsMap",new bu),mD(this,nd,[]),mD(this,Gd,[]),this.hot.columnIndexMapper.registerMap(ete,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,r,i)=>ea(Ga,this,gD).call(this,t,r,i))}isEnabled(){return this.hot.getSettings()[Hf]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Hf];t&&t.useHeaders!==null&&t.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ea(Ga,e,rte).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ea(Ga,e,ite).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ea(Ga,e,ote).call(e,...i)}),this.addHook("beforeRender",()=>ea(Ga,this,nte).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>ea(Ga,this,ste).call(this)),super.enablePlugin()}updatePlugin(){cO(Gd,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,r)=>ea(Ga,this,gD).call(this,e,t,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(e===-1||t===-1)return;const r=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:t},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof t=="number"?{from:t,to:t}:t;He(i.from,i.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&this.samplesGenerator.generateColumnSamples(o,s).forEach((u,h)=>this.ghostTable.addColumn(h,u))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((o,a)=>{const l=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){ny(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Im.CALCULATION_STEP,i)},e,t),r=r+Im.CALCULATION_STEP+1,r<i?s=tI(o):(ny(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,t),r=a+1),r<i?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Hf],t=e&&Ln(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Ln(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Hf];let t=Im.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return mt(e)&&(t=e.syncLimit,KV(t)?t=TU(r,t):t>>=0),Math.min(t,r)}getColumnWidth(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=t;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,BC))),i}getFirstVisibleColumn(){var e;return(e=this.hot.view.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.view.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,s)=>{const o=Mh(nd,this).length;return(o-1<s||Mh(nd,this)[s]!==i)&&r.push(this.hot.toVisualColumn(s)),o-1<s?Mh(nd,this).push(i):Mh(nd,this)[s]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function tte(n){const e={from:0,to:this.hot.countRows()-1};n.forEach(t=>{const r=this.hot.toPhysicalColumn(t);r!==null&&(this.hot._getColWidthFromSettings(r)||this.samplesGenerator.generateColumnSamples(t,e).forEach((s,o)=>this.ghostTable.addColumn(o,s)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,r)=>{const i=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function nte(){this.calculateVisibleColumnsWidth(),this.inProgress||(ea(Ga,this,tte).call(this,Mh(Gd,this)),cO(Gd,this,[]))}function rte(n,e){e||this.recalculateAllColumnsWidth()}function ite(n){const e=n.reduce((t,r)=>{let[,i]=r;const s=this.hot.propToCol(i);return Number.isInteger(s)&&t.indexOf(s)===-1&&t.push(s),t},[]);Mh(Gd,this).push(...e)}function gD(n,e,t){let r=n;return t&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function ste(){cO(nd,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function ote(n){const e=n.reduce((t,r)=>{var i;const s=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);t.indexOf(o)===-1&&t.push(o)}return t},[]);Mh(Gd,this).push(...e)}const Oh={horizontal:"horizontal",vertical:"vertical"};function ate(n,e,t){let r,i,s;return e[0]===n[0]&&e[1]<n[1]?(s="left",r=t(e[0],e[1]),i=t(e[2],n[1]-1)):e[2]===n[2]&&e[0]===n[0]&&e[3]>n[3]?(s="right",r=t(e[0],n[3]+1),i=t(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(s="up",r=t(e[0],e[1]),i=t(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(s="down",r=t(n[2]+1,e[1]),i=t(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:r,endOfDragCoords:i}}function lte(n){const e={};return n===!0?(e.directions=Object.keys(Oh),e.autoInsertRow=!0):mt(n)?(_e(n.autoInsertRow)?n.direction===Oh.horizontal?e.autoInsertRow=!1:e.autoInsertRow=n.autoInsertRow:e.autoInsertRow=!1,_e(n.direction)?e.directions=[n.direction]:e.directions=Object.keys(Oh)):typeof n=="string"?(e.directions=[n],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function ute(n,e){hte(n,e),e.add(n)}function hte(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ac(n,e,t){return(e=cte(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cte(n){var e=dte(n,"string");return typeof e=="symbol"?e:e+""}function dte(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ff(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ie.getSingleton().register("modifyAutofillRange");Ie.getSingleton().register("beforeAutofill");Ie.getSingleton().register("afterAutofill");const pD="autofill",fte=20,mte=["fillHandle"],gte="insert_row_below",pte=200;var Nc=new WeakSet;class wte extends Wt{constructor(){super(...arguments),ute(this,Nc),Ac(this,"addingStarted",!1),Ac(this,"mouseDownOnCellCorner",!1),Ac(this,"mouseDragOutside",!1),Ac(this,"handleDraggedCells",0),Ac(this,"directions",[]),Ac(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return pD}static get PLUGIN_PRIORITY(){return fte}static get SETTING_KEYS(){return[pD,...mte]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Ff(Nc,this,yte).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Ff(Nc,this,vte).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>Ff(Nc,this,Cte).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:r}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:r,endRow:i,endCol:s}]),a=[],l=[],u=[];return D(o,h=>{for(let c=h.startRow;c<=h.endRow;c+=1)a.indexOf(c)===-1&&a.push(c);for(let c=h.startCol;c<=h.endCol;c+=1)l.indexOf(c)===-1&&l.push(c)}),D(a,h=>{const c=[];D(l,d=>{c.push(this.hot.getCopyableData(h,d))}),u.push(c)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,t),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:h,startOfDragCoords:c,endOfDragCoords:d}=ate(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(c&&c.row>-1&&c.col>-1){const f=this.getSelectionData(),m=s.clone(),p=this.hot._createCellRange(c,c,d),v=this.hot.runHooks("beforeAutofill",f,m,p,h);if(v===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let y=v;const S=v;if(["up","left"].indexOf(h)>-1&&!(S.length===1&&S[0].length===0))if(y=[],h==="up"){const R=d.row-c.row+1,T=R%S.length;for(let I=0;I<R;I++)y.push(S[(I+(S.length-T))%S.length])}else{const R=d.col-c.col+1,T=R%S[0].length;for(let I=0;I<S.length;I++){y.push([]);for(let H=0;H<R;H++)y[I].push(S[I][(H+(S[I].length-T))%S[I].length])}}this.hot.populateFromArray(c.row,c.col,y,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",y,m,p,h),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),r=t.getBottomEndCorner();let i=e;if(this.directions.includes(Oh.vertical)&&this.directions.includes(Oh.horizontal)){const s=t.getTopStartCorner();(r.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Oh.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Oh.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(gte,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},pte)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&t[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),r=this.hot.countRows();let i;for(let s=e[2]+1;s<r;s++){for(let l=e[1];l<=e[3];l++){const u=t[s][l];if(!Gn(u))return-1}const o=t[s][e[1]-1],a=t[s][e[3]+1];(!Gn(o)||!Gn(a))&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...bt(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,r=br(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+er(this.hot.table),i=br(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+gn(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Ff(Nc,this,Ste).call(this)),this.eventManager.addEventListener(e,"mousemove",t=>Ff(Nc,this,Rte).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=lte(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function vte(){this.selectAdjacent()&&this.fillIn()}function yte(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Cte(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(n),this.addNewRowIfNeeded())}function Ste(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Rte(n){const e=this.getIfMouseWasDraggedOutside(n);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Ete(n,e){XB(n,e),e.add(n)}function bte(n,e,t){XB(n,e),e.set(n,t)}function XB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ic(n,e,t){return(e=Tte(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Tte(n){var e=Ate(n,"string");return typeof e=="symbol"?e:e+""}function Ate(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Nte(n,e,t){return n.set(ta(n,e),t),t}function dO(n,e){return n.get(ta(n,e))}function ta(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const nw="autoRowSize",Ite=40,Mte="autoRowSize";var fg=new WeakMap,ja=new WeakSet;class Mm extends Wt{static get PLUGIN_KEY(){return nw}static get PLUGIN_PRIORITY(){return Ite}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Ete(this,ja),Ic(this,"headerHeight",null),Ic(this,"ghostTable",new KB(this.hot)),Ic(this,"samplesGenerator",new ZC((t,r)=>{const i=this.hot.toPhysicalRow(t),s=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s)||t>=0&&r>=0&&this.hot.getCellMeta(t,r).hidden)return!1;let o;return t>=0?o=this.hot.getDataAtCell(t,r):t===-1&&(o=this.hot.getColHeader(r)),{value:o}})),Ic(this,"inProgress",!1),Ic(this,"measuredRows",0),Ic(this,"rowHeightsMap",new bu),bte(this,fg,[]),this.hot.rowIndexMapper.registerMap(Mte,this.rowHeightsMap),this.addHook("beforeRowResize",(t,r,i)=>ta(ja,this,wD).call(this,t,r,i))}isEnabled(){const e=this.hot.getSettings()[nw];return e===!0||mt(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ta(ja,e,xte).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ta(ja,e,Pte).call(e,...r)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ta(ja,e,Dte).call(e,...r)}),this.addHook("beforeRender",()=>ta(ja,this,_te).call(this)),this.addHook("modifyRowHeight",(t,r)=>this.getRowHeight(r,t)),this.addHook("init",()=>ta(ja,this,Lte).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,r)=>ta(ja,this,wD).call(this,e,t,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(e===-1||t===-1)return;const r=this.hot.renderCall;this.calculateRowsHeight({from:e,to:t},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}He(i.from,i.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((u,h)=>this.ghostTable.addRow(h,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){ny(s),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+Mm.CALCULATION_STEP,i)},e,t),r=r+Mm.CALCULATION_STEP+1,r<i?s=tI(o):(ny(s),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,t),r=a+1),r<i?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const e=this.hot.getSettings()[nw],t=e&&Ln(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Ln(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[nw];let t=Mm.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return mt(e)&&(t=e.syncLimit,KV(t)?t=TU(r,t):t>>=0),Math.min(t,r)}getRowHeight(e,t){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=t;return r!==null&&r>(t||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.view.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.view.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{He(Math.min(t,r),Math.max(t,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Ote(n){const e={from:0,to:this.hot.countCols()-1};n.forEach(t=>{this.samplesGenerator.generateRowSamples(t,e).forEach((i,s)=>this.ghostTable.addRow(s,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,r)=>{const i=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function _te(){this.calculateVisibleRowsHeight(),this.inProgress||(ta(ja,this,Ote).call(this,dO(fg,this)),Nte(fg,this,[]))}function wD(n,e,t){let r=n;return t&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function xte(n,e){e||this.recalculateAllRowsHeight()}function Pte(n){const e=n.reduce((t,r)=>{let[i]=r;return t.indexOf(i)===-1&&t.push(i),t},[]);dO(fg,this).push(...e)}function Lte(){this.recalculateAllRowsHeight()}function Dte(n){const e=n.reduce((t,r)=>{var i;const s=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);t.indexOf(o)===-1&&t.push(o)}return t},[]);dO(fg,this).push(...e)}const{getListWithInsertedItems:Hte,getListWithRemovedItems:Fte}=JU("physicallyIndexed");class kte extends lc{constructor(){super(e=>e)}insert(e,t){const r=MI(this.indexedValues,t);this.indexedValues=Hte(r,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=Fte(this.indexedValues,e);this.indexedValues=II(t,e),super.remove(e)}}const{getListWithInsertedItems:Vte,getListWithRemovedItems:Ute}=JU("physicallyIndexed");class Bte extends lc{constructor(){super(e=>e)}insert(e,t){this.indexedValues=Vte(this.indexedValues,e,t,(r,i)=>this.getNextValue(i)),super.insert(e,t)}remove(e){this.indexedValues=Ute(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function Wte(n,e){$te(n,e),e.add(n)}function $te(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gte(n,e,t){return(e=jte(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function jte(n){var e=zte(n,"string");return typeof e=="symbol"?e:e+""}function zte(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Yte(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const qb="bindRowsWithHeaders",Kte=210,qte="loose",Xte=new Map([["loose",kte],["strict",Bte]]);var vD=new WeakSet;class Qte extends Wt{constructor(){super(...arguments),Wte(this,vD),Gte(this,"headerIndexes",null)}static get PLUGIN_KEY(){return qb}static get PLUGIN_PRIORITY(){return Kte}isEnabled(){return!!this.hot.getSettings()[qb]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[qb];typeof e!="string"&&(e=qte);const t=Xte.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",r=>Yte(vD,this,Zte).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Zte(n){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(n))}function Jte(n,e){QB(n,e),e.add(n)}function ene(n,e,t){QB(n,e),e.set(n,t)}function QB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yD(n,e,t){return(e=tne(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tne(n){var e=nne(n,"string");return typeof e=="symbol"?e:e+""}function nne(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function CD(n,e){return n.get(gd(n,e))}function Xb(n,e,t){return n.set(gd(n,e),t),t}function gd(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Rv="collapsibleColumns",rne=290,ine=["nestedHeaders"],Ad="collapsibleIndicator",SD=Rv,RD=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Mc=new WeakMap,kf=new WeakSet;class sne extends Wt{constructor(){super(...arguments),Jte(this,kf),yD(this,"nestedHeadersPlugin",null),yD(this,"headerStateManager",null),ene(this,Mc,null)}static get PLUGIN_KEY(){return Rv}static get PLUGIN_PRIORITY(){return rne}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Rv,...ine]}isEnabled(){return!!this.hot.getSettings()[Rv]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||zt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Xb(Mc,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>gd(kf,this,lne).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return gd(kf,e,une).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return gd(kf,e,one).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,s)=>gd(kf,this,ane).call(this,r,i,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Xb(Mc,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(t,r))!==null&&e!==void 0?e:{};if(i)return s?this.expandSection({row:t,col:o}):this.collapseSection({row:t,col:o}),!1},runOnlyIf:()=>{var e,t;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight.isHeader())},group:SD,relativeToGroup:Tu,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SD)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};He(0,e-1,o=>{const a=t.childNodes[o],l=r.childNodes[o],u=i?i.childNodes[o]:null;He(0,a.childNodes.length-1,h=>{let c=a.childNodes[h].querySelector(`.${Ad}`);s(c),l&&l.childNodes[h]&&(c=l.childNodes[h].querySelector(`.${Ad}`),s(c)),i&&u&&u.childNodes[h]&&(c=u.childNodes[h].querySelector(`.${Ad}`),s(c))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=r;if(i===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!RD.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const r=vu(e,f=>{let{row:m}=f;return m<0});let i=r.length>0;D(r,f=>{var m;let{row:p,col:v}=f;const{collapsible:y,isCollapsed:S}=(m=this.headerStateManager.getHeaderSettings(p,v))!==null&&m!==void 0?m:{};if(!y||S&&t==="collapse"||!S&&t==="expand")return i=!1,!1});const s=[],o=[];i&&D(r,f=>{let{row:m,col:p}=f;const{colspanCompensation:v,affectedColumns:y,rollbackModification:S}=this.headerStateManager.triggerNodeModification(t,m,p);v>0&&(o.push(...y),s.push(S))});const a=this.getCollapsedColumns();let l=[];t==="collapse"?l=zV([...a,...o]):t==="expand"&&(l=vu(a,f=>!o.includes(f)));const u=RD.get(t);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){D(s,f=>{f()});return}this.hot.batchExecution(()=>{D(o,f=>{CD(Mc,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const c=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(t==="collapse"&&c&&d){const{row:f,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&o.includes(m)){const v=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,y=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;v!==null&&y!==null&&this.hot.selectCell(v,y)}}this.hot.runHooks(u.afterHook,a,l,i,c),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return CD(Mc,this).getHiddenIndexes()}destroy(){Xb(Mc,this,null),super.destroy()}}function one(n,e,t){var r;const{collapsible:i,origColspan:s,isCollapsed:o}=(r=this.headerStateManager.getHeaderSettings(t,n))!==null&&r!==void 0?r:{},a=i&&s>1&&n>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Ad}`);if(Jd(e,[Ns("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),ue(u,Ad),e.querySelector("div:first-child").appendChild(u)),rt(u,["collapsed","expanded"]),o?(ue(u,"collapsed"),Wh(u,"+"),l&&Xe(e,...Ns(!1))):(ue(u,"expanded"),Wh(u,"-"),l&&Xe(e,...Ns(!0))),l&&Xe(u,...ac());else{var h;(h=u)===null||h===void 0||h.remove()}}function ane(n,e){Je(n.target,Ad)&&(Je(n.target,"expanded")?(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Je(n.target,"collapsed")&&(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),To(n))}function lne(){this.updatePlugin()}function une(n,e){e||this.updatePlugin()}function Yu(n,e,t){return(e=hne(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hne(n){var e=cne(n,"string");return typeof e=="symbol"?e:e+""}function cne(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const dne=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],fne=!1,mne=!0,gne=!0;class pne{constructor(e,t){Yu(this,"hot",void 0),Yu(this,"sortingStates",new jC),Yu(this,"sortEmptyCells",fne),Yu(this,"indicator",mne),Yu(this,"headerAction",gne),Yu(this,"compareFunctionFactory",void 0),Yu(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){mt(e)&&gt(e,(t,r)=>{dne.includes(r)&&(this[r]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[r]=t;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return mt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[r,i]=t;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(_e(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function ZB(n,e,t){const r=e.locale;return function(i,s){const{sortEmptyCells:o}=t;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof s=="string"&&(s=s.toLocaleLowerCase(r)),i===s?fa:Gn(i)?Gn(s)?fa:o&&n==="asc"?xn:Pn:Gn(s)?o&&n==="asc"?Pn:xn:isNaN(i)&&!isNaN(s)?n==="asc"?Pn:xn:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?n==="asc"?xn:Pn:i>s?n==="asc"?Pn:xn:fa}}const JB="default";function wne(n,e,t){return function(r,i){const s=parseFloat(r),o=parseFloat(i),{sortEmptyCells:a}=t;if(s===o||isNaN(s)&&isNaN(o))return fa;if(a){if(Gn(r))return n==="asc"?xn:Pn;if(Gn(i))return n==="asc"?Pn:xn}return isNaN(s)?Pn:isNaN(o)?xn:s<o?n==="asc"?xn:Pn:s>o?n==="asc"?Pn:xn:fa}}const vne="numeric";function yne(n,e,t){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=t;return function(o,a){const l=Gn(o),u=Gn(a),h=l?i:o,c=u?i:a,d=h===i||h===r,f=c===i||c===r;if(s===!1){if(l&&u===!1)return Pn;if(l===!1&&u)return xn}return d===!1&&f?n==="asc"?xn:Pn:d&&f===!1?n==="asc"?Pn:xn:d===!1&&f===!1?ZB(n,e,t)(o,a):h===i&&c===r?n==="asc"?xn:Pn:h===r&&c===i?n==="asc"?Pn:xn:fa}}const Cne="checkbox";function Sne(n,e,t){return sW(n,e.dateFormat,t)}const Rne="date";function Ene(n,e,t){return sW(n,e.timeFormat,t)}const bne="time",{register:Zg,getItem:ED,hasItem:Tne}=Ao("sorting.compareFunctionFactory"),{register:eW,getItem:Ane}=Ao("sorting.mainSortComparator");function tW(n){return Tne(n)?ED(n):ED(JB)}Zg(Cne,yne);Zg(Rne,Sne);Zg(JB,ZB);Zg(vne,wne);Zg(bne,Ene);const fa=0,xn=-1,Pn=1;function Nne(n,e){const t=Ane(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];n.sort(t(...i))}const vy="asc",yy="desc",nW="colHeader";function Ine(n){if(mt(n)===!1)return!1;const{column:e,sortOrder:t}=n;return Number.isInteger(e)&&[vy,yy].includes(t)}function Mne(n){if(n.some(t=>Ine(t)===!1))return!1;const e=n.map(t=>{let{column:r}=t;return r});return new Set(e).size===e.length}function bD(n){if(n!==yy)return n===vy?yy:vy}function rW(n){return n.querySelector(`.${nW}`)}function iW(n,e){if(n<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function fO(n,e,t){return n===-1&&e>=0&&$h(t)===!1}function sW(n,e,t){return function(r,i){const{sortEmptyCells:s}=t;if(r===i)return fa;if(Gn(r))return Gn(i)?fa:s&&n==="asc"?xn:Pn;if(Gn(i))return s&&n==="asc"?Pn:xn;const o=le(r,e),a=le(i,e);return o.isValid()?a.isValid()?a.isAfter(o)?n==="asc"?xn:Pn:a.isBefore(o)?n==="asc"?Pn:xn:fa:xn:Pn}}const One="ascending",_ne="descending",oW="indicatorDisabled",aW="columnSorting",lW="sortAction",uW=new Map([[vy,One],[yy,_ne]]);function xne(n,e,t,r){const i=[aW];if(r&&i.push(lW),t===!1)return i.push(oW),i;const s=n.getSortOrderOfColumn(e);return _e(s)&&i.push(uW.get(s)),i}function Pne(){return Array.from(uW.values()).concat(lW,oW,aW)}function Lne(n,e){return function(t,r){const[,...i]=t,[,...s]=r;return(function(a){const l=n[a],u=e[a],h=i[a],c=s[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:tW(u.type))(l,u,d)(h,c)})(0)}}function Dne(n,e){Hne(n,e),e.add(n)}function Hne(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rw(n,e,t){return(e=Fne(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Fne(n){var e=kne(n,"string");return typeof e=="symbol"?e:e+""}function kne(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function rd(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Cy="columnSorting",Vne=50,Sy="append",Une="replace",TD=Cy;eW(Cy,Lne);Ie.getSingleton().register("beforeColumnSort");Ie.getSingleton().register("afterColumnSort");var Sh=new WeakSet;class hW extends Wt{constructor(){super(...arguments),Dne(this,Sh),rw(this,"columnStatesManager",null),rw(this,"columnMetaCache",null),rw(this,"pluginKey",Cy),rw(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Cy}static get PLUGIN_PRIORITY(){return Vne}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new pne(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new bu(t=>{let r=this.hot.toVisualColumn(t);return r===null&&(r=t),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,r)=>rd(Sh,this,Bne).call(this,t,r)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return rd(Sh,e,$ne).call(e,...r)}),this.addHook("afterOnCellMouseDown",(t,r)=>this.onAfterOnCellMouseDown(t,r)),this.addHook("afterInit",()=>rd(Sh,this,oN).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return rd(Sh,e,Wne).call(e,...r)}),this.hot.view&&rd(Sh,this,oN).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,r)=>{const i=rW(r);iW(t,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:Tu,position:"before",group:TD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(TD)}sort(e){const t=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",t,r,i)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new eB),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",t,i?r:t,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return _e(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return Mne(e)&&e.every(r=>{let{column:i}=r;return i<=t&&i>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:s,...o}=i;return{column:this.hot.toPhysicalColumn(s),...o}};t.initialConfig=bt(e,r),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,r=i=>{let{column:s,...o}=i;return{column:this.hot.toVisualColumn(s),...o}};return _e(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=bt(t.initialConfig,r)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(_e(t)){const i=bD(t);return _e(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:bD()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sy;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(i){if(mn(o))return[...s.slice(0,r),...s.slice(r+1)];if(t===Sy)return[...s.slice(0,r),...s.slice(r+1),o];if(t===Une)return[...s.slice(0,r),o,...s.slice(r+1)]}return _e(o)?s.concat(o):s}getPluginColumnConfig(e){if(mt(e)){const t=e[this.pluginKey];if(mt(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(r,t,this.getPluginColumnConfig(s.columns[e])):fn(s.columns)?Object.assign(r,t,this.getPluginColumnConfig(s.columns(e))):Object.assign(r,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),r=Object.create(t);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const t=[],r=this.hot.countRows(),i=u=>bt(e,h=>this.hot.getDataAtCell(u,h.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)t.push([this.hot.toPhysicalRow(u)].concat(i(u)));const s=bt(t,u=>u[0]);Nne(t,this.pluginKey,bt(e,u=>u.sortOrder),bt(e,u=>this.getFirstCellSettings(u.column)));for(let u=t.length;u<r;u+=1)t.push([u].concat(i(u)));const o=bt(t,u=>u[0]),a=new Map(bt(s,(u,h)=>[u,o[h]])),l=bt(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(mt(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||mt(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(rt(e,Pne()),this.enabled!==!1){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];ue(e,xne(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),_e(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&Je(e.target,nW)}onAfterOnCellMouseDown(e,t){if(fO(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(t.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function oN(){const n=this.getAllSavedSortSettings();if(mt(n))this.sortBySettings(n);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Bne(n,e){const t=rW(e);if(iW(n,e)===!1||t===null)return;const r=this.getFirstCellSettings(n)[this.pluginKey],i=r.indicator,s=r.headerAction;if(this.updateHeaderClasses(t,this.columnStatesManager,n,i,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(n);Xe(e,...i4(o?`${o}ending`:"none"))}}function Wne(n){n===!0&&this.hot.view&&rd(Sh,this,oN).call(this)}function $ne(n,e,t,r){fO(e.row,e.col,n)!==!1&&this.wasClickableHeaderClicked(n,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Ku(n,e,t){return(e=Gne(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Gne(n){var e=jne(n,"string");return typeof e=="symbol"?e:e+""}function jne(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class zne{constructor(e,t){Ku(this,"plugin",void 0),Ku(this,"hot",void 0),Ku(this,"endpoints",[]),Ku(this,"settings",void 0),Ku(this,"settingsType","array"),Ku(this,"currentEndpoint",null),Ku(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),D(r,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),t.push(s)}),t}assignSetting(e,t,r,i){if(r==="ranges"&&e[r]===void 0){t[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;t[r]=i}else r==="destinationRow"&&t.reversedRowCoords?t[r]=this.hot.countRows()-e[r]-1:t[r]=e[r]}resetSetupBeforeStructureAlteration(e,t,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();D(s,o=>{i==="row"&&o.destinationRow>=t&&(e==="insert_row"?o.alterRowOffset=r:e==="remove_row"&&(o.alterRowOffset=-1*r)),i==="col"&&o.destinationColumn>=t&&(e==="insert_col"?o.alterColumnOffset=r:e==="remove_col"&&(o.alterColumnOffset=-1*r))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,t,r,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),h=e.indexOf("move_row")===0,c=t;D(u,d=>{a==="row"&&d.destinationRow>=c&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=c&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!h),h?D(u,d=>{this.extendEndpointRanges(d,c,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):D(u,d=>{this.shiftEndpointCoordinates(d,c)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,r,i){D(e.ranges,s=>{s[1]&&(t>=s[0]&&t<=s[1]?r>s[1]?s[1]+=i:r<s[0]&&(s[0]-=i):r>=s[0]&&r<=s[1]&&(s[1]-=i,t<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,r=[],i=[];D(t,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));i.push(o)}),D(i,s=>{let o=[];D(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),r.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),r.push(o))})}),e.ranges=r}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,D(e.ranges,r=>{D(r,(i,s)=>{i>=t&&(r[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,o=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],D(e,i=>{this.resetEndpointValue(i,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],D(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],D(e,(r,i,s)=>{`${r[2]||""}`!=`${r[3]}`&&D(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[i][1])===o.sourceColumn&&t.indexOf(a)===-1&&t.push(a)})}),D(t,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(t!==null){const r=this.hot.getCellMeta(t,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?r:0)),this.hot.toVisualColumn(e.destinationColumn+(t?i:0)),""])}setEndpointValue(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(t==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let a=0;Number.isInteger(o)&&(a=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){zt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function Qb(n){return n==null||isNaN(n)}function Yne(n,e){Kne(n,e),e.add(n)}function Kne(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qne(n,e,t){return(e=Xne(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Xne(n){var e=Qne(n,"string");return typeof e=="symbol"?e:e+""}function Qne(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function iw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Zb="columnSummary",Zne=220;var Vf=new WeakSet;class Jne extends Wt{constructor(){super(...arguments),Yne(this,Vf),qne(this,"endpoints",null)}static get PLUGIN_KEY(){return Zb}static get PLUGIN_PRIORITY(){return Zne}isEnabled(){return!!this.hot.getSettings()[Zb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Zb],this.endpoints=new zne(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return iw(Vf,e,ere).call(e,...r)}),this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return iw(Vf,e,nre).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return iw(Vf,e,tre).call(e,...r)}),this.addHook("beforeCreateRow",(t,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,r,null,i)),this.addHook("beforeCreateCol",(t,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(t,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,r,null,i)),this.addHook("afterCreateCol",(t,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,r,null,i)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return iw(Vf,e,rre).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return gt(e.ranges,r=>{t+=this.getPartialSum(r,e.sourceColumn)}),t}getPartialSum(e,t){let r=0,i=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(i,t),s=Qb(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}r+=s||0,i-=1}while(i>=e[0]);return Math.round(r*10**o)/10**o}calculateMinMax(e,t){let r=null;return gt(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,t);if(r===null&&s!==null&&(r=s),s!==null)switch(t){case"min":r=Math.min(r,s);break;case"max":r=Math.max(r,s);break}}),r===null?"Not enough data":r}getPartialMinMax(e,t,r){let i=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,t),o=Qb(o)?null:o,i===null)i=o;else if(o!==null)switch(r){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}s-=1}while(s>=e[0]);return i}countEmpty(e,t){let r,i=0,s=e[1]||e[0];do r=this.getCellValue(s,t),r=Qb(r)?null:r,r===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let t=0;const r=e.ranges;return gt(r,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,o=this.countEmpty(i,e.sourceColumn);t+=s,t-=o}),t}calculateAverage(e){const t=this.calculateSum(e),r=this.countEntries(e);return t/r}getCellValue(e,t){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(t);let s=this.hot.getSourceDataAtCell(e,t),o="";if(r!==null&&i!==null&&(o=this.hot.getCellMeta(r,i).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Yt`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function ere(){this.endpoints.initEndpoints()}function tre(n){n.columns!==void 0&&this.endpoints.refreshCellMetas()}function nre(n,e){n&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(n)}function rre(n,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",n[0],n.length,n,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,n.length,n,this.pluginName)}function ire(n,e){cW(n,e),e.add(n)}function Jb(n,e,t){cW(n,e),e.set(n,t)}function cW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function id(n,e){return n.get(mO(n,e))}function aN(n,e,t){return n.set(mO(n,e),t),t}function mO(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ry=new WeakMap,sw=new WeakMap,ow=new WeakMap,AD=new WeakSet;class dW{constructor(){ire(this,AD),Jb(this,Ry,!0),Jb(this,sw,null),Jb(this,ow,new ResizeObserver(e=>mO(AD,this,sre).call(this,e)))}setObservedElement(e){aN(sw,this,e)}unobserve(){id(ow,this).unobserve(id(sw,this))}observe(){aN(Ry,this,!0),id(ow,this).observe(id(sw,this))}destroy(){id(ow,this).disconnect()}}function sre(n){if(id(Ry,this)||!Array.isArray(n)||!n.length){aN(Ry,this,!1);return}n.forEach(e=>{let{borderBoxSize:t}=e;const{inlineSize:r,blockSize:i}=t[0];this.runLocalHooks("resize",r,i)})}en(dW,Br);function qu(n,e,t){ore(n,e),e.set(n,t)}function ore(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tn(n,e){return n.get(fW(n,e))}function Fa(n,e,t){return n.set(fW(n,e),t),t}function fW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Xu=new WeakMap,eT=new WeakMap,ka=new WeakMap,Qu=new WeakMap,Ml=new WeakMap,aw=new WeakMap,Oc=new WeakMap;class _h{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var r=this;qu(this,Xu,void 0),qu(this,eT,!1),qu(this,ka,null),qu(this,Qu,void 0),qu(this,Ml,void 0),qu(this,aw,!0),qu(this,Oc,new dW),Fa(Xu,this,e),Fa(eT,this,t),Fa(Qu,this,this.createEditor()),Fa(Ml,this,tn(Qu,this).style),tn(Oc,this).setObservedElement(this.getInputElement()),tn(Oc,this).addLocalHook("resize",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,t){tn(Ml,this).left=`${e}px`,tn(Ml,this).top=`${t}px`}setSize(e,t){if(e&&t){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${t}px`}}getSize(){return{width:gn(this.getInputElement()),height:er(this.getInputElement())}}observeSize(){tn(Oc,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){tn(Ml,this).display="block",Fa(aw,this,!1)}hide(){tn(Oc,this).unobserve(),tn(aw,this)||(tn(Ml,this).display="none"),Fa(aw,this,!0)}isVisible(){return tn(Ml,this).display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return tn(Xu,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=tn(Xu,this).createElement("div"),t=tn(Xu,this).createElement("textarea");return e.style.display="none",Fa(ka,this,tn(Xu,this).createElement("div")),tn(ka,this).setAttribute("dir",tn(eT,this)?"rtl":"ltr"),ue(tn(ka,this),_h.CLASS_EDITOR_CONTAINER),tn(Xu,this).body.appendChild(tn(ka,this)),ue(e,_h.CLASS_EDITOR),ue(t,_h.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),tn(ka,this).appendChild(e),e}getInputElement(){return tn(Qu,this).querySelector(`.${_h.CLASS_INPUT}`)}destroy(){const e=tn(ka,this)?tn(ka,this).parentNode:null;tn(Qu,this).parentNode.removeChild(tn(Qu,this)),Fa(Qu,this,null),Fa(Ml,this,null),tn(Oc,this).destroy(),e&&e.removeChild(tn(ka,this))}}en(_h,Br);function tT(n,e,t){return(e=are(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function are(n){var e=lre(n,"string");return typeof e=="symbol"?e:e+""}function lre(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const ure=250,hre=250;class mW{constructor(e){tT(this,"wasLastActionShow",!0),tT(this,"showDebounced",null),tT(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},hre)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ure;this.showDebounced=Z0(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}en(mW,Br);function cre(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function dre(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Zu(n,e){const t={};return D(n,r=>{r.forAll((i,s)=>{i>=0&&s>=0&&(t[i]||(t[i]=[]),t[i][s]=e(i,s))})}),t}function Bl(n,e,t,r,i){D(n,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&fre(o,a,e,t,r,i)})})}function fre(n,e,t,r,i,s){const o=i(n,e);let a=r;o.className&&(t==="vertical"?a=cre(o.className,r):a=dre(o.className,r)),s(n,e,"className",a)}function Ka(n){return`<span class="selected">✓</span>${n}`}function Om(n,e){let t=!1;return Array.isArray(n)&&D(n,r=>(r.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return t=!0,!1}),t)),t}function JC(n,e){const t={top:0,left:0};if(e!==n.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:s}=r.getBoundingClientRect();t.top=i,t.left=s}return t}function mre(n){return function(e,t){const r=this.getCellMeta(e,t).className;return r&&r.indexOf(n)!==-1}}function Si(n,e){return Om(n.getSelectedRange(),mre(e).bind(n))}const dt="---------";function gre(){return{name:dt}}const vs="alignment";function pre(){return{key:vs,name(){return this.getTranslatedPhrase(eM)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${vs}:left`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(oy)},ariaChecked(){return Si(this,"htLeft")},name(){let n=this.getTranslatedPhrase(oy);return Si(this,"htLeft")&&(n=Ka(n)),n},callback(){const n=this.getSelectedRange(),e=Zu(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,n,t,r),Bl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${vs}:center`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(ay)},ariaChecked(){return Si(this,"htCenter")},name(){let n=this.getTranslatedPhrase(ay);return Si(this,"htCenter")&&(n=Ka(n)),n},callback(){const n=this.getSelectedRange(),e=Zu(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,n,t,r),Bl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${vs}:right`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(ly)},ariaChecked(){return Si(this,"htRight")},name(){let n=this.getTranslatedPhrase(ly);return Si(this,"htRight")&&(n=Ka(n)),n},callback(){const n=this.getSelectedRange(),e=Zu(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,n,t,r),Bl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${vs}:justify`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(uy)},ariaChecked(){return Si(this,"htJustify")},name(){let n=this.getTranslatedPhrase(uy);return Si(this,"htJustify")&&(n=Ka(n)),n},callback(){const n=this.getSelectedRange(),e=Zu(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,n,t,r),Bl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{name:dt},{key:`${vs}:top`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(hy)},ariaChecked(){return Si(this,"htTop")},name(){let n=this.getTranslatedPhrase(hy);return Si(this,"htTop")&&(n=Ka(n)),n},callback(){const n=this.getSelectedRange(),e=Zu(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,n,t,r),Bl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${vs}:middle`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(cy)},ariaChecked(){return Si(this,"htMiddle")},name(){let n=this.getTranslatedPhrase(cy);return Si(this,"htMiddle")&&(n=Ka(n)),n},callback(){const n=this.getSelectedRange(),e=Zu(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,n,t,r),Bl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${vs}:bottom`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(dy)},ariaChecked(){return Si(this,"htBottom")},name(){let n=this.getTranslatedPhrase(dy);return Si(this,"htBottom")&&(n=Ka(n)),n},callback(){const n=this.getSelectedRange(),e=Zu(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,n,t,r),Bl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1}]}}}const eS="clear_column";function wre(){return{key:eS,name(){return this.getTranslatedPhrase(UI)},callback(n,e){const t=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const Jg="col_left";function vre(){return{key:Jg,name(){return this.getTranslatedPhrase(LI)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,n.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const ep="col_right";function yre(){return{key:ep,name(){return this.getTranslatedPhrase(DI)},callback(){const n=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,n.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const tp="make_read_only";function Cre(){return{key:tp,checkable:!0,ariaChecked(){return Om(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly)},ariaLabel(){return this.getTranslatedPhrase(sy)},name(){let n=this.getTranslatedPhrase(sy);return Om(this.getSelectedRange(),(t,r)=>this.getCellMeta(t,r).readOnly)&&(n=Ka(n)),n},callback(){const n=this.getSelectedRange(),e=Om(n,(t,r)=>this.getCellMeta(t,r).readOnly);D(n,t=>{t.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const n=this.getSelectedRangeLast();return!!(!n||n.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const tS="redo";function Sre(){return{key:tS,name(){return this.getTranslatedPhrase(VI)},callback(){this.redo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const np="remove_col";function Rre(){return{key:np,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[,t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(FI,e)},callback(){this.alter("remove_col",F7(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const nS="remove_row";function Ere(){return{key:nS,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(HI,e)},callback(){this.alter("remove_row",k7(this),1,"ContextMenu.removeRow")},disabled(){const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const rS="row_above";function bre(){return{key:rS,name(){return this.getTranslatedPhrase(xI)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",n.row,1,"ContextMenu.rowAbove")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const iS="row_below";function Tre(){return{key:iS,name(){return this.getTranslatedPhrase(PI)},callback(){const n=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",n.row,1,"ContextMenu.rowBelow")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const mg="no_items";function Are(){return{key:mg,name(){return this.getTranslatedPhrase(_I)},disabled:!0,isCommand:!1}}const sS="undo";function Nre(){return{key:sS,name(){return this.getTranslatedPhrase(kI)},callback(){this.undo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Ire=[rS,iS,Jg,ep,eS,nS,np,sS,tS,tp,vs,dt,mg],Mre={[dt]:gre,[mg]:Are,[rS]:bre,[iS]:Tre,[Jg]:vre,[ep]:yre,[eS]:wre,[nS]:Ere,[np]:Rre,[sS]:Nre,[tS]:Sre,[tp]:Cre,[vs]:pre};function gW(){const n={};return gt(Mre,(e,t)=>{n[t]=e()}),n}function Ore(n){return{key:"commentsAddEdit",name(){var e;const t=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t!=null&&t.isCell()&&n.getCommentAtCell(t.row,t.col)?this.getTranslatedPhrase(QI):this.getTranslatedPhrase(XI)},callback(){const e=this.getSelectedRangeLast();n.setRange(e),n.show(),n.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function _re(n){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(ZI)},callback(){this.getSelectedRangeLast().forAll((t,r)=>{t>=0&&r>=0&&n.removeCommentAtCell(t,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function xre(n){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(JI);return Om(this.getSelectedRange(),(r,i)=>n.getCommentMeta(r,i,Ev))?Ka(e):e},callback(){this.getSelectedRangeLast().forAll((t,r)=>{if(t>=0&&r>=0){const i=!!n.getCommentMeta(t,r,Ev);n.updateCommentMeta(t,r,{[Ev]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!n.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Pre(n,e){pW(n,e),e.add(n)}function _c(n,e,t){pW(n,e),e.set(n,t)}function pW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lre(n,e,t){return(e=Dre(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Dre(n){var e=Hre(n,"string");return typeof e=="symbol"?e:e+""}function Hre(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ou(n,e,t){return n.set(eo(n,e),t),t}function St(n,e){return n.get(eo(n,e))}function eo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const _m="comments",Fre=60,qa="comment",gm="value",wW="style",Ev="readOnly",lw=_m,lN=`plugin:${_m}`;var rn=new WeakMap,Xo=new WeakMap,oS=new WeakMap,bv=new WeakMap,uN=new WeakMap,Ey=new WeakMap,Ho=new WeakSet;class kre extends Wt{constructor(){super(...arguments),Pre(this,Ho),Lre(this,"range",{}),_c(this,rn,null),_c(this,Xo,null),_c(this,oS,!1),_c(this,bv,!1),_c(this,uN,null),_c(this,Ey,"")}static get PLUGIN_KEY(){return _m}static get PLUGIN_PRIORITY(){return Fre}isEnabled(){return!!this.hot.getSettings()[_m]}enablePlugin(){var e=this;this.enabled||(St(rn,this)||(ou(rn,this,new _h(this.hot.rootDocument,this.hot.isRtl())),St(rn,this).addLocalHook("resize",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return eo(Ho,e,jre).call(e,...r)})),St(Xo,this)||ou(Xo,this,new mW(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,r,i,s,o,a)=>eo(Ho,this,Wre).call(this,t,a)),this.addHook("afterScroll",()=>eo(Ho,this,Yre).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>eo(Ho,this,zre).call(this,t)),St(Xo,this).addLocalHook("hide",()=>this.hide()),St(Xo,this).addLocalHook("show",(t,r)=>this.showAtCell(t,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){St(Xo,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),r=e.addContext(lN);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();ou(bv,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(lN),this.hot._registerTimeout(()=>{ou(bv,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!St(rn,this).isVisible()},group:lw}),r.addShortcut({keys:[["Escape"]],callback:()=>{St(rn,this).setValue(St(Ey,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>St(rn,this).isVisible()&&St(rn,this).isFocused(),group:lw}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>St(rn,this).isVisible()&&St(rn,this).isFocused(),group:lw})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(lw)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>eo(Ho,this,Ure).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>eo(Ho,this,Vre).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>eo(Ho,this,Bre).call(this)),this.eventManager.addEventListener(t,"focus",()=>eo(Ho,this,Gre).call(this)),this.eventManager.addEventListener(t,"blur",()=>eo(Ho,this,$re).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=Bh(e.target,"TD","TBODY");return!!(t&&Je(t,"htCommentCell")&&Bh(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=St(rn,this).getValue();let r="";e!=null?r=e:t!=null&&(r=t);const i=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(i,s,{[gm]:r}),this.hot.render()}setCommentAtCell(e,t,r){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,qa),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(r)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,gm)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,gm)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:r}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return St(Xo,this).cancelHiding(),St(rn,this).setValue((e=i[qa]?i[qa][gm]:null)!==null&&e!==void 0?e:""),St(rn,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){St(rn,this).hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!St(rn,this).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:s}=this.hot,{row:o,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(o),u=s.getRenderableFromVisualIndex(a);const h=l===null;St(rn,this).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1))),u===null&&(u=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1)));const c=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(t=u)!==null&&t!==void 0?t:0;const{rootWindow:f,view:{_wt:m}}=this.hot,{wtTable:p}=m,v=m.getCell({row:l,col:u},!0),y=this.getCommentMeta(o,a,wW);y?St(rn,this).setSize(y.width,y.height):St(rn,this).resetSize();const S=d?0:p.getStretchedColumnWidth(u),R=h&&!c?er(v):0,{left:T,top:I,width:H,height:k}=v.getBoundingClientRect(),{width:W,height:Y}=St(rn,this).getSize(),{innerWidth:$,innerHeight:q}=this.hot.rootWindow,J=this.hot.rootDocument.documentElement;let re=T+f.scrollX+S,ie=I+f.scrollY+R;this.hot.isRtl()&&(re-=W+S),this.hot.isLtr()&&T+H+W>$?re=T+f.scrollX-W-1:this.hot.isRtl()&&re<-(J.scrollWidth-J.clientWidth)&&(re=T+f.scrollX+S+1),I+Y>q&&(ie-=Y-k+1),St(rn,this).setPosition(re,ie),St(rn,this).setReadOnlyState(this.getCommentMeta(o,a,Ev)),St(rn,this).observeSize()}focusEditor(){St(rn,this).focus()}updateCommentMeta(e,t,r){const i=this.hot.getCellMeta(e,t)[qa];let s;i?(s=mi(i),VC(s,r)):s=r,this.hot.setCellMeta(e,t,qa,s)}getCommentMeta(e,t,r){const i=this.hot.getCellMeta(e,t);if(i[qa])return i[qa][r]}addToContextMenu(e){e.items.push({name:dt},Ore(this),_re(this),xre(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[_m];if(mt(e))return e.displayDelay}getEditorInputElement(){return St(rn,this).getInputElement()}destroy(){var e,t;(e=St(rn,this))===null||e===void 0||e.destroy(),(t=St(Xo,this))===null||t===void 0||t.destroy(),super.destroy()}}function Vre(n){if(!(!this.hot.view||!this.hot.view._wt)&&!St(oS,this)&&!this.targetIsCommentTextArea(n)){const e=Bh(n.target,"TD","TBODY");let t=null;e&&(t=this.hot.getCoords(e)),(!e||this.range.from&&t&&(this.range.from.row!==t.row||this.range.from.col!==t.col))&&this.hide()}}function Ure(n){const{rootDocument:e}=this.hot;if(!(St(oS,this)||St(rn,this).isFocused()||Je(n.target,"wtBorder")||St(uN,this)===n.target||!St(rn,this)))if(ou(uN,this,e.elementFromPoint(n.clientX,n.clientY)),this.targetIsCellWithComment(n)){const t=this.hot._createCellRange(this.hot.getCoords(n.target));St(Xo,this).show(t)}else kh(n.target,e)&&!this.targetIsCommentTextArea(n)&&St(Xo,this).hide()}function Bre(){ou(oS,this,!1)}function Wre(n,e){e[qa]&&e[qa][gm]&&ue(n,e.commentedCellClassName)}function $re(){ou(Ey,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Gre(){ou(Ey,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(lN)}function jre(n,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[wW]:{width:n,height:e}})}function zre(n){St(rn,this).isVisible()&&To(n)}function Yre(){St(bv,this)||this.hide()}var ND={},nT,ID;function Kre(){if(ID)return nT;ID=1;var n=SC(),e=TypeError;return nT=function(t,r){if(!delete t[r])throw new e("Cannot delete property "+n(r)+" of "+n(t))},nT}var MD;function qre(){if(MD)return ND;MD=1;var n=Ur(),e=Dg(),t=kg(),r=jk(),i=Kre(),s=zk(),o=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=o||!a();return n({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(h){var c=e(this),d=t(c),f=arguments.length;if(f){s(d+f);for(var m=d;m--;){var p=m+f;m in c?c[p]=c[m]:i(c,p)}for(var v=0;v<f;v++)c[v]=arguments[v]}return r(c,d+f)}}),ND}qre();function rT(n,e,t){return(e=Xre(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Xre(n){var e=Qre(n,"string");return typeof e=="symbol"?e:e+""}function Qre(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class vW{constructor(e){rT(this,"hot",void 0),rT(this,"commands",{}),rT(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=Zre(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Ln(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(s.join(":")),D(u,h=>h.apply(this.hot,r))}}function Zre(n,e){let t;return D(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===n)return t=r,!1}),t}function iT(n,e,t){return(e=Jre(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Jre(n){var e=eie(n,"string");return typeof e=="symbol"?e:e+""}function eie(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class yW{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;iT(this,"hot",void 0),iT(this,"predefinedItems",gW()),iT(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,gt(e,(r,i)=>{let s="";r.name===dt?(t[dt]=r,s=dt):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,t[i]=r,s=r.key):(t[r.key]=r,s=r.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return tie(e,this.defaultOrderPattern,this.predefinedItems)}}function tie(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=n;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),mt(i)?gt(i,(s,o)=>{let a=t[typeof s=="string"?s:o];a||(a=s),mt(s)?ir(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),r.push(a)}):D(i,(s,o)=>{let a=t[s];!a&&Ire.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),mt(s)&&ir(a,s),a.key===void 0&&(a.key=o),r.push(a))}),r}function Ol(n,e,t){return(e=nie(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nie(n){var e=rie(n,"string");return typeof e=="symbol"?e:e+""}function rie(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class iie{constructor(e,t){Ol(this,"top",void 0),Ol(this,"topRelative",void 0),Ol(this,"left",void 0),Ol(this,"leftRelative",void 0),Ol(this,"scrollTop",void 0),Ol(this,"scrollLeft",void 0),Ol(this,"cellHeight",void 0),Ol(this,"cellWidth",void 0);const r=t.scrollY,i=t.scrollX;let s,o,a,l,u,h;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,h=e.width||0,o=s,l=a,s+=r,a+=i):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,h=e.target.clientWidth,o=s-r,l=a-i),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=h}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Uf(n,e,t){sie(n,e),e.set(n,t)}function sie(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tt(n,e){return n.get(CW(n,e))}function uw(n,e,t){return n.set(CW(n,e),t),t}function CW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ri=new WeakMap,_l=new WeakMap,Ri=new WeakMap,sT=new WeakMap,xc=new WeakMap;class oie{constructor(e){Uf(this,ri,void 0),Uf(this,_l,void 0),Uf(this,Ri,void 0),Uf(this,sT,!1),Uf(this,xc,{above:0,below:0,left:0,right:0}),uw(sT,this,e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Tt(xc,this)[e]=t,this}setElement(e){return uw(ri,this,e),this}setParentElement(e){return uw(_l,this,e),this}updatePosition(e){uw(Ri,this,new iie(e,Tt(ri,this).ownerDocument.defaultView)),Tt(sT,this)?(Tt(Ri,this).fitsBelow(Tt(ri,this))?this.setPositionBelowCursor():Tt(Ri,this).fitsAbove(Tt(ri,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Tt(ri,this).dir==="rtl"?Tt(Ri,this).fitsOnLeft(Tt(ri,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Tt(Ri,this).fitsOnRight(Tt(ri,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Tt(xc,this).above+Tt(Ri,this).top-Tt(ri,this).offsetHeight;Tt(_l,this)&&(e=Tt(Ri,this).top+Tt(Ri,this).cellHeight-Tt(ri,this).offsetHeight+3),Tt(ri,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Tt(xc,this).below+Tt(Ri,this).top+1;Tt(_l,this)&&(e=Tt(Ri,this).top-1),Tt(ri,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Tt(Ri,this).left;if(Tt(_l,this)){const t=Number.parseInt(getComputedStyle(Tt(_l,this).querySelector(".htCore")).borderRightWidth,10);e+=Tt(Ri,this).cellWidth+t}else e+=Tt(xc,this).right;Tt(ri,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Tt(xc,this).left+Tt(Ri,this).left-Tt(ri,this).offsetWidth;if(Tt(_l,this)){const t=Number.parseInt(getComputedStyle(Tt(_l,this).querySelector(".htCore")).borderLeftWidth,10);e-=t}Tt(ri,this).style.left=`${e}px`}}function SW(n){let{initialPage:e=-1,size:t=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=n;const s=new Set;let o=Qt(e,-1,m()-1);function a(v,y){const S=m()-1;return v<0&&(v=S),v>S&&(v=0),s.has(v)?-1:(s.add(v),r(v,!1)===!1&&(v=a(y===1?++v:--v,y)),v)}function l(v){v>-1&&v<m()&&r(v,!0)!==!1&&(o=v)}function u(){return o}function h(){m()>0&&(s.clear(),o=a(0,1))}function c(){m()>0&&(s.clear(),o=a(m()-1,-1))}function d(){m()>0&&(s.clear(),o=a(++o,1))}function f(){m()>0&&(s.clear(),o=a(--o,-1))}function m(){return Math.max(t(),0)}function p(){s.clear(),o=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:h,toLastItem:c,toNextItem:d,toPreviousItem:f,getSize:m,clear:p}}function aie(n){return bt(n,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function hN(n){return Ln(n,"submenu")}function cN(n){return new RegExp(dt,"i").test(n.name)}function Tv(n,e){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(e)===!0}function OD(n){return Ln(n,"disableSelection")}function lie(n){return Je(n,"htSeparator")}function uie(n){return Je(n,"htSubmenu")}function hie(n){return Je(n,"htDisabled")}function cie(n){return Je(n,"htSelectionDisabled")}function die(n,e){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(e))}function RW(n,e){const t=n.slice(0);for(let r=0;r<t.length&&t[r].name===e;)t.shift();return t}function fie(n,e){let t=n.slice(0);return t.reverse(),t=RW(t,e),t.reverse(),t}function mie(n){const e=[];return D(n,(t,r)=>{r>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function gie(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dt,t=n.slice(0);return t=RW(t,e),t=fie(t,e),t=mie(t),t}function pie(n){return n.checkable===!0}function wie(n){return SW({size:()=>n.countRows(),onItemSelect(e,t){const r=n.getCell(e,0);if(!r||lie(r)||hie(r)||cie(r))return!1;n.selectCell(e,0,...t?[e,0,!1,!1]:[])},onClear(){n.deselectCell()}})}function vie(n){const{hot:e,hotMenu:t}=n;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>n.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(r):s.tabMoves;i.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),n.close(!0)}},{keys:[["Escape"]],callback:()=>n.close()},{keys:[["ArrowDown"]],callback:()=>n.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>n.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const r=t.getSelectedLast();if(r){const i=n.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.getSelectedLast()&&n.isSubMenu()&&(n.close(),n.isSubMenu()&&n.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>n.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>n.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=t.getSelectedLast();i&&(t.getSourceDataAtRow(i[0]).submenu?n.openSubMenu(i[0]).getNavigator().toFirstItem():(n.executeCommand(r),n.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(-t.countVisibleRows(),0):n.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(t.countVisibleRows(),0):n.getNavigator().toLastItem()}}]}const EW="menu",_D=EW;function yie(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=[];r(vie(n)),e.forEach(u=>{let{shortcuts:h,contextName:c}=u;i(h,c)});function r(u,h){a(h).addShortcuts(u,{group:EW})}function i(u,h){const c=a(h);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>c.removeShortcutsByKeys(m))}),t.push({shortcuts:u,contextName:h}),r(u,h)}function s(){return[...t]}function o(u){return u?`${_D}:${u}`:_D}function a(u){var h;const c=n.hotMenu.getShortcutManager(),d=o(u);return(h=c.getContext(d))!==null&&h!==void 0?h:c.addContext(d)}function l(u){n.hotMenu.getShortcutManager().setActiveContextName(o(u))}return{addCustomShortcuts:i,getCustomShortcuts:s,getContext:a,listen:l}}function Cie(n){return(e,t,r,i,s,o)=>{const a=e.getSourceDataAtRow(r),l=n.rootDocument.createElement("div"),u=typeof o=="function"?o.call(n):o,h=typeof a.ariaLabel=="function"?a.ariaLabel.call(n):a.ariaLabel,c=typeof a.ariaChecked=="function"?a.ariaChecked.call(n):a.ariaChecked;if(pa(t),ue(l,"htItemWrapper"),n.getSettings().ariaTags){const d=!Tv(a,n)&&!OD(a)&&!cN(a);Xe(t,[...pie(a)?[q6(),ey(h),tU(c)]:[K6(),ey(u)],...d?[Zd(-1)]:[],...Tv(a,n)?[n4()]:[],...hN(a)?[Ns(!1)]:[]])}t.className="",t.appendChild(l),cN(a)?ue(t,"htSeparator"):typeof a.renderer=="function"?(ue(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,r,i,s,u))):ef(l,u),Tv(a,n)?ue(t,"htDisabled"):OD(a)?ue(t,"htSelectionDisabled"):hN(a)&&ue(t,"htSubmenu")}}function oT(n,e,t){Sie(n,e),e.set(n,t)}function Sie(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fo(n,e,t){return(e=Rie(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Rie(n){var e=Eie(n,"string");return typeof e=="symbol"?e:e+""}function Eie(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function aT(n,e,t){return n.set(bW(n,e),t),t}function Ju(n,e){return n.get(bW(n,e))}function bW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const xD=215;var Bf=new WeakMap,hw=new WeakMap,cw=new WeakMap;class sf{get tableBorderWidth(){return Ju(cw,this)===void 0&&this.hotMenu&&aT(cw,this,parseInt(fl(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Ju(cw,this)}constructor(e,t){var r=this;Fo(this,"hot",void 0),Fo(this,"options",void 0),Fo(this,"eventManager",new Co(this)),Fo(this,"container",void 0),Fo(this,"positioner",void 0),Fo(this,"hotMenu",null),Fo(this,"hotSubMenus",{}),Fo(this,"parentMenu",void 0),Fo(this,"menuItems",null),Fo(this,"origOutsideClickDeselects",null),oT(this,Bf,void 0),oT(this,hw,void 0),oT(this,cw,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:xD,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new oie(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.parentMenu.runLocalHooks("afterSelectionChange",...s)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"touchstart",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=Hd(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Ju(Bf,this)}getKeyboardShortcutsCtrl(){return Ju(hw,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Z0(a=>this.openSubMenu(a),300),t=this.options.minWidth||xD;let r=!1,i=vu(this.menuItems,a=>(a.key===mg&&(r=!0),die(a,this.hot)));if(i.length<1&&!r)i.push(gW()[mg]);else if(i.length===0)return;i=gie(i,dt);let s=!1;const o={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return _e(a)&&a<t?t:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Cie(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Ju(Bf,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===dt?1:void 0,afterOnCellContextMenu:a=>{a.preventDefault(),M1()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,h,c)=>{this.hotMenu.view.isMouseDown()&&(c.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!M1()||!$h(a))&&s&&this.hasSelectedItem()&&(iu()||vU()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),aT(Bf,this,wie(this.hotMenu)),aT(hw,this,yie(this)),Ju(hw,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Ju(Bf,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const r=this.parentMenu.hotMenu.getCell(t[0],0);Xe(r,[Ns(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!uie(t))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new sf(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(t.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Xe(t,[Ns(!0)]),i}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[t.key];if(r){r.destroy(),delete this.hotSubMenus[t.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Xe(i,[Ns(!1)])}}closeAllSubMenus(){D(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const r=this.hot.getSelectedRange(),i=r?aie(r):[];this.runLocalHooks("executeCommand",t.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,i,e)}isCommandPassive(e){return e.isCommand===!1||cN(e)||Tv(e,this.hot)||hN(e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,s=parseInt(r.width,10),o=gi(t,(a,l,u)=>{const c=this.hotMenu.getCell(u,0)?er(this.hotMenu.getCell(u,0)):0;return a+(l.name===dt?1:c)},0);i.width=`${s+3}px`,i.height=`${o+3}px`,r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let r=e,i;return r&&(fn(r)&&(r=r.call(this.hot),r===null||mn(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=t.querySelector(`.${this.options.className}.${r}`)),i||(i=t.createElement("div"),ue(i,`htMenu ${this.options.className}`),r&&ue(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Xe(this.hotMenu.rootElement,[Y6(),Zd(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!kh(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!kh(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Je(e.target,"htCore")&&kh(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}en(sf,Br);function bie(n,e){Tie(n,e),e.add(n)}function Tie(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lT(n,e,t){return(e=Aie(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Aie(n){var e=Nie(n,"string");return typeof e=="symbol"?e:e+""}function Nie(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function dw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const pm="contextMenu",Iie=70,PD=pm;Ie.getSingleton().register("afterContextMenuDefaultOptions");Ie.getSingleton().register("beforeContextMenuShow");Ie.getSingleton().register("afterContextMenuShow");Ie.getSingleton().register("afterContextMenuHide");Ie.getSingleton().register("afterContextMenuExecute");var Wf=new WeakSet;class aS extends Wt{constructor(){super(...arguments),bie(this,Wf),lT(this,"commandExecutor",new vW(this.hot)),lT(this,"itemsFactory",null),lT(this,"menu",null)}static get PLUGIN_KEY(){return pm}static get PLUGIN_PRIORITY(){return Iie}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[rS,iS,dt,Jg,ep,dt,nS,np,dt,sS,tS,dt,tp,dt,vs]}isEnabled(){return!!this.hot.getSettings()[pm]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[pm];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new sf(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>dw(Wf,this,Oie).call(this)),this.menu.addLocalHook("afterOpen",()=>dw(Wf,this,_ie).call(this)),this.menu.addLocalHook("afterClose",()=>dw(Wf,this,xie).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>dw(Wf,this,Mie).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=JC(this.menu.container,this.hot.rootDocument);this.open({left:t.left+r.left,top:t.top+r.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:PD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(PD)}open(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((t=this.menu)!==null&&t!==void 0&&t.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(r.below+=1,r.right+=1,r.above-=1,r.left-=1),gt(r,(s,o)=>{this.menu.setOffset(o,s)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new yW(this.hot,aS.DEFAULT_ITEMS);const e=this.hot.getSettings()[pm],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),D(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Mie(n){const e=this.hot.getSettings(),t=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=n.target;if(this.close(),Je(s,"handsontableInput")||(n.preventDefault(),n.stopPropagation(),!(t||r)&&!i(s)&&!(Je(s,"current")&&Je(s,"wtBorder"))))return;const o=JC(this.menu.container,this.hot.rootDocument);this.open({top:n.clientY+o.top,left:n.clientX+o.left})}function Oie(){this.hot.runHooks("beforeContextMenuShow",this)}function _ie(){this.hot.runHooks("afterContextMenuShow",this)}function xie(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}aS.SEPARATOR={name:dt};function Pie(n){return{key:"copy",name(){return this.getTranslatedPhrase(BI)},callback(){n.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Lie(n){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?Qt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(GI,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Die(n){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?Qt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase($I,t)},callback(){n.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Hie(n){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?Qt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(WI,t)},callback(){n.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Fie(n){return{key:"cut",name(){return this.getTranslatedPhrase(jI)},callback(){n.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}class kie{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class Vie{constructor(){this.clipboardData=new kie}preventDefault(){}}function Uie(n,e){TW(n,e),e.add(n)}function Pc(n,e,t){TW(n,e),e.set(n,t)}function TW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oi(n,e){return n.get(pd(n,e))}function Lc(n,e,t){return n.set(pd(n,e),t),t}function pd(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var xl=new WeakMap,uT=new WeakMap,$f=new WeakMap,dN=new WeakMap,fN=new WeakMap,Gf=new WeakMap,jf=new WeakSet;class Bie{constructor(e){let{countRows:t,countColumns:r,rowsLimit:i,columnsLimit:s,countColumnHeaders:o}=e;Uie(this,jf),Pc(this,xl,void 0),Pc(this,uT,void 0),Pc(this,$f,void 0),Pc(this,dN,void 0),Pc(this,fN,void 0),Pc(this,Gf,void 0),Lc(uT,this,t),Lc($f,this,r),Lc(dN,this,i),Lc(fN,this,s),Lc(Gf,this,o)}setSelectedRange(e){Lc(xl,this,e)}getCellsRange(){if(oi(uT,this).call(this)===0||oi($f,this).call(this)===0)return null;const{row:e,col:t}=oi(xl,this).getTopStartCorner(),{row:r,col:i}=oi(xl,this).getBottomEndCorner(),s=pd(jf,this,Wie).call(this,e,r),o=pd(jf,this,hT).call(this,t,i);return{isRangeTrimmed:r!==s||i!==o,startRow:e,startCol:t,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(oi($f,this).call(this)===0||oi(Gf,this).call(this)===0)return null;const{col:e}=oi(xl,this).getTopStartCorner(),{col:t}=oi(xl,this).getBottomEndCorner(),r=pd(jf,this,hT).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(oi($f,this).call(this)===0||oi(Gf,this).call(this)===0)return null;const{col:e}=oi(xl,this).getTopStartCorner(),{col:t}=oi(xl,this).getBottomEndCorner(),r=pd(jf,this,hT).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-oi(Gf,this).call(this),startCol:e,endRow:-1,endCol:r}}}function hT(n,e){return Math.min(e,Math.max(n+oi(fN,this).call(this)-1,n))}function Wie(n,e){return Math.min(e,Math.max(n+oi(dN,this).call(this)-1,n))}function AW(n){const e=[],t=[];return D(n,r=>{const i=Math.min(r.startRow,r.endRow),s=Math.max(r.startRow,r.endRow);He(i,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);He(o,a,l=>{t.indexOf(l)===-1&&t.push(l)})}),{rows:e,columns:t}}function $ie(n,e){NW(n,e),e.add(n)}function Pl(n,e,t){NW(n,e),e.set(n,t)}function NW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zf(n,e,t){return(e=Gie(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Gie(n){var e=jie(n,"string");return typeof e=="symbol"?e:e+""}function jie(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ii(n,e){return n.get(Mi(n,e))}function Js(n,e,t){return n.set(Mi(n,e),t),t}function Mi(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ie.getSingleton().register("afterCopyLimit");Ie.getSingleton().register("modifyCopyableRange");Ie.getSingleton().register("beforeCut");Ie.getSingleton().register("afterCut");Ie.getSingleton().register("beforePaste");Ie.getSingleton().register("afterPaste");Ie.getSingleton().register("beforeCopy");Ie.getSingleton().register("afterCopy");const fw="copyPaste",zie=80,Yie=["fragmentSelection"],LD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var mN=new WeakMap,gN=new WeakMap,pN=new WeakMap,Dc=new WeakMap,mw=new WeakMap,gw=new WeakMap,Hc=new WeakMap,by=new WeakMap,Ki=new WeakSet;class Kie extends Wt{constructor(){super(...arguments),$ie(this,Ki),zf(this,"columnsLimit",1/0),zf(this,"rowsLimit",1/0),zf(this,"pasteMode","overwrite"),zf(this,"uiContainer",this.hot.rootDocument.body),Pl(this,mN,!1),Pl(this,gN,!1),Pl(this,pN,!1),Pl(this,Dc,"cells-only"),Pl(this,mw,!1),Pl(this,gw,!1),Pl(this,Hc,new Bie({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Pl(this,by,!1),zf(this,"copyableRanges",[])}static get PLUGIN_KEY(){return fw}static get SETTING_KEYS(){return[fw,...Yie]}static get PLUGIN_PRIORITY(){return zie}isEnabled(){return!!this.hot.getSettings()[fw]}enablePlugin(){var e=this;if(this.enabled)return;const{[fw]:t}=this.hot.getSettings();if(typeof t=="object"){var r,i;this.pasteMode=(r=t.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(t.rowsLimit)?this.rowsLimit:t.rowsLimit,this.columnsLimit=isNaN(t.columnsLimit)?this.columnsLimit:t.columnsLimit,Js(mN,this,!!t.copyColumnHeaders),Js(gN,this,!!t.copyColumnGroupHeaders),Js(pN,this,!!t.copyColumnHeadersOnly),this.uiContainer=(i=t.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",s=>Mi(Ki,this,Qie).call(this,s)),this.addHook("afterSelection",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return Mi(Ki,e,Zie).call(e,...o)}),this.addHook("afterSelectionEnd",()=>Mi(Ki,this,Jie).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),pU()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return Mi(Ki,e,ese).call(e,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return Mi(Ki,e,tse).call(e,...o)}),this.addHook("afterSelection",()=>Mi(Ki,this,nse).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Js(Dc,this,e),Js(mw,this,!0),Mi(Ki,this,DD).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Js(gw,this,!0),Mi(Ki,this,DD).call(this,"cut")}getRangedCopyableData(e){return Nm(this.getRangedData(e))}getRangedData(e){const t=[],{rows:r,columns:i}=AW(e);return D(r,s=>{const o=[];D(i,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),t.push(o)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const r=new Vie;e&&r.clipboardData.setData("text/plain",e),t&&r.clipboardData.setData("text/html",t),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Ii(Hc,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);Ii(Dc,this)==="column-headers-only"?t.set("headers",Ii(Hc,this).getMostBottomColumnHeadersRange()):(Ii(Dc,this)==="with-column-headers"?t.set("headers",Ii(Hc,this).getMostBottomColumnHeadersRange()):Ii(Dc,this)==="with-column-group-headers"&&t.set("headers",Ii(Hc,this).getAllColumnHeadersRange()),t.set("cells",Ii(Hc,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=i;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=t.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:s,endRow:o,endCol:a}=r;this.hot.runHooks("afterCopyLimit",o-i+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,s=[],{row:o,col:a}=t.getTopStartCorner(),{row:l,col:u}=t.getBottomEndCorner();let h=o,c=a,d=o,f=a;for(;s.length<r||h<=l;){const{skipRowOnPaste:m,visualRow:p}=this.hot.getCellMeta(h,a);if(h=p+1,m===!0)continue;d=p,c=a;const v=[],y=s.length%r;for(;v.length<i||c<=u;){const{skipColumnOnPaste:S,visualCol:R}=this.hot.getCellMeta(o,c);if(c=R+1,S===!0)continue;f=R;const T=v.length%i;v.push(e[y][T])}s.push(v)}return Js(by,this,!0),this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,d,f]}onCopy(e){var t,r;const i=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input"),o=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight,a=o?this.hot.getCell(o.row,o.col,!0):null;if(!this.hot.isListening()&&!Ii(mw,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body&&a!==e.target))return;e.preventDefault(),this.setCopyableText(),Js(mw,this,!1);const l=this.getRangedData(this.copyableRanges),u=Mi(Ki,this,qie).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",l,this.copyableRanges,u)){const c=Nm(l);if(e&&e.clipboardData){const d=Y1(l,this.hot.rootDocument);e.clipboardData.setData("text/plain",c),e.clipboardData.setData("text/html",[LD,d].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",c);this.hot.runHooks("afterCopy",l,this.copyableRanges,u)}Js(Dc,this,"cells-only")}onCut(e){var t,r;const i=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input"),o=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight,a=o?this.hot.getCell(o.row,o.col,!0):null;if(!this.hot.isListening()&&!Ii(gw,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body&&a!==e.target))return;e.preventDefault(),this.setCopyableText(),Js(gw,this,!1);const l=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",l,this.copyableRanges)){const h=Nm(l);if(e&&e.clipboardData){const c=Y1(l,this.hot.rootDocument);e.clipboardData.setData("text/plain",h),e.clipboardData.setData("text/html",[LD,c].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",h);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",l,this.copyableRanges)}}onPaste(e){var t,r;const i=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input"),o=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight,a=o?this.hot.getCell(o.row,o.col,!0):null;if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body&&a!==e.target))return;e.preventDefault();let l;if(e&&typeof e.clipboardData<"u"){const f=z0(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});f&&/(<table)|(<TABLE)/g.test(f)?l=EX(f,this.hot.rootDocument).data:l=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(l=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof l=="string"&&(l=$7(l)),l===void 0||l&&l.length===0||this.hot.runHooks("beforePaste",l,this.copyableRanges)===!1)return;const[u,h,c,d]=this.populateValues(l);this.hot.selectCell(u,h,Math.min(this.hot.countRows()-1,c),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",l,this.copyableRanges)}destroy(){super.destroy()}}function DD(n){if(pU()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:r}=e.highlight,i=this.hot.getCell(t,r,!0);i&&b4(i,()=>{this.hot.rootDocument.execCommand(n)})}}else this.hot.rootDocument.execCommand(n)}function qie(n){const{rows:e}=AW(n);let t=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)t+=1;return{columnHeadersCount:t}}function Xie(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,r=this.hot.getCell(e,t,!0);r&&cU(r)}}}function IW(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,r=this.hot.getCell(e,t,!0);r!=null&&r.hasAttribute("contenteditable")&&dU(r)}}}function Qie(n){n.items.push({name:"---------"},Pie(this)),Ii(mN,this)&&n.items.push(Hie(this)),Ii(gN,this)&&n.items.push(Die(this)),Ii(pN,this)&&n.items.push(Lie(this)),n.items.push(Fie(this))}function Zie(n,e,t,r,i){Ii(by,this)&&(i.value=!0),Js(by,this,!1)}function Jie(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function ese(){Mi(Ki,this,IW).call(this)}function tse(){Mi(Ki,this,Xie).call(this)}function nse(){Mi(Ki,this,IW).call(this)}function MW(n,e){return`border_row${n}col${e}`}function wm(){return{width:1,color:"#000"}}function rl(){return{hide:!0}}function rse(){return{width:1,color:"#000",cornerVisible:!1}}function cT(n){if(_e(n.start)||_e(n.left)){var e;n.start=(e=n.start)!==null&&e!==void 0?e:n.left}if(_e(n.end)||_e(n.right)){var t;n.end=(t=n.end)!==null&&t!==void 0?t:n.right}return delete n.left,delete n.right,n}function Yf(n){return _e(n.start)&&(n.left=n.start),_e(n.end)&&(n.right=n.end),n}function dT(n,e){return{id:MW(n,e),border:rse(),row:n,col:e,top:rl(),bottom:rl(),start:rl(),end:rl()}}function ise(n,e){return Ln(e,"border")&&e.border&&(n.border=e.border),Ln(e,"top")&&_e(e.top)&&(e.top?(mt(e.top)||(e.top=wm()),n.top=e.top):(e.top=rl(),n.top=e.top)),Ln(e,"bottom")&&_e(e.bottom)&&(e.bottom?(mt(e.bottom)||(e.bottom=wm()),n.bottom=e.bottom):(e.bottom=rl(),n.bottom=e.bottom)),Ln(e,"start")&&_e(e.start)&&(e.start?(mt(e.start)||(e.start=wm()),n.start=e.start):(e.start=rl(),n.start=e.start)),Ln(e,"end")&&_e(e.end)&&(e.end?(mt(e.end)||(e.end=wm()),n.end=e.end):(e.end=rl(),n.end=e.end)),n}function ml(n,e){let t=!1;return D(n.getSelectedRange(),r=>{r.forAll((i,s)=>{if(i<0||s<0)return;const o=n.getCellMeta(i,s).borders;if(o)if(e){if(!Ln(o[e],"hide")||o[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function lS(n){return`<span class="selected">✓</span>${n}`}function sse(n){return n.some(e=>_e(e.left)||_e(e.right))}function ose(n){return n.some(e=>_e(e.start)||_e(e.end))}const ase=new Map([["left","start"],["right","end"]]);function lse(n){var e;return(e=ase.get(n))!==null&&e!==void 0?e:n}function use(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(iM);return ml(this,"bottom")&&(e=lS(e)),e},callback(e,t){const r=ml(this,"bottom");n.prepareBorder(t,"bottom",r)}}}function hse(n){const e=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(sM);return ml(this,e)&&(t=lS(t)),t},callback(t,r){const i=ml(this,e);n.prepareBorder(r,e,i)}}}function cse(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(oM)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!ml(this)}}}function dse(n){const e=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(rM);return ml(this,e)&&(t=lS(t)),t},callback(t,r){const i=ml(this,e);n.prepareBorder(r,e,i)}}}function fse(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(nM);return ml(this,"top")&&(e=lS(e)),e},callback(e,t){const r=ml(this,"top");n.prepareBorder(t,"top",r)}}}function mse(n,e){gse(n,e),e.add(n)}function gse(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pse(n,e,t){return(e=wse(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wse(n){var e=vse(n,"string");return typeof e=="symbol"?e:e+""}function vse(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function HD(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Av="customBorders",yse=90;var fT=new WeakSet;class Cse extends Wt{constructor(){super(...arguments),mse(this,fT),pse(this,"savedBorders",[])}static get PLUGIN_KEY(){return Av}static get PLUGIN_PRIORITY(){return yse}isEnabled(){return!!this.hot.getSettings()[Av]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>HD(fT,this,Sse).call(this,e)),this.addHook("init",()=>HD(fT,this,Rse).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let r=["top","bottom","start","end"],i=null;t&&(this.checkSettingsCohesion([t]),r=Object.keys(t),i=cT(t));const s=Vd(e),o=hg(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});D(e,a=>{o(a).forAll((l,u)=>{D(r,h=>{this.prepareBorderFromCustomAdded(l,u,i,lse(h))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=Vd(e),r=hg(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return D(e,s=>{r(s).forAll((o,a)=>{D(this.savedBorders,l=>{l.row===o&&l.col===a&&i.push(Yf(l))})})}),i}clearBorders(e){e?this.setBorders(e):(D(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,t,r,i){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||t>=o)return;let a=dT(e,t);r&&(a=ise(a,r),D(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",Yf(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,t){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);He(e.from.row,r,s=>{He(e.from.col,i,o=>{const a=dT(s,o);let l=0;s===e.from.row&&Ln(t,"top")&&(l+=1,a.top=t.top),s===e.to.row&&Ln(t,"bottom")&&(l+=1,a.bottom=t.bottom),o===e.from.col&&Ln(t,"start")&&(l+=1,a.start=t.start),o===e.to.col&&Ln(t,"end")&&(l+=1,a.end=t.end),l>0&&(this.hot.setCellMeta(s,o,"borders",Yf(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,t){const r=MW(e,t);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,r,i){let s=this.hot.getCellMeta(e,t).borders;!s||s.border===void 0?s=dT(e,t):s=cT(s),i?(s[r]=rl(),this.countHide(s)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,t,"borders",Yf(s)))):(s[r]=wm(),this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,t,"borders",Yf(s)))}prepareBorder(e,t,r){D(e,i=>{let{start:s,end:o}=i;if(s.row===o.row&&s.col===o.col)t==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,t,r);else switch(t){case"noBorders":He(s.col,o.col,a=>{He(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":He(s.col,o.col,a=>{this.setBorder(s.row,a,t,r)});break;case"bottom":He(s.col,o.col,a=>{this.setBorder(o.row,a,t,r)});break;case"start":He(s.row,o.row,a=>{this.setBorder(a,s.col,t,r)});break;case"end":He(s.row,o.row,a=>{this.setBorder(a,o.col,t,r)});break}})}createCustomBorders(e){D(e,t=>{const r=cT(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,r):this.prepareBorderFromCustomAdded(t.row,t.col,r)})}countHide(e){const{top:t,bottom:r,start:i,end:s}=e;return gi([t,r,i,s],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const t=bt(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){D(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){D(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=bt(this.savedBorders,r=>r.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):D(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,r){let i=!1;return D(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return D(o,a=>{a.toggleHiddenClass(t,r)}),i=!0,!1}}),i}checkCustomSelections(e,t,r){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):D(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=t,o.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);D(a,l=>{l.changeBorderStyle(r,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[Av];if(Array.isArray(e)){const t=mi(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=sse(e),r=ose(e);if(t&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Sse(n){this.hot.getSettings()[Av]&&n.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(tM)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[fse(this),dse(this),use(this),hse(this),cse(this)]}})}function Rse(){this.changeBorderSettings()}function Ese(n,e){bse(n,e),e.add(n)}function bse(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mT(n,e,t){return(e=Tse(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Tse(n){var e=Ase(n,"string");return typeof e=="symbol"?e:e+""}function Ase(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function FD(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const kD="dragToScroll",Nse=100;var gT=new WeakSet;class Ise extends Wt{constructor(){super(...arguments),Ese(this,gT),mT(this,"boundaries",null),mT(this,"callback",null),mT(this,"listening",!1)}static get PLUGIN_KEY(){return kD}static get PLUGIN_PRIORITY(){return Nse}isEnabled(){return!!this.hot.getSettings()[kD]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>FD(gT,this,VD).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>FD(gT,this,VD).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let r=0,i=0;t<this.boundaries.top?i=t-this.boundaries.top:t>this.boundaries.bottom&&(i=t-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",r=>this.onMouseMove(r)),t=Hd(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function VD(n){if($h(n))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,r)=>{var i,s;const o=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(t)*50,a+Math.sign(r)*20)}),this.listen()}function Mse(n,e){OW(n,e),e.add(n)}function Ose(n,e,t){OW(n,e),e.set(n,t)}function OW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pT(n,e,t){return(e=_se(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _se(n){var e=xse(n,"string");return typeof e=="symbol"?e:e+""}function xse(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Pse(n,e){return n.get(ys(n,e))}function _W(n,e,t){return n.set(ys(n,e),t),t}function ys(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ie.getSingleton().register("afterDropdownMenuDefaultOptions");Ie.getSingleton().register("beforeDropdownMenuShow");Ie.getSingleton().register("afterDropdownMenuShow");Ie.getSingleton().register("afterDropdownMenuHide");Ie.getSingleton().register("afterDropdownMenuExecute");const Nv="dropdownMenu",Lse=230,gg="changeType",wT=Nv;var uS=new WeakMap,to=new WeakSet;class hS extends Wt{static get PLUGIN_KEY(){return Nv}static get PLUGIN_PRIORITY(){return Lse}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Jg,ep,dt,np,dt,eS,dt,tp,dt,vs]}constructor(e){super(e),Mse(this,to),pT(this,"commandExecutor",new vW(this.hot)),pT(this,"itemsFactory",null),pT(this,"menu",null),Ose(this,uS,!1),this.hot.addHook("afterGetColHeader",(t,r)=>ys(to,this,Hse).call(this,t,r))}isEnabled(){return this.hot.getSettings()[Nv]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new yW(this.hot,hS.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ys(to,e,Wse).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ys(to,e,Bse).call(e,...s)});const t=this.hot.getSettings()[Nv],r={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new sf(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>ys(to,this,Fse).call(this)),this.menu.addLocalHook("afterOpen",()=>ys(to,this,kse).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>ys(to,this,Vse).call(this,s)),this.menu.addLocalHook("afterClose",()=>ys(to,this,Use).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),D(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),s=JC(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,i.col,!0).querySelector(`.${gg}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:wT},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:wT}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wT)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>ys(to,this,Dse).call(this,e))}open(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(t=this.menu)!==null&&t!==void 0&&t.isOpened()||(this.menu.open(),gt(r,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function xW(n){n.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Dse(n){if(Je(n.target,gg)){const e=JC(this.menu.container,this.hot.rootDocument),t=n.target.getBoundingClientRect();n.stopPropagation(),_W(uS,this,!1),this.open({left:t.left+e.left,top:t.top+n.target.offsetHeight+e.top},{left:t.width,right:0,above:0,below:3})}}function Hse(n,e){const t=e.parentNode;if(!t)return;const r=t.parentNode.childNodes,i=Array.prototype.indexOf.call(r,t);if(n<0||i!==r.length-1)return;const s=e.querySelector(`.${gg}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=gg,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(Xe(o,[ac(),ey(" ")]),Xe(e,[ZV("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function Fse(){this.hot.runHooks("beforeDropdownMenuShow",this)}function kse(){this.hot.runHooks("afterDropdownMenuShow",this),ys(to,this,xW).call(this,this.menu)}function Vse(n){ys(to,this,xW).call(this,n)}function Use(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Bse(n){return Pse(uS,this)?null:n}function Wse(n){Je(n.target,gg)&&_W(uS,this,!0)}hS.SEPARATOR={name:dt};function UD(n,e,t){return(e=$se(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $se(n){var e=Gse(n,"string");return typeof e=="symbol"?e:e+""}function Gse(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class jse{constructor(e){UD(this,"hot",void 0),UD(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:r,endCol:i}=this._getDataRange(),s=this.options,o=[];return He(e,r,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(He(t,i,u=>{!s.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();He(t,r,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();He(t,r,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[r=0,i=0,s=t,o=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),s=Math.min(s,t),o=Math.min(o,e),{startRow:r,startCol:i,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function BD(n,e,t){return(e=zse(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zse(n){var e=Yse(n,"string");return typeof e=="symbol"?e:e+""}function Yse(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class gO{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){BD(this,"dataProvider",void 0),BD(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=wa(this.constructor.DEFAULT_OPTIONS);const r=new Date;return t=ir(wa(gO.DEFAULT_OPTIONS),t),t=ir(t,e),t.filename=qV(t.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),t}}const Kse="\r",qse='"',Xse=`
`;class Qse extends gO{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=bt(r,l=>this._escapeCell(l,!0)),o&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),D(t,(l,u)=>{u>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[u])+e.columnDelimiter),a+=l.map(h=>this._escapeCell(h)).join(e.columnDelimiter)}),a}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Zn(e);return r!==""&&(t||r.indexOf(Kse)>=0||r.indexOf(qse)>=0||r.indexOf(Xse)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const Zse="csv",wN={[Zse]:Qse};function Jse(n,e,t){return typeof wN[n]=="function"?new wN[n](e,t):null}const eoe="exportFile",toe=240;class noe extends Wt{static get PLUGIN_KEY(){return eoe}static get PLUGIN_PRIORITY(){return toe}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,t),o=this._createBlob(s),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const h=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",h),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(h)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,u)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!wN[e])throw new Error(`Export format type "${e}" is not supported.`);return Jse(e,new jse(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function Fc(n,e,t){return(e=roe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function roe(n){var e=ioe(n,"string");return typeof e=="symbol"?e:e+""}function ioe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class rp{constructor(e,t){let{id:r,stateless:i=!0}=t;Fc(this,"hot",void 0),Fc(this,"id",void 0),Fc(this,"elements",[]),Fc(this,"hidden",!1),Fc(this,"stateId",""),Fc(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new jC)}getElements(){return this.elements}reset(){D(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),D(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}en(rp,Br);const pg={};function yu(n,e){if(!pg[n])throw Error(`Filter condition "${n}" does not exist.`);const{condition:t,descriptor:r}=pg[n];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(s){return t.apply(s.meta.instance,[].concat([s],[i]))}}function xh(n){if(!pg[n])throw Error(`Filter condition "${n}" does not exist.`);return pg[n].descriptor}function tr(n,e,t){t.key=n,pg[n]={condition:e,descriptor:t}}const Rr="none";function soe(){return!0}tr(Rr,soe,{name:zC,inputsCount:0,showOperators:!1});const xm="empty";function ooe(n){return Gn(n.value)}tr(xm,ooe,{name:fM,inputsCount:0,showOperators:!0});const Iv="not_empty";function aoe(n,e){return!yu(xm,e)(n)}tr(Iv,aoe,{name:mM,inputsCount:0,showOperators:!0});const Pm="eq";function loe(n,e){let[t]=e;return Zn(n.value).toLocaleLowerCase(n.meta.locale)===Zn(t)}tr(Pm,loe,{name:gM,inputsCount:1,showOperators:!0});const Mv="neq";function uoe(n,e){return!yu(Pm,e)(n)}tr(Mv,uoe,{name:pM,inputsCount:1,showOperators:!0});const PW="gt";function hoe(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>r}tr(PW,hoe,{name:SM,inputsCount:1,showOperators:!0});const LW="gte";function coe(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>=r}tr(LW,coe,{name:RM,inputsCount:1,showOperators:!0});const DW="lt";function doe(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<r}tr(DW,doe,{name:EM,inputsCount:1,showOperators:!0});const HW="lte";function foe(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<=r}tr(HW,foe,{name:bM,inputsCount:1,showOperators:!0});const pO="date_after";function moe(n,e){let[t]=e;const r=le(n.value,n.meta.dateFormat),i=le(t,n.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}tr(pO,moe,{name:NM,inputsCount:1,showOperators:!0});const wO="date_before";function goe(n,e){let[t]=e;const r=le(n.value,n.meta.dateFormat),i=le(t,n.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}tr(wO,goe,{name:IM,inputsCount:1,showOperators:!0});const Ty="between";function poe(n,e){let[t,r]=e,i=t,s=r;if(n.meta.type==="numeric"){const o=parseFloat(i,10),a=parseFloat(s,10);i=Math.min(o,a),s=Math.max(o,a)}else if(n.meta.type==="date"){const o=yu(wO,[s]),a=yu(pO,[i]);return o(n)&&a(n)}return n.value>=i&&n.value<=s}tr(Ty,poe,{name:TM,inputsCount:2,showOperators:!0});const FW="not_between";function woe(n,e){return!yu(Ty,e)(n)}tr(FW,woe,{name:AM,inputsCount:2,showOperators:!0});const kW="begins_with";function voe(n,e){let[t]=e;return Zn(n.value).toLocaleLowerCase(n.meta.locale).startsWith(Zn(t))}tr(kW,voe,{name:wM,inputsCount:1,showOperators:!0});const VW="ends_with";function yoe(n,e){let[t]=e;return Zn(n.value).toLocaleLowerCase(n.meta.locale).endsWith(Zn(t))}tr(VW,yoe,{name:vM,inputsCount:1,showOperators:!0});const vO="contains";function Coe(n,e){let[t]=e;return Zn(n.value).toLocaleLowerCase(n.meta.locale).indexOf(Zn(t))>=0}tr(vO,Coe,{name:yM,inputsCount:1,showOperators:!0});const UW="not_contains";function Soe(n,e){return!yu(vO,e)(n)}tr(UW,Soe,{name:CM,inputsCount:1,showOperators:!0});const BW="date_tomorrow";function Roe(n){const e=le(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(le().subtract(-1,"days").startOf("day"),"d"):!1}tr(BW,Roe,{name:OM,inputsCount:0});const WW="date_today";function Eoe(n){const e=le(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(le().startOf("day"),"d"):!1}tr(WW,Eoe,{name:MM,inputsCount:0});const $W="date_yesterday";function boe(n){const e=le(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(le().subtract(1,"days").startOf("day"),"d"):!1}tr($W,boe,{name:_M,inputsCount:0});x4();function Toe(n,e){let t=n;return t===""&&(t=`(${e})`),t}const vN=new Set([1]).has(1),Aoe=vN&&typeof Array.from=="function";function ip(n){let e=n;return vN&&(e=new Set(e)),function(t){let r;return vN?r=e.has(t):r=!!~e.indexOf(t),r}}function GW(n){return n??""}function yN(n){let e=n;return Aoe?e=Array.from(new Set(e)):e=zV(e),e=e.sort((t,r)=>typeof t=="number"&&typeof r=="number"?t-r:t===r?0:t>r?1:-1),e}function WD(n,e,t,r){const i=[],s=n===e;let o;return s||(o=ip(e)),D(n,a=>{let l=!1;(s||o(a))&&(l=!0);const u={checked:l,value:a,visualValue:Toe(a,t)};r&&r(u),i.push(u)}),i}const Ph="by_value";function Noe(n,e){let[t]=e;return t(n.value)}tr(Ph,Noe,{name:"By value",inputsCount:0,inputValuesDecorator(n){let[e]=n;return[ip(e)]},showOperators:!1});const wg={};function Ioe(n){if(!wg[n])throw Error(`Operation with id "${n}" does not exist.`);const e=wg[n].func;return function(t,r){return e(t,r)}}function Moe(n){return wg[n].name}function yO(n,e,t){wg[n]={name:e,func:t}}const fu="conjunction",Ooe=LM;function _oe(n,e){return n.every(t=>t.func(e))}yO(fu,Ooe,_oe);const Ay="disjunction",xoe=YC;function Poe(n,e){return n.some(t=>t.func(e))}yO(Ay,xoe,Poe);const CO="disjunctionWithExtraCondition",Loe=YC;function Doe(n,e){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(t=>t.func(e))&&n[n.length-1].func(e)}yO(CO,Loe,Doe);const Hoe="numeric",jW="text",Foe="date",$D={[Hoe]:[Rr,dt,xm,Iv,dt,Pm,Mv,dt,PW,LW,DW,HW,Ty,FW],[jW]:[Rr,dt,xm,Iv,dt,Pm,Mv,dt,kW,VW,dt,vO,UW],[Foe]:[Rr,dt,xm,Iv,dt,Pm,Mv,dt,wO,pO,Ty,dt,BW,WW,$W]};function koe(n){const e=[];let t=n;return $D[t]||(t=jW),D($D[t],r=>{let i;r===dt?i={name:dt}:i=wa(xh(r)),e.push(i)}),e}function Kf(n,e,t){return(e=Voe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Voe(n){var e=Uoe(n,"string");return typeof e=="symbol"?e:e+""}function Uoe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const vT="built",yT="building",GD=["click","input","keydown","keypress","keyup","focus","blur","change"];let go=class zW{static get DEFAULTS(){return wa({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){Kf(this,"hot",void 0),Kf(this,"eventManager",new Co(this)),Kf(this,"options",void 0),Kf(this,"_element",void 0),Kf(this,"buildState",void 0),this.hot=e,this.options=ir(zW.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===yT?this._element:this.buildState===vT?(this.update(),this._element):(this.buildState=yT,this.build(),this.buildState=vT,this._element)}isBuilt(){return this.buildState===vT}translateIfPossible(e){return typeof e=="string"&&e.startsWith(pi)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,r)=>{this.eventManager.addEventListener(t,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=yT),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&ue(this._element,this.options.className),this.options.children.length)D(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),gt(this.options,(r,i)=>{t[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(t[i]=this.translateIfPossible(r))}),this._element.appendChild(t),D(GD,r=>e(t,r))}else D(GD,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};en(go,Br);function Boe(n,e){YW(n,e),e.add(n)}function Woe(n,e,t){YW(n,e),e.set(n,t)}function YW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pw(n,e){return n.get(SO(n,e))}function $oe(n,e,t){return n.set(SO(n,e),t),t}function SO(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var kc=new WeakMap,jD=new WeakSet;class mu extends go{static get DEFAULTS(){return wa({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,ir(mu.DEFAULTS,t)),Boe(this,jD),Woe(this,kc,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>SO(jD,this,Goe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");$oe(kc,this,this._element.firstChild),ue(this._element,"htUIInput"),ue(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(pw(kc,this).type=this.options.type,pw(kc,this).placeholder=this.translateIfPossible(this.options.placeholder),pw(kc,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&pw(kc,this).focus()}}function Goe(n){this.options.value=n.target.value}function joe(n,e){KW(n,e),e.add(n)}function qf(n,e,t){KW(n,e),e.set(n,t)}function KW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vc(n,e,t){return n.set(Lm(n,e),t),t}function An(n,e){return n.get(Lm(n,e))}function Lm(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ur=new WeakMap,ww=new WeakMap,vw=new WeakMap,CT=new WeakMap,yw=new WeakMap,Cw=new WeakSet;class vg extends go{static get DEFAULTS(){return wa({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,ir(vg.DEFAULTS,t)),joe(this,Cw),qf(this,ur,null),qf(this,ww,[]),qf(this,vw,void 0),qf(this,CT,void 0),qf(this,yw,void 0),this.registerHooks()}getMenu(){return An(ur,this)}registerHooks(){this.addLocalHook("click",()=>Lm(Cw,this,Koe).call(this))}setItems(e){Vc(ww,this,this.translateNames(e)),An(ur,this)&&An(ur,this).setMenuItems(An(ww,this))}translateNames(e){return D(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),Vc(ur,this,new sf(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),An(ur,this).setMenuItems(An(ww,this));const e=new go(this.hot,{className:"htUISelectCaption"}),t=new go(this.hot,{className:"htUISelectDropdown"});Vc(vw,this,e),Vc(CT,this,e.element),Vc(yw,this,t),this.hot.getSettings().ariaTags&&(Xe(t.element,[ac()]),Xe(this._element,[QV()])),D([e,t],r=>this._element.appendChild(r.element)),An(ur,this).addLocalHook("select",r=>Lm(Cw,this,zoe).call(this,r)),An(ur,this).addLocalHook("afterClose",()=>Lm(Cw,this,Yoe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=An(ur,this).hot.getTranslatedPhrase(zC),An(CT,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();An(ur,this)&&(An(ur,this).open(),An(ur,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),An(ur,this).getNavigator().toFirstItem(),An(ur,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){An(ur,this)&&An(ur,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){An(ur,this)&&(An(ur,this).destroy(),Vc(ur,this,null)),An(vw,this)&&An(vw,this).destroy(),An(yw,this)&&An(yw,this).destroy(),super.destroy()}}function zoe(n){n.name!==dt&&(this.options.value=n,this.update(),this.runLocalHooks("select",this.options.value))}function Yoe(){this.runLocalHooks("afterClose")}function Koe(){this.openOptions()}function qoe(n,e){Xoe(n,e),e.add(n)}function Xoe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zD(n,e,t){return(e=Qoe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Qoe(n){var e=Zoe(n,"string");return typeof e=="symbol"?e:e+""}function Zoe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function YD(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ST=new WeakSet;class CN extends rp{constructor(e,t){super(e,{id:t.id,stateless:!1}),qoe(this,ST),zD(this,"name",""),zD(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new vg(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new mu(this.hot,{placeholder:UM})),this.elements.push(new mu(this.hot,{placeholder:BM})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>YD(ST,this,Joe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),D(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>YD(ST,this,eae).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=wa(e.command);t.name.startsWith(Hn)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),D(e.args,(r,i)=>{if(i>t.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(r),s[t.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||xh(Rr),t=[];return D(this.getInputElements(),(r,i)=>{e.inputsCount>i&&t.push(r.getValue())}),{command:e,args:t}}updateState(e,t){const r=xh(e?e.name:Rr);this.state.setValueAtIndex(t,{command:r,args:e?e.args:[]}),e||D(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof vg)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof mu)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,i,s,o)=>{ue(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ue(t.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return ue(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||D(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[xh(Rr)];if(e!==null){const{visualIndex:r}=e;t=koe(this.hot.getDataType(0,r,this.hot.countRows(),r))}D(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function Joe(n){D(this.getInputElements(),(e,t)=>{e[n.inputsCount>t?"show":"hide"](),t===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",n)}function eae(n){zg(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),To(n))}function KD(n,e,t){tae(n,e),e.set(n,t)}function tae(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xf(n,e){return n.get(qW(n,e))}function qD(n,e,t){return n.set(qW(n,e),t),t}function qW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Uc=new WeakMap,RT=new WeakMap;class Ny extends go{static get DEFAULTS(){return wa({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,ir(Ny.DEFAULTS,t)),KD(this,Uc,void 0),KD(this,RT,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),qD(RT,this,e),qD(Uc,this,this._element.firstChild),Xf(Uc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Xf(RT,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Xf(Uc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Xf(Uc,this).checked=e)}focus(){this.isBuilt()&&Xf(Uc,this).focus()}}function nae(n,e){rae(n,e),e.add(n)}function rae(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iae(n,e,t){return(e=sae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sae(n){var e=oae(n,"string");return typeof e=="symbol"?e:e+""}function oae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function aae(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const XD=0;var QD=new WeakSet;class lae extends rp{constructor(e,t){super(e,{id:t.id,stateless:!1}),nae(this,QD),iae(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(ue(t.parentNode,"htFiltersMenuOperators"),D(this.elements,r=>t.appendChild(r.element)),t)}}buildOperatorsElement(){const e=[fu,Ay];D(e,t=>{const r=new Ny(this.hot,{name:"operator",label:{htmlFor:t,textContent:Moe(t)},value:t,checked:t===e[XD],id:t});r.addLocalHook("change",i=>aae(QD,this,uae).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(Yt`Radio button with index ${e} doesn't exist.`);D(this.elements,(t,r)=>{t.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof Ny&&t.isChecked());return e?e.getValue():fu}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&D(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fu,t=arguments.length>1?arguments[1]:void 0,r=e;r===CO&&(r=Ay),this.state.setValueAtIndex(t,r)}reset(){this.setChecked(XD)}}function uae(n){this.setState(n.target.value)}function hae(n,e,t){cae(n,e),e.set(n,t)}function cae(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ET(n,e){return n.get(XW(n,e))}function dae(n,e,t){return n.set(XW(n,e),t),t}function XW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Qf=new WeakMap;class yg extends go{static get DEFAULTS(){return wa({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,ir(yg.DEFAULTS,t)),hae(this,Qf,void 0)}build(){super.build(),dae(Qf,this,this._element.firstChild)}update(){this.isBuilt()&&(ET(Qf,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&ET(Qf,this).focus()}activate(){ET(Qf,this).click()}}function fae(n,e){QW(n,e),e.add(n)}function Bc(n,e,t){QW(n,e),e.set(n,t)}function QW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function at(n,e){return n.get(wd(n,e))}function Ks(n,e,t){return n.set(wd(n,e),t),t}function wd(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const ZD="multipleSelect.itemBox";var no=new WeakMap,Kn=new WeakMap,bT=new WeakMap,Va=new WeakMap,Ll=new WeakMap,Dl=new WeakMap,Zf=new WeakSet;class Cg extends go{static get DEFAULTS(){return wa({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,ir(Cg.DEFAULTS,t)),fae(this,Zf),Bc(this,no,[]),Bc(this,Kn,void 0),Bc(this,bT,void 0),Bc(this,Va,void 0),Bc(this,Ll,void 0),Bc(this,Dl,void 0),Ks(Va,this,new mu(this.hot,{placeholder:VM,className:"htUIMultipleSelectSearch"})),Ks(Ll,this,new yg(this.hot,{textContent:DM,className:"htUISelectAll"})),Ks(Dl,this,new yg(this.hot,{textContent:HM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return at(Kn,this)}registerHooks(){at(Va,this).addLocalHook("keydown",e=>wd(Zf,this,gae).call(this,e)),at(Va,this).addLocalHook("input",e=>wd(Zf,this,mae).call(this,e)),at(Ll,this).addLocalHook("click",e=>wd(Zf,this,pae).call(this,e)),at(Dl,this).addLocalHook("click",e=>wd(Zf,this,wae).call(this,e))}setItems(e){var t;Ks(no,this,e),(t=at(Kn,this))===null||t===void 0||t.loadData(at(no,this))}setLocale(e){Ks(bT,this,e)}getLocale(){return at(bT,this)}getItems(){return[...at(no,this)]}getValue(){return yae(at(no,this))}getSearchInputElement(){return at(Va,this)}getSelectAllElement(){return at(Ll,this)}getClearAllElement(){return at(Dl,this)}isSelectedAllValues(){return at(no,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),r=new go(this.hot,{className:"htUISelectionControls",children:[at(Ll,this),at(Dl,this)]});this._element.appendChild(at(Va,this).element),this._element.appendChild(r.element),this._element.appendChild(t);const i=s=>{var o;if(!this._element)return;(o=at(Kn,this))===null||o===void 0||o.destroy(),ue(s,"htUIMultipleSelectHot"),Ks(Kn,this,new this.hot.constructor(s,{data:at(no,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,h,c,d,f,m)=>{u.title=m.instance.getDataAtRowProp(h,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{at(Kn,this).listen()},colWidths:()=>at(Kn,this).container.scrollWidth-Tr(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),at(Kn,this).init();const l=at(Kn,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:ZD}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{at(Kn,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:ZD})};i(t),this.hot._registerTimeout(()=>i(t),100)}focus(){this.isBuilt()&&at(Kn,this).listen()}reset(){at(Va,this).reset(),at(Ll,this).reset(),at(Dl,this).reset()}update(){this.isBuilt()&&(at(Kn,this).loadData(vae(at(no,this),this.options.value)),super.update())}destroy(){var e;(e=at(Kn,this))===null||e===void 0||e.destroy(),at(Va,this).destroy(),at(Dl,this).destroy(),at(Ll,this).destroy(),Ks(Va,this,null),Ks(Dl,this,null),Ks(Ll,this,null),Ks(Kn,this,null),Ks(no,this,null),super.destroy()}}function mae(n){const e=n.target.value.toLocaleLowerCase(this.getLocale());let t;e===""?t=[...at(no,this)]:t=at(no,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),at(Kn,this).loadData(t)}function gae(n){this.runLocalHooks("keydown",n,this),fU(zg,n.keyCode)("ARROW_DOWN")&&(n.preventDefault(),To(n),at(Kn,this).listen(),at(Kn,this).selectCell(0,0))}function pae(n){const e=[];n.preventDefault(),at(Kn,this).getSourceData().forEach((t,r)=>{t.checked=!0,e.push(QU(t,r)[0])}),at(Kn,this).setSourceDataAtCell(e)}function wae(n){const e=[];n.preventDefault(),at(Kn,this).getSourceData().forEach((t,r)=>{t.checked=!1,e.push(QU(t,r)[0])}),at(Kn,this).setSourceDataAtCell(e)}function vae(n,e){const t=ip(e);return n.map(r=>(r.checked=t(r.value),r))}function yae(n){const e=[];return n.forEach(t=>{t.checked&&e.push(t.value)}),e}function Cae(n,e){Sae(n,e),e.add(n)}function Sae(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rae(n,e,t){return(e=Eae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Eae(n){var e=bae(n,"string");return typeof e=="symbol"?e:e+""}function bae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Sw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Jf=new WeakSet;class Tae extends rp{constructor(e,t){super(e,{id:t.id,stateless:!1}),Cae(this,Jf),Rae(this,"name",""),this.name=t.name,this.elements.push(new Cg(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Sw(Jf,this,Aae).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>Sw(Jf,this,Nae).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Ph){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?Rr:Ph},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(r,i,s,o,a)=>{const[l]=vu(i,c=>c.name===Ph),u={},h=this.hot.getTranslatedPhrase(fy);if(l){const c=o(r,a),d=bt(c,S=>S.value),f=new Map(c.map(S=>[S.value,this.hot.getCellMeta(S.meta.visualRow,S.meta.visualCol)])),m=yN(d);s&&(l.args[0]=s);const p=[],v=WD(m,l.args[0],h,S=>{S.checked&&p.push(S.value),Sw(Jf,this,JD).call(this,S,f)}),y=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,y).locale,u.args=[p],u.command=xh(Ph),u.itemsSnapshot=v}else u.args=[],u.command=xh(Rr);this.state.setValueAtIndex(r,u)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Cg)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,i,s,o)=>{ue(t.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return ue(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||D(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(fy),t=this._getColumnVisibleValues(),r=t.map(l=>l.value),i=new Map(t.map(l=>[l.value,l.meta])),s=yN(r),o=WD(s,s,e,l=>{Sw(Jf,this,JD).call(this,l,i)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:bt(this.hot.getDataAtCol(e.visualIndex),(t,r)=>({value:GW(t),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function Aae(n){zg(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),To(n))}function JD(n,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(n.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",n.visualValue,e.get(n.value)))}function Nae(n,e){return e.type==="numeric"?GB(n,e):n}var ZW;function Iae(n,e){Mae(n,e),e.add(n)}function Mae(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oae(n,e,t){return(e=_ae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _ae(n){var e=xae(n,"string");return typeof e=="symbol"?e:e+""}function xae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Pae(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var eH=new WeakSet;class Sg extends rp{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),Iae(this,eH),Oae(this,"name",""),this.name=t.name,this.elements.push(new mu(this.hot,{type:"button",value:FM,className:"htUIButton htUIButtonOK",identifier:Sg.BUTTON_OK})),this.elements.push(new mu(this.hot,{type:"button",value:kM,className:"htUIButton htUIButtonCancel",identifier:Sg.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){D(this.elements,e=>{e.addLocalHook("click",(t,r)=>Pae(eH,this,Lae).call(this,t,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(ue(t.parentNode,"htFiltersMenuActionBar"),D(this.elements,r=>t.appendChild(r.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}ZW=Sg;function Lae(n,e){e.options.identifier===ZW.BUTTON_OK?this.accept():this.cancel()}function Rw(n,e,t){return(e=Dae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Dae(n){var e=Hae(n,"string");return typeof e=="symbol"?e:e+""}function Hae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const tH="ConditionCollection.filteringStates";class RO{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Rw(this,"hot",void 0),Rw(this,"isMapRegistrable",void 0),Rw(this,"filteringStates",new jC),Rw(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=t,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(tH,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var r;const i=this.filteringStates.getValueAtIndex(t),s=(r=i?.conditions)!==null&&r!==void 0?r:[],o=i?.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fu;return e.length?Ioe(r)(e,t):!0}addCondition(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fu,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=bt(t.args,h=>typeof h=="string"?h.toLocaleLowerCase(s):h),a=t.name||t.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(Yt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(mn(wg[r]))throw new Error(Yt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:o,func:yu(a,o)}]},i):u.push({name:a,args:o,func:yu(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,r;return(t=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return gi(this.filteringStates.getEntries(),(e,t)=>{let[r,{operation:i,conditions:s}]=t;return e.push({column:r,operation:i,conditions:bt(s,o=>{let{name:a,args:l}=o;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),D(e,t=>{D(t.conditions,r=>this.addCondition(t.column,r))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const r=this.getConditions(e);return t?r.some(i=>i.name===t):r.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(tH),this.filteringStates=null,this.clearLocalHooks()}}en(RO,Br);function nH(n,e,t){return(e=Fae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Fae(n){var e=kae(n,"string");return typeof e=="symbol"?e:e+""}function kae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class JW{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];nH(this,"conditionCollection",void 0),nH(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return D(this.conditionCollection.getFilteredColumns(),(t,r)=>{let i=this.columnDataFactory(t);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(t,i)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return D(t,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,t){const r=[];return D(t,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(r[s]=e[s])}),r}}function Vae(n,e){Uae(n,e),e.add(n)}function Uae(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eh(n,e,t){return(e=Bae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Bae(n){var e=Wae(n,"string");return typeof e=="symbol"?e:e+""}function Wae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function TT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ew=new WeakSet;class e${constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Vae(this,Ew),eh(this,"hot",void 0),eh(this,"conditionCollection",void 0),eh(this,"columnDataFactory",void 0),eh(this,"changes",[]),eh(this,"grouping",!1),eh(this,"latestEditedColumnPosition",-1),eh(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>TT(Ew,this,$ae).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>TT(Ew,this,Gae).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>TT(Ew,this,jae).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,D(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=i.slice(0,s),a=i.slice(s);a.length&&a[0].column===e&&a.shift();const l=T4(function(h,c){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new RO(r.hot,!1),m=[].concat(h,d);f.importAllConditions(m);const p=r.columnDataFactory(c);let v;f.isEmpty()?v=p:v=new JW(f,S=>r.columnDataFactory(S)).filter(),v=bt(v,S=>S.meta.visualRow);const y=ip(v);return f.destroy(),vu(p,S=>y(S.meta.visualRow))})(o),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),gt(this,(e,t)=>{this[t]=null})}}function $ae(n){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(n)}function Gae(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function jae(){D(this.latestOrderStack,n=>{this.updateStatesAtColumn(n)})}en(e$,Br);function zae(n){return SW({initialPage:0,size:()=>n.length,onItemSelect:(t,r)=>{const i=n[t];if(i instanceof Cg)return r;if(i.element&&!Fd(i.element))return!1;i.focus()}})}const em="filters";function Yae(n,e){let t=-1;const r=zae(e),i=l=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(em),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof go&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),n.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function s(l){const u=n.getKeyboardShortcutsCtrl(),h=l.getKeyboardShortcutsCtrl();r.clear(),h.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(em),callback:()=>{l.isSubMenu()&&l.close(),u.listen(em)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:c=>{const d=n.getNavigator();d.getCurrentPage()>-1&&(t=d.getCurrentPage()),d.clear(),c.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:c=>{const d=e[r.getCurrentPage()];d instanceof vg&&(d.openOptions(),c.preventDefault()),d instanceof yg&&(d.activate(),c.preventDefault()),d instanceof go||c.preventDefault()}}],em)}n.addLocalHook("afterSubmenuOpen",s),n.addLocalHook("afterOpen",s);function o(){n.focus(),n.getKeyboardShortcutsCtrl().listen(em)}function a(){return t}return{...r,listen:o,getLastMenuPage:a}}function Kae(n,e){t$(n,e),e.add(n)}function qae(n,e,t){t$(n,e),e.set(n,t)}function t$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tm(n,e,t){return(e=Xae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Xae(n){var e=Qae(n,"string");return typeof e=="symbol"?e:e+""}function Qae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Zae(n,e,t){return n.set(Yi(n,e),t),t}function nm(n,e){return n.get(Yi(n,e))}function Yi(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const SN="filters",Jae=250,rH=SN;var th=new WeakMap,cs=new WeakSet;class ele extends Wt{static get PLUGIN_KEY(){return SN}static get PLUGIN_PRIORITY(){return Jae}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),Kae(this,cs),tm(this,"dropdownMenuPlugin",null),tm(this,"conditionCollection",null),tm(this,"conditionUpdateObserver",null),tm(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),tm(this,"filtersRowsMap",null),qae(this,th,void 0),this.hot.addHook("afterGetColHeader",(t,r)=>Yi(cs,this,ole).call(this,t,r))}isEnabled(){return!!this.hot.getSettings()[SN]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Xg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,r=o=>(o.addLocalHook("accept",()=>Yi(cs,this,iH).call(this,"accept")),o.addLocalHook("cancel",()=>Yi(cs,this,iH).call(this,"cancel")),o.addLocalHook("change",a=>Yi(cs,this,sle).call(this,o,a)),o),i=()=>`${this.hot.getTranslatedPhrase(xM)}:`,s=()=>`${this.hot.getTranslatedPhrase(PM)}:`;if(!this.components.get("filter_by_condition")){const o=new CN(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:t});o.addLocalHook("afterClose",()=>Yi(cs,this,sH).call(this)),this.components.set("filter_by_condition",r(o))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new lae(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const o=new CN(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});o.addLocalHook("afterClose",()=>Yi(cs,this,sH).call(this)),this.components.set("filter_by_condition2",r(o))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new Tae(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Sg(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new RO(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new e$(this.hot,this.conditionCollection,o=>this.getDataMapAtColumn(o)),this.conditionUpdateObserver.addLocalHook("update",o=>Yi(cs,this,ale).call(this,o))),this.components.forEach(o=>o.show()),this.addHook("afterDropdownMenuDefaultOptions",o=>Yi(cs,this,ile).call(this,o)),this.addHook("afterDropdownMenuShow",()=>Yi(cs,this,nle).call(this)),this.addHook("afterDropdownMenuHide",()=>Yi(cs,this,rle).call(this)),this.addHook("afterChange",o=>Yi(cs,this,tle).call(this,o)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!nm(th,this)&&this.dropdownMenuPlugin.enabled){const o=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=o.getNavigator(),h=nm(th,this).getLastMenuPage();o.focus(),h>0?u.setCurrentPage(h):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,h]=u;return h.getElements()}).flat()];Zae(th,this,Yae(o,a));const l=u=>{nm(th,this).listen(),u.preventDefault(),zg(u.keyCode,"TAB")&&(u.shiftKey?nm(th,this).toPreviousItem():nm(th,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,r)=>{t.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:rH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rH)}addCondition(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:fu;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:t},args:r},i)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const s=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",s,this.conditionCollection.previousConditionStack)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=bt(t.filter(),u=>u.meta.visualRow);const l=ip(i);He(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),D(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),r=[];return D(this.hot.getSourceDataAtCol(t),(i,s)=>{var o;const{row:a,col:l,visualCol:u,visualRow:h,type:c,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(s,t),p=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),t))!==null&&o!==void 0?o:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:h,type:c,instance:d,dateFormat:f,locale:m},value:GW(p)})}),r}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),r=yN(t);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var t;const r=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,r,i){let s=e;return s===Ay&&t.command.key!==Rr&&r.command.key!==Rr&&i.command.key!==Rr?s=CO:i.command.key!==Rr&&(t.command.key===Rr||r.command.key===Rr)&&(s=fu),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new JW(e,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return D(i,o=>{D(t.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function tle(n){n&&D(n,e=>{const[,t]=e,r=this.hot.propToCol(t);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function nle(){const n=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),n.updateMenuDimensions()}function rle(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function ile(n){n.items.push({name:dt}),this.components.forEach(e=>{n.items.push(e.getMenuItemDescriptor())})}function iH(n){var e;if(n==="accept"){const r=this.getSelectedColumn();if(r===null){var t;(t=this.dropdownMenuPlugin)===null||t===void 0||t.close();return}const{physicalIndex:i}=r,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),s.command.key!==Rr&&(this.conditionCollection.addCondition(i,s,l,u),o.command.key!==Rr&&this.conditionCollection.addCondition(i,o,l,u)),a.command.key!==Rr&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(h=>h.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function sle(n,e){this.updateDependentComponentsVisibility(),n.constructor===CN&&!e.inputsCount&&this.setListeningDropdownMenu()}function sH(){this.setListeningDropdownMenu()}function ole(n,e){const t=this.hot.toPhysicalColumn(n);this.enabled&&this.conditionCollection.hasConditions(t)?ue(e,"htFiltersActive"):rt(e,"htFiltersActive")}function ale(n){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:t,column:r}}=n,i=t.filter(o=>o.name===Ph),s=t.filter(o=>o.name!==Ph);if(i.length>=2||s.length>=3)zt(Yt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const o=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(o,r),this.components.get("filter_by_value").updateState(n)}}const n$="internal-use-in-handsontable",RN={licenseKey:n$,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function r$(n){var e;return{maxColumns:n.maxColumns,maxRows:n.maxRows,language:(e=n[Xr])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function i$(n){return Object.keys(n).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=n[t]),e),{})}function lle(n){var e;const t=n[Xr],r=i$(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),i=r$(n);return{...RN,...r,...i}}function ule(n){var e;const t=n[Xr],r=i$(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),i=r$(n);return{...r,...i}}function hle(n,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==n[t])}function cS(){const n="engine_relationship",e=Ao(Xr);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function EO(){const n="shared_engine_usage",e=Ao(Xr);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function cle(n){const e=n.getSettings(),t=e[Xr],r=t?.engine;if(t===!0||mn(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return dle((i=r.hyperformula)!==null&&i!==void 0?i:r,e,n)}else if(typeof r=="object"&&mn(r.hyperformula)){const s=cS(),o=EO().get(r);return s.has(r)||s.set(r,[]),s.get(r).push(n),o&&o.push(n.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:n$}),(r.getConfig().leapYear1900!==RN.leapYear1900||J0(r.getConfig().nullDate,RN.nullDate)===!1)&&zt(Yt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function dle(n,e,t){const r=e[Xr],i=lle(e),s=cS(),o=EO();fle(n,r.functions),mle(n,r.language);const a=n.buildEmpty(i);return s.set(a,[t]),o.set(a,[t.guid]),gle(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function oH(n){var e;const t=cS(),r=t.size===0?[]:Array.from((e=t.get(n))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function aH(n,e){if(n){const t=cS(),r=t.get(n),i=EO(),s=i.get(n);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&t.delete(n)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(n),n.destroy()))}}function fle(n,e){e&&e.forEach(t=>{const{name:r,plugin:i,translations:s}=t;try{n.registerFunction(r,i,s)}catch(o){zt(o.message)}})}function mle(n,e){if(e){const{langCode:t}=e;try{n.registerLanguage(t,e)}catch(r){zt(r.message)}}}function gle(n,e){e&&(n.suspendEvaluation(),e.forEach(t=>{const{name:r,expression:i,scope:s,options:o}=t;try{n.addNamedExpression(r,i,s,o)}catch(a){zt(a.message)}}),n.resumeEvaluation())}function ple(n,e){return(mn(e)||!n.doesSheetExist(e))&&(e=n.addSheet(e)),e}const s$="DD/MM/YYYY";function o$(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function wle(n){return o$(n)?n.substr(1):n}function vle(n){return typeof n=="string"&&n.startsWith("=")}function bO(n,e){return typeof n=="string"&&e==="date"}function a$(n,e){return le(n,e,!0).isValid()}function l$(n,e){return le(n,e,!0).format(s$)}function yle(n,e){return le(n,s$,!0).format(e)}function u$(n,e){const r=new Date(Date.UTC(0,0,n+-1));return le(r).format(e)}function Cle(n,e,t){const r=Array.from(Array(t).keys()).filter(s=>n.includes(s)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Sle(n,e){const t=[];return n.forEach(r=>{const i={from:r,to:e};t.forEach(s=>{const o=s.from>s.to,a=s.to<=i.from;s.from>i.from&&a&&o&&(i.from+=1)}),i.from>=e&&(e+=1),t.push(i)}),t}function Rle(n){return n.forEach((e,t)=>{n.slice(t+1).forEach(i=>{const s=i.from<i.to;i.from>e.from&&s&&(i.from-=1)})}),n}function TO(n,e,t){const r=Sle(n,Cle(n,e,t));return Rle(r)}function nh(n,e,t){Ele(n,e),e.set(n,t)}function Ele(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vn(n,e){return n.get(h$(n,e))}function Hl(n,e,t){return n.set(h$(n,e),t),t}function h$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var rm=new WeakMap,Fl=new WeakMap,Wi=new WeakMap,bw=new WeakMap,AT=new WeakMap,NT=new WeakMap,Tw=new WeakMap;class lH{constructor(e,t,r){nh(this,rm,void 0),nh(this,Fl,void 0),nh(this,Wi,void 0),nh(this,bw,[]),nh(this,AT,[]),nh(this,NT,void 0),nh(this,Tw,[]),Hl(rm,this,e),Hl(Fl,this,t),Hl(Wi,this,r)}setRemovedHfIndexes(e){return Hl(Tw,this,e.map(t=>{const r=vn(Fl,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(r)})),vn(Tw,this)}getRemovedHfIndexes(){return vn(Tw,this)}getHfIndexFromVisualIndex(e){const t=vn(Fl,this).getIndexesSequence(),r=vn(Fl,this).getNotTrimmedIndexes();return t.indexOf(r[e])}syncMoves(e){const r=`move${yo(vn(rm,this))}s`;vn(Wi,this).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,o=i.from+1!==i.to;s&&o&&vn(Wi,this).getEngine()[r](vn(Wi,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,t,r){r!==!1&&(Hl(AT,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),Hl(NT,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(vn(Wi,this).isPerformingUndoRedo()||e===!1||t===!1)return;const r=TO(vn(AT,this),vn(NT,this),vn(Fl,this).getNumberOfIndexes());vn(Wi,this).getSheetId()===null?vn(Wi,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${yo(vn(rm,this))}Order`;return t=>{if(vn(Wi,this).isPerformingUndoRedo())return;const r=vn(Fl,this).getIndexesSequence();if(t==="update"&&r.length>0){const i=vn(bw,this).map(l=>r.indexOf(l)),s=vn(Wi,this).getEngine().getSheetDimensions(vn(Wi,this).getSheetId());let o;vn(rm,this)==="row"?o=s.height:o=s.width;const a=i.length;for(let l=a;l<o;l+=1)i.push(l);vn(Wi,this).getEngine()[e](vn(Wi,this).getSheetId(),i)}Hl(bw,this,r)}}init(){Hl(bw,this,vn(Fl,this).getIndexesSequence())}}function rh(n,e,t){ble(n,e),e.set(n,t)}function ble(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ua(n,e){return n.get(c$(n,e))}function ih(n,e,t){return n.set(c$(n,e),t),t}function c$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Aw=new WeakMap,Nw=new WeakMap,IT=new WeakMap,MT=new WeakMap,OT=new WeakMap,_T=new WeakMap,xT=new WeakMap;class Tle{constructor(e,t,r){rh(this,Aw,void 0),rh(this,Nw,void 0),rh(this,IT,void 0),rh(this,MT,!1),rh(this,OT,!1),rh(this,_T,null),rh(this,xT,null),ih(Aw,this,new lH("row",e,this)),ih(Nw,this,new lH("column",t,this)),ih(IT,this,r)}getForAxis(e){return e==="row"?Ua(Aw,this):Ua(Nw,this)}setPerformUndo(e){ih(MT,this,e)}setPerformRedo(e){ih(OT,this,e)}isPerformingUndoRedo(){return Ua(MT,this)||Ua(OT,this)}getSheetId(){return Ua(xT,this)}getEngine(){return Ua(_T,this)}getPostponeAction(){return Ua(IT,this)}setupSyncEndpoint(e,t){ih(_T,this,e),ih(xT,this,t),Ua(Aw,this).init(),Ua(Nw,this).init()}}function Ale(n,e){d$(n,e),e.add(n)}function Wc(n,e,t){return(e=Nle(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Nle(n){var e=Ile(n,"string");return typeof e=="symbol"?e:e+""}function Ile(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function PT(n,e,t){d$(n,e),e.set(n,t)}function d$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cu(n,e,t){return n.set(Xt(n,e),t),t}function Nd(n,e){return n.get(Xt(n,e))}function Xt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Xr="formulas",Mle=["maxRows","maxColumns","language"],Ole=260;Ie.getSingleton().register("afterNamedExpressionAdded");Ie.getSingleton().register("afterNamedExpressionRemoved");Ie.getSingleton().register("afterSheetAdded");Ie.getSingleton().register("afterSheetRemoved");Ie.getSingleton().register("afterSheetRenamed");Ie.getSingleton().register("afterFormulasValuesUpdate");const of=n=>n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto";var gl=new WeakMap,AO=new WeakMap,im=new WeakMap,nn=new WeakSet;class _le extends Wt{constructor(){var e;super(...arguments),e=this,Ale(this,nn),PT(this,gl,!1),PT(this,AO,!1),PT(this,im,[["valuesUpdated",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Xt(nn,e,Yle).call(e,...r)}],["namedExpressionAdded",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Xt(nn,e,Kle).call(e,...r)}],["namedExpressionRemoved",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Xt(nn,e,qle).call(e,...r)}],["sheetAdded",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Xt(nn,e,Xle).call(e,...r)}],["sheetRenamed",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Xt(nn,e,Qle).call(e,...r)}],["sheetRemoved",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Xt(nn,e,Zle).call(e,...r)}]]),Wc(this,"staticRegister",Ao("formulas")),Wc(this,"engine",null),Wc(this,"sheetName",null),Wc(this,"indexSyncer",null),Wc(this,"rowAxisSyncer",null),Wc(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Xr}static get PLUGIN_PRIORITY(){return Ole}static get SETTING_KEYS(){return[Xr,...Mle]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Xr]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=cle(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){zt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,uH).call(t,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,hH).call(t,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,uH).call(t,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,hH).call(t,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,Dle).call(t,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,Hle).call(t,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,xle).call(t,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,Fle).call(t,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,cH).call(t,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,cH).call(t,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,kle).call(t,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,Vle).call(t,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,Wle).call(t,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,$le).call(t,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,Ule).call(t,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,Ble).call(t,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,Gle).call(t,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,jle).call(t,...i)}),this.indexSyncer=new Tle(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,s,o)=>{this.rowAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("beforeColumnMove",(r,i,s,o)=>{this.columnAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("afterRowMove",(r,i,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(r,i,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,Lle).call(t,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,zle).call(t,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xt(nn,t,Ple).call(t,...i)}),Nd(im,this).forEach(r=>{let[i,s]=r;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){Nd(im,this).forEach(e=>{let[t,r]=e;return this.engine.off(t,r)}),aH(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=ule(this.hot.getSettings());hle(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const r=this.hot.getSettings()[Xr];if(_e(r)&&_e(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Xr].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Nd(im,this).forEach(e=>{var t;let[r,i]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(r,i)}),Cu(im,this,null),aH(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(_e(t)&&!O8(t))return zt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return zt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(r),t),r}catch(r){return zt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){iI(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${yo(Xr)}.switchSheet`)}getCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(t);return i!==null&&s!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var s;const o=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(r.has(o)||r.add(o))}),oH(this.engine).forEach((i,s)=>{if((t||s!==this.sheetId)&&r.has(s)){var o;i.render(),(o=i.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=s=>{var o;const{row:a,col:l,sheet:u}=(o=s?.address)!==null&&o!==void 0?o:{};return _e(u)?`${u}:${a}x${l}`:""},i=new Set(t.map(s=>r(s)));e.forEach(s=>{var o,a;const{row:l,col:u}=(o=s.address)!==null&&o!==void 0?o:{};if(_e(l)===!1||_e(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const h=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,c=r(s);if(h!==void 0&&!i.has(c)){const d=oH(this.engine).get(h);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,t,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){zt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,t);return bO(r,s.type)&&(a$(r,s.dateFormat)?r=l$(r,s.dateFormat):vle(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function xle(n,e,t){const r=this.hot.propToCol(t);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},s=this.hot.getCellMeta(e,r);let o=this.engine.getCellValue(i);return s.type==="date"&&ci(o)&&(o=u$(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return n}function Ple(n,e,t){const{row:r,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=t.getTopStartCorner(),{row:u,col:h}=t.getBottomEndCorner(),c={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(c,d),{row:m,col:p}=c.start,{row:v,col:y}=c.end,S=v-m+1,R=y-p+1;for(let T=0;T<f.length;T+=1)for(let I=0;I<f[T].length;I+=1){const H=f[T][I],k=m+T%S,W=p+I%R,Y=this.hot.getCellMeta(k,W);bO(H,Y.type)&&(H.startsWith("'")?f[T][I]=H.slice(1):this.isFormulaCellType(k,W,this.sheetId)===!1&&(f[T][I]=yle(H,Y.dateFormat)))}return f}function uH(n,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(yo(Xr))||Cu(AO,this,mn(this.hot.getSettings().data))}function Lle(){const n=this.hot.getSourceDataArray();let e=!1;n.forEach((t,r)=>{t.forEach((i,s)=>{const o=this.hot.getCellMeta(r,s),a=o.dateFormat;bO(i,o.type)&&(e=!0,a$(i,a)?n[r][s]=l$(i,a):this.isFormulaCellType(r,s)===!1&&(n[r][s]=`'${i}`))})}),e===!0&&(Cu(gl,this,!0),this.engine.setSheetContent(this.sheetId,n),Cu(gl,this,!1))}function hH(n,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(yo(Xr)))if(this.sheetName=ple(this.engine,this.hot.getSettings()[Xr].sheetName),Nd(AO,this))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Cu(gl,this,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),Cu(gl,this,!1)}}}function Dle(n,e,t,r){if(r!=="get"||Nd(gl,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(n);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){o$(t.value)&&(t.value=wle(t.value));return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(o),l=this.hot.getCellsMeta().find(h=>h.visualRow===i&&h.visualCol===e);l===void 0&&(l={}),l.type==="date"&&ci(a)&&(a=u$(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;t.value=u}function Hle(n,e,t,r){if(r!=="get"||Nd(gl,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(n),s=this.hot.propToCol(e);if(i===null||s===null||!this.isFormulaCellType(i,s)&&this.getCellType(i,s)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};t.value=this.engine.getCellSerialized(l)}function cH(n,e){if(of(e))return;const t=[],r=[],i=this.engine.batch(()=>{n.forEach(s=>{let[o,a,,l]=s;const u=this.hot.propToCol(a),h=this.hot.toPhysicalRow(o),c=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};h!==null&&c!==null?this.syncChangeWithEngine(o,u,l):t.push([o,u,l]),r.push({address:d})})});t.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{t.forEach(o=>{let[a,l,u]=o;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Fle(n,e){if(of(e))return;const t=[],r=[];n.forEach(i=>{let[s,o,,a]=i;const l=this.hot.propToCol(o);if(!ci(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){zt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),t.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(t),this.validateDependentCells(t,r)}function kle(n,e){let t=this.rowAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countRows()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[t,e]))return!1}function Vle(n,e){let t=this.columnAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countCols()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[t,e]))return!1}function Ule(n,e,t){return this.rowAxisSyncer.setRemovedHfIndexes(t).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function Ble(n,e,t){return this.columnAxisSyncer.setRemovedHfIndexes(t).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function Wle(n,e,t){if(of(t))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(r)}function $le(n,e,t){if(of(t))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(r)}function Gle(n,e,t,r){if(of(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function jle(n,e,t,r){if(of(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function zle(n,e,t){var r;Cu(gl,this,!0);const i=this.hot.getSourceDataArray(t,0,t+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Cu(gl,this,!1),i.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:t+o,sheet:this.sheetId},[[a]])})})}function Yle(n){this.hot.runHooks("afterFormulasValuesUpdate",n)}function Kle(n,e){this.hot.runHooks("afterNamedExpressionAdded",n,e)}function qle(n,e){this.hot.runHooks("afterNamedExpressionRemoved",n,e)}function Xle(n){this.hot.runHooks("afterSheetAdded",n)}function Qle(n,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",n,e)}function Zle(n,e){this.hot.runHooks("afterSheetRemoved",n,e)}function Jle(n){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(t=1)}return this.getTranslatedPhrase(uM,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,t.col),0),i=Math.max(e.col,t.col),s=[];for(let l=r;l<=i;l+=1)s.push(l);n.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function eue(n){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(hM,t)},callback(){var t,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(t=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&t!==void 0?t:0,s=(r=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countCols()-1,n.showColumns(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const t=bt(n.getHiddenColumns(),c=>this.toPhysicalColumn(c));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,s=r.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),h=[];if(i!==s){const c=s-i+1,d=l-a+1;if(c>d){const f=u.slice(i,s+1);h.push(...f.filter(m=>t.includes(m)))}}else if(a===0&&a<i)h.push(...u.slice(0,i));else if(a===null)h.push(...u.slice(0,this.countCols()));else{const c=this.countCols()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,-1));l===d&&c>s&&h.push(...u.slice(s+1))}return D(h,c=>{e.push(this.toVisualColumn(c))}),e.length===0}}}function tue(n,e){f$(n,e),e.add(n)}function dH(n,e,t){f$(n,e),e.set(n,t)}function f$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ji(n,e){return n.get($l(n,e))}function sm(n,e,t){return n.set($l(n,e),t),t}function $l(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ie.getSingleton().register("beforeHideColumns");Ie.getSingleton().register("afterHideColumns");Ie.getSingleton().register("beforeUnhideColumns");Ie.getSingleton().register("afterUnhideColumns");const LT="hiddenColumns",nue=310;var ha=new WeakMap,ko=new WeakMap,sh=new WeakSet;class rue extends Wt{constructor(){super(...arguments),tue(this,sh),dH(this,ha,{}),dH(this,ko,null)}static get PLUGIN_KEY(){return LT}static get PLUGIN_PRIORITY(){return nue}isEnabled(){return!!this.hot.getSettings()[LT]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[LT];mt(t)&&(sm(ha,this,t),mn(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),sm(ko,this,new GC),Ji(ko,this).addLocalHook("init",()=>$l(sh,this,uue).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ji(ko,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return $l(sh,e,lue).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,s)=>$l(sh,this,sue).call(this,r,i,s)),this.addHook("modifyColWidth",(r,i)=>$l(sh,this,iue).call(this,r,i),2),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return $l(sh,e,aue).call(e,...i)}),this.addHook("modifyCopyableRange",r=>$l(sh,this,oue).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),sm(ha,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let i=t;const s=Ji(ko,this).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalColumn(u));D(l,u=>{s[u]=!1}),i=gi(s,(u,h,c)=>(h&&u.push(this.hot.toVisualColumn(c)),u),[])}this.hot.runHooks("beforeUnhideColumns",t,i,r&&o)!==!1&&(r&&o&&Ji(ko,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,i,r&&o,r&&i.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{D(e,o=>{Ji(ko,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",t,i,r,r&&i.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideColumns(t)}getHiddenColumns(){return bt(Ji(ko,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Ji(ko,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){D(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){sm(ha,this,null),sm(ko,this,null),super.destroy()}}function iue(n,e){if(this.isHidden(e))return 0;if(Ji(ha,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof n=="number"&&this.hot.hasColHeaders())return n+15}function sue(n,e,t){if(Ji(ha,this).copyPasteEnabled===!1&&this.isHidden(e)&&(t.skipColumnOnPaste=!0),this.isHidden(e-1))t.className=t.className||"",t.className.indexOf("afterHiddenColumn")===-1&&(t.className+=" afterHiddenColumn");else if(t.className){const r=t.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),t.className=r.join(" ")}}}function oue(n){if(Ji(ha,this).copyPasteEnabled)return n;const e=[],t=(r,i,s,o)=>{e.push({startRow:r,endRow:i,startCol:s,endCol:o})};return D(n,r=>{let i=!0,s=0;He(r.startCol,r.endCol,o=>{this.isHidden(o)?(i||t(r.startRow,r.endRow,s,o-1),i=!0):(i&&(s=o),o===r.endCol&&t(r.startRow,r.endRow,s,o),i=!1)})}),e}function aue(n,e){if(!Ji(ha,this).indicators||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenColumn"),n<this.hot.countCols()-1&&this.isHidden(n+1)&&t.push("beforeHiddenColumn"),ue(e,t)}function lue(n){n.items.push({name:dt},Jle(this),eue(this))}function uue(){Array.isArray(Ji(ha,this).columns)&&this.hideColumns(Ji(ha,this).columns)}function hue(n){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(t=1)}return this.getTranslatedPhrase(cM,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,t.row),0),i=Math.max(e.row,t.row),s=[];for(let l=r;l<=i;l+=1)s.push(l);n.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function cue(n){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(dM,t)},callback(){var t,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(t=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&t!==void 0?t:0,s=(r=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countRows()-1,n.showRows(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const t=bt(n.getHiddenRows(),c=>this.toPhysicalRow(c));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,s=r.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),h=[];if(i!==s){const c=s-i+1,d=l-a+1;if(c>d){const f=u.slice(i,s+1);h.push(...f.filter(m=>t.includes(m)))}}else if(a===0&&a<i)h.push(...u.slice(0,i));else if(a===null)h.push(...u.slice(0,this.countRows()));else{const c=this.countRows()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,-1));l===d&&c>s&&h.push(...u.slice(s+1))}return D(h,c=>{e.push(this.toVisualRow(c))}),e.length===0}}}function due(n,e){m$(n,e),e.add(n)}function fH(n,e,t){m$(n,e),e.set(n,t)}function m$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ss(n,e){return n.get(Gl(n,e))}function om(n,e,t){return n.set(Gl(n,e),t),t}function Gl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ie.getSingleton().register("beforeHideRows");Ie.getSingleton().register("afterHideRows");Ie.getSingleton().register("beforeUnhideRows");Ie.getSingleton().register("afterUnhideRows");const DT="hiddenRows",fue=320;var il=new WeakMap,Vo=new WeakMap,oh=new WeakSet;class mue extends Wt{constructor(){super(...arguments),due(this,oh),fH(this,il,{}),fH(this,Vo,null)}static get PLUGIN_KEY(){return DT}static get PLUGIN_PRIORITY(){return fue}isEnabled(){return!!this.hot.getSettings()[DT]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[DT];mt(t)&&(om(il,this,t),mn(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),om(Vo,this,new GC),Ss(Vo,this).addLocalHook("init",()=>Gl(oh,this,Cue).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ss(Vo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gl(oh,e,yue).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,s)=>Gl(oh,this,pue).call(this,r,i,s)),this.addHook("modifyRowHeight",(r,i)=>Gl(oh,this,gue).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gl(oh,e,vue).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Gl(oh,this,wue).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),om(il,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let i=t;const s=Ss(Vo,this).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalRow(u));D(l,u=>{s[u]=!1}),i=gi(s,(u,h,c)=>(h&&u.push(this.hot.toVisualRow(c)),u),[])}this.hot.runHooks("beforeUnhideRows",t,i,r&&o)!==!1&&(r&&o&&Ss(Vo,this).setValues(s),this.hot.runHooks("afterUnhideRows",t,i,r&&o,r&&i.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{D(e,o=>{Ss(Vo,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",t,i,r,r&&i.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideRows(t)}getHiddenRows(){return bt(Ss(Vo,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Ss(Vo,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){D(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){om(il,this,null),om(Vo,this,null),super.destroy()}}function gue(n,e){return this.isHidden(e)?0:n}function pue(n,e,t){if(Ss(il,this).copyPasteEnabled===!1&&this.isHidden(n)&&(t.skipRowOnPaste=!0),this.isHidden(n-1))t.className=t.className||"",t.className.indexOf("afterHiddenRow")===-1&&(t.className+=" afterHiddenRow");else if(t.className){const r=t.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),t.className=r.join(" ")}}}function wue(n){if(Ss(il,this).copyPasteEnabled)return n;const e=[],t=(r,i,s,o)=>{e.push({startRow:r,endRow:i,startCol:s,endCol:o})};return D(n,r=>{let i=!0,s=0;He(r.startRow,r.endRow,o=>{this.isHidden(o)?(i||t(s,o-1,r.startCol,r.endCol),i=!0):(i&&(s=o),o===r.endRow&&t(s,o,r.startCol,r.endCol),i=!1)})}),e}function vue(n,e){if(!Ss(il,this).indicators||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenRow"),n<this.hot.countRows()-1&&this.isHidden(n+1)&&t.push("beforeHiddenRow"),ue(e,t)}function yue(n){n.items.push({name:dt},hue(this),cue(this))}function Cue(){Array.isArray(Ss(il,this).rows)&&this.hideRows(Ss(il,this).rows)}function Sue(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase(zI)},callback(e,t){const[{start:{col:r}}]=t;n.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function Rue(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(YI)},callback(e,t){const[{start:{col:r}}]=t;n.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}function Eue(n,e){g$(n,e),e.add(n)}function bue(n,e,t){g$(n,e),e.set(n,t)}function g$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EN(n,e){return n.get(Iy(n,e))}function HT(n,e,t){return n.set(Iy(n,e),t),t}function Iy(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ie.getSingleton().register("beforeColumnFreeze");Ie.getSingleton().register("afterColumnFreeze");Ie.getSingleton().register("beforeColumnUnfreeze");Ie.getSingleton().register("afterColumnUnfreeze");const mH="manualColumnFreeze",Tue=110;var Rh=new WeakMap,FT=new WeakSet;class Aue extends Wt{constructor(){super(...arguments),Eue(this,FT),bue(this,Rh,!1)}static get PLUGIN_KEY(){return mH}static get PLUGIN_PRIORITY(){return Tue}isEnabled(){return!!this.hot.getSettings()[mH]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Iy(FT,this,Nue).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>Iy(FT,this,Iue).call(this,e,t)),super.enablePlugin())}disablePlugin(){HT(Rh,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;EN(Rh,this)||HT(Rh,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;EN(Rh,this)||HT(Rh,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Nue(n){n.items.push({name:"---------"},Sue(this),Rue(this))}function Iue(n,e){if(EN(Rh,this)){const t=this.hot.getSettings().fixedColumnsStart;if(e<t||n.some(r=>r<t))return!1}}function Iw(n,e,t){return(e=Mue(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Mue(n){var e=Oue(n,"string");return typeof e=="symbol"?e:e+""}function Oue(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const kT=0,gH=1,pH=2,$c="px";let p$=class{constructor(e){Iw(this,"hot",void 0),Iw(this,"_element",null),Iw(this,"state",kT),Iw(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=pH}build(){this.state===kT&&(this._element=this.hot.rootDocument.createElement("div"),this.state=gH)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=kT}isAppended(){return this.state===pH}isBuilt(){return this.state>=gH}setPosition(e,t){ci(e)&&(this._element.style.top=e+$c),ci(t)&&(this._element.style[this.inlineProperty]=t+$c)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){ci(e)&&(this._element.style.width=e+$c),ci(t)&&(this._element.style.height=t+$c)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){ci(e)&&(this._element.style.marginTop=e+$c),ci(t)&&(this._element.style[`margin${yo(this.inlineProperty)}`]=t+$c)}getOffset(){const e=this._element.style,t=`margin${yo(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const _ue="ht__manualColumnMove--backlight";let xue=class extends p${build(){super.build(),ue(this._element,_ue)}};const Pue="ht__manualColumnMove--guideline";let Lue=class extends p${build(){super.build(),ue(this._element,Pue)}};function Due(n,e){w$(n,e),e.add(n)}function qs(n,e,t){w$(n,e),e.set(n,t)}function w$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oi(n,e,t){return n.set(jl(n,e),t),t}function Pe(n,e){return n.get(jl(n,e))}function jl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ie.getSingleton().register("beforeColumnMove");Ie.getSingleton().register("afterColumnMove");const VT="manualColumnMove",Hue=120,wH="ht__manualColumnMove",My="show-ui",bN="on-moving--columns",TN="after-selection--columns";var li=new WeakMap,Zl=new WeakMap,sl=new WeakMap,Ov=new WeakMap,au=new WeakMap,ai=new WeakMap,Mw=new WeakMap,ms=new WeakMap,sd=new WeakMap,Oy=new WeakMap,Dm=new WeakMap,ah=new WeakSet;class Fue extends Wt{constructor(){super(...arguments),Due(this,ah),qs(this,li,new xue(this.hot)),qs(this,Zl,new Lue(this.hot)),qs(this,sl,[]),qs(this,Ov,0),qs(this,au,!1),qs(this,ai,{}),qs(this,Mw,void 0),qs(this,ms,void 0),qs(this,sd,void 0),qs(this,Oy,void 0),qs(this,Dm,void 0)}static get PLUGIN_KEY(){return VT}static get PLUGIN_PRIORITY(){return Hue}isEnabled(){return!!this.hot.getSettings()[VT]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return jl(ah,e,kue).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return jl(ah,e,Uue).call(e,...r)}),this.addHook("afterScrollVertically",()=>jl(ah,this,Wue).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return jl(ah,e,$ue).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ue(this.hot.rootElement,wH),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){rt(this.hot.rootElement,wH),this.unregisterEvents(),Pe(li,this).destroy(),Pe(Zl,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const r=Pe(Mw,this),i=this.isMovePossible(e,t),s=this.hot.runHooks("beforeColumnMove",e,t,r,i);if(Oi(Mw,this,void 0),s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,t);const o=i&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,r,i,o),o}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const r=this.countFinalIndex(e,t);return Oi(Mw,this,t),this.moveColumns(e,r)}isMovePossible(e,t){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>r,s=t<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isColumnOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}countFinalIndex(e,t){const r=gi(e,(i,s)=>(s<t&&(i+=1),i),0);return t-r}getColumnsWidth(e,t){const r=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=t;s+=1){const o=r.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[VT];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const r=[];return He(e,t,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Pe(ms,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Pe(ms,this)-1);const o=t.hider.offsetWidth,a=t.TBODY.offsetLeft,l=Pe(li,this).getOffset().start,u=Pe(li,this).getSize().width;let h=0,c=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,p=gn(this.hot.rootElement),v=m.innerWidth-Pe(sd,this)-p;c=m.innerWidth-Pe(ai,this).eventPageX-v-(r.scrollX===void 0?i:0)}else c=Pe(ai,this).eventPageX-(Pe(sd,this)-(r.scrollX===void 0?i:0));if(Pe(Oy,this)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Pe(ms,this))&&(s+=i),s+=h,Pe(ms,this)<0)Pe(Dm,this)>0?Pe(ai,this).col=0:Pe(ai,this).col=e>0?e-1:e;else if(Pe(ai,this).TD.offsetWidth/2+s<=c){const m=Pe(ms,this)>=Pe(Ov,this)?Pe(Ov,this)-1:Pe(ms,this);Pe(ai,this).col=m+1,s+=Pe(ai,this).TD.offsetWidth}else Pe(ai,this).col=Pe(ms,this);let d=c,f=s;c+u+l>=o?d=o-u-l:c+l<a+h&&(d=a+h+Math.abs(l)),s>=o-1?f=o-1:f===0?f=1:r.scrollX!==void 0&&Pe(ms,this)<Pe(Dm,this)&&(f-=Pe(sd,this)<=r.scrollX?Pe(sd,this):0),Pe(li,this).setPosition(null,d),Pe(Zl,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>jl(ah,this,Vue).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>jl(ah,this,Bue).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Pe(li,this).build(),Pe(Zl,this).build()}destroy(){Pe(li,this).destroy(),Pe(Zl,this).destroy(),super.destroy()}}function kue(n,e,t,r){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),a=Je(n.target,"sortAction");if(!o||!s||Pe(au,this)||n.button!==0||a){Oi(au,this,!1),Pe(sl,this).length=0,rt(this.hot.rootElement,[bN,My]);return}const l=Pe(Zl,this).isBuilt()&&!Pe(Zl,this).isAppended(),u=Pe(li,this).isBuilt()&&!Pe(li,this).isAppended();l&&u&&(Pe(Zl,this).appendTo(i.hider),Pe(li,this).appendTo(i.hider));const{from:h,to:c}=o,d=Math.min(h.col,c.col),f=Math.max(h.col,c.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,Oi(au,this,!0);const m=t.firstChild?W4(n,t.firstChild).x:n.offsetX;Pe(ai,this).eventPageX=n.pageX,Oi(ms,this,e.col),Pe(ai,this).TD=t,Pe(ai,this).col=e.col,Oi(sl,this,this.prepareColumnsToMoving(d,f)),Oi(Oy,this,!!this.hot.getSettings().rowHeaders),Oi(Ov,this,this.hot.countCols()),Oi(Dm,this,this.hot.getSettings().fixedColumnsStart),Oi(sd,this,br(this.hot.rootElement).left);const p=Pe(Oy,this)?-1:0,v=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,y=e.col<Pe(Dm,this),S=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),R=Math.abs(m-(this.hot.isRtl()?t.offsetWidth:0)),T=this.getColumnsWidth(d,e.col-1)+R,I=this.getColumnsWidth(p,d-1)+(y?S:0)+T;Pe(li,this).setPosition(v,I),Pe(li,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-v),Pe(li,this).setOffset(null,-T),ue(this.hot.rootElement,bN)}else rt(this.hot.rootElement,TN),Oi(au,this,!1),Pe(sl,this).length=0}function Vue(n){Pe(au,this)&&(Pe(ai,this).eventPageX=n.pageX,this.refreshPositions())}function Uue(n,e,t,r){!this.hot.getSelectedRangeLast()||!Pe(au,this)||(Pe(sl,this).indexOf(e.col)>-1?rt(this.hot.rootElement,My):ue(this.hot.rootElement,My),r.row=!0,r.column=!0,r.cell=!0,Oi(ms,this,e.col),Pe(ai,this).TD=t)}function Bue(){const n=Pe(ai,this).col,e=Pe(sl,this).length;if(Oi(ms,this,void 0),Oi(au,this,!1),rt(this.hot.rootElement,[bN,My,TN]),this.hot.selection.isSelectedByColumnHeader()&&ue(this.hot.rootElement,TN),e<1||n===void 0)return;const t=Pe(sl,this)[0],r=this.hot.toPhysicalColumn(t),i=this.dragColumns(Pe(sl,this),n);if(Pe(sl,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(r),o=s+e-1;this.hot.selectColumns(s,o)}}function Wue(){const n=this.hot.view._wt.wtTable,e=n.getColumnHeaderHeight(0)+1,t=n.holder.scrollTop,r=e+t;Pe(li,this).setPosition(r),Pe(li,this).setSize(null,n.hider.offsetHeight-r)}function $ue(){this.moveBySettingsOrLoad()}function Gue(n,e){v$(n,e),e.add(n)}function jr(n,e,t){v$(n,e),e.set(n,t)}function v$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wn(n,e,t){return n.set(ro(n,e),t),t}function Re(n,e){return n.get(ro(n,e))}function ro(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const _y="manualColumnResize",jue=130,vH="manualColumnWidths";var Xa=new WeakMap,Ow=new WeakMap,Xi=new WeakMap,xy=new WeakMap,aa=new WeakMap,zue=new WeakMap,Id=new WeakMap,_w=new WeakMap,Ti=new WeakMap,za=new WeakMap,Kh=new WeakMap,Py=new WeakMap,Hm=new WeakMap,Fm=new WeakMap,Zi=new WeakMap,km=new WeakMap,Uo=new WeakSet;class Yue extends Wt{static get PLUGIN_KEY(){return _y}static get PLUGIN_PRIORITY(){return jue}constructor(e){super(e),Gue(this,Uo),jr(this,Xa,null),jr(this,Ow,null),jr(this,Xi,[]),jr(this,xy,null),jr(this,aa,null),jr(this,zue,null),jr(this,Id,null),jr(this,_w,null),jr(this,Ti,this.hot.rootDocument.createElement("DIV")),jr(this,za,this.hot.rootDocument.createElement("DIV")),jr(this,Kh,null),jr(this,Py,!1),jr(this,Hm,0),jr(this,Fm,null),jr(this,Zi,void 0),jr(this,km,void 0),ue(Re(Ti,this),"manualColumnResizer"),ue(Re(za,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[_y]}enablePlugin(){this.enabled||(Wn(Zi,this,new bu),Re(Zi,this).addLocalHook("init",()=>ro(Uo,this,Kue).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Re(Zi,this)),this.addHook("modifyColWidth",(e,t)=>ro(Uo,this,ehe).call(this,e,t),1),this.addHook("beforeStretchingColumnWidth",(e,t)=>ro(Uo,this,the).call(this,e,t)),this.addHook("beforeColumnResize",(e,t,r)=>ro(Uo,this,nhe).call(this,e,t,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Wn(km,this,Re(Zi,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",vH,Re(Zi,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",vH,e),e.value}setManualSize(e,t){const r=Math.max(t,20),i=this.hot.toPhysicalColumn(e);return Re(Zi,this).setValueAtIndex(i,r),r}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);Re(Zi,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;Wn(Xa,this,e);const{_wt:t}=this.hot.view,r=t.wtTable.getCoords(Re(Xa,this)),i=r.col;if(i<0)return;const s=er(Re(Xa,this)),o=Re(Xa,this).getBoundingClientRect(),a=i<t.getSetting("fixedColumnsStart");let l;a&&(l=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Re(Xa,this),r.row,r.col)),l||(l=t.wtOverlays.topOverlay.getRelativeCellPosition(Re(Xa,this),r.row,r.col)),Wn(Ow,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Wn(Xi,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const h=this.hot.getSelectedRange();D(h,c=>{const d=c.getTopStartCorner().col,f=c.getBottomEndCorner().col;He(d,f,m=>{Re(Xi,this).includes(m)||Re(Xi,this).push(m)})})}Re(Xi,this).includes(Re(Ow,this))||Wn(Xi,this,[Re(Ow,this)]),Wn(_w,this,l.start-6),Wn(Id,this,parseInt(o.width,10)),Re(Ti,this).style.top=`${l.top}px`,Re(Ti,this).style[this.inlineDir]=`${Re(_w,this)+Re(Id,this)}px`,Re(Ti,this).style.height=`${s}px`,this.hot.rootElement.appendChild(Re(Ti,this))}refreshHandlePosition(){Re(Ti,this).style[this.inlineDir]=`${Re(_w,this)+Re(xy,this)}px`}setupGuidePosition(){const e=parseInt(er(Re(Ti,this)),10),t=parseInt(Re(Ti,this).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ue(Re(Ti,this),"active"),ue(Re(za,this),"active"),Re(za,this).style.top=`${t}px`,this.refreshGuidePosition(),Re(za,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(Re(za,this))}refreshGuidePosition(){Re(za,this).style[this.inlineDir]=Re(Ti,this).style[this.inlineDir]}hideHandleAndGuide(){rt(Re(Ti,this),"active"),rt(Re(za,this),"active")}checkIfColumnHeader(e){const t=Bh(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(r,i)=>{const s=this.hot.runHooks("beforeColumnResize",Re(aa,this),r,!0);s!==void 0&&Wn(aa,this,s),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,Re(aa,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Re(aa,this),r,!0),i&&e()};Re(Hm,this)>=2&&(Re(Xi,this).length>1?(D(Re(Xi,this),i=>{t(i)}),e()):D(Re(Xi,this),i=>{t(i,!0)})),Wn(Hm,this,0),Wn(Fm,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",r=>ro(Uo,this,que).call(this,r)),this.eventManager.addEventListener(t,"mousedown",r=>ro(Uo,this,Xue).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>ro(Uo,this,Que).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>ro(Uo,this,Zue).call(this)),this.eventManager.addEventListener(Re(Ti,this),"contextmenu",()=>ro(Uo,this,Jue).call(this))}destroy(){super.destroy()}}function Kue(){const n=this.hot.getSettings()[_y],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((t,r)=>{Re(Zi,this).setValueAtIndex(r,t)})},!0):Array.isArray(n)?(this.hot.batchExecution(()=>{n.forEach((t,r)=>{Re(Zi,this).setValueAtIndex(r,t)})},!0),Wn(km,this,n)):n===!0&&Array.isArray(Re(km,this))&&this.hot.batchExecution(()=>{Re(km,this).forEach((t,r)=>{Re(Zi,this).setValueAtIndex(r,t)})},!0)}function que(n){if(!hU(n.target)&&Re(Py,this)!==!0&&this.checkIfColumnHeader(n.target)){const e=this.getClosestTHParent(n.target);if(!e)return;const t=e.getAttribute("colspan");e&&(t===null||t==="1")&&(Re(Kh,this)||this.setupHandlePosition(e))}}function Xue(n){n.target.parentNode===this.hot.rootElement&&Je(n.target,"manualColumnResizer")&&(this.setupHandlePosition(Re(Xa,this)),this.setupGuidePosition(),Wn(Kh,this,!0),Re(Fm,this)===null&&(Wn(Fm,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Re(Fm,this))),Wn(Hm,this,Re(Hm,this)+1),this.startX=n.pageX,Wn(aa,this,Re(Id,this)))}function Que(n){if(Re(Kh,this)){const e=(n.pageX-this.startX)*this.hot.getDirectionFactor();Wn(xy,this,Re(Id,this)+e),D(Re(Xi,this),t=>{Wn(aa,this,this.setManualSize(t,Re(xy,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Zue(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,r)=>{this.hot.runHooks("beforeColumnResize",Re(aa,this),t,!1),r&&n(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Re(aa,this),t,!1)};Re(Kh,this)&&(this.hideHandleAndGuide(),Wn(Kh,this,!1),Re(aa,this)!==Re(Id,this)&&(Re(Xi,this).length>1?(D(Re(Xi,this),r=>{e(r)}),n()):D(Re(Xi,this),r=>{e(r,!0)})),this.setupHandlePosition(Re(Xa,this)))}function Jue(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Re(Ti,this)),this.hot.rootElement.removeChild(Re(za,this)),Wn(Kh,this,!1),Wn(Py,this,!0),this.hot._registerImmediate(()=>{Wn(Py,this,!1)})}function ehe(n,e){let t=n;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=Re(Zi,this).getValueAtIndex(r);this.hot.getSettings()[_y]&&i&&(t=i)}return t}function the(n,e){let t=Re(Zi,this).getValueAtIndex(e);return t===null&&(t=n),t}function nhe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function UT(n,e,t){return(e=rhe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rhe(n){var e=ihe(n,"string");return typeof e=="symbol"?e:e+""}function ihe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const BT=0,yH=1,CH=2,Gc="px";let y$=class{constructor(e){UT(this,"hot",void 0),UT(this,"_element",null),UT(this,"state",BT),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=CH}build(){this.state===BT&&(this._element=this.hot.rootDocument.createElement("div"),this.state=yH)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=BT}isAppended(){return this.state===CH}isBuilt(){return this.state>=yH}setPosition(e,t){e!==void 0&&(this._element.style.top=e+Gc),t!==void 0&&(this._element.style.left=t+Gc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+Gc),t&&(this._element.style.height=t+Gc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+Gc),t&&(this._element.style.marginLeft=t+Gc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const she="ht__manualRowMove--backlight";class ohe extends y${build(){super.build(),ue(this._element,she)}}const ahe="ht__manualRowMove--guideline";class lhe extends y${build(){super.build(),ue(this._element,ahe)}}function uhe(n,e){C$(n,e),e.add(n)}function jc(n,e,t){C$(n,e),e.set(n,t)}function C$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lh(n,e,t){return n.set(zl(n,e),t),t}function it(n,e){return n.get(zl(n,e))}function zl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ie.getSingleton().register("beforeRowMove");Ie.getSingleton().register("afterRowMove");const WT="manualRowMove",hhe=140,SH="ht__manualRowMove",Ly="show-ui",AN="on-moving--rows",NN="after-selection--rows";var ui=new WeakMap,Jl=new WeakMap,ol=new WeakMap,lu=new WeakMap,_i=new WeakMap,xw=new WeakMap,lh=new WeakSet;class che extends Wt{constructor(){super(...arguments),uhe(this,lh),jc(this,ui,new ohe(this.hot)),jc(this,Jl,new lhe(this.hot)),jc(this,ol,[]),jc(this,lu,void 0),jc(this,_i,{}),jc(this,xw,void 0)}static get PLUGIN_KEY(){return WT}static get PLUGIN_PRIORITY(){return hhe}isEnabled(){return!!this.hot.getSettings()[WT]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zl(lh,e,dhe).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zl(lh,e,mhe).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>zl(lh,this,phe).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zl(lh,e,whe).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ue(this.hot.rootElement,SH),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){rt(this.hot.rootElement,SH),this.unregisterEvents(),it(ui,this).destroy(),it(Jl,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const r=it(xw,this),i=this.isMovePossible(e,t),s=this.hot.runHooks("beforeRowMove",e,t,r,i);if(Lh(xw,this,void 0),s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,t);const o=i&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,r,i,o),o}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const r=this.countFinalIndex(e,t);return Lh(xw,this,t),this.moveRows(e,r)}isMovePossible(e,t){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>r,s=t<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isRowOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}countFinalIndex(e,t){const r=gi(e,(i,s)=>(s<t&&(i+=1),i),0);return t-r}getRowsHeight(e,t){const r=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=t;s++){const o=r.getRenderableFromVisualIndex(s);o!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[WT];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:r,to:i}=e,s=Math.min(r.row,i.row),o=Math.max(r.row,i.row);return He(s,o,a=>{t.push(a)}),t}refreshPositions(){const e=it(_i,this).coords,t=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=it(_i,this).TD,a=this.hot.rootElement,l=br(a),u=kd(a),h=s.holder.scrollTop,c=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-c,f=it(_i,this).eventPageY-d+h,m=s.hider.offsetHeight,p=s.TBODY.offsetTop,v=it(ui,this).getOffset().top,y=it(ui,this).getSize().height,S=o.offsetHeight/2,R=o.offsetHeight;let T=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const I=f>=T+S;this.isFixedRowTop(e.row)&&(T+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?it(_i,this).row=t>0?t-1:t:I?(it(_i,this).row=e.row+1,T+=e.row===0?R-1:R):it(_i,this).row=e.row;let H=f,k=T;f+y+v>=m?H=m-y-v:f+v<p&&(H=p+Math.abs(v)),T>=m-1&&(k=m-1),it(ui,this).setPosition(H),it(Jl,this).setPosition(k)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>zl(lh,this,fhe).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>zl(lh,this,ghe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){it(ui,this).build(),it(Jl,this).build()}destroy(){it(ui,this).destroy(),it(Jl,this).destroy(),super.destroy()}}function dhe(n,e,t,r){const{wtTable:i,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!o||it(lu,this)||n.button!==0){Lh(lu,this,!1),it(ol,this).length=0,rt(this.hot.rootElement,[AN,Ly]);return}const l=it(Jl,this).isBuilt()&&!it(Jl,this).isAppended(),u=it(ui,this).isBuilt()&&!it(ui,this).isAppended();l&&u&&(it(Jl,this).appendTo(i.hider),it(ui,this).appendTo(i.hider));const{from:h,to:c}=a,d=Math.min(h.row,c.row),f=Math.max(h.row,c.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,Lh(lu,this,!0),it(_i,this).eventPageY=n.pageY,it(_i,this).coords=e,it(_i,this).TD=t,Lh(ol,this,this.prepareRowsToMoving());const m=i.holder.scrollLeft+s.getRowHeaderWidth(),p=this.getRowsHeight(d,e.row-1)+n.offsetY;it(ui,this).setPosition(null,m),it(ui,this).setSize(i.hider.offsetWidth-m,this.getRowsHeight(d,f)),it(ui,this).setOffset(-p,null),ue(this.hot.rootElement,AN),this.refreshPositions()}else rt(this.hot.rootElement,NN),Lh(lu,this,!1),it(ol,this).length=0}function fhe(n){it(lu,this)&&(it(_i,this).eventPageY=n.pageY,this.refreshPositions())}function mhe(n,e,t,r){!this.hot.getSelectedRangeLast()||!it(lu,this)||(it(ol,this).indexOf(e.row)>-1?rt(this.hot.rootElement,Ly):ue(this.hot.rootElement,Ly),r.row=!0,r.column=!0,r.cell=!0,it(_i,this).coords=e,it(_i,this).TD=t)}function ghe(){const n=it(_i,this).row,e=it(ol,this).length;if(Lh(lu,this,!1),rt(this.hot.rootElement,[AN,Ly,NN]),this.hot.selection.isSelectedByRowHeader()&&ue(this.hot.rootElement,NN),e<1||n===void 0)return;const t=it(ol,this)[0],r=this.hot.toPhysicalRow(t),i=this.dragRows(it(ol,this),n);if(it(ol,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(r),o=s+e-1;this.hot.selectRows(s,o)}}function phe(){const n=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),t=n.holder.scrollLeft,r=e+t;it(ui,this).setPosition(null,r),it(ui,this).setSize(n.hider.offsetWidth-r)}function whe(){this.moveBySettingsOrLoad()}function vhe(n,e){S$(n,e),e.add(n)}function zr(n,e,t){S$(n,e),e.set(n,t)}function S$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mn(n,e,t){return n.set(Qa(n,e),t),t}function ye(n,e){return n.get(Qa(n,e))}function Qa(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Dy="manualRowResize",yhe=30,RH="manualRowHeights";var Qo=new WeakMap,Pw=new WeakMap,Qi=new WeakMap,Vm=new WeakMap,eu=new WeakMap,NO=new WeakMap,Md=new WeakMap,Lw=new WeakMap,si=new WeakMap,qo=new WeakMap,qh=new WeakMap,Hy=new WeakMap,Um=new WeakMap,Bm=new WeakMap,oo=new WeakMap,Wm=new WeakMap,kl=new WeakSet;class Che extends Wt{static get PLUGIN_KEY(){return Dy}static get PLUGIN_PRIORITY(){return yhe}constructor(e){super(e),vhe(this,kl),zr(this,Qo,null),zr(this,Pw,null),zr(this,Qi,[]),zr(this,Vm,null),zr(this,eu,null),zr(this,NO,null),zr(this,Md,null),zr(this,Lw,null),zr(this,si,this.hot.rootDocument.createElement("DIV")),zr(this,qo,this.hot.rootDocument.createElement("DIV")),zr(this,qh,!1),zr(this,Hy,!1),zr(this,Um,0),zr(this,Bm,null),zr(this,oo,void 0),zr(this,Wm,void 0),ue(ye(si,this),"manualRowResizer"),ue(ye(qo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Dy]}enablePlugin(){this.enabled||(Mn(oo,this,new bu),ye(oo,this).addLocalHook("init",()=>Qa(kl,this,Nhe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ye(oo,this)),this.addHook("modifyRowHeight",(e,t)=>Qa(kl,this,Ahe).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Mn(Wm,this,ye(oo,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",RH,ye(oo,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",RH,e),e.value}setManualSize(e,t){const r=this.hot.toPhysicalRow(e),i=Math.max(t,LU);return ye(oo,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return ye(Vm,this)}setupHandlePosition(e){Mn(Qo,this,e);const{view:t}=this.hot,{_wt:r}=t,i=r.wtTable.getCoords(ye(Qo,this)),s=i.row;if(s<0)return;const o=gn(ye(Qo,this)),a=ye(Qo,this).getBoundingClientRect(),l=s<r.getSetting("fixedRowsTop"),u=s>=t.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let h;l?h=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ye(Qo,this),i.row,i.col):u&&(h=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ye(Qo,this),i.row,i.col)),h||(h=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ye(Qo,this),i.row,i.col)),Mn(Pw,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),Mn(Qi,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){const d=this.hot.getSelectedRange();D(d,f=>{const m=f.getTopStartCorner().row,p=f.getBottomStartCorner().row;He(m,p,v=>{ye(Qi,this).includes(v)||ye(Qi,this).push(v)})})}ye(Qi,this).includes(ye(Pw,this))||Mn(Qi,this,[ye(Pw,this)]),Mn(Lw,this,h.top-6),Mn(Md,this,parseInt(a.height,10)),ye(si,this).style.top=`${ye(Lw,this)+ye(Md,this)}px`,ye(si,this).style[this.inlineDir]=`${h.start}px`,ye(si,this).style.width=`${o}px`,this.hot.rootElement.appendChild(ye(si,this))}refreshHandlePosition(){ye(si,this).style.top=`${ye(Lw,this)+ye(Vm,this)}px`}setupGuidePosition(){const e=parseInt(gn(ye(si,this)),10),t=parseInt(ye(si,this).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ue(ye(si,this),"active"),ue(ye(qo,this),"active"),ye(qo,this).style.top=ye(si,this).style.top,ye(qo,this).style[this.inlineDir]=`${t}px`,ye(qo,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ye(qo,this))}refreshGuidePosition(){ye(qo,this).style.top=ye(si,this).style.top}hideHandleAndGuide(){rt(ye(si,this),"active"),rt(ye(qo,this),"active")}checkIfRowHeader(e){const t=Bh(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&ye(eu,this)<t?t:ye(eu,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(r,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);s!==void 0&&Mn(eu,this,s),this.setManualSize(r,ye(eu,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ye(Um,this)>=2&&(ye(Qi,this).length>1?(D(ye(Qi,this),i=>{t(i)}),e()):D(ye(Qi,this),i=>{t(i,!0)})),Mn(Um,this,0),Mn(Bm,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Qa(kl,this,She).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Qa(kl,this,Rhe).call(this,r)),this.eventManager.addEventListener(t,"mousemove",r=>Qa(kl,this,Ehe).call(this,r)),this.eventManager.addEventListener(t,"mouseup",()=>Qa(kl,this,bhe).call(this)),this.eventManager.addEventListener(ye(si,this),"contextmenu",()=>Qa(kl,this,The).call(this))}destroy(){super.destroy()}}function She(n){if(!hU(n.target)&&ye(Hy,this)!==!0&&this.checkIfRowHeader(n.target)){const e=this.getClosestTHParent(n.target);e&&(ye(qh,this)||this.setupHandlePosition(e))}}function Rhe(n){Je(n.target,"manualRowResizer")&&(this.setupHandlePosition(ye(Qo,this)),this.setupGuidePosition(),Mn(qh,this,!0),ye(Bm,this)===null&&(Mn(Bm,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ye(Bm,this))),Mn(Um,this,ye(Um,this)+1),Mn(NO,this,n.pageY),Mn(eu,this,ye(Md,this)))}function Ehe(n){ye(qh,this)&&(Mn(Vm,this,ye(Md,this)+(n.pageY-ye(NO,this))),D(ye(Qi,this),e=>{Mn(eu,this,this.setManualSize(e,ye(Vm,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function bhe(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),r&&n(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};ye(qh,this)&&(this.hideHandleAndGuide(),Mn(qh,this,!1),ye(eu,this)!==ye(Md,this)&&(ye(Qi,this).length>1?(D(ye(Qi,this),r=>{e(r)}),n()):D(ye(Qi,this),r=>{e(r,!0)})),this.setupHandlePosition(ye(Qo,this)))}function The(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ye(si,this)),this.hot.rootElement.removeChild(ye(qo,this)),Mn(qh,this,!1),Mn(Hy,this,!0),this.hot._registerImmediate(()=>{Mn(Hy,this,!1)})}function Ahe(n,e){let t=n;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ye(oo,this).getValueAtIndex(r);this.hot.getSettings()[Dy]&&i&&(t=i)}return t}function Nhe(){const n=this.hot.getSettings()[Dy],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((t,r)=>{ye(oo,this).setValueAtIndex(r,t)}):Array.isArray(n)?(n.forEach((t,r)=>{ye(oo,this).setValueAtIndex(r,t)}),Mn(Wm,this,n)):n===!0&&Array.isArray(ye(Wm,this))&&ye(Wm,this).forEach((t,r)=>{ye(oo,this).setValueAtIndex(r,t)})},!0)}function Ihe(n,e,t){Mhe(n,e),e.set(n,t)}function Mhe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uh(n,e,t){return(e=Ohe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ohe(n){var e=_he(n,"string");return typeof e=="symbol"?e:e+""}function _he(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function EH(n,e){return n.get(R$(n,e))}function Dw(n,e,t){return n.set(R$(n,e),t),t}function R$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var hh=new WeakMap;class Zo{constructor(e,t,r,i,s,o){uh(this,"row",void 0),uh(this,"col",void 0),uh(this,"rowspan",void 0),uh(this,"colspan",void 0),uh(this,"removed",!1),uh(this,"cellCoordsFactory",void 0),uh(this,"cellRangeFactory",void 0),Ihe(this,hh,null),this.row=e,this.col=t,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:r,rowspan:i,colspan:s}=e;return Yt`The merged cell declared with {row: ${t}, col: ${r},\x20
      rowspan: ${i}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:r}=e;return Yt`The merged cell declared at [${t}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:r}=e;return Yt`The merged cell declared at [${t}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:r}=e;return Yt`The merged cell declared at [${t}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:r,rowspan:i,colspan:s}=e;return t<0||r<0||i<0||s<0}static isSingleCell(e){let{rowspan:t,colspan:r}=e;return r===1&&t===1}static containsZeroSpan(e){let{rowspan:t,colspan:r}=e;return r===0||t===0}static isOutOfBounds(e,t,r){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const t=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),Dw(hh,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const r=e[0]||e[1],i=t+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(t,i),l=Math.max(t,i),u=this[o],h=this[o]+this[s]-1;if(u>=t&&(this[o]+=r),r>0)t<=h&&t>u&&(this[s]+=r);else if(r<0){if(a<=u&&l>=h)return this.removed=!0,Dw(hh,this,null),!1;if(u>=a&&u<=l){const c=l-u+1,d=Math.abs(r)-c;this[o]-=d+r,this[s]-=c}else if(u<=a&&h>=l)this[s]+=r;else if(u<=a&&h>=a&&h<l){const c=h-a+1;this[s]-=c}}return Dw(hh,this,null),!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return EH(hh,this)||Dw(hh,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),EH(hh,this)}}function xhe(n,e){Phe(n,e),e.add(n)}function Phe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hw(n,e,t){return(e=Lhe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Lhe(n){var e=Dhe(n,"string");return typeof e=="symbol"?e:e+""}function Dhe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ch(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Vl=new WeakSet;class Fy{constructor(e){xhe(this,Vl),Hw(this,"plugin",void 0),Hw(this,"mergedCells",[]),Hw(this,"mergedCellsMatrix",new Map),Hw(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:r}=e;return Yt`The merged cell declared at [${t}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(t))!==null&&r!==void 0?r:!1}getByRange(e){let t=!1;return D(this.mergedCells,r=>r.row<=e.from.row&&r.row+r.rowspan-1>=e.to.row&&r.col<=e.from.col&&r.col+r.colspan-1>=e.to.col?(t=r,t):!0),t}filterOverlappingMergeCells(e){const t=new Set;return this.mergedCells.forEach(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i;for(let u=s;u<s+l;u++)for(let h=o;h<o+a;h++)t.add(`r${u},c${h}`)}),e.filter(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i,u=new Set;let h=!1;for(let c=s;c<s+l;c++){for(let d=o;d<o+a;d++){const f=`r${c},c${d}`;if(t.has(f)){zt(Fy.IS_OVERLAPPING_WARNING(i)),h=!0;break}u.add(f)}if(h)break}return h||t.add(...u),!h})}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=r;l<=s;l++)for(let u=i;u<=o;u++){const h=this.get(l,u);h&&(t||!t&&h.row===l&&h.col===u)&&a.push(h)}return a}add(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,s=e.rowspan,o=e.colspan,a=new Zo(r,i,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=t?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),ch(Vl,this,bH).call(this,a),a):(zt(Fy.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,t){const r=this.get(e,t),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),ch(Vl,this,Hhe).call(this,r),r):!1}clear(){D(this.mergedCells,e=>{let{row:t,col:r,rowspan:i,colspan:s}=e;He(t,t+i,o=>{He(r,r+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(t))return!0;return!1}isFirstRenderableMergedCell(e,t){const r=this.get(e,t);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===t}getFirstRenderableCoords(e,t){const r=this.get(e,t);if(!r||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,s)}getStartMostColumnIndex(e,t){const r=ch(Vl,this,Fw).call(this,e,"col",-1);let i=t;for(let s=0;s<r.length;s++)if(r[s]<=t){i=r[s];break}return i}getEndMostColumnIndex(e,t){const r=ch(Vl,this,Fw).call(this,e,"col",1);let i=t;for(let s=0;s<r.length;s++)if(r[s]>=t){i=r[s];break}return i}getTopMostRowIndex(e,t){const r=ch(Vl,this,Fw).call(this,e,"row",-1);let i=t;for(let s=0;s<r.length;s++)if(r[s]<=t){i=r[s];break}return i}getBottomMostRowIndex(e,t){const r=ch(Vl,this,Fw).call(this,e,"row",1);let i=t;for(let s=0;s<r.length;s++)if(r[s]>=t){i=r[s];break}return i}shiftCollections(e,t,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const s=[];this.mergedCells.forEach(o=>{o.shift(i,t),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{ch(Vl,this,bH).call(this,o)})}}function Fw(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=t===1?n.getTopStartCorner():n.getBottomEndCorner(),s=t===1?n.getBottomEndCorner():n.getTopStartCorner();for(let o=i.row;t===1?o<=s.row:o>=s.row;o+=t)for(let a=i.col;t===1?a<=s.col:a>=s.col;a+=t){const l=e==="row"?o:a,u=this.get(o,a);let h=l;u&&(h=t===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(h)}return Array.from(new Set(Array.from(r.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function bH(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(t,n)}function Hhe(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.get(e).delete(t)}function $T(n,e,t){return(e=Fhe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Fhe(n){var e=khe(n,"string");return typeof e=="symbol"?e:e+""}function khe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Vhe{constructor(e){$T(this,"plugin",void 0),$T(this,"mergedCellsCollection",void 0),$T(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let r=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?r="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?r="up":t[1]===e[1]&&t[2]===e[2]?r="right":r="left",r}snapDragArea(e,t,r,i){const s=t.slice(0),o=this.getAutofillSize(e,t,r),[a,l,u,h]=e,d=["up","down"].indexOf(r)>-1?u-a+1:h-l+1,f=Math.floor(o/d)*d,m=o-f,p=this.getFarthestCollection(e,t,r,i);if(p){if(r==="down"){const v=p.row+p.rowspan-a-m;s[2]+v>=this.plugin.hot.countRows()?s[2]-=m:s[2]+=m?v:0}else if(r==="right"){const v=p.col+p.colspan-l-m;s[3]+v>=this.plugin.hot.countCols()?s[3]-=m:s[3]+=m?v:0}else if(r==="up"){const v=u-m-p.row+1;s[0]+v<0?s[0]+=m:s[0]-=m?v:0}else if(r==="left"){const v=h-m-p.col+1;s[1]+v<0?s[1]+=m:s[1]-=m?v:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:o,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),ir(this.currentFillData,e)}getAutofillSize(e,t,r){const[i,s,o,a]=e,[l,u,h,c]=t;switch(r){case"up":return i-l;case"down":return h-o;case"left":return s-u;case"right":return c-a;default:return null}}getDragArea(e,t,r){const[i,s,o,a]=e,[l,u,h,c]=t;switch(r){case"up":return[l,u,i-1,a];case"down":return[o+1,s,h,a];case"left":return[l,u,o,s-1];case"right":return[i,a+1,h,c];default:return null}}getFarthestCollection(e,t,r,i){const[s,o,a,l]=e,u=["up","down"].indexOf(r)>-1,h=u?a:l,c=u?s:o,d=this.getAutofillSize(e,t,r),f=u?a-s+1:l-o+1,m=Math.floor(d/f)*f,p=d-m;let v=null,y=null,S=null;switch(r){case"up":v="includesVertically",S=h-p+1;break;case"left":v="includesHorizontally",S=h-p+1;break;case"down":v="includesVertically",S=c+p-1;break;case"right":v="includesHorizontally",S=c+p-1;break}return D(i,R=>{R[v](S)&&R.isFarther(y,r)&&(y=R)}),y}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(u,h)=>{switch(i){case"up":return u.row-h>=t.from.row;case"down":return u.row+u.rowspan-1+h<=t.to.row;case"left":return u.col-h>=t.from.column;case"right":return u.col+u.colspan-1+h<=t.to.column;default:return null}};let o=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],o=l*this.currentFillData.cycleLength,s(a,o))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},r={min:null,max:null};return D(e,i=>{const s=i[0],o=this.plugin.hot.propToCol(i[1]);(t.min===null||s<t.min)&&(t.min=s),(t.max===null||s>t.max)&&(t.max=s),(r.min===null||o<r.min)&&(r.min=o),(r.max===null||o>r.max)&&(r.max=o)}),{from:{row:t.min,column:r.min},to:{row:t.max,column:r.max}}}dragAreaOverlapsCollections(e,t,r){const i=this.getDragArea(e,t,r),[s,o,a,l]=i,u=this.plugin.hot._createCellCoords(s,o),h=this.plugin.hot._createCellCoords(a,l),c=this.plugin.hot._createCellRange(u,u,h);return this.mergedCellsCollection.getWithinRange(c,!0).length>0}}function GT(n,e,t){return(e=Uhe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Uhe(n){var e=Bhe(n,"string");return typeof e=="symbol"?e:e+""}function Bhe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Whe{constructor(e){GT(this,"plugin",void 0),GT(this,"hot",void 0),GT(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,r,i){const s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const h=this.plugin.mergedCellsCollection.get(e,t);if(!h)return;const c=h.getLastRow(),d=h.getLastColumn();if(s<=h.row&&o<=h.col&&a>=c&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(h,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const r=[];if(!t||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<r.length;i+=1){const s=[];for(let o=0;o<t.length;o+=1)s[o]=t[o].includes(r[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function $he(n){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(qI)}return this.getTranslatedPhrase(KI)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;n.toggleMerge(e),this.selectCell(t.row,t.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?Zo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function $m(n,e,t){return(e=Ghe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ghe(n){var e=jhe(n,"string");return typeof e=="symbol"?e:e+""}function jhe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class TH{constructor(e){$m(this,"data",void 0),$m(this,"next",null),$m(this,"prev",null),this.data=e}}class kw{constructor(){$m(this,"first",null),$m(this,"last",null)}push(e){const t=new TH(e);if(this.first===null)this.first=t,this.last=t;else{const r=this.last;this.last=t,t.prev=r,r.next=t}return t}unshift(e){const t=new TH(e);if(this.first===null)this.first=t,this.last=t;else{const r=this.first;this.first=t,t.next=r,r.prev=t}}inorder(e){let t=this.first;for(;t;){const r=e(t);if(t===this.last||r===!0)break;t=t.next}}remove(e){if(this.first===null)return!1;let t=this.first,r,i;for(;t;){if(t.data===e)return r=t.next,i=t.prev,r&&(r.prev=i),i&&(i.next=r),t===this.first&&(this.first=r),t===this.last&&(this.last=i),!0;t=t.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,t=this.first,r;for(;e;)r=e.next,e.next=t,t.prev=e,t=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=t,this.last=r}}function zhe(n,e){E$(n,e),e.add(n)}function dh(n,e,t){E$(n,e),e.set(n,t)}function E$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bt(n,e){return n.get(ky(n,e))}function $i(n,e,t){return n.set(ky(n,e),t),t}function ky(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Bo=new WeakMap,Wo=new WeakMap,$o=new WeakMap,Go=new WeakMap,IN=new WeakMap,Vw=new WeakMap,Uw=new WeakMap,jT=new WeakSet;class Yhe{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:r,columnIndexMapper:i}=e;zhe(this,jT),dh(this,Bo,new kw),dh(this,Wo,new kw),dh(this,$o,null),dh(this,Go,null),dh(this,IN,null),dh(this,Vw,null),dh(this,Uw,null),$i(IN,this,t),$i(Vw,this,r),$i(Uw,this,i)}getCurrentVerticalNode(){return Bt(Go,this).data}getFirstVerticalNode(){return Bt(Wo,this).first.data}getNextVerticalNode(){return Bt(Go,this).next.data}getPrevVerticalNode(){return Bt(Go,this).prev.data}getCurrentHorizontalNode(){return Bt($o,this).data}getFirstHorizontalNode(){return Bt(Bo,this).first.data}getNextHorizontalNode(){return Bt($o,this).next.data}getPrevHorizontalNode(){return Bt($o,this).prev.data}setPrevNodeAsActive(){$i(Go,this,Bt(Go,this).prev),$i($o,this,Bt($o,this).prev)}setNextNodeAsActive(){$i(Go,this,Bt(Go,this).next),$i($o,this,Bt($o,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;$i(Bo,this,new kw);for(let o=t.row;o<=r.row;o++)if(!Bt(Vw,this).isHidden(o))for(let a=t.col;a<=r.col;a++){if(Bt(Uw,this).isHidden(a))continue;const l=ky(jT,this,AH).call(this,e,Bt(Bo,this),i,o,a);l&&$i($o,this,l)}Bt(Bo,this).first&&(Bt(Bo,this).first.prev=Bt(Bo,this).last,Bt(Bo,this).last.next=Bt(Bo,this).first);const s=new WeakSet;$i(Wo,this,new kw);for(let o=t.col;o<=r.col;o++)if(!Bt(Uw,this).isHidden(o))for(let a=t.row;a<=r.row;a++){if(Bt(Vw,this).isHidden(a))continue;const l=ky(jT,this,AH).call(this,e,Bt(Wo,this),s,a,o);l&&$i(Go,this,l)}Bt(Wo,this).first&&(Bt(Wo,this).first.prev=Bt(Wo,this).last,Bt(Wo,this).last.next=Bt(Wo,this).first)}setActiveNode(e,t){return Bt(Bo,this).inorder(r=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=r.data;if(e>=i&&e<=s&&t>=o&&t<=a)return $i($o,this,r),!1}),Bt(Wo,this).inorder(r=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=r.data;if(e>=i&&e<=s&&t>=o&&t<=a)return $i(Go,this,r),!1}),this}}function AH(n,e,t,r,i){const s=n.getTopStartCorner(),o=n.getBottomEndCorner(),a=n.highlight.clone().normalize(),l=Bt(IN,this).call(this,r,i);if(l&&t.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(t.add(l),l.row<s.row||l.row+l.rowspan-1>o.row||l.col<s.col||l.col+l.colspan-1>o.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const h=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?h:null}function Khe(n){const{hot:e}=n,{rowIndexMapper:t,columnIndexMapper:r}=e;function i(){}function s(o,a,l){const u=n.mergedCellsCollection.get(a,l);if(!mt(u)){o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="";return}const{row:h,col:c,colspan:d,rowspan:f}=u,[m,p]=n.translateMergedCellToRenderable(h,f,c,d),v=t.getRenderableFromVisualIndex(a),y=r.getRenderableFromVisualIndex(l),S=m-v+1,R=p-y+1,T=t.getNearestNotHiddenIndex(h,1),I=r.getNearestNotHiddenIndex(c,1),H=Math.min(f,S),k=Math.min(d,R);T===a&&I===l?(o.setAttribute("rowspan",H),o.setAttribute("colspan",k)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}return{before:i,after:s}}function qhe(n,e){b$(n,e),e.add(n)}function Bw(n,e,t){b$(n,e),e.set(n,t)}function b$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zT(n,e,t){return(e=Xhe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Xhe(n){var e=Qhe(n,"string");return typeof e=="symbol"?e:e+""}function Qhe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Rg(n,e,t){return n.set(Gt(n,e),t),t}function un(n,e){return n.get(Gt(n,e))}function Gt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ie.getSingleton().register("beforeMergeCells");Ie.getSingleton().register("afterMergeCells");Ie.getSingleton().register("beforeUnmergeCells");Ie.getSingleton().register("afterUnmergeCells");const Gm="mergeCells",Zhe=150,NH=Gm;var bs=new WeakMap,Ts=new WeakMap,la=new WeakMap,IH=new WeakMap,qt=new WeakSet;class Jhe extends Wt{constructor(){super(...arguments),qhe(this,qt),zT(this,"mergedCellsCollection",null),zT(this,"autofillCalculations",null),zT(this,"selectionCalculations",null),Bw(this,bs,null),Bw(this,Ts,{row:0,col:0}),Bw(this,la,new Yhe({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Bw(this,IH,Khe(this))}static get PLUGIN_KEY(){return Gm}static get PLUGIN_PRIORITY(){return Zhe}isEnabled(){return!!this.hot.getSettings()[Gm]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Fy(this),this.autofillCalculations=new Vhe(this),this.selectionCalculations=new Whe(this),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,ece).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,nce).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,rce).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,ice).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,sce).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,MH).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,MH).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,lce).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,uce).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,hce).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,oce).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,tce).call(e,...r)}),this.addHook("afterRenderer",function(){return un(IH,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,ace).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,cce).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,dce).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,fce).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,mce).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,gce).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,pce).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,wce).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,vce).call(e,...r)}),this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,yce).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,Cce).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,Sce).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,Rce).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,Ece).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(qt,e,bce).call(e,...r)}),this.addHook("beforeUndoStackChange",(t,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Gm];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!gU())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:s}=r;for(let o=i+1;o<i+s;o++)t.push(o)}),t=[...new Set(t)],t.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>s?.name==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(i);o&&(o.style.background=og(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=og(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?Zo.containsNegativeValues(e)?(zt(Zo.NEGATIVE_VALUES_WARNING(e)),!1):Zo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(zt(Zo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Zo.isSingleCell(e)?(zt(Zo.IS_SINGLE_CELL(e)),!1):Zo.containsZeroSpan(e)?(zt(Zo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(e){if(!Array.isArray(e))return;const t=e.filter(s=>this.validateSetting(s)),r=this.mergedCellsCollection.filterOverlappingMergeCells(t),i=[];r.forEach(s=>{const{row:o,col:a,rowspan:l,colspan:u}=s,h=this.hot._createCellCoords(o,a),c=this.hot._createCellCoords(o+l-1,a+u-1),d=this.hot._createCellRange(h,h,c);this.mergeRange(d,!0,!0);for(let f=o;f<o+l;f++)for(let m=a;m<a+u;m++)(f!==o||m!==a)&&i.push([f,m,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},a=[];let l=null;return this.canMergeRange(o,t)?(this.hot.runHooks("beforeMergeCells",e,t),He(0,o.rowspan-1,h=>{He(0,o.colspan-1,c=>{let d=null;a[h]||(a[h]=[]),h===0&&c===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+h,o.col+c,"hidden",!0),a[h][c]=d})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,t)?(r?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,t),l):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,t),D(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),He(0,i.rowspan-1,s=>{He(0,i.colspan-1,o=>{this.hot.removeCellMeta(i.row+s,i.col+o,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+o,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,r,i){const s=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,t,r,i){const s=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:NH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(NH)}modifyViewportRowStart(e,t){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(i,s);if(mt(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(i,s);if(mt(o)){const a=o.row+o.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,t);return}}}}modifyViewportColumnStart(e,t){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(s,i);if(mt(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(s,i);if(mt(o)){const a=o.col+o.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,r,i){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;t===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+t-1,-1),i===0?l=o.getNearestNotHiddenIndex(r,1):l=o.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?s.getRenderableFromVisualIndex(a):e,h=r>=0?o.getRenderableFromVisualIndex(l):r;return[u,h]}}function ece(){this.generateFromSettings(this.hot.getSettings()[Gm]),this.hot.render()}function tce(n){if(n){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),r=t.getTopStartCorner(),i=t.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(r.row===e[s].row&&r.col===e[s].col&&i.row===e[s].row+e[s].rowspan-1&&i.col===e[s].col+e[s].colspan-1)return!1}return n}function nce(n){un(Ts,this).row=n.row,un(Ts,this).col=n.col}function rce(n){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;un(bs,this)&&(i.getRenderableFromVisualIndex(un(bs,this).row)!==null&&(t.row=un(bs,this).row),r.getRenderableFromVisualIndex(un(bs,this).col)!==null&&(t.col=un(bs,this).col),Rg(bs,this,null));const s=this.mergedCellsCollection.get(t.row,t.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(n.col<0){const h=t.col>=o&&t.col<=a?o-1:a,c=r.getNearestNotHiddenIndex(h,-1);c===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(c,t.col)-1,1)}else if(n.col>0){const h=t.col>=o&&t.col<=a?a+1:o,c=r.getNearestNotHiddenIndex(h,1);c===null?n.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,c)-1,1)}const l=s.row,u=s.row+s.rowspan-1;if(n.row<0){const h=t.row>=l&&t.row<=u?l-1:u,c=i.getNearestNotHiddenIndex(h,-1);c===null?n.row=-this.hot.view.countRenderableRowsInRange(0,t.row):n.row=-Math.max(this.hot.view.countRenderableRowsInRange(c,t.row)-1,1)}else if(n.row>0){const h=t.row>=l&&t.row<=u?u+1:l,c=i.getNearestNotHiddenIndex(h,1);c===null?n.row=this.hot.view.countRenderableRowsInRange(t.row,this.hot.countRows()):n.row=Math.max(this.hot.view.countRenderableRowsInRange(t.row,c)-1,1)}}function ice(n){const e=this.hot.getSelectedRangeLast(),t=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot,o=(a,l)=>{t.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(n.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+n.col;o(r.row,a),e.getHorizontalDirection()==="E-W"&&t.getHorizontalDirection()==="E-W"&&(a=t.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(n.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+n.col;o(r.row,a),e.getHorizontalDirection()==="W-E"&&t.getHorizontalDirection()==="W-E"&&(a=t.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(n.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(n.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+n.row;o(a,r.col),e.getVerticalDirection()==="S-N"&&t.getVerticalDirection()==="S-N"&&(a=t.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(n.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(n.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+n.row;o(a,r.col),e.getVerticalDirection()==="N-S"&&t.getVerticalDirection()==="N-S"&&(a=t.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(n.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function sce(){const n=this.hot.getSelectedRangeLast(),{highlight:e}=n;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Rg(bs,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const t=this.mergedCellsCollection.get(e.row,e.col);Rg(bs,this,e.clone()),t&&e.assign(t)}function oce(n,e){if(n<0||e<0)return;const t=this.mergedCellsCollection.get(n,e);if(!t)return;const{row:r,col:i,colspan:s,rowspan:o}=t;return[r,i,r+o-1,i+s-1]}function ace(n){n.items.push({name:"---------"},$he(this))}function MH(){Rg(bs,this,null)}function lce(){if(un(bs,this).isCell())return;const n=this.hot.getSelectedRangeLast(),e=n.getVerticalDirection(),t=n.getHorizontalDirection(),r=un(bs,this).clone().normalize();un(la,this).setActiveNode(r.row,r.col),un(Ts,this).row>0||un(Ts,this).col>0?un(la,this).setPrevNodeAsActive():(t==="E-W"&&un(Ts,this).col<0||e==="S-N"&&un(Ts,this).row<0)&&un(la,this).setNextNodeAsActive()}function uce(n,e){const t=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let s=null,o=null;if(un(Ts,this).col<0){const{rowEnd:a,colEnd:l}=un(la,this).getPrevHorizontalNode();o=r.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(un(Ts,this).col>0){const{rowStart:a,colStart:l}=un(la,this).getNextHorizontalNode();o=r.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}else if(un(Ts,this).row<0){const{rowEnd:a,colEnd:l}=un(la,this).getPrevVerticalNode();o=r.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(un(Ts,this).row>0){const{rowStart:a,colStart:l}=un(la,this).getNextVerticalNode();o=r.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}if(s!==null||o!==null){const a=this.hot._createCellCoords(s,o),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();n=a.row,e=a.col,l?t.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):t.highlight.assign(a),u.clear(),u.add(a).commit()}un(la,this).setActiveNode(n,e),Rg(Ts,this,{row:0,col:0})}function hce(){this.hot.getSelectedRangeLast().isHeader()||un(la,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function cce(n,e,t){const r=this.mergedCellsCollection.get(n,e);r&&(r.row!==n||r.col!==e?t.copyable=!1:(t.rowspan=r.rowspan,t.colspan=r.colspan))}function dce(n){const e=this.hot.countCols();this.modifyViewportRowStart(n,e),this.modifyViewportRowEnd(n,e)}function fce(n){const e=this.hot.countRows();this.modifyViewportColumnStart(n,e),this.modifyViewportColumnEnd(n,e)}function mce(n,e){this.autofillCalculations.correctSelectionAreaSize(e);const t=this.autofillCalculations.getDirection(e,n);let r=n;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,t))return r=e,r;const i=this.hot._createCellCoords(e[0],e[1]),s=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,s),a=this.mergedCellsCollection.getWithinRange(o);return a.length===0||(r=this.autofillCalculations.snapDragArea(e,r,t,a)),r}function gce(n,e){this.mergedCellsCollection.shiftCollections("right",n,e)}function pce(n,e){this.mergedCellsCollection.shiftCollections("left",n,e)}function wce(n,e,t){t!=="auto"&&this.mergedCellsCollection.shiftCollections("down",n,e)}function vce(n,e){this.mergedCellsCollection.shiftCollections("up",n,e)}function yce(n,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(n)}function Cce(n,e){if(e&&e==="area"){const t=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(t);D(r,i=>{t.getBottomEndCorner().row===i.getLastRow()&&t.getBottomEndCorner().col===i.getLastColumn()&&(n[2]=i.row,n[3]=i.col)})}}function Sce(n,e,t,r){if(t)return this.selectionCalculations.getSelectedMergedCellClassName(n,e,t,r)}function Rce(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Ece(n,e,t,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(i);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(o,o,a))}function bce(n,e,t){if(this.hot.getSettings().rowHeaders||t==="bottom"||t==="bottom_inline_start_corner")return n;let r,i;if(t==="master")r=this.hot.view.getFirstRenderedVisibleColumn(),i=this.hot.view.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(t);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return n;const o=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(o,o,a),u=this.mergedCellsCollection.getWithinRange(l),h=u.reduce((d,f)=>{let{rowspan:m}=f;return Math.max(d,m)},1);let c=0;return u.length>1&&u[0].rowspan<h&&(c=h-u[0].rowspan),u.forEach(d=>{var f;let{rowspan:m}=d,p=0;t==="top"||t==="top_inline_start_corner"?p=Math.min(h,this.hot.view.countNotHiddenFixedRowsTop()-e):p=m-c,n=Math.max((f=n)!==null&&f!==void 0?f:0,Gt(qt,this,Tce).call(this,e,p))}),n}function Tce(n,e){const t=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),r=this.hot.getPlugin("autoRowSize");let i=0;for(let o=n;o<n+e;o++)if(!this.hot.rowIndexMapper.isHidden(o)){var s;i+=(s=r?.getRowHeight(o))!==null&&s!==void 0?s:t}return i}function Ace(n,e){return function(t,r){const[,...i]=t,[,...s]=r;return(function o(a){const l=n[a],u=e[a],h=i[a],c=s[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:tW(u.type))(l,u,d)(h,c);if(m===fa){const p=a+1;if(typeof e[p]<"u")return o(p)}return m})(0)}}function OH(){zt(Yt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const T$="sort";function Nce(n,e,t){const r=[];return t===!1||n.isColumnSorted(e)&&n.getNumberOfSortedColumns()>1&&r.push(`${T$}-${n.getIndexOfColumnInSortQueue(e)+1}`),r}function Ice(n){const e=n.className.split(" "),t=new RegExp(`^${T$}-[0-9]{1,2}$`);return e.filter(r=>t.test(r))}function Mce(n,e,t){return(e=Oce(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Oce(n){var e=_ce(n,"string");return typeof e=="symbol"?e:e+""}function _ce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Vy="multiColumnSorting",xce=170,YT="columnSorting",_H=Vy;eW(Vy,Ace);class Pce extends hW{constructor(){super(...arguments),Mce(this,"pluginKey",Vy)}static get PLUGIN_KEY(){return Vy}static get PLUGIN_PRIORITY(){return xce}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[YT]&&(OH(),this.hot.getPlugin(YT).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Sy)),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:Tu,position:"before",group:_H})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_H)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),rt(e,Ice(e)),this.enabled!==!1&&ue(e,Nce(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[YT]&&OH(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){fO(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,Sy))):this.sort(this.getColumnNextConfig(t.col)))}}function xH(n,e,t){return(e=Lce(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Lce(n){var e=Dce(n,"string");return typeof e=="symbol"?e:e+""}function Dce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Hce="multipleSelectionHandles",Fce=160;class kce extends Wt{constructor(){super(...arguments),xH(this,"dragged",[]),xH(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Hce}static get PLUGIN_PRIORITY(){return Fce}isEnabled(){return iu()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",i=>{let s;if(Je(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(Je(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",i=>{if(Je(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Je(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",i=>{const{rootDocument:s}=this.hot;let o,a,l,u,h,c;if(e.dragged.length===0)return;const d=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(o=e.hot.getCoords(d),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),h=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(o),c=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,h,e.dragged[0]),c.start!==null&&e.hot.selection.setRangeStart(c.start),e.hot.selection.setRangeEnd(c.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,t,r,i,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let h={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?h={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:h={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,o.col)};break;case"SE-NW":s==="bottom"&&(h={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,o.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?h={start:t,end:l}:h.end=t;break;case"NW-SE":s==="top"?h={start:t,end:a}:h.end=t;break;case"SE-NW":s==="top"?h={start:t,end:o}:h.end=t;break;case"SW-NE":s==="top"?h={start:t,end:u}:h.end=t;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?h={start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(l.row,t.col)}:h={start:this.hot._createCellCoords(o.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":s==="top"?h={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:h={start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(o.row,t.col)};break;case"SE-NW":s==="bottom"?h={start:this.hot._createCellCoords(t.row,u.col),end:this.hot._createCellCoords(o.row,t.col)}:s==="top"&&(h={start:l,end:t});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(h.end=t);break;case"SE-NW":s==="top"?h.end=t:h={start:t,end:o};break}break}return h}isDragged(){return this.dragged.length>0}}function MN(){let{label:n="",colspan:e=1,origColspan:t=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:n,colspan:e,origColspan:t,collapsible:r,isCollapsed:s,crossHiddenColumns:i,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:u}}function A$(){return{label:"",isPlaceholder:!0}}function Vce(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;D(n,i=>{const s=[];let o=0;t.push(s),D(i,a=>{const l=MN();if(mt(a)){const{label:h,colspan:c,headerClassName:d}=a;l.label=Zn(h),typeof c=="number"&&c>1&&(l.colspan=c,l.origColspan=c),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Zn(a);o+=l.origColspan;let u=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,u=!0),s.push(l),l.colspan>1)for(let h=0;h<l.colspan-1;h++)s.push(A$());return!u})});const r=Math.max(...bt(t,i=>i.length));return D(t,i=>{if(i.length<r){const s=bt(new Array(r-i.length),()=>MN());i.splice(i.length,0,...s)}}),t}function KT(n,e,t){Uce(n,e),e.set(n,t)}function Uce(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xs(n,e){return n.get(N$(n,e))}function am(n,e,t){return n.set(N$(n,e),t),t}function N$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PH=["label","collapsible"];var Ba=new WeakMap,fh=new WeakMap,qT=new WeakMap;class Bce{constructor(){KT(this,Ba,[]),KT(this,fh,0),KT(this,qT,1/0)}setColumnsLimit(e){am(qT,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];am(Ba,this,Vce(e,Xs(qT,this))),am(fh,this,Xs(Ba,this).length)}getData(){return Xs(Ba,this)}mergeWith(e){D(e,t=>{let{row:r,col:i,...s}=t;const o=this.getHeaderSettings(r,i);o!==null&&ir(o,s,PH)})}map(e){D(Xs(Ba,this),t=>{D(t,r=>{const i=e({...r});mt(i)&&ir(r,i,PH)})})}getHeaderSettings(e,t){var r;if(e>=Xs(fh,this)||e<0)return null;const i=Xs(Ba,this)[e];return Array.isArray(i)===!1||t>=i.length?null:(r=i[t])!==null&&r!==void 0?r:null}getHeadersSettings(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Xs(fh,this)||e<0)return i;const s=Xs(Ba,this)[e];let o=0;for(let a=t;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),o===r)break;if(o>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Xs(fh,this)}getColumnsCount(){return Xs(fh,this)>0?Xs(Ba,this)[0].length:0}clear(){am(Ba,this,[]),am(fh,this,0)}}function XT(n,e,t){return(e=Wce(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Wce(n){var e=$ce(n,"string");return typeof e=="symbol"?e:e+""}function $ce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const I$="DF-pre-order";function M$(n,e){let t=n.call(e,this);for(let r=0;r<this.childs.length;r++){if(t===!1)return!1;t=M$.call(this.childs[r],n,e)}return t}const Gce="DF-post-order";function O$(n,e){for(let t=0;t<this.childs.length;t++)if(O$.call(this.childs[t],n,e)===!1)return!1;return n.call(e,this)}const _$="BF";function jce(n,e){const t=[this];function r(){if(t.length===0)return;const i=t.shift();t.push(...i.childs),n.call(e,i)!==!1&&r()}r()}const zce=_$,LH=new Map([[I$,M$],[Gce,O$],[_$,jce]]);class Uy{constructor(e){XT(this,"data",{}),XT(this,"parent",null),XT(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new Uy({...e.data});for(let r=0;r<e.childs.length;r++)t.addChild(this.cloneTree(e.childs[r]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zce;if(!LH.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);LH.get(t).call(this,e,this)}walkUp(e){const t=this,r=i=>{e.call(t,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function QT(n,e,t){Yce(n,e),e.set(n,t)}function Yce(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ii(n,e){return n.get(x$(n,e))}function Kce(n,e,t){return n.set(x$(n,e),t),t}function x$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var zc=new WeakMap,mh=new WeakMap,Yc=new WeakMap;class qce{constructor(e){QT(this,zc,new Map),QT(this,mh,new Map),QT(this,Yc,null),Kce(Yc,this,e)}getRoots(){return Array.from(ii(zc,this).values())}getRootByColumn(e){let t;return ii(mh,this).has(e)&&(t=ii(zc,this).get(ii(mh,this).get(e))),t}getNode(e,t){const r=this.getRootByColumn(t);if(!r)return;const i=t-ii(mh,this).get(t);let s=0,o;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=s&&i<=s+l-1)return o=a,o.data.isRoot=t===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;ii(mh,this).clear(),D(ii(zc,this),t=>{let[,{data:{colspan:r}}]=t;for(let i=e;i<e+r;i++)ii(mh,this).set(i,e);e+=r})}buildTree(){this.clear();const e=ii(Yc,this).getColumnsCount();let t=0;for(;t<e;){const r=ii(Yc,this).getHeaderSettings(0,t),i=new Uy;ii(zc,this).set(t,i),this.buildLeaves(i,t,0,r.origColspan),t+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=ii(Yc,this).getHeadersSettings(r,t,i);r+=1,D(s,o=>{const a={...o,headerLevel:r-1,columnIndex:t};let l;r===1?(e.data=a,l=e):(l=new Uy(a),e.addChild(l)),r<ii(Yc,this).getLayersCount()&&this.buildLeaves(l,t,r,o.origColspan),t+=o.origColspan})}clear(){ii(zc,this).clear(),ii(mh,this).clear()}}function P$(n,e){n.walkDown(t=>{let{data:r,childs:i}=t;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let s=1;s<r.colspan;s++)e(r.columnIndex+s)})}function By(n,e){let{childs:t}=n;if(t.length!==0)return t[0].data[e]}function Wy(n){return By(n,"origColspan")===n.data.origColspan}function IO(n){const{data:e,childs:t}=n;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Wy(n))return IO(t[0]);e.isCollapsed=!1;const i=t.slice(1),s=new Set;let o=0;if(i.length>0)D(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,P$(a,u=>{s.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;o=l-a;for(let h=1;h<l;h++)s.add(u+h)}return n.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Wy(a)&&(l.isCollapsed=By(a,"isCollapsed"))}),{rollbackModification:()=>MO(n),affectedColumns:Array.from(s),colspanCompensation:o}}function MO(n){var e;const{data:t,childs:r}=n;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Wy(n))return MO(r[0]);t.isCollapsed=!0;const s=r.slice(1),o=new Set;if(s.length>0)D(s,l=>{P$(l,u=>{o.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:h}=u;h.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=t;for(let h=1;h<l;h++){const c=u+h;o.add(c)}}const a=t.colspan-((e=By(n,"colspan"))!==null&&e!==void 0?e:1);return n.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Wy(l)&&(u.isCollapsed=By(l,"isCollapsed"))}),{rollbackModification:()=>IO(n),affectedColumns:Array.from(o),colspanCompensation:a}}function Xce(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(Yt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(t.includes(e))return;let r=!1;n.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&n.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function Qce(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(Yt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(!t.includes(e))return;let r=!1;n.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&n.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const DH=new Map([["collapse",MO],["expand",IO],["hide-column",Xce],["show-column",Qce]]);function Zce(n,e,t){if(!DH.has(n))throw new Error(`The node modifier action ("${n}") does not exist.`);return DH.get(n)(e,t)}function Ww(n){const e=[];return D(n,t=>{t.walkDown(r=>{const i=r.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=i,u=ede(e,a);let h=!1;for(let c=o;c<o+s;c++)if(l.includes(c)||h)u.push(A$());else{const f=Jce(i);f.isRoot=!0,u.push(f),h=!0}})}),e}function Jce(n){const{crossHiddenColumns:e,...t}=MN(n);return t}function ede(n,e){let t;return Array.isArray(n[e])?t=n[e]:(t=[],n[e]=t),t}function ZT(n,e,t){tde(n,e),e.set(n,t)}function tde(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lm(n,e,t){return n.set(L$(n,e),t),t}function Nn(n,e){return n.get(L$(n,e))}function L$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var jo=new WeakMap,Ei=new WeakMap,gh=new WeakMap;class nde{constructor(){ZT(this,jo,new Bce),ZT(this,Ei,new qce(Nn(jo,this))),ZT(this,gh,[[]])}setState(e){Nn(jo,this).setData(e);let t=!1;try{Nn(Ei,this).buildTree()}catch{Nn(Ei,this).clear(),Nn(jo,this).clear(),t=!0}return lm(gh,this,Ww(Nn(Ei,this).getRoots())),t}setColumnsLimit(e){Nn(jo,this).setColumnsLimit(e)}mergeStateWith(e){const t=bt(e,r=>{let{row:i,...s}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});Nn(jo,this).mergeWith(t),Nn(Ei,this).buildTree(),lm(gh,this,Ww(Nn(Ei,this).getRoots()))}mapState(e){Nn(jo,this).map(e),Nn(Ei,this).buildTree(),lm(gh,this,Ww(Nn(Ei,this).getRoots()))}mapNodes(e){return gi(Nn(Ei,this).getRoots(),(t,r)=>(r.walkDown(i=>{const s=e(i.data);s!==void 0&&t.push(s)}),t),[])}triggerNodeModification(e,t,r){t<0&&(t=this.rowCoordsToLevel(t));const i=Nn(Ei,this).getNode(t,r);let s;return i&&(s=Zce(e,i,r),lm(gh,this,Ww(Nn(Ei,this).getRoots()))),s}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Nn(gh,this)[e])===null||i===void 0?void 0:i[t])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,t){const r=this.getHeaderTreeNode(e,t);return r?{...r.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Nn(Ei,this).getNode(e,t);return r||null}findTopMostEntireHeaderLevel(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let s=!1,o=null;for(let a=e;a<=r;a++){const l=Nn(Ei,this).getRootByColumn(a);if(!l)break;s=!0,l.walkDown(u=>{const{columnIndex:h,headerLevel:c,origColspan:d,isHidden:f}=u.data;f||d<=i&&h>=e&&h+d-1<=r&&(o===null||c<o)&&(o=c)},I$)}return s&&o===null?-1:this.levelToRowCoords((t=o)!==null&&t!==void 0?t:0)}findLeftMostColumnIndex(e,t){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0};if(i)return t;let s=t-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,t){var r;const{isRoot:i,origColspan:s}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return t+s-1;let o=t+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return Nn(jo,this).getLayersCount()}getColumnsCount(){return Nn(jo,this).getColumnsCount()}clear(){lm(gh,this,[]),Nn(jo,this).clear(),Nn(Ei,this).clear()}}function um(n,e,t){return(e=rde(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rde(n){var e=ide(n,"string");return typeof e=="symbol"?e:e+""}function ide(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class sde{constructor(e,t){um(this,"hot",void 0),um(this,"nestedHeaderSettingsGetter",void 0),um(this,"layersCount",0),um(this,"container",void 0),um(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let r=0;r<t;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),s=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(s,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:r}=this.hot,i=t.createDocumentFragment(),s=t.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=t.createElement("tr");for(let h=0;h<a;h++){let c=r.getVisualFromRenderableIndex(h);c===null&&(c=h);const d=t.createElement("th"),f=this.nestedHeaderSettingsGetter(l,c);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;o&&(m+='<button class="changeType"></button>'),ef(d,m),d.colSpan=f.colspan,u.appendChild(d)}}s.appendChild(u)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function ode(n,e){D$(n,e),e.add(n)}function HH(n,e,t){return(e=ade(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ade(n){var e=lde(n,"string");return typeof e=="symbol"?e:e+""}function lde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $w(n,e,t){D$(n,e),e.set(n,t)}function D$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dh(n,e,t){return n.set(In(n,e),t),t}function Mt(n,e){return n.get(In(n,e))}function In(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const FH="nestedHeaders",ude=280;var Zt=new WeakMap,Ul=new WeakMap,jm=new WeakMap,dS=new WeakMap,Fn=new WeakSet;class hde extends Wt{constructor(){super(...arguments),ode(this,Fn),$w(this,Zt,new nde),$w(this,Ul,null),$w(this,jm,null),$w(this,dS,!1),HH(this,"ghostTable",new sde(this.hot,(e,t)=>this.getHeaderSettings(e,t))),HH(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return FH}static get PLUGIN_PRIORITY(){return ude}isEnabled(){return!!this.hot.getSettings()[FH]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&zt(Yt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>In(Fn,this,Ade).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,Nde).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,mde).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,gde).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,pde).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,wde).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,vde).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,yde).call(e,...i)}),this.addHook("afterSelection",()=>In(Fn,this,Gw).call(this)),this.addHook("afterSelectionFocusSet",()=>In(Fn,this,Gw).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,cde).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>In(Fn,this,Sde).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,Ede).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,bde).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,dde).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,fde).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,Cde).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,Rde).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return In(Fn,e,Tde).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>In(Fn,this,Gw).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>In(Fn,this,Gw).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Mt(Zt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Mt(Zt,this).setState(e)),this.detectedOverlappedHeaders&&zt(Yt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,r)=>{const i=t===!0?"hide-column":"show-column";Mt(Zt,this).triggerColumnModification(i,r)}),!Mt(Ul,this)&&this.enabled&&Dh(Ul,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(r=>{let{op:i,index:s,newValue:o}=r;if(i==="replace"){const a=o===!0?"hide-column":"show-column";Mt(Zt,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Mt(Zt,this).clear(),Mt(Ul,this).unsubscribe(),Dh(Ul,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Mt(Zt,this)}getLayersCount(){return Mt(Zt,this).getLayersCount()}getHeaderSettings(e,t){return Mt(Zt,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<t;o++){const a=r.childNodes[o];if(!a)break;const l=i.childNodes[o],u=s?s.childNodes[o]:null;for(let h=0,c=a.childNodes.length;h<c;h++)a.childNodes[h].removeAttribute("colspan"),rt(a.childNodes[h],"hiddenHeader"),l&&l.childNodes[h]&&(l.childNodes[h].removeAttribute("colspan"),rt(l.childNodes[h],"hiddenHeader")),s&&u&&u.childNodes[h]&&(u.childNodes[h].removeAttribute("colspan"),rt(u.childNodes[h],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),s.removeAttribute("colspan"),rt(s,"hiddenHeader");const{colspan:h,isHidden:c,isPlaceholder:d,headerClassNames:f}=(o=Mt(Zt,this).getHeaderSettings(e,u))!==null&&o!==void 0?o:{};if(d||c)ue(s,"hiddenHeader");else if(h>1){var m,p;const{wtOverlays:v}=l._wt,y=(m=v.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s),S=(p=v.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(s),R=y||S?Math.min(h,r-i):h;R>1&&s.setAttribute("colspan",R)}if(this.hot.view.appendColHeader(u,s,function(){return t.getColumnHeaderValue(...arguments)},e),!d&&!c){const v=s.querySelector("div.relative");v&&f&&f.length>0&&(rt(v,this.hot.getColumnMeta(u).headerClassName),ue(v,f))}}}getColumnHeaderValue(e,t){var r;const{isHidden:i,isPlaceholder:s}=(r=Mt(Zt,this).getHeaderSettings(t,e))!==null&&r!==void 0?r:{};return s||i?"":this.hot.getColHeader(e,t)}destroy(){Dh(Zt,this,null),Mt(Ul,this)!==null&&(Mt(Ul,this).unsubscribe(),Dh(Ul,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Mt(Zt,this).getHeaderTreeNodeData(e.row,e.col)}}function Gw(){var n;const e=(n=this.hot)===null||n===void 0?void 0:n.getSelectedRangeLast();if(!e)return;const{highlight:t}=e;if(t.isHeader()&&t.col>=0){const i=Mt(Zt,this).findLeftMostColumnIndex(t.row,t.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=i,s.visualCellRange.from.col=i,s.visualCellRange.to.col=i,s.commit()}}function cde(n){const e=this.hot.getSelectedRangeLast();if(!e)return n;const{highlight:t}=e;if(!(t.isHeader()&&t.col>=0))return n;const i=this.hot.view.getFirstFullyVisibleColumn(),s=this.hot.view.getLastFullyVisibleColumn(),o=Mt(Zt,this).findLeftMostColumnIndex(t.row,t.col),a=Mt(Zt,this).findRightMostColumnIndex(t.row,t.col);return o<i&&a>s?n:o<i?o:a}function dde(n,e,t){const r=Mt(Zt,this).getHeaderTreeNodeData(e,n);if(!r)return n;const{columnCursor:i,selectionType:s,selectionWidth:o}=t,{isRoot:a,colspan:l}=Mt(Zt,this).getHeaderSettings(e,n);if(s===mI){if(!a)return r.columnIndex}else if(s===GU&&(l>o-i||!a))return null;return n}function fde(n,e,t){let{columnHeadersCount:r}=t;if(r!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:u}=e[s],h=l-o+1,c=a-u+1;if(o>=0||c===1)break;for(let d=a;d<=u;d++)for(let f=o;f<=l;f++){var i;const m=h+f,p=d-a;if(p===0)continue;((i=Mt(Zt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(n[m][p]="")}}}function mde(n,e,t,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function gde(n,e){const t=this._getHeaderTreeNodeDataByCoords(e);if(!t)return;Dh(jm,this,e.clone()),Dh(dS,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=t,l=!r.inInSelection(e);n.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,o,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(nI(n)||$h(n)&&l||B4(n))&&s.push(o,o+a-1,e.row),r.selectColumns(...s)}function pde(n,e,t,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:o}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:h}=a;r.column=!0,r.cell=!0;const c=[],d=Qt(e.row,-1/0,-1);e.col<h.col?c.push(u.col,s,d):e.col>h.col?c.push(l.col,s+o-1,d):c.push(s,s+o-1,d),this.hot.selection.selectColumns(...c)}function wde(){Dh(dS,this,!1)}function vde(){const{navigableHeaders:n}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Mt(dS,this)||!n)return;const e=this.hot.getSelectedRangeLast(),t=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=Mt(Zt,this).getHeaderTreeNodeData(Mt(jm,this).row,Mt(jm,this).col);if(e.setHighlight(Mt(jm,this)),s>e.getWidth()||i<t||i+s-1>r){const o=Mt(Zt,this).findTopMostEntireHeaderLevel(Qt(t,i,i+s-1),Qt(r,i,i+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function yde(n){const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.hot._createCellCoords(e.row+n.row,e.col+n.col);if(!(t.isHeader()&&t.col>=0))return;const i=Mt(Zt,this).findLeftMostColumnIndex(t.row,t.col),s=Mt(Zt,this).findRightMostColumnIndex(t.row,t.col);if(n.col<0){const o=e.col>=i&&e.col<=s?i-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(n.col>0){const o=e.col>=i&&e.col<=s?s+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?n.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Cde(n,e){const t=n.row,r=this._getHeaderTreeNodeDataByCoords({row:t,col:n.col}),i=this._getHeaderTreeNodeDataByCoords({row:t,col:e.col});e.col<n.col?(r&&(n.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=n.col&&(r&&(n.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function Sde(n){n.length=0;for(let e=0;e<Mt(Zt,this).getLayersCount();e++)n.push(this.headerRendererFactory(e))}function Rde(n){const e=Mt(Zt,this).getLayersCount();let t=n.startColumn,r=!!e;for(let i=0;i<e;i++){const s=Mt(Zt,this).findLeftMostColumnIndex(i,n.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(r=!1),ci(o)&&o<n.startColumn){t=o;break}}n.startColumn=r?Mt(Zt,this).getHeaderTreeNodeData(0,t).columnIndex:t}function Ede(n,e){const t=this.ghostTable.getWidth(e);return n>t?n:t}function bde(n,e,t){var r;const{label:i}=(r=Mt(Zt,this).getHeaderTreeNodeData(t,e))!==null&&r!==void 0?r:{label:""};return i}function Tde(n,e){if(n<0)return this.hot.getCell(n,Mt(Zt,this).findLeftMostColumnIndex(n,e),!0)}function Ade(){this.updatePlugin()}function Nde(n,e){e||this.updatePlugin()}function hm(n,e,t){return(e=Ide(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ide(n){var e=Mde(n,"string");return typeof e=="symbol"?e:e+""}function Mde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Ode{constructor(e,t){hm(this,"hot",void 0),hm(this,"data",null),hm(this,"plugin",void 0),hm(this,"parentReference",new WeakMap),hm(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},He(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,r){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&D(e.__children,i=>{this.cacheNode(i,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,r,i){let s=!1,o=t;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),r!=null&&o===r?{result:a,end:!0}:i!=null&&a===i?{result:o,end:!0}:(o+=1,a.__children&&D(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,r,i),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return gt(this.data[0],(t,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(t):r.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(D(r.__children,i=>{t+=1,i.__children&&(t+=this.countChildren(i))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var r;return((r=e.__children)===null||r===void 0?void 0:r[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((t=r.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let r=t;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),r||(r=this.mockNode()),s.__children.push(r),this.rewriteCache();const o=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,t,r){let i=r,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,t),e){const a=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(t,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[t]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),s=this.getRowIndexWithinParent(r);switch(t){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(He(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),He(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const s=this.getRowIndex(r),o=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),h=this.getRowIndex(u);let c=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,d,this.plugin.pluginName),u){c=h+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,o+1,this.plugin.pluginName),u.__children.push(r)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,o+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),t&&this.hot.render()}filterData(e,t,r){const i=[];D(r,s=>{i.push(this.getDataObject(s))}),D(i,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,t,r){const i=this.getDataObject(e-1);let s=null,o=e;i&&i.__children&&i.__children.length===0?(s=i,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?r?s.__children.splice(o,t,...r):s.__children.splice(o,t):r?this.data.splice(o,t,...r):this.data.splice(o,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,r=null;do r=this.getRowParent(r),r!==null&&(t=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,r,i){const s=t===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),u=e>t;let h=s?this.getRowParent(t-1):this.getRowParent(t);h==null&&(h=this.getRowParent(t-1)),h==null&&(h=this.getDataObject(t-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(t),h.__children=[]);const c=s||r||i?h.__children.length:this.getRowIndexWithinParent(t),d=o===h;h.__children.splice(c,0,l[0]),o.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(h)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function kH(n,e,t){return(e=_de(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _de(n){var e=xde(n,"string");return typeof e=="symbol"?e:e+""}function xde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class OO{constructor(e,t){kH(this,"hot",void 0),kH(this,"plugin",void 0),this.hot=t,this.plugin=e}}class na extends OO{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),s=this.dataManager.getDataObject(r),o=t.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(D(l,h=>{h&&o.removeChild(h)}),ue(t,na.CSS_CLASSES.indicatorContainer),i){const{rootDocument:h}=this.hot,c=a.cloneNode(!0);o.innerHTML="",He(0,i-1,()=>{const d=h.createElement("SPAN");ue(d,na.CSS_CLASSES.emptyIndicator),o.appendChild(d)}),o.appendChild(c)}if(this.dataManager.hasChildren(s)){const h=this.hot.rootDocument.createElement("DIV");u&&Xe(h,[ac()]),ue(t,na.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(ue(h,`${na.CSS_CLASSES.button} ${na.CSS_CLASSES.expandButton}`),u&&Xe(t,[Ns(!1)])):(ue(h,`${na.CSS_CLASSES.button} ${na.CSS_CLASSES.collapseButton}`),u&&Xe(t,[Ns(!0)])),o.appendChild(h)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}class Pde extends OO{constructor(e,t){var r;super(e,t),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),D(r.lastCollapsedRows,(a,l)=>{a>=i&&a<s&&(r.lastCollapsedRows[l]=a+o)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,s)=>{He(i,i+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&D(s.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];D(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),r&&this.trimRows(i),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return D(e,s=>{i.push(s),t&&this.collapseChildRows(s,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);D(i.__children,s=>{const o=this.dataManager.getRowIndex(s);t.push(o),this.collapseChildRows(o,t)})}r&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return D(e,s=>{i.push(s),t&&this.expandChildRows(s,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);D(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);t.push(o),this.expandChildRows(o,t)}})}r&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&D(s.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),t&&this.renderAndAdjust(),a}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];D(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),r&&this.untrimRows(i),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];D(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];D(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{D(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{D(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&D(t.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return r=!1,!1}),r}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const r=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const r=this.translateTrimmedRow(t.row);Je(e.target,na.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),To(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Lde(n,e,t){Dde(n,e),e.set(n,t)}function Dde(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hde(n,e,t){return(e=Fde(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Fde(n){var e=kde(n,"string");return typeof e=="symbol"?e:e+""}function kde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Vde(n,e){return n.get(Ude(n,e))}function Ude(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var VH=new WeakMap;class Bde extends OO{constructor(){super(...arguments),Hde(this,"dataManager",this.plugin.dataManager),Lde(this,VH,{row_above:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(aM)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(lM)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return He(0,e.items.length-1,r=>{if(r===0)return D(t,(i,s)=>{e.items.splice(r+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return He(0,e.items.length-1,t=>{const r=Vde(VH,this)[e.items[t].key];r!=null&&(e.items[t].callback=r)}),e}}function jw(n,e,t){return(e=Wde(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Wde(n){var e=$de(n,"string");return typeof e=="symbol"?e:e+""}function $de(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Gde{constructor(e){jw(this,"plugin",void 0),jw(this,"hot",void 0),jw(this,"dataManager",void 0),jw(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=r===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(m=>{if(!l)return!1;const p=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(p,a),p}),h=u.indexOf(a)===-1;if(!l||!h)return!1;const c=this.getBaseParent(u),d=this.getTargetParent(o,a),f=c===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,r,i,i&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:r,dropIndex:i,movePossible:s}=e;let o=!1;return mn(i)&&(zt(Yt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,r,i,s,!1),o=!0),o}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let r=this.dataManager.getRowParent(e?t-1:t);return r==null&&(r=this.dataManager.getRowParent(t-1)),r}shiftCollapsibleParentsLocations(e,t,r){r||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,r){const i=t===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,t,this.movedToCollapsed,i)})})}moveCellsMeta(e,t){const r=[],i=Math.max(...e)<t;e.forEach(s=>{r.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(i?r.length:0),0,...r)}selectCells(e,t){const r=e.length;let i=0,s=0,o=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<t?l=this.dataManager.translateTrimmedRow(t-r):l=this.dataManager.translateTrimmedRow(t);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),h=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(h),s=i}else e[r-1]<t?(s=t-1,i=s-r+1):(i=t,s=i+r-1);o=this.hot.selection,a=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(i,0)),o.setRangeEnd(this.hot._createCellCoords(s,a),!0)}isRowOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}}function jde(n,e){H$(n,e),e.add(n)}function UH(n,e,t){H$(n,e),e.set(n,t)}function H$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JT(n,e,t){return(e=zde(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zde(n){var e=Yde(n,"string");return typeof e=="symbol"?e:e+""}function Yde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function _v(n,e){return n.get(cr(n,e))}function $y(n,e,t){return n.set(cr(n,e),t),t}function cr(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Gy="nestedRows",Kde=300,BH=Gy,qde="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var fS=new WeakMap,Kc=new WeakMap,vr=new WeakSet;class Xde extends Wt{constructor(){super(...arguments),jde(this,vr),JT(this,"dataManager",null),JT(this,"headersUI",null),JT(this,"collapsedRowsMap",null),UH(this,fS,!1),UH(this,Kc,!1)}static get PLUGIN_KEY(){return Gy}static get PLUGIN_PRIORITY(){return Kde}isEnabled(){return!!this.hot.getSettings()[Gy]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Xg),this.dataManager=new Ode(this,this.hot),this.collapsingUI=new Pde(this,this.hot),this.headersUI=new na(this,this.hot),this.contextMenuUI=new Bde(this,this.hot),this.rowMoveController=new Gde(this),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,hfe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,cfe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,Jde).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,efe).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,tfe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,Zde).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,ife).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,rfe).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,sfe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,ofe).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,afe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,lfe).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,nfe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,ufe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return cr(vr,e,Qde).call(e,...r)}),this.addHook("beforeLoadData",t=>cr(vr,this,WH).call(this,t)),this.addHook("beforeUpdateData",t=>cr(vr,this,WH).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:BH,relativeToGroup:Tu,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(BH)}disableCoreAPIModifiers(){$y(Kc,this,!0)}enableCoreAPIModifiers(){$y(Kc,this,!1)}onModifyRowData(e){if(!_v(Kc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!_v(Kc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,r){return _v(Kc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,r),!1)}destroy(){super.destroy()}}function Qde(n,e,t,r){return this.rowMoveController.onBeforeRowMove(n,e,t,r)}function Zde(n,e,t){this.collapsingUI.toggleState(n,e,t)}function Jde(n,e,t){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(t[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(t[0],null,-1*e),this.dataManager.filterData(n,e,t),$y(fS,this,!0),this.dataManager.getData().slice()}function efe(n){return this.contextMenuUI.appendOptions(n)}function tfe(n,e){this.headersUI.appendLevelIndicators(n,e)}function nfe(n){return Math.max(this.headersUI.rowHeaderWidthCache,n)}function rfe(n,e,t,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{$y(fS,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function ife(n,e,t){const r=Array.from(t.reduce((i,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(o)&&o.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(s)},new Set));t.length=0,t.push(...r)}function sfe(){this.collapsingUI.collapsedRowsStash.stash()}function ofe(n,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function afe(){this.collapsingUI.collapsedRowsStash.stash()}function lfe(n,e,t){this.collapsingUI.collapsedRowsStash.shiftStash(t,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function ufe(){this.dataManager.rewriteCache()}function hfe(){this.headersUI.updateRowHeaderWidth()}function cfe(n,e){_v(fS,this)&&(e.skipRender=!0)}function WH(n){if(!_8(n)){iI(qde),this.hot.getSettings()[Gy]=!1,this.disablePlugin();return}this.dataManager.setData(n),this.dataManager.rewriteCache()}function eA(n,e,t){return(e=dfe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function dfe(n){var e=ffe(n,"string");return typeof e=="symbol"?e:e+""}function ffe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class mfe{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;eA(this,"rootWindow",void 0),eA(this,"prefix",void 0),eA(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const r=typeof e>"u"?t:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){D(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function gfe(n,e,t){return(e=pfe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pfe(n){var e=wfe(n,"string");return typeof e=="symbol"?e:e+""}function wfe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}Ie.getSingleton().register("persistentStateSave");Ie.getSingleton().register("persistentStateLoad");Ie.getSingleton().register("persistentStateReset");const $H="persistentState",vfe=0;class yfe extends Wt{constructor(){super(...arguments),gfe(this,"storage",void 0)}static get PLUGIN_KEY(){return $H}static get PLUGIN_PRIORITY(){return vfe}isEnabled(){return!!this.hot.getSettings()[$H]}enablePlugin(){this.enabled||(this.storage||(this.storage=new mfe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Cfe(n,e){Sfe(n,e),e.add(n)}function Sfe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tA(n,e,t){return(e=Rfe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Rfe(n){var e=Efe(n,"string");return typeof e=="symbol"?e:e+""}function Efe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function GH(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const nA="search",bfe=190,Tfe="htSearchResult",Afe=function(n,e,t,r,i){n.getCellMeta(e,t).isSearchResult=i},Nfe=function(n,e,t){return mn(n)||n===null||!n.toLocaleLowerCase||n.length===0||mn(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(n.toLocaleLowerCase(t.locale))!==-1};var rA=new WeakSet;class Ife extends Wt{constructor(){super(...arguments),Cfe(this,rA),tA(this,"callback",Afe),tA(this,"queryMethod",Nfe),tA(this,"searchResultClass",Tfe)}static get PLUGIN_KEY(){return nA}static get PLUGIN_PRIORITY(){return bfe}isEnabled(){return this.hot.getSettings()[nA]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[nA];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return GH(rA,e,jH).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return GH(rA,e,jH).call(e,...i)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return He(0,i-1,l=>{He(0,s-1,u=>{const h=this.hot.getDataAtCell(l,u),c=this.hot.getCellMeta(l,u),d=c.search.callback||t,m=(c.search.queryMethod||r)(e,h,c);if(m){const p={row:l,col:u,data:h};o.push(p)}d&&d(a,l,u,h,m)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){mt(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function jH(n,e,t,r,i,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function Mfe(n,e){Ofe(n,e),e.add(n)}function Ofe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zw(n,e,t){return(e=_fe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _fe(n){var e=xfe(n,"string");return typeof e=="symbol"?e:e+""}function xfe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function iA(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Pfe="touchScroll",Lfe=200;var Yw=new WeakSet;class Dfe extends Wt{constructor(){super(...arguments),Mfe(this,Yw),zw(this,"scrollbars",[]),zw(this,"clones",[]),zw(this,"lockedCollection",!1),zw(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Pfe}static get PLUGIN_PRIORITY(){return Lfe}static get SETTING_KEYS(){return!0}isEnabled(){return mU()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>iA(Yw,this,Hfe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>iA(Yw,this,Ffe).call(this)),this.addHook("afterMomentumScroll",()=>iA(Yw,this,kfe).call(this))}}function Hfe(){if(this.lockedCollection)return;const{topOverlay:n,bottomOverlay:e,inlineStartOverlay:t,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(n),e.clone&&this.scrollbars.push(e),this.scrollbars.push(t),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Ffe(){this.freezeOverlays=!0,D(this.clones,n=>{ue(n,"hide-tween")})}function kfe(){this.freezeOverlays=!1,D(this.clones,n=>{rt(n,"hide-tween"),ue(n,"show-tween")}),this.hot._registerTimeout(()=>{D(this.clones,n=>{rt(n,"show-tween")})},400),D(this.scrollbars,n=>{n.refresh(),n.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Vfe(n,e){Ufe(n,e),e.add(n)}function Ufe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bfe(n,e,t){return(e=Wfe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Wfe(n){var e=$fe(n,"string");return typeof e=="symbol"?e:e+""}function $fe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Gfe(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const xv="trimRows",jfe=330;var zH=new WeakSet;class zfe extends Wt{constructor(){super(...arguments),Vfe(this,zH),Bfe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return xv}static get PLUGIN_PRIORITY(){return jfe}isEnabled(){return!!this.hot.getSettings()[xv]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Xg),this.trimmedRowsMap.addLocalHook("init",()=>Gfe(zH,this,Yfe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[xv];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),D(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{D(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",t,i,r,r&&i.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let i=t;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;r&&o&&(D(e,l=>{s[l]=!1}),i=gi(s,(l,u,h)=>(u&&l.push(h),l),[])),this.hot.runHooks("beforeUntrimRow",t,i,r&&o)!==!1&&(r&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",t,i,r&&o,r&&i.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<t)}destroy(){super.destroy()}}function Yfe(){const n=this.hot.getSettings()[xv];Array.isArray(n)&&this.hot.batchExecution(()=>{D(n,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var YH={},sA,KH;function F$(){return KH||(KH=1,sA={}),sA}var oA,qH;function Kfe(){if(qH)return oA;qH=1;var n=Ru(),e=F$(),t=n("iterator"),r=Array.prototype;return oA=function(i){return i!==void 0&&(e.Array===i||r[t]===i)},oA}var aA,XH;function k$(){if(XH)return aA;XH=1;var n=$k(),e=RC(),t=c0(),r=F$(),i=Ru(),s=i("iterator");return aA=function(o){if(!t(o))return e(o,s)||e(o,"@@iterator")||r[n(o)]},aA}var lA,QH;function qfe(){if(QH)return lA;QH=1;var n=Ro(),e=Lg(),t=wl(),r=SC(),i=k$(),s=TypeError;return lA=function(o,a){var l=arguments.length<2?i(o):a;if(e(l))return t(n(l,o));throw new s(r(o)+" is not iterable")},lA}var uA,ZH;function Xfe(){if(ZH)return uA;ZH=1;var n=Kk(),e=Ro(),t=wl(),r=SC(),i=Kfe(),s=kg(),o=yC(),a=qfe(),l=k$(),u=R0(),h=TypeError,c=function(f,m){this.stopped=f,this.result=m},d=c.prototype;return uA=function(f,m,p){var v=p&&p.that,y=!!(p&&p.AS_ENTRIES),S=!!(p&&p.IS_RECORD),R=!!(p&&p.IS_ITERATOR),T=!!(p&&p.INTERRUPTED),I=n(m,v),H,k,W,Y,$,q,J,re=function(ae){return H&&u(H,"normal"),new c(!0,ae)},ie=function(ae){return y?(t(ae),T?I(ae[0],ae[1],re):I(ae[0],ae[1])):T?I(ae,re):I(ae)};if(S)H=f.iterator;else if(R)H=f;else{if(k=l(f),!k)throw new h(r(f)+" is not iterable");if(i(k)){for(W=0,Y=s(f);Y>W;W++)if($=ie(f[W]),$&&o(d,$))return $;return new c(!1)}H=a(f,k)}for(q=S?f.next:H.next;!(J=e(q,H)).done;){try{$=ie(J.value)}catch(ae){u(H,"throw",ae)}if(typeof $=="object"&&$&&o(d,$))return $}return new c(!1)},uA}var hA,JH;function Qfe(){if(JH)return hA;JH=1;var n=So(),e=tc(),t=wC();return hA=function(r,i,s){n?e.f(r,i,t(0,s)):r[i]=s},hA}var eF;function Zfe(){if(eF)return YH;eF=1;var n=Ur(),e=Xfe(),t=Qfe();return n({target:"Object",stat:!0},{fromEntries:function(i){var s={};return e(i,function(o,a){t(s,o,a)},{AS_ENTRIES:!0}),s}}),YH}Zfe();const V$="undoRedo",Jfe="undoRedo";function ge(n){const e=this;this.instance=n,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,n.addHook("afterChange",function(r,i){const s=r&&r.length;if(!s||!r.find(l=>{const[,,u,h]=l;return u!==h}))return;const a=()=>{const l=r.reduce((h,c)=>(h.push([...c]),h),[]);D(l,h=>{h[1]=n.propToCol(h[1])});const u=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new ge.ChangeAction(l,u)};e.done(a,i)}),n.addHook("afterCreateRow",(r,i,s)=>{e.done(()=>new ge.CreateRowAction(r,i),s)});const t=(r,i,s,o)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return He(s,o,h=>{He(r,i,c=>{const d=n.getCellMeta(c,h);if(Object.keys(d).length!==l){const f=Object.fromEntries(Object.entries(d).filter(m=>{let[p]=m;return a.includes(p)===!1}));u.push([d.visualRow,d.visualCol,f])}})}),u};n.addHook("beforeRemoveRow",(r,i,s,o)=>{const a=()=>{const l=n.toPhysicalRow(r),u=l+i-1,h=mi(e.instance.getSourceData(l,0,l+i-1,e.instance.countSourceCols()-1));return new ge.RemoveRowAction(l,h,n.getSettings().fixedRowsBottom,n.getSettings().fixedRowsTop,n.rowIndexMapper.getIndexesSequence(),t(l,u,0,n.countCols()-1))};e.done(a,o)}),n.addHook("afterCreateCol",(r,i,s)=>{e.done(()=>new ge.CreateColumnAction(r,i),s)}),n.addHook("beforeRemoveCol",(r,i,s,o)=>{const a=()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+r)%e.instance.countCols(),h=u+i-1,c=[],d=[],f=[];He(l.length-1,v=>{const y=[],S=l[v];He(u,h,R=>{y.push(S[n.toPhysicalColumn(R)])}),c.push(y)}),He(i-1,v=>{f.push(n.toPhysicalColumn(u+v))}),Array.isArray(n.getSettings().colHeaders)&&He(i-1,v=>{d.push(n.getSettings().colHeaders[n.toPhysicalColumn(u+v)]||null)});const m=n.columnIndexMapper.getIndexesSequence(),p=n.rowIndexMapper.getIndexesSequence();return new ge.RemoveColumnAction(u,f,c,d,m,p,n.getSettings().fixedColumnsStart,t(0,n.countRows(),u,h))};e.done(a,o)}),n.addHook("beforeCellAlignment",(r,i,s,o)=>{e.done(()=>new ge.CellAlignmentAction(r,i,s,o))}),n.addHook("beforeFilter",(r,i)=>{e.done(()=>new ge.FiltersAction(r,i))}),n.addHook("beforeRowMove",(r,i)=>{r!==!1&&e.done(()=>new ge.RowMoveAction(r,i))}),n.addHook("beforeColumnMove",(r,i)=>{r!==!1&&e.done(()=>new ge.ColumnMoveAction(r,i))}),n.addHook("beforeMergeCells",(r,i)=>{i||e.done(()=>new ge.MergeCellsAction(n,r))}),n.addHook("afterUnmergeCells",(r,i)=>{i||e.done(()=>new ge.UnmergeCellsAction(n,r))}),n.addHook("beforeColumnSort",(r,i,s)=>{s&&e.done(()=>new ge.ColumnSortAction(r,i))}),n.addHook("afterInit",()=>{e.init()})}ge.prototype.done=function(n,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const s=n(),o=this.undoneActions.slice();this.doneActions.push(s),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())};ge.prototype.undo=function(){if(this.isUndoAvailable()){const n=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",n);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice());const t=mi(e);if(this.instance.runHooks("beforeUndo",t)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}};ge.prototype.redo=function(){if(this.isRedoAvailable()){const n=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",n);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",n,this.undoneActions.slice());const t=mi(e);if(this.instance.runHooks("beforeRedo",t)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}};ge.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ge.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ge.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ge.prototype.isEnabled=function(){return this.enabled};ge.prototype.enable=function(){if(this.isEnabled())return;const n=this.instance;this.enabled=!0,nme(n),this.registerShortcuts(),n.addHook("afterChange",U$)};ge.prototype.disable=function(){if(!this.isEnabled())return;const n=this.instance;this.enabled=!1,rme(n),this.unregisterShortcuts(),n.removeHook("afterChange",U$)};ge.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ge.Action=function(){};ge.Action.prototype.undo=function(){};ge.Action.prototype.redo=function(){};ge.ChangeAction=function(n,e){this.changes=n,this.selected=e,this.actionType="change"};Ea(ge.ChangeAction,ge.Action);ge.ChangeAction.prototype.undo=function(n,e){const t=mi(this.changes),r=n.countEmptyRows(!0),i=n.countEmptyCols(!0);for(let o=0,a=t.length;o<a;o++)t[o].splice(3,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.undo");for(let o=0,a=t.length;o<a;o++){const[l,u]=t[o];n.getSettings().minSpareRows&&l+1+n.getSettings().minSpareRows===n.countRows()&&r===n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(l+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&u+1+n.getSettings().minSpareCols===n.countCols()&&i===n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(u+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())}const s=n.getSelectedLast();if(s!==void 0){const[o,a]=t[0],[l,u]=s,h=n.view.getFirstFullyVisibleRow(),c=n.view.getFirstFullyVisibleColumn(),d=o>=h,f=a>=c;if((d&&f)===!1&&(l!==o||u!==a)===!0){const v={row:o,col:a};d===!1&&(v.verticalSnap="top"),f===!1&&(v.horizontalSnap="start"),n.scrollViewportTo(v)}}n.selectCells(this.selected,!1,!1)};ge.ChangeAction.prototype.redo=function(n,e){const t=mi(this.changes);for(let r=0,i=t.length;r<i;r++)t[r].splice(2,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&n.selectCells(this.selected,!1,!1)};ge.CreateRowAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_row"};Ea(ge.CreateRowAction,ge.Action);ge.CreateRowAction.prototype.undo=function(n,e){const t=n.countRows(),r=n.getSettings().minSpareRows;this.index>=t&&this.index-r<t&&(this.index-=r),n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ge.CreateRowAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateRow",e),n.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ge.RemoveRowAction=function(n,e,t,r,i,s){this.index=n,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=r,this.rowIndexesSequence=i,this.removedCellMetas=s};Ea(ge.RemoveRowAction,ge.Action);ge.RemoveRowAction.prototype.undo=function(n,e){const t=n.getSettings(),r=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,s)=>{Object.keys(i).forEach(o=>{const a=parseInt(o,10);r.push([this.index+s,isNaN(a)?o:a,i[o]])})}),n.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(i=>{let[s,o,a]=i;n.setCellMetaObject(s,o,a)}),n.addHookOnce("afterViewRender",e),n.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),n.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ge.RemoveRowAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ge.CreateColumnAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_col"};Ea(ge.CreateColumnAction,ge.Action);ge.CreateColumnAction.prototype.undo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ge.CreateColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateCol",e),n.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ge.RemoveColumnAction=function(n,e,t,r,i,s,o,a){this.index=n,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o,this.removedCellMetas=a};Ea(ge.RemoveColumnAction,ge.Action);ge.RemoveColumnAction.prototype.undo=function(n,e){const t=n.getSettings();t.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,h,c)=>c[this.indexes.indexOf(r[h])],s=this.data.length,o=[];for(let u=0;u<s;u++)o.push(bt(this.data[u],i));const a=bt(this.headers,i),l=[];n.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),D(n.getSourceDataArray(),(u,h)=>{D(r,(c,d)=>{u[c]=o[h][d],l.push([h,c,u[c]])})}),n.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&D(a,(u,h)=>{n.getSettings().colHeaders[r[h]]=u}),this.removedCellMetas.forEach(u=>{let[h,c,d]=u;n.setCellMetaObject(h,c,d)}),n.batchExecution(()=>{n.rowIndexMapper.setIndexesSequence(this.rowPositions),n.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),n.addHookOnce("afterViewRender",e),n.render()};ge.RemoveColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ge.CellAlignmentAction=function(n,e,t,r){this.stateBefore=n,this.range=e,this.type=t,this.alignment=r};ge.CellAlignmentAction.prototype.undo=function(n,e){D(this.range,t=>{t.forAll((r,i)=>{r>=0&&i>=0&&n.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),n.addHookOnce("afterViewRender",e),n.render()};ge.CellAlignmentAction.prototype.redo=function(n,e){Bl(this.range,this.type,this.alignment,(t,r)=>n.getCellMeta(t,r),(t,r,i,s)=>n.setCellMeta(t,r,i,s)),n.addHookOnce("afterViewRender",e),n.render()};ge.FiltersAction=function(n,e){this.previousConditionsStack=e,this.conditionsStack=n,this.actionType="filter"};Ea(ge.FiltersAction,ge.Action);ge.FiltersAction.prototype.undo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),this.previousConditionsStack&&t.conditionCollection.importAllConditions(this.previousConditionsStack),t.filter()};ge.FiltersAction.prototype.redo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};class eme extends ge.Action{constructor(e,t){super(),this.cellRange=t;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange)}}ge.MergeCellsAction=eme;class tme extends ge.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange,!0)}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0),e.render()}}ge.UnmergeCellsAction=tme;ge.RowMoveAction=function(n,e){this.rows=n.slice(),this.finalRowIndex=e,this.actionType="row_move"};Ea(ge.RowMoveAction,ge.Action);ge.RowMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),TO(this.rows,this.finalRowIndex,n.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),t.moveRow(o,s)}),n.render(),n.deselectCell(),n.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ge.RowMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalRowIndex),n.render(),n.deselectCell(),n.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};ge.ColumnMoveAction=function(n,e){this.columns=n.slice(),this.finalColumnIndex=e,this.actionType="col_move"};Ea(ge.ColumnMoveAction,ge.Action);ge.ColumnMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualColumnMove");n.addHookOnce("afterViewRender",e),TO(this.columns,this.finalColumnIndex,n.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),t.moveColumn(o,s)}),n.render(),n.deselectCell(),n.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};ge.ColumnMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualColumnMove");n.addHookOnce("afterViewRender",e),t.moveColumns(this.columns.slice(),this.finalColumnIndex),n.render(),n.deselectCell(),n.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};ge.ColumnSortAction=function(n,e){this.previousSortState=n,this.nextSortState=e};Ea(ge.ColumnSortAction,ge.Action);ge.ColumnSortAction.prototype.undo=function(n,e){const t=n.getPlugin("columnSorting"),r=n.getPlugin("multiColumnSorting"),i=r.isEnabled()?r:t;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),e()};ge.ColumnSortAction.prototype.redo=function(n,e){const t=n.getPlugin("columnSorting"),r=n.getPlugin("multiColumnSorting");(r.isEnabled()?r:t).sort(this.nextSortState),e()};ge.prototype.init=function(){const n=this.instance.getSettings().undo,e=typeof n>"u"||n;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ge.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:V$};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};ge.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(V$)};function U$(n,e){const t=this;if(e==="loadData")return t.undoRedo.clear()}function nme(n){n.undo=function(){return n.undoRedo.undo()},n.redo=function(){return n.undoRedo.redo()},n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()},n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()},n.clearUndo=function(){return n.undoRedo.clear()}}function rme(n){delete n.undo,delete n.redo,delete n.isUndoAvailable,delete n.isRedoAvailable,delete n.clearUndo}const sp=Ie.getSingleton();sp.add("afterUpdateSettings",function(){var n;(n=this.getPlugin("undoRedo"))===null||n===void 0||n.init()});sp.register("beforeUndo");sp.register("afterUndo");sp.register("beforeRedo");sp.register("afterRedo");ge.PLUGIN_KEY=Jfe;ge.SETTING_KEYS=!0;function ime(){Dt(Im),Dt(wte),Dt(Mm),Dt(Qte),Dt(sne),Dt(hW),Dt(Jne),Dt(kre),Dt(aS),Dt(Kie),Dt(Cse),Dt(Ise),Dt(hS),Dt(noe),Dt(ele),Dt(_le),Dt(rue),Dt(mue),Dt(Aue),Dt(Fue),Dt(Yue),Dt(che),Dt(Che),Dt(Jhe),Dt(Pce),Dt(kce),Dt(hde),Dt(Xde),Dt(yfe),Dt(Ife),Dt(Dfe),Dt(zfe),Dt(ge)}function sme(){jJ(),hee(),yee(),Vee(),ime()}var $n;(function(n){n.RELATIVE="RELATIVE",n.ABSOLUTE="ABSOLUTE"})($n||($n={}));class hi{constructor(e,t,r){this.type=e,this.col=t,this.sheet=r}static absolute(e,t){return new hi($n.ABSOLUTE,e,t)}static relative(e,t){return new hi($n.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleColumnAddress(e).col-r.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===$n.ABSOLUTE}isColumnRelative(){return this.type===$n.RELATIVE}isAbsolute(){return this.type===$n.ABSOLUTE&&this.sheet!==void 0}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new hi(this.type,this.col+t,i)}shiftedByColumns(e){return new hi(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=po(this,e);let r=this.col;return this.isColumnRelative()&&(r=e.col+this.col),mj(t,r)}shiftRelativeDimensions(e,t){const r=this.isColumnRelative()?this.col+e:this.col;return new hi(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnAbsolute()?this.col+e:this.col;return new hi(this.type,r,this.sheet)}withSheet(e){return new hi(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case $n.RELATIVE:return`${t}#COLR${this.col}`;case $n.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(Uwe(t))return;const r=gS(t.col);return`${this.type===$n.ABSOLUTE?"$":""}${r}`}exceedsSheetSizeLimits(e){return this.col>=e}}class qr{constructor(e,t,r){this.type=e,this.row=t,this.sheet=r}static absolute(e,t){return new qr($n.ABSOLUTE,e,t)}static relative(e,t){return new qr($n.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleRowAddress(e).row-r.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===$n.ABSOLUTE}isRowRelative(){return this.type===$n.RELATIVE}isAbsolute(){return this.type===$n.ABSOLUTE&&this.sheet!==void 0}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new qr(this.type,this.row+r,i)}shiftedByRows(e){return new qr(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=po(this,e);let r=this.row;return this.isRowRelative()&&(r=e.row+this.row),fj(t,r)}shiftRelativeDimensions(e,t){const r=this.isRowRelative()?this.row+t:this.row;return new qr(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isRowAbsolute()?this.row+t:this.row;return new qr(this.type,r,this.sheet)}withSheet(e){return new qr(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case $n.RELATIVE:return`${t}#ROWR${this.row}`;case $n.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);return Vwe(t)?void 0:`${this.type===$n.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}var jt;(function(n){n.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",n.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",n.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",n.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(jt||(jt={}));class sn{constructor(e,t,r,i){this.col=e,this.row=t,this.type=r,this.sheet=i}static fromColAndRow(e,t,r){return(e.isColumnAbsolute()&&t.isRowAbsolute()?sn.absolute.bind(this):e.isColumnAbsolute()?sn.absoluteCol.bind(this):t.isRowAbsolute()?sn.absoluteRow.bind(this):sn.relative.bind(this))(e.col,t.row,r)}static relative(e,t,r){return new sn(e,t,jt.CELL_REFERENCE_RELATIVE,r)}static absolute(e,t,r){return new sn(e,t,jt.CELL_REFERENCE_ABSOLUTE,r)}static absoluteCol(e,t,r){return new sn(e,t,jt.CELL_REFERENCE_ABSOLUTE_COL,r)}static absoluteRow(e,t,r){return new sn(e,t,jt.CELL_REFERENCE_ABSOLUTE_ROW,r)}toSimpleCellAddress(e){const t=po(this,e);return this.type===jt.CELL_REFERENCE_ABSOLUTE?Ce(t,this.col,this.row):this.type===jt.CELL_REFERENCE_ABSOLUTE_ROW?Ce(t,e.col+this.col,this.row):this.type===jt.CELL_REFERENCE_ABSOLUTE_COL?Ce(t,this.col,e.row+this.row):Ce(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?$n.RELATIVE:$n.ABSOLUTE;return new hi(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?$n.RELATIVE:$n.ABSOLUTE;return new qr(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=po(this,e);let r=this.col;return this.isColumnRelative()&&(r+=e.col),mj(t,r)}toSimpleRowAddress(e){const t=po(this,e);let r=this.row;return this.isRowRelative()&&(r+=e.row),fj(t,r)}isRowAbsolute(){return this.type===jt.CELL_REFERENCE_ABSOLUTE||this.type===jt.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===jt.CELL_REFERENCE_ABSOLUTE||this.type===jt.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===jt.CELL_REFERENCE_RELATIVE||this.type===jt.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===jt.CELL_REFERENCE_RELATIVE||this.type===jt.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===jt.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}shiftedByRows(e){return new sn(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new sn(this.col+e,this.row,this.type,this.sheet)}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new sn(this.col+t,this.row+r,this.type,i)}withSheet(e){return new sn(this.col,this.row,this.type,e)}isInvalid(e){return Di(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const r=this.isColumnAbsolute()?this.col:this.col+e,i=this.isRowAbsolute()?this.row:this.row+t;return new sn(r,i,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnRelative()?this.col:this.col+e,i=this.isRowRelative()?this.row:this.row+t;return new sn(r,i,this.type,this.sheet)}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case jt.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case jt.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case jt.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case jt.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if(Di(t))return;const r=gS(t.col),i=this.type===jt.CELL_REFERENCE_ABSOLUTE||this.type===jt.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===jt.CELL_REFERENCE_ABSOLUTE||this.type===jt.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${r}${i}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}const op=":",di="$",ome="\\s+",ame="[ \\t\\n\\r]+",mS="A-Za-zÀ-ʯ",_O=`${mS}0-9_.`,B$=`[${mS}0-9_]+`,lme="'(((?!').|'')*)'",af=`(${B$}|${lme})!`,W$=`(${af})?\\${di}?[A-Za-z]+\\${di}?[0-9]+`,tF=`(${af})?\\${di}?[A-Za-z]+`,nF=`(${af})?\\${di}?[0-9]+`,$$="[rR][0-9]*[cC][0-9]*",ume=`(${W$})[^${_O}]`,G$=`[${mS}_][${_O}]*`,hme=["0","1","2","3","4","5","6","7","8","9"],j$=[...Array.from(Array(26)).map((n,e)=>e+65),...Array.from(Array(26)).map((n,e)=>e+97),...Array.from(Array(496)).map((n,e)=>e+192)].map(n=>String.fromCharCode(n));const z$=new RegExp(`^(${af})?(\\${di}?)([A-Za-z]+)(\\${di}?)([0-9]+)$`),cme=new RegExp(`^(${af})?(\\${di}?)([A-Za-z]+)$`),dme=new RegExp(`^(${af})?(\\${di}?)([0-9]+)$`),fme=new RegExp(`^${B$}$`),od=(n,e,t)=>{const r=z$.exec(e),i=xO(r[6]);let s=pS(r,n);if(s===void 0)return;s===null&&(s=void 0);const o=Number(r[8])-1;return r[5]===di&&r[7]===di?sn.absolute(i,o,s):r[5]===di?sn.absoluteCol(i,o-t.row,s):r[7]===di?sn.absoluteRow(i-t.col,o,s):sn.relative(i-t.col,o-t.row,s)},jy=(n,e,t)=>{const r=cme.exec(e);let i=pS(r,n);if(i===void 0)return;i===null&&(i=void 0);const s=xO(r[6]);return r[5]===di?hi.absolute(s,i):hi.relative(s-t.col,i)},zy=(n,e,t)=>{const r=dme.exec(e);let i=pS(r,n);if(i===void 0)return;i===null&&(i=void 0);const s=Number(r[6])-1;return r[5]===di?qr.absolute(s,i):qr.relative(s-t.row,i)},ON=(n,e,t)=>{const r=z$.exec(e);if(!r)return;const i=xO(r[6]);let s=pS(r,n);if(s===void 0)return;s===null&&(s=t);const o=Number(r[8])-1;return Ce(s,i,o)},mme=(n,e,t)=>{const r=e.split(op);if(r.length!==2)return;const[i,s]=r,o=ON(n,i,t);if(o===void 0)return;const a=ON(n,s,o.sheet);if(a!==void 0&&o.sheet===a.sheet)return jN(o,a)},Yy=(n,e,t)=>{const r=gS(e.col),i=Y$(e.sheet,n);if(i!==void 0)return t!==e.sheet?`${i}!${r}${e.row+1}`:`${r}${e.row+1}`},gme=(n,e,t)=>{const r=Yy(n,e.start,t),i=Yy(n,e.end,e.start.sheet);if(!(r===void 0||i===void 0))return`${r}${op}${i}`};function xO(n){return n.length===1?n.toUpperCase().charCodeAt(0)-65:n.split("").reduce((e,t)=>e*26+(t.toUpperCase().charCodeAt(0)-64),0)-1}function gS(n){let e="";for(;n>=0;)e=String.fromCharCode(n%26+97)+e,n=Math.floor(n/26)-1;return e.toUpperCase()}function Y$(n,e){let t=e(n);if(t!==void 0)return fme.test(t)?t:(t=t.replace(/'/g,"''"),`'${t}'`)}function pS(n,e){var t;let r=(t=n[3])!==null&&t!==void 0?t:n[2];return r?(r=r.replace(/''/g,"'"),e(r)):null}function on(n){return n&&n.length===0}function El(n){return n==null?[]:Object.keys(n)}function Qr(n){for(var e=[],t=Object.keys(n),r=0;r<t.length;r++)e.push(n[t[r]]);return e}function pme(n,e){for(var t=[],r=El(n),i=0;i<r.length;i++){var s=r[i];t.push(e.call(null,n[s],s))}return t}function Ne(n,e){for(var t=[],r=0;r<n.length;r++)t.push(e.call(null,n[r],r));return t}function ki(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];Array.isArray(r)?e=e.concat(ki(r)):e.push(r)}return e}function _s(n){return on(n)?void 0:n[0]}function K$(n){var e=n&&n.length;return e?n[e-1]:void 0}function je(n,e){if(Array.isArray(n))for(var t=0;t<n.length;t++)e.call(null,n[t],t);else if(LO(n))for(var r=El(n),t=0;t<r.length;t++){var i=r[t],s=n[i];e.call(null,s,i)}else throw Error("non exhaustive match")}function va(n){return typeof n=="string"}function xs(n){return n===void 0}function Au(n){return n instanceof Function}function Dr(n,e){return e===void 0&&(e=1),n.slice(e,n.length)}function Eg(n,e){return e===void 0&&(e=1),n.slice(0,n.length-e)}function No(n,e){var t=[];if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];e.call(null,i)&&t.push(i)}return t}function Xh(n,e){return No(n,function(t){return!e(t)})}function ks(n,e){for(var t=Object.keys(n),r={},i=0;i<t.length;i++){var s=t[i],o=n[s];e(o)&&(r[s]=o)}return r}function Ge(n,e){return LO(n)?n.hasOwnProperty(e):!1}function gr(n,e){return jd(n,function(t){return t===e})!==void 0}function Vi(n){for(var e=[],t=0;t<n.length;t++)e.push(n[t]);return e}function ap(n){var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}function jd(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(e.call(null,r))return r}}function wme(n,e){for(var t=[],r=0;r<n.length;r++){var i=n[r];e.call(null,i)&&t.push(i)}return t}function kr(n,e,t){for(var r=Array.isArray(n),i=r?n:Qr(n),s=r?[]:El(n),o=t,a=0;a<i.length;a++)o=e.call(null,o,i[a],r?a:s[a]);return o}function lp(n){return Xh(n,function(e){return e==null})}function PO(n,e){e===void 0&&(e=function(r){return r});var t=[];return kr(n,function(r,i){var s=e(i);return gr(t,s)?r:(t.push(s),r.concat(i))},[])}function fo(n){return Array.isArray(n)}function pl(n){return n instanceof RegExp}function LO(n){return n instanceof Object}function Is(n,e){for(var t=0;t<n.length;t++)if(!e(n[t],t))return!1;return!0}function wS(n,e){return Xh(n,function(t){return gr(e,t)})}function q$(n,e){for(var t=0;t<n.length;t++)if(e(n[t]))return!0;return!1}function vme(n,e){for(var t=0;t<n.length;t++)if(n[t]===e)return t;return-1}function Io(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++)for(var i=e[r],s=El(i),o=0;o<s.length;o++){var a=s[o];n[a]=i[a]}return n}function yme(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++){var i=e[r];if(!xs(i))for(var s=El(i),o=0;o<s.length;o++){var a=s[o];Ge(n,a)||(n[a]=i[a])}}return n}function vS(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return yme.apply(null,[{}].concat(n))}function X$(n,e){var t={};return je(n,function(r){var i=e(r),s=t[i];s?s.push(r):t[i]=[r]}),t}function rF(n,e){for(var t=ap(n),r=El(e),i=0;i<r.length;i++){var s=r[i],o=e[s];t[s]=o}return t}function yr(){}function iF(n){return n}function Cme(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];e.push(r!==void 0?r:void 0)}return e}function _N(n){console&&console.error&&console.error("Error: "+n)}function DO(n){console&&console.warn&&console.warn("Warning: "+n)}function sF(){return typeof Map=="function"}function Sme(n,e){e.forEach(function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach(function(i){if(i!=="constructor"){var s=Object.getOwnPropertyDescriptor(r,i);s&&(s.get||s.set)?Object.defineProperty(n.prototype,i,s):n.prototype[i]=t.prototype[i]}})})}function Q$(n){function e(){}e.prototype=n;var t=new e;function r(){return typeof t.bar}return r(),r(),n}function Ky(n){return n[n.length-1]}function Z$(n){var e=new Date().getTime(),t=n(),r=new Date().getTime(),i=r-e;return{time:i,value:t}}var Pv={exports:{}},Rme=Pv.exports,oF;function Eme(){return oF||(oF=1,(function(n){(function(e,t){n.exports?n.exports=t():e.regexpToAst=t()})(typeof self<"u"?self:Rme,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(p){this.idx=p.idx,this.input=p.input,this.groupIdx=p.groupIdx},e.prototype.pattern=function(p){this.idx=0,this.input=p,this.groupIdx=0,this.consumeChar("/");var v=this.disjunction();this.consumeChar("/");for(var y={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":a(y,"global");break;case"i":a(y,"ignoreCase");break;case"m":a(y,"multiLine");break;case"u":a(y,"unicode");break;case"y":a(y,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:y,value:v}},e.prototype.disjunction=function(){var p=[];for(p.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),p.push(this.alternative());return{type:"Disjunction",value:p}},e.prototype.alternative=function(){for(var p=[];this.isTerm();)p.push(this.term());return{type:"Alternative",value:p}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var p;switch(this.popChar()){case"=":p="Lookahead";break;case"!":p="NegativeLookahead";break}l(p);var v=this.disjunction();return this.consumeChar(")"),{type:p,value:v}}u()},e.prototype.quantifier=function(p){var v;switch(this.popChar()){case"*":v={atLeast:0,atMost:1/0};break;case"+":v={atLeast:1,atMost:1/0};break;case"?":v={atLeast:0,atMost:1};break;case"{":var y=this.integerIncludingZero();switch(this.popChar()){case"}":v={atLeast:y,atMost:y};break;case",":var S;this.isDigit()?(S=this.integerIncludingZero(),v={atLeast:y,atMost:S}):v={atLeast:y,atMost:1/0},this.consumeChar("}");break}if(p===!0&&v===void 0)return;l(v);break}if(!(p===!0&&v===void 0))return l(v),this.peekChar(0)==="?"?(this.consumeChar("?"),v.greedy=!1):v.greedy=!0,v.type="Quantifier",v},e.prototype.atom=function(){var p;switch(this.peekChar()){case".":p=this.dotAll();break;case"\\":p=this.atomEscape();break;case"[":p=this.characterClass();break;case"(":p=this.group();break}return p===void 0&&this.isPatternCharacter()&&(p=this.patternCharacter()),l(p),this.isQuantifier()&&(p.quantifier=this.quantifier()),p},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[s(`
`),s("\r"),s("\u2028"),s("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var p=this.positiveInteger();return{type:"GroupBackReference",value:p}},e.prototype.characterClassEscape=function(){var p,v=!1;switch(this.popChar()){case"d":p=c;break;case"D":p=c,v=!0;break;case"s":p=f;break;case"S":p=f,v=!0;break;case"w":p=d;break;case"W":p=d,v=!0;break}return l(p),{type:"Set",value:p,complement:v}},e.prototype.controlEscapeAtom=function(){var p;switch(this.popChar()){case"f":p=s("\f");break;case"n":p=s(`
`);break;case"r":p=s("\r");break;case"t":p=s("	");break;case"v":p=s("\v");break}return l(p),{type:"Character",value:p}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var p=this.popChar();if(/[a-zA-Z]/.test(p)===!1)throw Error("Invalid ");var v=p.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:v}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:s("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var p=this.popChar();return{type:"Character",value:s(p)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var p=this.popChar();return{type:"Character",value:s(p)}}},e.prototype.characterClass=function(){var p=[],v=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),v=!0);this.isClassAtom();){var y=this.classAtom(),S=y.type==="Character";if(S&&this.isRangeDash()){this.consumeChar("-");var R=this.classAtom(),T=R.type==="Character";if(T){if(R.value<y.value)throw Error("Range out of order in character class");p.push({from:y.value,to:R.value})}else o(y.value,p),p.push(s("-")),o(R.value,p)}else o(y.value,p)}return this.consumeChar("]"),{type:"Set",complement:v,value:p}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:s("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var p=!0;this.consumeChar("("),this.peekChar(0)==="?"?(this.consumeChar("?"),this.consumeChar(":"),p=!1):this.groupIdx++;var v=this.disjunction();this.consumeChar(")");var y={type:"Group",capturing:p,value:v};return p&&(y.idx=this.groupIdx),y},e.prototype.positiveInteger=function(){var p=this.popChar();if(i.test(p)===!1)throw Error("Expecting a positive integer");for(;r.test(this.peekChar(0));)p+=this.popChar();return parseInt(p,10)},e.prototype.integerIncludingZero=function(){var p=this.popChar();if(r.test(p)===!1)throw Error("Expecting an integer");for(;r.test(this.peekChar(0));)p+=this.popChar();return parseInt(p,10)},e.prototype.patternCharacter=function(){var p=this.popChar();switch(p){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:s(p)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return r.test(this.peekChar(0))},e.prototype.isClassAtom=function(p){switch(p===void 0&&(p=0),this.peekChar(p)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var p=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(p)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(p){for(var v="",y=0;y<p;y++){var S=this.popChar();if(t.test(S)===!1)throw Error("Expecting a HexDecimal digits");v+=S}var R=parseInt(v,16);return{type:"Character",value:R}},e.prototype.peekChar=function(p){return p===void 0&&(p=0),this.input[this.idx+p]},e.prototype.popChar=function(){var p=this.peekChar(0);return this.consumeChar(),p},e.prototype.consumeChar=function(p){if(p!==void 0&&this.input[this.idx]!==p)throw Error("Expected: '"+p+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t=/[0-9a-fA-F]/,r=/[0-9]/,i=/[1-9]/;function s(p){return p.charCodeAt(0)}function o(p,v){p.length!==void 0?p.forEach(function(y){v.push(y)}):v.push(p)}function a(p,v){if(p[v]===!0)throw"duplicate flag "+v;p[v]=!0}function l(p){if(p===void 0)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}var h,c=[];for(h=s("0");h<=s("9");h++)c.push(h);var d=[s("_")].concat(c);for(h=s("a");h<=s("z");h++)d.push(h);for(h=s("A");h<=s("Z");h++)d.push(h);var f=[s(" "),s("\f"),s(`
`),s("\r"),s("	"),s("\v"),s("	"),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s("\u2028"),s("\u2029"),s(" "),s(" "),s("　"),s("\uFEFF")];function m(){}return m.prototype.visitChildren=function(p){for(var v in p){var y=p[v];p.hasOwnProperty(v)&&(y.type!==void 0?this.visit(y):Array.isArray(y)&&y.forEach(function(S){this.visit(S)},this))}},m.prototype.visit=function(p){switch(p.type){case"Pattern":this.visitPattern(p);break;case"Flags":this.visitFlags(p);break;case"Disjunction":this.visitDisjunction(p);break;case"Alternative":this.visitAlternative(p);break;case"StartAnchor":this.visitStartAnchor(p);break;case"EndAnchor":this.visitEndAnchor(p);break;case"WordBoundary":this.visitWordBoundary(p);break;case"NonWordBoundary":this.visitNonWordBoundary(p);break;case"Lookahead":this.visitLookahead(p);break;case"NegativeLookahead":this.visitNegativeLookahead(p);break;case"Character":this.visitCharacter(p);break;case"Set":this.visitSet(p);break;case"Group":this.visitGroup(p);break;case"GroupBackReference":this.visitGroupBackReference(p);break;case"Quantifier":this.visitQuantifier(p);break}this.visitChildren(p)},m.prototype.visitPattern=function(p){},m.prototype.visitFlags=function(p){},m.prototype.visitDisjunction=function(p){},m.prototype.visitAlternative=function(p){},m.prototype.visitStartAnchor=function(p){},m.prototype.visitEndAnchor=function(p){},m.prototype.visitWordBoundary=function(p){},m.prototype.visitNonWordBoundary=function(p){},m.prototype.visitLookahead=function(p){},m.prototype.visitNegativeLookahead=function(p){},m.prototype.visitCharacter=function(p){},m.prototype.visitSet=function(p){},m.prototype.visitGroup=function(p){},m.prototype.visitGroupBackReference=function(p){},m.prototype.visitQuantifier=function(p){},{RegExpParser:e,BaseRegExpVisitor:m,VERSION:"0.4.0"}})})(Pv)),Pv.exports}var up=Eme(),Lv={},bme=new up.RegExpParser;function yS(n){var e=n.toString();if(Lv.hasOwnProperty(e))return Lv[e];var t=bme.pattern(e);return Lv[e]=t,t}function Tme(){Lv={}}var Ame=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),J$="Complement Sets are not supported for first char optimization",qy=`Unable to use "first char" lexer optimizations:
`;function Nme(n,e){e===void 0&&(e=!1);try{var t=yS(n),r=xN(t.value,{},t.flags.ignoreCase);return r}catch(s){if(s.message===J$)e&&DO(""+qy+("	Unable to optimize: < "+n.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var i="";e&&(i=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),_N(qy+`
`+("	Failed parsing: < "+n.toString()+` >
`)+("	Using the regexp-to-ast library version: "+up.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+i)}}return[]}function xN(n,e,t){switch(n.type){case"Disjunction":for(var r=0;r<n.value.length;r++)xN(n.value[r],e,t);break;case"Alternative":for(var i=n.value,r=0;r<i.length;r++){var s=i[r];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var o=s;switch(o.type){case"Character":Kw(o.value,e,t);break;case"Set":if(o.complement===!0)throw Error(J$);je(o.value,function(u){if(typeof u=="number")Kw(u,e,t);else{var h=u;if(t===!0)for(var c=h.from;c<=h.to;c++)Kw(c,e,t);else{for(var c=h.from;c<=h.to&&c<vm;c++)Kw(c,e,t);if(h.to>=vm)for(var d=h.from>=vm?h.from:vm,f=h.to,m=Su(d),p=Su(f),v=m;v<=p;v++)e[v]=v}}});break;case"Group":xN(o.value,e,t);break;default:throw Error("Non Exhaustive Match")}var a=o.quantifier!==void 0&&o.quantifier.atLeast===0;if(o.type==="Group"&&PN(o)===!1||o.type!=="Group"&&a===!1)break}break;default:throw Error("non exhaustive match!")}return Qr(e)}function Kw(n,e,t){var r=Su(n);e[r]=r,t===!0&&Ime(n,e)}function Ime(n,e){var t=String.fromCharCode(n),r=t.toUpperCase();if(r!==t){var i=Su(r.charCodeAt(0));e[i]=i}else{var s=t.toLowerCase();if(s!==t){var i=Su(s.charCodeAt(0));e[i]=i}}}function aF(n,e){return jd(n.value,function(t){if(typeof t=="number")return gr(e,t);var r=t;return jd(e,function(i){return r.from<=i&&i<=r.to})!==void 0})}function PN(n){return n.quantifier&&n.quantifier.atLeast===0?!0:n.value?fo(n.value)?Is(n.value,PN):PN(n.value):!1}var Mme=(function(n){Ame(e,n);function e(t){var r=n.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return e.prototype.visitChildren=function(t){if(this.found!==!0){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}n.prototype.visitChildren.call(this,t)}},e.prototype.visitCharacter=function(t){gr(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?aF(t,this.targetCharCodes)===void 0&&(this.found=!0):aF(t,this.targetCharCodes)!==void 0&&(this.found=!0)},e})(up.BaseRegExpVisitor);function HO(n,e){if(e instanceof RegExp){var t=yS(e),r=new Mme(n);return r.visit(t),r.found}else return jd(e,function(i){return gr(n,i.charCodeAt(0))})!==void 0}var eG=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),ya="PATTERN",Hh="defaultMode",qw="modes",tG=typeof new RegExp("(?:)").sticky=="boolean";function Ome(n,e){e=vS(e,{useSticky:tG,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(S,R){return R()}});var t=e.tracer;t("initCharCodeToOptimizedIndexMap",function(){Jme()});var r;t("Reject Lexer.NA",function(){r=Xh(n,function(S){return S[ya]===Fi.NA})});var i=!1,s;t("Transform Patterns",function(){i=!1,s=Ne(r,function(S){var R=S[ya];if(pl(R)){var T=R.source;return T.length===1&&T!=="^"&&T!=="$"&&T!=="."?T:T.length===2&&T[0]==="\\"&&!gr(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],T[1])?T[1]:e.useSticky?uF(R):lF(R)}else{if(Au(R))return i=!0,{exec:R};if(Ge(R,"exec"))return i=!0,R;if(typeof R=="string"){if(R.length===1)return R;var I=R.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),H=new RegExp(I);return e.useSticky?uF(H):lF(H)}else throw Error("non exhaustive match")}})});var o,a,l,u,h;t("misc mapping",function(){o=Ne(r,function(S){return S.tokenTypeIdx}),a=Ne(r,function(S){var R=S.GROUP;if(R!==Fi.SKIPPED){if(va(R))return R;if(xs(R))return!1;throw Error("non exhaustive match")}}),l=Ne(r,function(S){var R=S.LONGER_ALT;if(R){var T=vme(r,R);return T}}),u=Ne(r,function(S){return S.PUSH_MODE}),h=Ne(r,function(S){return Ge(S,"POP_MODE")})});var c;t("Line Terminator Handling",function(){var S=iG(e.lineTerminatorCharacters);c=Ne(r,function(R){return!1}),e.positionTracking!=="onlyOffset"&&(c=Ne(r,function(R){if(Ge(R,"LINE_BREAKS"))return R.LINE_BREAKS;if(rG(R,S)===!1)return HO(S,R.PATTERN)}))});var d,f,m,p;t("Misc Mapping #2",function(){d=Ne(r,nG),f=Ne(s,Xme),m=kr(r,function(S,R){var T=R.GROUP;return va(T)&&T!==Fi.SKIPPED&&(S[T]=[]),S},{}),p=Ne(s,function(S,R){return{pattern:s[R],longerAlt:l[R],canLineTerminator:c[R],isCustom:d[R],short:f[R],group:a[R],push:u[R],pop:h[R],tokenTypeIdx:o[R],tokenType:r[R]}})});var v=!0,y=[];return e.safeMode||t("First Char Optimization",function(){y=kr(r,function(S,R,T){if(typeof R.PATTERN=="string"){var I=R.PATTERN.charCodeAt(0),H=Su(I);cA(S,H,p[T])}else if(fo(R.START_CHARS_HINT)){var k;je(R.START_CHARS_HINT,function(Y){var $=typeof Y=="string"?Y.charCodeAt(0):Y,q=Su($);k!==q&&(k=q,cA(S,q,p[T]))})}else if(pl(R.PATTERN))if(R.PATTERN.unicode)v=!1,e.ensureOptimizations&&_N(""+qy+("	Unable to analyze < "+R.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var W=Nme(R.PATTERN,e.ensureOptimizations);on(W)&&(v=!1),je(W,function(Y){cA(S,Y,p[T])})}else e.ensureOptimizations&&_N(""+qy+("	TokenType: <"+R.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),v=!1;return S},[])}),t("ArrayPacking",function(){y=Cme(y)}),{emptyGroups:m,patternIdxToConfig:p,charCodeToPatternIdxToConfig:y,hasCustom:i,canBeOptimized:v}}function _me(n,e){var t=[],r=Pme(n);t=t.concat(r.errors);var i=Lme(r.valid),s=i.valid;return t=t.concat(i.errors),t=t.concat(xme(s)),t=t.concat(Wme(s)),t=t.concat($me(s,e)),t=t.concat(Gme(s)),t}function xme(n){var e=[],t=No(n,function(r){return pl(r[ya])});return e=e.concat(Hme(t)),e=e.concat(Vme(t)),e=e.concat(Ume(t)),e=e.concat(Bme(t)),e=e.concat(Fme(t)),e}function Pme(n){var e=No(n,function(i){return!Ge(i,ya)}),t=Ne(e,function(i){return{message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:Jn.MISSING_PATTERN,tokenTypes:[i]}}),r=wS(n,e);return{errors:t,valid:r}}function Lme(n){var e=No(n,function(i){var s=i[ya];return!pl(s)&&!Au(s)&&!Ge(s,"exec")&&!va(s)}),t=Ne(e,function(i){return{message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Jn.INVALID_PATTERN,tokenTypes:[i]}}),r=wS(n,e);return{errors:t,valid:r}}var Dme=/[^\\][\$]/;function Hme(n){var e=(function(i){eG(s,i);function s(){var o=i!==null&&i.apply(this,arguments)||this;return o.found=!1,o}return s.prototype.visitEndAnchor=function(o){this.found=!0},s})(up.BaseRegExpVisitor),t=No(n,function(i){var s=i[ya];try{var o=yS(s),a=new e;return a.visit(o),a.found}catch{return Dme.test(s.source)}}),r=Ne(t,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Jn.EOI_ANCHOR_FOUND,tokenTypes:[i]}});return r}function Fme(n){var e=No(n,function(r){var i=r[ya];return i.test("")}),t=Ne(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:Jn.EMPTY_MATCH_PATTERN,tokenTypes:[r]}});return t}var kme=/[^\\[][\^]|^\^/;function Vme(n){var e=(function(i){eG(s,i);function s(){var o=i!==null&&i.apply(this,arguments)||this;return o.found=!1,o}return s.prototype.visitStartAnchor=function(o){this.found=!0},s})(up.BaseRegExpVisitor),t=No(n,function(i){var s=i[ya];try{var o=yS(s),a=new e;return a.visit(o),a.found}catch{return kme.test(s.source)}}),r=Ne(t,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Jn.SOI_ANCHOR_FOUND,tokenTypes:[i]}});return r}function Ume(n){var e=No(n,function(r){var i=r[ya];return i instanceof RegExp&&(i.multiline||i.global)}),t=Ne(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Jn.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}});return t}function Bme(n){var e=[],t=Ne(n,function(s){return kr(n,function(o,a){return s.PATTERN.source===a.PATTERN.source&&!gr(e,a)&&a.PATTERN!==Fi.NA&&(e.push(a),o.push(a)),o},[])});t=lp(t);var r=No(t,function(s){return s.length>1}),i=Ne(r,function(s){var o=Ne(s,function(l){return l.name}),a=_s(s).PATTERN;return{message:"The same RegExp pattern ->"+a+"<-"+("has been used in all of the following Token Types: "+o.join(", ")+" <-"),type:Jn.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}});return i}function Wme(n){var e=No(n,function(r){if(!Ge(r,"GROUP"))return!1;var i=r.GROUP;return i!==Fi.SKIPPED&&i!==Fi.NA&&!va(i)}),t=Ne(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Jn.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}});return t}function $me(n,e){var t=No(n,function(i){return i.PUSH_MODE!==void 0&&!gr(e,i.PUSH_MODE)}),r=Ne(t,function(i){var s="Token Type: ->"+i.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+i.PUSH_MODE+"<-which does not exist";return{message:s,type:Jn.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}});return r}function Gme(n){var e=[],t=kr(n,function(r,i,s){var o=i.PATTERN;return o===Fi.NA||(va(o)?r.push({str:o,idx:s,tokenType:i}):pl(o)&&zme(o)&&r.push({str:o.source,idx:s,tokenType:i})),r},[]);return je(n,function(r,i){je(t,function(s){var o=s.str,a=s.idx,l=s.tokenType;if(i<a&&jme(o,r.PATTERN)){var u="Token: ->"+l.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+r.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:u,type:Jn.UNREACHABLE_PATTERN,tokenTypes:[r,l]})}})}),e}function jme(n,e){if(pl(e)){var t=e.exec(n);return t!==null&&t.index===0}else{if(Au(e))return e(n,0,[],{});if(Ge(e,"exec"))return e.exec(n,0,[],{});if(typeof e=="string")return e===n;throw Error("non exhaustive match")}}function zme(n){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return jd(e,function(t){return n.source.indexOf(t)!==-1})===void 0}function lF(n){var e=n.ignoreCase?"i":"";return new RegExp("^(?:"+n.source+")",e)}function uF(n){var e=n.ignoreCase?"iy":"y";return new RegExp(""+n.source,e)}function Yme(n,e,t){var r=[];return Ge(n,Hh)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Hh+`> property in its definition
`,type:Jn.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Ge(n,qw)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+qw+`> property in its definition
`,type:Jn.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Ge(n,qw)&&Ge(n,Hh)&&!Ge(n.modes,n.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a "+Hh+": <"+n.defaultMode+`>which does not exist
`,type:Jn.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Ge(n,qw)&&je(n.modes,function(i,s){je(i,function(o,a){xs(o)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+s+"> at index: <"+a+`>
`),type:Jn.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),r}function Kme(n,e,t){var r=[],i=!1,s=lp(ki(pme(n.modes,function(l){return l}))),o=Xh(s,function(l){return l[ya]===Fi.NA}),a=iG(t);return e&&je(o,function(l){var u=rG(l,a);if(u!==!1){var h=Zme(l,u),c={message:h,type:u.issue,tokenType:l};r.push(c)}else Ge(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(i=!0):HO(a,l.PATTERN)&&(i=!0)}),e&&!i&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:Jn.NO_LINE_BREAKS_FLAGS}),r}function qme(n){var e={},t=El(n);return je(t,function(r){var i=n[r];if(fo(i))e[r]=[];else throw Error("non exhaustive match")}),e}function nG(n){var e=n.PATTERN;if(pl(e))return!1;if(Au(e))return!0;if(Ge(e,"exec"))return!0;if(va(e))return!1;throw Error("non exhaustive match")}function Xme(n){return va(n)&&n.length===1?n.charCodeAt(0):!1}var Qme={test:function(n){for(var e=n.length,t=this.lastIndex;t<e;t++){var r=n.charCodeAt(t);if(r===10)return this.lastIndex=t+1,!0;if(r===13)return n.charCodeAt(t+1)===10?this.lastIndex=t+2:this.lastIndex=t+1,!0}return!1},lastIndex:0};function rG(n,e){if(Ge(n,"LINE_BREAKS"))return!1;if(pl(n.PATTERN)){try{HO(e,n.PATTERN)}catch(t){return{issue:Jn.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}else{if(va(n.PATTERN))return!1;if(nG(n))return{issue:Jn.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function Zme(n,e){if(e.issue===Jn.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+n.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===Jn.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+n.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function iG(n){var e=Ne(n,function(t){return va(t)&&t.length>0?t.charCodeAt(0):t});return e}function cA(n,e,t){n[e]===void 0?n[e]=[t]:n[e].push(t)}var vm=256;function Su(n){return n<vm?n:Dv[n]}var Dv=[];function Jme(){if(on(Dv)){Dv=new Array(65536);for(var n=0;n<65536;n++)Dv[n]=n>255?255+~~(n/255):n}}function CS(n,e){var t=n.tokenTypeIdx;return t===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[t]===!0}function Xy(n,e){return n.tokenTypeIdx===e.tokenTypeIdx}var hF=1,sG={};function hp(n){var e=ege(n);tge(e),rge(e),nge(e),je(e,function(t){t.isParent=t.categoryMatches.length>0})}function ege(n){for(var e=Vi(n),t=n,r=!0;r;){t=lp(ki(Ne(t,function(s){return s.CATEGORIES})));var i=wS(t,e);e=e.concat(i),on(i)?r=!1:t=i}return e}function tge(n){je(n,function(e){aG(e)||(sG[hF]=e,e.tokenTypeIdx=hF++),cF(e)&&!fo(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),cF(e)||(e.CATEGORIES=[]),ige(e)||(e.categoryMatches=[]),sge(e)||(e.categoryMatchesMap={})})}function nge(n){je(n,function(e){e.categoryMatches=[],je(e.categoryMatchesMap,function(t,r){e.categoryMatches.push(sG[r].tokenTypeIdx)})})}function rge(n){je(n,function(e){oG([],e)})}function oG(n,e){je(n,function(t){e.categoryMatchesMap[t.tokenTypeIdx]=!0}),je(e.CATEGORIES,function(t){var r=n.concat(e);gr(r,t)||oG(r,t)})}function aG(n){return Ge(n,"tokenTypeIdx")}function cF(n){return Ge(n,"CATEGORIES")}function ige(n){return Ge(n,"categoryMatches")}function sge(n){return Ge(n,"categoryMatchesMap")}function oge(n){return Ge(n,"tokenTypeIdx")}var age={buildUnableToPopLexerModeMessage:function(n){return"Unable to pop Lexer Mode after encountering Token ->"+n.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(n,e,t,r,i){return"unexpected character: ->"+n.charAt(e)+"<- at offset: "+e+","+(" skipped "+t+" characters.")}},Jn;(function(n){n[n.MISSING_PATTERN=0]="MISSING_PATTERN",n[n.INVALID_PATTERN=1]="INVALID_PATTERN",n[n.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",n[n.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",n[n.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",n[n.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",n[n.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",n[n.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",n[n.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",n[n.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",n[n.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",n[n.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",n[n.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",n[n.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",n[n.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",n[n.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",n[n.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(Jn||(Jn={}));var ym={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:age,traceInitPerf:!1,skipValidations:!1};Object.freeze(ym);var Fi=(function(){function n(e,t){var r=this;if(t===void 0&&(t=ym),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof t=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=rF(ym,t);var i=this.config.traceInitPerf;i===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof i=="number"&&(this.traceInitMaxIdent=i,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var s,o=!0;r.TRACE_INIT("Lexer Config handling",function(){if(r.config.lineTerminatorsPattern===ym.lineTerminatorsPattern)r.config.lineTerminatorsPattern=Qme;else if(r.config.lineTerminatorCharacters===ym.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),fo(e)?(s={modes:{}},s.modes[Hh]=Vi(e),s[Hh]=Hh):(o=!1,s=ap(e))}),r.config.skipValidations===!1&&(r.TRACE_INIT("performRuntimeChecks",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Yme(s,r.trackStartLines,r.config.lineTerminatorCharacters))}),r.TRACE_INIT("performWarningRuntimeChecks",function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(Kme(s,r.trackStartLines,r.config.lineTerminatorCharacters))})),s.modes=s.modes?s.modes:{},je(s.modes,function(h,c){s.modes[c]=Xh(h,function(d){return xs(d)})});var a=El(s.modes);if(je(s.modes,function(h,c){r.TRACE_INIT("Mode: <"+c+"> processing",function(){if(r.modes.push(c),r.config.skipValidations===!1&&r.TRACE_INIT("validatePatterns",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(_me(h,a))}),on(r.lexerDefinitionErrors)){hp(h);var d;r.TRACE_INIT("analyzeTokenTypes",function(){d=Ome(h,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:r.TRACE_INIT.bind(r)})}),r.patternIdxToConfig[c]=d.patternIdxToConfig,r.charCodeToPatternIdxToConfig[c]=d.charCodeToPatternIdxToConfig,r.emptyGroups=rF(r.emptyGroups,d.emptyGroups),r.hasCustom=d.hasCustom||r.hasCustom,r.canModeBeOptimized[c]=d.canBeOptimized}})}),r.defaultMode=s.defaultMode,!on(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var l=Ne(r.lexerDefinitionErrors,function(h){return h.message}),u=l.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}je(r.lexerDefinitionWarning,function(h){DO(h.message)}),r.TRACE_INIT("Choosing sub-methods implementations",function(){if(tG?(r.chopInput=iF,r.match=r.matchWithTest):(r.updateLastIndex=yr,r.match=r.matchWithExec),o&&(r.handleModes=yr),r.trackStartLines===!1&&(r.computeNewColumn=iF),r.trackEndLines===!1&&(r.updateTokenEndLineColumnLocation=yr),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else if(/onlyOffset/i.test(r.config.positionTracking))r.createTokenInstance=r.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)}),r.TRACE_INIT("Failed Optimization Warnings",function(){var h=kr(r.canModeBeOptimized,function(c,d,f){return d===!1&&c.push(f),c},[]);if(t.ensureOptimizations&&!on(h))throw Error("Lexer Modes: < "+h.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),r.TRACE_INIT("clearRegExpParserCache",function(){Tme()}),r.TRACE_INIT("toFastProperties",function(){Q$(r)})})}return n.prototype.tokenize=function(e,t){if(t===void 0&&(t=this.defaultMode),!on(this.lexerDefinitionErrors)){var r=Ne(this.lexerDefinitionErrors,function(o){return o.message}),i=r.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}var s=this.tokenizeInternal(e,t);return s},n.prototype.tokenizeInternal=function(e,t){var r=this,i,s,o,a,l,u,h,c,d,f,m,p,v,y,S=e,R=S.length,T=0,I=0,H=this.hasCustom?0:Math.floor(e.length/10),k=new Array(H),W=[],Y=this.trackStartLines?1:void 0,$=this.trackStartLines?1:void 0,q=qme(this.emptyGroups),J=this.trackStartLines,re=this.config.lineTerminatorsPattern,ie=0,ae=[],Ve=[],De=[],Se=[];Object.freeze(Se);var pe=void 0;function ze(){return ae}function w(A){var O=Su(A),x=Ve[O];return x===void 0?Se:x}var C=function(A){if(De.length===1&&A.tokenType.PUSH_MODE===void 0){var O=r.config.errorMessageProvider.buildUnableToPopLexerModeMessage(A);W.push({offset:A.startOffset,line:A.startLine!==void 0?A.startLine:void 0,column:A.startColumn!==void 0?A.startColumn:void 0,length:A.image.length,message:O})}else{De.pop();var x=K$(De);ae=r.patternIdxToConfig[x],Ve=r.charCodeToPatternIdxToConfig[x],ie=ae.length;var z=r.canModeBeOptimized[x]&&r.config.safeMode===!1;Ve&&z?pe=w:pe=ze}};function b(A){De.push(A),Ve=this.charCodeToPatternIdxToConfig[A],ae=this.patternIdxToConfig[A],ie=ae.length,ie=ae.length;var O=this.canModeBeOptimized[A]&&this.config.safeMode===!1;Ve&&O?pe=w:pe=ze}b.call(this,t);for(var P;T<R;){l=null;var L=S.charCodeAt(T),G=pe(L),ee=G.length;for(i=0;i<ee;i++){P=G[i];var ne=P.pattern;u=null;var he=P.short;if(he!==!1?L===he&&(l=ne):P.isCustom===!0?(y=ne.exec(S,T,k,q),y!==null?(l=y[0],y.payload!==void 0&&(u=y.payload)):l=null):(this.updateLastIndex(ne,T),l=this.match(ne,e,T)),l!==null){if(a=P.longerAlt,a!==void 0){var we=ae[a],oe=we.pattern;h=null,we.isCustom===!0?(y=oe.exec(S,T,k,q),y!==null?(o=y[0],y.payload!==void 0&&(h=y.payload)):o=null):(this.updateLastIndex(oe,T),o=this.match(oe,e,T)),o&&o.length>l.length&&(l=o,u=h,P=we)}break}}if(l!==null){if(c=l.length,d=P.group,d!==void 0&&(f=P.tokenTypeIdx,m=this.createTokenInstance(l,T,f,P.tokenType,Y,$,c),this.handlePayload(m,u),d===!1?I=this.addToken(k,I,m):q[d].push(m)),e=this.chopInput(e,c),T=T+c,$=this.computeNewColumn($,c),J===!0&&P.canLineTerminator===!0){var We=0,Ke=void 0,Q=void 0;re.lastIndex=0;do Ke=re.test(l),Ke===!0&&(Q=re.lastIndex-1,We++);while(Ke===!0);We!==0&&(Y=Y+We,$=c-Q,this.updateTokenEndLineColumnLocation(m,d,Q,We,Y,$,c))}this.handleModes(P,C,b,m)}else{for(var Qe=T,et=Y,ht=$,Ze=!1;!Ze&&T<R;)for(S.charCodeAt(T),e=this.chopInput(e,1),T++,s=0;s<ie;s++){var ke=ae[s],ne=ke.pattern,he=ke.short;if(he!==!1?S.charCodeAt(T)===he&&(Ze=!0):ke.isCustom===!0?Ze=ne.exec(S,T,k,q)!==null:(this.updateLastIndex(ne,T),Ze=ne.exec(e)!==null),Ze===!0)break}p=T-Qe,v=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(S,Qe,p,et,ht),W.push({offset:Qe,line:et,column:ht,length:p,message:v})}}return this.hasCustom||(k.length=I),{tokens:k,groups:q,errors:W}},n.prototype.handleModes=function(e,t,r,i){if(e.pop===!0){var s=e.push;t(i),s!==void 0&&r.call(this,s)}else e.push!==void 0&&r.call(this,e.push)},n.prototype.chopInput=function(e,t){return e.substring(t)},n.prototype.updateLastIndex=function(e,t){e.lastIndex=t},n.prototype.updateTokenEndLineColumnLocation=function(e,t,r,i,s,o,a){var l,u;t!==void 0&&(l=r===a-1,u=l?-1:0,i===1&&l===!0||(e.endLine=s+u,e.endColumn=o-1+-u))},n.prototype.computeNewColumn=function(e,t){return e+t},n.prototype.createTokenInstance=function(){return null},n.prototype.createOffsetOnlyToken=function(e,t,r,i){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:i}},n.prototype.createStartOnlyToken=function(e,t,r,i,s,o){return{image:e,startOffset:t,startLine:s,startColumn:o,tokenTypeIdx:r,tokenType:i}},n.prototype.createFullToken=function(e,t,r,i,s,o,a){return{image:e,startOffset:t,endOffset:t+a-1,startLine:s,endLine:s,startColumn:o,endColumn:o+a-1,tokenTypeIdx:r,tokenType:i}},n.prototype.addToken=function(e,t,r){return 666},n.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},n.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,t++,t},n.prototype.handlePayload=function(e,t){},n.prototype.handlePayloadNoCustom=function(e,t){},n.prototype.handlePayloadWithCustom=function(e,t){t!==null&&(e.payload=t)},n.prototype.match=function(e,t,r){return null},n.prototype.matchWithTest=function(e,t,r){var i=e.test(t);return i===!0?t.substring(r,e.lastIndex):null},n.prototype.matchWithExec=function(e,t){var r=e.exec(t);return r!==null?r[0]:r},n.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var i=Z$(t),s=i.time,o=i.value,a=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(r+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,o}else return t()},n.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",n.NA=/NOT_APPLICABLE/,n})();function Od(n){return lG(n)?n.LABEL:n.name}function lG(n){return va(n.LABEL)&&n.LABEL!==""}var lge="parent",dF="categories",fF="label",mF="group",gF="push_mode",pF="pop_mode",wF="longer_alt",vF="line_breaks",yF="start_chars_hint";function At(n){return uge(n)}function uge(n){var e=n.pattern,t={};if(t.name=n.name,xs(e)||(t.PATTERN=e),Ge(n,lge))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return Ge(n,dF)&&(t.CATEGORIES=n[dF]),hp([t]),Ge(n,fF)&&(t.LABEL=n[fF]),Ge(n,mF)&&(t.GROUP=n[mF]),Ge(n,pF)&&(t.POP_MODE=n[pF]),Ge(n,gF)&&(t.PUSH_MODE=n[gF]),Ge(n,wF)&&(t.LONGER_ALT=n[wF]),Ge(n,vF)&&(t.LINE_BREAKS=n[vF]),Ge(n,yF)&&(t.START_CHARS_HINT=n[yF]),t}var Qh=At({name:"EOF",pattern:Fi.NA});hp([Qh]);function FO(n,e,t,r,i,s,o,a){return{image:e,startOffset:t,endOffset:r,startLine:i,endLine:s,startColumn:o,endColumn:a,tokenTypeIdx:n.tokenTypeIdx,tokenType:n}}function Jt(n,e){return CS(n,e)}var bl=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),ba=(function(){function n(e){this.definition=e}return n.prototype.accept=function(e){e.visit(this),je(this.definition,function(t){t.accept(e)})},n})(),ns=(function(n){bl(e,n);function e(t){var r=n.call(this,[])||this;return r.idx=1,Io(r,ks(t,function(i){return i!==void 0})),r}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e})(ba),lf=(function(n){bl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.orgText="",Io(r,ks(t,function(i){return i!==void 0})),r}return e})(ba),Ui=(function(n){bl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.ignoreAmbiguities=!1,Io(r,ks(t,function(i){return i!==void 0})),r}return e})(ba),Fr=(function(n){bl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,Io(r,ks(t,function(i){return i!==void 0})),r}return e})(ba),Ps=(function(n){bl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,Io(r,ks(t,function(i){return i!==void 0})),r}return e})(ba),Ls=(function(n){bl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,Io(r,ks(t,function(i){return i!==void 0})),r}return e})(ba),Qn=(function(n){bl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,Io(r,ks(t,function(i){return i!==void 0})),r}return e})(ba),rs=(function(n){bl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,Io(r,ks(t,function(i){return i!==void 0})),r}return e})(ba),is=(function(n){bl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,Io(r,ks(t,function(i){return i!==void 0})),r}return e})(ba),Dn=(function(){function n(e){this.idx=1,Io(this,ks(e,function(t){return t!==void 0}))}return n.prototype.accept=function(e){e.visit(this)},n})();function hge(n){return Ne(n,Hv)}function Hv(n){function e(i){return Ne(i,Hv)}if(n instanceof ns)return{type:"NonTerminal",name:n.nonTerminalName,idx:n.idx};if(n instanceof Ui)return{type:"Flat",definition:e(n.definition)};if(n instanceof Fr)return{type:"Option",idx:n.idx,definition:e(n.definition)};if(n instanceof Ps)return{type:"RepetitionMandatory",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof Ls)return{type:"RepetitionMandatoryWithSeparator",name:n.name,idx:n.idx,separator:Hv(new Dn({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof rs)return{type:"RepetitionWithSeparator",name:n.name,idx:n.idx,separator:Hv(new Dn({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof Qn)return{type:"Repetition",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof is)return{type:"Alternation",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof Dn){var t={type:"Terminal",name:n.terminalType.name,label:Od(n.terminalType),idx:n.idx},r=n.terminalType.PATTERN;return n.terminalType.PATTERN&&(t.pattern=pl(r)?r.source:r),t}else{if(n instanceof lf)return{type:"Rule",name:n.name,orgText:n.orgText,definition:e(n.definition)};throw Error("non exhaustive match")}}var SS=(function(){function n(){}return n.prototype.walk=function(e,t){var r=this;t===void 0&&(t=[]),je(e.definition,function(i,s){var o=Dr(e.definition,s+1);if(i instanceof ns)r.walkProdRef(i,o,t);else if(i instanceof Dn)r.walkTerminal(i,o,t);else if(i instanceof Ui)r.walkFlat(i,o,t);else if(i instanceof Fr)r.walkOption(i,o,t);else if(i instanceof Ps)r.walkAtLeastOne(i,o,t);else if(i instanceof Ls)r.walkAtLeastOneSep(i,o,t);else if(i instanceof rs)r.walkManySep(i,o,t);else if(i instanceof Qn)r.walkMany(i,o,t);else if(i instanceof is)r.walkOr(i,o,t);else throw Error("non exhaustive match")})},n.prototype.walkTerminal=function(e,t,r){},n.prototype.walkProdRef=function(e,t,r){},n.prototype.walkFlat=function(e,t,r){var i=t.concat(r);this.walk(e,i)},n.prototype.walkOption=function(e,t,r){var i=t.concat(r);this.walk(e,i)},n.prototype.walkAtLeastOne=function(e,t,r){var i=[new Fr({definition:e.definition})].concat(t,r);this.walk(e,i)},n.prototype.walkAtLeastOneSep=function(e,t,r){var i=CF(e,t,r);this.walk(e,i)},n.prototype.walkMany=function(e,t,r){var i=[new Fr({definition:e.definition})].concat(t,r);this.walk(e,i)},n.prototype.walkManySep=function(e,t,r){var i=CF(e,t,r);this.walk(e,i)},n.prototype.walkOr=function(e,t,r){var i=this,s=t.concat(r);je(e.definition,function(o){var a=new Ui({definition:[o]});i.walk(a,s)})},n})();function CF(n,e,t){var r=[new Fr({definition:[new Dn({terminalType:n.separator})].concat(n.definition)})],i=r.concat(e,t);return i}var hc=(function(){function n(){}return n.prototype.visit=function(e){var t=e;switch(t.constructor){case ns:return this.visitNonTerminal(t);case Ui:return this.visitFlat(t);case Fr:return this.visitOption(t);case Ps:return this.visitRepetitionMandatory(t);case Ls:return this.visitRepetitionMandatoryWithSeparator(t);case rs:return this.visitRepetitionWithSeparator(t);case Qn:return this.visitRepetition(t);case is:return this.visitAlternation(t);case Dn:return this.visitTerminal(t);case lf:return this.visitRule(t);default:throw Error("non exhaustive match")}},n.prototype.visitNonTerminal=function(e){},n.prototype.visitFlat=function(e){},n.prototype.visitOption=function(e){},n.prototype.visitRepetition=function(e){},n.prototype.visitRepetitionMandatory=function(e){},n.prototype.visitRepetitionMandatoryWithSeparator=function(e){},n.prototype.visitRepetitionWithSeparator=function(e){},n.prototype.visitAlternation=function(e){},n.prototype.visitTerminal=function(e){},n.prototype.visitRule=function(e){},n})(),cge=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})();function dge(n){return n instanceof Ui||n instanceof Fr||n instanceof Qn||n instanceof Ps||n instanceof Ls||n instanceof rs||n instanceof Dn||n instanceof lf}function Qy(n,e){e===void 0&&(e=[]);var t=n instanceof Fr||n instanceof Qn||n instanceof rs;return t?!0:n instanceof is?q$(n.definition,function(r){return Qy(r,e)}):n instanceof ns&&gr(e,n)?!1:n instanceof ba?(n instanceof ns&&e.push(n),Is(n.definition,function(r){return Qy(r,e)})):!1}function fge(n){return n instanceof is}function ao(n){if(n instanceof ns)return"SUBRULE";if(n instanceof Fr)return"OPTION";if(n instanceof is)return"OR";if(n instanceof Ps)return"AT_LEAST_ONE";if(n instanceof Ls)return"AT_LEAST_ONE_SEP";if(n instanceof rs)return"MANY_SEP";if(n instanceof Qn)return"MANY";if(n instanceof Dn)return"CONSUME";throw Error("non exhaustive match")}var mge=(function(n){cge(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var r=t.terminalType.name+this.separator+"Terminal";Ge(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(t)},e.prototype.visitNonTerminal=function(t){var r=t.nonTerminalName+this.separator+"Terminal";Ge(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e})(hc),Xw=new mge;function gge(n){Xw.reset(),n.accept(Xw);var e=Xw.dslMethods;return Xw.reset(),e}function cp(n){if(n instanceof ns)return cp(n.referencedRule);if(n instanceof Dn)return vge(n);if(dge(n))return pge(n);if(fge(n))return wge(n);throw Error("non exhaustive match")}function pge(n){for(var e=[],t=n.definition,r=0,i=t.length>r,s,o=!0;i&&o;)s=t[r],o=Qy(s),e=e.concat(cp(s)),r=r+1,i=t.length>r;return PO(e)}function wge(n){var e=Ne(n.definition,function(t){return cp(t)});return PO(ki(e))}function vge(n){return[n.terminalType]}var uG="_~IN~_",yge=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),Cge=(function(n){yge(e,n);function e(t){var r=n.call(this)||this;return r.topProd=t,r.follows={},r}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,r,i){},e.prototype.walkProdRef=function(t,r,i){var s=Rge(t.referencedRule,t.idx)+this.topProd.name,o=r.concat(i),a=new Ui({definition:o}),l=cp(a);this.follows[s]=l},e})(SS);function Sge(n){var e={};return je(n,function(t){var r=new Cge(t).startWalking();Io(e,r)}),e}function Rge(n,e){return n.name+e+uG}var Ege=4,Nu=8,bge=8,_d=1<<Nu,Zy=2<<Nu,zm=3<<Nu,Ym=4<<Nu,Km=5<<Nu,vd=6<<Nu;function qm(n,e,t){return t|e|n}var Tge=32-bge;function hG(n,e,t,r){var i=r+1<<Tge;return qm(n,e,t)|i}var Age=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})();function SF(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.endOffset=e.endOffset):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset)}function RF(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.startColumn=e.startColumn,n.startLine=e.startLine,n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine)}function Nge(n,e,t){n.children[t]===void 0?n.children[t]=[e]:n.children[t].push(e)}function EF(n,e,t){n.children[e]===void 0?n.children[e]=[t]:n.children[e].push(t)}var kO=(function(n){Age(e,n);function e(t){var r=n.call(this)||this;return r.result=[],r.ruleIdx=t,r}return e.prototype.collectNamedDSLMethod=function(t,r,i){if(!xs(t.name)){var s=void 0;if(t instanceof Fr||t instanceof Qn||t instanceof Ps||t instanceof is)s=new r({definition:t.definition,idx:t.idx});else if(t instanceof Ls||t instanceof rs)s=new r({definition:t.definition,idx:t.idx,separator:t.separator});else throw Error("non exhaustive match");var o=[s],a=qm(this.ruleIdx,i,t.idx);this.result.push({def:o,key:a,name:t.name,orgProd:t})}},e.prototype.visitOption=function(t){this.collectNamedDSLMethod(t,Fr,Zy)},e.prototype.visitRepetition=function(t){this.collectNamedDSLMethod(t,Qn,zm)},e.prototype.visitRepetitionMandatory=function(t){this.collectNamedDSLMethod(t,Ps,Ym)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.collectNamedDSLMethod(t,Ls,vd)},e.prototype.visitRepetitionWithSeparator=function(t){this.collectNamedDSLMethod(t,rs,Km)},e.prototype.visitAlternation=function(t){var r=this;this.collectNamedDSLMethod(t,is,_d);var i=t.definition.length>1;je(t.definition,function(s,o){if(!xs(s.name)){var a=s.definition;i?a=[new Fr({definition:s.definition})]:a=s.definition;var l=hG(r.ruleIdx,_d,t.idx,o);r.result.push({def:a,key:l,name:s.name,orgProd:s})}})},e})(hc);function Ige(n,e){var t={allRuleNames:[]};return je(n,function(r){var i=e[r.name];t.allRuleNames.push(r.name);var s=new kO(i);r.accept(s),je(s.result,function(o){o.def,o.key;var a=o.name;t.allRuleNames.push(r.name+a)})}),t}var cc=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),Mge=(function(n){cc(e,n);function e(t,r){var i=n.call(this)||this;return i.topProd=t,i.path=r,i.possibleTokTypes=[],i.nextProductionName="",i.nextProductionOccurrence=0,i.found=!1,i.isAtEndOfPath=!1,i}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Vi(this.path.ruleStack).reverse(),this.occurrenceStack=Vi(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(t,r){r===void 0&&(r=[]),this.found||n.prototype.walk.call(this,t,r)},e.prototype.walkProdRef=function(t,r,i){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var s=r.concat(i);this.updateExpectedNext(),this.walk(t.referencedRule,s)}},e.prototype.updateExpectedNext=function(){on(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e})(SS),Oge=(function(n){cc(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.path=r,i.nextTerminalName="",i.nextTerminalOccurrence=0,i.nextTerminalName=i.path.lastTok.name,i.nextTerminalOccurrence=i.path.lastTokOccurrence,i}return e.prototype.walkTerminal=function(t,r,i){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var s=r.concat(i),o=new Ui({definition:s});this.possibleTokTypes=cp(o),this.found=!0}},e})(Mge),RS=(function(n){cc(e,n);function e(t,r){var i=n.call(this)||this;return i.topRule=t,i.occurrence=r,i.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},i}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e})(SS),_ge=(function(n){cc(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkMany=function(t,r,i){if(t.idx===this.occurrence){var s=_s(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Dn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkMany.call(this,t,r,i)},e})(RS),bF=(function(n){cc(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkManySep=function(t,r,i){if(t.idx===this.occurrence){var s=_s(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Dn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkManySep.call(this,t,r,i)},e})(RS),xge=(function(n){cc(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(t,r,i){if(t.idx===this.occurrence){var s=_s(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Dn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkAtLeastOne.call(this,t,r,i)},e})(RS),TF=(function(n){cc(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(t,r,i){if(t.idx===this.occurrence){var s=_s(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Dn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkAtLeastOneSep.call(this,t,r,i)},e})(RS);function LN(n,e,t){t===void 0&&(t=[]),t=Vi(t);var r=[],i=0;function s(u){return u.concat(Dr(n,i+1))}function o(u){var h=LN(s(u),e,t);return r.concat(h)}for(;t.length<e&&i<n.length;){var a=n[i];if(a instanceof Ui)return o(a.definition);if(a instanceof ns)return o(a.definition);if(a instanceof Fr)r=o(a.definition);else if(a instanceof Ps){var l=a.definition.concat([new Qn({definition:a.definition})]);return o(l)}else if(a instanceof Ls){var l=[new Ui({definition:a.definition}),new Qn({definition:[new Dn({terminalType:a.separator})].concat(a.definition)})];return o(l)}else if(a instanceof rs){var l=a.definition.concat([new Qn({definition:[new Dn({terminalType:a.separator})].concat(a.definition)})]);r=o(l)}else if(a instanceof Qn){var l=a.definition.concat([new Qn({definition:a.definition})]);r=o(l)}else{if(a instanceof is)return je(a.definition,function(u){r=o(u.definition)}),r;if(a instanceof Dn)t.push(a.terminalType);else throw Error("non exhaustive match")}i++}return r.push({partialPath:t,suffixDef:Dr(n,i)}),r}function cG(n,e,t,r){var i="EXIT_NONE_TERMINAL",s=[i],o="EXIT_ALTERNATIVE",a=!1,l=e.length,u=l-r-1,h=[],c=[];for(c.push({idx:-1,def:n,ruleStack:[],occurrenceStack:[]});!on(c);){var d=c.pop();if(d===o){a&&K$(c).idx<=u&&c.pop();continue}var f=d.def,m=d.idx,p=d.ruleStack,v=d.occurrenceStack;if(!on(f)){var y=f[0];if(y===i){var S={idx:m,def:Dr(f),ruleStack:Eg(p),occurrenceStack:Eg(v)};c.push(S)}else if(y instanceof Dn)if(m<l-1){var R=m+1,T=e[R];if(t(T,y.terminalType)){var S={idx:R,def:Dr(f),ruleStack:p,occurrenceStack:v};c.push(S)}}else if(m===l-1)h.push({nextTokenType:y.terminalType,nextTokenOccurrence:y.idx,ruleStack:p,occurrenceStack:v}),a=!0;else throw Error("non exhaustive match");else if(y instanceof ns){var I=Vi(p);I.push(y.nonTerminalName);var H=Vi(v);H.push(y.idx);var S={idx:m,def:y.definition.concat(s,Dr(f)),ruleStack:I,occurrenceStack:H};c.push(S)}else if(y instanceof Fr){var k={idx:m,def:Dr(f),ruleStack:p,occurrenceStack:v};c.push(k),c.push(o);var W={idx:m,def:y.definition.concat(Dr(f)),ruleStack:p,occurrenceStack:v};c.push(W)}else if(y instanceof Ps){var Y=new Qn({definition:y.definition,idx:y.idx}),$=y.definition.concat([Y],Dr(f)),S={idx:m,def:$,ruleStack:p,occurrenceStack:v};c.push(S)}else if(y instanceof Ls){var q=new Dn({terminalType:y.separator}),Y=new Qn({definition:[q].concat(y.definition),idx:y.idx}),$=y.definition.concat([Y],Dr(f)),S={idx:m,def:$,ruleStack:p,occurrenceStack:v};c.push(S)}else if(y instanceof rs){var k={idx:m,def:Dr(f),ruleStack:p,occurrenceStack:v};c.push(k),c.push(o);var q=new Dn({terminalType:y.separator}),J=new Qn({definition:[q].concat(y.definition),idx:y.idx}),$=y.definition.concat([J],Dr(f)),W={idx:m,def:$,ruleStack:p,occurrenceStack:v};c.push(W)}else if(y instanceof Qn){var k={idx:m,def:Dr(f),ruleStack:p,occurrenceStack:v};c.push(k),c.push(o);var J=new Qn({definition:y.definition,idx:y.idx}),$=y.definition.concat([J],Dr(f)),W={idx:m,def:$,ruleStack:p,occurrenceStack:v};c.push(W)}else if(y instanceof is)for(var re=y.definition.length-1;re>=0;re--){var ie=y.definition[re],ae={idx:m,def:ie.definition.concat(Dr(f)),ruleStack:p,occurrenceStack:v};c.push(ae),c.push(o)}else if(y instanceof Ui)c.push({idx:m,def:y.definition.concat(Dr(f)),ruleStack:p,occurrenceStack:v});else if(y instanceof lf)c.push(Pge(y,m,p,v));else throw Error("non exhaustive match")}}return h}function Pge(n,e,t,r){var i=Vi(t);i.push(n.name);var s=Vi(r);return s.push(1),{idx:e,def:n.definition,ruleStack:i,occurrenceStack:s}}var dG=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),hn;(function(n){n[n.OPTION=0]="OPTION",n[n.REPETITION=1]="REPETITION",n[n.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",n[n.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",n[n.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",n[n.ALTERNATION=5]="ALTERNATION"})(hn||(hn={}));function Lge(n){if(n instanceof Fr)return hn.OPTION;if(n instanceof Qn)return hn.REPETITION;if(n instanceof Ps)return hn.REPETITION_MANDATORY;if(n instanceof Ls)return hn.REPETITION_MANDATORY_WITH_SEPARATOR;if(n instanceof rs)return hn.REPETITION_WITH_SEPARATOR;if(n instanceof is)return hn.ALTERNATION;throw Error("non exhaustive match")}function Dge(n,e,t,r,i,s){var o=VO(n,e,t),a=gG(o)?Xy:CS;return s(o,r,a,i)}function Hge(n,e,t,r,i,s){var o=UO(n,e,i,t),a=gG(o)?Xy:CS;return s(o[0],a,r)}function Fge(n,e,t,r){var i=n.length,s=Is(n,function(l){return Is(l,function(u){return u.length===1})});if(e)return function(l){for(var u=Ne(l,function(R){return R.GATE}),h=0;h<i;h++){var c=n[h],d=c.length,f=u[h];if(!(f!==void 0&&f.call(this)===!1))e:for(var m=0;m<d;m++){for(var p=c[m],v=p.length,y=0;y<v;y++){var S=this.LA(y+1);if(t(S,p[y])===!1)continue e}return h}}};if(s&&!r){var o=Ne(n,function(l){return ki(l)}),a=kr(o,function(l,u,h){return je(u,function(c){Ge(l,c.tokenTypeIdx)||(l[c.tokenTypeIdx]=h),je(c.categoryMatches,function(d){Ge(l,d)||(l[d]=h)})}),l},[]);return function(){var l=this.LA(1);return a[l.tokenTypeIdx]}}else return function(){for(var l=0;l<i;l++){var u=n[l],h=u.length;e:for(var c=0;c<h;c++){for(var d=u[c],f=d.length,m=0;m<f;m++){var p=this.LA(m+1);if(t(p,d[m])===!1)continue e}return l}}}}function kge(n,e,t){var r=Is(n,function(u){return u.length===1}),i=n.length;if(r&&!t){var s=ki(n);if(s.length===1&&on(s[0].categoryMatches)){var o=s[0],a=o.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===a}}else{var l=kr(s,function(u,h,c){return u[h.tokenTypeIdx]=!0,je(h.categoryMatches,function(d){u[d]=!0}),u},[]);return function(){var u=this.LA(1);return l[u.tokenTypeIdx]===!0}}}else return function(){e:for(var u=0;u<i;u++){for(var h=n[u],c=h.length,d=0;d<c;d++){var f=this.LA(d+1);if(e(f,h[d])===!1)continue e}return!0}return!1}}var Vge=(function(n){dG(e,n);function e(t,r,i){var s=n.call(this)||this;return s.topProd=t,s.targetOccurrence=r,s.targetProdType=i,s}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,r,i,s){return t.idx===this.targetOccurrence&&this.targetProdType===r?(this.restDef=i.concat(s),!0):!1},e.prototype.walkOption=function(t,r,i){this.checkIsTarget(t,hn.OPTION,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkAtLeastOne=function(t,r,i){this.checkIsTarget(t,hn.REPETITION_MANDATORY,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkAtLeastOneSep=function(t,r,i){this.checkIsTarget(t,hn.REPETITION_MANDATORY_WITH_SEPARATOR,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkMany=function(t,r,i){this.checkIsTarget(t,hn.REPETITION,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkManySep=function(t,r,i){this.checkIsTarget(t,hn.REPETITION_WITH_SEPARATOR,r,i)||n.prototype.walkOption.call(this,t,r,i)},e})(SS),fG=(function(n){dG(e,n);function e(t,r,i){var s=n.call(this)||this;return s.targetOccurrence=t,s.targetProdType=r,s.targetRef=i,s.result=[],s}return e.prototype.checkIsTarget=function(t,r){t.idx===this.targetOccurrence&&this.targetProdType===r&&(this.targetRef===void 0||t===this.targetRef)&&(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,hn.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,hn.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,hn.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,hn.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,hn.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,hn.ALTERNATION)},e})(hc);function AF(n){for(var e=new Array(n),t=0;t<n;t++)e[t]=[];return e}function dA(n){for(var e=[""],t=0;t<n.length;t++){for(var r=n[t],i=[],s=0;s<e.length;s++){var o=e[s];i.push(o+"_"+r.tokenTypeIdx);for(var a=0;a<r.categoryMatches.length;a++){var l="_"+r.categoryMatches[a];i.push(o+l)}}e=i}return e}function Uge(n,e,t){for(var r=0;r<n.length;r++)if(r!==t)for(var i=n[r],s=0;s<e.length;s++){var o=e[s];if(i[o]===!0)return!1}return!0}function mG(n,e){for(var t=Ne(n,function(h){return LN([h],1)}),r=AF(t.length),i=Ne(t,function(h){var c={};return je(h,function(d){var f=dA(d.partialPath);je(f,function(m){c[m]=!0})}),c}),s=t,o=1;o<=e;o++){var a=s;s=AF(a.length);for(var l=function(h){for(var c=a[h],d=0;d<c.length;d++){var f=c[d].partialPath,m=c[d].suffixDef,p=dA(f),v=Uge(i,p,h);if(v||on(m)||f.length===e){var y=r[h];if(DN(y,f)===!1){y.push(f);for(var S=0;S<p.length;S++){var R=p[S];i[h][R]=!0}}}else{var T=LN(m,o+1,f);s[h]=s[h].concat(T),je(T,function(I){var H=dA(I.partialPath);je(H,function(k){i[h][k]=!0})})}}},u=0;u<a.length;u++)l(u)}return r}function VO(n,e,t,r){var i=new fG(n,hn.ALTERNATION,r);return e.accept(i),mG(i.result,t)}function UO(n,e,t,r){var i=new fG(n,t);e.accept(i);var s=i.result,o=new Vge(e,n,t),a=o.startWalking(),l=new Ui({definition:s}),u=new Ui({definition:a});return mG([l,u],r)}function DN(n,e){e:for(var t=0;t<n.length;t++){var r=n[t];if(r.length===e.length){for(var i=0;i<r.length;i++){var s=e[i],o=r[i],a=s===o||o.categoryMatchesMap[s.tokenTypeIdx]!==void 0;if(a===!1)continue e}return!0}}return!1}function Bge(n,e){return n.length<e.length&&Is(n,function(t,r){var i=e[r];return t===i||i.categoryMatchesMap[t.tokenTypeIdx]})}function gG(n){return Is(n,function(e){return Is(e,function(t){return Is(t,function(r){return on(r.categoryMatches)})})})}var BO=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})();function Wge(n,e,t,r,i,s){var o=Ne(n,function(S){return Gge(S,i)}),a=Ne(n,function(S){return vG(S,S,i)}),l=[],u=[],h=[];Is(a,on)&&(l=Ne(n,function(S){return Zge(S,i)}),u=Ne(n,function(S){return Jge(S,e,r,i)}),h=npe(n,e,i));var c=spe(n,t,i),d=Ne(t,function(S){return qge(S,i)}),f=$ge(n,i),m=ope(n,i),p=Ne(n,function(S){return tpe(S,i)}),v=Ne(n,function(S){return Yge(S,i)}),y=Ne(n,function(S){return Xge(S,n,s,i)});return ki(o.concat(d,f,m,h,a,l,u,c,p,v,y))}function $ge(n,e){var t=[];return je(n,function(r){var i=new kO("");r.accept(i);var s=Ne(i.result,function(o){return o.orgProd});t.push(Ne(s,function(o){return Kge(r,o,e)}))}),ki(t)}function Gge(n,e){var t=new zge;n.accept(t);var r=t.allProductions,i=X$(r,jge),s=ks(i,function(a){return a.length>1}),o=Ne(Qr(s),function(a){var l=_s(a),u=e.buildDuplicateFoundError(n,a),h=ao(l),c={message:u,type:Nr.DUPLICATE_PRODUCTIONS,ruleName:n.name,dslName:h,occurrence:l.idx},d=pG(l);return d&&(c.parameter=d),c});return o}function jge(n){return ao(n)+"_#_"+n.idx+"_#_"+pG(n)}function pG(n){return n instanceof Dn?n.terminalType.name:n instanceof ns?n.nonTerminalName:""}var zge=(function(n){BO(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e})(hc),Zh=/^[a-zA-Z_]\w*$/,wG=new RegExp(Zh.source.replace("^","^\\$"));function Yge(n,e){var t=[],r=n.name;return r.match(Zh)||t.push({message:e.buildInvalidRuleNameError({topLevelRule:n,expectedPattern:Zh}),type:Nr.INVALID_RULE_NAME,ruleName:r}),t}function Kge(n,e,t){var r=[],i;return e.name.match(wG)||(i=t.buildInvalidNestedRuleNameError(n,e),r.push({message:i,type:Nr.INVALID_NESTED_RULE_NAME,ruleName:n.name})),r}function qge(n,e){var t=[],r=n.name;return r.match(Zh)||t.push({message:e.buildTokenNameError({tokenType:n,expectedPattern:Zh}),type:Nr.INVALID_TOKEN_NAME}),t}function Xge(n,e,t,r){var i=[],s=kr(e,function(a,l){return l.name===n.name?a+1:a},0);if(s>1){var o=r.buildDuplicateRuleNameError({topLevelRule:n,grammarName:t});i.push({message:o,type:Nr.DUPLICATE_RULE_NAME,ruleName:n.name})}return i}function Qge(n,e,t){var r=[],i;return gr(e,n)||(i="Invalid rule override, rule: ->"+n+"<- cannot be overridden in the grammar: ->"+t+"<-as it is not defined in any of the super grammars ",r.push({message:i,type:Nr.INVALID_RULE_OVERRIDE,ruleName:n})),r}function vG(n,e,t,r){r===void 0&&(r=[]);var i=[],s=Fv(e.definition);if(on(s))return[];var o=n.name,a=gr(s,n);a&&i.push({message:t.buildLeftRecursionError({topLevelRule:n,leftRecursionPath:r}),type:Nr.LEFT_RECURSION,ruleName:o});var l=wS(s,r.concat([n])),u=Ne(l,function(h){var c=Vi(r);return c.push(h),vG(n,h,t,c)});return i.concat(ki(u))}function Fv(n){var e=[];if(on(n))return e;var t=_s(n);if(t instanceof ns)e.push(t.referencedRule);else if(t instanceof Ui||t instanceof Fr||t instanceof Ps||t instanceof Ls||t instanceof rs||t instanceof Qn)e=e.concat(Fv(t.definition));else if(t instanceof is)e=ki(Ne(t.definition,function(o){return Fv(o.definition)}));else if(!(t instanceof Dn))throw Error("non exhaustive match");var r=Qy(t),i=n.length>1;if(r&&i){var s=Dr(n);return e.concat(Fv(s))}else return e}var WO=(function(n){BO(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.alternations=[],t}return e.prototype.visitAlternation=function(t){this.alternations.push(t)},e})(hc);function Zge(n,e){var t=new WO;n.accept(t);var r=t.alternations,i=kr(r,function(s,o){var a=Eg(o.definition),l=Ne(a,function(u,h){var c=cG([u],[],null,1);return on(c)?{message:e.buildEmptyAlternationError({topLevelRule:n,alternation:o,emptyChoiceIdx:h}),type:Nr.NONE_LAST_EMPTY_ALT,ruleName:n.name,occurrence:o.idx,alternative:h+1}:null});return s.concat(lp(l))},[]);return i}function Jge(n,e,t,r){var i=new WO;n.accept(i);var s=i.alternations,o=t[n.name];o&&(s=Xh(s,function(l){return o[ao(l)+(l.idx===0?"":l.idx)]})),s=Xh(s,function(l){return l.ignoreAmbiguities===!0});var a=kr(s,function(l,u){var h=u.idx,c=u.maxLookahead||e,d=VO(h,n,c,u),f=rpe(d,u,n,r),m=ipe(d,u,n,r);return l.concat(f,m)},[]);return a}var epe=(function(n){BO(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e})(hc);function tpe(n,e){var t=new WO;n.accept(t);var r=t.alternations,i=kr(r,function(s,o){return o.definition.length>255&&s.push({message:e.buildTooManyAlternativesError({topLevelRule:n,alternation:o}),type:Nr.TOO_MANY_ALTS,ruleName:n.name,occurrence:o.idx}),s},[]);return i}function npe(n,e,t){var r=[];return je(n,function(i){var s=new epe;i.accept(s);var o=s.allProductions;je(o,function(a){var l=Lge(a),u=a.maxLookahead||e,h=a.idx,c=UO(h,i,l,u),d=c[0];if(on(ki(d))){var f=t.buildEmptyRepetitionError({topLevelRule:i,repetition:a});r.push({message:f,type:Nr.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),r}function rpe(n,e,t,r){var i=[],s=kr(n,function(a,l,u){return e.definition[u].ignoreAmbiguities===!0||je(l,function(h){var c=[u];je(n,function(d,f){u!==f&&DN(d,h)&&e.definition[f].ignoreAmbiguities!==!0&&c.push(f)}),c.length>1&&!DN(i,h)&&(i.push(h),a.push({alts:c,path:h}))}),a},[]),o=Ne(s,function(a){var l=Ne(a.alts,function(h){return h+1}),u=r.buildAlternationAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:l,prefixPath:a.path});return{message:u,type:Nr.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:e.idx,alternatives:[a.alts]}});return o}function ipe(n,e,t,r){var i=[],s=kr(n,function(o,a,l){var u=Ne(a,function(h){return{idx:l,path:h}});return o.concat(u)},[]);return je(s,function(o){var a=e.definition[o.idx];if(a.ignoreAmbiguities!==!0){var l=o.idx,u=o.path,h=wme(s,function(d){return e.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<l&&Bge(d.path,u)}),c=Ne(h,function(d){var f=[d.idx+1,l+1],m=e.idx===0?"":e.idx,p=r.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:f,prefixPath:d.path});return{message:p,type:Nr.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:m,alternatives:f}});i=i.concat(c)}}),i}function spe(n,e,t){var r=[],i=Ne(e,function(s){return s.name});return je(n,function(s){var o=s.name;if(gr(i,o)){var a=t.buildNamespaceConflictError(s);r.push({message:a,type:Nr.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:o})}}),r}function ope(n,e){var t=[];return je(n,function(r){var i=new kO("");r.accept(i);var s=X$(i.result,function(a){return a.name}),o=ks(s,function(a){return a.length>1});je(Qr(o),function(a){var l=Ne(a,function(h){return h.orgProd}),u=e.buildDuplicateNestedRuleNameError(r,l);t.push({message:u,type:Nr.DUPLICATE_NESTED_NAME,ruleName:r.name})})}),t}var yG={buildMismatchTokenMessage:function(n){var e=n.expected,t=n.actual;n.previous,n.ruleName;var r=lG(e),i=r?"--> "+Od(e)+" <--":"token of type --> "+e.name+" <--",s="Expecting "+i+" but found --> '"+t.image+"' <--";return s},buildNotAllInputParsedMessage:function(n){var e=n.firstRedundant;return n.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(n){var e=n.expectedPathsPerAlt,t=n.actual;n.previous;var r=n.customUserDescription;n.ruleName;var i="Expecting: ",s=_s(t).image,o=`
but found: '`+s+"'";if(r)return i+r+o;var a=kr(e,function(c,d){return c.concat(d)},[]),l=Ne(a,function(c){return"["+Ne(c,function(d){return Od(d)}).join(", ")+"]"}),u=Ne(l,function(c,d){return"  "+(d+1)+". "+c}),h=`one of these possible Token sequences:
`+u.join(`
`);return i+h+o},buildEarlyExitMessage:function(n){var e=n.expectedIterationPaths,t=n.actual,r=n.customUserDescription;n.ruleName;var i="Expecting: ",s=_s(t).image,o=`
but found: '`+s+"'";if(r)return i+r+o;var a=Ne(e,function(u){return"["+Ne(u,function(h){return Od(h)}).join(",")+"]"}),l=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+a.join(" ,")+">");return i+l+o}};Object.freeze(yG);var ape={buildRuleNotFoundError:function(n,e){var t="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+n.name+"<-";return t}},$O={buildDuplicateFoundError:function(n,e){function t(h){return h instanceof Dn?h.terminalType.name:h instanceof ns?h.nonTerminalName:""}var r=n.name,i=_s(e),s=i.idx,o=ao(i),a=t(i),l=s>0,u="->"+o+(l?s:"")+"<- "+(a?"with argument: ->"+a+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+r+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,`
`),u},buildInvalidNestedRuleNameError:function(n,e){var t="Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+n.name+`<-
`+("it must match the pattern: ->"+wG.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return t},buildDuplicateNestedRuleNameError:function(n,e){var t=_s(e).name,r="Duplicate nested rule name: ->"+t+"<- inside rule: ->"+n.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return r},buildNamespaceConflictError:function(n){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+n.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(n){var e=Ne(n.prefixPath,function(i){return Od(i)}).join(", "),t=n.alternation.idx===0?"":n.alternation.idx,r="Ambiguous alternatives: <"+n.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+t+"> inside <"+n.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return r},buildAlternationAmbiguityError:function(n){var e=Ne(n.prefixPath,function(i){return Od(i)}).join(", "),t=n.alternation.idx===0?"":n.alternation.idx,r="Ambiguous Alternatives Detected: <"+n.ambiguityIndices.join(" ,")+"> in <OR"+t+">"+(" inside <"+n.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return r=r+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError:function(n){var e=ao(n.repetition);n.repetition.idx!==0&&(e+=n.repetition.idx);var t="The repetition <"+e+"> within Rule <"+n.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return t},buildTokenNameError:function(n){var e=n.tokenType.name,t="Invalid Grammar Token name: ->"+e+"<- it must match the pattern: ->"+n.expectedPattern.toString()+"<-";return t},buildEmptyAlternationError:function(n){var e="Ambiguous empty alternative: <"+(n.emptyChoiceIdx+1)+">"+(" in <OR"+n.alternation.idx+"> inside <"+n.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(n){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+n.alternation.idx+"> inside <"+n.topLevelRule.name+`> Rule.
 has `+(n.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(n){var e=n.topLevelRule.name,t=Ne(n.leftRecursionPath,function(s){return s.name}),r=e+" --> "+t.concat([e]).join(" --> "),i=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+r+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return i},buildInvalidRuleNameError:function(n){var e=n.topLevelRule.name,t=n.expectedPattern.toString(),r="Invalid grammar rule name: ->"+e+"<- it must match the pattern: ->"+t+"<-";return r},buildDuplicateRuleNameError:function(n){var e;n.topLevelRule instanceof lf?e=n.topLevelRule.name:e=n.topLevelRule;var t="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+n.grammarName+"<-";return t}},lpe=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})();function upe(n,e){var t=new hpe(n,e);return t.resolveRefs(),t.errors}var hpe=(function(n){lpe(e,n);function e(t,r){var i=n.call(this)||this;return i.nameToTopRule=t,i.errMsgProvider=r,i.errors=[],i}return e.prototype.resolveRefs=function(){var t=this;je(Qr(this.nameToTopRule),function(r){t.currTopLevel=r,r.accept(t)})},e.prototype.visitNonTerminal=function(t){var r=this.nameToTopRule[t.nonTerminalName];if(r)t.referencedRule=r;else{var i=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:i,type:Nr.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e})(hc);function cpe(n){n=vS(n,{errMsgProvider:ape});var e={};return je(n.rules,function(t){e[t.name]=t}),upe(e,n.errMsgProvider)}function dpe(n){return n=vS(n,{errMsgProvider:$O,ignoredIssues:{}}),Wge(n.rules,n.maxLookahead,n.tokenTypes,n.ignoredIssues,n.errMsgProvider,n.grammarName)}var CG="MismatchedTokenException",SG="NoViableAltException",RG="EarlyExitException",EG="NotAllInputParsedException",bG=[CG,SG,RG,EG];Object.freeze(bG);function Jy(n){return gr(bG,n.name)}function GO(n,e,t){this.name=CG,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}GO.prototype=Error.prototype;function TG(n,e,t){this.name=SG,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}TG.prototype=Error.prototype;function AG(n,e){this.name=EG,this.message=n,this.token=e,this.resyncedTokens=[]}AG.prototype=Error.prototype;function NG(n,e,t){this.name=RG,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}NG.prototype=Error.prototype;var fA={},IG="InRuleRecoveryException";function MG(n){this.name=IG,this.message=n}MG.prototype=Error.prototype;var fpe=(function(){function n(){}return n.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Ge(e,"recoveryEnabled")?e.recoveryEnabled:Li.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=mpe)},n.prototype.getTokenToInsert=function(e){var t=FO(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},n.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},n.prototype.tryInRepetitionRecovery=function(e,t,r,i){for(var s=this,o=this.findReSyncTokenType(),a=this.exportLexerState(),l=[],u=!1,h=this.LA(1),c=this.LA(1),d=function(){var f=s.LA(0),m=s.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:h,previous:f,ruleName:s.getCurrRuleFullName()}),p=new GO(m,h,s.LA(0));p.resyncedTokens=Eg(l),s.SAVE_ERROR(p)};!u;)if(this.tokenMatcher(c,i)){d();return}else if(r.call(this)){d(),e.apply(this,t);return}else this.tokenMatcher(c,o)?u=!0:(c=this.SKIP_TOKEN(),this.addToResyncTokens(c,l));this.importLexerState(a)},n.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!(r===!1||e===void 0||t===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))},n.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t),i=this.getNextPossibleTokenTypes(r);return i},n.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t)){var r=this.getTokenToInsert(e);return r}if(this.canRecoverWithSingleTokenDeletion(e)){var i=this.SKIP_TOKEN();return this.consumeToken(),i}throw new MG("sad sad panda")},n.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},n.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||on(t))return!1;var i=this.LA(1),s=jd(t,function(o){return r.tokenMatcher(i,o)})!==void 0;return s},n.prototype.canRecoverWithSingleTokenDeletion=function(e){var t=this.tokenMatcher(this.LA(2),e);return t},n.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return gr(r,e)},n.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var i=t.tokenType;if(gr(e,i))return i;t=this.LA(r),r++}},n.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return fA;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}},n.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return on(this.LAST_EXPLICIT_RULE_STACK)||(t=Ne(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_STACK[i]}),r=Ne(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_OCCURRENCE_STACK[i]})),Ne(t,function(i,s){return s===0?fA:{ruleName:e.shortRuleNameToFullName(i),idxInCallingRule:r[s],inRule:e.shortRuleNameToFullName(t[s-1])}})},n.prototype.flattenFollowSet=function(){var e=this,t=Ne(this.buildFullFollowKeyStack(),function(r){return e.getFollowSetFromFollowKey(r)});return ki(t)},n.prototype.getFollowSetFromFollowKey=function(e){if(e===fA)return[Qh];var t=e.ruleName+e.idxInCallingRule+uG+e.inRule;return this.resyncFollows[t]},n.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,Qh)||t.push(e),t},n.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);this.tokenMatcher(r,e)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return Eg(t)},n.prototype.attemptInRepetitionRecovery=function(e,t,r,i,s,o,a){},n.prototype.getCurrentGrammarPath=function(e,t){var r=this.getHumanReadableRuleStack(),i=Vi(this.RULE_OCCURRENCE_STACK),s={ruleStack:r,occurrenceStack:i,lastTok:e,lastTokOccurrence:t};return s},n.prototype.getHumanReadableRuleStack=function(){var e=this;return on(this.LAST_EXPLICIT_RULE_STACK)?Ne(this.RULE_STACK,function(t){return e.shortRuleNameToFullName(t)}):Ne(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])})},n})();function mpe(n,e,t,r,i,s,o){var a=this.getKeyForAutomaticLookahead(r,i),l=this.firstAfterRepMap[a];if(l===void 0){var u=this.getCurrRuleFullName(),h=this.getGAstProductions()[u],c=new s(h,i);l=c.startWalking(),this.firstAfterRepMap[a]=l}var d=l.token,f=l.occurrence,m=l.isEndOfRule;this.RULE_STACK.length===1&&m&&d===void 0&&(d=Qh,f=1),this.shouldInRepetitionRecoveryBeTried(d,f,o)&&this.tryInRepetitionRecovery(n,e,t,d)}var gpe=(function(){function n(){}return n.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=Ge(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:Li.dynamicTokensEnabled,this.maxLookahead=Ge(e,"maxLookahead")?e.maxLookahead:Li.maxLookahead,this.lookAheadFuncsCache=sF()?new Map:[],sF()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},n.prototype.preComputeLookaheadFunctions=function(e){var t=this;je(e,function(r){t.TRACE_INIT(r.name+" Rule Lookahead",function(){var i=gge(r),s=i.alternation,o=i.repetition,a=i.option,l=i.repetitionMandatory,u=i.repetitionMandatoryWithSeparator,h=i.repetitionWithSeparator;je(s,function(c){var d=c.idx===0?"":c.idx;t.TRACE_INIT(""+ao(c)+d,function(){var f=Dge(c.idx,r,c.maxLookahead||t.maxLookahead,c.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),m=qm(t.fullRuleNameToShort[r.name],_d,c.idx);t.setLaFuncCache(m,f)})}),je(o,function(c){t.computeLookaheadFunc(r,c.idx,zm,hn.REPETITION,c.maxLookahead,ao(c))}),je(a,function(c){t.computeLookaheadFunc(r,c.idx,Zy,hn.OPTION,c.maxLookahead,ao(c))}),je(l,function(c){t.computeLookaheadFunc(r,c.idx,Ym,hn.REPETITION_MANDATORY,c.maxLookahead,ao(c))}),je(u,function(c){t.computeLookaheadFunc(r,c.idx,vd,hn.REPETITION_MANDATORY_WITH_SEPARATOR,c.maxLookahead,ao(c))}),je(h,function(c){t.computeLookaheadFunc(r,c.idx,Km,hn.REPETITION_WITH_SEPARATOR,c.maxLookahead,ao(c))})})})},n.prototype.computeLookaheadFunc=function(e,t,r,i,s,o){var a=this;this.TRACE_INIT(""+o+(t===0?"":t),function(){var l=Hge(t,e,s||a.maxLookahead,a.dynamicTokensEnabled,i,a.lookAheadBuilderForOptional),u=qm(a.fullRuleNameToShort[e.name],r,t);a.setLaFuncCache(u,l)})},n.prototype.lookAheadBuilderForOptional=function(e,t,r){return kge(e,t,r)},n.prototype.lookAheadBuilderForAlternatives=function(e,t,r,i){return Fge(e,t,r,i)},n.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return qm(r,e,t)},n.prototype.getLaFuncFromCache=function(e){},n.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},n.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},n.prototype.setLaFuncCache=function(e,t){},n.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},n.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},n})();function ppe(n){return ES(n.constructor)}var wpe=/^\s*function\s*(\S*)\s*\(/,NF="name";function ES(n){var e=n.name;if(e)return e;var t=n.toString().match(wpe)[1];return t}function OG(n,e){var t=Object.getOwnPropertyDescriptor(n,NF);return xs(t)||t.configurable?(Object.defineProperty(n,NF,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}function vpe(n,e){for(var t=El(n),r=t.length,i=0;i<r;i++)for(var s=t[i],o=n[s],a=o.length,l=0;l<a;l++){var u=o[l];u.tokenTypeIdx===void 0&&(u.fullName!==void 0?this[u.fullName](u.children,e):this[u.name](u.children,e))}}function ype(n,e){var t=function(){};OG(t,n+"BaseSemantics");var r={visit:function(i,s){if(fo(i)&&(i=i[0]),!xs(i))return i.fullName!==void 0?this[i.fullName](i.children,s):this[i.name](i.children,s)},validateVisitor:function(){var i=Spe(this,e);if(!on(i)){var s=Ne(i,function(o){return o.msg});throw Error("Errors Detected in CST Visitor <"+ES(this.constructor)+`>:
	`+(""+s.join(`

`).replace(/\n/g,`
	`)))}}};return t.prototype=r,t.prototype.constructor=t,t._RULE_NAMES=e,t}function Cpe(n,e,t){var r=function(){};OG(r,n+"BaseSemanticsWithDefaults");var i=Object.create(t.prototype);return je(e,function(s){i[s]=vpe}),r.prototype=i,r.prototype.constructor=r,r}var eC;(function(n){n[n.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",n[n.MISSING_METHOD=1]="MISSING_METHOD"})(eC||(eC={}));function Spe(n,e){var t=Rpe(n,e),r=bpe(n,e);return t.concat(r)}function Rpe(n,e){var t=Ne(e,function(r){if(!Au(n[r]))return{msg:"Missing visitor method: <"+r+"> on "+ES(n.constructor)+" CST Visitor.",type:eC.MISSING_METHOD,methodName:r}});return lp(t)}var Epe=["constructor","visit","validateVisitor"];function bpe(n,e){var t=[];for(var r in n)Zh.test(r)&&Au(n[r])&&!gr(Epe,r)&&!gr(e,r)&&t.push({msg:"Redundant visitor method: <"+r+"> on "+ES(n.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+Zh.source+"/."),type:eC.REDUNDANT_METHOD,methodName:r});return t}var Tpe=(function(){function n(){}return n.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=Ge(e,"outputCst")?e.outputCst:Li.outputCst,this.nodeLocationTracking=Ge(e,"nodeLocationTracking")?e.nodeLocationTracking:Li.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=yr,this.cstFinallyStateUpdate=yr,this.cstPostTerminal=yr,this.cstPostNonTerminal=yr,this.cstPostRule=yr,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=RF,this.setNodeLocationFromNode=RF,this.cstPostRule=yr,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=yr,this.setNodeLocationFromNode=yr,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=SF,this.setNodeLocationFromNode=SF,this.cstPostRule=yr,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=yr,this.setNodeLocationFromNode=yr,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=yr,this.setNodeLocationFromNode=yr,this.cstPostRule=yr,this.setInitialNodeLocation=yr;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},n.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},n.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},n.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},n.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},n.prototype.cstNestedInvocationStateUpdate=function(e,t){var r={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},n.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var r={name:e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},n.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},n.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},n.prototype.cstPostRuleFull=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},n.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?r.endOffset=t.endOffset:r.startOffset=NaN},n.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];Nge(r,t,e),this.setNodeLocationFromToken(r.location,t)},n.prototype.cstPostNonTerminal=function(e,t){if(this.isBackTracking()!==!0){var r=this.CST_STACK[this.CST_STACK.length-1];EF(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}},n.prototype.getBaseCstVisitorConstructor=function(){if(xs(this.baseCstVisitorConstructor)){var e=ype(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},n.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(xs(this.baseCstVisitorWithDefaultsConstructor)){var e=Cpe(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},n.prototype.nestedRuleBeforeClause=function(e,t){var r;if(e.NAME!==void 0)return r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r},n.prototype.nestedAltBeforeClause=function(e,t,r,i){var s=this.getLastExplicitRuleShortName(),o=hG(s,r,t,i),a;if(e.NAME!==void 0)return a=e.NAME,this.nestedRuleInvocationStateUpdate(a,o),{shortName:o,nestedName:a}},n.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,i=r[r.length-1];this.nestedRuleFinallyStateUpdate();var s=r[r.length-1];EF(s,t,i),this.setNodeLocationFromNode(s.location,i.location)},n.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},n.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},n.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},n.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},n.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},n.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},n.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},n.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},n})(),Ape=(function(){function n(){}return n.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(n.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),n.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):nC},n.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?nC:this.tokVector[t]},n.prototype.consumeToken=function(){this.currIdx++},n.prototype.exportLexerState=function(){return this.currIdx},n.prototype.importLexerState=function(e){this.currIdx=e},n.prototype.resetLexerState=function(){this.currIdx=-1},n.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},n.prototype.getLexerPosition=function(){return this.exportLexerState()},n})(),Npe=(function(){function n(){}return n.prototype.ACTION=function(e){return e.call(this)},n.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},n.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},n.prototype.option=function(e,t){return this.optionInternal(t,e)},n.prototype.or=function(e,t){return this.orInternal(t,e)},n.prototype.many=function(e,t){return this.manyInternal(e,t)},n.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},n.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},n.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},n.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},n.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},n.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},n.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},n.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},n.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},n.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},n.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},n.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},n.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},n.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},n.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},n.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},n.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},n.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},n.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},n.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},n.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},n.prototype.OPTION=function(e){return this.optionInternal(e,0)},n.prototype.OPTION1=function(e){return this.optionInternal(e,1)},n.prototype.OPTION2=function(e){return this.optionInternal(e,2)},n.prototype.OPTION3=function(e){return this.optionInternal(e,3)},n.prototype.OPTION4=function(e){return this.optionInternal(e,4)},n.prototype.OPTION5=function(e){return this.optionInternal(e,5)},n.prototype.OPTION6=function(e){return this.optionInternal(e,6)},n.prototype.OPTION7=function(e){return this.optionInternal(e,7)},n.prototype.OPTION8=function(e){return this.optionInternal(e,8)},n.prototype.OPTION9=function(e){return this.optionInternal(e,9)},n.prototype.OR=function(e){return this.orInternal(e,0)},n.prototype.OR1=function(e){return this.orInternal(e,1)},n.prototype.OR2=function(e){return this.orInternal(e,2)},n.prototype.OR3=function(e){return this.orInternal(e,3)},n.prototype.OR4=function(e){return this.orInternal(e,4)},n.prototype.OR5=function(e){return this.orInternal(e,5)},n.prototype.OR6=function(e){return this.orInternal(e,6)},n.prototype.OR7=function(e){return this.orInternal(e,7)},n.prototype.OR8=function(e){return this.orInternal(e,8)},n.prototype.OR9=function(e){return this.orInternal(e,9)},n.prototype.MANY=function(e){this.manyInternal(0,e)},n.prototype.MANY1=function(e){this.manyInternal(1,e)},n.prototype.MANY2=function(e){this.manyInternal(2,e)},n.prototype.MANY3=function(e){this.manyInternal(3,e)},n.prototype.MANY4=function(e){this.manyInternal(4,e)},n.prototype.MANY5=function(e){this.manyInternal(5,e)},n.prototype.MANY6=function(e){this.manyInternal(6,e)},n.prototype.MANY7=function(e){this.manyInternal(7,e)},n.prototype.MANY8=function(e){this.manyInternal(8,e)},n.prototype.MANY9=function(e){this.manyInternal(9,e)},n.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},n.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},n.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},n.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},n.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},n.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},n.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},n.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},n.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},n.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},n.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},n.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},n.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},n.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},n.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},n.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},n.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},n.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},n.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},n.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},n.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},n.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},n.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},n.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},n.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},n.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},n.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},n.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},n.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},n.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},n.prototype.RULE=function(e,t,r){if(r===void 0&&(r=rC),gr(this.definedRulesNames,e)){var i=$O.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),s={message:i,type:Nr.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(s)}this.definedRulesNames.push(e);var o=this.defineRule(e,t,r);return this[e]=o,o},n.prototype.OVERRIDE_RULE=function(e,t,r){r===void 0&&(r=rC);var i=[];i=i.concat(Qge(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,i);var s=this.defineRule(e,t,r);return this[e]=s,s},n.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(i){if(Jy(i))return!1;throw i}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},n.prototype.getGAstProductions=function(){return this.gastProductionsCache},n.prototype.getSerializedGastProductions=function(){return hge(Qr(this.gastProductionsCache))},n})(),Ipe=(function(){function n(){}return n.prototype.initRecognizerEngine=function(e,t){if(this.className=ppe(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=Xy,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Ge(t,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(fo(e)){if(on(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(fo(e))this.tokensMap=kr(e,function(o,a){return o[a.name]=a,o},{});else if(Ge(e,"modes")&&Is(ki(Qr(e.modes)),oge)){var r=ki(Qr(e.modes)),i=PO(r);this.tokensMap=kr(i,function(o,a){return o[a.name]=a,o},{})}else if(LO(e))this.tokensMap=ap(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=Qh;var s=Is(Qr(e),function(o){return on(o.categoryMatches)});this.tokenMatcher=s?Xy:CS,hp(Qr(this.tokensMap))},n.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var i=Ge(r,"resyncEnabled")?r.resyncEnabled:rC.resyncEnabled,s=Ge(r,"recoveryValueFunc")?r.recoveryValueFunc:rC.recoveryValueFunc,o=this.ruleShortNameIdx<<Ege+Nu;this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=e,this.fullRuleNameToShort[e]=o;function a(h){try{if(this.outputCst===!0){t.apply(this,h);var c=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(c),c}else return t.apply(this,h)}catch(d){return this.invokeRuleCatch(d,i,s)}finally{this.ruleFinallyStateUpdate()}}var l;l=function(h,c){return h===void 0&&(h=0),this.ruleInvocationStateUpdate(o,e,h),a.call(this,c)};var u="ruleName";return l[u]=e,l.originalGrammarAction=t,l},n.prototype.invokeRuleCatch=function(e,t,r){var i=this.RULE_STACK.length===1,s=t&&!this.isBackTracking()&&this.recoveryEnabled;if(Jy(e)){var o=e;if(s){var a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))if(o.resyncedTokens=this.reSyncTo(a),this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return r();else{if(this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,o.partialCstResult=l}throw o}}else{if(i)return this.moveToTerminatedState(),r();throw o}}else throw e},n.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Zy,t),i=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Zy,t);return this.optionInternalLogic(e,t,r)},n.prototype.optionInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(e.DEF!==void 0){if(o=e.DEF,a=e.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=e;if(s.call(this)===!0)return o.call(this)},n.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Ym,e),i=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Ym,e);this.atLeastOneInternalLogic(e,t,r)},n.prototype.atLeastOneInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=t;if(s.call(this)===!0)for(var u=this.doSingleRepetition(o);s.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);else throw this.raiseEarlyExitException(e,hn.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],s,Ym,e,xge)},n.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(vd,e),i=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(vd,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},n.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var i=this,s=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(r);if(a.call(this)===!0){s.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,s,TF],l,vd,e,TF)}else throw this.raiseEarlyExitException(e,hn.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)},n.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(zm,e),i=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(zm,e);return this.manyInternalLogic(e,t,r)},n.prototype.manyInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=t;for(var u=!0;s.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],s,zm,e,_ge,u)},n.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Km,e),i=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Km,e);this.manySepFirstInternalLogic(e,t,r)},n.prototype.manySepFirstInternalLogic=function(e,t,r){var i=this,s=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(r);if(a.call(this)===!0){s.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,s,bF],l,Km,e,bF)}},n.prototype.repetitionSepSecondInternal=function(e,t,r,i,s){for(;r();)this.CONSUME(t),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,i,s],r,vd,e,s)},n.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();e.call(this);var r=this.getLexerPosition();return r>t},n.prototype.orInternalNoCst=function(e,t){var r=fo(e)?e:e.DEF,i=this.getKeyForAutomaticLookahead(_d,t),s=this.getLaFuncFromCache(i),o=s.call(this,r);if(o!==void 0){var a=r[o];return a.ALT.call(this)}this.raiseNoAltException(t,e.ERR_MSG)},n.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(_d,t),i=this.nestedRuleBeforeClause(e,r);try{var s=fo(e)?e:e.DEF,o=this.getLaFuncFromCache(r),a=o.call(this,s);if(a!==void 0){var l=s[a],u=this.nestedAltBeforeClause(l,t,_d,a);try{return l.ALT.call(this)}finally{u!==void 0&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new AG(t,e))}},n.prototype.subruleInternal=function(e,t,r){var i;try{var s=r!==void 0?r.ARGS:void 0;return i=e.call(this,t,s),this.cstPostNonTerminal(i,r!==void 0&&r.LABEL!==void 0?r.LABEL:e.ruleName),i}catch(o){this.subruleInternalError(o,r,e.ruleName)}},n.prototype.subruleInternalError=function(e,t,r){throw Jy(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,t!==void 0&&t.LABEL!==void 0?t.LABEL:r),delete e.partialCstResult),e},n.prototype.consumeInternal=function(e,t,r){var i;try{var s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):this.consumeInternalError(e,s,r)}catch(o){i=this.consumeInternalRecovery(e,t,o)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:e.name,i),i},n.prototype.consumeInternalError=function(e,t,r){var i,s=this.LA(0);throw r!==void 0&&r.ERR_MSG?i=r.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new GO(i,t,s))},n.prototype.consumeInternalRecovery=function(e,t,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){var i=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===IG?r:s}}else throw r},n.prototype.saveRecogState=function(){var e=this.errors,t=Vi(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},n.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},n.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},n.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},n.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},n.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},n.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),Qh)},n.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},n})(),Mpe=(function(){function n(){}return n.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=vS(e.errorMessageProvider,Li.errorMessageProvider)},n.prototype.SAVE_ERROR=function(e){if(Jy(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Vi(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(n.prototype,"errors",{get:function(){return Vi(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),n.prototype.raiseEarlyExitException=function(e,t,r){for(var i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],o=UO(e,s,t,this.maxLookahead),a=o[0],l=[],u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));var h=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:l,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new NG(h,this.LA(1),this.LA(0)))},n.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=VO(e,i,this.maxLookahead),o=[],a=1;a<=this.maxLookahead;a++)o.push(this.LA(a));var l=this.LA(0),u=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:o,previous:l,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new TG(u,this.LA(1),l))},n})(),Ope=(function(){function n(){}return n.prototype.initContentAssist=function(){},n.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if(xs(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return cG([r],t,this.tokenMatcher,this.maxLookahead)},n.prototype.getNextPossibleTokenTypes=function(e){var t=_s(e.ruleStack),r=this.getGAstProductions(),i=r[t],s=new Oge(i,e).startWalking();return s},n})(),bS={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(bS);var IF=!0,MF=Math.pow(2,Nu)-1,_G=At({name:"RECORDING_PHASE_TOKEN",pattern:Fi.NA});hp([_G]);var xG=FO(_G,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(xG);var _pe={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},xpe=(function(){function n(){}return n.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},n.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var t=function(i){var s=i>0?i:"";e["CONSUME"+s]=function(o,a){return this.consumeInternalRecord(o,i,a)},e["SUBRULE"+s]=function(o,a){return this.subruleInternalRecord(o,i,a)},e["OPTION"+s]=function(o){return this.optionInternalRecord(o,i)},e["OR"+s]=function(o){return this.orInternalRecord(o,i)},e["MANY"+s]=function(o){this.manyInternalRecord(i,o)},e["MANY_SEP"+s]=function(o){this.manySepFirstInternalRecord(i,o)},e["AT_LEAST_ONE"+s]=function(o){this.atLeastOneInternalRecord(i,o)},e["AT_LEAST_ONE_SEP"+s]=function(o){this.atLeastOneSepFirstInternalRecord(i,o)}},r=0;r<10;r++)t(r);e.consume=function(i,s,o){return this.consumeInternalRecord(s,i,o)},e.subrule=function(i,s,o){return this.subruleInternalRecord(s,i,o)},e.option=function(i,s){return this.optionInternalRecord(s,i)},e.or=function(i,s){return this.orInternalRecord(s,i)},e.many=function(i,s){this.manyInternalRecord(i,s)},e.atLeastOne=function(i,s){this.atLeastOneInternalRecord(i,s)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},n.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var t=0;t<10;t++){var r=t>0?t:"";delete e["CONSUME"+r],delete e["SUBRULE"+r],delete e["OPTION"+r],delete e["OR"+r],delete e["MANY"+r],delete e["MANY_SEP"+r],delete e["AT_LEAST_ONE"+r],delete e["AT_LEAST_ONE_SEP"+r]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},n.prototype.ACTION_RECORD=function(e){},n.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},n.prototype.LA_RECORD=function(e){return nC},n.prototype.topLevelRuleRecord=function(e,t){try{var r=new lf({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(i){if(i.KNOWN_RECORDER_ERROR!==!0)try{i.message=i.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw i}throw i}},n.prototype.optionInternalRecord=function(e,t){return cm.call(this,Fr,e,t)},n.prototype.atLeastOneInternalRecord=function(e,t){cm.call(this,Ps,t,e)},n.prototype.atLeastOneSepFirstInternalRecord=function(e,t){cm.call(this,Ls,t,e,IF)},n.prototype.manyInternalRecord=function(e,t){cm.call(this,Qn,t,e)},n.prototype.manySepFirstInternalRecord=function(e,t){cm.call(this,rs,t,e,IF)},n.prototype.orInternalRecord=function(e,t){return Ppe.call(this,e,t)},n.prototype.subruleInternalRecord=function(e,t,r){if(tC(t),!e||Ge(e,"ruleName")===!1){var i=new Error("<SUBRULE"+OF(t)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=Ky(this.recordingProdStack),o=e.ruleName,a=new ns({idx:t,nonTerminalName:o,referencedRule:void 0});return s.definition.push(a),this.outputCst?_pe:bS},n.prototype.consumeInternalRecord=function(e,t,r){if(tC(t),!aG(e)){var i=new Error("<CONSUME"+OF(t)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=Ky(this.recordingProdStack),o=new Dn({idx:t,terminalType:e});return s.definition.push(o),xG},n})();function cm(n,e,t,r){r===void 0&&(r=!1),tC(t);var i=Ky(this.recordingProdStack),s=Au(e)?e:e.DEF,o=new n({definition:[],idx:t});return Ge(e,"NAME")&&(o.name=e.NAME),r&&(o.separator=e.SEP),Ge(e,"MAX_LOOKAHEAD")&&(o.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(o),s.call(this),i.definition.push(o),this.recordingProdStack.pop(),bS}function Ppe(n,e){var t=this;tC(e);var r=Ky(this.recordingProdStack),i=fo(n)===!1,s=i===!1?n:n.DEF,o=new is({definition:[],idx:e,ignoreAmbiguities:i&&n.IGNORE_AMBIGUITIES===!0});Ge(n,"NAME")&&(o.name=n.NAME),Ge(n,"MAX_LOOKAHEAD")&&(o.maxLookahead=n.MAX_LOOKAHEAD);var a=q$(s,function(l){return Au(l.GATE)});return o.hasPredicates=a,r.definition.push(o),je(s,function(l){var u=new Ui({definition:[]});o.definition.push(u),Ge(l,"NAME")&&(u.name=l.NAME),Ge(l,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=l.IGNORE_AMBIGUITIES:Ge(l,"GATE")&&(u.ignoreAmbiguities=!0),t.recordingProdStack.push(u),l.ALT.call(t),t.recordingProdStack.pop()}),bS}function OF(n){return n===0?"":""+n}function tC(n){if(n<0||n>MF){var e=new Error("Invalid DSL Method idx value: <"+n+`>
	`+("Idx value must be a none negative value smaller than "+(MF+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}var Lpe=(function(){function n(){}return n.prototype.initPerformanceTracer=function(e){if(Ge(e,"traceInitPerf")){var t=e.traceInitPerf,r=typeof t=="number";this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=Li.traceInitPerf;this.traceInitIndent=-1},n.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var i=Z$(t),s=i.time,o=i.value,a=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(r+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,o}else return t()},n})(),PG=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),nC=FO(Qh,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(nC);var Li=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:yG,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),rC=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),Nr;(function(n){n[n.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",n[n.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",n[n.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",n[n.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",n[n.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",n[n.LEFT_RECURSION=5]="LEFT_RECURSION",n[n.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",n[n.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",n[n.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",n[n.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",n[n.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",n[n.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",n[n.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",n[n.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",n[n.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(Nr||(Nr={}));function Dpe(n){return n===void 0&&(n=void 0),function(){return n}}var jO=(function(){function n(e,t){t===void 0&&(t=Li),this.ignoredIssues=Li.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var r=this;r.initErrorHandler(t),r.initLexerAdapter(),r.initLooksAhead(t),r.initRecognizerEngine(e,t),r.initRecoverable(t),r.initTreeBuilder(t),r.initContentAssist(),r.initGastRecorder(t),r.initPerformanceTracer(t),Ge(t,"ignoredIssues")&&t.ignoredIssues!==Li.ignoredIssues&&DO(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=Ge(t,"ignoredIssues")?t.ignoredIssues:Li.ignoredIssues,this.skipValidations=Ge(t,"skipValidations")?t.skipValidations:Li.skipValidations}return n.performSelfAnalysis=function(e){e.performSelfAnalysis()},n.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var t;e.selfAnalysisDone=!0;var r=e.className;e.TRACE_INIT("toFastProps",function(){Q$(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),je(e.definedRulesNames,function(s){var o=e[s],a=o.originalGrammarAction,l=void 0;e.TRACE_INIT(s+" Rule",function(){l=e.topLevelRuleRecord(s,a)}),e.gastProductionsCache[s]=l})}finally{e.disableRecording()}});var i=[];if(e.TRACE_INIT("Grammar Resolving",function(){i=cpe({rules:Qr(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,i)}),e.TRACE_INIT("Grammar Validations",function(){if(on(i)&&e.skipValidations===!1){var s=dpe({rules:Qr(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:Qr(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:$O,grammarName:r});e.definitionErrors.push.apply(e.definitionErrors,s)}}),on(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var s=Sge(Qr(e.gastProductionsCache));e.resyncFollows=s}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(Qr(e.gastProductionsCache))})),e.TRACE_INIT("expandAllNestedRuleNames",function(){var s=Ige(Qr(e.gastProductionsCache),e.fullRuleNameToShort);e.allRuleNames=s.allRuleNames}),!n.DEFER_DEFINITION_ERRORS_HANDLING&&!on(e.definitionErrors))throw t=Ne(e.definitionErrors,function(s){return s.message}),new Error(`Parser Definition Errors detected:
 `+t.join(`
-------------------------------
`))})},n.DEFER_DEFINITION_ERRORS_HANDLING=!1,n})();Sme(jO,[fpe,gpe,Tpe,Ape,Ipe,Npe,Mpe,Ope,xpe,Lpe]);(function(n){PG(e,n);function e(t,r){r===void 0&&(r=Li);var i=this,s=ap(r);return s.outputCst=!0,i=n.call(this,t,s)||this,i}return e})(jO);var Hpe=(function(n){PG(e,n);function e(t,r){r===void 0&&(r=Li);var i=this,s=ap(r);return s.outputCst=!1,i=n.call(this,t,s)||this,i}return e})(jO);const _F=(n,e)=>({type:n,message:e});var Un;(function(n){n.LexingError="LexingError",n.ParserError="ParsingError",n.StaticOffsetError="StaticOffsetError",n.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",n.RangeOffsetNotAllowed="RangeOffsetNotAllowed",n.InvalidRangeSize="InvalidRangeSize"})(Un||(Un={}));var M;(function(n){n.EMPTY="EMPTY",n.NUMBER="NUMBER",n.STRING="STRING",n.MINUS_UNARY_OP="MINUS_UNARY_OP",n.PLUS_UNARY_OP="PLUS_UNARY_OP",n.PERCENT_OP="PERCENT_OP",n.CONCATENATE_OP="CONCATENATE_OP",n.EQUALS_OP="EQUALS_OP",n.NOT_EQUAL_OP="NOT_EQUAL_OP",n.GREATER_THAN_OP="GREATER_THAN_OP",n.LESS_THAN_OP="LESS_THAN_OP",n.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",n.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",n.PLUS_OP="PLUS_OP",n.MINUS_OP="MINUS_OP",n.TIMES_OP="TIMES_OP",n.DIV_OP="DIV_OP",n.POWER_OP="POWER_OP",n.FUNCTION_CALL="FUNCTION_CALL",n.NAMED_EXPRESSION="NAMED_EXPRESSION",n.PARENTHESIS="PARENTHESES",n.CELL_REFERENCE="CELL_REFERENCE",n.CELL_RANGE="CELL_RANGE",n.COLUMN_RANGE="COLUMN_RANGE",n.ROW_RANGE="ROW_RANGE",n.ERROR="ERROR",n.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",n.ARRAY="ARRAY"})(M||(M={}));var As;(function(n){n[n.RELATIVE=0]="RELATIVE",n[n.START_ABSOLUTE=1]="START_ABSOLUTE",n[n.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(As||(As={}));const Fpe=n=>({type:M.EMPTY,leadingWhitespace:n?.image}),kpe=(n,e)=>({type:M.NUMBER,value:n,leadingWhitespace:e?.image}),Vpe=n=>{var e;return{type:M.STRING,value:n.image.slice(1,-1),leadingWhitespace:(e=n.leadingWhitespace)===null||e===void 0?void 0:e.image}},xF=(n,e)=>({type:M.CELL_REFERENCE,reference:n,leadingWhitespace:e?.image}),PF=(n,e,t,r)=>(zO(n,e,t),{type:M.CELL_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r}),Upe=(n,e,t,r)=>(zO(n,e,t),{type:M.COLUMN_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r?.image}),Bpe=(n,e,t,r)=>(zO(n,e,t),{type:M.ROW_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r?.image}),Wpe=(n,e,t)=>({type:M.CONCATENATE_OP,left:n,right:e,leadingWhitespace:t?.image}),$pe=(n,e,t)=>({type:M.EQUALS_OP,left:n,right:e,leadingWhitespace:t?.image}),Gpe=(n,e,t)=>({type:M.NOT_EQUAL_OP,left:n,right:e,leadingWhitespace:t?.image}),jpe=(n,e,t)=>({type:M.GREATER_THAN_OP,left:n,right:e,leadingWhitespace:t?.image}),zpe=(n,e,t)=>({type:M.LESS_THAN_OP,left:n,right:e,leadingWhitespace:t?.image}),Ype=(n,e,t)=>({type:M.GREATER_THAN_OR_EQUAL_OP,left:n,right:e,leadingWhitespace:t?.image}),Kpe=(n,e,t)=>({type:M.LESS_THAN_OR_EQUAL_OP,left:n,right:e,leadingWhitespace:t?.image}),qpe=(n,e,t)=>({type:M.PLUS_OP,left:n,right:e,leadingWhitespace:t?.image}),Xpe=(n,e,t)=>({type:M.MINUS_OP,left:n,right:e,leadingWhitespace:t?.image}),Qpe=(n,e,t)=>({type:M.TIMES_OP,left:n,right:e,leadingWhitespace:t?.image}),Zpe=(n,e,t)=>({type:M.DIV_OP,left:n,right:e,leadingWhitespace:t?.image}),Jpe=(n,e,t)=>({type:M.POWER_OP,left:n,right:e,leadingWhitespace:t?.image}),ewe=(n,e)=>({type:M.MINUS_UNARY_OP,value:n,leadingWhitespace:e?.image}),twe=(n,e)=>({type:M.PLUS_UNARY_OP,value:n,leadingWhitespace:e?.image}),nwe=(n,e)=>({type:M.PERCENT_OP,value:n,leadingWhitespace:e?.image}),rwe=(n,e,t,r,i)=>({type:M.FUNCTION_CALL,procedureName:n,args:e,leadingWhitespace:t?.image,internalWhitespace:r?.image,hyperlink:i}),LF=(n,e,t)=>({type:M.ARRAY,args:n,leadingWhitespace:e?.image,internalWhitespace:t?.image}),iwe=(n,e)=>({type:M.NAMED_EXPRESSION,expressionName:n,leadingWhitespace:e?.image}),swe=(n,e,t)=>({type:M.PARENTHESIS,expression:n,leadingWhitespace:e?.image,internalWhitespace:t?.image}),ra=(n,e)=>({type:M.ERROR,error:n,leadingWhitespace:e?.image}),qc=(n,e,t)=>({type:M.ERROR_WITH_RAW_INPUT,error:e,rawInput:n,leadingWhitespace:t?.image}),HN=()=>({type:M.ERROR,error:E.parsingError()});function zO(n,e,t){if(n.sheet!==void 0&&e.sheet===void 0||n.sheet===void 0&&e.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(n.sheet===void 0&&t!==As.RELATIVE||n.sheet!==void 0&&t===As.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function It(n,e){return(e??"")+n}const LG={[M.PLUS_OP]:"+",[M.MINUS_OP]:"-",[M.TIMES_OP]:"*",[M.DIV_OP]:"/",[M.CONCATENATE_OP]:"&",[M.POWER_OP]:"^",[M.EQUALS_OP]:"=",[M.NOT_EQUAL_OP]:"<>",[M.GREATER_THAN_OP]:">",[M.GREATER_THAN_OR_EQUAL_OP]:">=",[M.LESS_THAN_OP]:"<",[M.LESS_THAN_OR_EQUAL_OP]:"<="};const owe=(n,e,t,r)=>({ast:n,relativeDependencies:e,hasVolatileFunction:t,hasStructuralChangeFunction:r});class awe{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const r=AS(t,this.functionRegistry),i=owe(t,r,Yl(t,this.functionRegistry.isFunctionVolatile),Yl(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,i),i}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const r=this.cache.get(e);return r!==void 0?r.ast:(this.set(e,t),t)}}const Yl=(n,e)=>{switch(n.type){case M.EMPTY:case M.NUMBER:case M.STRING:case M.ERROR:case M.ERROR_WITH_RAW_INPUT:case M.CELL_REFERENCE:case M.CELL_RANGE:case M.COLUMN_RANGE:case M.ROW_RANGE:case M.NAMED_EXPRESSION:return!1;case M.PERCENT_OP:case M.PLUS_UNARY_OP:case M.MINUS_UNARY_OP:return Yl(n.value,e);case M.CONCATENATE_OP:case M.EQUALS_OP:case M.NOT_EQUAL_OP:case M.LESS_THAN_OP:case M.GREATER_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.PLUS_OP:case M.TIMES_OP:case M.DIV_OP:case M.POWER_OP:return Yl(n.left,e)||Yl(n.right,e);case M.PARENTHESIS:return Yl(n.expression,e);case M.FUNCTION_CALL:return e(n.procedureName)?!0:n.args.some(t=>Yl(t,e));case M.ARRAY:return n.args.some(t=>t.some(r=>Yl(r,e)))}};class _{}_.DistinctSigns="Distinct signs.";_.WrongArgNumber="Wrong number of arguments.";_.EmptyArg="Empty function argument.";_.EmptyArray="Empty array not allowed.";_.ArrayDimensions="Array dimensions are not compatible.";_.NoSpaceForArrayResult="No space for array result.";_.ValueSmall="Value too small.";_.ValueLarge="Value too large.";_.BadCriterion="Incorrect criterion.";_.RangeManySheets="Range spans more than one sheet.";_.CellRangeExpected="Cell range expected.";_.WrongDimension="Wrong range dimension.";_.ScalarExpected="Cell range not allowed.";_.NumberCoercion="Value cannot be coerced to number.";_.NumberExpected="Number argument expected.";_.IntegerExpected="Value needs to be an integer.";_.BadMode="Mode not recognized.";_.DateBounds="Date outside of bounds.";_.OutOfSheet="Resulting reference is out of the sheet.";_.WrongType="Wrong type of argument.";_.NaN="NaN or infinite value encountered.";_.EqualLength="Ranges need to be of equal length.";_.Negative="Value cannot be negative.";_.NotBinary="String does not represent a binary number.";_.NotOctal="String does not represent an octal number.";_.NotHex="String does not represent a hexadecimal number.";_.EndStartPeriod="End period needs to be at least start period.";_.CellRefExpected="Cell reference expected.";_.EmptyRange="Empty range not allowed.";_.BadRef="Address is not correct.";_.NumberRange="Number-only range expected.";_.ValueNotFound="Value not found.";_.ValueBaseLarge="Value in base too large.";_.ValueBaseSmall="Value in base too small.";_.ValueBaseLong="Value in base too long.";_.NegativeLength="Length cannot be negative.";_.PatternNotFound="Pattern not found.";_.OneValue="Needs at least one value.";_.TwoValues="Range needs to contain at least two elements.";_.ThreeValues="Range needs to contain at least three elements.";_.IndexBounds="Index out of bounds.";_.IndexLarge="Index too large.";_.Formula="Expected formula.";_.NegativeCount="Count cannot be negative.";_.ParseError="Parsing error.";_.SheetRef="Sheet does not exist.";_.PeriodLong="Period number cannot exceed life length.";_.InvalidDate="Invalid date.";_.BitshiftLong="Result of bitshift is too long.";_.EmptyString="Empty-string argument not allowed.";_.LengthBounds="Length out of bounds.";_.NegativeTime="Time cannot be negative.";_.NoDefault="No default option.";_.NoConditionMet="None of the conditions were met.";_.Selector="Selector cannot exceed the number of arguments.";_.StartEndDate="Start date needs to be earlier than end date.";_.IncorrectDateTime="String does not represent correct DateTime.";_.CharacterCodeBounds="Character code out of bounds.";_.NonZero="Argument cannot be 0.";_.LessThanOne="Argument cannot be less than 1.";_.WeekendString="Incorrect weekend bitmask string.";_.InvalidRoman="Invalid roman numeral.";_.WrongOrder="Wrong order of values.";_.ComplexNumberExpected="Complex number expected.";_.ShouldBeIorJ="Should be 'i' or 'j'.";_.SizeMismatch="Array dimensions mismatched.";_.FunctionName=n=>`Function name ${n} not recognized.`;_.NamedExpressionName=n=>`Named expression ${n} not recognized.`;_.LicenseKey=n=>`License key is ${n}.`;class lwe{constructor(){this.POSSIBLE_START_CHARACTERS=[...j$,...hme,di,"'","_"],this.cellReferenceRegexp=new RegExp(ume,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const r=this.cellReferenceRegexp.exec(e+"@");return r==null||r[1]==null?null:(r[0]=r[1],r)}}class uwe{constructor(){this.POSSIBLE_START_CHARACTERS=[...j$,"_"],this.namedExpressionRegexp=new RegExp(G$,"y"),this.r1c1CellRefRegexp=new RegExp(`^${$$}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const r=this.namedExpressionRegexp.exec(e);return r==null||r[0]==null||this.r1c1CellRefRegexp.test(r[0])?null:r}}const bg=At({name:"AdditionOp",pattern:Fi.NA}),FN=At({name:"PlusOp",pattern:/\+/,categories:bg}),kN=At({name:"MinusOp",pattern:/-/,categories:bg}),TS=At({name:"MultiplicationOp",pattern:Fi.NA}),DG=At({name:"TimesOp",pattern:/\*/,categories:TS}),HG=At({name:"DivOp",pattern:/\//,categories:TS}),VN=At({name:"PowerOp",pattern:/\^/}),FG=At({name:"PercentOp",pattern:/%/}),Iu=At({name:"BooleanOp",pattern:Fi.NA}),UN=At({name:"EqualsOp",pattern:/=/,categories:Iu}),kG=At({name:"NotEqualOp",pattern:/<>/,categories:Iu}),VG=At({name:"GreaterThanOp",pattern:/>/,categories:Iu}),UG=At({name:"LessThanOp",pattern:/</,categories:Iu}),BG=At({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:Iu}),WG=At({name:"LessThanOrEqualOp",pattern:/<=/,categories:Iu}),$G=At({name:"ConcatenateOp",pattern:/&/}),BN=At({name:"LParen",pattern:/\(/}),kv=At({name:"RParen",pattern:/\)/}),GG=At({name:"ArrayLParen",pattern:/{/}),jG=At({name:"ArrayRParen",pattern:/}/}),zG=At({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),YG=At({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),Tg=At({name:"RangeSeparator",pattern:new RegExp(op)}),YO=At({name:"ColumnRange",pattern:new RegExp(`${tF}${op}${tF}`)}),KO=At({name:"RowRange",pattern:new RegExp(`${nF}${op}${nF}`)}),qO=At({name:"ProcedureName",pattern:new RegExp(`([${mS}][${_O}]*)\\(`)}),mA=new lwe,uu=At({name:"CellReference",pattern:mA.match.bind(mA),start_chars_hint:mA.POSSIBLE_START_CHARACTERS,line_breaks:!1}),gA=new uwe,KG=At({name:"NamedExpression",pattern:gA.match.bind(gA),start_chars_hint:gA.POSSIBLE_START_CHARACTERS,line_breaks:!1}),XO=n=>{const e=n.translationPackage.getFunctionTranslation("OFFSET"),t=n.errorMapping,r=n.translationPackage.buildFunctionMapping(),i=new RegExp(n.ignoreWhiteSpace==="standard"?ame:ome),s=At({name:"WhiteSpace",pattern:i}),o=At({name:"ArrayRowSep",pattern:n.arrayRowSeparator}),a=At({name:"ArrayColSep",pattern:n.arrayColumnSeparator}),l=At({name:"NumberLiteral",pattern:new RegExp(`(([${n.decimalSeparator}]\\d+)|(\\d+([${n.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),u=At({name:"OffsetProcedureName",pattern:new RegExp(e,"i")});let h,c;n.functionArgSeparator===n.arrayColumnSeparator?(h=a,c=[]):n.functionArgSeparator===n.arrayRowSeparator?(h=o,c=[]):(h=At({name:"ArgSeparator",pattern:n.functionArgSeparator}),c=[h]);const d=[s,FN,kN,DG,HG,VN,UN,kG,FG,BG,WG,VG,UG,BN,kv,GG,jG,u,qO,Tg,...c,YO,KO,l,zG,YG,$G,Iu,bg,TS,uu,KG,o,a];return{ArgSeparator:h,NumberLiteral:l,OffsetProcedureName:u,ArrayRowSeparator:o,ArrayColSeparator:a,WhiteSpace:s,allTokens:d,errorMapping:t,functionMapping:r,decimalSeparator:n.decimalSeparator,maxColumns:n.maxColumns,maxRows:n.maxRows}};class yd extends Hpe{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:Dpe(Fpe())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var r;const i=this.CONSUME(qO),s=i.image.toUpperCase().slice(0,-1),o=(r=this.lexerConfig.functionMapping[s])!==null&&r!==void 0?r:s,a=[];let l=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var h;const c=this.CONSUME(this.lexerConfig.ArgSeparator);l.type===M.EMPTY&&(l.leadingWhitespace=(h=c.leadingWhitespace)===null||h===void 0?void 0:h.image),a.push(l),l=this.SUBRULE2(this.booleanExpressionOrEmpty)}),a.push(l),a.length===1&&a[0].type===M.EMPTY&&(a.length=0);const u=this.CONSUME(kv);return rwe(o,a,i.leadingWhitespace,u.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const r=this.CONSUME(KG);return iwe(r.image,r.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const r=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(BN),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{r.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(kv),this.handleOffsetHeuristic(r)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const r=this.CONSUME(YO),[i,s]=r.image.split(":"),o=this.ACTION(()=>jy(this.sheetMapping,i,this.formulaAddress)),a=this.ACTION(()=>jy(this.sheetMapping,s,this.formulaAddress));if(o===void 0||a===void 0)return ra(new E(N.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return qc(r.image,new E(N.NAME),r.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Un.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:h}=yd.fixSheetIdsForRangeEnds(o,a);return Upe(l,u,h,r.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const r=this.CONSUME(KO),[i,s]=r.image.split(":"),o=this.ACTION(()=>zy(this.sheetMapping,i,this.formulaAddress)),a=this.ACTION(()=>zy(this.sheetMapping,s,this.formulaAddress));if(o===void 0||a===void 0)return ra(new E(N.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return qc(r.image,new E(N.NAME),r.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Un.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:h}=yd.fixSheetIdsForRangeEnds(o,a);return Bpe(l,u,h,r.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const r=this.CONSUME(uu),i=this.ACTION(()=>od(this.sheetMapping,r.image,this.formulaAddress));return i===void 0?qc(r.image,new E(N.REF),r.leadingWhitespace):i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?qc(r.image,new E(N.NAME),r.leadingWhitespace):xF(i,r.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",r=>{var i;const s=this.CONSUME(uu),o=this.ACTION(()=>od(this.sheetMapping,r.image,this.formulaAddress)),a=this.ACTION(()=>od(this.sheetMapping,s.image,this.formulaAddress));return o===void 0||a===void 0?this.ACTION(()=>qc(`${r.image}:${s.image}`,new E(N.REF),r.leadingWhitespace)):o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>qc(`${r.image}:${s.image}`,new E(N.NAME),r.leadingWhitespace)):this.buildCellRange(o,a,(i=r.leadingWhitespace)===null||i===void 0?void 0:i.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",r=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[r]})},{ALT:()=>{var i;const s=this.SUBRULE(this.offsetProcedureExpression),o=this.ACTION(()=>od(this.sheetMapping,r.image,this.formulaAddress));return o===void 0?ra(new E(N.REF)):s.type===M.CELL_REFERENCE?this.buildCellRange(o,s.reference,(i=r.leadingWhitespace)===null||i===void 0?void 0:i.image):this.parsingError(Un.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const r=this.CONSUME(uu);return this.CONSUME2(Tg),this.SUBRULE(this.endOfRangeExpression,{ARGS:[r]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",r=>{const i=this.CONSUME(uu),s=this.ACTION(()=>od(this.sheetMapping,i.image,this.formulaAddress));return s===void 0?this.ACTION(()=>ra(new E(N.REF))):this.buildCellRange(r.reference,s,r.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",r=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[r]})},{ALT:()=>{const i=this.SUBRULE(this.offsetProcedureExpression);return i.type===M.CELL_REFERENCE?this.buildCellRange(r.reference,i.reference,r.leadingWhitespace):this.parsingError(Un.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const r=this.SUBRULE(this.offsetProcedureExpression);let i;return this.OPTION(()=>{this.CONSUME(Tg),r.type===M.CELL_RANGE?i=this.parsingError(Un.RangeOffsetNotAllowed,"Range offset not allowed here"):i=this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[r]})}),i!==void 0?i:r}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const r=[[]];return r[r.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),r[r.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),r.push([]),r[r.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),LF(r)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const r=this.CONSUME(BN),i=this.SUBRULE(this.booleanExpression),s=this.CONSUME(kv);return swe(i,r.leadingWhitespace,s.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const r=this.CONSUME(GG),i=this.SUBRULE(this.insideArrayExpression),s=this.CONSUME(jG);return LF(i.args,r.leadingWhitespace,s.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=r=>{const i=r.replace(this.lexerConfig.decimalSeparator,".");return Number(i)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var r;return this.OR((r=this.atomicExpCache)!==null&&r!==void 0?r:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const i=this.CONSUME(this.lexerConfig.NumberLiteral);return kpe(this.numericStringToNumber(i.image),i.leadingWhitespace)}},{ALT:()=>{const i=this.CONSUME(zG);return Vpe(i)}},{ALT:()=>{const i=this.CONSUME(YG),s=i.image.toUpperCase(),o=this.lexerConfig.errorMapping[s];return o?ra(new E(o),i.leadingWhitespace):this.parsingError(Un.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const r=this.SUBRULE(this.positiveAtomicExpression),i=this.OPTION(()=>this.CONSUME(FG));return i?nwe(r,i.leadingWhitespace):r}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const r=this.CONSUME(bg),i=this.SUBRULE(this.atomicExpression);return Jt(r,FN)?twe(i,r.leadingWhitespace):Jt(r,kN)?ewe(i,r.leadingWhitespace):(this.customParsingError=_F(Un.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let r=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const i=this.CONSUME(VN),s=this.SUBRULE2(this.atomicExpression);Jt(i,VN)?r=Jpe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let r=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const i=this.CONSUME(TS),s=this.SUBRULE2(this.powerExpression);Jt(i,DG)?r=Qpe(r,s,i.leadingWhitespace):Jt(i,HG)?r=Zpe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.additionExpression=this.RULE("additionExpression",()=>{let r=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const i=this.CONSUME(bg),s=this.SUBRULE2(this.multiplicationExpression);Jt(i,FN)?r=qpe(r,s,i.leadingWhitespace):Jt(i,kN)?r=Xpe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let r=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const i=this.CONSUME($G),s=this.SUBRULE2(this.additionExpression);r=Wpe(r,s,i.leadingWhitespace)}),r}),this.booleanExpression=this.RULE("booleanExpression",()=>{let r=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const i=this.CONSUME(Iu),s=this.SUBRULE2(this.concatenateExpression);Jt(i,UN)?r=$pe(r,s,i.leadingWhitespace):Jt(i,kG)?r=Gpe(r,s,i.leadingWhitespace):Jt(i,VG)?r=jpe(r,s,i.leadingWhitespace):Jt(i,UG)?r=zpe(r,s,i.leadingWhitespace):Jt(i,BG)?r=Ype(r,s,i.leadingWhitespace):Jt(i,WG)?r=Kpe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.formula=this.RULE("formula",()=>(this.CONSUME(UN),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=Ce(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let r=this.formulaWithContext(t),i=[];return this.customParsingError&&i.push(this.customParsingError),i=i.concat(this.errors.map(s=>({type:Un.ParserError,message:s.message}))),i.length>0&&(r=HN()),{ast:r,errors:i}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,r){if(e.sheet===void 0&&t.sheet!==void 0)return this.parsingError(Un.ParserError,"Malformed range expression");const{firstEnd:i,secondEnd:s,sheetRefType:o}=yd.fixSheetIdsForRangeEnds(e,t);return PF(i,s,o,r)}static fixSheetIdsForRangeEnds(e,t){const r=yd.rangeSheetReferenceType(e.sheet,t.sheet),i=e.sheet!==void 0&&t.sheet===void 0?t.withSheet(e.sheet):t;return{firstEnd:e,secondEnd:i,sheetRefType:r}}handleOffsetHeuristic(e){const t=e[0];if(t.type!==M.CELL_REFERENCE)return this.parsingError(Un.StaticOffsetError,"First argument to OFFSET is not a reference");const r=e[1];let i;if(r.type===M.NUMBER&&Number.isInteger(r.value))i=r.value;else if(r.type===M.PLUS_UNARY_OP&&r.value.type===M.NUMBER&&Number.isInteger(r.value.value))i=r.value.value;else if(r.type===M.MINUS_UNARY_OP&&r.value.type===M.NUMBER&&Number.isInteger(r.value.value))i=-r.value.value;else return this.parsingError(Un.StaticOffsetError,"Second argument to OFFSET is not a static number");const s=e[2];let o;if(s.type===M.NUMBER&&Number.isInteger(s.value))o=s.value;else if(s.type===M.PLUS_UNARY_OP&&s.value.type===M.NUMBER&&Number.isInteger(s.value.value))o=s.value.value;else if(s.type===M.MINUS_UNARY_OP&&s.value.type===M.NUMBER&&Number.isInteger(s.value.value))o=-s.value.value;else return this.parsingError(Un.StaticOffsetError,"Third argument to OFFSET is not a static number");const a=e[3];let l;if(a===void 0)l=1;else if(a.type===M.NUMBER){if(l=a.value,l<1)return this.parsingError(Un.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(l))return this.parsingError(Un.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(Un.StaticOffsetError,"Fourth argument to OFFSET is not a static number");const u=e[4];let h;if(u===void 0)h=1;else if(u.type===M.NUMBER){if(h=u.value,h<1)return this.parsingError(Un.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(h))return this.parsingError(Un.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(Un.StaticOffsetError,"Fifth argument to OFFSET is not a static number");const c=new sn(t.reference.col+o,t.reference.row+i,t.reference.type);let d=c.col,f=c.row;if((t.reference.type===jt.CELL_REFERENCE_RELATIVE||t.reference.type===jt.CELL_REFERENCE_ABSOLUTE_COL)&&(f=f+this.formulaAddress.row),(t.reference.type===jt.CELL_REFERENCE_RELATIVE||t.reference.type===jt.CELL_REFERENCE_ABSOLUTE_ROW)&&(d=d+this.formulaAddress.col),d<0||f<0)return ra(new E(N.REF,_.OutOfSheet));if(h===1&&l===1)return xF(c);{const m=new sn(c.col+h-1,c.row+l-1,c.type);return PF(c,m,As.RELATIVE)}}parsingError(e,t){return this.customParsingError=_F(e,t),HN()}static rangeSheetReferenceType(e,t){return e===void 0?As.RELATIVE:t===void 0?As.START_ABSOLUTE:As.BOTH_ABSOLUTE}}class iC{constructor(e){this.lexerConfig=e,this.lexer=new Fi(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let r=t.tokens;return r=this.trimTrailingWhitespaces(r),r=this.skipWhitespacesInsideRanges(r),r=this.skipWhitespacesBeforeArgSeparators(r),t.tokens=r,t}skipWhitespacesInsideRanges(e){return iC.filterTokensByNeighbors(e,(t,r,i)=>(Jt(t,uu)||Jt(t,Tg))&&Jt(r,this.lexerConfig.WhiteSpace)&&(Jt(i,uu)||Jt(i,Tg)))}skipWhitespacesBeforeArgSeparators(e){return iC.filterTokensByNeighbors(e,(t,r,i)=>!Jt(t,this.lexerConfig.ArgSeparator)&&Jt(r,this.lexerConfig.WhiteSpace)&&Jt(i,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let r=0;const i=[e[r++]];for(;r<e.length-1;)t(e[r-1],e[r],e[r+1])||i.push(e[r]),++r;return i.push(e[r]),i}trimTrailingWhitespaces(e){return e.length>0&&Jt(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}class qG{constructor(e,t,r,i){this.config=e,this.lexerConfig=t,this.sheetMappingFn=r,this.namedExpressions=i}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var r,i;switch(e.type){case M.EMPTY:return It("",e.leadingWhitespace);case M.NUMBER:return It(XG(e.value,this.config.decimalSeparator),e.leadingWhitespace);case M.STRING:return It('"'+e.value+'"',e.leadingWhitespace);case M.FUNCTION_CALL:{const s=e.args.map(l=>l!==void 0?this.unparseAst(l,t):"").join(this.config.functionArgSeparator),a=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+s+It(")",e.internalWhitespace);return It(a,e.leadingWhitespace)}case M.NAMED_EXPRESSION:{const s=(r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))===null||r===void 0?void 0:r.displayName;return It(s||e.expressionName,e.leadingWhitespace)}case M.CELL_REFERENCE:{let s;return e.reference.sheet!==void 0?s=this.unparseSheetName(e.reference.sheet)+"!":s="",s+=(i=e.reference.unparse(t))!==null&&i!==void 0?i:this.config.translationPackage.getErrorTranslation(N.REF),It(s,e.leadingWhitespace)}case M.COLUMN_RANGE:case M.ROW_RANGE:case M.CELL_RANGE:return It(this.formatRange(e,t),e.leadingWhitespace);case M.PLUS_UNARY_OP:{const s=this.unparseAst(e.value,t);return It("+",e.leadingWhitespace)+s}case M.MINUS_UNARY_OP:{const s=this.unparseAst(e.value,t);return It("-",e.leadingWhitespace)+s}case M.PERCENT_OP:return this.unparseAst(e.value,t)+It("%",e.leadingWhitespace);case M.ERROR:{const s=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:N.ERROR);return It(s,e.leadingWhitespace)}case M.ERROR_WITH_RAW_INPUT:return It(e.rawInput,e.leadingWhitespace);case M.PARENTHESIS:{const o="("+this.unparseAst(e.expression,t)+It(")",e.internalWhitespace);return It(o,e.leadingWhitespace)}case M.ARRAY:{const s="{"+e.args.map(o=>o.map(a=>this.unparseAst(a,t)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+It("}",e.internalWhitespace);return It(s,e.leadingWhitespace)}default:{const s=this.unparseAst(e.left,t),o=this.unparseAst(e.right,t);return s+It(LG[e.type],e.leadingWhitespace)+o}}}unparseSheetName(e){const t=Y$(e,this.sheetMappingFn);if(t===void 0)throw new On(e);return t}formatRange(e,t){let r="",i="";e.start.sheet!==void 0&&e.sheetReferenceType!==As.RELATIVE&&(r=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===As.BOTH_ABSOLUTE&&(i=this.unparseSheetName(e.end.sheet)+"!");const s=e.start.unparse(t),o=e.end.unparse(t);return s===void 0||o===void 0?this.config.translationPackage.getErrorTranslation(N.REF):`${r}${s}:${i}${o}`}}function XG(n,e){return n.toString().replace(".",e)}class Xm{constructor(e,t,r){this.config=e,this.functionRegistry=t,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=XO(e),this.lexer=new iC(this.lexerConfig),this.formulaParser=new yd(this.lexerConfig,this.sheetMapping),this.cache=new awe(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const r=this.tokenizeFormula(e);if(r.errors.length>0){const c=r.errors.map(d=>({type:Un.LexingError,message:d.message}));return{ast:HN(),errors:c,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const i=this.computeHashFromTokens(r.tokens,t);let s=this.cache.get(i);if(s!==void 0)++this.statsCacheUsed;else{const c=this.bindWhitespacesToTokens(r.tokens),d=this.formulaParser.parseFromTokens(c,t);if(d.errors.length>0)return Object.assign(Object.assign({},d),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});s=this.cache.set(i,d.ast)}const{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l}=s,u=this.convertReversedRangesToRegularRanges(o),h=AS(u,this.functionRegistry);return{ast:u,errors:[],hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:h}}convertReversedRangesToRegularRanges(e){switch(e.type){case M.EMPTY:case M.NUMBER:case M.STRING:case M.ERROR:case M.ERROR_WITH_RAW_INPUT:case M.CELL_REFERENCE:case M.NAMED_EXPRESSION:return e;case M.CELL_RANGE:{const{start:t,end:r}=e,i=this.orderCellRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case M.COLUMN_RANGE:{const{start:t,end:r}=e,i=this.orderColumnRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case M.ROW_RANGE:{const{start:t,end:r}=e,i=this.orderRowRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case M.PERCENT_OP:case M.PLUS_UNARY_OP:case M.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case M.CONCATENATE_OP:case M.EQUALS_OP:case M.NOT_EQUAL_OP:case M.LESS_THAN_OP:case M.GREATER_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.PLUS_OP:case M.TIMES_OP:case M.DIV_OP:case M.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),r=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:r})}case M.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case M.FUNCTION_CALL:{const t=e.args.map(r=>this.convertReversedRangesToRegularRanges(r));return Object.assign(Object.assign({},e),{args:t})}case M.ARRAY:{const t=e.args.map(r=>r.map(i=>this.convertReversedRangesToRegularRanges(i)));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const r=[e,t],[i,s]=r.map(h=>h.toColumnAddress()).sort(hi.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(h=>h.toRowAddress()).sort(qr.compareByAbsoluteAddress(this.formulaAddress)),[l,u]=r.map(h=>h.sheet).sort(Xm.compareSheetIds.bind(this));return{start:sn.fromColAndRow(i,o,l),end:sn.fromColAndRow(s,a,u)}}orderColumnRangeEnds(e,t){const r=[e,t],[i,s]=r.sort(hi.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(l=>l.sheet).sort(Xm.compareSheetIds.bind(this));return{start:new hi(i.type,i.col,o),end:new hi(s.type,s.col,a)}}orderRowRangeEnds(e,t){const r=[e,t],[i,s]=r.sort(qr.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(l=>l.sheet).sort(Xm.compareSheetIds.bind(this));return{start:new qr(i.type,i.row,o),end:new qr(s.type,s.row,a)}}static compareSheetIds(e,t){return e=e??1/0,t=t??1/0,e-t}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(t===void 0)throw new Error("There is no AST with such key in the cache");{const{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,relativeDependencies:o}=t;return{ast:r,errors:[],hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}}}computeHashFromTokens(e,t){var r;let i="",s=0;for(;s<e.length;){const o=e[s];if(Jt(o,uu)){const a=od(this.sheetMapping,o.image,t);a===void 0?i=i.concat(o.image):i=i.concat(a.hash(!0))}else if(Jt(o,qO)){const a=o.image.toUpperCase().slice(0,-1),l=(r=this.lexerConfig.functionMapping[a])!==null&&r!==void 0?r:a;i=i.concat(l,"(")}else if(Jt(o,YO)){const[a,l]=o.image.split(":"),u=jy(this.sheetMapping,a,t),h=jy(this.sheetMapping,l,t);u===void 0||h===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",h.hash(!0))}else if(Jt(o,KO)){const[a,l]=o.image.split(":"),u=zy(this.sheetMapping,a,t),h=zy(this.sheetMapping,l,t);u===void 0||h===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",h.hash(!0))}else i=i.concat(o.image);s++}return i}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case M.EMPTY:return e.leadingWhitespace||"";case M.NUMBER:return It(XG(e.value,this.config.decimalSeparator),e.leadingWhitespace);case M.STRING:return It('"'+e.value+'"',e.leadingWhitespace);case M.NAMED_EXPRESSION:return It(e.expressionName,e.leadingWhitespace);case M.FUNCTION_CALL:{const t=e.args.map(i=>this.computeHashOfAstNode(i)).join(this.config.functionArgSeparator),r=e.procedureName+"("+t+It(")",e.internalWhitespace);return It(r,e.leadingWhitespace)}case M.CELL_REFERENCE:return It(e.reference.hash(!0),e.leadingWhitespace);case M.COLUMN_RANGE:case M.ROW_RANGE:case M.CELL_RANGE:{const t=e.start.hash(e.sheetReferenceType!==As.RELATIVE),r=e.end.hash(e.sheetReferenceType===As.BOTH_ABSOLUTE);return It(t+":"+r,e.leadingWhitespace)}case M.MINUS_UNARY_OP:return It("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case M.PLUS_UNARY_OP:return It("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case M.PERCENT_OP:return this.computeHashOfAstNode(e.value)+It("%",e.leadingWhitespace);case M.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:N.ERROR);return It(t,e.leadingWhitespace)}case M.ERROR_WITH_RAW_INPUT:return It(e.rawInput,e.leadingWhitespace);case M.ARRAY:{const t=e.args.map(r=>r.map(i=>this.computeHashOfAstNode(i)).join(",")).join(";");return It("{"+t+It("}",e.internalWhitespace),e.leadingWhitespace)}case M.PARENTHESIS:{const r="("+this.computeHashOfAstNode(e.expression)+It(")",e.internalWhitespace);return It(r,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+It(LG[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],r=e[0];Jt(r,this.lexerConfig.WhiteSpace)||t.push(r);for(let i=1;i<e.length;++i){const s=e[i];if(Jt(s,this.lexerConfig.WhiteSpace))continue;const o=e[i-1];Jt(o,this.lexerConfig.WhiteSpace)&&(s.leadingWhitespace=o),t.push(s)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}const ad=(n,e,t,r)=>{switch(n.type){case M.EMPTY:case M.NUMBER:case M.STRING:case M.ERROR:return;case M.NAMED_EXPRESSION:{r&&t.push(new al(n.expressionName));return}case M.CELL_REFERENCE:{r&&t.push(new QG(n.reference));return}case M.CELL_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new hwe(n.start,n.end));return}case M.COLUMN_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new cwe(n.start,n.end));return}case M.ROW_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new dwe(n.start,n.end));return}case M.PERCENT_OP:case M.PLUS_UNARY_OP:case M.MINUS_UNARY_OP:{ad(n.value,e,t,!0);return}case M.CONCATENATE_OP:case M.EQUALS_OP:case M.NOT_EQUAL_OP:case M.LESS_THAN_OP:case M.GREATER_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.PLUS_OP:case M.TIMES_OP:case M.DIV_OP:case M.POWER_OP:ad(n.left,e,t,!0),ad(n.right,e,t,!0);return;case M.PARENTHESIS:ad(n.expression,e,t,r);return;case M.FUNCTION_CALL:{const i=!e.doesFunctionNeedArgumentToBeComputed(n.procedureName);n.args.forEach(s=>ad(s,e,t,i));return}}},AS=(n,e)=>{const t=new Array;return ad(n,e,t,!0),t};class QG{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class hwe{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new Le(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class cwe{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),r=this.end.toSimpleColumnAddress(e);return new hl(t.sheet,t.col,r.col)}}class dwe{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),r=this.end.toSimpleRowAddress(e);return new cl(t.sheet,t.row,r.row)}}class al{constructor(e){this.name=e}absolutize(e){return this}}const ia=(n,e)=>n.map(t=>t.absolutize(e)),fwe=n=>n.filter(e=>e instanceof al?!0:e instanceof Le?!(Di(e.start)||Di(e.end)):!Di(e));const ft=Symbol("Empty value");function ve(n){return n instanceof Ta?n.val:n}class Ta{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function QO(n,e){if(typeof n=="number")return e;{const t=n.fromNumber(e);return t.format=n.format,t}}class ZO extends Ta{getDetailedType(){return Me.NUMBER_DATE}}class WN extends Ta{getDetailedType(){return Me.NUMBER_CURRENCY}}class JO extends Ta{getDetailedType(){return Me.NUMBER_TIME}}class e_ extends Ta{getDetailedType(){return Me.NUMBER_DATETIME}}class Vv extends Ta{getDetailedType(){return Me.NUMBER_PERCENT}}function Pt(n){return typeof n=="number"||n instanceof Ta}var Me;(function(n){n.NUMBER_RAW="NUMBER_RAW",n.NUMBER_DATE="NUMBER_DATE",n.NUMBER_TIME="NUMBER_TIME",n.NUMBER_DATETIME="NUMBER_DATETIME",n.NUMBER_CURRENCY="NUMBER_CURRENCY",n.NUMBER_PERCENT="NUMBER_PERCENT"})(Me||(Me={}));function mwe(n){return n instanceof Ta?n.getDetailedType():Me.NUMBER_RAW}function gwe(n){if(n instanceof Ta)return n.format}function sC(n){return n instanceof Ta?{type:n.getDetailedType(),format:n.format}:{type:Me.NUMBER_RAW}}class Oe{constructor(e,t,r,i){this._data=e,this.range=t,this.dependencyGraph=r,this._hasOnlyNumbers=i,this.size=e===void 0?new yt(t.effectiveWidth(r),t.effectiveHeight(r)):new yt(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,r){return new Oe(e,t,r,!0)}static onlyNumbers(e){return new Oe(e,void 0,void 0,!0)}static onlyValues(e){return new Oe(e,void 0,void 0,void 0)}static onlyRange(e,t){return new Oe(void 0,e,t,void 0)}static fromScalar(e){return new Oe([[e]],void 0,void 0,void 0)}isAdHoc(){return this.range===void 0}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let r=0;r<this._data[0].length;r++)e.push(this._data[t][r]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const r=this.data[t];for(let i=0;i<r.length;++i)yield Ce(e.sheet,e.col+i,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let r=0;r<this.size.width;++r)yield[this._data[t][r],Ce(e.sheet,e.col+r,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if(typeof t!="number")return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof Oe?(this._hasOnlyNumbers=!1,new E(N.VALUE,_.ScalarExpected)):(Pt(t)||(this._hasOnlyNumbers=!1),t)}))}}class gu{constructor(){this.changes=new Map}static empty(){return new gu}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,r){this.addInterpreterValue(e,t,r)}exportChanges(e){let t=[];return this.changes.forEach(r=>{const i=e.exportChange(r);Array.isArray(i)?t=t.concat(i):t.push(i)}),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return this.changes.size===0}add(e,t){const r=t.value;if(r instanceof Oe)for(const i of r.effectiveAddressesFromData(e))this.changes.delete(Qm(i));this.changes.set(Qm(e),t)}addInterpreterValue(e,t,r){this.add(t,{address:t,value:e,oldValue:r})}}class Hi{constructor(e,t,r){if(this.sheet=e,this.rowStart=t,this.rowEnd=r,t<0)throw Error("Starting row cant be less than 0");if(r<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,r){return new Hi(e,t,t+r-1)}static fromRowStartAndEnd(e,t,r){return new Hi(e,t,r)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),r=Math.min(this.rowEnd,e.rowEnd);return t>r?null:new Hi(this.sheet,t,r)}firstRow(){return new Hi(this.sheet,this.rowStart,this.rowStart)}}class es{constructor(e,t,r){if(this.sheet=e,this.columnStart=t,this.columnEnd=r,t<0)throw Error("Starting column cant be less than 0");if(r<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,r){return new es(e,t,t+r-1)}static fromColumnStartAndEnd(e,t,r){return new es(e,t,r)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),r=Math.min(this.columnEnd,e.columnEnd);return t>r?null:new es(this.sheet,t,r)}firstColumn(){return new es(this.sheet,this.columnStart,this.columnStart)}}var tt;(function(n){n.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",n.PARSER="PARSER",n.GRAPH_BUILD="GRAPH_BUILD",n.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",n.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",n.TOP_SORT="TOP_SORT",n.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",n.EVALUATION="EVALUATION",n.VLOOKUP="VLOOKUP",n.TRANSFORM_ASTS="TRANSFORM_ASTS",n.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",n.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",n.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",n.ADJUSTING_RANGES="ADJUSTING_RANGES",n.ADJUSTING_GRAPH="ADJUSTING_GRAPH",n.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",n.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(tt||(tt={}));class ZG{constructor(){this.stats=new Map([[tt.CRITERION_FUNCTION_FULL_CACHE_USED,0],[tt.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=((e=this.stats.get(tt.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(tt.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=((e=this.stats.get(tt.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(tt.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(tt.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(tt.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const r=Date.now(),i=this.startTimes.get(e);if(i){let s=(t=this.stats.get(e))!==null&&t!==void 0?t:0;s+=r-i,this.stats.set(e,s),this.startTimes.delete(e)}else throw Error(`Statistics ${e} not started`)}measure(e,t){this.start(e);const r=t();return this.end(e),r}snapshot(){return new Map(this.stats)}}class pwe extends ZG{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}class On extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class JG extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class Ag extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class Vh extends Error{constructor(){super("Sheet size limit exceeded")}}class Uv extends Error{constructor(){super("This is not a formula")}}class ej extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class rr extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class Ng extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class tj extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class nj extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class Ig extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class rj extends Error{constructor(){super("There is no operation to undo")}}class ij extends Error{constructor(){super("There is no operation to redo")}}class sj extends Error{constructor(){super("There is nothing to paste")}}function wwe(n,e){switch(typeof e){case"function":case"symbol":return e.toString();case"bigint":return"BigInt("+e.toString()+")";default:return e instanceof RegExp?"RegExp("+e.toString()+")":e}}class oj extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,wwe,4)}`)}}class _t extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class vwe extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class aj extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class lj extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class uj extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class hj extends Error{constructor(){super("Computations are suspended")}}class ld extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class cj extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class $N extends Error{constructor(){super("Language not registered.")}}class dj extends Error{constructor(){super("Language already registered.")}}class zd extends Error{static functionNotDeclaredInPlugin(e,t){return new zd(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new zd(`Function method ${e} not found in plugin ${t}`)}}class Uh extends Error{static cannotRegisterFunctionWithId(e){return new Uh(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new Uh(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new Uh("Cannot unregister protected plugin")}}class Cd extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class oC extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class t_ extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class ywe extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}class Cwe{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new On(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new On(e.sheet);const r=t.getCell(e);if(!r)throw Error("Vertex for address missing in AddressMapping");return r}strategyFor(e){const t=this.mapping.get(e);if(t===void 0)throw new On(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){const{height:r,width:i,fill:s}=t,o=this.policy.call(s);this.addSheet(e,new o(i,r))}getCellValue(e){const t=this.getCell(e);return t===void 0?ft:t instanceof Xn?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof pu?t.getValues().rawValue:t instanceof Xn?t.getArrayCellRawValue(e):null}setCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.setCell(e,t)}moveCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(r.has(t))throw new Error("Cannot move cell. Destination already occupied.");const i=r.getCell(e);if(i===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,i),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return t===void 0?!1:t.has(e)}getHeight(e){const t=this.mapping.get(e);if(t===void 0)throw new On(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new On(e);return t.getWidth()}addRows(e,t,r){const i=this.mapping.get(e);if(i===void 0)throw new On(e);i.addRows(t,r)}removeRows(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new On(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,r){const i=this.mapping.get(e);if(i===void 0)throw new On(e);i.addColumns(t,r)}removeColumns(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new On(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(t!==void 0)yield*t.getEntries(e);else throw new On(e)}}class Swe{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(t?.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(Qm(e))}setArray(e,t){this.arrayMapping.set(Qm(e.start),t)}removeArray(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(Qm(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,r])}*arraysInCols(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,r])}isFormulaArrayInRow(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const r of e.rows())this.isFormulaArrayInRow(e.sheet,r)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const r of e.columns())this.isFormulaArrayInColumn(e.sheet,r)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,r){this.updateArrayVerticesInSheet(e,(i,s)=>{const o=s.getRange();return t<=o.start.row?[o.shifted(0,r),s]:void 0})}moveArrayVerticesAfterColumnByColumns(e,t,r){this.updateArrayVerticesInSheet(e,(i,s)=>{const o=s.getRange();return t<=o.start.col?[o.shifted(r,0),s]:void 0})}updateArrayVerticesInSheet(e,t){const r=Array();for(const[i,s]of this.arrayMapping.entries()){if(s.sheet!==e)continue;const o=t(i,s);o!==void 0&&(this.removeArray(i),r.push(o))}r.forEach(([i,s])=>{this.setArray(i,s)})}}class Cm{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class Yd{constructor(e){if(this.size=new yt(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return e instanceof Oe?new Yd(e.data):new Yd([[e]])}simpleRangeValue(){return Oe.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let r=0;r<this.height();r++)this.array[r].splice(e,0,...new Array(t).fill(ft));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const r=t-e+1;this.array.splice(e,r),this.size.height-=r}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const r=t-e+1;for(const i of this.array)i.splice(e,r);this.size.width-=r}nullArrays(e,t){const r=[];for(let i=0;i<e;++i)r.push(new Array(t).fill(ft));return r}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,r){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=r}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class pA{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}class ts{constructor(e,t,r){this.formula=e,this.cellAddress=t,this.version=r}get width(){return 1}get height(){return 1}static fromAst(e,t,r,i){return r.isScalar()?new ca(e,t,i):new Xn(e,t,r,i)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,r,i]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=r,this.version=i}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class Xn extends ts{constructor(e,t,r,i=0){super(e,t,i),r.isRef?this.array=new pA(new E(N.REF,_.NoSpaceForArrayResult),yt.error()):this.array=new Cm(r)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof E)return this.setErrorValue(e),e;const t=Yd.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof Cm)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof Cm))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;try{return this.array.get(t,r)}catch{return new E(N.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);if(!(t instanceof E||t===ft))return ve(t)}setArrayCellValue(e,t){const r=e.col-this.cellAddress.col,i=e.row-this.cellAddress.row;this.array instanceof Yd&&this.array.set(r,i,t)}setNoSpace(){return this.array=new pA(new E(N.SPILL,_.NoSpaceForArrayResult),yt.error()),this.getCellValue()}getRange(){return Le.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return Le.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof Cm)}columnsFromArray(){return es.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return Hi.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return Og(this.cellAddress,e)}setErrorValue(e){this.array=new pA(e,this.array.size)}}class ca extends ts{constructor(e,t,r){super(e,t,r)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return this.cachedCellValue!==void 0}}class Kr{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var r;return(r=this.getCriterionFunctionValues(e).get(t))===null||r===void 0?void 0:r[0]}getCriterionFunctionValues(e){var t;return(t=this.criterionFunctionCache.get(e))!==null&&t!==void 0?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}const Rwe=(n,e,t,r,i)=>{if(e instanceof Kr){const a=e.range.intersectionWith(t);return a!==void 0?Array.from(a.addresses(i)):[]}let s,o;if(e instanceof ts)s=e.getFormula(r),o=e.getAddress(r);else return[];return AS(s,n).filter(a=>a instanceof QG).map(a=>a.dependency.toSimpleCellAddress(o)).filter(a=>t.addressInRange(a))};var Za;(function(n){n[n.ON_STACK=0]="ON_STACK",n[n.PROCESSED=1]="PROCESSED",n[n.POPPED=2]="POPPED"})(Za||(Za={}));class Ewe{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,r){const i=e.reverse();return i.forEach(s=>this.runDFS(s)),this.postprocess(i,r,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter(t=>t!==void 0&&this.nodesSparseArray[t])}runDFS(e){if(this.nodeStatus[e]!==void 0)return;this.nodeStatus[e]=Za.ON_STACK;const t=[e],r=[];for(;t.length>0;){const i=t[t.length-1];switch(this.nodeStatus[i]){case Za.ON_STACK:{this.handleOnStack(i,r,t);break}case Za.PROCESSED:{this.handleProcessed(i,r,t);break}case Za.POPPED:{t.pop();break}}}}handleOnStack(e,t,r){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach(i=>{this.entranceTime[i]===void 0&&(r.push(i),this.parent[i]=e,this.nodeStatus[i]=Za.ON_STACK)}),this.nodeStatus[e]=Za.PROCESSED}handleProcessed(e,t,r){let i=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach(s=>{this.inSCC[s]||(i=this.parent[s]===e?Math.min(i,this.low[s]):Math.min(i,this.entranceTime[s]))}),this.low[e]=i,i===this.entranceTime[e]){const s=[];do s.push(t[t.length-1]),t.pop();while(s[s.length-1]!==e);s.forEach(o=>{this.inSCC[o]=!0}),this.order.push(...s),s.length>1&&s.forEach(o=>{this.sccNonSingletons[o]=!0})}r.pop(),this.nodeStatus[e]=Za.POPPED}postprocess(e,t,r){const i=[];e.forEach(a=>{i[a]=!0});const s=[],o=[];return this.order.reverse(),this.order.forEach(a=>{const l=this.getAdjacentNodeIds(a);this.sccNonSingletons[a]||l.includes(a)?(o.push(this.nodesSparseArray[a]),t(this.nodesSparseArray[a]),l.forEach(u=>i[u]=!0)):(s.push(this.nodesSparseArray[a]),i[a]&&r(this.nodesSparseArray[a])&&l.forEach(u=>i[u]=!0))}),{sorted:s,cycled:o}}}class bwe{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return this.processedValue===null&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}class Twe{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new bwe({dirty:[],volatile:[]},t=>this.processDirtyAndVolatileNodeIds(t)),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter(e=>e!==void 0)}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const r=this.getNodeId(e),i=this.getNodeId(t);return r===void 0||i===void 0?!1:this.edgesSparseArray[r].includes(i)}adjacentNodes(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter(r=>r!==void 0).map(r=>this.nodesSparseArray[r]))}adjacentNodesCount(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(t!==void 0)return t;const r=this.nextId;return this.nextId++,this.nodesSparseArray[r]=e,this.edgesSparseArray[r]=[],this.nodesIds.set(e,r),r}addEdge(e,t){const r=this.getNodeIdIfNotNumber(e),i=this.getNodeIdIfNotNumber(t);if(r===void 0)throw this.missingNodeError(e);if(i===void 0)throw this.missingNodeError(t);this.edgesSparseArray[r].includes(i)||this.edgesSparseArray[r].push(i)}removeNode(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach(i=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(i)),this.dirtyAndVolatileNodeIds.markAsModified());const r=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),r}removeEdge(e,t){const r=this.getNodeIdIfNotNumber(e),i=this.getNodeIdIfNotNumber(t);if(r===void 0)throw this.missingNodeError(e);if(i===void 0)throw this.missingNodeError(t);const s=this.edgesSparseArray[r].indexOf(i);if(s===-1)throw new Error("Edge does not exist");delete this.edgesSparseArray[r][s]}removeEdgeIfExists(e,t){const r=this.getNodeId(e),i=this.getNodeId(t);if(r===void 0||i===void 0)return;const s=this.edgesSparseArray[r].indexOf(i);s!==-1&&delete this.edgesSparseArray[r][s]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,r){const i=new Ewe(this.nodesSparseArray,this.edgesSparseArray),s=e.map(o=>this.getNodeId(o)).filter(o=>o!==void 0);return i.getTopSortedWithSccSubgraphFrom(s,t,r)}markNodeAsVolatile(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);t!==void 0&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);t!==void 0&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map(e=>({node:this.nodesSparseArray[e],id:e}))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return typeof e=="number"?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter(r=>r!==void 0&&this.nodesSparseArray[r]),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach(([r,i])=>{this.removeEdgeIfExists(i,e)}),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map(r=>this.nodesSparseArray[r]).filter(r=>r!==void 0)}missingNodeError(e){return new Error(`Unknown node ${e}`)}}class Awe{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,r;return(r=(t=this.rangeMapping.get(e))===null||t===void 0?void 0:t.size)!==null&&r!==void 0?r:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);t===void 0&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const r=Bv(e.getStart(),e.getEnd());t.set(r,e)}removeRange(e){const t=e.getStart().sheet,r=this.rangeMapping.get(t);if(r===void 0)return;const i=Bv(e.getStart(),e.getEnd());r.delete(i),r.size===0&&this.rangeMapping.delete(t)}getRange(e,t){const r=this.rangeMapping.get(e.sheet),i=Bv(e,t);return r?.get(i)}fetchRange(e,t){const r=this.getRange(e,t);if(!r)throw Error("Range does not exist");return r}truncateRanges(e,t){const r=Array(),i=Array(),s=Array(),o=e.sheet;for(const[l,u]of this.entriesFromSheet(e.sheet)){const h=u.range;e.start<=t(u.range.end)&&(h.removeSpan(e),h.shouldBeRemoved()?(this.removeByKey(o,l),r.push(u)):i.push([l,u]),s.push(u))}const a=[];i.sort((l,u)=>Iwe(l[1],u[1],t));for(const[l,u]of i){const h=Nwe(u.range);if(h===l)continue;const c=this.getByKey(o,h);this.removeByKey(o,l),c!==void 0&&u!=c?a.push([c,u]):this.setRange(u)}return{verticesToRemove:r,verticesToMerge:a,verticesWithChangedSize:s}}moveAllRangesInSheetAfterRowByRows(e,t,r){return this.updateVerticesFromSheet(e,(i,s)=>t<=s.start.row?(s.range.shiftByRows(r),{changedSize:!1,vertex:s}):t>s.start.row&&t<=s.end.row?(s.range.expandByRows(r),{changedSize:!0,vertex:s}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,t,r){return this.updateVerticesFromSheet(e,(i,s)=>t<=s.start.col?(s.range.shiftByColumns(r),{changedSize:!1,vertex:s}):t>s.start.col&&t<=s.end.col?(s.range.expandByColumns(r),{changedSize:!0,vertex:s}):void 0)}moveRangesInsideSourceRange(e,t,r,i){this.updateVerticesFromSheet(e.sheet,(s,o)=>{if(e.containsRange(o.range))return o.range.shiftByColumns(t),o.range.shiftByRows(r),o.range.moveToSheet(i),{changedSize:!1,vertex:o}})}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=Ce(e.end.sheet,e.end.col,e.end.row-1),r=this.getRange(e.start,t);if(r!==void 0){const i=Le.fromSimpleCellAddresses(Ce(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:r,restRange:i}}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var r;return(r=this.rangeMapping.get(e))===null||r===void 0?void 0:r.get(t)}updateVerticesFromSheet(e,t){const r=Array();for(const[i,s]of this.entriesFromSheet(e)){const o=t(i,s);o!==void 0&&(this.removeByKey(e,i),r.push(o))}return r.forEach(i=>{this.setRange(i.vertex)}),{verticesWithChangedSize:r.filter(i=>i.changedSize).map(i=>i.vertex)}}}function Bv(n,e){return`${n.col},${n.row},${e.col},${e.row}`}function Nwe(n){return Bv(n.start,n.end)}const Iwe=(n,e,t)=>{const r=t(n.range.start),i=t(n.range.start);if(r===i){const s=t(n.range.end),o=t(e.range.end);return s-o}else return r-i};class Mwe{constructor(e,t,r){this.functions=e,this.errors=t,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return this.functions[e]!==void 0}getFunctionTranslations(e){const t=[];for(const r of e)this.isFunctionTranslated(r)&&t.push(this.functions[r]);return t}getFunctionTranslation(e){const t=this.functions[e];if(t===void 0)throw new ld(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===N.LIC)return`#${N.LIC}!`;const t=this.errors[e];if(t===void 0)throw new ld(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(t===void 0)throw new ld(`ui.${e}`);return t}checkUI(){for(const e of Object.values(Mg))if(!(e in this.ui))throw new ld(`ui.${e}`)}checkErrors(){for(const e of Object.values(N))if(!(e in this.errors)&&e!==N.LIC)throw new ld(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const r of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(r))throw new cj(r)}}function Owe(n){return new Mwe(Object.assign({},n.functions),Object.assign({},n.errors),Object.assign({},n.ui))}var Mg;(function(n){n.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(Mg||(Mg={}));function ud(n){return n.toLowerCase()}class _we{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return ud(this.displayName)}}class xwe{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=t=>{const r=this.mappingFromCanonicalName.get(ud(t));if(r===void 0)throw new JG(t);return r.id},this.get=t=>{var r;return(r=this.mappingFromCanonicalName.get(ud(t)))===null||r===void 0?void 0:r.id},this.fetchDisplayName=t=>this.fetchSheetById(t).displayName,this.sheetNamePrefix=e.getUITranslation(Mg.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=ud(e);if(this.mappingFromCanonicalName.has(t))throw new Ag(e);this.lastSheetId++;const r=new _we(this.lastSheetId,e);return this.store(r),r.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return(t=this.mappingFromId.get(e))===null||t===void 0?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(ud(e))}renameSheet(e,t){const r=this.fetchSheetById(e),i=r.displayName;if(i===t)return;const s=this.mappingFromCanonicalName.get(ud(t));if(s!==void 0&&s.id!==r.id)throw new Ag(t);const o=r.canonicalName;return this.mappingFromCanonicalName.delete(o),r.displayName=t,this.store(r),i}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(t===void 0)throw new On(e);return t}}class n_{constructor(e,t,r,i,s,o,a,l){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=r,this.arrayMapping=i,this.stats=s,this.lazilyTransformingAstService=o,this.functionRegistry=a,this.namedExpressions=l,this.changes=gu.empty(),this.dependencyQueryAddresses=u=>{if(u instanceof Kr)return this.rangeDependencyQuery(u).map(([h,c])=>h);{const h=this.formulaDependencyQuery(u);if(h!==void 0){const[c,d]=h;return d.map(f=>f instanceof al?this.namedExpressions.namedExpressionOrPlaceholder(f.name,c.sheet).address:Vn(f)?f:jN(f.start,f.end))}else return[]}},this.dependencyQueryVertices=u=>{if(u instanceof Kr)return this.rangeDependencyQuery(u);{const h=this.formulaDependencyQuery(u);if(h!==void 0){const[c,d]=h;return d.map(f=>{if(f instanceof Le)return[f.start,this.rangeMapping.fetchRange(f.start,f.end)];if(f instanceof al){const m=this.namedExpressions.namedExpressionOrPlaceholder(f.name,c.sheet);return[m.address,this.addressMapping.fetchCell(m.address)]}else return[f,this.addressMapping.fetchCell(f)]})}else return[]}},this.rangeDependencyQuery=u=>{const h=[],{smallerRangeVertex:c,restRange:d}=this.rangeMapping.findSmallerRange(u.range);let f;c!==void 0&&this.graph.adjacentNodes(c).has(u)?(f=d,h.push([new Le(c.start,c.end),c])):f=u.range;for(const m of f.addresses(this)){const p=this.addressMapping.getCell(m);p!==void 0&&h.push([m,p])}return h},this.formulaDependencyQuery=u=>{let h,c;if(u instanceof ts)c=u.getAddress(this.lazilyTransformingAstService),h=u.getFormula(this.lazilyTransformingAstService);else return;const d=AS(h,this.functionRegistry);return[c,ia(d,c)]},this.graph=new Twe(this.dependencyQueryVertices)}static buildEmpty(e,t,r,i,s){return new n_(new Cwe(t.chooseAddressMappingPolicy),new Awe,new xwe(t.translationPackage),new Swe,s,e,r,i)}setFormulaToCell(e,t,r,i,s,o){const a=ts.fromAst(t,e,i,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(a),this.processCellDependencies(r,a),this.graph.markNodeAsDirty(a),s&&this.markAsVolatile(a),o&&this.markAsDependentOnStructureChange(a),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);if(r instanceof Xn&&this.arrayMapping.removeArray(r.getRange()),r instanceof pu)r.getValues().rawValue!==t.rawValue&&(r.setValues(t),this.graph.markNodeAsDirty(r));else{const i=new pu(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(r,i),this.addressMapping.setCell(e,i),this.graph.markNodeAsDirty(i)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(t===void 0)return gu.empty();if(this.graph.adjacentNodes(t).size>0){const r=new tu;this.exchangeGraphNode(t,r),this.graph.adjacentNodesCount(r)===0?(this.removeVertex(r),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(r),this.addressMapping.setCell(e,r))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const r=this.graph.getNodeId(t);e.forEach(i=>{if(i instanceof Le){const s=i;let o=this.getRange(s.start,s.end);o===void 0&&(o=new Kr(s),this.rangeMapping.setRange(o)),this.graph.addNodeAndReturnId(o);const a=this.graph.getNodeId(o);s.isFinite()||this.graph.markNodeAsInfiniteRange(a);const{smallerRangeVertex:l,restRange:u}=this.rangeMapping.findSmallerRange(s);if(l!==void 0){if(this.graph.addEdge(l,a),o.bruteForce){o.bruteForce=!1;for(const c of s.addresses(this))this.graph.removeEdge(this.fetchCell(c),a)}}else o.bruteForce=!0;const h=this.arrayMapping.getArray(u);if(h!==void 0)this.graph.addEdge(h,a);else for(const c of u.addresses(this)){const{vertex:d,id:f}=this.fetchCellOrCreateEmpty(c);this.graph.addEdge(f??d,a)}this.graph.addEdge(a,r),s.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(i instanceof al){const s=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:o,id:a}=this.fetchNamedExpressionVertex(i.name,s);this.graph.addEdge(a??o,r)}else{const{vertex:s,id:o}=this.fetchCellOrCreateEmpty(i);this.graph.addEdge(o??s,r)}})}fetchNamedExpressionVertex(e,t){const r=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(r.address)}exchangeNode(e,t){const r=this.fetchCellOrCreateEmpty(e).vertex,i=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(r,i)}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(t!==void 0)return{vertex:t,id:void 0};const r=new tu,i=this.graph.addNodeAndReturnId(r);return this.addressMapping.setCell(e,r),{vertex:r,id:i}}removeRows(e){this.stats.measure(tt.ADJUSTING_GRAPH,()=>{for(const[r,i]of this.addressMapping.entriesFromRowsSpan(e)){for(const s of this.graph.adjacentNodes(i))this.graph.markNodeAsDirty(s);if(i instanceof Xn)if(i.isLeftCorner(r))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(tt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const t=this.stats.measure(tt.ADJUSTING_RANGES,()=>{const r=this.truncateRanges(e,i=>i.row);return this.getArrayVerticesRelatedToRanges(r)});return this.stats.measure(tt.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[t,r]of this.addressMapping.sheetEntries(e)){for(const i of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(i);this.removeVertex(r),this.addressMapping.removeCell(t)}this.stats.measure(tt.ADJUSTING_RANGES,()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const r of t)this.removeVertex(r);this.stats.measure(tt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){const t=new Set;for(const[r,i]of this.addressMapping.sheetEntries(e))i instanceof Xn?t.add(i):this.setCellEmpty(r);for(const r of t.values())this.setArrayEmpty(r);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(tt.ADJUSTING_GRAPH,()=>{for(const[r,i]of this.addressMapping.entriesFromColumnsSpan(e)){for(const s of this.graph.adjacentNodes(i))this.graph.markNodeAsDirty(s);if(i instanceof Xn)if(i.isLeftCorner(r))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(tt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const t=this.stats.measure(tt.ADJUSTING_RANGES,()=>{const r=this.truncateRanges(e,i=>i.col);return this.getArrayVerticesRelatedToRanges(r)});return this.stats.measure(tt.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(tt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const t=this.stats.measure(tt.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(r.verticesWithChangedSize)});this.stats.measure(tt.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const r of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(tt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const t=this.stats.measure(tt.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(r.verticesWithChangedSize)});this.stats.measure(tt.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const r of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(t===void 0)return!1;for(const r of t.addresses(this)){const i=this.addressMapping.getCell(r);if(i!==void 0&&!(i instanceof tu)&&i!==e)return!1}return!0}moveCells(e,t,r,i){for(const s of e.addressesWithDirection(t,r,this)){const o=Ce(i,s.col+t,s.row+r);let a=this.addressMapping.getCell(s);const l=this.addressMapping.getCell(o);if(this.addressMapping.removeCell(s),a!==void 0){this.graph.markNodeAsDirty(a),this.addressMapping.setCell(o,a);let u;for(const h of this.graph.adjacentNodes(a))h instanceof Kr&&!e.containsRange(h.range)&&(u=u??this.fetchCellOrCreateEmpty(s).vertex,this.graph.addEdge(u,h),this.graph.removeEdge(a,h));u&&(this.graph.markNodeAsDirty(u),this.addressMapping.setCell(s,u))}if(l!==void 0){a===void 0&&this.addressMapping.removeCell(o);for(const u of this.graph.adjacentNodes(l))a=a??this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(a,u),this.graph.markNodeAsDirty(a);this.removeVertex(l)}}for(const s of this.rangeMapping.rangeVerticesContainedInRange(e))for(const o of this.graph.adjacentNodes(s))if(o instanceof Kr&&!e.containsRange(o.range)){this.graph.removeEdge(s,o);for(const a of s.range.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,o),this.addressMapping.setCell(a,l),this.graph.markNodeAsDirty(l)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,r,i)}setArrayEmpty(e){const t=Le.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),r=this.graph.adjacentNodes(e);for(const i of t.addresses(this))this.addressMapping.removeCell(i);for(const i of r.values()){const s=Rwe(this.functionRegistry,i,e.getRange(),this.lazilyTransformingAstService,this);for(const o of s){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,i)}s.length>0&&this.graph.markNodeAsDirty(i)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof Xn&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof Oe?new E(N.VALUE,_.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof ca&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const r=this.getScalarValue(t);r!==ft&&(yield[ve(r),t])}}computeListOfValuesInRange(e){const t=[];for(const r of e.addresses(this)){const i=this.getScalarValue(r);t.push(i)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let r;t instanceof ts?r=this.formulaDirectDependenciesToArray(t,e):r=this.rangeDirectDependenciesToArray(t,e);let i=!1;for(const[s,o]of r)e.isLeftCorner(s)&&(i=!0),this.graph.addEdge(o,t),this.graph.markNodeAsDirty(o);i||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof Xn&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=gu.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),r=[];return t.forEach(i=>{const s=i;s instanceof Kr?r.push(jN(s.start,s.end)):r.push(s.getAddress(this.lazilyTransformingAstService))}),r}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const r=this.graph.adjacentNodes(e);this.removeVertex(e),r.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(t,i)})}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter(({node:o})=>o.range.addressInRange(e));if(t.length<=0)return;const{vertex:r,id:i}=this.fetchCellOrCreateEmpty(e),s=i??this.graph.getNodeId(r);t.forEach(({id:o})=>{this.graph.addEdge(s,o)})}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach(r=>{this.graph.hasNode(r)&&this.graph.adjacentNodes(r).forEach(i=>{i instanceof Xn&&t.add(i)})}),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach(({id:t,node:r})=>{const i=e.range.intersectionWith(r.range);i!==void 0&&i.addresses(this).forEach(s=>{const{vertex:o,id:a}=this.fetchCellOrCreateEmpty(s);this.graph.addEdge(a??o,t)})})}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const r of t.addresses(this)){const i=e.getArrayCellValue(r);this.getCell(r)===e?e.isLeftCorner(r)?this.changes.addChange(new E(N.REF),r,i):(this.addressMapping.removeCell(r),this.changes.addChange(ft,r,i)):this.changes.addChange(ft,r,i)}}*formulaDirectDependenciesToArray(e,t){var r;const[,i]=(r=this.formulaDependencyQuery(e))!==null&&r!==void 0?r:[];if(i!==void 0){for(const s of i)if(!(s instanceof al||s instanceof Le)&&t.getRange().addressInRange(s)){const o=this.fetchCellOrCreateEmpty(s).vertex;yield[s,o]}}}*rangeDirectDependenciesToArray(e,t){const{restRange:r}=this.rangeMapping.findSmallerRange(e.range);for(const i of r.addresses(this))if(t.getRange().addressInRange(i)){const s=this.fetchCellOrCreateEmpty(i).vertex;yield[i,s]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const r of t)(r instanceof ts||r instanceof Kr)&&(yield r)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,r){const i=Array.from(this.rangeMapping.rangesInSheet(e));for(const s of i)if(s.range.includesRow(t+r))if(s.bruteForce){const o=s.range.rangeWithSameWidth(t,r);for(const a of o.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,s)}}else{let o=s,a=this.rangeMapping.findSmallerRange(o.range);if(a.smallerRangeVertex!==void 0)continue;for(;a.smallerRangeVertex===void 0;){const l=new Kr(Le.spanFrom(o.range.start,o.range.width(),o.range.height()-1));this.rangeMapping.setRange(l),this.graph.addNodeAndReturnId(l);const u=new Le(Ce(o.range.start.sheet,o.range.start.col,o.range.end.row),o.range.end);this.addAllFromRange(u,o),this.graph.addEdge(l,o),o=l,a=this.rangeMapping.findSmallerRange(o.range)}this.graph.addEdge(a.smallerRangeVertex,o),this.addAllFromRange(a.restRange,o),this.graph.removeEdge(a.smallerRangeVertex,s)}}addAllFromRange(e,t){for(const r of e.addresses(this)){const{vertex:i,id:s}=this.fetchCellOrCreateEmpty(r);this.graph.addEdge(s??i,t)}}fixRangesWhenAddingColumns(e,t,r){for(const i of this.rangeMapping.rangesInSheet(e))if(i.range.includesColumn(t+r)){let s;i.bruteForce?s=i.range.rangeWithSameHeight(t,r):s=Le.spanFrom(Ce(e,t,i.range.end.row),r,1);for(const o of s.addresses(this)){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,i)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),r=Le.spanFrom(t,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof Xn&&this.setArray(r,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(t,e),e instanceof Xn){if(!this.isThereSpaceForArray(e))return;for(const s of r.addresses(this)){if(e.isLeftCorner(s))continue;const o=this.getCell(s);this.exchangeOrAddGraphNode(o,e)}}for(const s of r.addresses(this))this.addressMapping.setCell(s,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof Xn))return;const r=Le.spanFromOrUndef(t,e.width,e.height);if(r!==void 0&&(this.setArray(r,e),!!this.isThereSpaceForArray(e)))for(const i of r.addresses(this))this.addressMapping.setCell(i,e)}truncateRanges(e,t){const{verticesToRemove:r,verticesToMerge:i,verticesWithChangedSize:s}=this.rangeMapping.truncateRanges(e,t);for(const[o,a]of i)this.mergeRangeVertices(o,a);for(const o of r)this.removeVertexAndCleanupDependencies(o);return s}fixArraysAfterAddingRow(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInRows(Hi.fromRowStartAndEnd(e,t-1,t-1))){const s=i.getRange();for(let o=s.start.col;o<=s.end.col;++o)for(let a=t;a<=s.end.row;++a){const l=Ce(e,o,a),u=Ce(e,o,a+r),h=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(ft,u,h)}}}fixArraysAfterRemovingRows(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInRows(Hi.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(i))for(const s of i.getRange().addresses(this))this.addressMapping.setCell(s,i);else this.setNoSpaceIfArray(i)}fixArraysAfterAddingColumn(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInCols(es.fromColumnStartAndEnd(e,t-1,t-1))){const s=i.getRange();for(let o=s.start.row;o<=s.end.row;++o)for(let a=t;a<=s.end.col;++a){const l=Ce(e,a,o),u=Ce(e,a+r,o),h=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(ft,u,h)}}}fixArraysAfterRemovingColumns(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInCols(es.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(i))for(const s of i.getRange().addresses(this))this.addressMapping.setCell(s,i);else this.setNoSpaceIfArray(i)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof Xn?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof Xn&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof Kr&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const r=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),r.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(e,i)})}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;t.size>0;){const r=t.values().next().value;t.delete(r);const[i,s]=r;this.graph.hasNode(s)&&this.graph.adjacentNodesCount(s)===0&&((s instanceof Kr||s instanceof tu)&&this.graph.removeNode(s).forEach(o=>t.add(o)),s instanceof Kr?this.rangeMapping.removeRange(s):s instanceof tu&&this.addressMapping.removeCell(i))}}}class tu{constructor(){}getCellValue(){return ft}}class pu{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw Error("SetCellValue is deprecated for ValueCellVertex")}}class xd{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){const e=this.errors.map(t=>t.message).find(t=>t);return E.parsingError(e)}getFormula(){return this.rawInput}}class Pwe{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return(t=this.mapping.get(e.col))===null||t===void 0?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let r=this.mapping.get(e.col);r||(r=new Map,this.mapping.set(e.col,r)),r.set(e.row,t)}has(e){var t;return!!(!((t=this.mapping.get(e.col))===null||t===void 0)&&t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;(t=this.mapping.get(e.col))===null||t===void 0||t.delete(e.row)}addRows(e,t){this.mapping.forEach(r=>{const i=new Map;r.forEach((s,o)=>{o>=e&&(i.set(o+t,s),r.delete(o))}),i.forEach((s,o)=>{r.set(o,s)})}),this.height+=t}addColumns(e,t){const r=new Map;this.mapping.forEach((i,s)=>{s>=e&&(r.set(s+t,i),this.mapping.delete(s))}),r.forEach((i,s)=>{this.mapping.set(s,i)}),this.width+=t}removeRows(e){this.mapping.forEach(i=>{const s=new Map;i.forEach((o,a)=>{a>=e.rowStart&&(i.delete(a),a>e.rowEnd&&s.set(a-e.numberOfRows,o))}),s.forEach((o,a)=>{i.set(a,o)})});const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){const t=new Map;this.mapping.forEach((s,o)=>{o>=e.columnStart&&(this.mapping.delete(o),o>e.columnEnd&&t.set(o-e.numberOfColumns,s))}),t.forEach((s,o)=>{this.mapping.set(o,s)});const r=Math.min(this.width-1,e.columnEnd),i=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-i)}*getEntries(e){for(const[t,r]of this.mapping)for(const[i,s]of r)yield[Ce(e,t,i),s]}*verticesFromColumn(e){const t=this.mapping.get(e);if(t!==void 0)for(const[r,i]of t)yield i}*verticesFromRow(e){for(const t of this.mapping.values()){const r=t.get(e);r!==void 0&&(yield r)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(r!==void 0)for(const[i,s]of r)yield s}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const r of e.rows()){const i=t.get(r);i!==void 0&&(yield i)}}*entriesFromRowsSpan(e){for(const[t,r]of this.mapping.entries())for(const i of e.rows()){const s=r.get(i);s!==void 0&&(yield[Ce(e.sheet,t,i),s])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(r!==void 0)for(const[i,s]of r.entries())yield[Ce(e.sheet,t,i),s]}}*vertices(){for(const[e,t]of this.mapping)for(const[r,i]of t)i!==void 0&&(yield i)}}class Lwe{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let r=0;r<t;r++)this.mapping[r]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return t?!!t[e.col]:!1}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}addRows(e,t){const r=[];for(let i=0;i<t;i++)r.push(new Array(this.width));this.mapping.splice(e,0,...r),this.height+=t}addColumns(e,t){for(let r=0;r<this.height;r++)this.mapping[r]!==void 0&&this.mapping[r].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){for(let i=0;i<this.height;i++)this.mapping[i]!==void 0&&this.mapping[i].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),r=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-r)}*getEntries(e){for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r){const i=this.getCellVertex(r,t);i&&(yield[Ce(e,r,t),i])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const r=this.getCellVertex(e,t);r&&(yield r)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const i=this.getCellVertex(t,r);i&&(yield i)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const i=this.getCellVertex(t,r);i&&(yield i)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const i=this.getCellVertex(t,r);i&&(yield[Ce(e.sheet,t,r),i])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const i=this.getCellVertex(t,r);i&&(yield[Ce(e.sheet,t,r),i])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}getCellVertex(e,t){var r;return(r=this.mapping[t])===null||r===void 0?void 0:r[e]}}var N;(function(n){n.DIV_BY_ZERO="DIV_BY_ZERO",n.NAME="NAME",n.VALUE="VALUE",n.NUM="NUM",n.NA="NA",n.CYCLE="CYCLE",n.REF="REF",n.SPILL="SPILL",n.LIC="LIC",n.ERROR="ERROR"})(N||(N={}));var xi;(function(n){n.FORMULA="FORMULA",n.VALUE="VALUE",n.ARRAY="ARRAY",n.EMPTY="EMPTY",n.ARRAYFORMULA="ARRAYFORMULA"})(xi||(xi={}));const Dwe=(n,e)=>n instanceof Xn?n.isLeftCorner(e)?xi.ARRAYFORMULA:xi.ARRAY:n instanceof ca||n instanceof xd?xi.FORMULA:n instanceof pu?xi.VALUE:xi.EMPTY;var aC;(function(n){n.EMPTY="EMPTY",n.NUMBER="NUMBER",n.STRING="STRING",n.BOOLEAN="BOOLEAN",n.ERROR="ERROR"})(aC||(aC={}));var GN;(function(n){n.NUMBER="NUMBER"})(GN||(GN={}));const uo=Object.assign(Object.assign({},aC),GN),Hwe=Object.assign(Object.assign({},aC),Me),DF=n=>{switch(n){case uo.EMPTY:return 0;case uo.NUMBER:return 1;case uo.STRING:return 2;case uo.BOOLEAN:return 3;case uo.ERROR:return 4}throw new Error("Cell value not computed")},lC=n=>{if(n===ft)return uo.EMPTY;if(n instanceof E||n instanceof Oe)return uo.ERROR;if(typeof n=="string")return uo.STRING;if(Pt(n))return uo.NUMBER;if(typeof n=="boolean")return uo.BOOLEAN;throw new Error("Cell value not computed")},Fwe=n=>Pt(n)?mwe(n):lC(n),kwe=n=>{if(Pt(n))return gwe(n)};class E{constructor(e,t,r){this.type=e,this.message=t,this.root=r}static parsingError(e){return new E(N.ERROR,`${_.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return this.root===void 0?new E(this.type,this.message,e):this}}const fj=(n,e)=>({sheet:n,row:e}),Vwe=n=>n.row<0,mj=(n,e)=>({sheet:n,col:e}),Uwe=n=>n.col<0,Ce=(n,e,t)=>({sheet:n,col:e,row:t}),Di=n=>n.col<0||n.row<0,Bwe=(n,e,t,r)=>Ce(e,n.col+t,n.row+r),Qm=n=>`${n.sheet},${n.row},${n.col}`;function Vn(n){var e,t,r;return n&&(typeof n=="object"||typeof n=="function")&&typeof((e=n)===null||e===void 0?void 0:e.sheet)=="number"&&typeof((t=n)===null||t===void 0?void 0:t.col)=="number"&&typeof((r=n)===null||r===void 0?void 0:r.row)=="number"}const po=(n,e)=>{var t;return(t=n.sheet)!==null&&t!==void 0?t:e.sheet},Og=(n,e)=>n.sheet===e.sheet&&n.col===e.col&&n.row===e.row;const Wwe="AbsoluteCellRange: Wrong range size";function Gi(n){return n&&(typeof n=="object"||typeof n=="function")?"start"in n&&Vn(n.start)&&"end"in n&&Vn(n.end):!1}const jN=(n,e)=>({start:n,end:e});class Le{constructor(e,t){if(e.sheet!==t.sheet)throw new Ng(e.sheet,t.sheet);this.start=Ce(e.sheet,e.col,e.row),this.end=Ce(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new Ng(e.sheet,t.sheet);const r=t.col-e.col,i=t.row-e.row;return Number.isFinite(i)&&Number.isFinite(r)?new Le(e,t):Number.isFinite(i)?new cl(e.sheet,e.row,t.row):new hl(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===M.CELL_RANGE?Le.fromCellRange(e,t):e.type===M.COLUMN_RANGE?hl.fromColumnRange(e,t):cl.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return Le.fromAst(e,t)}catch{return}}static fromCellRange(e,t){return new Le(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,r){const i=Le.spanFromOrUndef(e,t,r);if(i===void 0)throw new Error(Wwe);return i}static spanFromOrUndef(e,t,r){if(!Number.isFinite(t)&&Number.isFinite(r))return e.col!==0?void 0:new cl(e.sheet,e.row,e.row+r-1);if(!Number.isFinite(r)&&Number.isFinite(t))return e.row!==0?void 0:new hl(e.sheet,e.col,e.col+t-1);if(Number.isFinite(r)&&Number.isFinite(t))return new Le(e,Ce(e.sheet,e.col+t-1,e.row+r-1))}static fromCoordinates(e,t,r,i,s){return new Le(Ce(e,t,r),Ce(e,i,s))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),r=Math.min(this.end.row,e.end.row),i=Math.max(this.start.col,e.start.col),s=Math.min(this.end.col,e.end.col);if(!(t>r||i>s))return new Le(Ce(this.sheet,i,t),Ce(this.sheet,s,r))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return Le.spanFrom(Ce(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof Hi?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return Le.spanFrom(Ce(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return Le.spanFrom(Ce(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let r=0;r<this.width();++r){const i=Ce(this.sheet,this.start.col+r,this.start.row+t);e[t].push(i)}}return e}withStart(e){return new Le(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return Og(this.start,e.start)&&Og(this.end,e.end)}addressesArrayMap(e,t){const r=[];let i=this.start.row;for(;i<=this.effectiveEndRow(e);){let s=this.start.col;const o=[];for(;s<=this.effectiveEndColumn(e);)o.push(t(Ce(this.start.sheet,s,i))),s++;r.push(o),i++}return r}addresses(e){const t=[];let r=this.start.row;const i=this.effectiveEndRow(e),s=this.effectiveEndColumn(e);for(;r<=i;){let o=this.start.col;for(;o<=s;)t.push(Ce(this.start.sheet,o,r)),o++;r++}return t}*addressesWithDirection(e,t,r){if(e>0)if(t>0){let i=this.effectiveEndRow(r);for(;i>=this.start.row;){let s=this.effectiveEndColumn(r);for(;s>=this.start.col;)yield Ce(this.start.sheet,s,i),s-=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(r);){let s=this.effectiveEndColumn(r);for(;s>=this.start.col;)yield Ce(this.start.sheet,s,i),s-=1;i+=1}}else if(t>0){let i=this.effectiveEndRow(r);for(;i>=this.start.row;){let s=this.start.col;for(;s<=this.effectiveEndColumn(r);)yield Ce(this.start.sheet,s,i),s+=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(r);){let s=this.start.col;for(;s<=this.effectiveEndColumn(r);)yield Ce(this.start.sheet,s,i),s+=1;i+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return Ce(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const r=t-e+1;return this.shiftByRows(-r)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const r=t-e+1;return this.shiftByColumns(-r)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class hl extends Le{constructor(e,t,r){super(Ce(e,t,0),Ce(e,r,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const r=e.start.toSimpleColumnAddress(t),i=e.end.toSimpleColumnAddress(t);if(r.sheet!==i.sheet)throw new Ng(r.sheet,i.sheet);return new hl(r.sheet,r.col,i.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new hl(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new hl(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class cl extends Le{constructor(e,t,r){super(Ce(e,0,t),Ce(e,Number.POSITIVE_INFINITY,r))}static fromRowRangeAst(e,t){const r=e.start.toSimpleRowAddress(t),i=e.end.toSimpleRowAddress(t);if(r.sheet!==i.sheet)throw new Ng(r.sheet,i.sheet);return new cl(r.sheet,r.row,i.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new cl(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new cl(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}class ma{constructor(e,t,r){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=r}}function $we(n){const e=n.caseSensitive?n.accentSensitive?"variant":"case":n.accentSensitive?"accent":"base",t=n.caseFirst,r=n.ignorePunctuation;return new Intl.Collator(n.localeLang,{sensitivity:e,caseFirst:t,ignorePunctuation:r})}const Gwe="i",jwe=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class zwe{constructor(e,t,r){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=r,this.lt=(i,s)=>this.compare(i,s)<0,this.leq=(i,s)=>this.compare(i,s)<=0,this.gt=(i,s)=>this.compare(i,s)>0,this.geq=(i,s)=>this.compare(i,s)>=0,this.eq=(i,s)=>this.compare(i,s)===0,this.neq=(i,s)=>this.compare(i,s)!==0,this.pow=(i,s)=>Math.pow(ve(i),ve(s)),this.addWithEpsilonRaw=(i,s)=>{const o=i+s;return Math.abs(o)<this.actualEps*Math.abs(i)?0:o},this.addWithEpsilon=(i,s)=>{const o=kF(i,s);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(ve(i),ve(s)),o)},this.unaryMinus=i=>QO(i,-ve(i)),this.unaryPlus=i=>i,this.unaryPercent=i=>new Vv(ve(i)/100),this.concat=(i,s)=>i.concat(s),this.nonstrictadd=(i,s)=>i instanceof E?i:s instanceof E?s:typeof i=="number"?typeof s=="number"?this.addWithEpsilonRaw(i,s):i:typeof s=="number"?s:0,this.subtract=(i,s)=>{const o=kF(i,s),a=ve(i),l=ve(s);let u=a-l;return Math.abs(u)<this.actualEps*Math.abs(a)&&(u=0),this.ExtendedNumberFactory(u,o)},this.divide=(i,s)=>{const o=ve(i),a=ve(s);if(a===0)return new E(N.DIV_BY_ZERO);{const l=VF(i,s);return this.ExtendedNumberFactory(o/a,l)}},this.multiply=(i,s)=>{const o=VF(i,s);return this.ExtendedNumberFactory(ve(i)*ve(s),o)},this.manyToExactComplex=i=>{const s=[];for(const o of i){if(o instanceof E)return o;if(Pt(o)||typeof o=="string"){const a=this.coerceScalarToComplex(o);a instanceof E||s.push(a)}}return s},this.coerceNumbersExactRanges=i=>this.manyToNumbers(i,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=i=>this.manyToNumbers(i,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=i=>{const s=[];for(const o of i){if(o instanceof E)return o;Pt(o)&&s.push(ve(o))}return s},this.manyToOnlyNumbersDropNulls=i=>{const s=[];for(const o of i){if(o instanceof E)return o;if(Pt(o))s.push(ve(o));else if(o!==ft)return new E(N.VALUE,_.NumberExpected)}return s},this.manyToCoercedNumbersDropNulls=i=>{const s=[];for(const o of i){if(o instanceof E)return o;if(o===ft)continue;const a=this.coerceScalarToNumberOrError(o);Pt(a)&&s.push(ve(a))}return s},this.collator=$we(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return r=>typeof r=="string"&&t.test(this.normalizeString(r))}neqMatcherFunction(e){const t=this.buildRegex(e);return r=>typeof r!="string"||!t.test(this.normalizeString(r))}searchString(e,t){var r;const s=this.buildRegex(e,!1).exec(t);return(r=s?.index)!==null&&r!==void 0?r:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const r=e.charAt(t);if(_g(r)||this.config.useRegularExpressions&&xg(r))return!0}return!1}floatCmp(e,t){const r=ve(e),i=ve(t),s=1+this.actualEps;return i>=0&&r*s>=i&&r<=i*s||i<=0&&r*s<=i&&r>=i*s?0:r>i?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof E?e:(t=this.coerceToMaybeNumber(e))!==null&&t!==void 0?t:new E(N.VALUE,_.NumberCoercion)}coerceToMaybeNumber(e){var t;return(t=this.coerceNonDateScalarToMaybeNumber(e))!==null&&t!==void 0?t:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===ft)return 0;if(typeof e=="string"){if(e==="")return 0;const t=this.coerceStringToMaybePercentNumber(e);if(t!==void 0)return t;const r=this.coerceStringToMaybeCurrencyNumber(e);return r!==void 0?r:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}else return Pt(e)?e:typeof e=="boolean"?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const r=t.slice(0,t.length-1).trim(),i=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(i!==void 0)return new Vv(i/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(t!==void 0){const[r,i]=t,s=this.numberLiteralsHelper.numericStringToMaybeNumber(i);if(s!==void 0)return new WN(s,r)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const i of e)if(i instanceof Oe)t.push(i);else if(i!==ft){const s=this.coerceScalarToComplex(i);if(s instanceof E)return s;t.push(s)}const r=[];for(const i of t)if(i instanceof Oe){const s=this.manyToExactComplex(i.valuesFromTopLeftCorner());if(s instanceof E)return s;r.push(...s)}else r.push(i);return r}coerceScalarToComplex(e){return e instanceof E?e:e===ft?[0,0]:Pt(e)?[ve(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new E(N.NUM,_.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:r,format:i}=t;switch(r){case Me.NUMBER_RAW:return e;case Me.NUMBER_CURRENCY:return new WN(e,i??this.config.currencySymbol[0]);case Me.NUMBER_DATE:return new ZO(e,i);case Me.NUMBER_DATETIME:return new e_(e,i);case Me.NUMBER_TIME:return new JO(e,i);case Me.NUMBER_PERCENT:return new Vv(e,i)}}buildRegex(e,t=!0){e=this.normalizeString(e);let r,i=this.config.useWildcards,s=this.config.useRegularExpressions;if(s)try{RegExp(e)}catch{s=!1,i=!1}return s?r=Xwe(e,this.config.caseSensitive):i?r=Kwe(e,this.config.caseSensitive):r=qwe(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+r+")$"):RegExp(r)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=yj(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if(typeof e=="string"||typeof t=="string"){const r=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,i=typeof t=="string"?this.dateTimeHelper.dateStringToDateNumber(t):t;if(Pt(r)&&Pt(i))return this.floatCmp(r,i)}return e===ft?e=HF(t):t===ft&&(t=HF(e)),typeof e=="string"&&typeof t=="string"?this.stringCmp(e,t):typeof e=="boolean"&&typeof t=="boolean"?FF(zN(e),zN(t)):Pt(e)&&Pt(t)?this.floatCmp(e,t):e===ft&&t===ft?0:FF(DF(lC(e)),DF(lC(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const r=[];for(const s of e)if(s instanceof Oe)r.push(s);else{const o=ve(this.coerceScalarToNumberOrError(s));if(o instanceof E)return o;r.push(o)}const i=[];for(const s of r)if(s instanceof Oe){const o=t(s.valuesFromTopLeftCorner());if(o instanceof E)return o;i.push(...o)}else i.push(s);return i}coerceStringToComplex(e){const t=jwe.exec(e);if(t===null)return new E(N.NUM,_.ComplexNumberExpected);let r;if(t[6]!==void 0?r=t[1]==="-"?[0,-1]:[0,1]:r=this.parseComplexToken(t[1]+t[3],t[5]),r instanceof E||t[8]===void 0)return r;let i;return t[14]!==void 0?i=t[9]==="-"?[0,-1]:[0,1]:i=this.parseComplexToken(t[9]+t[11],t[13]),i instanceof E?i:t[5]!==""||t[13]===""?new E(N.NUM,_.ComplexNumberExpected):t[8]==="+"?[r[0]+i[0],r[1]+i[1]]:[r[0]-i[0],r[1]-i[1]]}parseComplexToken(e,t){const r=ve(this.coerceNonDateScalarToMaybeNumber(e));return r===void 0?new E(N.NUM,_.ComplexNumberExpected):t===""?[r,0]:[0,r]}}function kn([n,e],t){if(!isFinite(n)||!isFinite(e))return new E(N.NUM,_.NaN);if(t=t??Gwe,e===0)return`${n}`;const r=`${e===-1||e===1?"":Math.abs(e)}${t}`;return n===0?`${e<0?"-":""}${r}`:`${n}${e<0?"-":"+"}${r}`}function gj(n){return n instanceof Oe?n:Oe.fromScalar(n)}function zN(n){return Number(n)}function HF(n){return typeof n=="string"?"":Pt(n)?0:typeof n=="boolean"?!1:ft}function pj(n){if(n instanceof E||typeof n=="boolean")return n;if(n===ft)return!1;if(Pt(n))return ve(n)!==0;{const e=n.toUpperCase();return e==="TRUE"?!0:e==="FALSE"||e===""?!1:void 0}}function YN(n){return n instanceof E||typeof n=="string"?n:n===ft?"":Pt(n)?ve(n).toString():n?"TRUE":"FALSE"}function wA(n){return n===ft?0:n}function FF(n,e){const t=ve(n),r=ve(e);return t>r?1:t<r?-1:0}function wj(n){return isNaN(n)||n===1/0||n===-1/0}function vj(n){return n===0?0:n}function _g(n){return["*","?"].includes(n)}const Ywe=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function xg(n){return Ywe.includes(n)}function Kwe(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);if(i==="~"){if(r==n.length-1){t+="~";continue}const s=n.charAt(r+1);_g(s)||xg(s)?(t+="\\"+s,r++):(t+=s,r++)}else _g(i)?t+="."+i:xg(i)?t+="\\"+i:e?t+=i:t+=i.toLowerCase()}return t}function qwe(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);_g(i)||xg(i)?t+="\\"+i:e?t+=i:t+=i.toLowerCase()}return t}function Xwe(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);_g(i)||xg(i)||e?t+=i:t+=i.toLowerCase()}return t}function kF(n,e){const{type:t,format:r}=sC(n),{type:i,format:s}=sC(e);if(t===Me.NUMBER_RAW)return{type:i,format:s};if(i===Me.NUMBER_RAW)return{type:t,format:r};if((t===Me.NUMBER_DATETIME||t===Me.NUMBER_DATE)&&(i===Me.NUMBER_DATETIME||i===Me.NUMBER_DATE))return{type:Me.NUMBER_RAW};if(t===Me.NUMBER_TIME){if(i===Me.NUMBER_DATE)return{type:Me.NUMBER_DATETIME,format:`${s} ${r}`};if(i===Me.NUMBER_DATETIME)return{type:Me.NUMBER_DATETIME,format:s}}if(i===Me.NUMBER_TIME){if(t===Me.NUMBER_DATE)return{type:Me.NUMBER_DATETIME,format:`${r} ${s}`};if(t===Me.NUMBER_DATETIME)return{type:Me.NUMBER_DATETIME,format:r}}return{type:t,format:r}}function VF(n,e){let{type:t,format:r}=sC(n),{type:i,format:s}=sC(e);return t===Me.NUMBER_PERCENT&&(t=Me.NUMBER_RAW,r=void 0),i===Me.NUMBER_PERCENT&&(i=Me.NUMBER_RAW,s=void 0),t===Me.NUMBER_RAW?{type:i,format:s}:i===Me.NUMBER_RAW?{type:t,format:r}:{type:Me.NUMBER_RAW}}function Zm(n){return yj(n.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function Wv(n,e){var t;if(n.isAdHoc())return(t=n.data[0])===null||t===void 0?void 0:t[0];const r=n.range;if(e.formulaAddress.sheet===r.sheet){if(r.width()===1){const i=e.formulaAddress.row-r.start.row;if(i>=0&&i<r.height())return n.data[i][0]}else if(r.height()===1){const i=e.formulaAddress.col-r.start.col;if(i>=0&&i<r.width())return n.data[0][i]}}}function yj(n,e){return n.normalize(e.toUpperCase())}var g;(function(n){n.STRING="STRING",n.NUMBER="NUMBER",n.BOOLEAN="BOOLEAN",n.SCALAR="SCALAR",n.NOERROR="NOERROR",n.RANGE="RANGE",n.INTEGER="INTEGER",n.COMPLEX="COMPLEX",n.ANY="ANY"})(g||(g={}));class st{constructor(e){this.coerceScalarToNumberOrError=t=>this.arithmeticHelper.coerceScalarToNumberOrError(t),this.runFunction=(t,r,i,s)=>{const o=this.evaluateArguments(t,r,i),a=o.map(([m,p])=>m),l=o.map(([m,p])=>p),u=this.buildMetadataForEachArgumentValue(a.length,i),h=r.arraysFlag&&!i.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(u,a.length))return new E(N.NA,_.WrongArgNumber);const[c,d]=h?this.calculateSizeOfVectorizedResultArray(a,u):[1,1];if(c===1&&d===1){const m=this.vectorizeAndBroadcastArgumentsIfNecessary(h,a,u,0,0);return this.calculateSingleCellOfResultArray(r,m,u,l,s,i.returnNumberType)}const f=[...Array(c).keys()].map(m=>[...Array(d).keys()].map(p=>{const v=this.vectorizeAndBroadcastArgumentsIfNecessary(h,a,u,m,p),y=this.calculateSingleCellOfResultArray(r,v,u,l,s,i.returnNumberType);if(y instanceof Oe)throw new Error("Function returning array cannot be vectorized.");return y}));return Oe.onlyValues(f)},this.runFunctionWithReferenceArgument=(t,r,i,s,o,a=()=>new E(N.NA,_.CellRefExpected))=>{if(t.length===0)return this.returnNumberWrapper(s(),i.returnNumberType);if(t.length>1)return new E(N.NA,_.WrongArgNumber);let l=t[0];for(;l.type===M.PARENTHESIS;)l=l.expression;let u;if(l.type===M.CELL_REFERENCE)u=l.reference.toSimpleCellAddress(r.formulaAddress);else if(l.type===M.CELL_RANGE||l.type===M.COLUMN_RANGE||l.type===M.ROW_RANGE)try{u=Le.fromAst(l,r.formulaAddress).start}catch{return new E(N.REF,_.CellRefExpected)}return u!==void 0?this.returnNumberWrapper(o(u),i.returnNumberType):this.runFunction(t,r,i,a)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const r=[];for(const i of e){const s=this.evaluateAst(i,t);if(s instanceof Oe)for(const o of s.valuesFromTopLeftCorner())r.push([o,!0]);else r.push([s,!1])}return r}coerceToType(e,t,r){let i;if(e instanceof Oe)switch(t.argumentType){case g.RANGE:case g.ANY:i=e;break;default:{const s=Wv(e,r);if(s===void 0)return;e=s}}if(!(e instanceof Oe))switch(t.argumentType){case g.INTEGER:case g.NUMBER:const s=this.coerceScalarToNumberOrError(e);if(!Pt(s)){i=s;break}const o=ve(s);if(t.maxValue!==void 0&&o>t.maxValue)return new E(N.NUM,_.ValueLarge);if(t.minValue!==void 0&&o<t.minValue)return new E(N.NUM,_.ValueSmall);if(t.lessThan!==void 0&&o>=t.lessThan)return new E(N.NUM,_.ValueLarge);if(t.greaterThan!==void 0&&o<=t.greaterThan)return new E(N.NUM,_.ValueSmall);if(t.argumentType===g.INTEGER&&!Number.isInteger(o))return new E(N.NUM,_.IntegerExpected);i=s;break;case g.STRING:i=YN(e);break;case g.BOOLEAN:i=pj(e);break;case g.SCALAR:case g.NOERROR:case g.ANY:i=e;break;case g.RANGE:if(e instanceof E)return e;i=gj(e);break;case g.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(ve(e))}return t.passSubtype||i===void 0?i:ve(i)}calculateSingleCellOfResultArray(e,t,r,i,s,o){const a=this.coerceArgumentsToRequiredTypes(e,t,r,i);if(a instanceof E)return a;const l=s(...a);return this.returnNumberWrapper(l,o)}coerceArgumentsToRequiredTypes(e,t,r,i){const s=[];for(let o=0;o<r.length;o++){const a=r[o],l=t[o]!==void 0?t[o]:a?.defaultValue;if(l===void 0){s.push(void 0);continue}const u=this.coerceToType(l,a,e);if(u===void 0&&!i[o])return new E(N.VALUE,_.WrongType);if(u instanceof E&&a.argumentType!==g.SCALAR)return u;s.push(u)}return s}vectorizeAndBroadcastArgumentsIfNecessary(e,t,r,i,s){return t.map((o,a)=>e&&this.isRangePassedAsAScalarArgument(o,r[a])?this.vectorizeAndBroadcastRangeArgument(o,i,s):o)}vectorizeAndBroadcastRangeArgument(e,t,r){var i;const s=e.height()===1?0:t,o=e.width()===1?0:r;return(i=e.data[s])===null||i===void 0?void 0:i[o]}evaluateArguments(e,t,r){return r.expandRanges?this.listOfScalarValues(e,t):e.map(i=>[this.evaluateAst(i,t),!1])}buildMetadataForEachArgumentValue(e,t){const r=t.parameters?[...t.parameters]:[];if(t.repeatLastArgs!==void 0&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>r.length;)r.push(...r.slice(r.length-t.repeatLastArgs));return r}isNumberOfArgumentValuesValid(e,t){return t>e.length?!1:t<e.length?e.slice(t).every(s=>s?.optionalArg||s?.defaultValue!==void 0):!0}calculateSizeOfVectorizedResultArray(e,t){const r=e.filter((o,a)=>this.isRangePassedAsAScalarArgument(o,t[a])),i=Math.max(1,...r.map(o=>o.height())),s=Math.max(1,...r.map(o=>o.width()));return[i,s]}isRangePassedAsAScalarArgument(e,t){return e==null||t==null?!1:e instanceof Oe&&![g.RANGE,g.ANY].includes(t.argumentType)}metadata(e){const t=this.constructor.implementedFunctions[e];if(t!==void 0)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,r){return t!==void 0&&Pt(e)?this.arithmeticHelper.ExtendedNumberFactory(ve(e),{type:t,format:r}):e}}class yt{constructor(e,t,r=!1){this.width=e,this.height=t,this.isRef=r}static error(){return new yt(1,1,!0)}static scalar(){return new yt(1,1,!1)}isScalar(){return this.width===1&&this.height===1||this.isRef}}function Qwe(n,e){return new yt(Math.max(n.width,e.width),Math.max(n.height,e.height))}function Zwe(n){return new yt(n.width,n.height)}class Jwe{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case M.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case M.COLUMN_RANGE:case M.ROW_RANGE:case M.CELL_RANGE:{const r=Le.fromAstOrUndef(e,t.formulaAddress);return r===void 0?yt.error():new yt(r.width(),r.height(),!0)}case M.ARRAY:{const r=[],i=[];for(const a of e.args){const l=a.map(c=>this.checkArraySizeForAst(c,t)),u=Math.min(...l.map(c=>c.height)),h=l.reduce((c,d)=>c+d.width,0);r.push(u),i.push(h)}const s=r.reduce((a,l)=>a+l,0),o=Math.min(...i);return new yt(o,s)}case M.STRING:case M.NUMBER:return yt.scalar();case M.CELL_REFERENCE:return new yt(1,1,!0);case M.DIV_OP:case M.CONCATENATE_OP:case M.EQUALS_OP:case M.GREATER_THAN_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.LESS_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.NOT_EQUAL_OP:case M.PLUS_OP:case M.POWER_OP:case M.TIMES_OP:{const r=this.checkArraySizeForAst(e.left,t),i=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(r.height>1||r.width>1||i.height>1||i.width>1)?yt.error():Qwe(r,i)}case M.MINUS_UNARY_OP:case M.PLUS_UNARY_OP:case M.PERCENT_OP:{const r=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(r.height>1||r.width>1)?yt.error():Zwe(r)}case M.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case M.EMPTY:return yt.error();default:return yt.error()}}checkArraySizeForFunction(e,t){const r=this.functionRegistry.getArraySizeFunction(e.procedureName);if(r!==void 0)return r(e,t);const i=this.functionRegistry.getMetadata(e.procedureName);if(i===void 0||i.expandRanges||!t.arraysFlag||i.vectorizationForbidden||i.parameters===void 0)return new yt(1,1);const s=e.args.map(u=>{var h;return this.checkArraySizeForAst(u,new ma(t.formulaAddress,t.arraysFlag||((h=i?.arrayFunction)!==null&&h!==void 0?h:!1)))}),o=[...i.parameters];if(i.repeatLastArgs!==void 0&&o.length<s.length&&(s.length-o.length)%i.repeatLastArgs!==0)return yt.error();for(;o.length<s.length;){if(i.repeatLastArgs===void 0)return yt.error();o.push(...o.slice(o.length-i.repeatLastArgs))}let a=1,l=1;for(let u=0;u<s.length;u++)o[u].argumentType!==g.RANGE&&o[u].argumentType!==g.ANY&&(l=Math.max(l,s[u].height),a=Math.max(a,s[u].width));return new yt(a,l)}}class Cj{constructor(e,t,r){var i;this.value=t,this.address=r,this.type=e.type,this.message=(i=e.message)!==null&&i!==void 0?i:""}toString(){return this.value}valueOf(){return this.value}}function Ut(n,e,t){if(typeof n>"u")return Hr.defaultConfig[t];if(typeof e=="string"){if(typeof n===e)return n;throw new _t(e,t)}else{if(e.includes(n))return n;throw new uj(e.map(r=>`'${r}'`).join(" "),t)}}function Xc(n,e,t){if(n<t)throw new aj(e,t)}function eve(n,e,t){if(n>t)throw new lj(e,t)}function Qw(n,e,t,r){if(e(n))return n;if(typeof n>"u")return Hr.defaultConfig[r];throw new _t(t,r)}function UF(...n){const e=new Map;n.forEach(r=>{const i=e.get(r.value)||[];i.push(r.name),e.set(r.value,i)});const t=[];for(const r of e.values())r.length>1&&t.push(r);if(t.length>0){t.forEach(i=>i.sort());const r=t.map(i=>`[${i}]`).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${r}`)}}function ce(n,e,t){if(typeof n!==e)throw new _t(e,t)}const r_=new RegExp("^ss(\\.(s+|0+))?$"),tve=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),nve=new RegExp("\\s+"),Sj=new RegExp("[ /.-]"),KN=":",BF=1e3,rve=Rj(ove),ive=Rj(ave);function sve(n,e,t){if(e===void 0&&t===void 0)return;let r=n.replace(nve," ").trim().toLowerCase();if(!lve(r))return;let i=r.substring(r.length-2);i==="am"||i==="pm"?r=r.substring(0,r.length-2).trim():(i=r.substring(r.length-1),i==="a"||i==="p"?r=r.substring(0,r.length-1).trim():i=void 0);const s=r.split(Sj);s.length>=2&&s[s.length-2].includes(KN)&&(s[s.length-2]=s[s.length-2]+"."+s[s.length-1],s.pop());const o=s[s.length-1].split(KN);if(i!==void 0&&o.push(i),s.length===1)return WF(o,t);if(o.length===1)return $F(s,e);const a=$F(s.slice(0,s.length-1),e),l=WF(o,t);if(a!==void 0)return l===void 0?void 0:Object.assign(Object.assign({},a),l)}function WF(n,e){var t,r,i;if(e===void 0)return;const{itemsCount:s,hourItem:o,minuteItem:a,secondItem:l}=rve(e);let u;if(n[n.length-1]==="am"||n[n.length-1]==="a"?(u=!1,n.pop()):(n[n.length-1]==="pm"||n[n.length-1]==="p")&&(u=!0,n.pop()),n.length!==s)return;const h=Number((t=n[l])!==null&&t!==void 0?t:"0");if(!Number.isFinite(h))return;const c=Math.round(h*BF)/BF,d=Number((r=n[a])!==null&&r!==void 0?r:"0");if(!(Number.isFinite(d)&&Number.isInteger(d)))return;const f=Number((i=n[o])!==null&&i!==void 0?i:"0");return!(Number.isFinite(f)&&Number.isInteger(f))||u!==void 0&&(f<0||f>12)?void 0:{hours:u!==void 0?f%12+(u?12:0):f,minutes:d,seconds:c}}function $F(n,e){var t;if(e===void 0)return;const{itemsCount:r,dayItem:i,monthItem:s,shortYearItem:o,longYearItem:a}=ive(e);if(n.length!==r)return;const l=Number(n[i]);if(!(Number.isFinite(l)&&Number.isInteger(l)))return;const u=Number(n[s]);if(!(Number.isFinite(u)&&Number.isInteger(u))||n[a]&&n[o])return;const h=Number((t=n[a])!==null&&t!==void 0?t:n[o]);if(Number.isFinite(h)&&Number.isInteger(h)&&!(n[a]&&(h<1e3||h>9999))&&!(n[o]&&(h<0||h>99)))return{year:h,month:u,day:l}}function ove(n){const e=n.toLowerCase().trim(),r=(e.endsWith("am/pm")?e.substring(0,e.length-5):e.endsWith("a/p")?e.substring(0,n.length-3):e).trim().split(KN);return{itemsCount:r.length,hourItem:r.indexOf("hh"),minuteItem:r.indexOf("mm"),secondItem:r.findIndex(i=>r_.test(i))}}function ave(n){const e=n.toLowerCase().trim().split(Sj);return{itemsCount:e.length,dayItem:e.indexOf("dd"),monthItem:e.indexOf("mm"),shortYearItem:e.indexOf("yy"),longYearItem:e.indexOf("yyyy")}}function lve(n){return tve.test(n)}function Rj(n){const e={};return t=>{const r=e[t];if(r!==void 0)return r;const i=n(t);return e[t]=i,i}}const qN=[31,28,31,30,31,30,31,31,30,31,30,31],Sd=[0,31,59,90,120,151,181,212,243,273,304,334],Zw=60,Jw=60,XN=24;function Jm(n){return n&&(typeof n=="object"||typeof n=="function")?"year"in n&&typeof n.year=="number"&&"month"in n&&typeof n.month=="number"&&"day"in n&&typeof n.day=="number":!1}function Ej(n){return n&&(typeof n=="object"||typeof n=="function")?"hours"in n&&typeof n.hours=="number"&&"minutes"in n&&typeof n.minutes=="number"&&"seconds"in n&&typeof n.seconds=="number":!1}const uve={year:9999,month:12,day:31};class hve{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(uve),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:r="",timeFormat:i=""}=this.parseDateTimeFromConfigFormats(e);if(t!==void 0)return Ej(t)?Jm(t)?new e_(Ld(t)+this.dateToNumber(t),r+" "+i):new JO(Ld(t),i):Jm(t)?new ZO(this.dateToNumber(t),r):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=qN[e.month-1]}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let r=Math.floor(t/365.2425);this.dateToNumberFromZero({year:r+1,month:1,day:1})<=t?r++:this.dateToNumberFromZero({year:r-1,month:1,day:1})>t&&r--;const i=t-this.dateToNumberFromZero({year:r,month:1,day:1}),s=cve(i-(this.isLeapYear(r)&&i>=59?1:0)),o=i-Sd[s]-(this.isLeapYear(r)&&s>1?1:0);return{year:r,month:s+1,day:o+1}}numberToSimpleDateTime(e){const t=Pd(e%1),r=Math.floor(t.hours/XN);t.hours=t.hours%XN;const i=this.numberToSimpleDate(Math.floor(e)+r);return Object.assign(Object.assign({},i),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&t===2?29:qN[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return e.day===31&&(e.day=30),e.day===30&&t.day===31&&(t.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,t.month===2&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,r){const i=this.parseDateTime(e,t,r);if(!(Jm(i)&&(i.year>=0&&i.year<100&&(i.year<this.getNullYear()?i.year+=2e3:i.year+=1900),!this.isValidDate(i))))return i}parseDateTimeFromFormats(e,t,r){const i=t.length===0?[void 0]:t,s=r.length===0?[void 0]:r;for(const o of i)for(const a of s){const l=this.parseSingleFormat(e,o,a);if(l!==void 0)return{dateTime:l,timeFormat:a,dateFormat:o}}return{}}countLeapDays(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+Sd[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}function cve(n){let e=0;return Sd[e+6]<=n&&(e+=6),Sd[e+3]<=n&&(e+=3),Sd[e+2]<=n?e+=2:Sd[e+1]<=n&&(e+=1),e}function GF(n,e){const t=12*n.year+n.month-1+e;return{year:Math.floor(t/12),month:t%12+1,day:n.day}}function dve(n){return{year:n.year,month:n.month,day:Math.min(n.day,qN[n.month-1])}}function vA(n){return Math.round(n*3600*24)/(3600*24)}function fve(n,e=1){return Math.round(n*e)/e}function Pd(n){const e=n*XN*Jw*Zw,t=fve(e%Zw,1e5)%Zw,r=(e-t)/Zw,i=Math.round(r%Jw)%Jw,s=(r-i)/Jw;return{hours:Math.round(s),minutes:i,seconds:t}}function Ld(n){return((n.seconds/60+n.minutes)/60+n.hours)/24}function jF(n){return{year:n.year,month:n.month,day:Math.min(30,n.day)}}class mve{call(){return Lwe}}const zF=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,YF=/(\\.|[#0]+(\.[#0]*)?)/g;var da;(function(n){n.FORMAT="FORMAT",n.FREE_TEXT="FREE_TEXT"})(da||(da={}));function ev(n,e){return{type:n,value:e}}var uC;(function(n){n.DATE="DATE",n.NUMBER="NUMBER",n.STRING="STRING"})(uC||(uC={}));function gve(n){zF.lastIndex=0;const e=[];let t;do t=zF.exec(n),t!==null&&e.push(t);while(t);return e}function pve(n){YF.lastIndex=0;const e=YF.exec(n);return e!==null?[e]:[]}function bj(n,e){const t=[];let r=0;for(let s=0;s<n.length;++s){const o=n[s];if(o.index!==r){const a=e.substr(r,o.index-r);t.push(ev(da.FREE_TEXT,a))}o[0].startsWith("\\")?t.push(ev(da.FREE_TEXT,o[0])):t.push(ev(da.FORMAT,o[0])),r=o.index+o[0].length}const i=n[n.length-1];if(i.index+i[0].length<e.length){const s=e.substr(i.index+i[0].length,e.length);t.push(ev(da.FREE_TEXT,s))}return t}function Tj(n){const e=gve(n);if(!e.every(t=>Aj(t)))return{type:uC.DATE,tokens:bj(e,n)}}function wve(n){const e=pve(n);if(!e.every(t=>Aj(t)))return{type:uC.NUMBER,tokens:bj(e,n)}}function Aj(n){return n[0].startsWith("\\")}function vve(n,e,t,r){const i=t.stringifyDateTime(r.numberToSimpleDateTime(n),e);if(i!==void 0)return i;const s=t.stringifyDuration(Pd(n),e);if(s!==void 0)return s;const o=wve(e);return o!==void 0?Cve(o.tokens,n):e}function Pi(n,e){let t=`${n}`;for(;t.length<e;)t="0"+t;return t}function yve(n,e){let t=`${n}`;for(;t.length<e;)t=t+"0";return t}function KF(n,e){return n.split(e).length-1}function Cve(n,e){let t="";for(let r=0;r<n.length;++r){const i=n[r];if(i.type===da.FREE_TEXT){t+=i.value;continue}const s=i.value.split("."),o=s[0],a=s[1]||"",l=s[1]?".":"",u=Number(e.toFixed(a.length)).toString().split(".");let h=u[0]||"",c=u[1]||"";if(o.length>h.length){const f=KF(o.substr(0,o.length-h.length),"0");h=Pi(h,f+h.length)}const d=KF(a.substr(c.length,a.length-c.length),"0");c=yve(c,d+c.length),t+=h+l+c}return t}function Sve(n,e){const t=Tj(e);if(t===void 0)return;const r=t.tokens;let i="";for(const s of r){if(s.type===da.FREE_TEXT){i+=s.value;continue}switch(s.value.toLowerCase()){case"h":case"hh":{i+=Pi(n.hours,s.value.length),n.hours=0;break}case"[hh]":{i+=Pi(n.hours,s.value.length-2),n.hours=0;break}case"m":case"mm":{i+=Pi(n.minutes,s.value.length),n.minutes=0;break}case"[mm]":{i+=Pi(n.minutes+60*n.hours,s.value.length-2),n.minutes=0,n.hours=0;break}case"s":case"ss":{i+=Pi(Math.floor(n.seconds),s.value.length);break}default:{if(r_.test(s.value)){const o=Math.max(s.value.length-3,0);i+=`${n.seconds<10?"0":""}${Math.floor(n.seconds*Math.pow(10,o))/Math.pow(10,o)}`;continue}return}}}return i}function Rve(n,e){const t=Tj(e);if(t===void 0)return;const r=t.tokens;let i="",s=!1;const o=r.some(a=>a.type===da.FORMAT&&(a.value==="a/p"||a.value==="A/P"||a.value==="am/pm"||a.value==="AM/PM"));for(let a=0;a<r.length;a++){const l=r[a];if(l.type===da.FREE_TEXT){i+=l.value;continue}switch(l.value.toLowerCase()){case"h":case"hh":{s=!0,i+=Pi(o?(n.hours+11)%12+1:n.hours,l.value.length);break}case"d":case"dd":{i+=Pi(n.day,l.value.length);break}case"s":case"ss":{i+=Pi(Math.floor(n.seconds),l.value.length);break}case"m":case"mm":{a+1<r.length&&r[a+1].value.startsWith(":")&&(s=!0),s?i+=Pi(n.minutes,l.value.length):i+=Pi(n.month,l.value.length),s=!0;break}case"yy":{i+=Pi(n.year%100,l.value.length);break}case"yyyy":{i+=n.year;break}case"am/pm":case"a/p":{const[u,h]=l.value.split("/");i+=n.hours<12?u:h;break}default:{if(r_.test(l.value)){const u=l.value.length-3;i+=`${n.seconds<10?"0":""}${Math.floor(n.seconds*Math.pow(10,u))/Math.pow(10,u)}`;continue}return}}}return i}const QN="length",eg=n=>parseInt(n,16),qF=n=>parseInt(n,10),yA=n=>(n+"").replace(/\-/g,""),hC=(n,e,t)=>n.substr(e,t),io=n=>n.codePointAt(0)-65;function Eve(n){return yA(n)[QN]===25?eg(hC(yA(n),eg("12"),io("F")))/(eg(hC(yA(n),io("C"),io("Y")>>4))||(~~![][QN]<<3)+1):0}function bve(n){if(n=(n+"").replace(/\-/g,""),n[QN]!==io("Z"))return!1;let e=0;return[[0,io("G")+1],[io("H"),io("H")-1],[io("G")+io("H"),io("G")]].reduce((t,[r,i],s)=>(t|=(qF(`${qF(eg(hC(n,e+r-(s===0?0:2),i+(s?2:0)))+(eg(hC(n,e+r+i,2))+[]).padStart(2,"0"))}`)%97||2)>>1,e+=2,t),io("A"))==="1">>1}const Tve={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:n})=>`The license key for HyperFormula expired on ${n}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let XF=!1;function Ave(n){const e={template:"missing",vars:{}};if(n==="gpl-v3"||n==="internal-use-in-handsontable")e.template="valid";else if(typeof n=="string"&&bve(n)){const[t,r,i]="18/07/2024".split("/"),s=Math.floor(new Date(`${r}/${t}/${i}`).getTime()/864e5),o=Eve(n);e.vars.keyValidityDate=Nve(new Date((o+1)*864e5)),s>o?e.template="expired":e.template="valid"}else n!==""&&(e.template="invalid");return!XF&&e.template!=="valid"&&(console.warn(Tve[e.template](e.vars)),XF=!0),e.template}function Nve(n){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][n.getMonth()],r=n.getDate(),i=n.getFullYear();return`${t} ${r}, ${i}`}var En;(function(n){class e{constructor(l){this.value=l,this.value=QO(this.value,vj(ve(this.value)))}}n.Number=e;class t{constructor(l){this.value=l}}n.String=t;class r{constructor(l){this.value=l}}n.Boolean=r;class i{static getSingletonInstance(){return i.instance||(i.instance=new i),i.instance}}n.Empty=i;class s{constructor(l){this.formula=l}}n.Formula=s;class o{constructor(l,u){this.value=new E(l,u)}}n.Error=o})(En||(En={}));function Ive(n){return n.startsWith("=")}function Mve(n){const e=n.toLowerCase();return e==="true"||e==="false"}function Ove(n,e){const t=n.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(t)&&Object.prototype.hasOwnProperty.call(e,t)}class _ve{constructor(e,t,r){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=r}parse(e){if(e==null)return En.Empty.getSingletonInstance();if(typeof e=="number")return wj(e)?new En.Error(N.NUM,_.ValueLarge):new En.Number(e);if(typeof e=="boolean")return new En.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),r=Ld({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),i=t+r;return i<0?new En.Error(N.NUM,_.DateBounds):i%1===0?new En.Number(new ZO(i,"Date()")):i<1?new En.Number(new JO(i,"Date()")):new En.Number(new e_(i,"Date()"))}else if(typeof e=="string"){if(Mve(e))return new En.Boolean(e.toLowerCase()==="true");if(Ive(e))return new En.Formula(e);if(Ove(e,this.config.errorMapping))return new En.Error(this.config.errorMapping[e.toUpperCase()]);{let t=e.trim(),r=0,i;if(t.endsWith("%"))r=1,t=t.slice(0,t.length-1);else{const a=this.currencyMatcher(t);a!==void 0&&(r=2,[i,t]=a)}const s=this.numberLiteralsHelper.numericStringToMaybeNumber(t);if(s!==void 0){let a;return r===1?a=new Vv(s/100):r===2?a=new WN(s,i):a=s,new En.Number(a)}const o=this.dateHelper.dateStringToDateNumber(t);return o!==void 0?new En.Number(o):new En.String(e.startsWith("'")?e.slice(1):e)}}else throw new oj(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}var Th;(function(n){n[n.COPY=0]="COPY",n[n.CUT=1]="CUT"})(Th||(Th={}));var Lr;(function(n){n[n.VALUE=0]="VALUE",n[n.EMPTY=1]="EMPTY",n[n.FORMULA=2]="FORMULA",n[n.PARSING_ERROR=3]="PARSING_ERROR"})(Lr||(Lr={}));class QF{constructor(e,t,r,i,s){this.sourceLeftCorner=e,this.width=t,this.height=r,this.type=i,this.content=s}*getContent(e){if(this.content!==void 0)for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r)yield[Ce(e.sheet,e.col+r,e.row+t),this.content[t][r]]}}class xve{constructor(e,t,r){this.dependencyGraph=t,this.operations=r,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,r){this.clipboard=new QF(e,t,r,Th.CUT)}copy(e,t,r){const i=[];for(let s=0;s<r;++s){i[s]=[];for(let o=0;o<t;++o){const a=this.operations.getClipboardCell(Ce(e.sheet,e.col+o,e.row+s));i[s].push(a)}}this.clipboard=new QF(e,t,r,Th.COPY,i)}abortCut(){this.clipboard&&this.clipboard.type===Th.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(this.clipboard===void 0)return;if(Di(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new rr("a valid target address.");const t=Le.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Vh;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return this.clipboard!==void 0&&this.clipboard.type===Th.CUT}isCopyClipboard(){return this.clipboard!==void 0&&this.clipboard.type===Th.COPY}}class cC{constructor(e,t,r,i){this.displayName=e,this.address=t,this.added=r,this.options=i}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new cC(this.displayName,this.address,this.added,this.options)}}class Pve{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);return!(r&&r.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));if(t&&t.added)return t}remove(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);r&&(r.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class ZF{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class Jh{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new Pve,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var r,i;return t===void 0?this.workbookStore.isNameAvailable(e):(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.isNameAvailable(e))!==null&&i!==void 0?i:!0}namedExpressionInAddress(e){const t=this.addressCache.get(e);if(t&&t.added)return t}namedExpressionForScope(e,t){var r;return t===void 0?this.workbookStore.getExisting(e):(r=this.worksheetStore(t))===null||r===void 0?void 0:r.get(e)}nearestNamedExpression(e,t){var r,i;return(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.get(e))!==null&&i!==void 0?i:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var r,i;return(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.has(e))!==null&&i!==void 0?i:!1}isNameValid(e){const t=new RegExp(`^${W$}$`),r=new RegExp(`^${$$}$`),i=new RegExp(`^${G$}$`);return t.test(e)||r.test(e)?!1:i.test(e)}addNamedExpression(e,t,r){const i=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);let s=i.get(e);return s!==void 0?(s.added=!0,s.displayName=e,s.options=r):(s=new cC(e,this.nextAddress(),!0,r),i.add(s)),this.addressCache.set(s.address.row,s),s}restoreNamedExpression(e,t){const r=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,r.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var r;return(r=this.worksheetStoreOrCreate(t).get(e))!==null&&r!==void 0?r:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return t===void 0&&(t=new cC(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let r;t===void 0?r=this.workbookStore:r=this.worksheetStore(t);const i=r?.get(e);if(r===void 0||i===void 0||!i.added)throw Error("Named expression does not exist");r.remove(e),r instanceof ZF&&r.mapping.size===0&&this.worksheetStores.delete(t),this.addressCache.delete(i.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:t})=>t===e).map(t=>t.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:void 0})}),this.worksheetStores.forEach((t,r)=>{t.getAllNamedExpressions().forEach(i=>{e.push({expression:i,scope:r})})}),e}getAllNamedExpressionsForScope(e){var t,r;return e===void 0?this.workbookStore.getAllNamedExpressions():(r=(t=this.worksheetStores.get(e))===null||t===void 0?void 0:t.getAllNamedExpressions())!==null&&r!==void 0?r:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new ZF,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return Ce(Jh.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}Jh.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const Kl=n=>{switch(n.type){case M.EMPTY:case M.NUMBER:case M.STRING:case M.ERROR:case M.ERROR_WITH_RAW_INPUT:return!1;case M.CELL_REFERENCE:return!n.reference.isAbsolute();case M.CELL_RANGE:case M.COLUMN_RANGE:case M.ROW_RANGE:return!n.start.isAbsolute();case M.NAMED_EXPRESSION:return!1;case M.PERCENT_OP:case M.PLUS_UNARY_OP:case M.MINUS_UNARY_OP:return Kl(n.value);case M.CONCATENATE_OP:case M.EQUALS_OP:case M.NOT_EQUAL_OP:case M.LESS_THAN_OP:case M.GREATER_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.PLUS_OP:case M.TIMES_OP:case M.DIV_OP:case M.POWER_OP:return Kl(n.left)||Kl(n.right);case M.PARENTHESIS:return Kl(n.expression);case M.FUNCTION_CALL:return n.args.some(e=>Kl(e));case M.ARRAY:return n.args.some(e=>e.some(t=>Kl(t)))}};class Mu{performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[i,s]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService)),o=t.rememberNewAst(i);r.setFormula(o),r.setAddress(s)}}transformSingleAst(e,t){const r=this.transformAst(e,t),i=this.fixNodeAddress(t);return[r,i]}transformAst(e,t){switch(e.type){case M.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case M.CELL_RANGE:return this.transformCellRangeAst(e,t);case M.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case M.ROW_RANGE:return this.transformRowRangeAst(e,t);case M.EMPTY:case M.ERROR:case M.NUMBER:case M.NAMED_EXPRESSION:case M.ERROR_WITH_RAW_INPUT:case M.STRING:return e;case M.PERCENT_OP:case M.MINUS_UNARY_OP:case M.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case M.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(r=>this.transformAst(r,t))});case M.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case M.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(r=>r.map(i=>this.transformAst(i,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const r=this.transformCellAddress(e.reference,t);return r instanceof sn?Object.assign(Object.assign({},e),{reference:r}):r===N.REF?ra(new E(N.REF)):e}transformCellRangeAst(e,t){const r=this.transformCellRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===N.REF?ra(new E(N.REF)):e}transformColumnRangeAst(e,t){const r=this.transformColumnRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===N.REF?ra(new E(N.REF)):e}transformRowRangeAst(e,t){const r=this.transformRowRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===N.REF?ra(new E(N.REF)):e}}class Lve extends Mu{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=po(e,t);if(r!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const i=e.toSimpleColumnAddress(t);return r===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=i.col?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1:t.sheet===this.columnsSpan.sheet&&r!==this.columnsSpan.sheet?e.isColumnAbsolute()||t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?e.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i===N.REF||s===N.REF?N.REF:i||s?[i||e,s||t]:!1}}class ZN extends Mu{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}transformCellAddress(e,t){const r=po(e,t);if(r!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const i=e.toSimpleRowAddress(t);return r===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=i.row?e.shiftedByRows(this.rowsSpan.numberOfRows):!1:t.sheet===this.rowsSpan.sheet&&r!==this.rowsSpan.sheet?e.isRowAbsolute()||t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?e.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(this.rowsSpan.numberOfRows):i.row<this.rowsSpan.rowStart?t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart?e.shiftedByRows(this.rowsSpan.numberOfRows):!1}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i===N.REF||s===N.REF?N.REF:i||s?[i||e,s||t]:!1}}class Dve extends Mu{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return e.isInvalid(t)?N.REF:!1}transformCellRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?N.REF:!1}transformColumnRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?N.REF:!1}transformRowRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?N.REF:!1}}class Hve extends Mu{constructor(e,t,r,i){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=i,this.dependentFormulaTransformer=new Fve(e,t,r,i)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return Ce(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformAddress(e,t){const r=this.sourceRange;if(e instanceof sn){const i=e.toSimpleCellAddress(t);if(r.addressInRange(i))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,r){const i=this.sourceRange;if(e instanceof sn&&t instanceof sn){const s=e.toSimpleCellAddress(r),o=t.toSimpleCellAddress(r);if(i.addressInRange(s)&&i.addressInRange(o))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class Fve extends Mu{constructor(e,t,r,i){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=i}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.shouldMove(e,t)?e.moved(this.toSheet,this.toRight,this.toBottom):!1}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}shouldMove(e,t){return e instanceof sn?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof qr?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i&&s?[i,s]:!1}}class kve extends Mu{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=po(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==r)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===r){const i=e.toSimpleColumnAddress(t);if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==r){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===r)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const i=e.toSimpleColumnAddress(t);if(i.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(i.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return N.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const i=po(e,r);let s=e,o=t;if(this.columnsSpan.sheet===i){const u=e.toSimpleColumnAddress(r),h=t.toSimpleColumnAddress(r);if(this.columnsSpan.columnStart<=u.col&&this.columnsSpan.columnEnd>=h.col)return N.REF;u.col>=this.columnsSpan.columnStart&&u.col<=this.columnsSpan.columnEnd&&(s=e.shiftedByColumns(this.columnsSpan.columnEnd-u.col+1)),h.col>=this.columnsSpan.columnStart&&h.col<=this.columnsSpan.columnEnd&&(o=t.shiftedByColumns(-(h.col-this.columnsSpan.columnStart+1)))}const a=this.transformCellAddress(s,r),l=this.transformCellAddress(o,r);if(a===!1&&l===!1)return[s,o];if(a===N.REF||l===N.REF)throw Error("Cannot happen");return[a||s,l||o]}}class JN extends Mu{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const r=po(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==r)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===r){const i=e.toSimpleRowAddress(t);if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==r){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===r)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const i=e.toSimpleRowAddress(t);if(i.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(i.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return N.REF}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const i=po(e,r);let s=e,o=t;if(this.rowsSpan.sheet===i){const u=e.toSimpleRowAddress(r),h=t.toSimpleRowAddress(r);if(this.rowsSpan.rowStart<=u.row&&this.rowsSpan.rowEnd>=h.row)return N.REF;u.row>=this.rowsSpan.rowStart&&u.row<=this.rowsSpan.rowEnd&&(s=e.shiftedByRows(this.rowsSpan.rowEnd-u.row+1)),h.row>=this.rowsSpan.rowStart&&h.row<=this.rowsSpan.rowEnd&&(o=t.shiftedByRows(-(h.row-this.rowsSpan.rowStart+1)))}const a=this.transformCellAddress(s,r),l=this.transformCellAddress(o,r);return a===!1&&l===!1?[s,o]:a===N.REF||l===N.REF?N.REF:[a||s,l||o]}}class Vve extends Mu{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[i]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService));r.setFormula(i)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,r){return this.transformAddress(e)}transformColumnRange(e,t,r){return this.transformAddress(e)}transformRowRange(e,t,r){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet?N.REF:!1}}function Nj(n){if(!Array.isArray(n))throw new rr("an array of arrays.");for(let e=0;e<n.length;e++)if(!Array.isArray(n[e]))throw new rr("an array of arrays.")}function dC(n){let e=0,t=0,r=0;for(let s=0;s<n.length;s++){let o=0;for(let a=0;a<n[s].length;a++){const l=n[s][a];l!=null&&(o=a+1,++r)}e=Math.max(e,o),o>0&&(t=s+1)}const i=e*t;return{height:t,width:e,fill:i===0?0:r/i}}class Ij{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return fC(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Hi.fromNumberOfRows(this.sheet,e[0],e[1]))}}class Mj{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return mC(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Hi.fromNumberOfRows(this.sheet,e[0],e[1]))}}class Oj{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return mC(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>es.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class _j{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return fC(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>es.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class Uve{constructor(e,t,r,i,s,o,a,l,u){this.dependencyGraph=t,this.columnSearch=r,this.cellContentParser=i,this.parser=s,this.stats=o,this.lazilyTransformingAstService=a,this.namedExpressions=l,this.arraySizePredictor=u,this.changes=gu.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const r of e.rowsSpans()){const i=this.doRemoveRows(r);i&&t.push(i)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const r of e.columnsSpans()){const i=this.doRemoveColumns(r);i&&t.push(i)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t=0;this.stats.measure(tt.TRANSFORM_ASTS,()=>{const i=new Vve(e);i.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(i)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const r=this.namedExpressions.getAllNamedExpressionsForScope(e).map(i=>this.removeNamedExpression(i.normalizeExpressionName(),e));return{version:t,scopedNamedExpressions:r}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e),r=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,dC(r)),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,r,i){const s=Hi.fromNumberOfRows(e,i,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(s),i<t&&(t+=r);const o=Ce(e,0,t),a=Ce(e,0,i);this.moveCells(o,Number.POSITIVE_INFINITY,r,a);const l=Hi.fromNumberOfRows(e,t,r);return this.doRemoveRows(l),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,r,i){const s=es.fromNumberOfColumns(e,i,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(s),i<t&&(t+=r);const o=Ce(e,t,0),a=Ce(e,i,0);this.moveCells(o,r,Number.POSITIVE_INFINITY,a);const l=es.fromNumberOfColumns(e,t,r);return this.doRemoveColumns(l),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,r,i){this.ensureItIsPossibleToMoveCells(e,t,r,i);const s=Le.spanFrom(e,t,r),o=Le.spanFrom(i,t,r),a=i.col-e.col,l=i.row-e.row,u=i.sheet,h=this.getRangeClipboardCells(o),c=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.removeValues(c);const d=this.dependencyGraph.rawValuesFromRange(s);this.columnSearch.moveValues(d,a,l,u);let f=0;this.stats.measure(tt.TRANSFORM_ASTS,()=>{const p=new Hve(s,a,l,u);p.performEagerTransformations(this.dependencyGraph,this.parser),f=this.lazilyTransformingAstService.addTransformation(p)}),this.dependencyGraph.moveCells(s,a,l,u);const m=this.updateNamedExpressionsForMovedCells(e,t,r,i);return{version:f,overwrittenCellsData:h,addedGlobalNamedExpressions:m}}setRowOrder(e,t){const r=[];let i=[];for(const[s,o]of t)if(s!==o){const a=Le.spanFrom({sheet:e,col:0,row:s},1/0,1),l=this.getRangeClipboardCells(a);i=i.concat(l),r.push(l.map(([{sheet:u,col:h},c])=>[{sheet:u,col:h,row:o},c]))}return r.forEach(s=>this.restoreClipboardCells(e,s.values())),i}setColumnOrder(e,t){const r=[];let i=[];for(const[s,o]of t)if(s!==o){const a=Le.spanFrom({sheet:e,col:s,row:0},1,1/0),l=this.getRangeClipboardCells(a);i=i.concat(l),r.push(l.map(([{sheet:u,col:h,row:c},d])=>[{sheet:u,col:o,row:c},d]))}return r.forEach(s=>this.restoreClipboardCells(e,s.values())),i}addNamedExpression(e,t,r,i){const s=this.namedExpressions.addNamedExpression(e,r,i);this.storeNamedExpressionInCell(s.address,t),this.adjustNamedExpressionEdges(s,e,r)}restoreNamedExpression(e,t,r){const i=e.displayName;this.restoreCell(e.address,t);const s=this.namedExpressions.restoreNamedExpression(e,r);this.adjustNamedExpressionEdges(s,i,r)}changeNamedExpressionExpression(e,t,r,i){const s=this.namedExpressions.namedExpressionForScope(e,r);if(!s)throw new Ig(e);const o=s.copy();s.options=i;const a=this.getClipboardCell(s.address);return this.storeNamedExpressionInCell(s.address,t),[o,a]}removeNamedExpression(e,t){const r=this.namedExpressions.namedExpressionForScope(e,t);if(!r)throw new Ig(e);this.namedExpressions.remove(r.displayName,t);const i=this.getClipboardCell(r.address);if(t!==void 0){const s=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(r.address,s.address)}else this.dependencyGraph.setCellEmpty(r.address);return[r,i]}ensureItIsPossibleToMoveCells(e,t,r,i){if(Di(e)||!(gC(t)&&gC(r)||Bve(e,t,r))||Di(i)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(i.sheet))throw new rr("a valid range of cells to move.");const s=Le.spanFrom(e,t,r),o=Le.spanFrom(i,t,r);if(o.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Vh;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new Cd;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new oC}restoreClipboardCells(e,t){const r=[];for(const[i,s]of t)if(this.restoreCell(i,s),s.type===Lr.FORMULA){const{dependencies:o}=this.parser.fetchCachedResult(s.hash);r.push(...this.updateNamedExpressionsForTargetAddress(e,i,o))}return r}restoreCell(e,t){switch(t.type){case Lr.VALUE:{this.setValueToCell(t,e);break}case Lr.FORMULA:{this.setFormulaToCellFromCache(t.hash,e);break}case Lr.EMPTY:{this.setCellEmpty(e);break}case Lr.PARSING_ERROR:{this.setParsingErrorToCell(t.rawInput,t.errors,e);break}}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof tu)return[e,{type:Lr.EMPTY}];if(t instanceof pu)return[e,Object.assign({type:Lr.VALUE},t.getValues())];if(t instanceof ts)return[t.getAddress(this.lazilyTransformingAstService),{type:Lr.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof xd)return[e,{type:Lr.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof tu)return{type:Lr.EMPTY};if(t instanceof pu)return Object.assign({type:Lr.VALUE},t.getValues());if(t instanceof Xn){const r=t.getArrayCellValue(e);return r===ft?{type:Lr.EMPTY}:{type:Lr.VALUE,parsedValue:r,rawValue:t.getArrayCellRawValue(e)}}else{if(t instanceof ca)return{type:Lr.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof xd)return{type:Lr.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}}throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),i=new Array(t);for(let s=0;s<t;s++){i[s]=new Array(r);for(let o=0;o<r;o++){const a=Ce(e,o,s);i[s][o]=this.getClipboardCell(a)}}return i}getRangeClipboardCells(e){const t=[];for(const r of e.addresses(this.dependencyGraph))t.push([r,this.getClipboardCell(r)]);return t}setCellContent(e,t){const r=this.cellContentParser.parse(t),i=this.getOldContent(e);if(r instanceof En.Formula){const s=this.parser.parse(r.formula,e),{ast:o,errors:a}=s;if(a.length>0)this.setParsingErrorToCell(r.formula,a,e);else try{const l=this.arraySizePredictor.checkArraySize(o,e);if(l.width<=0||l.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,l,s)}catch(l){if(!l.message)throw l;const u={type:Un.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(r.formula,[u],e)}}else r instanceof En.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e);return i}setSheetContent(e,t){this.clearSheet(e);for(let r=0;r<t.length;r++)for(let i=0;i<t[r].length;i++){const s=Ce(e,i,r);this.setCellContent(s,t[r][i])}}setParsingErrorToCell(e,t,r){const i=this.dependencyGraph.getCellValue(r),s=new xd(t,e),o=this.dependencyGraph.setParsingErrorToCell(r,s);this.columnSearch.remove(ve(i),r),this.columnSearch.applyChanges(o.getChanges()),this.changes.addAll(o),this.changes.addChange(s.getCellValue(),r)}setFormulaToCell(e,t,{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}){const a=this.dependencyGraph.getCellValue(e),l=this.dependencyGraph.setFormulaToCell(e,r,ia(o,e),t,i,s);this.columnSearch.remove(ve(a),e),this.columnSearch.applyChanges(l.getChanges()),this.changes.addAll(l)}setValueToCell(e,t){const r=this.dependencyGraph.getCellValue(t),i=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(ve(r),ve(e.parsedValue),t),this.columnSearch.applyChanges(i.getChanges().filter(s=>!Og(s.address,t))),this.changes.addAll(i),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),r=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(ve(t),e),this.columnSearch.applyChanges(r.getChanges()),this.changes.addAll(r),this.changes.addChange(ft,e)}setFormulaToCellFromCache(e,t){const{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}=this.parser.fetchCachedResult(e),a=ia(o,t),[l]=new Dve(t.sheet).transformSingleAst(r,t);this.parser.rememberNewAst(l);const u=fwe(a),h=this.arraySizePredictor.checkArraySize(r,t);this.dependencyGraph.setFormulaToCell(t,l,u,h,i,s)}rowEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getHeight(t);return e>=r}getAndClearContentChanges(){const e=this.changes;return this.changes=gu.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:r,contentChanges:i}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(i.getChanges());let s=0;return this.stats.measure(tt.TRANSFORM_ASTS,()=>{const o=new JN(e);o.performEagerTransformations(this.dependencyGraph,this.parser),s=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(r),{version:s,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:r,contentChanges:i}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(i.getChanges()),this.columnSearch.removeColumns(e);let s=0;return this.stats.measure(tt.TRANSFORM_ASTS,()=>{const o=new kve(e);o.performEagerTransformations(this.dependencyGraph,this.parser),s=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(r),{version:s,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(tt.TRANSFORM_ASTS,()=>{const r=new ZN(e);r.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(r)}),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const r=t.getFormula(this.lazilyTransformingAstService),i=t.getAddress(this.lazilyTransformingAstService),s=this.parser.computeHashFromAst(r);this.setFormulaToCellFromCache(s,i)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:r}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(r.getChanges()),this.stats.measure(tt.TRANSFORM_ASTS,()=>{const i=new Lve(e);i.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(i)}),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getWidth(t);return e>=r}adjustNamedExpressionEdges(e,t,r){if(r===void 0)return;const{vertex:i,id:s}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=s??this.dependencyGraph.graph.getNodeId(i),a=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:l,id:u}=this.dependencyGraph.fetchCellOrCreateEmpty(a.address),h=u??this.dependencyGraph.graph.getNodeId(l);for(const c of this.dependencyGraph.graph.adjacentNodes(l))if(c instanceof ca&&c.getAddress(this.lazilyTransformingAstService).sheet===r){const d=c.getFormula(this.lazilyTransformingAstService),f=c.getAddress(this.lazilyTransformingAstService),{dependencies:m}=this.parser.fetchCachedResultForAst(d);for(const p of ia(m,f))p instanceof al&&p.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(h,c),this.dependencyGraph.graph.addEdge(o,c))}}storeNamedExpressionInCell(e,t){const r=this.cellContentParser.parse(t);if(r instanceof En.Formula){const i=this.parser.parse(r.formula,Ce(-1,0,0));if(Kl(i.ast))throw new t_;const{ast:s,hasVolatileFunction:o,hasStructuralChangeFunction:a,dependencies:l}=i;this.dependencyGraph.setFormulaToCell(e,s,ia(l,e),yt.scalar(),o,a)}else r instanceof En.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,r,i){if(e.sheet===i.sheet)return[];const s=[],o=Le.spanFrom(i,t,r);for(const a of o.addresses(this.dependencyGraph)){const l=this.addressMapping.fetchCell(a);if(l instanceof ca&&a.sheet!==e.sheet){const u=l.getFormula(this.lazilyTransformingAstService),{dependencies:h}=this.parser.fetchCachedResultForAst(u);s.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,a,h))}}return s}updateNamedExpressionsForTargetAddress(e,t,r){if(e===t.sheet)return[];const i=[],s=this.addressMapping.fetchCell(t);for(const o of ia(r,t)){if(!(o instanceof al))continue;const a=o.name,l=this.dependencyGraph.fetchNamedExpressionVertex(a,e).vertex,h=this.namedExpressions.isExpressionInScope(a,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(a,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(a,l,i);h!==l&&(this.dependencyGraph.graph.removeEdgeIfExists(l,s),this.dependencyGraph.graph.addEdge(h,s))}return i}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(Jh.SHEET_FOR_WORKBOOK_EXPRESSIONS,new Pwe(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,r){let i=this.namedExpressions.namedExpressionForScope(e);if(i===void 0)if(i=this.namedExpressions.addNamedExpression(e),r.push(i.normalizeExpressionName()),t instanceof ca){const s=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:u}=s;this.dependencyGraph.setFormulaToCell(i.address,o,ia(u,i.address),yt.scalar(),a,l)}else t instanceof tu?this.setCellEmpty(i.address):t instanceof pu&&this.setValueToCell(t.getValues(),i.address);return this.dependencyGraph.fetchCellOrCreateEmpty(i.address).vertex}}function fC(n){if(n.length<=1)return n;const e=[...n].sort(([i],[s])=>i-s),t=e.reduce((i,[s,o])=>{const a=i[i.length-1],l=a[0]+a[1];return s<=l?a[1]+=Math.max(0,o-(l-s)):i.push([s,o]),i},[e[0]]);let r=0;for(let i=0;i<t.length;++i)t[i][0]-=r,r+=t[i][1];return t}function mC(n){if(n.length<=1)return n;const e=[...n].sort(([i],[s])=>i-s),t=e.reduce((i,[s,o])=>{const a=i[i.length-1];return s===a[0]?a[1]=Math.max(a[1],o):i.push([s,o]),i},[e[0]]);let r=0;for(let i=0;i<t.length;++i)t[i][0]+=r,r+=t[i][1];return t}function gC(n){return Number.isInteger(n)&&n>0}function Bve(n,e,t){return n.row===0&&gC(e)&&t===Number.POSITIVE_INFINITY||n.col===0&&gC(t)&&e===Number.POSITIVE_INFINITY}class or{}class Wve extends or{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class $ve extends or{constructor(e,t,r,i,s,o,a){super(),this.sourceLeftCorner=e,this.width=t,this.height=r,this.destinationLeftCorner=i,this.overwrittenCellsData=s,this.addedGlobalNamedExpressions=o,this.version=a}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class Gve extends or{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class jve extends or{constructor(e,t,r){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=r}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class zve extends or{constructor(e,t,r){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=r}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class Yve extends or{constructor(e,t,r){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=r}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class Kve extends or{constructor(e,t,r,i,s){super(),this.sheet=e,this.startRow=t,this.numberOfRows=r,this.targetRow=i,this.version=s,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class qve extends or{constructor(e,t,r,i,s){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=r,this.targetColumn=i,this.version=s,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class Xve extends or{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class Qve extends or{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class Zve extends or{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class Jve extends or{constructor(e,t,r,i,s){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=r,this.scopedNamedExpressions=i,this.version=s}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class eye extends or{constructor(e,t,r){super(),this.sheetId=e,this.oldName=t,this.newName=r}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class tye extends or{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class nye extends or{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class rye extends or{constructor(e,t,r,i){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=r,this.addedGlobalNamedExpressions=i}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class iye extends or{constructor(e,t,r,i){super(),this.name=e,this.newContent=t,this.scope=r,this.options=i}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class sye extends or{constructor(e,t,r){super(),this.namedExpression=e,this.content=t,this.scope=r}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class oye extends or{constructor(e,t,r,i,s){super(),this.namedExpression=e,this.newContent=t,this.oldContent=r,this.scope=i,this.options=s}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class aye extends or{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class lye{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new aye}commitBatchMode(){if(this.batchUndoEntry===void 0)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,r){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,r])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return this.undoStack.length===0}isRedoStackEmpty(){return this.redoStack.length===0}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:r}=e;for(let i=r.length-1;i>=0;--i){const s=r[i];this.operations.addRows(new Mj(t,[[s.rowFrom,s.rowCount]]));for(const{address:o,cellType:a}of s.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(s.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:r}=e;for(let i=r.length-1;i>=0;--i){const s=r[i];this.operations.addColumns(new Oj(t,[[s.columnFrom,s.columnCount]]));for(const{address:o,cellType:a}of s.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(s.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let r=t.length-1;r>=0;--r){const i=t[r];this.operations.removeRows(new Ij(e.command.sheet,[[i.rowStart,i.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let r=t.length-1;r>=0;--r){const i=t[r];this.operations.removeColumns(new _j(e.command.sheet,[[i.columnStart,i.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const r=t.address,[i,s]=t.oldContent;Og(r,i)||this.operations.setCellEmpty(r),this.operations.restoreCell(i,s)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:r}=e;this.operations.addSheet(e.sheetName);for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=Ce(r,o,i);this.operations.restoreCell(l,a)}}for(const[i,s]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(i,s,r);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:r}=e;for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=Ce(r,o,i);this.operations.restoreCell(l,a)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:r}=e;this.operations.clearSheet(r);for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=Ce(r,o,i);this.operations.restoreCell(l,a)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:r}=e,i=r.length,s=r[0].length;for(let o=0;o<i;++o)for(let a=0;a<s;++a){const l=Ce(t.sheet,t.col+a,t.row+o);this.operations.restoreCell(l,r[o][a])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:r}=e;this.operations.setSheetContent(t,r)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,r]of e)this.operations.restoreCell(t,r)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const r of t){const[i,s]=r;this.operations.setFormulaToCellFromCache(s,i)}}}class uye{constructor(e,t,r,i,s,o,a,l,u,h){this.operations=t,this.undoRedo=r,this.clipboardOperations=i,this.dependencyGraph=s,this.columnSearch=o,this.parser=a,this.cellContentParser=l,this.lazilyTransformingAstService=u,this.namedExpressions=h,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const r=new Mj(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(r),this.undoRedo.saveOperation(new Gve(r))}removeRows(e,...t){const r=new Ij(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeRows(r);this.undoRedo.saveOperation(new Wve(r,i))}addColumns(e,...t){const r=new Oj(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(r),this.undoRedo.saveOperation(new Xve(r))}removeColumns(e,...t){const r=new _j(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeColumns(r);this.undoRedo.saveOperation(new Qve(r,i))}moveCells(e,t,r,i){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:s,overwrittenCellsData:o,addedGlobalNamedExpressions:a}=this.operations.moveCells(e,t,r,i);this.undoRedo.saveOperation(new $ve(e,t,r,i,o,a,s))}moveRows(e,t,r,i){this.ensureItIsPossibleToMoveRows(e,t,r,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const s=this.operations.moveRows(e,t,r,i);this.undoRedo.saveOperation(new Kve(e,t,r,i,s))}moveColumns(e,t,r,i){this.ensureItIsPossibleToMoveColumns(e,t,r,i),this.undoRedo.clearRedoStack();const s=this.operations.moveColumns(e,t,r,i);this.undoRedo.saveOperation(new qve(e,t,r,i,s))}cut(e,t,r){this.clipboardOperations.cut(e,t,r)}ensureItIsPossibleToCopy(e,t,r){if(!Qc(t))throw new rr("width to be positive integer.");if(!Qc(r))throw new rr("height to be positive integer.")}copy(e,t,r){this.ensureItIsPossibleToCopy(e,t,r),this.clipboardOperations.copy(e,t,r)}paste(e){const t=this.clipboardOperations.clipboard;if(t===void 0)throw new sj;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const r=Le.spanFrom(e,t.width,t.height),i=this.operations.getRangeClipboardCells(r);this.undoRedo.clearRedoStack();const s=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new rye(e,i,t.content,s))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return this.clipboardOperations.clipboard===void 0}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new Zve(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),r=this.operations.getSheetClipboardCells(e),{version:i,scopedNamedExpressions:s}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new Jve(t,e,r,s,i))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const r=this.operations.renameSheet(e,t);return r!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new eye(e,r,t))),r}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new tye(e,t))}setCellContents(e,t){if(!(t instanceof Array))t=[[t]];else for(let i=0;i<t.length;i++)if(!(t[i]instanceof Array))throw new rr("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const r=[];for(let i=0;i<t.length;i++)for(let s=0;s<t[i].length;s++){const o={sheet:e.sheet,row:e.row+i,col:e.col+s},a=t[i][s];this.clipboardOperations.abortCut();const l=this.operations.setCellContent(o,a);r.push({address:o,newContent:a,oldContent:l})}this.undoRedo.saveOperation(new nye(r))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),Nj(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new Yve(e,r,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new jve(e,t,r))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new On(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[r,i]of t)if(r!==i){const s=Le.spanFrom({sheet:e,col:r,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new Cd}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new zve(e,t,r))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new On(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[r,i]of t)if(r!==i){const s=Le.spanFrom({sheet:e,col:0,row:r},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new Cd}}mappingFromOrder(e,t,r){if(!this.sheetMapping.hasSheetWithId(e))throw new On(e);const i=r==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==i)throw new rr(`number of ${r}s provided to be sheet ${r==="row"?"height":"width"}.`);const s=[];for(let o=0;o<i;o++)t[o]!==o&&s.push([o,t[o]]);return s}undo(){if(this.undoRedo.isUndoStackEmpty())throw new rj;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new ij;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,r,i){this.ensureItIsPossibleToAddNamedExpression(e,t,r),this.operations.addNamedExpression(e,t,r,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new iye(e,t,r,i))}changeNamedExpressionExpression(e,t,r,i){this.ensureItIsPossibleToChangeNamedExpression(e,r,t);const[s,o]=this.operations.changeNamedExpressionExpression(e,r,t,i);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new oye(s,r,o,t,i))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[r,i]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new sye(r,i,t)),r}ensureItIsPossibleToAddNamedExpression(e,t,r){this.ensureScopeIdIsValid(r),this.ensureNamedExpressionNameIsValid(e,r),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,r){if(this.ensureScopeIdIsValid(r),this.namedExpressions.namedExpressionForScope(e,r)===void 0)throw new Ig(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),this.namedExpressions.namedExpressionForScope(e,t)===void 0)throw new Ig(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new On(e);const r=this.dependencyGraph.getSheetHeight(e),i=t.map(s=>s[1]).reduce((s,o)=>s+o,0);if(r+i>this.maxRows)throw new Vh;for(const[s,o]of t)if(!ph(s)||!Qc(o))throw new rr("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[r,i]of t){const s=r+i-1;if(!ph(r)||!ph(s))throw new rr("starting and ending row to be nonnegative.");if(s<r)throw new rr("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new On(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new On(e);const r=this.dependencyGraph.getSheetWidth(e),i=t.map(s=>s[1]).reduce((s,o)=>s+o,0);if(r+i>this.maxColumns)throw new Vh;for(const[s,o]of t)if(!ph(s)||!Qc(o))throw new rr("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[r,i]of t){const s=r+i-1;if(!ph(r)||!ph(s))throw new rr("starting and ending column to be nonnegative.");if(s<r)throw new rr("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new On(e)}}ensureItIsPossibleToMoveRows(e,t,r,i){this.ensureItIsPossibleToAddRows(e,[i,r]);const s=Ce(e,0,t),o=Ce(e,0,i);if(!this.sheetMapping.hasSheetWithId(e)||Di(s)||Di(o)||!Qc(r)||i<=t+r&&i>=t)throw new rr("a valid range of rows to move.");const a=this.dependencyGraph.getSheetWidth(e),l=Le.spanFrom(s,a,r);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new Cd;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(Hi.fromNumberOfRows(e,i-1,2)))throw new oC}ensureItIsPossibleToMoveColumns(e,t,r,i){this.ensureItIsPossibleToAddColumns(e,[i,r]);const s=Ce(e,t,0),o=Ce(e,i,0);if(!this.sheetMapping.hasSheetWithId(e)||Di(s)||Di(o)||!Qc(r)||i<=t+r&&i>=t)throw new rr("a valid range of columns to move.");const a=this.dependencyGraph.getSheetHeight(e),l=Le.spanFrom(s,r,a);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new Cd;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(es.fromNumberOfColumns(e,i-1,2)))throw new oC}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new Ag(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new On(e);const r=this.sheetMapping.get(t);if(r!==void 0&&r!==e)throw new Ag(t)}ensureItIsPossibleToChangeContent(e){if(Di(e))throw new ej(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new On(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const r=dC(t),i=Le.spanFrom(e,r.width,r.height);this.ensureRangeInSizeLimits(i);for(const s of i.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(s)}ensureItIsPossibleToChangeSheetContents(e,t){const r=dC(t),i=Le.spanFrom(Ce(e,0,0),r.width,r.height);this.ensureRangeInSizeLimits(i)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Vh}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new On(e)}validateRowOrColumnMapping(e,t,r){const i=r==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),s=t.map(([a,l])=>a).sort((a,l)=>a-l),o=t.map(([a,l])=>l).sort((a,l)=>a-l);for(let a=0;a<s.length;a++){if(!ph(s[a])||s[a]>=i)throw new rr(`${r} numbers to be nonnegative integers and less than sheet ${r==="row"?"height":"width"}.`);if(s[a]===s[a+1])throw new rr(`source ${r} numbers to be unique.`);if(s[a]!==o[a])throw new rr(`target ${r} numbers to be permutation of source ${r} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new nj(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new tj(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof En.Formula){const r=this.parser.parse(t.formula,Ce(-1,0,0));if(Kl(r.ast))throw new t_}}}function Qc(n){return Number.isInteger(n)&&n>0}function ph(n){return Number.isInteger(n)&&n>=0}class hye{constructor(e,t,r,i,s,o){this.config=e,this.stats=t,this.interpreter=r,this.lazilyTransformingAstService=i,this.dependencyGraph=s,this.columnSearch=o}run(){this.stats.start(tt.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(tt.TOP_SORT),this.stats.measure(tt.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){const t=gu.empty();return this.stats.measure(tt.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,r=>{if(r instanceof ts){const i=r.isComputed()?r.getCellValue():void 0,s=this.recomputeFormulaVertexValue(r);if(s!==i){const o=r.getAddress(this.lazilyTransformingAstService);return t.addChange(s,o),this.columnSearch.change(ve(i),ve(s),o),!0}return!1}else return r instanceof Kr&&r.clearCache(),!0},r=>{if(r instanceof Kr)r.clearCache();else if(r instanceof ts){const i=r.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(ve(r.valueOrUndef()),i);const s=new E(N.CYCLE,void 0,r);r.setCellValue(s),t.addChange(s,i)}})}),t}runAndForget(e,t,r){const i=[];for(const o of ia(r,t))if(o instanceof Le){const a=o;if(this.dependencyGraph.getRange(a.start,a.end)===void 0){const l=new Kr(a);this.dependencyGraph.rangeMapping.setRange(l),i.push(l)}}const s=this.evaluateAstToCellValue(e,new ma(t,this.config.useArrayArithmetic));return i.forEach(o=>{this.dependencyGraph.rangeMapping.removeRange(o)}),s}recomputeFormulas(e,t){e.forEach(r=>{r instanceof ts&&r.setCellValue(new E(N.CYCLE,void 0,r))}),t.forEach(r=>{if(r instanceof ts){const i=this.recomputeFormulaVertexValue(r),s=r.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(ve(i),s)}else r instanceof Kr&&r.clearCache()})}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof Xn&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const r=e.getFormula(this.lazilyTransformingAstService),i=this.evaluateAstToCellValue(r,new ma(t,this.config.useArrayArithmetic,e));return e.setCellValue(i)}}evaluateAstToCellValue(e,t){const r=this.interpreter.evaluateAst(e,t);return r instanceof Oe?r:r===ft&&this.config.evaluateNullToZero?0:r}}class e0{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class xj{constructor(e,t){this.name=e,this.newValue=t}}class cye{constructor(e,t,r,i){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=r,this.lazilyTransformingService=i}exportChange(e){const t=e.value,r=e.address;if(r.sheet===Jh.SHEET_FOR_WORKBOOK_EXPRESSIONS){const i=this.namedExpressions.namedExpressionInAddress(r.row);if(!i)throw new Error("Missing named expression");return new xj(i.displayName,this.exportScalarOrRange(t))}else if(t instanceof Oe){const i=[];for(const[s,o]of t.entriesFromTopLeftCorner(r))i.push(new e0(o,this.exportValue(s)));return i}else return new e0(r,this.exportValue(t))}exportValue(e){return e instanceof Oe?this.detailedError(new E(N.VALUE,_.ScalarExpected)):this.config.smartRounding&&Pt(e)?this.cellValueRounding(ve(e)):e instanceof E?this.detailedError(e):e===ft?null:ve(e)}exportScalarOrRange(e){return e instanceof Oe?e.rawData().map(t=>t.map(r=>this.exportValue(r))):this.exportValue(e)}detailedError(e){var t,r;let i;const s=(t=e.root)===null||t===void 0?void 0:t.getAddress(this.lazilyTransformingService);return s!==void 0&&(s.sheet===Jh.SHEET_FOR_WORKBOOK_EXPRESSIONS?i=(r=this.namedExpressions.namedExpressionInAddress(s.row))===null||r===void 0?void 0:r.displayName:i=Yy(this.sheetIndexMapping,s,-1)),new Cj(e,this.config.translationPackage.getErrorTranslation(e.type),i)}cellValueRounding(e){if(e===0)return e;const t=Math.floor(Math.log10(Math.abs(e))),r=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}}class dye{constructor(e,t,r,i,s,o){this.dependencyGraph=e,this.columnSearch=t,this.parser=r,this.cellContentParser=i,this.stats=s,this.arraySizePredictor=o,this.buildStrategy=new fye(e,t,r,s,i,o)}buildGraph(e,t){const r=t.measure(tt.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(tt.PROCESS_DEPENDENCIES,()=>this.processDependencies(r))}processDependencies(e){e.forEach((t,r)=>{this.dependencyGraph.processCellDependencies(t,r)})}}class fye{constructor(e,t,r,i,s,o){this.dependencyGraph=e,this.columnIndex=t,this.parser=r,this.stats=i,this.cellContentParser=s,this.arraySizePredictor=o}run(e){const t=new Map;for(const r in e){const i=this.dependencyGraph.getSheetId(r),s=e[r];for(let o=0;o<s.length;++o){const a=s[o];for(let l=0;l<a.length;++l){const u=a[l],h=Ce(i,l,o),c=this.cellContentParser.parse(u);if(c instanceof En.Formula){const d=this.stats.measure(tt.PARSER,()=>this.parser.parse(c.formula,h));if(d.errors.length>0){this.shrinkArrayIfNeeded(h);const f=new xd(d.errors,c.formula);this.dependencyGraph.addVertex(h,f)}else{this.shrinkArrayIfNeeded(h);const f=this.arraySizePredictor.checkArraySize(d.ast,h);if(f.isScalar()){const m=new ca(d.ast,h,0);t.set(m,ia(d.dependencies,h)),this.dependencyGraph.addVertex(h,m),d.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(m),d.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(m)}else{const m=new Xn(d.ast,h,new yt(f.width,f.height));t.set(m,ia(d.dependencies,h)),this.dependencyGraph.addArrayVertex(h,m)}}}else if(!(c instanceof En.Empty)){this.shrinkArrayIfNeeded(h);const d=new pu(c.value,u);this.columnIndex.add(ve(c.value),h),this.dependencyGraph.addVertex(h,d)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof Xn&&this.dependencyGraph.shrinkArrayToCorner(t)}}const tv=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class Pj extends st{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:r,licenseKey:i}=this.config;let s;return tv.has(i)?s=tv.get(i):tv.has(r)?s=tv.get(r):r==="valid"&&(s=i.slice(-5)),`HyperFormula v${Ir.version}, ${s}`})}}Pj.implementedFunctions={VERSION:{method:"version",parameters:[]}};function CA(n,e){var t;let r=e.implementedFunctions[n];const i=(t=e.aliases)===null||t===void 0?void 0:t[n];if(i!==void 0){if(r!==void 0)throw new ywe(n,e.name);r=e.implementedFunctions[i]}if(r===void 0)throw zd.functionNotDeclaredInPlugin(n,e.name);return r}class dr{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=t=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(t),this.isFunctionVolatile=t=>this.volatileFunctions.has(t),this.isArrayFunction=t=>this.arrayFunctions.has(t),this.isFunctionDependentOnSheetStructureChange=t=>this.structuralChangeFunctions.has(t),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)dr.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(dr.plugins);for(const[t,r]of dr.protectedFunctions())dr.loadFunctionUnprotected(r,t,this.instancePlugins);for(const[t,r]of this.instancePlugins.entries())this.categorizeFunction(t,CA(t,r))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),t!==void 0&&this.loadTranslations(t)}static registerFunction(e,t,r){this.loadPluginFunction(t,e,this.plugins),r!==void 0&&this.loadTranslations(r)}static unregisterFunction(e){if(this.functionIsProtected(e))throw Uh.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw Uh.cannotUnregisterProtectedPlugin();for(const[t,r]of this.plugins.entries())r===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(Ir.getRegisteredLanguagesCodes());Object.keys(e).forEach(r=>{t.has(r)&&Ir.getLanguage(r).extendFunctions(e[r])})}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach(r=>{this.loadPluginFunction(e,r,t)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(r=>{this.loadPluginFunction(e,r,t)})}static loadPluginFunction(e,t,r){if(this.functionIsProtected(t))throw Uh.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,r)}static loadFunctionUnprotected(e,t,r){const i=CA(t,e).method;if(Object.prototype.hasOwnProperty.call(e.prototype,i))r.set(t,e);else throw zd.functionMethodNotFound(i,e.name)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)t!==void 0&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)e!==void 0&&(yield e)}initializePlugins(e){const t=[];for(const[r,i]of this.instancePlugins.entries()){let s=t.find(u=>u instanceof i);s===void 0&&(s=new i(e),t.push(s));const o=CA(r,i),a=o.method;this.functions.set(r,[a,s]);const l=o.arraySizeMethod;l!==void 0&&this.arraySizeFunctions.set(r,[l,s])}}getFunctionPlugin(e){if(!dr.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[r,i]=t;return(s,o)=>i[r](s,o)}else return}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[r,i]=t;return(s,o)=>i[r](s,o)}else return}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,r]of this.instancePlugins)dr.functionIsProtected(t)||e.add(r);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}dr.plugins=new Map;dr._protectedPlugins=new Map([["VERSION",Pj],["OFFSET",void 0]]);var Er;(function(n){n.GREATER_THAN="GREATER_THAN",n.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",n.LESS_THAN="LESS_THAN",n.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",n.NOT_EQUAL="NOT_EQUAL",n.EQUAL="EQUAL"})(Er||(Er={}));const nv=(n,e)=>({operator:n,value:e});class mye{constructor(e){var t,r,i,s;this.trueString=(r=(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||t===void 0?void 0:t.toLowerCase())!==null&&r!==void 0?r:"true",this.falseString=(s=(i=e.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||i===void 0?void 0:i.toLowerCase())!==null&&s!==void 0?s:"false"}fromCellValue(e,t){if(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")return;const r=this.parseCriterion(e,t);if(r!==void 0)return{raw:e,lambda:wye(r,t)}}parseCriterion(e,t){if(typeof e=="number"||typeof e=="boolean")return nv(Er.EQUAL,e);if(typeof e=="string"){const r=gye.exec(e);let i,s;r?(s=pye(r[1]),i=r[2]):(s=Er.EQUAL,i=e);const o=t.coerceToMaybeNumber(i),a=i.toLowerCase()===this.trueString?!0:i.toLowerCase()===this.falseString?!1:void 0;if(s===void 0)return;if(i==="")return nv(s,null);if(o===void 0){if(s===Er.EQUAL||s===Er.NOT_EQUAL)return nv(s,a??i)}else return nv(s,ve(o))}}}const gye=/([<>=]+)(.*)/;function pye(n){switch(n){case">":return Er.GREATER_THAN;case">=":return Er.GREATER_THAN_OR_EQUAL;case"<":return Er.LESS_THAN;case"<=":return Er.LESS_THAN_OR_EQUAL;case"<>":return Er.NOT_EQUAL;case"=":return Er.EQUAL;default:return}}const wye=(n,e)=>{switch(n.operator){case Er.GREATER_THAN:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)>0:t=>!1;case Er.GREATER_THAN_OR_EQUAL:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)>=0:t=>!1;case Er.LESS_THAN:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)<0:t=>!1;case Er.LESS_THAN_OR_EQUAL:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)<=0:t=>!1;case Er.EQUAL:return typeof n.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,n.value)===0;if(typeof t=="string"){if(t==="")return!1;const r=e.coerceToMaybeNumber(t);return r===void 0?!1:e.floatCmp(r,n.value)===0}else return!1}:typeof n.value=="string"?e.eqMatcherFunction(n.value):typeof n.value=="boolean"?t=>typeof t=="boolean"&&t===n.value:t=>t===ft;case Er.NOT_EQUAL:return typeof n.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,n.value)!==0;if(typeof t=="string"){if(t==="")return!0;const r=e.coerceToMaybeNumber(t);return r===void 0?!0:e.floatCmp(r,n.value)!==0}else return!0}:typeof n.value=="string"?e.neqMatcherFunction(n.value):typeof n.value=="boolean"?t=>typeof t!="boolean"||t!==n.value:t=>t!==ft}};class vye{constructor(e,t,r,i,s,o,a,l,u,h){this.config=e,this.dependencyGraph=t,this.columnSearch=r,this.stats=i,this.arithmeticHelper=s,this.functionRegistry=o,this.namedExpressions=a,this.serialization=l,this.arraySizePredictor=u,this.dateTimeHelper=h,this.equalOp=(c,d)=>ds(this.arithmeticHelper.eq,c,d),this.notEqualOp=(c,d)=>ds(this.arithmeticHelper.neq,c,d),this.greaterThanOp=(c,d)=>ds(this.arithmeticHelper.gt,c,d),this.lessThanOp=(c,d)=>ds(this.arithmeticHelper.lt,c,d),this.greaterThanOrEqualOp=(c,d)=>ds(this.arithmeticHelper.geq,c,d),this.lessThanOrEqualOp=(c,d)=>ds(this.arithmeticHelper.leq,c,d),this.concatOp=(c,d)=>ds(this.arithmeticHelper.concat,YN(c),YN(d)),this.plusOp=(c,d)=>ds(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.minusOp=(c,d)=>ds(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.timesOp=(c,d)=>ds(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.powerOp=(c,d)=>ds(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.divOp=(c,d)=>ds(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.unaryMinusOp=c=>JF(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(c)),this.percentOp=c=>JF(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(c)),this.unaryPlusOp=c=>this.arithmeticHelper.unaryPlus(c),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new mye(e)}evaluateAst(e,t){let r=this.evaluateAstWithoutPostprocessing(e,t);if(Pt(r)){if(wj(ve(r)))return new E(N.NUM,_.NaN);r=QO(r,vj(ve(r)))}return r instanceof Oe&&r.height()===1&&r.width()===1&&([[r]]=r.data),yye(r,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case M.EMPTY:return ft;case M.CELL_REFERENCE:{const r=e.reference.toSimpleCellAddress(t.formulaAddress);return Di(r)?new E(N.REF,_.BadRef):this.dependencyGraph.getCellValue(r)}case M.NUMBER:case M.STRING:return e.value;case M.CONCATENATE_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,r,i,t)}case M.EQUALS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,r,i,t)}case M.NOT_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,r,i,t)}case M.GREATER_THAN_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,r,i,t)}case M.LESS_THAN_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,r,i,t)}case M.GREATER_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,r,i,t)}case M.LESS_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,r,i,t)}case M.PLUS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,r,i,t)}case M.MINUS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,r,i,t)}case M.TIMES_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,r,i,t)}case M.POWER_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,r,i,t)}case M.DIV_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,r,i,t)}case M.PLUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,r,t)}case M.MINUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,r,t)}case M.PERCENT_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,r,t)}case M.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!dr.functionIsProtected(e.procedureName))return new E(N.LIC,_.LicenseKey(this.config.licenseKeyValidityState));const r=this.functionRegistry.getFunction(e.procedureName);return r!==void 0?r(e,new ma(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new E(N.NAME,_.FunctionName(e.procedureName))}case M.NAMED_EXPRESSION:{const r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return r?this.dependencyGraph.getCellValue(r.address):new E(N.NAME,_.NamedExpressionName(e.expressionName))}case M.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new E(N.REF,_.RangeManySheets);const r=Le.fromCellRange(e,t.formulaAddress),i=this.dependencyGraph.getArray(r);if(i){const s=i.array;if(s instanceof Cm)throw new Error("Array should be already computed");if(s instanceof E)return s;if(s instanceof Yd)return Oe.fromRange(s.raw(),r,this.dependencyGraph);throw new Error("Unknown array")}else return Oe.onlyRange(r,this.dependencyGraph)}case M.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new E(N.REF,_.RangeManySheets);const r=hl.fromColumnRange(e,t.formulaAddress);return Oe.onlyRange(r,this.dependencyGraph)}case M.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new E(N.REF,_.RangeManySheets);const r=cl.fromRowRangeAst(e,t.formulaAddress);return Oe.onlyRange(r,this.dependencyGraph)}case M.PARENTHESIS:return this.evaluateAst(e.expression,t);case M.ARRAY:{let r;const i=[];for(const s of e.args){let o;const a=[];for(const u of s){const h=gj(this.evaluateAst(u,t)),c=h.height();if(o===void 0)o=c,a.push(...h.data);else if(o===c)for(let d=0;d<c;d++)a[d].push(...h.data[d]);else return new E(N.REF,_.SizeMismatch)}const l=a[0].length;if(r===void 0)r=l,i.push(...a);else if(r===l)i.push(...a);else return new E(N.REF,_.SizeMismatch)}return Oe.onlyValues(i)}case M.ERROR_WITH_RAW_INPUT:case M.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,r){var i;if(t instanceof Oe&&!r.arraysFlag&&(t=(i=Wv(t,r))!==null&&i!==void 0?i:new E(N.VALUE,_.ScalarExpected)),t instanceof E)return t;if(t instanceof Oe){const s=t.data.map(o=>o.map(e));return Oe.onlyValues(s)}return e(t)}binaryRangeWrapper(e,t,r,i){var s,o;if(t instanceof Oe&&!i.arraysFlag&&(t=(s=Wv(t,i))!==null&&s!==void 0?s:new E(N.VALUE,_.ScalarExpected)),t instanceof E)return t;if(r instanceof Oe&&!i.arraysFlag&&(r=(o=Wv(r,i))!==null&&o!==void 0?o:new E(N.VALUE,_.ScalarExpected)),r instanceof E)return r;if(t instanceof Oe||r instanceof Oe){if(!(t instanceof Oe))if(r.isAdHoc()){const h=r.data;for(let c=0;c<h.length;c++)for(let d=0;d<h[0].length;d++)h[c][d]=e(t,h[c][d]);return Oe.onlyValues(h)}else t=Oe.fromScalar(t);if(!(r instanceof Oe))if(t.isAdHoc()){const h=t.data;for(let c=0;c<h.length;c++)for(let d=0;d<h[0].length;d++)h[c][d]=e(h[c][d],r);return Oe.onlyValues(h)}else r=Oe.fromScalar(r);if(t.width()===r.width()&&t.height()===r.height()){if(t.isAdHoc()){const h=t.data,c=r.data;for(let d=0;d<h.length;d++)for(let f=0;f<h[0].length;f++)h[d][f]=e(h[d][f],c[d][f]);return Oe.onlyValues(h)}if(r.isAdHoc()){const h=t.data,c=r.data;for(let d=0;d<h.length;d++)for(let f=0;f<h[0].length;f++)c[d][f]=e(h[d][f],c[d][f]);return Oe.onlyValues(c)}}const a=Math.max(t.width(),r.width()),l=Math.max(t.height(),r.height()),u=Array(l);for(let h=0;h<l;h++)u[h]=Array(a);for(let h=0;h<l;h++){const c=t.height()!==1?h:0,d=r.height()!==1?h:0;for(let f=0;f<a;f++){const m=t.width()!==1?f:0,p=r.width()!==1?f:0;c<t.height()&&d<r.height()&&m<t.width()&&p<r.width()?u[h][f]=e(t.data[c][m],r.data[d][p]):u[h][f]=new E(N.NA)}}return Oe.onlyValues(u)}return e(t,r)}}function JF(n,e){return e instanceof E?e:n(e)}function ds(n,e,t){return e instanceof E?e:t instanceof E?t:n(e,t)}function yye(n,e){return n instanceof E&&e!==void 0?n.attachRootVertex(e):n}class Cye{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach(r=>r.performEagerTransformations(e,t))}transformSingleAst(e,t){let[r,i]=[e,t];return this.transformations.forEach(s=>{[r,i]=s.transformSingleAst(r,i)}),[r,i]}isIrreversible(){return!0}}class Sye{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new Cye(e)}commitCombinedMode(){if(this.combinedTransformer===void 0)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,r){this.stats.start(tt.TRANSFORM_ASTS_POSTPONED);for(let s=r;s<this.transformations.length;s++){const o=this.transformations[s];o.isIrreversible()&&(this.undoRedo.storeDataForVersion(s,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[a,l]=o.transformSingleAst(e,t);e=a,t=l}const i=this.parser.rememberNewAst(e);return this.stats.end(tt.TRANSFORM_ASTS_POSTPONED),[i,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let r=e;r<this.transformations.length;r++){const i=this.transformations[r];(!t||t(i))&&(yield i)}}}const $v=-1;function Rye(n,e,{searchCoordinate:t,orderingDirection:r,matchExactly:i},s){const o=e.start[t],a=t==="col"?e.effectiveEndColumn(s):e.effectiveEndRow(s),l=t==="col"?d=>ve(s.getCellValue(Ce(e.sheet,d,e.start.row))):d=>ve(s.getCellValue(Ce(e.sheet,e.start.col,d))),u=r==="asc"?(d,f)=>ek(d,f):(d,f)=>-ek(d,f),h=Eye(d=>u(n,l(d))>=0,o,a),c=l(h);return h===$v||typeof c!=typeof n||i&&c!==n?$v:h-o}function Eye(n,e,t){let r=e,i=t;for(;r<i;){const s=Math.ceil((r+i)/2);n(s)?r=s:i=s-1}return r===i&&n(r)?r:$v}function ek(n,e){return typeof n==typeof e?n===ft?0:n<e?-1:n>e?1:0:n===ft?-1:e===ft?1:e instanceof E||typeof n=="number"&&typeof e=="string"||typeof n=="number"&&typeof e=="boolean"?-1:typeof n=="string"&&typeof e=="number"?1:typeof n=="string"&&typeof e=="boolean"?-1:1}class Lj{constructor(e){this.dependencyGraph=e}advancedFind(e,t){let r;const i=t.range;i===void 0?r=t.valuesFromTopLeftCorner():r=this.dependencyGraph.computeListOfValuesInRange(i);for(let s=0;s<r.length;s++)if(e(ve(r[s])))return s;return-1}basicFind(e,t,r,{ordering:i,matchExactly:s}){const o=typeof e=="string"?Zm(e):e,a=t.range;return a===void 0?this.findNormalizedValue(o,t.valuesFromTopLeftCorner()):i==="none"?this.findNormalizedValue(o,this.dependencyGraph.computeListOfValuesInRange(a)):Rye(o,a,{searchCoordinate:r,orderingDirection:i,matchExactly:s},this.dependencyGraph)}findNormalizedValue(e,t){return t.map(ve).map(r=>typeof r=="string"?Zm(r):r).indexOf(e)}}class Dj extends Lj{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,r){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,r,i){}removeValues(e){}find(e,t,r){return this.basicFind(e,t,"row",r)}}class Ah{constructor(e,t,r){this.dependencyGraph=e,this.config=t,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new Dj(e)}add(e,t){if(!(e===ft||e instanceof E))if(e instanceof Oe)for(const[r,i]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(ve(r),i);else this.addSingleCellValue(e,t)}remove(e,t){if(e!==void 0)if(e instanceof Oe)for(const[r,i]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(ve(r),i);else this.removeSingleValue(e,t)}change(e,t,r){e!==t&&(this.remove(e,r),this.add(t,r))}applyChanges(e){for(const t of e)t.oldValue!==void 0&&this.change(ve(t.oldValue),ve(t.value),t.address)}moveValues(e,t,r,i){for(const[s,o]of e){const a=Bwe(o,i,t,r);this.remove(s,o),this.add(s,a)}}removeValues(e){for(const[t,r]of e)this.remove(t,r)}find(e,t,{ordering:r,matchExactly:i}){const s=i===!0?"findFirst":"findLast",o=this.findUsingColumnIndex(e,t,s);return o!==void 0?o:this.binarySearchStrategy.find(e,t,{ordering:r,matchExactly:i})}findUsingColumnIndex(e,t,r){const i=t.range;if(i===void 0)return;this.ensureRecentData(i.sheet,i.start.col,e);const s=this.getColumnMap(i.sheet,i.start.col);if(!s)return-1;const o=typeof e=="string"?Zm(e):e,a=s.get(o);if(!a||!a.index||a.index.length===0)return;const l=Ah.findRowBelongingToRange(a,i,r);return l!==void 0?l-i.start.row:void 0}static findRowBelongingToRange(e,t,r){const i=t.start.row,s=t.end.row,o=r==="findFirst"?wh(i,e.index,"upperBound"):wh(s,e.index,"lowerBound");if(o===-1)return;const a=e.index[o];return a>=i&&a<=s?a:void 0}advancedFind(e,t){return this.binarySearchStrategy.advancedFind(e,t)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const r=this.index.get(e);let i=r[t];return i||(i=new Map,r[t]=i),i}getValueIndex(e,t,r){const i=this.getColumnMap(e,t);let s=this.getColumnMap(e,t).get(r);return s||(s={version:this.transformingService.version(),index:[]},i.set(r,s)),s}ensureRecentData(e,t,r){const i=this.getValueIndex(e,t,r),s=this.transformingService.version();if(i.version===s)return;const o=this.transformingService.getTransformationsFrom(i.version,a=>a.sheet===e&&(a instanceof ZN||a instanceof JN));for(const a of o)a instanceof ZN?this.addRows(t,a.rowsSpan,r):a instanceof JN&&this.removeRows(t,a.rowsSpan,r);i.version=s}addSingleCellValue(e,t){this.stats.measure(tt.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e),typeof e=="string"&&(e=Zm(e));const r=this.getValueIndex(t.sheet,t.col,e);Ah.addValue(r,t.row)})}removeSingleValue(e,t){this.stats.measure(tt.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e);const r=this.getColumnMap(t.sheet,t.col);typeof e=="string"&&(e=Zm(e));const i=r.get(e);if(!i)return;const s=wh(t.row,i.index);s>-1&&i.index.splice(s,1),i.index.length===0&&r.delete(e),r.size===0&&delete this.index.get(t.sheet)[t.col]})}addRows(e,t,r){const i=this.getValueIndex(t.sheet,e,r);Ah.shiftRows(i,t.rowStart,t.numberOfRows)}removeRows(e,t,r){const i=this.getValueIndex(t.sheet,e,r);Ah.removeRowsFromValues(i,t),Ah.shiftRows(i,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const r=wh(t,e.index,"lowerBound");e.index[r]===t||e.index.splice(r+1,0,t)}static removeRowsFromValues(e,t){const r=wh(t.rowStart,e.index,"upperBound"),i=wh(t.rowEnd,e.index,"lowerBound");r>-1&&i>-1&&r<=i&&e.index[r]<=t.rowEnd&&e.index.splice(r,i-r+1)}static shiftRows(e,t,r){const i=wh(t,e.index,"upperBound");if(i!==-1)for(let s=i;s<e.index.length;++s)e.index[s]+=r}}function wh(n,e,t="upperBound"){let r=0,i=e.length-1;for(;r<=i;){const a=Math.floor((r+i)/2);if(n>e[a])r=a+1;else if(n<e[a])i=a-1;else return a}const s=t==="lowerBound"?i:r;return s>=0&&s<=e.length?s:-1}function bye(n,e,t){return e.useColumnIndex?new Ah(n,e,t):new Dj(n)}class Tye{constructor(e){this.config=e;const t=this.config.thousandSeparator==="."?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,r=this.config.decimalSeparator==="."?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${r}\\d+)|(\\d+(${t}\\d{3,})*(${r}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);return isNaN(t)?void 0:t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}class i_{constructor(e,t,r){this.dependencyGraph=e,this.unparser=t,this.exporter=r}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof ca){const r=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(r.procedureName==="HYPERLINK")return r.hyperlink}}getCellFormula(e,t){const r=this.dependencyGraph.getCell(e);if(r instanceof ca){const i=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=t??e,this.unparser.unparse(i,t)}else if(r instanceof Xn){const i=r.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(i.row!==e.row||i.col!==e.col||i.sheet!==e.sheet)return;t=t??e;const s=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(s!==void 0)return this.unparser.unparse(s,t)}else if(r instanceof xd)return r.getFormula()}getCellSerialized(e,t){var r;return(r=this.getCellFormula(e,t))!==null&&r!==void 0?r:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,t=>this.getCellValue(t))}getSheetFormulas(e){return this.genericSheetGetter(e,t=>this.getCellFormula(t))}genericSheetGetter(e,t){const r=this.dependencyGraph.getSheetHeight(e),i=this.dependencyGraph.getSheetWidth(e),s=new Array(r);for(let o=0;o<r;o++){s[o]=new Array(i);for(let a=0;a<i;a++){const l=Ce(e,a,o);s[o][a]=t(l)}for(let a=i-1;a>=0&&(s[o][a]===null||s[o][a]===void 0);a--)s[o].pop()}for(let o=r-1;o>=0&&s[o].length===0;o--)s.pop();return s}genericAllSheetsGetter(e){const t={};for(const r of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(r);t[r]=e(i)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,t=>this.getCellSerialized(t))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const r of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(r);e[i]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(r=>({name:r.expression.displayName,expression:this.getCellSerialized(r.expression.address),scope:r.scope!==void 0?e[r.scope]:void 0,options:r.expression.options}))}withNewConfig(e,t){const r=new qG(e,XO(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new i_(this.dependencyGraph,r,this.exporter)}}class rv{static buildFromSheets(e,t={},r=[]){const i=new Hr(t);return this.buildEngine(i,e,r)}static buildFromSheet(e,t={},r=[]){const i=new Hr(t),s=i.translationPackage.getUITranslation(Mg.NEW_SHEET_PREFIX)+"1";return this.buildEngine(i,{[s]:e},r)}static buildEmpty(e={},t=[]){return this.buildEngine(new Hr(e),{},t)}static rebuildWithConfig(e,t,r,i){return this.buildEngine(e,t,r,i)}static buildEngine(e,t={},r=[],i=e.useStats?new ZG:new pwe){i.start(tt.BUILD_ENGINE_TOTAL);const s=new Jh,o=new dr(e),a=new Sye(i),l=n_.buildEmpty(a,e,o,s,i),u=bye(l,e,i),h=l.sheetMapping,c=l.addressMapping;for(const q in t)if(Object.prototype.hasOwnProperty.call(t,q)){const J=t[q];Nj(J);const re=dC(J);if(re.height>e.maxRows||re.width>e.maxColumns)throw new Vh;const ie=h.addSheet(q);c.autoAddSheet(ie,re)}const d=new Xm(e,o,h.get);a.parser=d;const f=new qG(e,XO(e),h.fetchDisplayName,s),m=new hve(e),p=new Tye(e),v=new zwe(e,m,p),y=new _ve(e,m,p),S=new Jwe(e,o),R=new Uve(e,l,u,y,d,i,a,s,S),T=new lye(e,R);a.undoRedo=T;const I=new xve(e,l,R),H=new uye(e,R,T,I,l,u,d,y,a,s);r.forEach(q=>{H.ensureItIsPossibleToAddNamedExpression(q.name,q.expression,q.scope),H.operations.addNamedExpression(q.name,q.expression,q.scope,q.options)});const k=new cye(e,s,h.fetchDisplayName,a),W=new i_(l,f,k),Y=new vye(e,l,u,i,v,o,s,W,S,m);i.measure(tt.GRAPH_BUILD,()=>{new dye(l,u,d,y,i,S).buildGraph(t,i)});const $=new hye(e,i,Y,a,l,u);return $.run(),i.end(tt.BUILD_ENGINE_TOTAL),{config:e,stats:i,dependencyGraph:l,columnSearch:u,parser:d,unparser:f,cellContentParser:y,evaluator:$,lazilyTransformingAstService:a,crudOperations:H,exporter:k,namedExpressions:s,serialization:W,functionRegistry:o}}}function Aye(n){for(const[e,t]of Object.entries(n))t instanceof Function?n[e]=Nye(t):delete n[e]}function Nye(n){return()=>{throw new Error(`The "${n}" method cannot be called because this HyperFormula instance has been destroyed`)}}var iv={exports:{}},tk;function Iye(){if(tk)return iv.exports;tk=1;function n(){}return n.prototype={on:function(e,t,r){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var i=this;function s(){i.off(e,s),t.apply(r,arguments)}return s._=t,this.on(e,s,r)},emit:function(e){var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),i=0,s=r.length;for(i;i<s;i++)r[i].fn.apply(r[i].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),i=r[e],s=[];if(i&&t)for(var o=0,a=i.length;o<a;o++)i[o].fn!==t&&i[o].fn._!==t&&s.push(i[o]);return s.length?r[e]=s:delete r[e],this}},iv.exports=n,iv.exports.TinyEmitter=n,iv.exports}var Mye=Iye();var Jo;(function(n){n.SheetAdded="sheetAdded",n.SheetRemoved="sheetRemoved",n.SheetRenamed="sheetRenamed",n.NamedExpressionAdded="namedExpressionAdded",n.NamedExpressionRemoved="namedExpressionRemoved",n.ValuesUpdated="valuesUpdated",n.EvaluationSuspended="evaluationSuspended",n.EvaluationResumed="evaluationResumed"})(Jo||(Jo={}));class Oye extends Mye.TinyEmitter{emit(e,...t){return super.emit(e,...t),this}}class Ir{constructor(e,t,r,i,s,o,a,l,u,h,c,d,f,m){this._config=e,this._stats=t,this._dependencyGraph=r,this._columnSearch=i,this._parser=s,this._unparser=o,this._cellContentParser=a,this._evaluator=l,this._lazilyTransformingAstService=u,this._crudOperations=h,this._exporter=c,this._namedExpressions=d,this._serialization=f,this._functionRegistry=m,this._emitter=new Oye,this._evaluationSuspended=!1}static get defaultConfig(){return _ye()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},r=[]){return this.buildFromEngineState(rv.buildFromSheet(e,t,r))}static buildFromSheets(e,t={},r=[]){return this.buildFromEngineState(rv.buildFromSheets(e,t,r))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(rv.buildEmpty(e,t))}static getLanguage(e){ce(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(t===void 0)throw new $N;return t}static registerLanguage(e,t){if(ce(e,"string","languageCode"),this.registeredLanguages.has(e))throw new dj;this.registeredLanguages.set(e,Owe(t))}static unregisterLanguage(e){if(ce(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new $N}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){dr.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){dr.unregisterFunctionPlugin(e)}static registerFunction(e,t,r){ce(e,"string","functionId"),dr.registerFunction(e,t,r)}static unregisterFunction(e){ce(e,"string","functionId"),dr.unregisterFunction(e)}static unregisterAllFunctions(){dr.unregisterAll()}static getRegisteredFunctionNames(e){ce(e,"string","code");const t=dr.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return ce(e,"string","functionId"),dr.getFunctionPlugin(e)}static getAllFunctionPlugins(){return dr.getPlugins()}static buildFromEngineState(e){return new Ir(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!Vn(e))throw new _t("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!Vn(e))throw new _t("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!Vn(e))throw new _t("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!Vn(e))throw new _t("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return ce(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return ce(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return ce(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return ce(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([r,i])=>this._config[r]===i)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if(Vn(e))t=new Le(e,e);else if(Gi(e))t=new Le(e.start,e.end);else throw new _t("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(t);for(const r of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(r)}catch{return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return ce(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){ce(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch{return!1}}setRowOrder(e,t){ce(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,r)}isItPossibleToSetRowOrder(e,t){ce(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch{return!1}}swapColumnIndexes(e,t){return ce(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){ce(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch{return!1}}setColumnOrder(e,t){ce(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,r)}isItPossibleToSetColumnOrder(e,t){ce(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch{return!1}}isItPossibleToAddRows(e,...t){ce(e,"number","sheetId");const r=mC(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...r),!0}catch{return!1}}addRows(e,...t){return ce(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){ce(e,"number","sheetId");const r=fC(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...r),!0}catch{return!1}}removeRows(e,...t){return ce(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){ce(e,"number","sheetId");const r=mC(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...r),!0}catch{return!1}}addColumns(e,...t){return ce(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){ce(e,"number","sheetId");const r=fC(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...r),!0}catch{return!1}}removeColumns(e,...t){return ce(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!Vn(t))throw new _t("SimpleCellAddress","destinationLeftCorner");if(!Gi(e))throw new _t("SimpleCellRange","source");try{const r=new Le(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(r.start,r.width(),r.height(),t),!0}catch{return!1}}moveCells(e,t){if(!Vn(t))throw new _t("SimpleCellAddress","destinationLeftCorner");if(!Gi(e))throw new _t("SimpleCellRange","source");const r=new Le(e.start,e.end);return this._crudOperations.moveCells(r.start,r.width(),r.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,r,i){ce(e,"number","sheetId"),ce(t,"number","startRow"),ce(r,"number","numberOfRows"),ce(i,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,r,i),!0}catch{return!1}}moveRows(e,t,r,i){return ce(e,"number","sheetId"),ce(t,"number","startRow"),ce(r,"number","numberOfRows"),ce(i,"number","targetRow"),this._crudOperations.moveRows(e,t,r,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,r,i){ce(e,"number","sheetId"),ce(t,"number","startColumn"),ce(r,"number","numberOfColumns"),ce(i,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,r,i),!0}catch{return!1}}moveColumns(e,t,r,i){return ce(e,"number","sheetId"),ce(t,"number","startColumn"),ce(r,"number","numberOfColumns"),ce(i,"number","targetColumn"),this._crudOperations.moveColumns(e,t,r,i),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!Gi(e))throw new _t("SimpleCellRange","source");const t=new Le(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!Gi(e))throw new _t("SimpleCellRange","source");const t=new Le(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!Vn(e))throw new _t("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!Gi(e))throw new _t("SimpleCellRange","source");return new Le(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellValue(i)))}getRangeFormulas(e){if(!Gi(e))throw new _t("SimpleCellRange","source");return new Le(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellFormula(i)))}getRangeSerialized(e){if(!Gi(e))throw new _t("SimpleCellRange","source");return new Le(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellSerialized(i)))}getFillRangeData(e,t,r=!1){if(!Gi(e))throw new _t("SimpleCellRange","source");if(!Gi(t))throw new _t("SimpleCellRange","target");const i=new Le(e.start,e.end),s=new Le(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),s.arrayOfAddressesInRange().map(o=>o.map(a=>{const l=((a.row-(r?t:e).start.row)%i.height()+i.height())%i.height()+e.start.row,u=((a.col-(r?t:e).start.col)%i.width()+i.width())%i.width()+e.start.col;return this._serialization.getCellSerialized({row:l,col:u,sheet:i.sheet},a)}))}isItPossibleToAddSheet(e){ce(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}addSheet(e){e!==void 0&&ce(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(Jo.SheetAdded,t),t}isItPossibleToRemoveSheet(e){ce(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}removeSheet(e){ce(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Jo.SheetRemoved,t,r),r}isItPossibleToClearSheet(e){ce(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}clearSheet(e){return ce(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){ce(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch{return!1}}setSheetContent(e,t){return ce(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return ce(e,"string","cellAddress"),ce(t,"number","sheetId"),ON(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return ce(e,"string","cellRange"),ce(t,"number","sheetId"),mme(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t){if(!Vn(e))throw new _t("SimpleCellAddress","cellAddress");return ce(t,"number","sheetId"),Yy(this.sheetMapping.fetchDisplayName,e,t)}simpleCellRangeToString(e,t){if(!Gi(e))throw new _t("SimpleCellRange","cellRange");return ce(t,"number","sheetId"),gme(this.sheetMapping.fetchDisplayName,e,t)}getCellDependents(e){let t;if(Vn(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(Gi(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new _t("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if(Vn(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(Gi(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new _t("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return ce(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return ce(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return ce(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!Vn(e))throw new _t("SimpleCellAddress","cellAddress");const t=this.dependencyGraph.getCell(e);return Dwe(t,e)}doesCellHaveSimpleValue(e){if(!Vn(e))throw new _t("SimpleCellAddress","cellAddress");return this.getCellType(e)===xi.VALUE}doesCellHaveFormula(e){if(!Vn(e))throw new _t("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===xi.FORMULA||t===xi.ARRAYFORMULA}isCellEmpty(e){if(!Vn(e))throw new _t("SimpleCellAddress","cellAddress");return this.getCellType(e)===xi.EMPTY}isCellPartOfArray(e){if(!Vn(e))throw new _t("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===xi.ARRAY||t===xi.ARRAYFORMULA}getCellValueType(e){if(!Vn(e))throw new _t("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return lC(t)}getCellValueDetailedType(e){if(!Vn(e))throw new _t("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return Fwe(t)}getCellValueFormat(e){if(!Vn(e))throw new _t("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return kwe(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){ce(e,"number","sheetId"),ce(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch{return!1}}renameSheet(e,t){ce(e,"number","sheetId"),ce(t,"string","newName");const r=this._crudOperations.renameSheet(e,t);r!==void 0&&this._emitter.emit(Jo.SheetRenamed,r,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(Jo.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Jo.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,r){ce(e,"string","expressionName"),r!==void 0&&ce(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,r),!0}catch{return!1}}addNamedExpression(e,t,r,i){ce(e,"string","expressionName"),r!==void 0&&ce(r,"number","scope"),this._crudOperations.addNamedExpression(e,t,r,i);const s=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Jo.NamedExpressionAdded,e,s),s}getNamedExpressionValue(e,t){ce(e,"string","expressionName"),t!==void 0&&ce(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);if(r)return this._serialization.getCellValue(r.address)}getNamedExpressionFormula(e,t){ce(e,"string","expressionName"),t!==void 0&&ce(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);if(r!==void 0)return this._serialization.getCellFormula(r.address)}getNamedExpression(e,t){ce(e,"string","expressionName"),t!==void 0&&ce(t,"number","scope");const r=this._namedExpressions.namedExpressionForScope(e,t);if(r===void 0)return;const i=this._serialization.getCellFormula(r.address);return{name:e,scope:t,expression:i,options:r.options}}isItPossibleToChangeNamedExpression(e,t,r){ce(e,"string","expressionName"),r!==void 0&&ce(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,r),!0}catch{return!1}}changeNamedExpression(e,t,r,i){return ce(e,"string","expressionName"),r!==void 0&&ce(r,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,r,t,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){ce(e,"string","expressionName"),t!==void 0&&ce(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch{return!1}}removeNamedExpression(e,t){ce(e,"string","expressionName"),t!==void 0&&ce(t,"number","scope");const r=this._crudOperations.removeNamedExpression(e,t);if(r){const i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Jo.NamedExpressionRemoved,r.displayName,i),i}else return[]}listNamedExpressions(e){return e!==void 0&&ce(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){ce(e,"string","formulaString");const{ast:t,address:r}=this.extractTemporaryFormula(e);if(t===void 0)throw new Uv;return this._unparser.unparse(t,r)}calculateFormula(e,t){ce(e,"string","formulaString"),ce(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:r,address:i,dependencies:s}=this.extractTemporaryFormula(e,t);if(r===void 0)throw new Uv;const o=this.evaluator.runAndForget(r,i,s);return this._exporter.exportScalarOrRange(o)}getNamedExpressionsFromFormula(e){ce(e,"string","formulaString");const{ast:t,dependencies:r}=this.extractTemporaryFormula(e);if(t===void 0)throw new Uv;const i=r.filter(o=>o instanceof al).map(o=>o.name);return[...new Set(i)]}validateFormula(e){ce(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return t!==void 0}getRegisteredFunctionNames(){return Ir.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return ce(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return ce(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return ce(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return ce(e,"number","val"),Pd(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){Aye(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new hj}extractTemporaryFormula(e,t=1){const r=this._cellContentParser.parse(e),i={sheet:t,col:0,row:0};if(!(r instanceof En.Formula))return{address:i,dependencies:[]};const{ast:s,errors:o,dependencies:a}=this._parser.parse(r.formula,i);return o.length>0?{address:i,dependencies:[]}:{ast:s,address:i,dependencies:a}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),r=this._config.mergeConfig({language:e.language}),i=this._serialization.withNewConfig(r,this._namedExpressions).getAllSheetsSerialized(),s=this._serialization.getAllNamedExpressionsSerialized(),o=rv.rebuildWithConfig(t,i,s,this._stats);this._config=o.config,this._stats=o.stats,this._dependencyGraph=o.dependencyGraph,this._columnSearch=o.columnSearch,this._parser=o.parser,this._unparser=o.unparser,this._cellContentParser=o.cellContentParser,this._evaluator=o.evaluator,this._lazilyTransformingAstService=o.lazilyTransformingAstService,this._crudOperations=o.crudOperations,this._exporter=o.exporter,this._namedExpressions=o.namedExpressions,this._serialization=o.serialization,this._functionRegistry=o.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const r=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(Jo.ValuesUpdated,r),r}}}Ir.version="2.7.1";Ir.buildDate="18/07/2024 11:23:17";Ir.releaseDate="18/07/2024";Ir.languages={};Ir.registeredLanguages=new Map;const nk=new WeakMap;class Hr{constructor(e={},t=!0){const{accentSensitive:r,binarySearchThreshold:i,caseSensitive:s,caseFirst:o,chooseAddressMappingPolicy:a,context:l,currencySymbol:u,dateFormats:h,decimalSeparator:c,evaluateNullToZero:d,functionArgSeparator:f,functionPlugins:m,ignorePunctuation:p,leapYear1900:v,localeLang:y,language:S,ignoreWhiteSpace:R,licenseKey:T,matchWholeCell:I,arrayColumnSeparator:H,arrayRowSeparator:k,maxRows:W,maxColumns:Y,nullYear:$,nullDate:q,parseDateTime:J,precisionEpsilon:re,precisionRounding:ie,stringifyDateTime:ae,stringifyDuration:Ve,smartRounding:De,timeFormats:Se,thousandSeparator:pe,useArrayArithmetic:ze,useStats:w,undoLimit:C,useColumnIndex:b,useRegularExpressions:P,useWildcards:L}=e;t&&Hr.warnDeprecatedOptions(e),this.useArrayArithmetic=Ut(ze,"boolean","useArrayArithmetic"),this.accentSensitive=Ut(r,"boolean","accentSensitive"),this.caseSensitive=Ut(s,"boolean","caseSensitive"),this.caseFirst=Ut(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=Ut(p,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=a??Hr.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...Qw(h,Array.isArray,"array","dateFormats")],this.timeFormats=[...Qw(Se,Array.isArray,"array","timeFormats")],this.functionArgSeparator=Ut(f,"string","functionArgSeparator"),this.decimalSeparator=Ut(c,[".",","],"decimalSeparator"),this.language=Ut(S,"string","language"),this.ignoreWhiteSpace=Ut(R,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=Ut(T,"string","licenseKey"),this.thousandSeparator=Ut(pe,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=Ut(H,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=Ut(k,[";","|"],"arrayRowSeparator"),this.localeLang=Ut(y,"string","localeLang"),this.functionPlugins=[...m??Hr.defaultConfig.functionPlugins],this.smartRounding=Ut(De,"boolean","smartRounding"),this.evaluateNullToZero=Ut(d,"boolean","evaluateNullToZero"),this.nullYear=Ut($,"number","nullYear"),Xc(this.nullYear,"nullYear",0),eve(this.nullYear,"nullYear",100),this.precisionRounding=Ut(ie,"number","precisionRounding"),Xc(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=Ut(re,"number","precisionEpsilon"),Xc(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=Ut(b,"boolean","useColumnIndex"),this.useStats=Ut(w,"boolean","useStats"),this.binarySearchThreshold=i??Hr.defaultConfig.binarySearchThreshold,this.parseDateTime=Ut(J,"function","parseDateTime"),this.stringifyDateTime=Ut(ae,"function","stringifyDateTime"),this.stringifyDuration=Ut(Ve,"function","stringifyDuration"),this.translationPackage=Ir.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=Qw(q,Jm,"IDate","nullDate"),this.leapYear1900=Ut(v,"boolean","leapYear1900"),this.undoLimit=Ut(C,"number","undoLimit"),this.useRegularExpressions=Ut(P,"boolean","useRegularExpressions"),this.useWildcards=Ut(L,"boolean","useWildcards"),this.matchWholeCell=Ut(I,"boolean","matchWholeCell"),Xc(this.undoLimit,"undoLimit",0),this.maxRows=Ut(W,"number","maxRows"),Xc(this.maxRows,"maxRows",1),this.maxColumns=Ut(Y,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(u),Xc(this.maxColumns,"maxColumns",1),this.context=l,nk.set(this,{licenseKeyValidityState:Ave(this.licenseKey)}),UF({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),UF({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...Qw(e,Array.isArray,"array","currencySymbol")];return t.forEach(r=>{if(typeof r!="string")throw new _t("string[]","currencySymbol");if(r==="")throw new vwe("currencySymbol")}),t}get licenseKeyValidityState(){return nk.get(this).licenseKeyValidityState}getConfig(){return Hj(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return Hr.warnDeprecatedOptions(e),new Hr(t,!1)}static warnDeprecatedOptions(e){Hr.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,t,r,i){e!==void 0&&console.warn(i===void 0?`${t} option is deprecated since ${r}`:`${t} option is deprecated since ${r}, please use ${i}`)}}Hr.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new mve,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:sve,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:Rve,stringifyDuration:Sve,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function Hj(n){var e;const t={};for(const r in Hr.defaultConfig){const i=(e=n[r])!==null&&e!==void 0?e:Hr.defaultConfig[r];Array.isArray(i)?t[r]=[...i]:t[r]=i}return t}function _ye(){return Hj({})}const t0={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};var ql;(function(n){n[n.FullyAbsolute=1]="FullyAbsolute",n[n.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",n[n.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",n[n.FullyRelative=4]="FullyRelative"})(ql||(ql={}));class Fj extends st{verifyAddressArguments(e,t,r,i){if(i){if(e<1||t<1)return new E(N.VALUE,_.LessThanOne)}else if(ql.FullyAbsolute==r){if(e<1||t<1)return new E(N.VALUE,_.LessThanOne)}else if(ql.RowAbsoluteColRelative==r){if(e<1)return new E(N.VALUE,_.LessThanOne)}else if(ql.RowRelativeColAbsolute==r&&t<1)return new E(N.VALUE,_.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(r,i,s,o,a)=>{const l=this.verifyAddressArguments(r,i,s,o);if(l!==void 0)return l;const u=gS(i-1);let h="";a!=null&&(h=`${a}!`);const c=i==0?"C":`C[${i}]`,d=r==0?"R":`R[${r}]`;return ql.FullyRelative==s?o?`${h}${u}${r}`:`${h}${d}${c}`:ql.RowRelativeColAbsolute==s?o?`${h}$${u}${r}`:`${h}${d}C${i}`:ql.RowAbsoluteColRelative==s?o?`${h}${u}$${r}`:`${h}R${r}${c}`:o?`${h}$${u}$${r}`:`${h}R${r}C${i}`})}}Fj.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:g.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:g.STRING,optionalArg:!0}]}};class kj extends st{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),r=>r)}arrayformulaArraySize(e,t){if(e.args.length!==1)return yt.error();const r=this.metadata("ARRAYFORMULA");return e.args.map(s=>{var o;return this.arraySizeForAst(s,new ma(t.formulaAddress,t.arraysFlag||((o=r?.arrayFunction)!==null&&o!==void 0?o:!1)))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(r,i,s)=>{i=Math.min(i,r.height()),s=Math.min(s,r.width());const o=r.data,a=[];for(let l=0;l<i;l++)a.push(o[l].slice(0,s));return Oe.onlyValues(a)})}arrayconstrainArraySize(e,t){if(e.args.length!==3)return yt.error();const r=this.metadata("ARRAY_CONSTRAIN"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new ma(t.formulaAddress,t.arraysFlag||((l=r?.arrayFunction)!==null&&l!==void 0?l:!1)))});let{height:s,width:o}=i[0];return e.args[1].type===M.NUMBER&&(s=Math.min(s,e.args[1].value)),e.args[2].type===M.NUMBER&&(o=Math.min(o,e.args[2].value)),s<1||o<1||!Number.isInteger(s)||!Number.isInteger(o)?yt.error():new yt(o,s)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(r,...i)=>{for(const a of i)if(r.width()!==a.width()||r.height()!==a.height())return new E(N.NA,_.EqualLength);if(r.width()>1&&r.height()>1)return new E(N.NA,_.WrongDimension);const s=r.data,o=[];for(let a=0;a<r.height();a++){const l=[];for(let u=0;u<r.width();u++){let h=!0;for(const c of i)if(pj(c.data[a][u])!==!0){h=!1;break}h&&l.push(s[a][u])}l.length>0&&o.push(l)}return o.length>0?Oe.onlyValues(o):new E(N.NA,_.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return yt.error();const r=this.metadata("FILTER"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new ma(t.formulaAddress,t.arraysFlag||((l=r?.arrayFunction)!==null&&l!==void 0?l:!1)))}),s=Math.max(...i.map(a=>a.width)),o=Math.max(...i.map(a=>a.height));return new yt(s,o)}}kj.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:g.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:g.RANGE},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}],repeatLastArgs:1}};class Vj extends st{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}Vj.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:g.NUMBER}]}};const xye=0xffffffffffff,rk=-53,ik=53;class Uj extends st{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),Bj)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),Wj)}}Uj.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:rk,maxValue:ik}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:rk,maxValue:ik}]}};function Bj(n,e){return e<0?Wj(n,-e):$j(n*Math.pow(2,e))}function Wj(n,e){return e<0?Bj(n,-e):$j(Math.floor(n/Math.pow(2,e)))}function $j(n){return n>xye?new E(N.NUM,_.BitshiftLong):n}class Gj extends st{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(r,i)=>r&i)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(r,i)=>r|i)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(r,i)=>r^i)}}Gj.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:0}]}};class jj extends st{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(r,i,s)=>r?i:s)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...r)=>{for(let i=0;i<r.length;i+=2)if(r[i])return r[i+1];return new E(N.NA,_.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...r)=>r.filter(i=>i!==void 0).every(i=>!!i))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...r)=>r.filter(i=>i!==void 0).some(i=>i))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),r=>!r)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...r)=>{let i=0;return r.filter(s=>s!==void 0).forEach(s=>{s&&i++}),i%2===1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(r,...i)=>{const s=i.length;let o=0;for(;o+1<s;o+=2)if(!(i[o]instanceof E)&&this.arithmeticHelper.eq(r,i[o]))return i[o+1];return o<s?i[o]:new E(N.NA,_.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(r,i)=>r instanceof E?i:r)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(r,i)=>r instanceof E&&r.type===N.NA?i:r)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(r,...i)=>r>i.length?new E(N.NUM,_.Selector):i[r-1])}}jj.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:g.BOOLEAN},{argumentType:g.SCALAR,passSubtype:!0},{argumentType:g.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:g.BOOLEAN},{argumentType:g.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:g.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:g.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:g.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:g.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:g.NOERROR},{argumentType:g.SCALAR,passSubtype:!0},{argumentType:g.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:g.SCALAR,passSubtype:!0},{argumentType:g.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:g.SCALAR,passSubtype:!0},{argumentType:g.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:g.INTEGER,minValue:1},{argumentType:g.SCALAR,passSubtype:!0}],repeatLastArgs:1}};class zj extends st{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),r=>r<1||r>=256?new E(N.VALUE,_.CharacterCodeBounds):String.fromCharCode(Math.trunc(r)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),r=>r<1||r>=1114112?new E(N.VALUE,_.CharacterCodeBounds):String.fromCodePoint(Math.trunc(r)))}}zj.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:g.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:g.NUMBER}]}};class Yj extends st{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),r=>r.length===0?new E(N.VALUE,_.EmptyString):r.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),r=>{var i;return(i=r.codePointAt(0))!==null&&i!==void 0?i:new E(N.VALUE,_.EmptyString)})}}Yj.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:g.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:g.STRING}]}};class Kj extends st{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...r)=>{let i=0;return r.forEach(s=>{s===ft&&i++}),i})}}Kj.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:g.SCALAR}],repeatLastArgs:1,expandRanges:!0}};class qj extends st{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...r)=>{const i=new Set,s=new Set;for(const o of r)o instanceof E?s.add(o.type):o!==""&&i.add(o);return i.size+s.size})}}qj.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:g.SCALAR}],repeatLastArgs:1,expandRanges:!0}};class Xj extends st{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),s=this.dateTimeHelper.relativeNumberToAbsoluteNumber(i),o=s+((4-s)%7+7)%7,a=Math.floor((t-1)/7)-Math.floor((o-1)/7)+1;return a===0?this.isoweeknumCore(e-7)+1:a},this.days360Core=(e,t,r)=>{const i=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.numberToSimpleDate(t);let o,a;return r?(o=jF(i),a=jF(s)):[o,a]=this.dateTimeHelper.toBasisUS(i,s),360*(a.year-o.year)+30*(a.month-o.month)+a.day-o.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(r,i,s)=>{const o=Math.trunc(s);let a=Math.trunc(i),l=Math.trunc(r);l<this.dateTimeHelper.getEpochYearZero()&&(l+=this.dateTimeHelper.getEpochYearZero());const u=Math.floor((a-1)/12);l+=u,a-=u*12;const h={year:l,month:a,day:1};if(this.dateTimeHelper.isValidDate(h)){let c=this.dateTimeHelper.dateToNumber(h)+(o-1);return c=this.dateTimeHelper.getWithinBounds(c),c===void 0?new E(N.NUM,_.DateBounds):c}return new E(N.VALUE,_.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(r,i,s)=>{const o=Ld({hours:Math.trunc(r),minutes:Math.trunc(i),seconds:Math.trunc(s)});return o<0?new E(N.NUM,_.NegativeTime):o%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(r,i)=>{const s=this.dateTimeHelper.numberToSimpleDate(r);let o=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(GF(s,i)));return o=this.dateTimeHelper.getWithinBounds(o),o===void 0?new E(N.NUM,_.DateBounds):o})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),r=>this.dateTimeHelper.numberToSimpleDate(r).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(r,i)=>Math.trunc(r)-Math.trunc(i))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),r=>this.dateTimeHelper.numberToSimpleDate(r).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),r=>this.dateTimeHelper.numberToSimpleDate(r).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),r=>Pd(vA(r)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),r=>Pd(vA(r)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),r=>Pd(vA(r)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(r,i)=>vve(r,i,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(r,i)=>{const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r));if(i===3)return(s-1)%7;const o=ak.get(i);return o===void 0?new E(N.NUM,_.BadMode):(s-o)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(r,i)=>{const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r)),o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.dateToNumber({year:o.year,month:1,day:1}),l=this.dateTimeHelper.relativeNumberToAbsoluteNumber(a);if(i===21)return this.isoweeknumCore(r);const u=ak.get(i);return u===void 0?new E(N.NUM,_.BadMode):Math.floor((s-u)/7)-Math.floor((l-u)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),r=>{const{dateTime:i}=this.dateTimeHelper.parseDateTimeFromConfigFormats(r);return i===void 0?new E(N.VALUE,_.IncorrectDateTime):Jm(i)?(Ej(i)?Math.trunc(Ld(i)):0)+this.dateTimeHelper.dateToNumber(i):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),r=>{const i=this.dateTimeHelper.dateStringToDateNumber(r);return i===void 0?new E(N.VALUE,_.IncorrectDateTime):ve(i)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{const r=new Date(Date.now());return Ld({hours:r.getHours(),minutes:r.getMinutes(),seconds:r.getSeconds()})+this.dateTimeHelper.dateToNumber({year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{const r=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(r,i)=>{const s=this.dateTimeHelper.numberToSimpleDate(r),o=dve(GF(s,i));let a=this.dateTimeHelper.dateToNumber(o);return a=this.dateTimeHelper.getWithinBounds(a),a===void 0?new E(N.NUM,_.DateBounds):a})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(r,i,s)=>{if(r>i)return new E(N.NUM,_.StartEndDate);if(s==="D")return Math.floor(i)-Math.floor(r);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);switch(s){case"M":return(a.year-o.year)*12+(a.month-o.month)-(a.day<o.day?1:0);case"YM":return(12+(a.month-o.month)-(a.day<o.day?1:0))%12;case"Y":return a.month>o.month||a.month===o.month&&a.day>=o.day?a.year-o.year:a.year-o.year-1;case"MD":if(a.day>=o.day)return a.day-o.day;{const l=a.month===1?12:a.month-1,u=a.month===1?a.year-1:a.year;return this.dateTimeHelper.daysInMonth(u,l)+a.day-o.day}case"YD":return a.month>o.month||a.month===o.month&&a.day>=o.day?Math.floor(i)-this.dateTimeHelper.dateToNumber({year:a.year,month:o.month,day:o.day}):Math.floor(i)-Math.floor(r)-365*(a.year-o.year-1)-this.dateTimeHelper.leapYearsCount(a.year-1)+this.dateTimeHelper.leapYearsCount(o.year);default:return new E(N.NUM,_.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(r,i,s)=>{switch(r=Math.trunc(r),i=Math.trunc(i),r>i&&([r,i]=[i,r]),s){case 0:return this.days360Core(r,i,!1)/360;case 1:return(i-r)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(r),this.dateTimeHelper.numberToSimpleDate(i));case 2:return(i-r)/360;case 3:return(i-r)/365;case 4:return this.days360Core(r,i,!0)/360}throw new Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),r=>{r=Math.trunc(r);const i=r%60;r=Math.trunc(r/60);const s=r%60;r=Math.trunc(r/60);const o=r%24;r=Math.trunc(r/24);const a=r%30;r=Math.trunc(r/30);const l=r%12,u=Math.trunc(r/12);return"P"+(u>0?`${u}Y`:"")+(l>0?`${l}M`:"")+(a>0?`${a}D`:"")+"T"+(o>0?`${o}H`:"")+(s>0?`${s}M`:"")+(i>0?`${i}S`:"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(r,i,s)=>this.networkdayscore(r,i,1,s))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(r,i,s,o)=>this.networkdayscore(r,i,s,o))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(r,i,s)=>this.workdaycore(r,i,1,s))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(r,i,s,o)=>this.workdaycore(r,i,s,o))}networkdayscore(e,t,r,i){e=Math.trunc(e),t=Math.trunc(t);let s=1;e>t&&([e,t]=[t,e],s=-1);const o=ok(r);if(o instanceof E)return o;const a=this.simpleRangeToFilteredHolidays(o,i);return a instanceof E?a:s*this.countWorkdays(e,t,o,a)}workdaycore(e,t,r,i){e=Math.trunc(e),t=Math.trunc(t);const s=ok(r);if(s instanceof E)return s;const o=this.simpleRangeToFilteredHolidays(s,i);if(o instanceof E)return o;if(t>0){let a=1;for(;this.countWorkdays(e+1,e+a,s,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e+1,e+u,s,o)<t?l=u:a=u}return e+a}else if(t<0){t*=-1;let a=1;for(;this.countWorkdays(e-a,e-1,s,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e-u,e-1,s,o)<t?l=u:a=u}return e-a}else return e}countWorkdays(e,t,r,i){const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let a=0;for(let l=0;l<7;l++)r.charAt(l)==="0"&&(a+=Math.floor((s+6-l)/7),a-=Math.floor((o-1+6-l)/7));return a-=sk(t+1,i)-sk(e,i),a}simpleRangeToFilteredHolidays(e,t){var r;const i=(r=t?.valuesFromTopLeftCorner())!==null&&r!==void 0?r:[];for(const o of i)if(o instanceof E)return o;const s=[];for(const o of i)if(o!==ft)if(Pt(o))s.push(Math.trunc(ve(o)));else return new E(N.VALUE,_.WrongType);return[...new Set(s)].sort((o,a)=>o-a).filter(o=>{const l=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(o)-1)%7;return e.charAt(l)==="0"})}}Xj.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Me.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Me.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:g.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:g.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:g.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:g.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:g.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:g.NUMBER},{argumentType:g.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER}],returnNumberType:Me.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:g.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:g.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:g.STRING}],returnNumberType:Me.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:g.STRING}],returnNumberType:Me.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:Me.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:Me.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER}],returnNumberType:Me.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:g.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NOERROR,defaultValue:1},{argumentType:g.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER},{argumentType:g.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER},{argumentType:g.NOERROR,defaultValue:1},{argumentType:g.RANGE,optionalArg:!0}]}};function sk(n,e){if(e.length===0||n<=e[0])return 0;if(e[e.length-1]<n)return e.length;let t=0,r=e.length-1;for(;t+1<r;){const i=Math.floor((r+t)/2);e[i]>=n?r=i:t=i}return r}function ok(n){var e;return typeof n!="number"&&typeof n!="string"?new E(N.VALUE,_.WrongType):typeof n=="string"?n.length!==7||!/^(0|1)*$/.test(n)||n==="1111111"?new E(N.NUM,_.WeekendString):n:(e=Pye.get(n))!==null&&e!==void 0?e:new E(N.NUM,_.BadMode)}const ak=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),Pye=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);class Qj extends st{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),r=>r*(180/Math.PI))}}Qj.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:g.NUMBER}]}};class Zj extends st{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(r,i)=>r===i?1:0)}}Zj.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0}]}};class Jj extends st{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}Jj.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:g.NUMBER}]}};class e2 extends st{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),s_)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),n0)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),lk)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),r0)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(r,i,s,o,a,l)=>{if(o>a)return new E(N.NUM,_.EndStartPeriod);let u=0;for(let h=o;h<=a;h++)u+=n0(r,h,i,s,0,l);return u})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(r,i,s,o,a,l)=>{if(o>a)return new E(N.NUM,_.EndStartPeriod);let u=0;for(let h=o;h<=a;h++)u+=lk(r,h,i,s,0,l);return u})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(r,i,s,o,a)=>{if(a===12&&o>s||o>s+1)return new E(N.NUM,_.PeriodLong);if(i>=r)return 0;const l=Math.round((1-Math.pow(i/r,1/s))*1e3)/1e3,u=r*l*a/12;if(o===1)return u;let h=u;for(let c=0;c<o-2;c++)h+=(r-h)*l;return o===s+1?(r-h)*l*(12-a)/12:(r-h)*l})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(r,i,s,o,a)=>{if(o>s)return new E(N.NUM);let l=a/s,u;l>=1?(l=1,o===1?u=r:u=0):u=r*Math.pow(1-l,o-1);const h=r*Math.pow(1-l,o);return Math.max(u-Math.max(i,h),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(r,i)=>{if(i<1)return new E(N.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(r)+(r-Math.trunc(r))*10/i})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(r,i)=>{if(i<1)return new E(N.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(r)+(r-Math.trunc(r))*i/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(r,i)=>(i=Math.trunc(i),Math.pow(1+r/i,i)-1))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(r,i,s,o)=>s===0?new E(N.DIV_BY_ZERO):o*r*(i/s-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(r,i)=>(i=Math.trunc(i),(Math.pow(r+1,1/i)-1)*i))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(r,i,s,o,a)=>r===0?i===0?new E(N.DIV_BY_ZERO):(-s-o)/i:(a&&(i*=1+r),Math.log((i-o*r)/(s*r+i))/Math.log(1+r)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(r,i,s,o,a,l)=>{if(l<=-1)return new E(N.VALUE);const u=1e-7,h=50;let c=l;a=a?1:0;for(let d=0;d<h;d++){if(c<=-1)return new E(N.NUM);let f;if(Math.abs(c)<u)f=s*(1+r*c)+i*(1+c*a)*r+o;else{const p=Math.pow(1+c,r);f=s*p+i*(1/c+a)*(p-1)+o}if(Math.abs(f)<u)return c;let m;if(Math.abs(c)<u)m=s*r+i*a*r;else{const p=Math.pow(1+c,r),v=r*Math.pow(1+c,r-1);m=s*v+i*(1/c+a)*v+i*(-1/(c*c))*(p-1)}c-=f/m}return new E(N.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(r,i,s,o,a)=>(a=a?1:0,r===-1?i===0?new E(N.NUM):new E(N.DIV_BY_ZERO):r===0?-s*i-o:((1-Math.pow(1+r,i))*s*(1+r*a)/r-o)/Math.pow(1+r,i)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(r,i,s)=>i===0||s<0&&i>0||s>0&&i<0?new E(N.NUM):Math.pow(s/i,1/r)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(r,i,s)=>s===0?new E(N.DIV_BY_ZERO):(r-i)/s)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(r,i,s,o)=>o>s?new E(N.NUM):(r-i)*(s-o+1)*2/(s*(s+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new E(N.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new E(N.NUM);const l=360-s*(i-r);return l===0?0:l<0?new E(N.NUM):365*s/l})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new E(N.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new E(N.NUM);const l=360-s*(i-r);return l===0?0:l<0?new E(N.NUM):100*(1-s*(i-r)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new E(N.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);return a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day)?new E(N.NUM):(100-s)*360/(s*(i-r))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(r,i)=>{const s=i.valuesFromTopLeftCorner();for(const o of s)if(o instanceof E)return o;for(const o of s)if(Pt(o))r*=1+ve(o);else if(o!==ft)return new E(N.VALUE,_.NumberExpected);return r})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(r,...i)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(i);return s instanceof E?s:SA(r,s)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(r,i,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());if(o instanceof E)return o;let a=!1,l=!1;const u=[],h=[];for(const m of o)m>0?(a=!0,u.push(m),h.push(0)):m<0?(l=!0,h.push(m),u.push(0)):(h.push(0),u.push(0));if(!a||!l)return new E(N.DIV_BY_ZERO);const c=o.length,d=SA(s,u);if(d instanceof E)return d;const f=SA(i,h);return f instanceof E?f:Math.pow(-d*Math.pow(1+s,c)/f/(1+i),1/(c-1))-1})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(r,i,s)=>(Math.log(s)-Math.log(i))/Math.log(1+r))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(r,i,s)=>{const o=i.valuesFromTopLeftCorner();for(const d of o)if(typeof d!="number")return new E(N.VALUE,_.NumberExpected);const a=o,l=s.valuesFromTopLeftCorner();for(const d of l)if(typeof d!="number")return new E(N.VALUE,_.NumberExpected);const u=l;if(u.length!==a.length)return new E(N.NUM,_.EqualLength);const h=u.length;let c=0;if(u[0]<0)return new E(N.NUM,_.ValueSmall);for(let d=0;d<h;d++){if(u[d]=Math.floor(u[d]),u[d]<u[0])return new E(N.NUM,_.ValueSmall);c+=a[d]/Math.pow(1+r,(u[d]-u[0])/365)}return c})}}e2.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Me.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Me.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Me.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Me.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:0,maxValue:1}],returnNumberType:Me.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:0,maxValue:1}],returnNumberType:Me.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:Me.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.INTEGER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:Me.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1}],returnNumberType:Me.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1}],returnNumberType:Me.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Me.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:.1}],returnNumberType:Me.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Me.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Me.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0}],returnNumberType:Me.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0}],returnNumberType:Me.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0}],returnNumberType:Me.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0}],returnNumberType:Me.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:g.NUMBER},{argumentType:g.RANGE}],returnNumberType:Me.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:g.NUMBER},{argumentType:g.ANY}],repeatLastArgs:1,returnNumberType:Me.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Me.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:g.NUMBER,greaterThan:-1},{argumentType:g.RANGE},{argumentType:g.RANGE}]}};function s_(n,e,t,r,i){if(n===0)return(-t-r)/e;{const s=Math.pow(1+n,e);return(r*n+t*n*s)*(i?1/(1+n):1)/(1-s)}}function n0(n,e,t,r,i,s){const o=s_(n,t,r,i,s);return e===1?n*(s?0:-r):n*(s?r0(n,e-2,o,r,s)-o:r0(n,e-1,o,r,s))}function r0(n,e,t,r,i){if(n===0)return-r-t*e;{const s=Math.pow(1+n,e);return t*(i?1+n:1)*(1-s)/n-r*s}}function lk(n,e,t,r,i,s){return s_(n,t,r,i,s)-n0(n,e,t,r,i,s)}function SA(n,e){let t=0;for(let r=e.length-1;r>=0;r--){if(t+=e[r],n===-1){if(t===0)continue;return new E(N.DIV_BY_ZERO)}t/=1+n}return t}class t2 extends st{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new E(N.NA,_.WrongArgNumber),r=>{var i;return(i=this.serialization.getCellFormula(r))!==null&&i!==void 0?i:new E(N.NA,_.Formula)})}}t2.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:g.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};class n2 extends st{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),(r,i)=>(e.hyperlink=r,i??r))}}n2.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:g.STRING},{argumentType:g.STRING,optionalArg:!0}]}};class r2 extends st{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),r=>/^[01]{1,10}$/.test(r))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),r=>r instanceof E&&r.type!==N.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),r=>r instanceof E)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new E(N.NA,_.WrongArgNumber),r=>this.dependencyGraph.addressMapping.getCell(r)instanceof ts)}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),r=>r===ft)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),r=>r instanceof E&&r.type==N.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),Pt)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),r=>typeof r=="boolean")}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),r=>r instanceof E&&(r.type==N.REF||r.type==N.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),r=>typeof r=="string")}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),r=>typeof r!="string")}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,r=>r.col+1)}columns(e,t){if(e.args.length!==1)return new E(N.NA,_.WrongArgNumber);if(e.args.some(i=>i.type===M.EMPTY))return new E(N.NUM,_.EmptyArg);let r=e.args[0];for(;r.type===M.PARENTHESIS;)r=r.expression;if(r.type===M.CELL_RANGE||r.type===M.COLUMN_RANGE)return r.end.col-r.start.col+1;if(r.type===M.CELL_REFERENCE)return 1;if(r.type===M.ROW_RANGE)return this.config.maxColumns;{const i=this.evaluateAst(r,t);return i instanceof Oe?i.width():i instanceof E?i:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,r=>r.row+1)}rows(e,t){if(e.args.length!==1)return new E(N.NA,_.WrongArgNumber);if(e.args.some(i=>i.type===M.EMPTY))return new E(N.NUM,_.EmptyArg);let r=e.args[0];for(;r.type===M.PARENTHESIS;)r=r.expression;if(r.type===M.CELL_RANGE||r.type===M.ROW_RANGE)return r.end.row-r.start.row+1;if(r.type===M.CELL_REFERENCE)return 1;if(r.type===M.COLUMN_RANGE)return this.config.maxRows;{const i=this.evaluateAst(r,t);return i instanceof Oe?i.height():i instanceof E?i:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(r,i,s)=>{var o,a,l,u,h,c;return s<1||i<1?new E(N.VALUE,_.LessThanOne):s>r.width()||i>r.height()?new E(N.NUM,_.ValueLarge):(c=(l=(a=(o=r?.data)===null||o===void 0?void 0:o[i-1])===null||a===void 0?void 0:a[s-1])!==null&&l!==void 0?l:(h=(u=r?.data)===null||u===void 0?void 0:u[0])===null||h===void 0?void 0:h[0])!==null&&c!==void 0?c:new E(N.VALUE,_.CellRangeExpected)})}na(e,t){return new E(N.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,r=>r.sheet+1,r=>{const i=this.dependencyGraph.sheetMapping.get(r);return i!==void 0?i+1:new E(N.NA,_.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new E(N.VALUE,_.CellRefExpected))}}r2.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:g.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:g.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:g.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:g.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:g.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:g.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:g.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:g.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:g.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:g.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:g.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:g.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:g.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:g.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:g.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:g.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:g.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};class i2 extends st{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),r=>r%2===0)}}i2.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:g.NUMBER}]}};class s2 extends st{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),r=>r%2===1)}}s2.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:g.NUMBER}]}};class o2 extends st{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(r,i)=>Math.log(r)/Math.log(i))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}o2.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:g.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:g.NUMBER}]}};const i0=parseFloat(Math.PI.toFixed(14));class a2 extends st{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>i0)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),r=>Math.sqrt(i0*r))}}a2.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:g.NUMBER,minValue:0}]}};function uk(n,e){return new yt(e.width,n.height)}function RA(n,e,t){return new yt(1+(n.width-e)/t,1+(n.height-e)/t)}class l2 extends st{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(r,i)=>{if(!r.hasOnlyNumbers()||!i.hasOnlyNumbers())return new E(N.VALUE,_.NumberRange);if(i.height()!==r.width())return new E(N.VALUE,_.ArrayDimensions);const s=uk(r.size,i.size),o=this.createKernel(function(a,l,u){let h=0;for(let c=0;c<u;++c)h+=a[this.thread.y][c]*l[c][this.thread.x];return h},s)(r.rawNumbers(),i.rawNumbers(),r.width());return Oe.onlyNumbers(o)})}mmultArraySize(e,t){if(e.args.length!==2)return yt.error();const r=this.metadata("MMULT"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new ma(t.formulaAddress,t.arraysFlag||((l=r?.arrayFunction)!==null&&l!==void 0?l:!1)))}),[s,o]=i;return uk(s,o)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(r,i,s=i)=>{if(!r.hasOnlyNumbers())return new E(N.VALUE,_.NumberRange);const o=RA(r.size,i,s),a=this.createKernel(function(l,u,h){const c=this.thread.x*h,d=this.thread.y*h;let f=l[d][c];for(let m=0;m<u;m++)for(let p=0;p<u;p++)f=Math.max(f,l[d+m][c+p]);return f},o)(r.rawNumbers(),i,s);return Oe.onlyNumbers(a)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(r,i,s=i)=>{if(!r.hasOnlyNumbers())return new E(N.VALUE,_.NumberRange);const o=RA(r.size,i,s),a=this.createKernel(function(l,u,h){const c=this.thread.x*h,d=this.thread.y*h;let f=l[d][c];for(let R=0;R<u;R++)for(let T=0;T<u;T++)f=Math.max(f,l[d+R][c+T]);let m=l[d][c];for(let R=0;R<u;R++)for(let T=0;T<u;T++)m=Math.min(m,l[d+R][c+T]);const p=u*u;let v=m,y=f,S=42;for(let R=0;R<32;R++){const T=(v+y)/2;let I=0;for(let H=0;H<u;H++)for(let k=0;k<u;k++)l[d+H][c+k]>T&&I++;if(u%2===0)if(I===p/2){S=T;break}else I>p/2?v=T:y=T;else if(I===(p-1)/2){S=T;break}else I>(p-1)/2?v=T:y=T}return S},o)(r.rawNumbers(),i,s);return Oe.onlyNumbers(a)})}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return yt.error();const r=this.metadata("MAXPOOL"),s=e.args.map(u=>{var h;return this.arraySizeForAst(u,new ma(t.formulaAddress,t.arraysFlag||((h=r?.arrayFunction)!==null&&h!==void 0?h:!1)))})[0],o=e.args[1];let a;o.type===M.NUMBER?a=o.value:a=1;let l=a;if(e.args.length===3){const u=e.args[2];u.type===M.NUMBER?l=u.value:l=1}return a>s.width||a>s.height||l>a||(s.width-a)%l!==0||(s.height-a)%l!==0?yt.error():RA(s,a,l)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),r=>{const i=r.rawData(),s=r.size,o=[];for(let a=0;a<s.width;++a){o[a]=[];for(let l=0;l<s.height;++l)o[a][l]=i[l][a]}return Oe.onlyValues(o)})}transposeArraySize(e,t){if(e.args.length!==1)return yt.error();const r=this.metadata("TRANSPOSE"),i=e.args.map(o=>{var a;return this.arraySizeForAst(o,new ma(t.formulaAddress,t.arraysFlag||((a=r?.arrayFunction)!==null&&a!==void 0?a:!1)))}),[s]=i;return new yt(s.height,s.width)}createKernel(e,t){return function(...r){const i=[];for(let s=0;s<t.height;++s){i.push([]);for(let o=0;o<t.width;++o)i[s][o]=e.apply({thread:{x:o,y:s}},r)}return i}}}l2.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:g.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};class u2 extends st{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);return i instanceof E?i:i.length===0?new E(N.NUM,_.OneValue):(i.sort((s,o)=>s-o),i.length%2===0?(i[i.length/2-1]+i[i.length/2])/2:i[Math.floor(i.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());return s instanceof E?s:(s.sort((o,a)=>o-a),i=Math.trunc(i),i>s.length?new E(N.NUM,_.ValueLarge):s[s.length-i])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());return s instanceof E?s:(s.sort((o,a)=>o-a),i=Math.trunc(i),i>s.length?new E(N.NUM,_.ValueLarge):s[i-1])})}}u2.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER,minValue:1}]}};class h2 extends st{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(r,i)=>i===0?new E(N.DIV_BY_ZERO):r%i)}}h2.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]}};function sv(n){return Pt(n)&&!Number.isFinite(ve(n))?0:n}class lo{constructor(e,t,r){this.sumsq=e,this.sum=t,this.count=r}static single(e){return new lo(e*e,e,1)}compose(e){return new lo(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}varSValue(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}lo.empty=new lo(0,0,0);class o_ extends st{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,r=>Math.pow(ve(r),2),Zc)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){const r=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(i,s)=>Math.max(i,s),ve,ov);return sv(r)}min(e,t){return this.doMin(e.args,t)}mina(e,t){const r=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(i,s)=>Math.min(i,s),ve,ov);return sv(r)}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var r;const i=this.reduce(e.args,t,lo.empty,"_AGGREGATE_A",(s,o)=>s.compose(o),s=>lo.single(ve(s)),ov);return i instanceof E?i:(r=i.averageValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var r;const i=this.reduceAggregateA(e.args,t);return i instanceof E?i:(r=i.varSValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}varpa(e,t){var r;const i=this.reduceAggregateA(e.args,t);return i instanceof E?i:(r=i.varPValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof E)return r;{const i=r.varSValue();return i===void 0?new E(N.DIV_BY_ZERO):Math.sqrt(i)}}stdevpa(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof E)return r;{const i=r.varPValue();return i===void 0?new E(N.DIV_BY_ZERO):Math.sqrt(i)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new E(N.NA,_.WrongArgNumber);const r=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:g.NUMBER},t),i=e.args.slice(1);switch(r){case 1:case 101:return this.doAverage(i,t);case 2:case 102:return this.doCount(i,t);case 3:case 103:return this.doCounta(i,t);case 4:case 104:return this.doMax(i,t);case 5:case 105:return this.doMin(i,t);case 6:case 106:return this.doProduct(i,t);case 7:case 107:return this.doStdevS(i,t);case 8:case 108:return this.doStdevP(i,t);case 9:case 109:return this.doSum(i,t);case 10:case 110:return this.doVarS(i,t);case 11:case 111:return this.doVarP(i,t);default:return new E(N.VALUE,_.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,lo.empty,"_AGGREGATE",(r,i)=>r.compose(i),r=>lo.single(ve(r)),Zc)}reduceAggregateA(e,t){return this.reduce(e,t,lo.empty,"_AGGREGATE_A",(r,i)=>r.compose(i),r=>lo.single(ve(r)),ov)}doAverage(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof E?i:(r=i.averageValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}doVarS(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof E?i:(r=i.varSValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}doVarP(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof E?i:(r=i.varPValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}doStdevS(e,t){const r=this.reduceAggregate(e,t);if(r instanceof E)return r;{const i=r.varSValue();return i===void 0?new E(N.DIV_BY_ZERO):Math.sqrt(i)}}doStdevP(e,t){const r=this.reduceAggregate(e,t);if(r instanceof E)return r;{const i=r.varPValue();return i===void 0?new E(N.DIV_BY_ZERO):Math.sqrt(i)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",(r,i)=>r+i,ve,r=>Pt(r)?1:0)}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(r,i)=>r+i,ve,r=>r===ft?0:1)}doMax(e,t){const r=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(i,s)=>Math.max(i,s),ve,Zc);return sv(r)}doMin(e,t){const r=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(i,s)=>Math.min(i,s),ve,Zc);return sv(r)}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,ve,Zc)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(r,i)=>r*i,ve,Zc)}reduce(e,t,r,i,s,o,a){return e.length<1?new E(N.NA,_.WrongArgNumber):e.reduce((l,u)=>{if(l instanceof E)return l;if(u.type===M.CELL_RANGE||u.type===M.COLUMN_RANGE||u.type===M.ROW_RANGE){const c=this.evaluateRange(u,t,r,i,s,o,a);return c instanceof E?c:s(c,l)}let h;if(h=this.evaluateAst(u,t),h instanceof Oe)return Array.from(h.valuesFromTopLeftCorner()).map(a).filter(d=>d!==void 0).map(d=>d instanceof E?d:o(d)).reduce((d,f)=>d instanceof E?d:f instanceof E?f:s(d,f),l);if(u.type===M.CELL_REFERENCE){if(h=a(h),h===void 0)return l}else if(h=this.coerceScalarToNumberOrError(h),h=a(h),h===void 0)return l;return h instanceof E?h:s(l,o(h))},r)}evaluateRange(e,t,r,i,s,o,a){let l;try{l=Le.fromAst(e,t.formulaAddress)}catch(c){if(c instanceof Ng)return new E(N.REF,_.RangeManySheets);throw c}const u=this.dependencyGraph.getRange(l.start,l.end);if(u===void 0)throw new Error("Range does not exists in graph");let h=u.getFunctionValue(i);return h===void 0&&(h=this.getRangeValues(i,l,u,o,a).reduce((d,f)=>d instanceof E?d:f instanceof E?f:s(d,f),r),u.setFunctionValue(i,h)),h}getRangeValues(e,t,r,i,s){const o=[],{smallerRangeVertex:a,restRange:l}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let u;if(a!==void 0&&this.dependencyGraph.existsEdge(a,r)){const h=a.getFunctionValue(e);if(h!==void 0)o.push(h);else for(const c of a.range.addresses(this.dependencyGraph)){const d=s(this.dependencyGraph.getScalarValue(c));d instanceof E?o.push(d):d!==void 0&&o.push(i(d))}u=l}else u=t;for(const h of u.addresses(this.dependencyGraph)){const c=s(this.dependencyGraph.getScalarValue(h));c instanceof E?o.push(c):c!==void 0&&o.push(i(c))}return o}}o_.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:g.NUMBER},{argumentType:g.ANY}],repeatLastArgs:1}};o_.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function Zc(n){if(Pt(n)||n instanceof E)return n}function ov(n){return typeof n=="boolean"?zN(n):Pt(n)||n instanceof E?n:typeof n=="string"?0:void 0}class c2 extends st{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}c2.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]}};class d2 extends st{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),r=>r*(Math.PI/180))}}d2.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:g.NUMBER}]}};const Sr=10,f2=255,hk=2,ck=36,Lye="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class m2 extends st{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(r,i)=>Wa(r,2,i))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(r,i)=>Wa(r,8,i))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(r,i)=>Wa(r,16,i))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),r=>{const i=zo(r,2,Sr);return i===void 0?new E(N.NUM,_.NotBinary):$a(i,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(r,i)=>{const s=zo(r,2,Sr);return s===void 0?new E(N.NUM,_.NotBinary):Wa($a(s,2),8,i)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(r,i)=>{const s=zo(r,2,Sr);return s===void 0?new E(N.NUM,_.NotBinary):Wa($a(s,2),16,i)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),r=>{const i=zo(r,8,Sr);return i===void 0?new E(N.NUM,_.NotOctal):$a(i,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(r,i)=>{const s=zo(r,8,Sr);return s===void 0?new E(N.NUM,_.NotOctal):Wa($a(s,8),2,i)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(r,i)=>{const s=zo(r,8,Sr);return s===void 0?new E(N.NUM,_.NotOctal):Wa($a(s,8),16,i)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),r=>{const i=zo(r,16,Sr);return i===void 0?new E(N.NUM,_.NotHex):$a(i,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(r,i)=>{const s=zo(r,16,Sr);return s===void 0?new E(N.NUM,_.NotHex):Wa($a(s,16),2,i)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(r,i)=>{const s=zo(r,16,Sr);return s===void 0?new E(N.NUM,_.NotHex):Wa($a(s,16),8,i)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),Hye)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(r,i)=>{const s=zo(r,i,f2);return s===void 0?new E(N.NUM,_.NotHex):parseInt(s,i)})}}m2.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:g.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:Sr}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:Sr}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:g.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:Sr}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:Sr}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:g.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:Sr}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:Sr}]},DECIMAL:{method:"decimal",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,minValue:hk,maxValue:ck}]},BASE:{method:"base",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:hk,maxValue:ck},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:f2}]}};function zo(n,e,t){const r=Lye.substr(0,e),i=new RegExp(`^[${r}]+$`);if(!(n.length>t||!i.test(n)))return n}function Wa(n,e,t){if(n>Dye(e))return new E(N.NUM,_.ValueBaseLarge);if(n<g2(e))return new E(N.NUM,_.ValueBaseSmall);const r=p2(n,e);return t===void 0||n<0?r:r.length>t?new E(N.NUM,_.ValueBaseLong):Pi(r,t)}function g2(n){return-Math.pow(n,Sr)/2}function Dye(n){return-g2(n)-1}function Hye(n,e,t){const r=p2(n,e);return t!==void 0&&t>r.length?Pi(r,t):r}function p2(n,e){const t=n<0?Math.pow(e,Sr):0;return(n+t).toString(e).toUpperCase()}function $a(n,e){const t=parseInt(n,e),r=Math.pow(e,Sr);return t>=r/2?t-r:t}class w2 extends st{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(r,i)=>i<r?new E(N.NUM,_.WrongOrder):(r=Math.ceil(r),i=Math.floor(i)+1,r===i&&(i+=1),r+Math.floor(Math.random()*(i-r))))}}w2.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}],isVolatile:!0}};function dk(n){const e=Math.ceil(n);return e%2===1?e:e+1}function fk(n){const e=Math.ceil(n);return e%2===0?e:e+1}class a_ extends st{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.ceil(-r*s)/s:Math.ceil(r*s)/s})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.floor(-r*s)/s:Math.floor(r*s)/s})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.round(-r*s)/s:Math.round(r*s)/s})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),r=>r<0?-Math.floor(-r):Math.floor(r))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),r=>r<0?-fk(-r):fk(r))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),r=>r<0?-dk(-r):dk(r))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(r,i,s)=>i===0||r===0?0:(i=Math.abs(i),s===1&&r<0&&(i=-i),Math.ceil(r/i)*i))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(r,i)=>r===0?0:i===0?new E(N.DIV_BY_ZERO):r>0&&i<0?new E(N.NUM,_.DistinctSigns):Math.ceil(r/i)*i)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(r,i)=>i===0||r===0?0:(i=Math.abs(i),Math.ceil(r/i)*i))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(r,i,s)=>i===0||r===0?0:(i=Math.abs(i),s===1&&r<0&&(i*=-1),Math.floor(r/i)*i))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(r,i)=>r===0?0:i===0?new E(N.DIV_BY_ZERO):r>0&&i<0?new E(N.NUM,_.DistinctSigns):Math.floor(r/i)*i)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(r,i)=>i===0||r===0?0:(i=Math.abs(i),Math.floor(r/i)*i))}}a_.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:g.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:g.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:g.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1},{argumentType:g.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1},{argumentType:g.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1}]}};a_.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};class v2 extends st{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}v2.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:g.NUMBER}]}};function*Fye(){}function kye(n){const e=n[Symbol.iterator](),{done:t,value:r}=e.next();return t?{rest:Fye()}:{value:r,rest:e}}const Vye=(n,e,t)=>{if(t.end.row>t.start.row){const r=Ce(t.end.sheet,t.end.col,t.end.row-1),i=n.getRange(t.start,r);if(i!==void 0)return{smallerRangeVertex:i,restValuesRange:t.withStart(Ce(t.start.sheet,t.start.col,t.end.row)),restConditionRanges:e.map(s=>s.withStart(Ce(s.start.sheet,s.start.col,s.end.row)))}}return{restValuesRange:t,restConditionRanges:e}};class Uye{constructor(e,t,r,i,s){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=r,this.composeFunction=i,this.mapFunction=s,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const s of t)if(!s.conditionRange.sameDimensionsAs(e))return new E(N.VALUE,_.EqualLength);const r=this.tryToGetRangeVertexForRangeValue(e),i=t.map(s=>this.tryToGetRangeVertexForRangeValue(s.conditionRange));if(r&&i.every(s=>s!==void 0)){const s=t.map(l=>l.criterionPackage.raw).join(","),o=this.findAlreadyComputedValueInCache(r,this.cacheKey(t),s);if(o!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),o;const a=this.buildNewCriterionCache(this.cacheKey(t),t.map(l=>l.conditionRange.range),e.range);return a.has(s)||a.set(s,[this.evaluateRangeValue(e,t),t.map(l=>l.criterionPackage.lambda)]),r.setCriterionFunctionValues(this.cacheKey(t),a),i.forEach(l=>{l!==void 0&&l.addDependentCacheRange(r)}),a.get(s)[0]}else return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;if(t!==void 0)return this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const r of e)t=this.composeFunction(t,r);return t}findAlreadyComputedValueInCache(e,t,r){return e.getCriterionFunctionValue(t,r)}evaluateRangeValue(e,t){const r=t.map(a=>a.criterionPackage.lambda),i=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),s=t.map(a=>a.conditionRange.iterateValuesFromTopLeftCorner()),o=gk(r,s,i);return this.reduceFunction(o)}buildNewCriterionCache(e,t,r){const i=this.dependencyGraph.getRange(r.start,r.end),{smallerRangeVertex:s,restConditionRanges:o,restValuesRange:a}=Vye(this.dependencyGraph,t,r);let l;s!==void 0&&this.dependencyGraph.existsEdge(s,i)?l=s.getCriterionFunctionValues(e):l=new Map;const u=new Map;return l.forEach(([h,c],d)=>{const f=gk(c,o.map(p=>mk(this.dependencyGraph,p)),Array.from(mk(this.dependencyGraph,a)).map(this.mapFunction)[Symbol.iterator]()),m=this.composeFunction(h,this.reduceFunction(f));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),u.set(d,[m,c])}),u}}class Bye{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*mk(n,e){for(const t of e.addresses(n))yield ve(n.getScalarValue(t))}function*gk(n,e,t){for(const r of t){const i=e.map(o=>kye(o));if(!i.every(o=>Object.prototype.hasOwnProperty.call(o,"value")))return;const s=i.map(o=>ve(o.value));Wye(s,n).every(([o,a])=>a(o))&&(yield r),e=i.map(o=>o.rest)}}function Wye(n,e){const t=[];for(let r=0;r<Math.min(n.length,e.length);r++)t.push([n[r],e[r]]);return t}class wu{constructor(e,t){this.sum=e,this.count=t}static single(e){return new wu(e,1)}compose(e){return new wu(this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}}wu.empty=new wu(0,0);function $ye(n){return e=>{const t=e.map(r=>`${r.conditionRange.range.sheet},${r.conditionRange.range.start.col},${r.conditionRange.range.start.row}`);return[n,...t].join(",")}}function pk(n){return Pt(n)&&!Number.isFinite(ve(n))?0:n}function av(n){if(n instanceof E)return n;if(Pt(n))return ve(n)}class y2 extends st{sumif(e,t){const r="SUMIF",i=(s,o,a)=>this.computeConditionalAggregationFunction(a??s,[s,o],r,0,(l,u)=>this.arithmeticHelper.nonstrictadd(l,u),av);return this.runFunction(e.args,t,this.metadata(r),i)}sumifs(e,t){const r="SUMIFS",i=(s,...o)=>this.computeConditionalAggregationFunction(s,o,r,0,(a,l)=>this.arithmeticHelper.nonstrictadd(a,l),av);return this.runFunction(e.args,t,this.metadata(r),i)}averageif(e,t){const r="AVERAGEIF",i=(s,o,a)=>{const l=this.computeConditionalAggregationFunction(a??s,[s,o],r,wu.empty,(u,h)=>u.compose(h),u=>Pt(u)?wu.single(ve(u)):wu.empty);return l instanceof E?l:l.averageValue()||new E(N.DIV_BY_ZERO)};return this.runFunction(e.args,t,this.metadata(r),i)}countif(e,t){const r="COUNTIF",i=(s,o)=>this.computeConditionalAggregationFunction(s,[s,o],r,0,(a,l)=>a+l,()=>1);return this.runFunction(e.args,t,this.metadata(r),i)}countifs(e,t){const r="COUNTIFS",i=(...s)=>this.computeConditionalAggregationFunction(s[0],s,r,0,(o,a)=>o+a,()=>1);return this.runFunction(e.args,t,this.metadata(r),i)}minifs(e,t){const r="MINIFS",i=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.min(o,a),s=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,r,Number.POSITIVE_INFINITY,i,av);return pk(l)};return this.runFunction(e.args,t,this.metadata(r),s)}maxifs(e,t){const r="MAXIFS",i=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.max(o,a),s=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,r,Number.NEGATIVE_INFINITY,i,av);return pk(l)};return this.runFunction(e.args,t,this.metadata(r),s)}computeConditionalAggregationFunction(e,t,r,i,s,o){const a=[];for(let l=0;l<t.length;l+=2){const u=t[l],h=this.interpreter.criterionBuilder.fromCellValue(t[l+1],this.arithmeticHelper);if(h===void 0)return new E(N.VALUE,_.BadCriterion);a.push(new Bye(u,h))}return new Uye(this.interpreter,$ye(r),i,s,o).compute(e,a)}}y2.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:g.RANGE},{argumentType:g.NOERROR},{argumentType:g.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:g.RANGE},{argumentType:g.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:g.RANGE},{argumentType:g.NOERROR},{argumentType:g.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE},{argumentType:g.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:g.RANGE},{argumentType:g.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE},{argumentType:g.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE},{argumentType:g.NOERROR}],repeatLastArgs:2}};class C2 extends st{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...r)=>{const i=r[0].width(),s=r[0].height();for(const l of r)if(l.width()!==i||l.height()!==s)return new E(N.VALUE,_.EqualLength);let o=0;const a=r.map(l=>l.iterateValuesFromTopLeftCorner());for(let l=0;l<i*s;l++){let u=1;for(const h of a){const c=h.next().value;if(c instanceof E)return c;const d=this.coerceScalarToNumberOrError(c);Pt(d)?u*=ve(d):u=0}o+=u}return o})}}C2.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:g.RANGE}],repeatLastArgs:1}};class S2 extends st{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...r)=>"".concat(...r))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(r,i)=>{const s=r.split(" ");return i>=s.length||i<0?new E(N.VALUE,_.IndexBounds):s[i]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),r=>r.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),r=>r.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),r=>r.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),r=>r.replace(new RegExp("\\p{L}+","gu"),i=>i.charAt(0).toUpperCase()+i.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),r=>r.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(r,i)=>r===i)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(r,i)=>i<0?new E(N.VALUE,_.NegativeCount):r.repeat(i))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(r,i)=>i<0?new E(N.VALUE,_.NegativeLength):i===0?"":r.slice(-i))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(r,i)=>i<0?new E(N.VALUE,_.NegativeLength):r.slice(0,i))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(r,i,s)=>i<1?new E(N.VALUE,_.LessThanOne):s<0?new E(N.VALUE,_.NegativeLength):r.substring(i-1,i+s-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(r,i,s,o)=>i<1?new E(N.VALUE,_.LessThanOne):s<0?new E(N.VALUE,_.NegativeLength):r.substring(0,i-1)+o+r.substring(i+s-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(r,i,s)=>{if(s<1||s>i.length)return new E(N.VALUE,_.LengthBounds);const o=r.toLowerCase(),a=i.substring(s-1).toLowerCase(),l=this.arithmeticHelper.requiresRegex(o)?this.arithmeticHelper.searchString(o,a):a.indexOf(o);return l>-1?l+s:new E(N.VALUE,_.PatternNotFound)})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(r,i,s,o)=>{const a=this.escapeRegExpSpecialCharacters(i),l=new RegExp(a,"g");if(o===void 0)return r.replace(l,s);if(o<1)return new E(N.VALUE,_.LessThanOne);let u,h=0;for(;(u=l.exec(r))!==null;)if(o===++h)return r.substring(0,u.index)+s+r.substring(l.lastIndex);return r})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(r,i,s)=>{if(s<1||s>i.length)return new E(N.VALUE,_.IndexBounds);const a=i.substring(s-1).indexOf(r)+s;return a>0?a:new E(N.VALUE,_.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),r=>r instanceof E||typeof r=="string"?r:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),r=>r.toUpperCase())}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}S2.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:g.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:g.STRING},{argumentType:g.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:g.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:g.STRING}]},MID:{method:"mid",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:g.STRING}]},T:{method:"t",parameters:[{argumentType:g.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:g.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:g.STRING}]},REPT:{method:"rept",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:g.STRING},{argumentType:g.STRING},{argumentType:g.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:g.STRING},{argumentType:g.STRING},{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:g.STRING},{argumentType:g.STRING},{argumentType:g.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:g.STRING}]}};class R2 extends st{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(r,i)=>r===0&&i===0?new E(N.DIV_BY_ZERO):Math.atan2(i,r))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),r=>r===0?new E(N.DIV_BY_ZERO):1/Math.tan(r))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),r=>r===0?i0/2:Math.atan(1/r))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),r=>1/Math.cos(r))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),r=>r===0?new E(N.DIV_BY_ZERO):1/Math.sin(r))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),r=>r===0?new E(N.DIV_BY_ZERO):1/Math.tanh(r))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),r=>r===0?new E(N.NUM,_.NonZero):Math.atanh(1/r))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),r=>1/Math.cosh(r))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),r=>r===0?new E(N.DIV_BY_ZERO):1/Math.sinh(r))}}R2.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:g.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:g.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:g.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:g.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:g.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:g.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:g.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:g.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:g.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:g.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:g.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:g.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:g.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:g.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:g.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:g.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:g.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:g.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:g.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:g.NUMBER}]}};class Gye extends Lj{constructor(e){super(e),this.dependencyGraph=e}find(e,t,r){return this.basicFind(e,t,"col",r)}}class E2 extends st{constructor(){super(...arguments),this.rowSearch=new Gye(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(r,i,s,o)=>{const a=i.range;return a===void 0?new E(N.VALUE,_.WrongType):s<1?new E(N.VALUE,_.LessThanOne):s>a.width()?new E(N.REF,_.IndexLarge):this.doVlookup(wA(r),i,s-1,o)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(r,i,s,o)=>{const a=i.range;return a===void 0?new E(N.VALUE,_.WrongType):s<1?new E(N.VALUE,_.LessThanOne):s>a.height()?new E(N.REF,_.IndexLarge):this.doHlookup(wA(r),i,s-1,o)})}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(r,i,s)=>this.doMatch(wA(r),i,s))}searchInRange(e,t,r,i){if(!r&&typeof e=="string"&&this.arithmeticHelper.requiresRegex(e))return i.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t);{const s=r?{ordering:"asc"}:{ordering:"none",matchExactly:!0};return i.find(e,t,s)}}doVlookup(e,t,r,i){this.dependencyGraph.stats.start(tt.VLOOKUP);const s=t.range;let o;s===void 0?o=Oe.onlyValues(t.data.map(u=>[u[0]])):o=Oe.onlyRange(Le.spanFrom(s.start,1,s.height()),this.dependencyGraph);const a=this.searchInRange(e,o,i,this.columnSearch);if(this.dependencyGraph.stats.end(tt.VLOOKUP),a===-1)return new E(N.NA,_.ValueNotFound);let l;if(s===void 0)l=t.data[a][r];else{const u=Ce(s.sheet,s.start.col+r,s.start.row+a);l=this.dependencyGraph.getCellValue(u)}return l instanceof Oe?new E(N.VALUE,_.WrongType):l}doHlookup(e,t,r,i){const s=t.range;let o;s===void 0?o=Oe.onlyValues([t.data[0]]):o=Oe.onlyRange(Le.spanFrom(s.start,s.width(),1),this.dependencyGraph);const a=this.searchInRange(e,o,i,this.rowSearch);if(a===-1)return new E(N.NA,_.ValueNotFound);let l;if(s===void 0)l=t.data[r][a];else{const u=Ce(s.sheet,s.start.col+a,s.start.row+r);l=this.dependencyGraph.getCellValue(u)}return l instanceof Oe?new E(N.VALUE,_.WrongType):l}doMatch(e,t,r){if(![-1,0,1].includes(r))return new E(N.VALUE,_.BadMode);if(t.width()>1&&t.height()>1)return new E(N.NA);const i=t.width()===1?this.columnSearch:this.rowSearch,s=r===0?{ordering:"none",matchExactly:!0}:{ordering:r===-1?"desc":"asc"},o=i.find(e,t,s);return o===-1?new E(N.NA,_.ValueNotFound):o+1}}E2.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:g.NOERROR},{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:g.NOERROR},{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:g.NOERROR},{argumentType:g.RANGE},{argumentType:g.NUMBER,defaultValue:1}]}};class b2 extends st{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(r,i)=>(r=Math.trunc(r),i===!1?i=4:i===!0&&(i=0),i=ve(this.coerceScalarToNumberOrError(i)),i instanceof E?i:(i=Math.trunc(i),i<0?new E(N.VALUE,_.ValueSmall):i>4?new E(N.VALUE,_.ValueLarge):jye(r,i))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),r=>{r=r.trim().toUpperCase();let i=!1;if(r.startsWith("-")&&(r=r.slice(1),i=!0,r===""))return new E(N.VALUE,_.InvalidRoman);const s={input:r,acc:0};return Yo(s,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),Yo(s,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),Yo(s,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),Yo(s,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),Yo(s,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),Yo(s,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),Yo(s,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),Yo(s,{token:"IX",val:9}),Yo(s,{token:"V",val:5},{token:"IV",val:4}),Yo(s,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),s.input!==""?new E(N.VALUE,_.InvalidRoman):i?-s.acc:s.acc})}}b2.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:g.NUMBER,minValue:1,lessThan:4e3},{argumentType:g.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:g.STRING}]}};function Yo(n,...e){for(const t of e)if(n.input.startsWith(t.token)){n.input=n.input.slice(t.token.length),n.acc+=t.val;break}}function jye(n,e){const t={val:n%1e3,acc:"M".repeat(Math.floor(n/1e3))};return e===4&&(zn(t,"IM",999,1e3),zn(t,"ID",499,500)),e>=3&&(zn(t,"VM",995,1e3),zn(t,"VD",495,500)),e>=2&&(zn(t,"XM",990,1e3),zn(t,"XD",490,500)),e>=1&&(zn(t,"LM",950,1e3),zn(t,"LD",450,500)),zn(t,"CM",900,1e3),zn(t,"CD",400,500),zn(t,"D",500,900),t.acc+="C".repeat(Math.floor(t.val/100)),t.val%=100,e>=2&&(zn(t,"IC",99,100),zn(t,"IL",49,50)),e>=1&&(zn(t,"VC",95,100),zn(t,"VL",45,50)),zn(t,"XC",90,100),zn(t,"XL",40,50),zn(t,"L",50,90),t.acc+="X".repeat(Math.floor(t.val/10)),t.val%=10,zn(t,"IX",9,10),zn(t,"IV",4,5),zn(t,"V",5,9),t.acc+="I".repeat(t.val),t.acc}function zn(n,e,t,r){n.val>=t&&n.val<r&&(n.val-=t,n.acc+=e)}class T2 extends st{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}T2.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:g.STRING,passSubtype:!0},{argumentType:g.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:g.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:g.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:g.NUMBER,passSubtype:!0}]}};var lt=Math;function Tn(n,e){for(var t=0,r=0;t<n.length;++t)r=e*r+n[t];return r}function A2(n,e,t,r,i){if(e===0)return t;if(e===1)return r;for(var s=2/n,o=r,a=1;a<e;++a)o=r*a*s+i*t,t=r,r=o;return o}function N2(n,e,t,r,i){return function(o,a){if(r){if(o===0)return r==1?-1/0:1/0;if(o<0)return NaN}if(a===0)return n(o);if(a===1)return e(o);if(a<0)return NaN;a|=0;var l=n(o),u=e(o);return A2(o,a,l,u,i)}}var s0=(function(){var n=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),t=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function s(c){var d=0,f=0,m=0,p=c*c;if(c<8)f=Tn(e,p),m=Tn(t,p),d=f/m;else{var v=c-.785398164;p=64/p,f=Tn(r,p),m=Tn(i,p),d=lt.sqrt(n/c)*(lt.cos(v)*f-lt.sin(v)*m*8/c)}return d}var o=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),a=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function h(c){var d=0,f=0,m=0,p=c*c,v=lt.abs(c)-2.356194491;return Math.abs(c)<8?(f=c*Tn(o,p),m=Tn(a,p),d=f/m):(p=64/p,f=Tn(l,p),m=Tn(u,p),d=lt.sqrt(n/lt.abs(c))*(lt.cos(v)*f-lt.sin(v)*m*8/lt.abs(c)),c<0&&(d=-d)),d}return function c(d,f){if(f=Math.round(f),!isFinite(d))return isNaN(d)?d:0;if(f<0)return(f%2?-1:1)*c(d,-f);if(d<0)return(f%2?-1:1)*c(-d,f);if(f===0)return s(d);if(f===1)return h(d);if(d===0)return 0;var m=0;if(d>f)m=A2(d,f,s(d),h(d),-1);else{for(var p=2*lt.floor((f+lt.floor(lt.sqrt(40*f)))/2),v=!1,y=0,S=0,R=1,T=0,I=2/d,H=p;H>0;H--)T=H*I*R-y,y=R,R=T,lt.abs(R)>1e10&&(R*=1e-10,y*=1e-10,m*=1e-10,S*=1e-10),v&&(S+=R),v=!v,H==f&&(m=y);S=2*S-R,m/=S}return m}})(),zye=(function(){var n=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),t=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function s(c){var d=0,f=0,m=0,p=c*c,v=c-.785398164;return c<8?(f=Tn(e,p),m=Tn(t,p),d=f/m+n*s0(c,0)*lt.log(c)):(p=64/p,f=Tn(r,p),m=Tn(i,p),d=lt.sqrt(n/c)*(lt.sin(v)*f+lt.cos(v)*m*8/c)),d}var o=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),a=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function h(c){var d=0,f=0,m=0,p=c*c,v=c-2.356194491;return c<8?(f=c*Tn(o,p),m=Tn(a,p),d=f/m+n*(s0(c,1)*lt.log(c)-1/c)):(p=64/p,f=Tn(l,p),m=Tn(u,p),d=lt.sqrt(n/c)*(lt.sin(v)*f+lt.cos(v)*m*8/c)),d}return N2(s,h,"BESSELY",1,-1)})(),o0=(function(){var n=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function t(o){return o<=3.75?Tn(n,o*o/(3.75*3.75)):lt.exp(lt.abs(o))/lt.sqrt(lt.abs(o))*Tn(e,3.75/lt.abs(o))}var r=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),i=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function s(o){return o<3.75?o*Tn(r,o*o/(3.75*3.75)):(o<0?-1:1)*lt.exp(lt.abs(o))/lt.sqrt(lt.abs(o))*Tn(i,3.75/lt.abs(o))}return function o(a,l){if(l=Math.round(l),l===0)return t(a);if(l===1)return s(a);if(l<0)return NaN;if(lt.abs(a)===0)return 0;if(a==1/0)return 1/0;var u=0,h,c=2/lt.abs(a),d=0,f=1,m=0,p=2*lt.round((l+lt.round(lt.sqrt(40*l)))/2);for(h=p;h>0;h--)m=h*c*f+d,d=f,f=m,lt.abs(f)>1e10&&(f*=1e-10,d*=1e-10,u*=1e-10),h==l&&(u=d);return u*=o(a,0)/f,a<0&&l%2?-u:u}})(),Yye=(function(){var n=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function t(o){return o<=2?-lt.log(o/2)*o0(o,0)+Tn(n,o*o/4):lt.exp(-o)/lt.sqrt(o)*Tn(e,2/o)}var r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),i=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function s(o){return o<=2?lt.log(o/2)*o0(o,1)+1/o*Tn(r,o*o/4):lt.exp(-o)/lt.sqrt(o)*Tn(i,2/o)}return N2(t,s,"BESSELK",2,1)})();function Dd(n){const e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let t=e.length-1,r=!1,i=0,s=0,o,a,l,u;if(n===0)return 0;for(n<0&&(n=-n,r=!0),o=2/(2+n),a=4*o-2;t>0;t--)l=i,i=a*i-s+e[t],s=l;return u=o*Math.exp(-n*n+.5*(e[0]+a*i)-s),r?u-1:1-u}function I2(n){return 1-Dd(n)}function M2(n){let e=0,t,r,i,s;if(n>=2)return-100;if(n<=0)return 100;for(s=n<1?n:2-n,i=Math.sqrt(-2*Math.log(s/2)),t=-.70711*((2.30753+i*.27061)/(1+i*(.99229+i*.04481))-i);e<2;e++)r=I2(t)-s,t+=r/(1.1283791670955126*Math.exp(-t*t)-t*r);return n<1?t:-t}const wk={pdf:(n,e)=>n<0?0:e*Math.exp(-e*n),cdf:(n,e)=>n<0?0:1-Math.exp(-e*n)};function tg(n){const e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],t=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let r=!1,i=0,s=0,o=0,a=n,l,u,h,c;if(n>171.6243769536076)return 1/0;if(a<=0)if(c=a%1,c)r=(a&1?-1:1)*Math.PI/Math.sin(Math.PI*c),a=1-a;else return 1/0;for(h=a,a<1?u=a++:u=(a-=i=(a|0)-1)-1,l=0;l<8;++l)o=(o+e[l])*u,s=s*u+t[l];if(c=o/s+1,h<a)c/=h;else if(h>a)for(l=0;l<i;++l)c*=a,a++;return r&&(c=r/c),c}const EA={pdf:function(e,t,r){return e<0?0:e===0&&t===1?1/r:Math.exp((t-1)*Math.log(e)-e/r-Ar(t)-t*Math.log(r))},cdf:function(e,t,r){return e<0?0:l_(t,e/r)},inv:function(n,e,t){return O2(n,e)*t}};function Ar(n){let e=0;const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let r=1.000000000190015,i,s,o;for(o=(s=i=n)+5.5,o-=(i+.5)*Math.log(o);e<6;e++)r+=t[e]/++s;return Math.log(2.5066282746310007*r/i)-o}function l_(n,e){const t=Ar(n);let r=n,i=1/n,s=i,o=e+1-n,a=1/1e-30,l=1/o,u=l,h=1;const c=-~(Math.log(n>=1?n:1/n)*8.5+n*.4+17);let d;if(e<0||n<=0)return NaN;if(e<n+1){for(;h<=c;h++)i+=s*=e/++r;return i*Math.exp(-e+n*Math.log(e)-t)}for(;h<=c;h++)d=-h*(h-n),o+=2,l=d*l+o,a=o+d/a,l=1/l,u*=l*a;return 1-u*Math.exp(-e+n*Math.log(e)-t)}function O2(n,e){let t=0;const r=e-1,i=1e-8,s=Ar(e);let o,a,l,u,h,c,d;if(n>=1)return Math.max(100,e+100*Math.sqrt(e));if(n<=0)return 0;for(e>1?(c=Math.log(r),d=Math.exp(r*(c-1)-s),h=n<.5?n:1-n,l=Math.sqrt(-2*Math.log(h)),o=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,n<.5&&(o=-o),o=Math.max(.001,e*Math.pow(1-1/(9*e)-o/(3*Math.sqrt(e)),3))):(l=1-e*(.253+e*.12),n<l?o=Math.pow(n/l,1/e):o=1-Math.log(1-(n-l)/(1-l)));t<12;t++){if(o<=0)return 0;if(a=l_(e,o)-n,e>1?l=d*Math.exp(-(o-r)+r*(Math.log(o)-c)):l=Math.exp(-o+r*Math.log(o)-s),u=a/l,o-=l=u/(1-.5*Math.min(1,u*((e-1)/o-1))),o<=0&&(o=.5*(o+l)),Math.abs(l)<i*o)break}return o}const so={pdf:function(e,t,r){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(e-t,2)/(2*r*r))},cdf:function(e,t,r){return .5*(1+Dd((e-t)/Math.sqrt(2*r*r)))},inv:function(n,e,t){return-1.4142135623730951*t*M2(2*n)+e}},bA={pdf:function(e,t,r){return e>1||e<0?0:t==1&&r==1?1:t<512&&r<512?Math.pow(e,t-1)*Math.pow(1-e,r-1)/u_(t,r):Math.exp((t-1)*Math.log(e)+(r-1)*Math.log(1-e)-_2(t,r))},cdf:function(e,t,r){return e>1||e<0?+(e>1):NS(e,t,r)},inv:function(e,t,r){return h_(e,t,r)}};function u_(n,e){if(!(n<=0||e<=0))return n+e>170?Math.exp(_2(n,e)):tg(n)*tg(e)/tg(n+e)}function _2(n,e){return Ar(n)+Ar(e)-Ar(n+e)}function h_(n,e,t){var r=1e-8,i=e-1,s=t-1,o=0,a,l,u,h,c,d,f,m,p,v,y;if(n<=0)return 0;if(n>=1)return 1;for(e>=1&&t>=1?(u=n<.5?n:1-n,h=Math.sqrt(-2*Math.log(u)),f=(2.30753+h*.27061)/(1+h*(.99229+h*.04481))-h,n<.5&&(f=-f),m=(f*f-3)/6,p=2/(1/(2*e-1)+1/(2*t-1)),v=f*Math.sqrt(m+p)/p-(1/(2*t-1)-1/(2*e-1))*(m+5/6-2/(3*p)),f=e/(e+t*Math.exp(2*v))):(a=Math.log(e/(e+t)),l=Math.log(t/(e+t)),h=Math.exp(e*a)/e,c=Math.exp(t*l)/t,v=h+c,n<h/v?f=Math.pow(e*v*n,1/e):f=1-Math.pow(t*v*(1-n),1/t)),y=-Ar(e)-Ar(t)+Ar(e+t);o<10;o++){if(f===0||f===1)return f;if(d=NS(f,e,t)-n,h=Math.exp(i*Math.log(f)+s*Math.log(1-f)+y),c=d/h,f-=h=c/(1-.5*Math.min(1,c*(i/f-s/(1-f)))),f<=0&&(f=.5*(f+h)),f>=1&&(f=.5*(f+h+1)),Math.abs(h)<r*f&&o>0)break}return f}function NS(n,e,t){var r=n===0||n===1?0:Math.exp(Ar(e+t)-Ar(e)-Ar(t)+e*Math.log(n)+t*Math.log(1-n));return n<0||n>1?!1:n<(e+1)/(e+t+2)?r*vk(n,e,t)/e:1-r*vk(1-n,t,e)/t}function vk(n,e,t){var r=1e-30,i=1,s=e+t,o=e+1,a=e-1,l=1,u=1-s*n/o,h,c,d,f;for(Math.abs(u)<r&&(u=r),u=1/u,f=u;i<=100&&(h=2*i,c=i*(t-i)*n/((a+h)*(e+h)),u=1+c*u,Math.abs(u)<r&&(u=r),l=1+c/l,Math.abs(l)<r&&(l=r),u=1/u,f*=u*l,c=-(e+i)*(s+i)*n/((e+h)*(o+h)),u=1+c*u,Math.abs(u)<r&&(u=r),l=1+c/l,Math.abs(l)<r&&(l=r),u=1/u,d=u*l,f*=d,!(Math.abs(d-1)<3e-7));i++);return f}const Gv={pdf:function(n,e,t){return t===0||t===1?e*t===n?1:0:x2(e,n)*Math.pow(t,n)*Math.pow(1-t,e-n)},cdf:function(n,e,t){var r,i=1e-10;if(n<0)return 0;if(n>=e)return 1;if(t<0||t>1||e<=0)return NaN;n=Math.floor(n);var s=t,o=n+1,a=e-n,l=o+a,u=Math.exp(Ar(l)-Ar(a)-Ar(o)+o*Math.log(s)+a*Math.log(1-s));return s<(o+1)/(l+2)?r=u*yk(s,o,a,i):r=1-u*yk(1-s,a,o,i),Math.round((1-r)*(1/i))/(1/i)}};function yk(n,e,t,r){for(var i=0,s=1,o=1,a=1,l=0,u=0,h;Math.abs((o-u)/o)>r;)u=o,h=-(e+l)*(e+t+l)*n/(e+2*l)/(e+2*l+1),i=o+h*i,s=a+h*s,l=l+1,h=l*(t-l)*n/(e+2*l-1)/(e+2*l),o=i+h*o,a=s+h*a,i=i/a,s=s/a,o=o/a,a=1;return o/e}function x2(n,e){return n>170||e>170?Math.exp(Kye(n,e)):jv(n)/jv(e)/jv(n-e)}function Kye(n,e){return TA(n)-TA(e)-TA(n-e)}function TA(n){return n<0?NaN:Ar(n+1)}function jv(n){return n<0?NaN:tg(n+1)}const hd={pdf:function(e,t){return e<0?0:e===0&&t===2?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-Ar(t/2))},cdf:function(e,t){return e<0?0:l_(t/2,e/2)},inv:function(n,e){return 2*O2(n,.5*e)}},cd={pdf:function(e,t,r){var i,s,o;return e<0?0:t<=2?e===0&&t<2?1/0:e===0&&t===2?1:1/u_(t/2,r/2)*Math.pow(t/r,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/r*e,-(t+r)/2):(i=t*e/(r+e*t),s=r/(r+e*t),o=t*s/2,o*Gv.pdf((t-2)/2,(t+r-2)/2,i))},cdf:function(e,t,r){return e<0?0:NS(t*e/(t*e+r),t/2,r/2)},inv:function(e,t,r){return r/(t*(1/h_(e,t/2,r/2)-1))}},Ck={pdf:function(e,t,r){return e<0||t<0||r<0?0:r/t*Math.pow(e/t,r-1)*Math.exp(-Math.pow(e/t,r))},cdf:function(e,t,r){return e<0?0:1-Math.exp(-Math.pow(e/t,r))}},a0={pdf:function(e,t){return t<0||e%1!==0||e<0?0:Math.pow(t,e)*Math.exp(-t)/jv(e)},cdf:function(e,t){var r=0;if(e<0)return 0;for(var i=0;r<=e;r++)i+=a0.pdf(r,t);return i}},Ja={pdf:function(e,t,r,i){if(e<0||e<r-(t-i))return 0;if(e>i||e>r)return 0;if(r*2>t)return i*2>t?Ja.pdf(t-r-i+e,t,t-r,t-i):Ja.pdf(i-e,t,t-r,i);if(i*2>t)return Ja.pdf(r-e,t,r,t-i);if(r<i)return Ja.pdf(e,t,i,r);for(var s=1,o=0,a=0;a<e;a++){for(;s>1&&o<i;)s*=1-r/(t-o),o++;s*=(i-a)*(r-a)/((a+1)*(t-r-i+a+1))}for(;o<i;o++)s*=1-r/(t-o);return Math.min(1,Math.max(0,s))},cdf:function n(e,t,r,i){if(e<0||e<r-(t-i))return 0;if(e>=i||e>=r)return 1;if(r*2>t)return i*2>t?n(t-r-i+e,t,t-r,t-i):1-Ja.cdf(i-e-1,t,t-r,i);if(i*2>t)return 1-Ja.cdf(r-e-1,t,r,t-i);if(r<i)return Ja.cdf(e,t,i,r);for(var s=1,o=1,a=0,l=0;l<e;l++){for(;s>1&&a<i;){var u=1-r/(t-a);o*=u,s*=u,a++}o*=(i-l)*(r-l)/((l+1)*(t-r-i+l+1)),s+=o}for(;a<i;a++)s*=1-r/(t-a);return Math.min(1,Math.max(0,s))}},Rs={pdf:function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*u_(.5,t/2))*Math.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var r=t/2;return NS((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),r,r)},inv:function(n,e){var t=h_(2*Math.min(n,1-n),.5*e,.5);return t=Math.sqrt(e*(1-t)/t),n>.5?t:-t}},AA={pdf:function(e,t,r){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(Math.log(e)-t,2)/(2*r*r))},cdf:function(e,t,r){return e<0?0:.5+.5*Dd((Math.log(e)-t)/Math.sqrt(2*r*r))},inv:function(n,e,t){return Math.exp(-1.4142135623730951*t*M2(2*n)+e)}},l0={pdf:function(e,t,r){return e!==e>>>0?!1:e<0?0:x2(e+t-1,t-1)*Math.pow(1-r,e)*Math.pow(r,t)},cdf:function(e,t,r){var i=0,s=0;if(e<0)return 0;for(;s<=e;s++)i+=l0.pdf(s,t,r);return i}};function P2(n){for(var e=0,t=n.length;--t>=0;)e+=n[t];return e}function gs(n){return P2(n)/n.length}function Eh(n){for(var e=gs(n),t=0,r=n.length,i;--r>=0;)i=n[r]-e,t+=i*i;return t}function Sm(n,e){return Eh(n)/(n.length-(e?1:0))}function hu(n,e){return Math.sqrt(Sm(n,e))}function qye(){var n=[].slice.call(arguments),e=new Array(2),t;return n.length===4?t=Math.abs(so.inv(n[1]/2,0,1)*n[2]/Math.sqrt(n[3])):t=Math.abs(so.inv(n[1]/2,0,1)*hu(n[2])/Math.sqrt(n[2].length)),e[0]=n[0]-t,e[1]=n[0]+t,e}function Xye(){var n=[].slice.call(arguments),e=new Array(2),t;return n.length===4?t=Math.abs(Rs.inv(n[1]/2,n[3]-1)*n[2]/Math.sqrt(n[3])):t=Math.abs(Rs.inv(n[1]/2,n[2].length-1)*hu(n[2],!0)/Math.sqrt(n[2].length)),e[0]=n[0]-t,e[1]=n[0]+t,e}function Qye(n){for(var e=1,t=n.length;--t>=0;)e*=n[t];return e}function Zye(n){return Math.pow(Qye(n),1/n.length)}function Rm(n,e){var t=gs(n),r=gs(e),i=n.length,s=new Array(i),o;for(o=0;o<i;o++)s[o]=(n[o]-t)*(e[o]-r);return P2(s)/(i-1)}function Sk(n,e){return Rm(n,e)/hu(n,1)/hu(e,1)}class c_ extends st{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(r,i)=>i===void 0?Dd(r):Dd(i)-Dd(r))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),I2)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(r,i,s)=>s?wk.cdf(r,i):wk.pdf(r,i))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),r=>Math.log((1+r)/(1-r))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),r=>1-2/(Math.exp(2*r)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),tg)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(r,i,s,o)=>o?EA.cdf(r,i,s):EA.pdf(r,i,s))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),Ar)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),EA.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),r=>so.cdf(r,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(r,i,s,o,a,l)=>r<=a?new E(N.NUM,_.ValueSmall):r>=l?new E(N.NUM,_.ValueLarge):(r=(r-a)/(l-a),o?bA.cdf(r,i,s):bA.pdf(r,i,s)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(r,i,s,o,a)=>o>=a?new E(N.NUM,_.WrongOrder):bA.inv(r,i,s)*(a-o)+o)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(r,i,s,o)=>r>i?new E(N.NUM,_.WrongOrder):(r=Math.trunc(r),i=Math.trunc(i),o?Gv.cdf(r,i,s):Gv.pdf(r,i,s)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(r,i,s)=>{r=Math.trunc(r);let o=-1,a=r;for(;a>o+1;){const l=Math.trunc((o+a)/2);Gv.cdf(l,r,i)>=s?a=l:o=l}return a})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(r,i)=>o0(r,Math.trunc(i)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(r,i)=>s0(r,Math.trunc(i)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(r,i)=>Yye(r,Math.trunc(i)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(r,i)=>zye(r,Math.trunc(i)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(r,i,s)=>(i=Math.trunc(i),s?hd.cdf(r,i):hd.pdf(r,i)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(r,i)=>1-hd.cdf(r,Math.trunc(i)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(r,i)=>hd.inv(r,Math.trunc(i)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(r,i)=>hd.inv(1-r,Math.trunc(i)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(r,i,s,o)=>(i=Math.trunc(i),s=Math.trunc(s),o?cd.cdf(r,i,s):cd.pdf(r,i,s)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(r,i,s)=>1-cd.cdf(r,Math.trunc(i),Math.trunc(s)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(r,i,s)=>cd.inv(r,Math.trunc(i),Math.trunc(s)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(r,i,s)=>cd.inv(1-r,Math.trunc(i),Math.trunc(s)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(r,i,s,o)=>o?Ck.cdf(r,s,i):Ck.pdf(r,s,i))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(r,i,s)=>(r=Math.trunc(r),s?a0.cdf(r,i):a0.pdf(r,i)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(r,i,s,o,a)=>r>i||r>s||i>o||s>o?new E(N.NUM,_.ValueLarge):r+o<s+i?new E(N.NUM,_.ValueLarge):(r=Math.trunc(r),i=Math.trunc(i),s=Math.trunc(s),o=Math.trunc(o),a?Ja.cdf(r,o,s,i):Ja.pdf(r,o,s,i)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(r,i,s)=>(i=Math.trunc(i),s?Rs.cdf(r,i):Rs.pdf(r,i)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(r,i)=>(1-Rs.cdf(r,Math.trunc(i)))*2)}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(r,i)=>1-Rs.cdf(r,Math.trunc(i)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(r,i,s)=>s*(1-Rs.cdf(r,Math.trunc(i))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(r,i)=>Rs.inv(r,Math.trunc(i)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(r,i)=>Rs.inv(1-r/2,Math.trunc(i)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(r,i,s,o)=>o?AA.cdf(r,i,s):AA.pdf(r,i,s))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(r,i,s)=>AA.inv(r,i,s))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(r,i,s,o)=>o?so.cdf(r,i,s):so.pdf(r,i,s))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(r,i,s)=>so.inv(r,i,s))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(r,i)=>i?so.cdf(r,0,1):so.pdf(r,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),r=>so.inv(r,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),r=>so.pdf(r,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(r,i,s,o)=>(r=Math.trunc(r),i=Math.trunc(i),o?l0.cdf(r,i,s):l0.pdf(r,i,s)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(r,i,s)=>qye(1,r,i,Math.trunc(s))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(r,i,s)=>(s=Math.trunc(s),s===1?new E(N.DIV_BY_ZERO):Xye(1,r,i,s)[1]-1))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(r,i,s)=>(r-i)/s)}}c_.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:g.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:g.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:g.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:g.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:g.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:g.NUMBER,minValue:0,lessThan:1},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:g.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:g.NUMBER,greaterThan:0,maxValue:1},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:1,maxValue:1e10},{argumentType:g.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:1},{argumentType:g.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:1},{argumentType:g.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1},{argumentType:g.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:g.NUMBER,greaterThan:0,maxValue:1},{argumentType:g.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:g.NUMBER},{argumentType:g.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:g.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0}]}};c_.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};class L2 extends st{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),r=>{r=Math.trunc(r);let i=1;for(let s=1;s<=r;s++)i*=s;return i})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),r=>{r=Math.trunc(r);let i=1;for(let s=r;s>=1;s-=2)i*=s;return i})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(r,i)=>i>r?new E(N.NUM,_.WrongOrder):(r=Math.trunc(r),i=Math.trunc(i),Rk(r,i)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(r,i)=>(r=Math.trunc(r),i=Math.trunc(i),r+i-1>=1030?new E(N.NUM,_.ValueLarge):r===0&&i===0?1:Rk(r+i-1,i)))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(r);if(i instanceof E)return i;let s=0;for(const o of i){if(o<0)return new E(N.NUM,_.ValueSmall);s=D2(s,Math.trunc(o))}return s>Number.MAX_SAFE_INTEGER?new E(N.NUM,_.ValueLarge):s})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(r);if(i instanceof E)return i;let s=1;for(const o of i){if(o<0)return new E(N.NUM,_.ValueSmall);s=Jye(s,Math.trunc(o))}return s>Number.MAX_SAFE_INTEGER?new E(N.NUM,_.ValueLarge):s})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(r,i)=>i===0?0:r>0&&i<0||r<0&&i>0?new E(N.NUM,_.DistinctSigns):Math.round(r/i)*i)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...r)=>{let i=0,s=1;for(let o of r){if(o<0)return new E(N.NUM,_.ValueSmall);o=Math.trunc(o);for(let a=1;a<=o;a++)s*=(i+a)/a;i+=o}return Math.round(s)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(r,i)=>i===0?new E(N.DIV_BY_ZERO):Math.trunc(r/i))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(r,i,s,o)=>{const a=this.arithmeticHelper.manyToOnlyNumbersDropNulls(o.valuesFromTopLeftCorner());if(a instanceof E)return a;let l=0;a.reverse();for(const u of a)l*=Math.pow(r,s),l+=u;return l*Math.pow(r,i)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),r=>r>0?1:r<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new E(N.NA,_.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const h=s[u],c=o[u];if(h instanceof E)return h;if(c instanceof E)return c;typeof h=="number"&&typeof c=="number"&&(l+=Math.pow(h,2)-Math.pow(c,2))}return l})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new E(N.NA,_.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const h=s[u],c=o[u];if(h instanceof E)return h;if(c instanceof E)return c;typeof h=="number"&&typeof c=="number"&&(l+=Math.pow(h,2)+Math.pow(c,2))}return l})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new E(N.NA,_.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const h=s[u],c=o[u];if(h instanceof E)return h;if(c instanceof E)return c;typeof h=="number"&&typeof c=="number"&&(l+=Math.pow(h-c,2))}return l})}}L2.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:g.NUMBER,minValue:0,lessThan:1030},{argumentType:g.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:g.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:g.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]}};function Rk(n,e){2*e>n&&(e=n-e);let t=1;for(let r=1;r<=e;r++)t*=(n-e+r)/r;return Math.round(t)}function D2(n,e){for(n<e&&([n,e]=[e,n]);e>0;)[n,e]=[e,n%e];return n}function Jye(n,e){return n===0||e===0?0:n*(e/D2(n,e))}class H2 extends st{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(r,i,s)=>s!=="i"&&s!=="j"?new E(N.VALUE,_.ShouldBeIorJ):kn([r,i],s))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),V2)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([r,i])=>i)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([r,i])=>r)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([r,i])=>r===0&&i===0?new E(N.DIV_BY_ZERO):Math.atan2(i,r))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([r,i])=>kn([r,-i]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),r=>kn(lv(r)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),r=>kn(Ek(r)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),r=>kn(vh(lv(r),uv(r))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),r=>kn(vh([1,0],uv(r))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),r=>kn(vh([1,0],bk(r))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),r=>kn(vh([1,0],lv(r))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),r=>kn(vh([1,0],Ek(r))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),r=>kn(uv(r)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),r=>kn(bk(r)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),r=>kn(vh(uv(r),lv(r))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(r,i)=>kn(vh(r,i)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...r)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(r);if(i instanceof E)return i;let s=[1,0];for(const o of i)s=F2(s,o);return kn(s)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...r)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(r);if(i instanceof E)return i;let s=[0,0];for(const o of i)s=eCe(s,o);return kn(s)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(r,i)=>kn(tCe(r,i)))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),r=>kn(k2(r)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),r=>kn(zv(r)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),r=>{const[i,s]=zv(r),o=Math.log(10);return kn([i/o,s/o])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),r=>{const[i,s]=zv(r),o=Math.log(2);return kn([i/o,s/o])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(r,i)=>kn(Tk(r,i)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),r=>kn(Tk(r,.5)))}}H2.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:g.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:g.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:g.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:g.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:g.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:g.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:g.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:g.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:g.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:g.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:g.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:g.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:g.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:g.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:g.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:g.COMPLEX},{argumentType:g.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:g.COMPLEX},{argumentType:g.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:g.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:g.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:g.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:g.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:g.COMPLEX},{argumentType:g.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:g.COMPLEX}]}};function eCe([n,e],[t,r]){return[n+t,e+r]}function tCe([n,e],[t,r]){return[n-t,e-r]}function F2([n,e],[t,r]){return[n*t-e*r,n*r+t*e]}function vh([n,e],[t,r]){const i=Math.pow(t,2)+Math.pow(r,2),[s,o]=F2([n,e],[t,-r]);return[s/i,o/i]}function lv([n,e]){return[Math.cos(n)*Math.cosh(e),-Math.sin(n)*Math.sinh(e)]}function Ek([n,e]){return[Math.cosh(n)*Math.cos(e),Math.sinh(n)*Math.sin(e)]}function uv([n,e]){return[Math.sin(n)*Math.cosh(e),Math.cos(n)*Math.sinh(e)]}function bk([n,e]){return[Math.sinh(n)*Math.cos(e),Math.cosh(n)*Math.sin(e)]}function k2([n,e]){return[Math.exp(n)*Math.cos(e),Math.exp(n)*Math.sin(e)]}function V2([n,e]){return Math.sqrt(n*n+e*e)}function zv([n,e]){return[Math.log(V2([n,e])),Math.atan2(e,n)]}function Tk(n,e){const[t,r]=zv(n);return k2([e*t,e*r])}class d_ extends st{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;if(i.length===0)return new E(N.DIV_BY_ZERO);const s=gs(i);return i.reduce((o,a)=>o+Math.abs(a-s),0)/i.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);return i instanceof E?i:i.length===0?0:Eh(i)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;if(i.length===0)return new E(N.NUM,_.OneValue);for(const s of i)if(s<=0)return new E(N.NUM,_.ValueSmall);return Zye(i)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;if(i.length===0)return new E(N.NUM,_.OneValue);for(const s of i)if(s<=0)return new E(N.NUM,_.ValueSmall);return i.length/i.reduce((s,o)=>s+1/o,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=yh(r,i);return s instanceof E?s:s[0].length<=1?new E(N.DIV_BY_ZERO,_.TwoValues):Sk(s[0],s[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=yh(r,i);return s instanceof E?s:s[0].length<=1?new E(N.DIV_BY_ZERO,_.TwoValues):Math.pow(Sk(s[0],s[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=yh(r,i);if(s instanceof E)return s;const o=s[0].length;return o<1?new E(N.DIV_BY_ZERO,_.OneValue):o===1?0:Rm(s[0],s[1])*(o-1)/o})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=yh(r,i);return s instanceof E?s:s[0].length<=1?new E(N.DIV_BY_ZERO,_.TwoValues):Rm(s[0],s[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(r,i,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());if(o instanceof E)return o;const a=o.length;if(s===void 0){if(a<2)return new E(N.DIV_BY_ZERO,_.TwoValues);s=hu(o,!0)}return a<1?new E(N.NA,_.OneValue):s===0?new E(N.DIV_BY_ZERO):1-so.cdf((gs(o)-i)/(s/Math.sqrt(a)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner()),o=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(s instanceof E)return s;if(o instanceof E)return o;if(s.length<=1||o.length<=1)return new E(N.DIV_BY_ZERO);const a=Sm(s,!0),l=Sm(o,!0);if(a===0||l===0)return new E(N.DIV_BY_ZERO);const u=a/l,h=cd.cdf(u,s.length-1,o.length-1);return 2*Math.min(h,1-h)})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=yh(r,i);if(s instanceof E)return s;const o=s[0].length;return o<=2?new E(N.DIV_BY_ZERO,_.ThreeValues):Math.sqrt((Eh(s[0])-Math.pow(Rm(s[0],s[1])*(o-1),2)/Eh(s[1]))/(o-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=yh(r,i);if(s instanceof E)return s;const o=s[0].length;return o<=1?new E(N.DIV_BY_ZERO,_.TwoValues):Rm(s[0],s[1])*(o-1)/Eh(s[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(r,i)=>{const s=r.height(),o=r.width();if(i.height()!==s||i.width()!==o)return new E(N.NA,_.EqualLength);const a=yh(r,i);if(a instanceof E)return a;if(a[0].length<=1)return new E(N.DIV_BY_ZERO,_.TwoValues);let l=0;for(let u=0;u<a[0].length;u++){if(a[1][u]===0)return new E(N.DIV_BY_ZERO);l+=Math.pow(a[0][u]-a[1][u],2)/a[1][u]}return l<0?new E(N.NUM,_.NaN):1-hd.cdf(l,s>1&&o>1?(s-1)*(o-1):s*o-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(r,i,s,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner()),l=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(a instanceof E)return a;if(l instanceof E)return l;const u=a.length,h=l.length;if(o===1){if(h!==u)return new E(N.NA,_.EqualLength);if(u<=1)return new E(N.DIV_BY_ZERO,_.TwoValues);const c=Array(u);for(let m=0;m<u;m++)c[m]=a[m]-l[m];const d=hu(c,!0);if(d===0)return new E(N.DIV_BY_ZERO);const f=Math.abs(Math.sqrt(u)*gs(c)/d);return s*(1-Rs.cdf(f,u-1))}else if(o===2){if(u<=1||h<=1)return new E(N.DIV_BY_ZERO,_.TwoValues);const c=(Eh(a)+Eh(l))/(u+h-2);if(c===0)return new E(N.DIV_BY_ZERO);const d=Math.abs((gs(a)-gs(l))/Math.sqrt(c*(1/u+1/h)));return s*(1-Rs.cdf(d,u+h-2))}else{if(u<=1||h<=1)return new E(N.DIV_BY_ZERO,_.TwoValues);const c=Sm(a,!0),d=Sm(l,!0);if(c===0&&d===0)return new E(N.DIV_BY_ZERO);const f=Math.abs((gs(a)-gs(l))/Math.sqrt(c/u+d/h)),m=Math.pow(c/u+d/h,2)/(Math.pow(c/u,2)/(u-1)+Math.pow(d/h,2)/(h-1));return s*(1-Rs.cdf(f,m))}})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;const s=i.length;if(s<3)return new E(N.DIV_BY_ZERO,_.ThreeValues);const o=gs(i),a=hu(i,!0);return a===0?new E(N.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)*s/(s-1)/(s-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;const s=i.length;if(s<3)return new E(N.DIV_BY_ZERO,_.ThreeValues);const o=gs(i),a=hu(i,!1);return a===0?new E(N.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)/s})}}d_.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE},{argumentType:g.INTEGER,minValue:1,maxValue:2},{argumentType:g.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:g.ANY}],repeatLastArgs:1}};d_.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function yh(n,e){const t=n.iterateValuesFromTopLeftCorner(),r=e.iterateValuesFromTopLeftCorner();let i,s;const o=[],a=[];for(;i=t.next(),s=r.next(),!i.done&&!s.done;){const l=i.value,u=s.value;if(l instanceof E)return l;if(u instanceof E)return u;Pt(l)&&Pt(u)&&(o.push(ve(l)),a.push(ve(u)))}return[o,a]}const Ak=Object.freeze(Object.defineProperty({__proto__:null,AbsPlugin:Vj,AddressPlugin:Fj,ArrayPlugin:kj,BitShiftPlugin:Uj,BitwiseLogicOperationsPlugin:Gj,BooleanPlugin:jj,CharPlugin:zj,CodePlugin:Yj,ComplexPlugin:H2,ConditionalAggregationPlugin:y2,CountBlankPlugin:Kj,CountUniquePlugin:qj,DateTimePlugin:Xj,DegreesPlugin:Qj,DeltaPlugin:Zj,ExpPlugin:Jj,FinancialPlugin:e2,FormulaTextPlugin:t2,HyperlinkPlugin:n2,InformationPlugin:r2,IsEvenPlugin:i2,IsOddPlugin:s2,LogarithmPlugin:o2,LookupPlugin:E2,MathConstantsPlugin:a2,MathPlugin:L2,MatrixPlugin:l2,MedianPlugin:u2,ModuloPlugin:h2,NumericAggregationPlugin:o_,PowerPlugin:c2,RadiansPlugin:d2,RadixConversionPlugin:m2,RandomPlugin:w2,RomanPlugin:b2,RoundingPlugin:a_,SimpleArithmerticPlugin:T2,SqrtPlugin:v2,StatisticalAggregationPlugin:d_,StatisticalPlugin:c_,SumprodPlugin:C2,TextPlugin:S2,TrigonometryPlugin:R2},Symbol.toStringTag,{value:"Module"}));class pt extends Ir{}pt.HyperFormula=Ir;pt.ErrorType=N;pt.CellError=E;pt.CellType=xi;pt.CellValueType=uo;pt.CellValueDetailedType=Hwe;pt.DetailedCellError=Cj;pt.ExportedCellChange=e0;pt.ExportedNamedExpressionChange=xj;pt.ConfigValueTooBigError=lj;pt.ConfigValueTooSmallError=aj;pt.EvaluationSuspendedError=hj;pt.ExpectedOneOfValuesError=uj;pt.ExpectedValueOfTypeError=_t;pt.ArraySize=yt;pt.SimpleRangeValue=Oe;pt.EmptyValue=ft;pt.FunctionPlugin=st;pt.FunctionArgumentType=g;pt.FunctionPluginValidationError=zd;pt.InvalidAddressError=ej;pt.InvalidArgumentsError=rr;pt.LanguageNotRegisteredError=$N;pt.LanguageAlreadyRegisteredError=dj;pt.MissingTranslationError=ld;pt.NamedExpressionDoesNotExistError=Ig;pt.NamedExpressionNameIsAlreadyTakenError=tj;pt.NamedExpressionNameIsInvalidError=nj;pt.NoOperationToRedoError=ij;pt.NoOperationToUndoError=rj;pt.NoRelativeAddressesAllowedError=t_;pt.NoSheetWithIdError=On;pt.NoSheetWithNameError=JG;pt.NotAFormulaError=Uv;pt.NothingToPasteError=sj;pt.ProtectedFunctionTranslationError=cj;pt.SheetNameAlreadyTakenError=Ag;pt.SheetSizeLimitExceededError=Vh;pt.SourceLocationHasArrayError=Cd;pt.TargetLocationHasArrayError=oC;pt.UnableToParseError=oj;const nCe=Hr.defaultConfig.language;Ir.registerLanguage(nCe,t0);Ir.languages[t0.langCode]=t0;for(const n of Object.getOwnPropertyNames(Ak))n.startsWith("_")||Ir.registerFunctionPlugin(Ak[n]);sme();const rCe=ei(fr)(({theme:n})=>({flex:1,overflow:"hidden","& .handsontable":{fontFamily:n.typography.fontFamily,fontSize:"14px"},"& .handsontable th":{backgroundColor:n.palette.mode==="dark"?yn(n.palette.text.primary,.05):Zr[50],fontWeight:600},"& .handsontable td":{verticalAlign:"middle"},"& .handsontable td.area":{backgroundColor:n.palette.mode==="dark"?yn(n.palette.text.primary,.1):Zr[100]},"& .handsontable .htContextMenu":{borderRadius:8,boxShadow:n.shadows[8]},"& .handsontable .wtBorder.current":{backgroundColor:n.palette.mode==="dark"?Zr[500]:Zr[700]}})),iCe=Ir.buildEmpty({licenseKey:"gpl-v3"}),sCe=n=>{const e=[];for(let t=0;t<n;t++){let r="",i=t;for(;i>=0;)r=String.fromCharCode(i%26+65)+r,i=Math.floor(i/26)-1;e.push(r)}return e};function oCe({data:n=[],columns:e=26,rows:t=100,onCellChange:r,onSelectionChange:i,onFormulaBarUpdate:s,readOnly:o=!1,contextMenuEnabled:a=!0,formulas:l=!0}){u0();const u=Ae.useRef(null),[h,c]=Ae.useState(null),[d,f]=Ae.useState(null),m=Ae.useMemo(()=>n&&n.length>0?n:Array(t).fill(null).map(()=>Array(e).fill("")),[n,t,e]),p=Ae.useMemo(()=>sCe(e),[e]),v=Ae.useCallback((T,I)=>{if(!T||I==="loadData")return;const H=T.map(([k,W,Y,$])=>({row:k,col:W,oldValue:Y,newValue:$,cellRef:`${p[W]}${k+1}`}));r?.(H,I)},[p,r]),y=Ae.useCallback((T,I,H,k)=>{const W={start:{row:T,col:I,ref:`${p[I]}${T+1}`},end:{row:H,col:k,ref:`${p[k]}${H+1}`},isRange:T!==H||I!==k};f(W),i?.(W);const Y=u.current?.hotInstance;if(Y){const $=Y.getDataAtCell(T,I),q=Y.getCellMeta(T,I);s?.({cellRef:W.start.ref,value:$||"",formula:q?.formula||null})}},[p,s,i]);Ae.useCallback(T=>{T.preventDefault(),c({mouseX:T.clientX,mouseY:T.clientY})},[]);const S=Ae.useCallback(()=>{c(null)},[]);Ae.useCallback(T=>{const I=u.current?.hotInstance;if(I){switch(T){case"copy":document.execCommand("copy");break;case"cut":document.execCommand("cut");break;case"paste":document.execCommand("paste");break;case"delete":if(d){const{start:H,end:k}=d;for(let W=Math.min(H.row,k.row);W<=Math.max(H.row,k.row);W++)for(let Y=Math.min(H.col,k.col);Y<=Math.max(H.col,k.col);Y++)I.setDataAtCell(W,Y,"")}break;case"insert_row_above":d&&I.alter("insert_row_above",d.start.row);break;case"insert_row_below":d&&I.alter("insert_row_below",d.start.row);break;case"delete_row":d&&I.alter("remove_row",d.start.row);break;case"insert_col_left":d&&I.alter("insert_col_start",d.start.col);break;case"insert_col_right":d&&I.alter("insert_col_end",d.start.col);break;case"delete_col":d&&I.alter("remove_col",d.start.col);break}S()}},[S,d]);const R=Ae.useMemo(()=>({data:m,colHeaders:p,rowHeaders:!0,width:"100%",height:"100%",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,readOnly:o,manualColumnResize:!0,manualRowResize:!0,manualColumnMove:!0,manualRowMove:!0,dropdownMenu:a,filters:!0,multiColumnSorting:!0,mergeCells:!0,undo:!0,autoColumnSize:{syncLimit:100},autoRowSize:{syncLimit:100},licenseKey:"non-commercial-and-evaluation",formulas:l?{engine:iCe}:!1,cells:function(T,I){return{}},comments:!0,validator:(T,I)=>{I(!0)},afterChange:v,afterSelection:y,afterScrollVertically:()=>{},afterScrollHorizontally:()=>{},contextMenu:a?{items:{copy:{name:"Copy",disabled:!1},cut:{name:"Cut",disabled:!1},hsep1:"---------",row_above:{name:"Insert row above"},row_below:{name:"Insert row below"},remove_row:{name:"Remove row"},hsep2:"---------",col_left:{name:"Insert column left"},col_right:{name:"Insert column right"},remove_col:{name:"Remove column"},hsep3:"---------",undo:{name:"Undo"},redo:{name:"Redo"}}}:!1}),[m,p,o,a,l,v,y]);return Ae.useEffect(()=>{if(u.current){const T=u.current.hotInstance;u.current.setSelectedCellValue=I=>{d&&T&&T.setDataAtCell(d.start.row,d.start.col,I)},u.current.getData=()=>T?.getData()||[],u.current.loadData=I=>T?.loadData(I),u.current.insertRow=(I,H=1)=>{T?.alter("insert_row_below",I,H)},u.current.insertColumn=(I,H=1)=>{T?.alter("insert_col_end",I,H)}}},[d]),te.jsx(rCe,{children:te.jsx(DB,{ref:u,settings:R})})}const aCe=ei(fr)(({theme:n})=>({display:"flex",alignItems:"center",padding:n.spacing(1,2),borderBottom:`1px solid ${yn(n.palette.divider,.1)}`,backgroundColor:n.palette.background.paper,gap:n.spacing(1)})),lCe=ei(fr)(({theme:n})=>({display:"flex",alignItems:"center",minWidth:80,padding:n.spacing(.5,1),backgroundColor:n.palette.mode==="dark"?yn(n.palette.text.primary,.05):Zr[50],borderRadius:8,border:`1px solid ${yn(n.palette.divider,.2)}`,cursor:"pointer","&:hover":{borderColor:n.palette.mode==="dark"?Zr[500]:Zr[700]}})),uCe=ei(hv)(({theme:n})=>({flex:1,"& .MuiOutlinedInput-root":{borderRadius:8,fontSize:"14px",fontFamily:"monospace","& fieldset":{borderColor:yn(n.palette.divider,.2)},"&:hover fieldset":{borderColor:n.palette.mode==="dark"?yn(n.palette.text.primary,.3):Zr[300]},"&.Mui-focused fieldset":{borderColor:n.palette.mode==="dark"?Zr[500]:Zr[700]}}})),Nk=ei(h0)(({theme:n})=>({borderRadius:8,height:24,fontSize:"0.75rem",fontFamily:"monospace",backgroundColor:n.palette.mode==="dark"?yn(n.palette.text.primary,.1):Zr[100],color:"text.secondary","&:hover":{backgroundColor:n.palette.mode==="dark"?yn(n.palette.text.primary,.15):Zr[200]}})),Ik=[{name:"SUM",syntax:"SUM(range)",description:"Sum of values"},{name:"AVERAGE",syntax:"AVERAGE(range)",description:"Average of values"},{name:"COUNT",syntax:"COUNT(range)",description:"Count of numbers"},{name:"COUNTA",syntax:"COUNTA(range)",description:"Count of non-empty cells"},{name:"MAX",syntax:"MAX(range)",description:"Maximum value"},{name:"MIN",syntax:"MIN(range)",description:"Minimum value"},{name:"IF",syntax:"IF(condition, true_val, false_val)",description:"Conditional logic"},{name:"VLOOKUP",syntax:"VLOOKUP(value, range, col, exact)",description:"Vertical lookup"},{name:"HLOOKUP",syntax:"HLOOKUP(value, range, row, exact)",description:"Horizontal lookup"},{name:"SUMIF",syntax:"SUMIF(range, criteria, sum_range)",description:"Conditional sum"},{name:"COUNTIF",syntax:"COUNTIF(range, criteria)",description:"Conditional count"},{name:"CONCATENATE",syntax:"CONCATENATE(text1, text2, ...)",description:"Join text"},{name:"LEFT",syntax:"LEFT(text, num_chars)",description:"Left characters"},{name:"RIGHT",syntax:"RIGHT(text, num_chars)",description:"Right characters"},{name:"MID",syntax:"MID(text, start, length)",description:"Middle characters"},{name:"LEN",syntax:"LEN(text)",description:"Text length"},{name:"TRIM",syntax:"TRIM(text)",description:"Remove extra spaces"},{name:"ROUND",syntax:"ROUND(number, decimals)",description:"Round number"},{name:"ABS",syntax:"ABS(number)",description:"Absolute value"},{name:"TODAY",syntax:"TODAY()",description:"Current date"},{name:"NOW",syntax:"NOW()",description:"Current date and time"},{name:"YEAR",syntax:"YEAR(date)",description:"Year from date"},{name:"MONTH",syntax:"MONTH(date)",description:"Month from date"},{name:"DAY",syntax:"DAY(date)",description:"Day from date"}];function hCe({cellRef:n="",value:e="",formula:t=null,onChange:r,onApply:i,onCancel:s,onCellRefClick:o,disabled:a=!1}){u0();const l=Ae.useRef(null),[u,h]=Ae.useState(e),[c,d]=Ae.useState(!1),[f,m]=Ae.useState(null),[p,v]=Ae.useState(null),[y,S]=Ae.useState([]);Ae.useEffect(()=>{h(t||e)},[e,t]),u.startsWith("=");const R=Ae.useCallback(q=>{const J=q.target.value;if(h(J),d(!0),r?.(J),J.startsWith("=")){const re=J.match(/=([A-Z]+)$/i);if(re){const ie=re[1].toUpperCase(),ae=Ik.filter(Ve=>Ve.name.startsWith(ie));ae.length>0?(S(ae),v(l.current)):v(null)}else v(null)}else v(null)},[r]),T=Ae.useCallback(()=>{d(!1),v(null),i?.(u)},[u,i]),I=Ae.useCallback(()=>{h(t||e),d(!1),v(null),s?.()},[t,s,e]),H=Ae.useCallback(q=>{q.key==="Enter"?T():q.key==="Escape"&&I()},[T,I]),k=Ae.useCallback(q=>{const J=u,re=J.match(/=([A-Z]+)$/i);if(re){const ie=J.slice(0,-re[1].length)+q.name+"(";h(ie),r?.(ie)}v(null),l.current?.focus()},[u,r]),W=Ae.useCallback(q=>{m(q.currentTarget)},[]),Y=Ae.useCallback(()=>{m(null)},[]),$=Ae.useCallback(q=>{const J=`=${q.name}(`;h(J),r?.(J),Y(),l.current?.focus()},[Y,r]);return te.jsxs(aCe,{children:[te.jsx(lCe,{onClick:o,children:te.jsx(ps,{variant:"body2",sx:{fontWeight:600,fontFamily:"monospace"},children:n||"A1"})}),te.jsx(Nh,{title:"Insert Function",children:te.jsx(Xl,{size:"small",onClick:W,disabled:a,sx:{color:"text.secondary"},children:te.jsx(lz,{fontSize:"small"})})}),te.jsx(uCe,{ref:l,size:"small",fullWidth:!0,value:u,onChange:R,onKeyDown:H,onFocus:()=>d(!0),placeholder:"Enter value or formula (start with =)",disabled:a,InputProps:{sx:{color:"text.primary"}}}),c&&te.jsxs(C_,{direction:"row",spacing:.5,children:[te.jsx(Nh,{title:"Apply (Enter)",children:te.jsx(Xl,{size:"small",onClick:T,sx:{color:"text.secondary"},children:te.jsx(sz,{fontSize:"small"})})}),te.jsx(Nh,{title:"Cancel (Esc)",children:te.jsx(Xl,{size:"small",onClick:I,sx:{color:"text.secondary"},children:te.jsx($2,{fontSize:"small"})})})]}),te.jsx(S_,{open:!!f,anchorEl:f,onClose:Y,anchorOrigin:{vertical:"bottom",horizontal:"left"},PaperProps:{sx:{width:320,maxHeight:400,borderRadius:1}},children:te.jsxs(fr,{sx:{p:1.5},children:[te.jsx(ps,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"Insert Function"}),te.jsx(IA,{dense:!0,sx:{maxHeight:300,overflow:"auto"},children:Ik.map(q=>te.jsx(R_,{disablePadding:!0,children:te.jsx(MA,{onClick:()=>$(q),sx:{borderRadius:1,py:.5},children:te.jsx(dm,{primary:te.jsx(C_,{direction:"row",alignItems:"center",spacing:1,children:te.jsx(Nk,{label:q.name,size:"small"})}),secondary:te.jsx(ps,{variant:"caption",color:"text.secondary",children:q.description})})})},q.name))})]})}),te.jsx(S_,{open:!!p&&y.length>0,anchorEl:p,onClose:()=>v(null),anchorOrigin:{vertical:"bottom",horizontal:"left"},disableAutoFocus:!0,disableEnforceFocus:!0,PaperProps:{sx:{width:250,maxHeight:200,borderRadius:1}},children:te.jsx(IA,{dense:!0,children:y.slice(0,8).map(q=>te.jsx(R_,{disablePadding:!0,children:te.jsxs(MA,{onClick:()=>k(q),sx:{py:.5},children:[te.jsx(Nk,{label:q.name,size:"small",sx:{mr:1}}),te.jsx(ps,{variant:"caption",color:"text.secondary",noWrap:!0,children:q.description})]})},q.name))})})]})}const cCe=ei(fr)(({theme:n})=>({display:"flex",height:"calc(100vh - 64px)",backgroundColor:n.palette.background.default})),dCe=ei(fr)(({theme:n})=>({width:300,display:"flex",flexDirection:"column",borderRight:`1px solid ${yn(n.palette.divider,.1)}`,backgroundColor:yn(n.palette.background.paper,.6)})),fCe=ei(fr)(({theme:n})=>({padding:n.spacing(2),borderBottom:`1px solid ${yn(n.palette.divider,.1)}`,display:"flex",alignItems:"center",justifyContent:"space-between"})),mCe=ei(fr)(({theme:n})=>({flex:1,display:"flex",flexDirection:"column",overflow:"hidden"})),gCe=ei(fr)(({theme:n})=>({display:"flex",alignItems:"center",justifyContent:"space-between",padding:n.spacing(1,2),borderBottom:`1px solid ${yn(n.palette.divider,.1)}`,backgroundColor:yn(n.palette.background.paper,.8),gap:n.spacing(1)})),pCe=ei(fr)(({theme:n})=>({flex:1,overflow:"hidden",backgroundColor:n.palette.background.paper})),wCe=ei(fr)(({theme:n})=>({display:"flex",alignItems:"center",padding:n.spacing(.5,1),borderTop:`1px solid ${yn(n.palette.divider,.1)}`,backgroundColor:yn(n.palette.background.paper,.6),minHeight:40,gap:n.spacing(.5)})),vCe=ei(h0,{shouldForwardProp:n=>n!=="active"})(({theme:n,active:e})=>({borderRadius:"4px 4px 0 0",height:28,fontSize:"14px",backgroundColor:e?n.palette.background.paper:yn(n.palette.background.default,.5),border:`1px solid ${yn(n.palette.divider,.2)}`,borderBottom:e?"none":`1px solid ${yn(n.palette.divider,.2)}`,"&:hover":{backgroundColor:e?n.palette.background.paper:n.palette.mode==="dark"?yn(n.palette.text.primary,.05):Zr[50]}})),Jc=ei(Ch)(({theme:n})=>({borderRadius:6,textTransform:"none",fontWeight:500,minWidth:"auto",fontSize:"14px"})),yCe=ei(MA,{shouldForwardProp:n=>n!=="active"})(({theme:n,active:e})=>({borderRadius:8,marginBottom:n.spacing(.5),backgroundColor:e?n.palette.mode==="dark"?yn(n.palette.text.primary,.1):Zr[100]:"transparent","&:hover":{backgroundColor:e?n.palette.mode==="dark"?yn(n.palette.text.primary,.15):Zr[100]:yn(n.palette.action.hover,.05)}})),CCe=ei(fr)(({theme:n})=>({flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:n.spacing(4),textAlign:"center"})),NA=(n,e)=>{let t="",r=e;for(;r>=0;)t=String.fromCharCode(r%26+65)+t,r=Math.floor(r/26)-1;return`${t}${n+1}`};function SCe(){u0();const n=G2(),{execute:e}=Ok();ez(),tz(b_.SPREADSHEETS,{[rz.OPEN_IN]:async se=>{const Te=se.data||{},ln=Te.columns||[],Ot=Te.rows||[],kt={};ln.forEach(($t,Or)=>{const Aa=String.fromCharCode(65+Or);kt[`${Aa}1`]={value:typeof $t=="string"?$t:$t.name||`Col${Or+1}`}}),Ot.forEach(($t,Or)=>{(Array.isArray($t)?$t:Object.values($t)).forEach((_r,Na)=>{if(Na<26){const dp=String.fromCharCode(65+Na);kt[`${dp}${Or+2}`]={value:_r}}})});const Kt=await h({name:se.title||"Imported Data",sheets:[{name:"Sheet 1",data:kt}]});Kt&&c(Kt.id)}});const{spreadsheets:t,currentSpreadsheet:r,activeSheetIndex:i,selectedCells:s,loading:o,saving:a,error:l,fetchSpreadsheets:u,createSpreadsheet:h,getSpreadsheet:c,updateSpreadsheet:d,deleteSpreadsheet:f,updateCells:m,addSheet:p,deleteSheet:v,renameSheet:y,setActiveSheetIndex:S,setSelectedCells:R,createPivotTable:T,generateFormula:I,importCsv:H,importExcel:k,exportSpreadsheet:W,reset:Y}=j2(),[$,q]=Ae.useState(!1),[J,re]=Ae.useState(""),[ie,ae]=Ae.useState(""),[Ve,De]=Ae.useState("A1"),[Se,pe]=Ae.useState(""),[ze,w]=Ae.useState(null),[C,b]=Ae.useState([]),[P,L]=Ae.useState(!1),[G,ee]=Ae.useState(!1),[ne,he]=Ae.useState(""),[we,oe]=Ae.useState(null),[We,Ke]=Ae.useState(null),[Q,Qe]=Ae.useState(!1),[et,ht]=Ae.useState(""),[Ze,ke]=Ae.useState(null),A=Ae.useRef(null),O=Ae.useRef(null);Ae.useEffect(()=>(u(),()=>Y()),[u,Y]),Ae.useEffect(()=>{if(r?.sheets?.[i]?.data){const se=r.sheets[i].data,Te=[],ln=100,Ot=26;for(let kt=0;kt<ln;kt++){const Kt=[];for(let $t=0;$t<Ot;$t++){const Or=NA(kt,$t),Aa=se[Or];Kt.push(Aa?.formula||Aa?.value||"")}Te.push(Kt)}b(Te)}else b(Array(100).fill(null).map(()=>Array(26).fill("")))},[r,i]);const x=Ae.useCallback((se,Te,ln={})=>e({type:Us.EXECUTE,label:se,reversibility:Vs.FULLY_REVERSIBLE,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{source:"spreadsheets",...ln},action:Te}),[e]),z=Ae.useCallback(()=>x("Open create spreadsheet",()=>q(!0)),[x]),F=Ae.useCallback(()=>x("Close create spreadsheet",()=>{q(!1),re(""),ae("")}),[x]),X=Ae.useCallback(()=>x("Open AI formula",()=>ee(!0)),[x]),B=Ae.useCallback(()=>x("Close AI formula",()=>{ee(!1),he("")}),[x]),V=Ae.useCallback(()=>x("Import spreadsheet",()=>A.current?.click()),[x]),K=Ae.useCallback(se=>e({type:Us.EXECUTE,label:"Open spreadsheet",reversibility:Vs.FULLY_REVERSIBLE,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{source:"spreadsheets",spreadsheetId:se},action:async()=>{await c(se),L(!1)}}),[e,c]),j=Ae.useCallback(()=>{if(J)return e({type:Us.CREATE,label:"Create spreadsheet",reversibility:Vs.SYSTEM_MANAGED,intent:{source:"spreadsheets",name:J,connectionId:ie||void 0},action:async()=>{const se=await h({name:J,sheets:[{name:"Sheet 1",data:{}}],connectionId:ie||void 0});return se&&(q(!1),re(""),ae(""),n.show("Spreadsheet created","success")),se}})},[h,e,J,ie,n]),Z=Ae.useCallback(se=>e({type:Us.DELETE,label:"Delete spreadsheet",reversibility:Vs.REQUIRES_CONFIRMATION,intent:{source:"spreadsheets",spreadsheetId:se},action:async()=>{const Te=await f(se);return Te&&n.show("Spreadsheet deleted","success"),Te}}),[f,e,n]),me=Ae.useCallback((se,Te)=>{Te!=="loadData"&&se&&(L(!0),b(ln=>{const Ot=ln.map(kt=>[...kt]);return se.forEach(([kt,Kt,$t,Or])=>{Ot[kt]&&(Ot[kt][Kt]=Or)}),Ot}))},[]),be=Ae.useCallback((se,Te,ln,Ot)=>{const kt=NA(se,Te);De(kt);const Kt=C[se]?.[Te]||"";pe(Kt),w(Kt.startsWith("=")?Kt:null)},[C]),Ue=Ae.useCallback(se=>{pe(se)},[]),nt=Ae.useCallback(se=>{const Te=Ve.match(/^([A-Z]+)(\d+)$/);if(!Te)return;const ln=Te[1],Ot=parseInt(Te[2],10)-1;let kt=0;for(let Kt=0;Kt<ln.length;Kt++)kt=kt*26+(ln.charCodeAt(Kt)-64);kt-=1,b(Kt=>{const $t=Kt.map(Or=>[...Or]);return $t[Ot]&&($t[Ot][kt]=se),$t}),L(!0)},[Ve]),Rt=Ae.useCallback(()=>{const se=Ve.match(/^([A-Z]+)(\d+)$/);if(!se)return;const Te=se[1],ln=parseInt(se[2],10)-1;let Ot=0;for(let kt=0;kt<Te.length;kt++)Ot=Ot*26+(Te.charCodeAt(kt)-64);Ot-=1,pe(C[ln]?.[Ot]||"")},[Ve,C]),ut=Ae.useCallback(()=>{if(r)return e({type:Us.UPDATE,label:"Save spreadsheet",reversibility:Vs.SYSTEM_MANAGED,intent:{source:"spreadsheets",spreadsheetId:r.id},action:async()=>{const se={};C.forEach((Te,ln)=>{Te.forEach((Ot,kt)=>{if(Ot!==""){const Kt=NA(ln,kt),$t=typeof Ot=="string"&&Ot.startsWith("=");se[Kt]={value:$t?"":Ot,formula:$t?Ot:null}}})}),await m(r.id,i,se),L(!1),n.show("Spreadsheet saved","success")}})},[i,r,e,C,n,m]),qe=Ae.useCallback(se=>{const Te=se.target.files[0];if(!Te)return;const ln=Te.name.endsWith(".xlsx")||Te.name.endsWith(".xls");e({type:Us.UPLOAD,label:"Import spreadsheet",reversibility:Vs.SYSTEM_MANAGED,intent:{source:"spreadsheets",filename:Te.name},action:async()=>{(ln?await k(Te):await H(Te))&&n.show("File imported successfully","success")}}).finally(()=>{se.target.value=""})},[e,H,k,n]),Ct=Ae.useCallback(se=>{if(r)return oe(null),e({type:Us.DOWNLOAD,label:"Export spreadsheet",reversibility:Vs.FULLY_REVERSIBLE,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{source:"spreadsheets",spreadsheetId:r.id,format:se},action:async()=>{const Te=await W(r.id,se);if(Te){const ln=URL.createObjectURL(Te),Ot=document.createElement("a");Ot.href=ln,Ot.download=`${r.name}.${se}`,Ot.click(),URL.revokeObjectURL(ln),n.show(`Exported to ${se.toUpperCase()}`,"success")}else n.show("Export not available","warning")}})},[r,e,W,n]),pn=Ae.useCallback(()=>{if(!(!ne||!r))return e({type:Us.GENERATE,label:"Generate formula",reversibility:Vs.FULLY_REVERSIBLE,blocksNavigation:!0,intent:{source:"spreadsheets",spreadsheetId:r.id},action:async()=>{const se=await I(r.id,ne);return se?.formula&&(pe(se.formula),nt(se.formula),n.show("Formula generated","success")),ee(!1),he(""),se}})},[ne,r,e,I,nt,n]),Tl=Ae.useCallback(se=>x("Switch sheet",()=>S(se),{index:se}),[x,S]),Bi=Ae.useCallback(()=>{if(r)return e({type:Us.UPDATE,label:"Add sheet",reversibility:Vs.SYSTEM_MANAGED,intent:{source:"spreadsheets",spreadsheetId:r.id},action:async()=>{const se=(r.sheets?.length||0)+1;await p(r.id,`Sheet ${se}`),n.show("Sheet added","success")}})},[p,r,e,n]),Al=Ae.useCallback(()=>{if(!(!r||Ze===null||!et))return e({type:Us.UPDATE,label:"Rename sheet",reversibility:Vs.SYSTEM_MANAGED,intent:{source:"spreadsheets",spreadsheetId:r.id},action:async()=>{await y(r.id,Ze,et),Qe(!1),ht(""),ke(null),n.show("Sheet renamed","success")}})},[r,e,et,y,Ze,n]),wi=Ae.useCallback(se=>{if(!r||r.sheets?.length<=1){n.show("Cannot delete the only sheet","warning");return}return e({type:Us.DELETE,label:"Delete sheet",reversibility:Vs.REQUIRES_CONFIRMATION,intent:{source:"spreadsheets",spreadsheetId:r.id,sheetIndex:se},action:async()=>{await v(r.id,se),n.show("Sheet deleted","success")}})},[r,v,e,n]),cn=Ae.useCallback(()=>x("Dismiss spreadsheet error",()=>Y()),[x,Y]),jn=Ae.useCallback(se=>{ke(se),ht(r?.sheets?.[se]?.name||""),Qe(!0)},[r]);return te.jsxs(cCe,{children:[te.jsxs(dCe,{children:[te.jsxs(fCe,{children:[te.jsx(ps,{variant:"subtitle2",sx:{fontWeight:600},children:"Spreadsheets"}),te.jsx(Nh,{title:"New Spreadsheet",children:te.jsx(Xl,{size:"small",onClick:z,children:te.jsx(OS,{fontSize:"small"})})})]}),te.jsx(fr,{sx:{flex:1,overflow:"auto",p:1},children:o&&t.length===0?te.jsx(fr,{sx:{display:"flex",justifyContent:"center",py:4},children:te.jsx(z2,{size:24})}):t.length===0?te.jsx(ps,{variant:"body2",color:"text.secondary",sx:{p:2,textAlign:"center"},children:"No spreadsheets yet"}):te.jsx(IA,{disablePadding:!0,children:t.map(se=>te.jsxs(yCe,{active:r?.id===se.id,onClick:()=>K(se.id),children:[te.jsx(Y2,{sx:{minWidth:36},children:te.jsx(E_,{sx:{color:"text.secondary"},fontSize:"small"})}),te.jsx(dm,{primary:se.name,secondary:`${se.sheets?.length||1} ${(se.sheets?.length||1)===1?"sheet":"sheets"}`,primaryTypographyProps:{variant:"body2",fontWeight:500},secondaryTypographyProps:{variant:"caption"}}),te.jsx(Xl,{size:"small",onClick:Te=>{Te.stopPropagation(),Z(se.id)},"aria-label":`Delete ${se.name}`,sx:{opacity:0,".MuiListItemButton-root:hover &":{opacity:.5},"&:hover":{opacity:1}},children:te.jsx(K2,{fontSize:"small"})})]},se.id))})}),te.jsx(fr,{sx:{p:1.5,borderTop:se=>`1px solid ${yn(se.palette.divider,.1)}`},children:te.jsx(nz,{currentFeature:b_.SPREADSHEETS,onImport:async se=>{const{columns:Te,rows:ln}=se.data||{},Ot={};Te&&ln&&(Te.forEach((Kt,$t)=>{if($t<26){const Or=String.fromCharCode(65+$t);Ot[`${Or}1`]={value:typeof Kt=="string"?Kt:Kt.name||`Col${$t+1}`}}}),ln.forEach((Kt,$t)=>{(Array.isArray(Kt)?Kt:Object.values(Kt)).forEach((Aa,_r)=>{if(_r<26){const Na=String.fromCharCode(65+_r);Ot[`${Na}${$t+2}`]={value:Aa}}})}));const kt=await h({name:se.title||"Imported Data",sheets:[{name:"Sheet 1",data:Ot}]});kt&&(c(kt.id),n.show(`Created spreadsheet from "${se.title}"`,"success"))},fullWidth:!0})})]}),te.jsxs(mCe,{children:[r?te.jsxs(te.Fragment,{children:[te.jsxs(gCe,{children:[te.jsxs(fr,{sx:{display:"flex",alignItems:"center",gap:1},children:[te.jsx(ps,{variant:"subtitle1",sx:{fontWeight:600},children:r.name}),P&&te.jsx(h0,{label:"Unsaved",size:"small",sx:{height:20,fontSize:"12px",bgcolor:se=>se.palette.mode==="dark"?yn(se.palette.text.primary,.1):Zr[200],color:"text.secondary"}})]}),te.jsxs(fr,{sx:{display:"flex",gap:1},children:[te.jsx(Nh,{title:"Undo",children:te.jsx(Xl,{size:"small",children:te.jsx(q2,{fontSize:"small"})})}),te.jsx(Nh,{title:"Redo",children:te.jsx(Xl,{size:"small",children:te.jsx(oz,{fontSize:"small"})})}),te.jsx(X2,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),te.jsx(Jc,{size:"small",startIcon:te.jsx(T_,{}),onClick:V,children:"Import"}),te.jsx(Jc,{size:"small",startIcon:te.jsx(Q2,{}),onClick:se=>oe(se.currentTarget),children:"Export"}),te.jsx(Jc,{size:"small",startIcon:te.jsx(_S,{}),onClick:X,children:"AI Formula"}),te.jsx(Jc,{variant:"contained",size:"small",startIcon:te.jsx(az,{}),onClick:ut,disabled:a||!P,children:a?"Saving...":"Save"})]})]}),te.jsx(hCe,{cellRef:Ve,value:Se,formula:ze,onChange:Ue,onApply:nt,onCancel:Rt,disabled:!r}),te.jsx(pCe,{children:te.jsx(oCe,{ref:O,data:C,onCellChange:me,onSelectionChange:be,formulas:!0})}),te.jsxs(wCe,{children:[r.sheets?.map((se,Te)=>te.jsx(vCe,{label:se.name,size:"small",active:i===Te,onClick:()=>Tl(Te),onDoubleClick:()=>jn(Te),onDelete:r.sheets.length>1?()=>wi(Te):void 0},Te)),te.jsx(Nh,{title:"Add Sheet",children:te.jsx(Xl,{size:"small",onClick:Bi,children:te.jsx(OS,{fontSize:"small"})})})]})]}):te.jsxs(CCe,{children:[te.jsx(E_,{sx:{fontSize:64,color:"text.disabled",mb:2}}),te.jsx(ps,{variant:"h5",sx:{fontWeight:600,mb:1},children:"No Spreadsheet Selected"}),te.jsx(ps,{color:"text.secondary",sx:{mb:3},children:"Create a new spreadsheet or select one from the sidebar."}),te.jsxs(fr,{sx:{display:"flex",gap:2},children:[te.jsx(Jc,{variant:"contained",startIcon:te.jsx(OS,{}),onClick:z,children:"Create Spreadsheet"}),te.jsx(Jc,{variant:"outlined",startIcon:te.jsx(T_,{}),onClick:V,children:"Import File"})]})]}),te.jsx("input",{ref:A,type:"file",hidden:!0,accept:".csv,.xlsx,.xls",onChange:qe})]}),te.jsxs(xS,{open:$,onClose:F,maxWidth:"xs",fullWidth:!0,children:[te.jsx(PS,{children:"Create New Spreadsheet"}),te.jsxs(LS,{children:[te.jsx(hv,{autoFocus:!0,fullWidth:!0,label:"Spreadsheet Name",value:J,onChange:se=>re(se.target.value),sx:{mt:2},onKeyDown:se=>{se.key==="Enter"&&J&&j()}}),te.jsx(iz,{value:ie,onChange:ae,label:"Import from Connection (Optional)",size:"small",showStatus:!0}),ie&&te.jsx(ps,{variant:"caption",color:"text.secondary",sx:{mt:1},children:"Data from the selected connection will be imported into the new spreadsheet."})]}),te.jsxs(DS,{children:[te.jsx(Ch,{onClick:F,children:"Cancel"}),te.jsx(Ch,{variant:"contained",onClick:j,disabled:!J||o,children:"Create"})]})]}),te.jsxs(xS,{open:Q,onClose:()=>Qe(!1),maxWidth:"xs",fullWidth:!0,children:[te.jsx(PS,{children:"Rename Sheet"}),te.jsx(LS,{children:te.jsx(hv,{autoFocus:!0,fullWidth:!0,label:"Sheet Name",value:et,onChange:se=>ht(se.target.value),sx:{mt:2},onKeyDown:se=>{se.key==="Enter"&&et&&Al()}})}),te.jsxs(DS,{children:[te.jsx(Ch,{onClick:()=>Qe(!1),children:"Cancel"}),te.jsx(Ch,{variant:"contained",onClick:Al,disabled:!et,children:"Rename"})]})]}),te.jsxs(xS,{open:G,onClose:B,maxWidth:"sm",fullWidth:!0,children:[te.jsx(PS,{children:te.jsxs(fr,{sx:{display:"flex",alignItems:"center",gap:1},children:[te.jsx(_S,{sx:{color:"text.secondary"}}),"Generate Formula with AI"]})}),te.jsxs(LS,{children:[te.jsx(ps,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Describe what you want to calculate in plain English."}),te.jsx(hv,{autoFocus:!0,fullWidth:!0,multiline:!0,rows:3,placeholder:"e.g., Sum all values in column A where column B equals 'Sales'",value:ne,onChange:se=>he(se.target.value)}),te.jsxs(ps,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:["The formula will be inserted into the currently selected cell (",Ve,")"]})]}),te.jsxs(DS,{children:[te.jsx(Ch,{onClick:B,children:"Cancel"}),te.jsx(Ch,{variant:"contained",onClick:pn,disabled:!ne,startIcon:te.jsx(_S,{}),children:"Generate"})]})]}),te.jsxs(Z2,{anchorEl:we,open:!!we,onClose:()=>oe(null),children:[te.jsx(HS,{onClick:()=>Ct("csv"),children:te.jsx(dm,{primary:"CSV",secondary:"Comma-separated values"})}),te.jsx(HS,{onClick:()=>Ct("xlsx"),children:te.jsx(dm,{primary:"Excel (.xlsx)",secondary:"Microsoft Excel format"})}),te.jsx(HS,{onClick:()=>Ct("json"),children:te.jsx(dm,{primary:"JSON",secondary:"JavaScript Object Notation"})})]}),l&&te.jsx(J2,{severity:"error",onClose:cn,sx:{position:"fixed",bottom:16,right:16,maxWidth:400},children:l})]})}function QCe(){return Ok(),te.jsx(SCe,{})}export{QCe as default};
