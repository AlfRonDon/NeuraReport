import{c as U2,j as te,bx as v_,bi as In,c3 as Nk,by as B2,e as a0,r as Ne,J as qr,B as vr,k as Yr,p as Rn,T as no,n as bh,o as Gl,S as y_,aG as W2,c5 as C_,aR as AA,aV as S_,c7 as NA,$ as um,N as av,v as l0,d as $2,u as Ik,c8 as G2,R as Ds,I as Hs,A as IS,as as j2,_ as z2,E as R_,a1 as Y2,c4 as K2,aJ as q2,ah as X2,F as MS,ak as OS,al as _S,am as xS,ao as PS,s as wh,a2 as Q2,a3 as LS,P as Z2}from"./index-B8Eu23bA.js";import{C as J2}from"./Check-BATZaRrq.js";import{R as ez}from"./Redo-DQdTvywB.js";import{U as E_}from"./Upload-BxhlLt54.js";import{S as tz}from"./Save-CpotRqw9.js";const nz=U2(te.jsx("path",{d:"M18 4H6v2l6.5 6L6 18v2h12v-3h-7l5-5-5-5h7z"}));var b_={},af,T_;function Ar(){if(T_)return af;T_=1;var n=function(e){return e&&e.Math===Math&&e};return af=n(typeof globalThis=="object"&&globalThis)||n(typeof window=="object"&&window)||n(typeof self=="object"&&self)||n(typeof v_=="object"&&v_)||n(typeof af=="object"&&af)||(function(){return this})()||Function("return this")(),af}var DS={},HS,A_;function Lr(){return A_||(A_=1,HS=function(n){try{return!!n()}catch{return!0}}),HS}var FS,N_;function vo(){if(N_)return FS;N_=1;var n=Lr();return FS=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),FS}var kS,I_;function fC(){if(I_)return kS;I_=1;var n=Lr();return kS=!n(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),kS}var VS,M_;function yo(){if(M_)return VS;M_=1;var n=fC(),e=Function.prototype.call;return VS=n?e.bind(e):function(){return e.apply(e,arguments)},VS}var US={},O_;function rz(){if(O_)return US;O_=1;var n={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,t=e&&!n.call({1:2},1);return US.f=t?function(i){var s=e(this,i);return!!s&&s.enumerable}:n,US}var BS,__;function mC(){return __||(__=1,BS=function(n,e){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:e}}),BS}var WS,x_;function tr(){if(x_)return WS;x_=1;var n=fC(),e=Function.prototype,t=e.call,r=n&&e.bind.bind(t,t);return WS=n?r:function(i){return function(){return t.apply(i,arguments)}},WS}var $S,P_;function Qh(){if(P_)return $S;P_=1;var n=tr(),e=n({}.toString),t=n("".slice);return $S=function(r){return t(e(r),8,-1)},$S}var GS,L_;function iz(){if(L_)return GS;L_=1;var n=tr(),e=Lr(),t=Qh(),r=Object,i=n("".split);return GS=e(function(){return!r("z").propertyIsEnumerable(0)})?function(s){return t(s)==="String"?i(s,""):r(s)}:r,GS}var jS,D_;function u0(){return D_||(D_=1,jS=function(n){return n==null}),jS}var zS,H_;function Og(){if(H_)return zS;H_=1;var n=u0(),e=TypeError;return zS=function(t){if(n(t))throw new e("Can't call method on "+t);return t},zS}var YS,F_;function gC(){if(F_)return YS;F_=1;var n=iz(),e=Og();return YS=function(t){return n(e(t))},YS}var KS,k_;function Xr(){if(k_)return KS;k_=1;var n=typeof document=="object"&&document.all;return KS=typeof n>"u"&&n!==void 0?function(e){return typeof e=="function"||e===n}:function(e){return typeof e=="function"},KS}var qS,V_;function _s(){if(V_)return qS;V_=1;var n=Xr();return qS=function(e){return typeof e=="object"?e!==null:n(e)},qS}var XS,U_;function jd(){if(U_)return XS;U_=1;var n=Ar(),e=Xr(),t=function(r){return e(r)?r:void 0};return XS=function(r,i){return arguments.length<2?t(n[r]):n[r]&&n[r][i]},XS}var QS,B_;function pC(){if(B_)return QS;B_=1;var n=tr();return QS=n({}.isPrototypeOf),QS}var ZS,W_;function wC(){if(W_)return ZS;W_=1;var n=Ar(),e=n.navigator,t=e&&e.userAgent;return ZS=t?String(t):"",ZS}var JS,$_;function sz(){if($_)return JS;$_=1;var n=Ar(),e=wC(),t=n.process,r=n.Deno,i=t&&t.versions||r&&r.version,s=i&&i.v8,o,a;return s&&(o=s.split("."),a=o[0]>0&&o[0]<4?1:+(o[0]+o[1])),!a&&e&&(o=e.match(/Edge\/(\d+)/),(!o||o[1]>=74)&&(o=e.match(/Chrome\/(\d+)/),o&&(a=+o[1]))),JS=a,JS}var eR,G_;function h0(){if(G_)return eR;G_=1;var n=sz(),e=Lr(),t=Ar(),r=t.String;return eR=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&n&&n<41}),eR}var tR,j_;function Mk(){if(j_)return tR;j_=1;var n=h0();return tR=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol",tR}var nR,z_;function c0(){if(z_)return nR;z_=1;var n=jd(),e=Xr(),t=pC(),r=Mk(),i=Object;return nR=r?function(s){return typeof s=="symbol"}:function(s){var o=n("Symbol");return e(o)&&t(o.prototype,i(s))},nR}var rR,Y_;function vC(){if(Y_)return rR;Y_=1;var n=String;return rR=function(e){try{return n(e)}catch{return"Object"}},rR}var iR,K_;function _g(){if(K_)return iR;K_=1;var n=Xr(),e=vC(),t=TypeError;return iR=function(r){if(n(r))return r;throw new t(e(r)+" is not a function")},iR}var sR,q_;function yC(){if(q_)return sR;q_=1;var n=_g(),e=u0();return sR=function(t,r){var i=t[r];return e(i)?void 0:n(i)},sR}var oR,X_;function oz(){if(X_)return oR;X_=1;var n=yo(),e=Xr(),t=_s(),r=TypeError;return oR=function(i,s){var o,a;if(s==="string"&&e(o=i.toString)&&!t(a=n(o,i))||e(o=i.valueOf)&&!t(a=n(o,i))||s!=="string"&&e(o=i.toString)&&!t(a=n(o,i)))return a;throw new r("Can't convert object to primitive value")},oR}var aR={exports:{}},lR,Q_;function d0(){return Q_||(Q_=1,lR=!1),lR}var uR,Z_;function f0(){if(Z_)return uR;Z_=1;var n=Ar(),e=Object.defineProperty;return uR=function(t,r){try{e(n,t,{value:r,configurable:!0,writable:!0})}catch{n[t]=r}return r},uR}var J_;function m0(){if(J_)return aR.exports;J_=1;var n=d0(),e=Ar(),t=f0(),r="__core-js_shared__",i=aR.exports=e[r]||t(r,{});return(i.versions||(i.versions=[])).push({version:"3.48.0",mode:n?"pure":"global",copyright:"© 2013–2025 Denis Pushkarev (zloirock.ru), 2025–2026 CoreJS Company (core-js.io). All rights reserved.",license:"https://github.com/zloirock/core-js/blob/v3.48.0/LICENSE",source:"https://github.com/zloirock/core-js"}),aR.exports}var hR,ex;function Ok(){if(ex)return hR;ex=1;var n=m0();return hR=function(e,t){return n[e]||(n[e]=t||{})},hR}var cR,tx;function xg(){if(tx)return cR;tx=1;var n=Og(),e=Object;return cR=function(t){return e(n(t))},cR}var dR,nx;function Co(){if(nx)return dR;nx=1;var n=tr(),e=xg(),t=n({}.hasOwnProperty);return dR=Object.hasOwn||function(i,s){return t(e(i),s)},dR}var fR,rx;function g0(){if(rx)return fR;rx=1;var n=tr(),e=0,t=Math.random(),r=n(1.1.toString);return fR=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+t,36)},fR}var mR,ix;function pu(){if(ix)return mR;ix=1;var n=Ar(),e=Ok(),t=Co(),r=g0(),i=h0(),s=Mk(),o=n.Symbol,a=e("wks"),l=s?o.for||o:o&&o.withoutSetter||r;return mR=function(u){return t(a,u)||(a[u]=i&&t(o,u)?o[u]:l("Symbol."+u)),a[u]},mR}var gR,sx;function az(){if(sx)return gR;sx=1;var n=yo(),e=_s(),t=c0(),r=yC(),i=oz(),s=pu(),o=TypeError,a=s("toPrimitive");return gR=function(l,u){if(!e(l)||t(l))return l;var h=r(l,a),c;if(h){if(u===void 0&&(u="default"),c=n(h,l,u),!e(c)||t(c))return c;throw new o("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},gR}var pR,ox;function _k(){if(ox)return pR;ox=1;var n=az(),e=c0();return pR=function(t){var r=n(t,"string");return e(r)?r:r+""},pR}var wR,ax;function p0(){if(ax)return wR;ax=1;var n=Ar(),e=_s(),t=n.document,r=e(t)&&e(t.createElement);return wR=function(i){return r?t.createElement(i):{}},wR}var vR,lx;function xk(){if(lx)return vR;lx=1;var n=vo(),e=Lr(),t=p0();return vR=!n&&!e(function(){return Object.defineProperty(t("div"),"a",{get:function(){return 7}}).a!==7}),vR}var ux;function Pk(){if(ux)return DS;ux=1;var n=vo(),e=yo(),t=rz(),r=mC(),i=gC(),s=_k(),o=Co(),a=xk(),l=Object.getOwnPropertyDescriptor;return DS.f=n?l:function(h,c){if(h=i(h),c=s(c),a)try{return l(h,c)}catch{}if(o(h,c))return r(!e(t.f,h,c),h[c])},DS}var yR={},CR,hx;function Lk(){if(hx)return CR;hx=1;var n=vo(),e=Lr();return CR=n&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),CR}var SR,cx;function fl(){if(cx)return SR;cx=1;var n=_s(),e=String,t=TypeError;return SR=function(r){if(n(r))return r;throw new t(e(r)+" is not an object")},SR}var dx;function Zh(){if(dx)return yR;dx=1;var n=vo(),e=xk(),t=Lk(),r=fl(),i=_k(),s=TypeError,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",h="writable";return yR.f=n?t?function(d,f,m){if(r(d),f=i(f),r(m),typeof d=="function"&&f==="prototype"&&"value"in m&&h in m&&!m[h]){var p=a(d,f);p&&p[h]&&(d[f]=m.value,m={configurable:u in m?m[u]:p[u],enumerable:l in m?m[l]:p[l],writable:!1})}return o(d,f,m)}:o:function(d,f,m){if(r(d),f=i(f),r(m),e)try{return o(d,f,m)}catch{}if("get"in m||"set"in m)throw new s("Accessors not supported");return"value"in m&&(d[f]=m.value),d},yR}var RR,fx;function Pg(){if(fx)return RR;fx=1;var n=vo(),e=Zh(),t=mC();return RR=n?function(r,i,s){return e.f(r,i,t(1,s))}:function(r,i,s){return r[i]=s,r},RR}var ER={exports:{}},bR,mx;function lz(){if(mx)return bR;mx=1;var n=vo(),e=Co(),t=Function.prototype,r=n&&Object.getOwnPropertyDescriptor,i=e(t,"name"),s=i&&(function(){}).name==="something",o=i&&(!n||n&&r(t,"name").configurable);return bR={EXISTS:i,PROPER:s,CONFIGURABLE:o},bR}var TR,gx;function uz(){if(gx)return TR;gx=1;var n=tr(),e=Xr(),t=m0(),r=n(Function.toString);return e(t.inspectSource)||(t.inspectSource=function(i){return r(i)}),TR=t.inspectSource,TR}var AR,px;function hz(){if(px)return AR;px=1;var n=Ar(),e=Xr(),t=n.WeakMap;return AR=e(t)&&/native code/.test(String(t)),AR}var NR,wx;function Dk(){if(wx)return NR;wx=1;var n=Ok(),e=g0(),t=n("keys");return NR=function(r){return t[r]||(t[r]=e(r))},NR}var IR,vx;function w0(){return vx||(vx=1,IR={}),IR}var MR,yx;function Hk(){if(yx)return MR;yx=1;var n=hz(),e=Ar(),t=_s(),r=Pg(),i=Co(),s=m0(),o=Dk(),a=w0(),l="Object already initialized",u=e.TypeError,h=e.WeakMap,c,d,f,m=function(C){return f(C)?d(C):c(C,{})},p=function(C){return function(R){var A;if(!t(R)||(A=d(R)).type!==C)throw new u("Incompatible receiver, "+C+" required");return A}};if(n||s.state){var v=s.state||(s.state=new h);v.get=v.get,v.has=v.has,v.set=v.set,c=function(C,R){if(v.has(C))throw new u(l);return R.facade=C,v.set(C,R),R},d=function(C){return v.get(C)||{}},f=function(C){return v.has(C)}}else{var y=o("state");a[y]=!0,c=function(C,R){if(i(C,y))throw new u(l);return R.facade=C,r(C,y,R),R},d=function(C){return i(C,y)?C[y]:{}},f=function(C){return i(C,y)}}return MR={set:c,get:d,has:f,enforce:m,getterFor:p},MR}var Cx;function cz(){if(Cx)return ER.exports;Cx=1;var n=tr(),e=Lr(),t=Xr(),r=Co(),i=vo(),s=lz().CONFIGURABLE,o=uz(),a=Hk(),l=a.enforce,u=a.get,h=String,c=Object.defineProperty,d=n("".slice),f=n("".replace),m=n([].join),p=i&&!e(function(){return c(function(){},"length",{value:8}).length!==8}),v=String(String).split("String"),y=ER.exports=function(C,R,A){d(h(R),0,7)==="Symbol("&&(R="["+f(h(R),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),A&&A.getter&&(R="get "+R),A&&A.setter&&(R="set "+R),(!r(C,"name")||s&&C.name!==R)&&(i?c(C,"name",{value:R,configurable:!0}):C.name=R),p&&A&&r(A,"arity")&&C.length!==A.arity&&c(C,"length",{value:A.arity});try{A&&r(A,"constructor")&&A.constructor?i&&c(C,"prototype",{writable:!1}):C.prototype&&(C.prototype=void 0)}catch{}var I=l(C);return r(I,"source")||(I.source=m(v,typeof R=="string"?R:"")),C};return Function.prototype.toString=y(function(){return t(this)&&u(this).source||o(this)},"toString"),ER.exports}var OR,Sx;function dz(){if(Sx)return OR;Sx=1;var n=Xr(),e=Zh(),t=cz(),r=f0();return OR=function(i,s,o,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:s;if(n(o)&&t(o,u,a),a.global)l?i[s]=o:r(s,o);else{try{a.unsafe?i[s]&&(l=!0):delete i[s]}catch{}l?i[s]=o:e.f(i,s,{value:o,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},OR}var _R={},xR,Rx;function fz(){if(Rx)return xR;Rx=1;var n=Math.ceil,e=Math.floor;return xR=Math.trunc||function(r){var i=+r;return(i>0?e:n)(i)},xR}var PR,Ex;function Lg(){if(Ex)return PR;Ex=1;var n=fz();return PR=function(e){var t=+e;return t!==t||t===0?0:n(t)},PR}var LR,bx;function mz(){if(bx)return LR;bx=1;var n=Lg(),e=Math.max,t=Math.min;return LR=function(r,i){var s=n(r);return s<0?e(s+i,0):t(s,i)},LR}var DR,Tx;function gz(){if(Tx)return DR;Tx=1;var n=Lg(),e=Math.min;return DR=function(t){var r=n(t);return r>0?e(r,9007199254740991):0},DR}var HR,Ax;function Dg(){if(Ax)return HR;Ax=1;var n=gz();return HR=function(e){return n(e.length)},HR}var FR,Nx;function pz(){if(Nx)return FR;Nx=1;var n=gC(),e=mz(),t=Dg(),r=function(i){return function(s,o,a){var l=n(s),u=t(l);if(u===0)return!i&&-1;var h=e(a,u),c;if(i&&o!==o){for(;u>h;)if(c=l[h++],c!==c)return!0}else for(;u>h;h++)if((i||h in l)&&l[h]===o)return i||h||0;return!i&&-1}};return FR={includes:r(!0),indexOf:r(!1)},FR}var kR,Ix;function Fk(){if(Ix)return kR;Ix=1;var n=tr(),e=Co(),t=gC(),r=pz().indexOf,i=w0(),s=n([].push);return kR=function(o,a){var l=t(o),u=0,h=[],c;for(c in l)!e(i,c)&&e(l,c)&&s(h,c);for(;a.length>u;)e(l,c=a[u++])&&(~r(h,c)||s(h,c));return h},kR}var VR,Mx;function v0(){return Mx||(Mx=1,VR=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),VR}var Ox;function wz(){if(Ox)return _R;Ox=1;var n=Fk(),e=v0(),t=e.concat("length","prototype");return _R.f=Object.getOwnPropertyNames||function(i){return n(i,t)},_R}var UR={},_x;function vz(){return _x||(_x=1,UR.f=Object.getOwnPropertySymbols),UR}var BR,xx;function yz(){if(xx)return BR;xx=1;var n=jd(),e=tr(),t=wz(),r=vz(),i=fl(),s=e([].concat);return BR=n("Reflect","ownKeys")||function(a){var l=t.f(i(a)),u=r.f;return u?s(l,u(a)):l},BR}var WR,Px;function kk(){if(Px)return WR;Px=1;var n=Co(),e=yz(),t=Pk(),r=Zh();return WR=function(i,s,o){for(var a=e(s),l=r.f,u=t.f,h=0;h<a.length;h++){var c=a[h];!n(i,c)&&!(o&&n(o,c))&&l(i,c,u(s,c))}},WR}var $R,Lx;function Cz(){if(Lx)return $R;Lx=1;var n=Lr(),e=Xr(),t=/#|\.prototype\./,r=function(l,u){var h=s[i(l)];return h===a?!0:h===o?!1:e(u)?n(u):!!u},i=r.normalize=function(l){return String(l).replace(t,".").toLowerCase()},s=r.data={},o=r.NATIVE="N",a=r.POLYFILL="P";return $R=r,$R}var GR,Dx;function Dr(){if(Dx)return GR;Dx=1;var n=Ar(),e=Pk().f,t=Pg(),r=dz(),i=f0(),s=kk(),o=Cz();return GR=function(a,l){var u=a.target,h=a.global,c=a.stat,d,f,m,p,v,y;if(h?f=n:c?f=n[u]||i(u,{}):f=n[u]&&n[u].prototype,f)for(m in l){if(v=l[m],a.dontCallGetSet?(y=e(f,m),p=y&&y.value):p=f[m],d=o(h?m:u+(c?".":"#")+m,a.forced),!d&&p!==void 0){if(typeof v==typeof p)continue;s(v,p)}(a.sham||p&&p.sham)&&t(v,"sham",!0),r(f,m,v,a)}},GR}var jR,Hx;function CC(){if(Hx)return jR;Hx=1;var n=fC(),e=Function.prototype,t=e.apply,r=e.call;return jR=typeof Reflect=="object"&&Reflect.apply||(n?r.bind(t):function(){return r.apply(t,arguments)}),jR}var zR,Fx;function Vk(){if(Fx)return zR;Fx=1;var n=tr(),e=_g();return zR=function(t,r,i){try{return n(e(Object.getOwnPropertyDescriptor(t,r)[i]))}catch{}},zR}var YR,kx;function Sz(){if(kx)return YR;kx=1;var n=_s();return YR=function(e){return n(e)||e===null},YR}var KR,Vx;function Rz(){if(Vx)return KR;Vx=1;var n=Sz(),e=String,t=TypeError;return KR=function(r){if(n(r))return r;throw new t("Can't set "+e(r)+" as a prototype")},KR}var qR,Ux;function Uk(){if(Ux)return qR;Ux=1;var n=Vk(),e=_s(),t=Og(),r=Rz();return qR=Object.setPrototypeOf||("__proto__"in{}?(function(){var i=!1,s={},o;try{o=n(Object.prototype,"__proto__","set"),o(s,[]),i=s instanceof Array}catch{}return function(l,u){return t(l),r(u),e(l)&&(i?o(l,u):l.__proto__=u),l}})():void 0),qR}var XR,Bx;function Ez(){if(Bx)return XR;Bx=1;var n=Zh().f;return XR=function(e,t,r){r in e||n(e,r,{configurable:!0,get:function(){return t[r]},set:function(i){t[r]=i}})},XR}var QR,Wx;function bz(){if(Wx)return QR;Wx=1;var n=Xr(),e=_s(),t=Uk();return QR=function(r,i,s){var o,a;return t&&n(o=i.constructor)&&o!==s&&e(a=o.prototype)&&a!==s.prototype&&t(r,a),r},QR}var ZR,$x;function Tz(){if($x)return ZR;$x=1;var n=pu(),e=n("toStringTag"),t={};return t[e]="z",ZR=String(t)==="[object z]",ZR}var JR,Gx;function Bk(){if(Gx)return JR;Gx=1;var n=Tz(),e=Xr(),t=Qh(),r=pu(),i=r("toStringTag"),s=Object,o=t((function(){return arguments})())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return JR=n?t:function(l){var u,h,c;return l===void 0?"Undefined":l===null?"Null":typeof(h=a(u=s(l),i))=="string"?h:o?t(u):(c=t(u))==="Object"&&e(u.callee)?"Arguments":c},JR}var eE,jx;function SC(){if(jx)return eE;jx=1;var n=Bk(),e=String;return eE=function(t){if(n(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(t)},eE}var tE,zx;function Az(){if(zx)return tE;zx=1;var n=SC();return tE=function(e,t){return e===void 0?arguments.length<2?"":t:n(e)},tE}var nE,Yx;function Nz(){if(Yx)return nE;Yx=1;var n=_s(),e=Pg();return nE=function(t,r){n(r)&&"cause"in r&&e(t,"cause",r.cause)},nE}var rE,Kx;function Iz(){if(Kx)return rE;Kx=1;var n=tr(),e=Error,t=n("".replace),r=(function(o){return String(new e(o).stack)})("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,s=i.test(r);return rE=function(o,a){if(s&&typeof o=="string"&&!e.prepareStackTrace)for(;a--;)o=t(o,i,"");return o},rE}var iE,qx;function Mz(){if(qx)return iE;qx=1;var n=Lr(),e=mC();return iE=!n(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",e(1,7)),t.stack!==7):!0}),iE}var sE,Xx;function Oz(){if(Xx)return sE;Xx=1;var n=Pg(),e=Iz(),t=Mz(),r=Error.captureStackTrace;return sE=function(i,s,o,a){t&&(r?r(i,s):n(i,"stack",e(o,a)))},sE}var oE,Qx;function _z(){if(Qx)return oE;Qx=1;var n=jd(),e=Co(),t=Pg(),r=pC(),i=Uk(),s=kk(),o=Ez(),a=bz(),l=Az(),u=Nz(),h=Oz(),c=vo(),d=d0();return oE=function(f,m,p,v){var y="stackTraceLimit",C=v?2:1,R=f.split("."),A=R[R.length-1],I=n.apply(null,R);if(I){var H=I.prototype;if(!d&&e(H,"cause")&&delete H.cause,!p)return I;var k=n("Error"),W=m(function(z,G){var q=l(v?G:z,void 0),J=v?new I(z):new I;return q!==void 0&&t(J,"message",q),h(J,W,J.stack,2),this&&r(H,this)&&a(J,this,W),arguments.length>C&&u(J,arguments[C]),J});if(W.prototype=H,A!=="Error"?i?i(W,k):s(W,k,{name:!0}):c&&y in I&&(o(W,I,y),o(W,I,"prepareStackTrace")),s(W,I),!d)try{H.name!==A&&t(H,"name",A),H.constructor=W}catch{}return W}},oE}var Zx;function xz(){if(Zx)return b_;Zx=1;var n=Dr(),e=Ar(),t=CC(),r=_z(),i="WebAssembly",s=e[i],o=new Error("e",{cause:7}).cause!==7,a=function(u,h){var c={};c[u]=r(u,h,o),n({global:!0,constructor:!0,arity:1,forced:o},c)},l=function(u,h){if(s&&s[u]){var c={};c[u]=r(i+"."+u,h,o),n({target:i,stat:!0,constructor:!0,arity:1,forced:o},c)}};return a("Error",function(u){return function(c){return t(u,this,arguments)}}),a("EvalError",function(u){return function(c){return t(u,this,arguments)}}),a("RangeError",function(u){return function(c){return t(u,this,arguments)}}),a("ReferenceError",function(u){return function(c){return t(u,this,arguments)}}),a("SyntaxError",function(u){return function(c){return t(u,this,arguments)}}),a("TypeError",function(u){return function(c){return t(u,this,arguments)}}),a("URIError",function(u){return function(c){return t(u,this,arguments)}}),l("CompileError",function(u){return function(c){return t(u,this,arguments)}}),l("LinkError",function(u){return function(c){return t(u,this,arguments)}}),l("RuntimeError",function(u){return function(c){return t(u,this,arguments)}}),b_}xz();var Jx={},aE,eP;function Wk(){if(eP)return aE;eP=1;var n=Qh();return aE=Array.isArray||function(t){return n(t)==="Array"},aE}var lE,tP;function $k(){if(tP)return lE;tP=1;var n=vo(),e=Wk(),t=TypeError,r=Object.getOwnPropertyDescriptor,i=n&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(s){return s instanceof TypeError}})();return lE=i?function(s,o){if(e(s)&&!r(s,"length").writable)throw new t("Cannot set read only .length");return s.length=o}:function(s,o){return s.length=o},lE}var uE,nP;function Gk(){if(nP)return uE;nP=1;var n=TypeError,e=9007199254740991;return uE=function(t){if(t>e)throw n("Maximum allowed index exceeded");return t},uE}var rP;function Pz(){if(rP)return Jx;rP=1;var n=Dr(),e=xg(),t=Dg(),r=$k(),i=Gk(),s=Lr(),o=s(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=o||!a();return n({target:"Array",proto:!0,arity:1,forced:l},{push:function(h){var c=e(this),d=t(c),f=arguments.length;i(d+f);for(var m=0;m<f;m++)c[d]=arguments[m],d++;return r(c,d),d}}),Jx}Pz();var iP={},hE,sP;function wa(){if(sP)return hE;sP=1;var n=tr(),e=Set.prototype;return hE={Set,add:n(e.add),has:n(e.has),remove:n(e.delete),proto:e},hE}var cE,oP;function Jh(){if(oP)return cE;oP=1;var n=wa().has;return cE=function(e){return n(e),e},cE}var dE,aP;function ec(){if(aP)return dE;aP=1;var n=yo();return dE=function(e,t,r){for(var i=r?e:e.iterator,s=e.next,o,a;!(o=n(s,i)).done;)if(a=t(o.value),a!==void 0)return a},dE}var fE,lP;function Hg(){if(lP)return fE;lP=1;var n=tr(),e=ec(),t=wa(),r=t.Set,i=t.proto,s=n(i.forEach),o=n(i.keys),a=o(new r).next;return fE=function(l,u,h){return h?e({iterator:o(l),next:a},u):s(l,u)},fE}var mE,uP;function y0(){if(uP)return mE;uP=1;var n=wa(),e=Hg(),t=n.Set,r=n.add;return mE=function(i){var s=new t;return e(i,function(o){r(s,o)}),s},mE}var gE,hP;function Fg(){if(hP)return gE;hP=1;var n=Vk(),e=wa();return gE=n(e.proto,"size","get")||function(t){return t.size},gE}var pE,cP;function Lz(){return cP||(cP=1,pE=function(n){return{iterator:n,next:n.next,done:!1}}),pE}var wE,dP;function tc(){if(dP)return wE;dP=1;var n=_g(),e=fl(),t=yo(),r=Lg(),i=Lz(),s="Invalid size",o=RangeError,a=TypeError,l=Math.max,u=function(h,c){this.set=h,this.size=l(c,0),this.has=n(h.has),this.keys=n(h.keys)};return u.prototype={getIterator:function(){return i(e(t(this.keys,this.set)))},includes:function(h){return t(this.has,this.set,h)}},wE=function(h){e(h);var c=+h.size;if(c!==c)throw new a(s);var d=r(c);if(d<0)throw new o(s);return new u(h,d)},wE}var vE,fP;function Dz(){if(fP)return vE;fP=1;var n=Jh(),e=wa(),t=y0(),r=Fg(),i=tc(),s=Hg(),o=ec(),a=e.has,l=e.remove;return vE=function(h){var c=n(this),d=i(h),f=t(c);return r(c)<=d.size?s(c,function(m){d.includes(m)&&l(f,m)}):o(d.getIterator(),function(m){a(f,m)&&l(f,m)}),f},vE}var yE,mP;function nc(){if(mP)return yE;mP=1;var n=jd(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},t=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return yE=function(r,i){var s=n("Set");try{new s()[r](e(0));try{return new s()[r](e(-1)),!1}catch{if(!i)return!0;try{return new s()[r](t(-1/0)),!1}catch{var o=new s([1,2]);return i(o[r](t(1/0)))}}}catch{return!1}},yE}var gP;function Hz(){if(gP)return iP;gP=1;var n=Dr(),e=Dz(),t=Lr(),r=nc(),i=!r("difference",function(o){return o.size===0}),s=i||t(function(){var o={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(o).size!==3});return n({target:"Set",proto:!0,real:!0,forced:s},{difference:e}),iP}Hz();var pP={},CE,wP;function Fz(){if(wP)return CE;wP=1;var n=Jh(),e=wa(),t=Fg(),r=tc(),i=Hg(),s=ec(),o=e.Set,a=e.add,l=e.has;return CE=function(h){var c=n(this),d=r(h),f=new o;return t(c)>d.size?s(d.getIterator(),function(m){l(c,m)&&a(f,m)}):i(c,function(m){d.includes(m)&&a(f,m)}),f},CE}var vP;function kz(){if(vP)return pP;vP=1;var n=Dr(),e=Lr(),t=Fz(),r=nc(),i=!r("intersection",function(s){return s.size===2&&s.has(1)&&s.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return n({target:"Set",proto:!0,real:!0,forced:i},{intersection:t}),pP}kz();var yP={},SE,CP;function C0(){if(CP)return SE;CP=1;var n=yo(),e=fl(),t=yC();return SE=function(r,i,s){var o,a;e(r);try{if(o=t(r,"return"),!o){if(i==="throw")throw s;return s}o=n(o,r)}catch(l){a=!0,o=l}if(i==="throw")throw s;if(a)throw o;return e(o),s},SE}var RE,SP;function Vz(){if(SP)return RE;SP=1;var n=Jh(),e=wa().has,t=Fg(),r=tc(),i=Hg(),s=ec(),o=C0();return RE=function(l){var u=n(this),h=r(l);if(t(u)<=h.size)return i(u,function(d){if(h.includes(d))return!1},!0)!==!1;var c=h.getIterator();return s(c,function(d){if(e(u,d))return o(c,"normal",!1)})!==!1},RE}var RP;function Uz(){if(RP)return yP;RP=1;var n=Dr(),e=Vz(),t=nc(),r=!t("isDisjointFrom",function(i){return!i});return n({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),yP}Uz();var EP={},EE,bP;function Bz(){if(bP)return EE;bP=1;var n=Jh(),e=Fg(),t=Hg(),r=tc();return EE=function(s){var o=n(this),a=r(s);return e(o)>a.size?!1:t(o,function(l){if(!a.includes(l))return!1},!0)!==!1},EE}var TP;function Wz(){if(TP)return EP;TP=1;var n=Dr(),e=Bz(),t=nc(),r=!t("isSubsetOf",function(i){return i});return n({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),EP}Wz();var AP={},bE,NP;function $z(){if(NP)return bE;NP=1;var n=Jh(),e=wa().has,t=Fg(),r=tc(),i=ec(),s=C0();return bE=function(a){var l=n(this),u=r(a);if(t(l)<u.size)return!1;var h=u.getIterator();return i(h,function(c){if(!e(l,c))return s(h,"normal",!1)})!==!1},bE}var IP;function Gz(){if(IP)return AP;IP=1;var n=Dr(),e=$z(),t=nc(),r=!t("isSupersetOf",function(i){return!i});return n({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),AP}Gz();var MP={},TE,OP;function jz(){if(OP)return TE;OP=1;var n=Jh(),e=wa(),t=y0(),r=tc(),i=ec(),s=e.add,o=e.has,a=e.remove;return TE=function(u){var h=n(this),c=r(u).getIterator(),d=t(h);return i(c,function(f){o(h,f)?a(d,f):s(d,f)}),d},TE}var AE,_P;function jk(){return _P||(_P=1,AE=function(n){try{var e=new Set,t={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[n](t);return r.size===1&&r.values().next().value===4}catch{return!1}}),AE}var xP;function zz(){if(xP)return MP;xP=1;var n=Dr(),e=jz(),t=jk(),r=nc(),i=!r("symmetricDifference")||!t("symmetricDifference");return n({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),MP}zz();var PP={},NE,LP;function Yz(){if(LP)return NE;LP=1;var n=Jh(),e=wa().add,t=y0(),r=tc(),i=ec();return NE=function(o){var a=n(this),l=r(o).getIterator(),u=t(a);return i(l,function(h){e(u,h)}),u},NE}var DP;function Kz(){if(DP)return PP;DP=1;var n=Dr(),e=Yz(),t=jk(),r=nc(),i=!r("union")||!t("union");return n({target:"Set",proto:!0,real:!0,forced:i},{union:e}),PP}Kz();var HP={},FP={},IE,kP;function qz(){if(kP)return IE;kP=1;var n=Qh(),e=tr();return IE=function(t){if(n(t)==="Function")return e(t)},IE}var ME,VP;function zk(){if(VP)return ME;VP=1;var n=qz(),e=_g(),t=fC(),r=n(n.bind);return ME=function(i,s){return e(i),s===void 0?i:t?r(i,s):function(){return i.apply(s,arguments)}},ME}var OE,UP;function Yk(){if(UP)return OE;UP=1;var n=jd();return OE=n("document","documentElement"),OE}var _E,BP;function S0(){if(BP)return _E;BP=1;var n=tr();return _E=n([].slice),_E}var xE,WP;function Kk(){if(WP)return xE;WP=1;var n=TypeError;return xE=function(e,t){if(e<t)throw new n("Not enough arguments");return e},xE}var PE,$P;function Xz(){if($P)return PE;$P=1;var n=wC();return PE=/(?:ipad|iphone|ipod).*applewebkit/i.test(n),PE}var LE,GP;function qk(){if(GP)return LE;GP=1;var n=Ar(),e=wC(),t=Qh(),r=function(i){return e.slice(0,i.length)===i};return LE=(function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":n.Bun&&typeof Bun.version=="string"?"BUN":n.Deno&&typeof Deno.version=="object"?"DENO":t(n.process)==="process"?"NODE":n.window&&n.document?"BROWSER":"REST"})(),LE}var DE,jP;function Qz(){if(jP)return DE;jP=1;var n=qk();return DE=n==="NODE",DE}var HE,zP;function Xk(){if(zP)return HE;zP=1;var n=Ar(),e=CC(),t=zk(),r=Xr(),i=Co(),s=Lr(),o=Yk(),a=S0(),l=p0(),u=Kk(),h=Xz(),c=Qz(),d=n.setImmediate,f=n.clearImmediate,m=n.process,p=n.Dispatch,v=n.Function,y=n.MessageChannel,C=n.String,R=0,A={},I="onreadystatechange",H,k,W,z;s(function(){H=n.location});var G=function(ie){if(i(A,ie)){var ae=A[ie];delete A[ie],ae()}},q=function(ie){return function(){G(ie)}},J=function(ie){G(ie.data)},re=function(ie){n.postMessage(C(ie),H.protocol+"//"+H.host)};return(!d||!f)&&(d=function(ae){u(arguments.length,1);var Ke=r(ae)?ae:v(ae),xe=a(arguments,1);return A[++R]=function(){e(Ke,void 0,xe)},k(R),R},f=function(ae){delete A[ae]},c?k=function(ie){m.nextTick(q(ie))}:p&&p.now?k=function(ie){p.now(q(ie))}:y&&!h?(W=new y,z=W.port2,W.port1.onmessage=J,k=t(z.postMessage,z)):n.addEventListener&&r(n.postMessage)&&!n.importScripts&&H&&H.protocol!=="file:"&&!s(re)?(k=re,n.addEventListener("message",J,!1)):I in l("script")?k=function(ie){o.appendChild(l("script"))[I]=function(){o.removeChild(this),G(ie)}}:k=function(ie){setTimeout(q(ie),0)}),HE={set:d,clear:f},HE}var YP;function Zz(){if(YP)return FP;YP=1;var n=Dr(),e=Ar(),t=Xk().clear;return n({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==t},{clearImmediate:t}),FP}var KP={},FE,qP;function Jz(){if(qP)return FE;qP=1;var n=Ar(),e=CC(),t=Xr(),r=qk(),i=wC(),s=S0(),o=Kk(),a=n.Function,l=/MSIE .\./.test(i)||r==="BUN"&&(function(){var u=n.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")})();return FE=function(u,h){var c=h?2:1;return l?function(d,f){var m=o(arguments.length,1)>c,p=t(d)?d:a(d),v=m?s(arguments,c):[],y=m?function(){e(p,this,v)}:p;return h?u(y,f):u(y)}:u},FE}var XP;function eY(){if(XP)return KP;XP=1;var n=Dr(),e=Ar(),t=Xk().set,r=Jz(),i=e.setImmediate?r(t,!1):t;return n({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),KP}var QP;function tY(){return QP||(QP=1,Zz(),eY()),HP}tY();function jl(n){"@babel/helpers - typeof";return jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jl(n)}function IA(n,e){return IA=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},IA(n,e)}function nY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lv(n,e,t){return nY()?lv=Reflect.construct:lv=function(i,s,o){var a=[null];a.push.apply(a,s);var l=Function.bind.apply(i,a),u=new l;return o&&IA(u,o.prototype),u},lv.apply(null,arguments)}function Ys(n){return rY(n)||iY(n)||sY(n)||oY()}function rY(n){if(Array.isArray(n))return MA(n)}function iY(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function sY(n,e){if(n){if(typeof n=="string")return MA(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return MA(n,e)}}function MA(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function oY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var aY=Object.hasOwnProperty,ZP=Object.setPrototypeOf,lY=Object.isFrozen,uY=Object.getPrototypeOf,hY=Object.getOwnPropertyDescriptor,li=Object.freeze,Ts=Object.seal,cY=Object.create,Qk=typeof Reflect<"u"&&Reflect,Gv=Qk.apply,OA=Qk.construct;Gv||(Gv=function(e,t,r){return e.apply(t,r)});li||(li=function(e){return e});Ts||(Ts=function(e){return e});OA||(OA=function(e,t){return lv(e,Ys(t))});var dY=As(Array.prototype.forEach),JP=As(Array.prototype.pop),lf=As(Array.prototype.push),uv=As(String.prototype.toLowerCase),kE=As(String.prototype.toString),e1=As(String.prototype.match),Fs=As(String.prototype.replace),fY=As(String.prototype.indexOf),mY=As(String.prototype.trim),Ir=As(RegExp.prototype.test),VE=gY(TypeError);function As(n){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return Gv(n,e,r)}}function gY(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return OA(n,t)}}function vt(n,e,t){var r;t=(r=t)!==null&&r!==void 0?r:uv,ZP&&ZP(n,null);for(var i=e.length;i--;){var s=e[i];if(typeof s=="string"){var o=t(s);o!==s&&(lY(e)||(e[i]=o),s=o)}n[s]=!0}return n}function Iu(n){var e=cY(null),t;for(t in n)Gv(aY,n,[t])===!0&&(e[t]=n[t]);return e}function hp(n,e){for(;n!==null;){var t=hY(n,e);if(t){if(t.get)return As(t.get);if(typeof t.value=="function")return As(t.value)}n=uY(n)}function r(i){return console.warn("fallback value for",i),null}return r}var t1=li(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),UE=li(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),BE=li(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),pY=li(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),WE=li(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),wY=li(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),n1=li(["#text"]),r1=li(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),$E=li(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),i1=li(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),cp=li(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),vY=Ts(/\{\{[\w\W]*|[\w\W]*\}\}/gm),yY=Ts(/<%[\w\W]*|[\w\W]*%>/gm),CY=Ts(/\${[\w\W]*}/gm),SY=Ts(/^data-[\-\w.\u00B7-\uFFFF]+$/),RY=Ts(/^aria-[\-\w]+$/),EY=Ts(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),bY=Ts(/^(?:\w+script|data):/i),TY=Ts(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),AY=Ts(/^html$/i),NY=Ts(/^[a-z][.\w]*(-[.\w]+)+$/i),IY=function(){return typeof window>"u"?null:window},MY=function(e,t){if(jl(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(i)&&(r=t.currentScript.getAttribute(i));var s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function Zk(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:IY(),e=function(U){return Zk(U)};if(e.version="2.5.8",e.removed=[],!n||!n.document||n.document.nodeType!==9)return e.isSupported=!1,e;var t=n.document,r=n.document,i=n.DocumentFragment,s=n.HTMLTemplateElement,o=n.Node,a=n.Element,l=n.NodeFilter,u=n.NamedNodeMap,h=u===void 0?n.NamedNodeMap||n.MozNamedAttrMap:u,c=n.HTMLFormElement,d=n.DOMParser,f=n.trustedTypes,m=a.prototype,p=hp(m,"cloneNode"),v=hp(m,"nextSibling"),y=hp(m,"childNodes"),C=hp(m,"parentNode");if(typeof s=="function"){var R=r.createElement("template");R.content&&R.content.ownerDocument&&(r=R.content.ownerDocument)}var A=MY(f,t),I=A?A.createHTML(""):"",H=r,k=H.implementation,W=H.createNodeIterator,z=H.createDocumentFragment,G=H.getElementsByTagName,q=t.importNode,J={};try{J=Iu(r).documentMode?r.documentMode:{}}catch{}var re={};e.isSupported=typeof C=="function"&&k&&k.createHTMLDocument!==void 0&&J!==9;var ie=vY,ae=yY,Ke=CY,xe=SY,Se=RY,ve=bY,He=TY,w=NY,S=EY,b=null,x=vt({},[].concat(Ys(t1),Ys(UE),Ys(BE),Ys(WE),Ys(n1))),L=null,$=vt({},[].concat(Ys(r1),Ys($E),Ys(i1),Ys(cp))),ee=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ne=null,he=null,we=!0,le=!0,$e=!1,Be=!0,Q=!1,Je=!0,nt=!1,wt=!1,et=!1,ke=!1,T=!1,O=!1,P=!0,Y=!1,F="user-content-",X=!0,B=!1,V={},K=null,j=vt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Z=null,me=vt({},["audio","video","img","source","image","track"]),Re=null,Ve=vt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ot="http://www.w3.org/1998/Math/MathML",Rt="http://www.w3.org/2000/svg",at="http://www.w3.org/1999/xhtml",qe=at,Tt=!1,dn=null,Ea=vt({},[ot,Rt,at],kE),Fi,bu=["application/xhtml+xml","text/html"],di="text/html",ue,Ue=null,Nt=r.createElement("form"),Qe=function(U){return U instanceof RegExp||U instanceof Function},fn=function(U){Ue&&Ue===U||((!U||jl(U)!=="object")&&(U={}),U=Iu(U),Fi=bu.indexOf(U.PARSER_MEDIA_TYPE)===-1?Fi=di:Fi=U.PARSER_MEDIA_TYPE,ue=Fi==="application/xhtml+xml"?kE:uv,b="ALLOWED_TAGS"in U?vt({},U.ALLOWED_TAGS,ue):x,L="ALLOWED_ATTR"in U?vt({},U.ALLOWED_ATTR,ue):$,dn="ALLOWED_NAMESPACES"in U?vt({},U.ALLOWED_NAMESPACES,kE):Ea,Re="ADD_URI_SAFE_ATTR"in U?vt(Iu(Ve),U.ADD_URI_SAFE_ATTR,ue):Ve,Z="ADD_DATA_URI_TAGS"in U?vt(Iu(me),U.ADD_DATA_URI_TAGS,ue):me,K="FORBID_CONTENTS"in U?vt({},U.FORBID_CONTENTS,ue):j,ne="FORBID_TAGS"in U?vt({},U.FORBID_TAGS,ue):{},he="FORBID_ATTR"in U?vt({},U.FORBID_ATTR,ue):{},V="USE_PROFILES"in U?U.USE_PROFILES:!1,we=U.ALLOW_ARIA_ATTR!==!1,le=U.ALLOW_DATA_ATTR!==!1,$e=U.ALLOW_UNKNOWN_PROTOCOLS||!1,Be=U.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Q=U.SAFE_FOR_TEMPLATES||!1,Je=U.SAFE_FOR_XML!==!1,nt=U.WHOLE_DOCUMENT||!1,ke=U.RETURN_DOM||!1,T=U.RETURN_DOM_FRAGMENT||!1,O=U.RETURN_TRUSTED_TYPE||!1,et=U.FORCE_BODY||!1,P=U.SANITIZE_DOM!==!1,Y=U.SANITIZE_NAMED_PROPS||!1,X=U.KEEP_CONTENT!==!1,B=U.IN_PLACE||!1,S=U.ALLOWED_URI_REGEXP||S,qe=U.NAMESPACE||at,ee=U.CUSTOM_ELEMENT_HANDLING||{},U.CUSTOM_ELEMENT_HANDLING&&Qe(U.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ee.tagNameCheck=U.CUSTOM_ELEMENT_HANDLING.tagNameCheck),U.CUSTOM_ELEMENT_HANDLING&&Qe(U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ee.attributeNameCheck=U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),U.CUSTOM_ELEMENT_HANDLING&&typeof U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ee.allowCustomizedBuiltInElements=U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Q&&(le=!1),T&&(ke=!0),V&&(b=vt({},Ys(n1)),L=[],V.html===!0&&(vt(b,t1),vt(L,r1)),V.svg===!0&&(vt(b,UE),vt(L,$E),vt(L,cp)),V.svgFilters===!0&&(vt(b,BE),vt(L,$E),vt(L,cp)),V.mathMl===!0&&(vt(b,WE),vt(L,i1),vt(L,cp))),U.ADD_TAGS&&(b===x&&(b=Iu(b)),vt(b,U.ADD_TAGS,ue)),U.ADD_ATTR&&(L===$&&(L=Iu(L)),vt(L,U.ADD_ATTR,ue)),U.ADD_URI_SAFE_ATTR&&vt(Re,U.ADD_URI_SAFE_ATTR,ue),U.FORBID_CONTENTS&&(K===j&&(K=Iu(K)),vt(K,U.FORBID_CONTENTS,ue)),X&&(b["#text"]=!0),nt&&vt(b,["html","head","body"]),b.table&&(vt(b,["tbody"]),delete ne.tbody),li&&li(U),Ue=U)},rr=vt({},["mi","mo","mn","ms","mtext"]),fi=vt({},["annotation-xml"]),Tu=vt({},["title","style","font","a","script"]),Au=vt({},UE);vt(Au,BE),vt(Au,pY);var TS=vt({},WE);vt(TS,wY);var k2=function(U){var fe=C(U);(!fe||!fe.tagName)&&(fe={namespaceURI:qe,tagName:"template"});var be=uv(U.tagName),Vt=uv(fe.tagName);return dn[U.namespaceURI]?U.namespaceURI===Rt?fe.namespaceURI===at?be==="svg":fe.namespaceURI===ot?be==="svg"&&(Vt==="annotation-xml"||rr[Vt]):!!Au[be]:U.namespaceURI===ot?fe.namespaceURI===at?be==="math":fe.namespaceURI===Rt?be==="math"&&fi[Vt]:!!TS[be]:U.namespaceURI===at?fe.namespaceURI===Rt&&!fi[Vt]||fe.namespaceURI===ot&&!rr[Vt]?!1:!TS[be]&&(Tu[be]||!Au[be]):!!(Fi==="application/xhtml+xml"&&dn[U.namespaceURI]):!1},ns=function(U){lf(e.removed,{element:U});try{U.parentNode.removeChild(U)}catch{try{U.outerHTML=I}catch{U.remove()}}},up=function(U,fe){try{lf(e.removed,{attribute:fe.getAttributeNode(U),from:fe})}catch{lf(e.removed,{attribute:null,from:fe})}if(fe.removeAttribute(U),U==="is"&&!L[U])if(ke||T)try{ns(fe)}catch{}else try{fe.setAttribute(U,"")}catch{}},c_=function(U){var fe,be;if(et)U="<remove></remove>"+U;else{var Vt=e1(U,/^[\r\n\t ]+/);be=Vt&&Vt[0]}Fi==="application/xhtml+xml"&&qe===at&&(U='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+U+"</body></html>");var mi=A?A.createHTML(U):U;if(qe===at)try{fe=new d().parseFromString(mi,Fi)}catch{}if(!fe||!fe.documentElement){fe=k.createDocument(qe,"template",null);try{fe.documentElement.innerHTML=Tt?I:mi}catch{}}var Fr=fe.body||fe.documentElement;return U&&be&&Fr.insertBefore(r.createTextNode(be),Fr.childNodes[0]||null),qe===at?G.call(fe,nt?"html":"body")[0]:nt?fe.documentElement:Fr},d_=function(U){return W.call(U.ownerDocument||U,U,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null,!1)},AS=function(U){return U instanceof c&&(typeof U.nodeName!="string"||typeof U.textContent!="string"||typeof U.removeChild!="function"||!(U.attributes instanceof h)||typeof U.removeAttribute!="function"||typeof U.setAttribute!="function"||typeof U.namespaceURI!="string"||typeof U.insertBefore!="function"||typeof U.hasChildNodes!="function")},of=function(U){return jl(o)==="object"?U instanceof o:U&&jl(U)==="object"&&typeof U.nodeType=="number"&&typeof U.nodeName=="string"},ba=function(U,fe,be){re[U]&&dY(re[U],function(Vt){Vt.call(e,fe,be,Ue)})},f_=function(U){var fe;if(ba("beforeSanitizeElements",U,null),AS(U)||Ir(/[\u0080-\uFFFF]/,U.nodeName))return ns(U),!0;var be=ue(U.nodeName);if(ba("uponSanitizeElement",U,{tagName:be,allowedTags:b}),U.hasChildNodes()&&!of(U.firstElementChild)&&(!of(U.content)||!of(U.content.firstElementChild))&&Ir(/<[/\w]/g,U.innerHTML)&&Ir(/<[/\w]/g,U.textContent)||be==="select"&&Ir(/<template/i,U.innerHTML)||U.nodeType===7||Je&&U.nodeType===8&&Ir(/<[/\w]/g,U.data))return ns(U),!0;if(!b[be]||ne[be]){if(!ne[be]&&g_(be)&&(ee.tagNameCheck instanceof RegExp&&Ir(ee.tagNameCheck,be)||ee.tagNameCheck instanceof Function&&ee.tagNameCheck(be)))return!1;if(X&&!K[be]){var Vt=C(U)||U.parentNode,mi=y(U)||U.childNodes;if(mi&&Vt)for(var Fr=mi.length,Nr=Fr-1;Nr>=0;--Nr){var Nu=p(mi[Nr],!0);Nu.__removalCount=(U.__removalCount||0)+1,Vt.insertBefore(Nu,v(U))}}return ns(U),!0}return U instanceof a&&!k2(U)||(be==="noscript"||be==="noembed"||be==="noframes")&&Ir(/<\/no(script|embed|frames)/i,U.innerHTML)?(ns(U),!0):(Q&&U.nodeType===3&&(fe=U.textContent,fe=Fs(fe,ie," "),fe=Fs(fe,ae," "),fe=Fs(fe,Ke," "),U.textContent!==fe&&(lf(e.removed,{element:U.cloneNode()}),U.textContent=fe)),ba("afterSanitizeElements",U,null),!1)},m_=function(U,fe,be){if(P&&(fe==="id"||fe==="name")&&(be in r||be in Nt))return!1;if(!(le&&!he[fe]&&Ir(xe,fe))){if(!(we&&Ir(Se,fe))){if(!L[fe]||he[fe]){if(!(g_(U)&&(ee.tagNameCheck instanceof RegExp&&Ir(ee.tagNameCheck,U)||ee.tagNameCheck instanceof Function&&ee.tagNameCheck(U))&&(ee.attributeNameCheck instanceof RegExp&&Ir(ee.attributeNameCheck,fe)||ee.attributeNameCheck instanceof Function&&ee.attributeNameCheck(fe))||fe==="is"&&ee.allowCustomizedBuiltInElements&&(ee.tagNameCheck instanceof RegExp&&Ir(ee.tagNameCheck,be)||ee.tagNameCheck instanceof Function&&ee.tagNameCheck(be))))return!1}else if(!Re[fe]){if(!Ir(S,Fs(be,He,""))){if(!((fe==="src"||fe==="xlink:href"||fe==="href")&&U!=="script"&&fY(be,"data:")===0&&Z[U])){if(!($e&&!Ir(ve,Fs(be,He,"")))){if(be)return!1}}}}}}return!0},g_=function(U){return U!=="annotation-xml"&&e1(U,w)},p_=function(U){var fe,be,Vt,mi;ba("beforeSanitizeAttributes",U,null);var Fr=U.attributes;if(!(!Fr||AS(U))){var Nr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:L};for(mi=Fr.length;mi--;){fe=Fr[mi];var Nu=fe,ir=Nu.name,NS=Nu.namespaceURI;if(be=ir==="value"?fe.value:mY(fe.value),Vt=ue(ir),Nr.attrName=Vt,Nr.attrValue=be,Nr.keepAttr=!0,Nr.forceKeepAttr=void 0,ba("uponSanitizeAttribute",U,Nr),be=Nr.attrValue,!Nr.forceKeepAttr&&(up(ir,U),!!Nr.keepAttr)){if(!Be&&Ir(/\/>/i,be)){up(ir,U);continue}Q&&(be=Fs(be,ie," "),be=Fs(be,ae," "),be=Fs(be,Ke," "));var w_=ue(U.nodeName);if(m_(w_,Vt,be)){if(Y&&(Vt==="id"||Vt==="name")&&(up(ir,U),be=F+be),Je&&Ir(/((--!?|])>)|<\/(style|title)/i,be)){up(ir,U);continue}if(A&&jl(f)==="object"&&typeof f.getAttributeType=="function"&&!NS)switch(f.getAttributeType(w_,Vt)){case"TrustedHTML":{be=A.createHTML(be);break}case"TrustedScriptURL":{be=A.createScriptURL(be);break}}try{NS?U.setAttributeNS(NS,ir,be):U.setAttribute(ir,be),AS(U)?ns(U):JP(e.removed)}catch{}}}}ba("afterSanitizeAttributes",U,null)}},V2=function Ge(U){var fe,be=d_(U);for(ba("beforeSanitizeShadowDOM",U,null);fe=be.nextNode();)ba("uponSanitizeShadowNode",fe,null),f_(fe),p_(fe),fe.content instanceof i&&Ge(fe.content);ba("afterSanitizeShadowDOM",U,null)};return e.sanitize=function(Ge){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},fe,be,Vt,mi,Fr;if(Tt=!Ge,Tt&&(Ge="<!-->"),typeof Ge!="string"&&!of(Ge))if(typeof Ge.toString=="function"){if(Ge=Ge.toString(),typeof Ge!="string")throw VE("dirty is not a string, aborting")}else throw VE("toString is not a function");if(!e.isSupported){if(jl(n.toStaticHTML)==="object"||typeof n.toStaticHTML=="function"){if(typeof Ge=="string")return n.toStaticHTML(Ge);if(of(Ge))return n.toStaticHTML(Ge.outerHTML)}return Ge}if(wt||fn(U),e.removed=[],typeof Ge=="string"&&(B=!1),B){if(Ge.nodeName){var Nr=ue(Ge.nodeName);if(!b[Nr]||ne[Nr])throw VE("root node is forbidden and cannot be sanitized in-place")}}else if(Ge instanceof o)fe=c_("<!---->"),be=fe.ownerDocument.importNode(Ge,!0),be.nodeType===1&&be.nodeName==="BODY"||be.nodeName==="HTML"?fe=be:fe.appendChild(be);else{if(!ke&&!Q&&!nt&&Ge.indexOf("<")===-1)return A&&O?A.createHTML(Ge):Ge;if(fe=c_(Ge),!fe)return ke?null:O?I:""}fe&&et&&ns(fe.firstChild);for(var Nu=d_(B?Ge:fe);Vt=Nu.nextNode();)Vt.nodeType===3&&Vt===mi||(f_(Vt),p_(Vt),Vt.content instanceof i&&V2(Vt.content),mi=Vt);if(mi=null,B)return Ge;if(ke){if(T)for(Fr=z.call(fe.ownerDocument);fe.firstChild;)Fr.appendChild(fe.firstChild);else Fr=fe;return(L.shadowroot||L.shadowrootmod)&&(Fr=q.call(t,Fr,!0)),Fr}var ir=nt?fe.outerHTML:fe.innerHTML;return nt&&b["!doctype"]&&fe.ownerDocument&&fe.ownerDocument.doctype&&fe.ownerDocument.doctype.name&&Ir(AY,fe.ownerDocument.doctype.name)&&(ir="<!DOCTYPE "+fe.ownerDocument.doctype.name+`>
`+ir),Q&&(ir=Fs(ir,ie," "),ir=Fs(ir,ae," "),ir=Fs(ir,Ke," ")),A&&O?A.createHTML(ir):ir},e.setConfig=function(Ge){fn(Ge),wt=!0},e.clearConfig=function(){Ue=null,wt=!1},e.isValidAttribute=function(Ge,U,fe){Ue||fn({});var be=ue(Ge),Vt=ue(U);return m_(be,Vt,fe)},e.addHook=function(Ge,U){typeof U=="function"&&(re[Ge]=re[Ge]||[],lf(re[Ge],U))},e.removeHook=function(Ge){if(re[Ge])return JP(re[Ge])},e.removeHooks=function(Ge){re[Ge]&&(re[Ge]=[])},e.removeAllHooks=function(){re={}},e}var OY=Zk();var Jk;function se(){return Jk.apply(null,arguments)}function _Y(n){Jk=n}function mo(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function Lh(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function Ft(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function R0(n){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(n).length===0;var e;for(e in n)if(Ft(n,e))return!1;return!0}function Ri(n){return n===void 0}function ll(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function kg(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function eV(n,e){var t=[],r,i=n.length;for(r=0;r<i;++r)t.push(e(n[r],r));return t}function Xl(n,e){for(var t in e)Ft(e,t)&&(n[t]=e[t]);return Ft(e,"toString")&&(n.toString=e.toString),Ft(e,"valueOf")&&(n.valueOf=e.valueOf),n}function va(n,e,t,r){return EV(n,e,t,r,!0).utc()}function xY(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ct(n){return n._pf==null&&(n._pf=xY()),n._pf}var _A;Array.prototype.some?_A=Array.prototype.some:_A=function(n){var e=Object(this),t=e.length>>>0,r;for(r=0;r<t;r++)if(r in e&&n.call(this,e[r],r,e))return!0;return!1};function E0(n){var e=null,t=!1,r=n._d&&!isNaN(n._d.getTime());if(r&&(e=ct(n),t=_A.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t),n._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(n))n._isValid=r;else return r;return n._isValid}function RC(n){var e=va(NaN);return n!=null?Xl(ct(e),n):ct(e).userInvalidated=!0,e}var s1=se.momentProperties=[],GE=!1;function b0(n,e){var t,r,i,s=s1.length;if(Ri(e._isAMomentObject)||(n._isAMomentObject=e._isAMomentObject),Ri(e._i)||(n._i=e._i),Ri(e._f)||(n._f=e._f),Ri(e._l)||(n._l=e._l),Ri(e._strict)||(n._strict=e._strict),Ri(e._tzm)||(n._tzm=e._tzm),Ri(e._isUTC)||(n._isUTC=e._isUTC),Ri(e._offset)||(n._offset=e._offset),Ri(e._pf)||(n._pf=ct(e)),Ri(e._locale)||(n._locale=e._locale),s>0)for(t=0;t<s;t++)r=s1[t],i=e[r],Ri(i)||(n[r]=i);return n}function Vg(n){b0(this,n),this._d=new Date(n._d!=null?n._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),GE===!1&&(GE=!0,se.updateOffset(this),GE=!1)}function go(n){return n instanceof Vg||n!=null&&n._isAMomentObject!=null}function tV(n){se.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+n)}function xs(n,e){var t=!0;return Xl(function(){if(se.deprecationHandler!=null&&se.deprecationHandler(null,n),t){var r=[],i,s,o,a=arguments.length;for(s=0;s<a;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(o in arguments[0])Ft(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[s];r.push(i)}tV(n+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var o1={};function nV(n,e){se.deprecationHandler!=null&&se.deprecationHandler(n,e),o1[n]||(tV(e),o1[n]=!0)}se.suppressDeprecationWarnings=!1;se.deprecationHandler=null;function ya(n){return typeof Function<"u"&&n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function PY(n){var e,t;for(t in n)Ft(n,t)&&(e=n[t],ya(e)?this[t]=e:this["_"+t]=e);this._config=n,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function xA(n,e){var t=Xl({},n),r;for(r in e)Ft(e,r)&&(Lh(n[r])&&Lh(e[r])?(t[r]={},Xl(t[r],n[r]),Xl(t[r],e[r])):e[r]!=null?t[r]=e[r]:delete t[r]);for(r in n)Ft(n,r)&&!Ft(e,r)&&Lh(n[r])&&(t[r]=Xl({},t[r]));return t}function T0(n){n!=null&&this.set(n)}var PA;Object.keys?PA=Object.keys:PA=function(n){var e,t=[];for(e in n)Ft(n,e)&&t.push(e);return t};var LY={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function DY(n,e,t){var r=this._calendar[n]||this._calendar.sameElse;return ya(r)?r.call(e,t):r}function da(n,e,t){var r=""+Math.abs(n),i=e-r.length,s=n>=0;return(s?t?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var A0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,dp=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,jE={},yd={};function Ye(n,e,t,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),n&&(yd[n]=i),e&&(yd[e[0]]=function(){return da(i.apply(this,arguments),e[1],e[2])}),t&&(yd[t]=function(){return this.localeData().ordinal(i.apply(this,arguments),n)})}function HY(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function FY(n){var e=n.match(A0),t,r;for(t=0,r=e.length;t<r;t++)yd[e[t]]?e[t]=yd[e[t]]:e[t]=HY(e[t]);return function(i){var s="",o;for(o=0;o<r;o++)s+=ya(e[o])?e[o].call(i,n):e[o];return s}}function hv(n,e){return n.isValid()?(e=rV(e,n.localeData()),jE[e]=jE[e]||FY(e),jE[e](n)):n.localeData().invalidDate()}function rV(n,e){var t=5;function r(i){return e.longDateFormat(i)||i}for(dp.lastIndex=0;t>=0&&dp.test(n);)n=n.replace(dp,r),dp.lastIndex=0,t-=1;return n}var kY={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function VY(n){var e=this._longDateFormat[n],t=this._longDateFormat[n.toUpperCase()];return e||!t?e:(this._longDateFormat[n]=t.match(A0).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[n])}var UY="Invalid date";function BY(){return this._invalidDate}var WY="%d",$Y=/\d{1,2}/;function GY(n){return this._ordinal.replace("%d",n)}var jY={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function zY(n,e,t,r){var i=this._relativeTime[t];return ya(i)?i(n,e,t,r):i.replace(/%d/i,n)}function YY(n,e){var t=this._relativeTime[n>0?"future":"past"];return ya(t)?t(e):t.replace(/%s/i,e)}var a1={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Ps(n){return typeof n=="string"?a1[n]||a1[n.toLowerCase()]:void 0}function N0(n){var e={},t,r;for(r in n)Ft(n,r)&&(t=Ps(r),t&&(e[t]=n[r]));return e}var KY={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function qY(n){var e=[],t;for(t in n)Ft(n,t)&&e.push({unit:t,priority:KY[t]});return e.sort(function(r,i){return r.priority-i.priority}),e}var iV=/\d/,ts=/\d\d/,sV=/\d{3}/,I0=/\d{4}/,EC=/[+-]?\d{6}/,wn=/\d\d?/,oV=/\d\d\d\d?/,aV=/\d\d\d\d\d\d?/,bC=/\d{1,3}/,M0=/\d{1,4}/,TC=/[+-]?\d{1,6}/,zd=/\d+/,AC=/[+-]?\d+/,XY=/Z|[+-]\d\d:?\d\d/gi,NC=/Z|[+-]\d\d(?::?\d\d)?/gi,QY=/[+-]?\d+(\.\d{1,3})?/,Ug=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Yd=/^[1-9]\d?/,O0=/^([1-9]\d|\d)/,jv;jv={};function _e(n,e,t){jv[n]=ya(e)?e:function(r,i){return r&&t?t:e}}function ZY(n,e){return Ft(jv,n)?jv[n](e._strict,e._locale):new RegExp(JY(n))}function JY(n){return il(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,r,i,s){return t||r||i||s}))}function il(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ys(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function Mt(n){var e=+n,t=0;return e!==0&&isFinite(e)&&(t=ys(e)),t}var LA={};function sn(n,e){var t,r=e,i;for(typeof n=="string"&&(n=[n]),ll(e)&&(r=function(s,o){o[e]=Mt(s)}),i=n.length,t=0;t<i;t++)LA[n[t]]=r}function Bg(n,e){sn(n,function(t,r,i,s){i._w=i._w||{},e(t,i._w,i,s)})}function eK(n,e,t){e!=null&&Ft(LA,n)&&LA[n](e,t._a,t,n)}function IC(n){return n%4===0&&n%100!==0||n%400===0}var Kr=0,Qa=1,na=2,hr=3,ao=4,Za=5,Th=6,tK=7,nK=8;Ye("Y",0,0,function(){var n=this.year();return n<=9999?da(n,4):"+"+n});Ye(0,["YY",2],0,function(){return this.year()%100});Ye(0,["YYYY",4],0,"year");Ye(0,["YYYYY",5],0,"year");Ye(0,["YYYYYY",6,!0],0,"year");_e("Y",AC);_e("YY",wn,ts);_e("YYYY",M0,I0);_e("YYYYY",TC,EC);_e("YYYYYY",TC,EC);sn(["YYYYY","YYYYYY"],Kr);sn("YYYY",function(n,e){e[Kr]=n.length===2?se.parseTwoDigitYear(n):Mt(n)});sn("YY",function(n,e){e[Kr]=se.parseTwoDigitYear(n)});sn("Y",function(n,e){e[Kr]=parseInt(n,10)});function Cm(n){return IC(n)?366:365}se.parseTwoDigitYear=function(n){return Mt(n)+(Mt(n)>68?1900:2e3)};var lV=Kd("FullYear",!0);function rK(){return IC(this.year())}function Kd(n,e){return function(t){return t!=null?(uV(this,n,t),se.updateOffset(this,e),this):Jm(this,n)}}function Jm(n,e){if(!n.isValid())return NaN;var t=n._d,r=n._isUTC;switch(e){case"Milliseconds":return r?t.getUTCMilliseconds():t.getMilliseconds();case"Seconds":return r?t.getUTCSeconds():t.getSeconds();case"Minutes":return r?t.getUTCMinutes():t.getMinutes();case"Hours":return r?t.getUTCHours():t.getHours();case"Date":return r?t.getUTCDate():t.getDate();case"Day":return r?t.getUTCDay():t.getDay();case"Month":return r?t.getUTCMonth():t.getMonth();case"FullYear":return r?t.getUTCFullYear():t.getFullYear();default:return NaN}}function uV(n,e,t){var r,i,s,o,a;if(!(!n.isValid()||isNaN(t))){switch(r=n._d,i=n._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(t):r.setMilliseconds(t));case"Seconds":return void(i?r.setUTCSeconds(t):r.setSeconds(t));case"Minutes":return void(i?r.setUTCMinutes(t):r.setMinutes(t));case"Hours":return void(i?r.setUTCHours(t):r.setHours(t));case"Date":return void(i?r.setUTCDate(t):r.setDate(t));case"FullYear":break;default:return}s=t,o=n.month(),a=n.date(),a=a===29&&o===1&&!IC(s)?28:a,i?r.setUTCFullYear(s,o,a):r.setFullYear(s,o,a)}}function iK(n){return n=Ps(n),ya(this[n])?this[n]():this}function sK(n,e){if(typeof n=="object"){n=N0(n);var t=qY(n),r,i=t.length;for(r=0;r<i;r++)this[t[r].unit](n[t[r].unit])}else if(n=Ps(n),ya(this[n]))return this[n](e);return this}function oK(n,e){return(n%e+e)%e}var jn;Array.prototype.indexOf?jn=Array.prototype.indexOf:jn=function(n){var e;for(e=0;e<this.length;++e)if(this[e]===n)return e;return-1};function _0(n,e){if(isNaN(n)||isNaN(e))return NaN;var t=oK(e,12);return n+=(e-t)/12,t===1?IC(n)?29:28:31-t%7%2}Ye("M",["MM",2],"Mo",function(){return this.month()+1});Ye("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});Ye("MMMM",0,0,function(n){return this.localeData().months(this,n)});_e("M",wn,Yd);_e("MM",wn,ts);_e("MMM",function(n,e){return e.monthsShortRegex(n)});_e("MMMM",function(n,e){return e.monthsRegex(n)});sn(["M","MM"],function(n,e){e[Qa]=Mt(n)-1});sn(["MMM","MMMM"],function(n,e,t,r){var i=t._locale.monthsParse(n,r,t._strict);i!=null?e[Qa]=i:ct(t).invalidMonth=n});var aK="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),hV="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),cV=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,lK=Ug,uK=Ug;function hK(n,e){return n?mo(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||cV).test(e)?"format":"standalone"][n.month()]:mo(this._months)?this._months:this._months.standalone}function cK(n,e){return n?mo(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[cV.test(e)?"format":"standalone"][n.month()]:mo(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function dK(n,e,t){var r,i,s,o=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)s=va([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(s,"").toLocaleLowerCase();return t?e==="MMM"?(i=jn.call(this._shortMonthsParse,o),i!==-1?i:null):(i=jn.call(this._longMonthsParse,o),i!==-1?i:null):e==="MMM"?(i=jn.call(this._shortMonthsParse,o),i!==-1?i:(i=jn.call(this._longMonthsParse,o),i!==-1?i:null)):(i=jn.call(this._longMonthsParse,o),i!==-1?i:(i=jn.call(this._shortMonthsParse,o),i!==-1?i:null))}function fK(n,e,t){var r,i,s;if(this._monthsParseExact)return dK.call(this,n,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=va([2e3,r]),t&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!t&&!this._monthsParse[r]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(s.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[r].test(n))return r;if(t&&e==="MMM"&&this._shortMonthsParse[r].test(n))return r;if(!t&&this._monthsParse[r].test(n))return r}}function dV(n,e){if(!n.isValid())return n;if(typeof e=="string"){if(/^\d+$/.test(e))e=Mt(e);else if(e=n.localeData().monthsParse(e),!ll(e))return n}var t=e,r=n.date();return r=r<29?r:Math.min(r,_0(n.year(),t)),n._isUTC?n._d.setUTCMonth(t,r):n._d.setMonth(t,r),n}function fV(n){return n!=null?(dV(this,n),se.updateOffset(this,!0),this):Jm(this,"Month")}function mK(){return _0(this.year(),this.month())}function gK(n){return this._monthsParseExact?(Ft(this,"_monthsRegex")||mV.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(Ft(this,"_monthsShortRegex")||(this._monthsShortRegex=lK),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function pK(n){return this._monthsParseExact?(Ft(this,"_monthsRegex")||mV.call(this),n?this._monthsStrictRegex:this._monthsRegex):(Ft(this,"_monthsRegex")||(this._monthsRegex=uK),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function mV(){function n(l,u){return u.length-l.length}var e=[],t=[],r=[],i,s,o,a;for(i=0;i<12;i++)s=va([2e3,i]),o=il(this.monthsShort(s,"")),a=il(this.months(s,"")),e.push(o),t.push(a),r.push(a),r.push(o);e.sort(n),t.sort(n),r.sort(n),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function wK(n,e,t,r,i,s,o){var a;return n<100&&n>=0?(a=new Date(n+400,e,t,r,i,s,o),isFinite(a.getFullYear())&&a.setFullYear(n)):a=new Date(n,e,t,r,i,s,o),a}function eg(n){var e,t;return n<100&&n>=0?(t=Array.prototype.slice.call(arguments),t[0]=n+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(n)):e=new Date(Date.UTC.apply(null,arguments)),e}function zv(n,e,t){var r=7+e-t,i=(7+eg(n,0,r).getUTCDay()-e)%7;return-i+r-1}function gV(n,e,t,r,i){var s=(7+t-r)%7,o=zv(n,r,i),a=1+7*(e-1)+s+o,l,u;return a<=0?(l=n-1,u=Cm(l)+a):a>Cm(n)?(l=n+1,u=a-Cm(n)):(l=n,u=a),{year:l,dayOfYear:u}}function tg(n,e,t){var r=zv(n.year(),e,t),i=Math.floor((n.dayOfYear()-r-1)/7)+1,s,o;return i<1?(o=n.year()-1,s=i+sl(o,e,t)):i>sl(n.year(),e,t)?(s=i-sl(n.year(),e,t),o=n.year()+1):(o=n.year(),s=i),{week:s,year:o}}function sl(n,e,t){var r=zv(n,e,t),i=zv(n+1,e,t);return(Cm(n)-r+i)/7}Ye("w",["ww",2],"wo","week");Ye("W",["WW",2],"Wo","isoWeek");_e("w",wn,Yd);_e("ww",wn,ts);_e("W",wn,Yd);_e("WW",wn,ts);Bg(["w","ww","W","WW"],function(n,e,t,r){e[r.substr(0,1)]=Mt(n)});function vK(n){return tg(n,this._week.dow,this._week.doy).week}var yK={dow:0,doy:6};function CK(){return this._week.dow}function SK(){return this._week.doy}function RK(n){var e=this.localeData().week(this);return n==null?e:this.add((n-e)*7,"d")}function EK(n){var e=tg(this,1,4).week;return n==null?e:this.add((n-e)*7,"d")}Ye("d",0,"do","day");Ye("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)});Ye("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)});Ye("dddd",0,0,function(n){return this.localeData().weekdays(this,n)});Ye("e",0,0,"weekday");Ye("E",0,0,"isoWeekday");_e("d",wn);_e("e",wn);_e("E",wn);_e("dd",function(n,e){return e.weekdaysMinRegex(n)});_e("ddd",function(n,e){return e.weekdaysShortRegex(n)});_e("dddd",function(n,e){return e.weekdaysRegex(n)});Bg(["dd","ddd","dddd"],function(n,e,t,r){var i=t._locale.weekdaysParse(n,r,t._strict);i!=null?e.d=i:ct(t).invalidWeekday=n});Bg(["d","e","E"],function(n,e,t,r){e[r]=Mt(n)});function bK(n,e){return typeof n!="string"?n:isNaN(n)?(n=e.weekdaysParse(n),typeof n=="number"?n:null):parseInt(n,10)}function TK(n,e){return typeof n=="string"?e.weekdaysParse(n)%7||7:isNaN(n)?null:n}function x0(n,e){return n.slice(e,7).concat(n.slice(0,e))}var AK="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),pV="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),NK="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),IK=Ug,MK=Ug,OK=Ug;function _K(n,e){var t=mo(this._weekdays)?this._weekdays:this._weekdays[n&&n!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return n===!0?x0(t,this._week.dow):n?t[n.day()]:t}function xK(n){return n===!0?x0(this._weekdaysShort,this._week.dow):n?this._weekdaysShort[n.day()]:this._weekdaysShort}function PK(n){return n===!0?x0(this._weekdaysMin,this._week.dow):n?this._weekdaysMin[n.day()]:this._weekdaysMin}function LK(n,e,t){var r,i,s,o=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)s=va([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(s,"").toLocaleLowerCase();return t?e==="dddd"?(i=jn.call(this._weekdaysParse,o),i!==-1?i:null):e==="ddd"?(i=jn.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=jn.call(this._minWeekdaysParse,o),i!==-1?i:null):e==="dddd"?(i=jn.call(this._weekdaysParse,o),i!==-1||(i=jn.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=jn.call(this._minWeekdaysParse,o),i!==-1?i:null)):e==="ddd"?(i=jn.call(this._shortWeekdaysParse,o),i!==-1||(i=jn.call(this._weekdaysParse,o),i!==-1)?i:(i=jn.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=jn.call(this._minWeekdaysParse,o),i!==-1||(i=jn.call(this._weekdaysParse,o),i!==-1)?i:(i=jn.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function DK(n,e,t){var r,i,s;if(this._weekdaysParseExact)return LK.call(this,n,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=va([2e3,1]).day(r),t&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(s.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[r].test(n))return r;if(t&&e==="ddd"&&this._shortWeekdaysParse[r].test(n))return r;if(t&&e==="dd"&&this._minWeekdaysParse[r].test(n))return r;if(!t&&this._weekdaysParse[r].test(n))return r}}function HK(n){if(!this.isValid())return n!=null?this:NaN;var e=Jm(this,"Day");return n!=null?(n=bK(n,this.localeData()),this.add(n-e,"d")):e}function FK(n){if(!this.isValid())return n!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return n==null?e:this.add(n-e,"d")}function kK(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var e=TK(n,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function VK(n){return this._weekdaysParseExact?(Ft(this,"_weekdaysRegex")||P0.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(Ft(this,"_weekdaysRegex")||(this._weekdaysRegex=IK),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function UK(n){return this._weekdaysParseExact?(Ft(this,"_weekdaysRegex")||P0.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ft(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=MK),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function BK(n){return this._weekdaysParseExact?(Ft(this,"_weekdaysRegex")||P0.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ft(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=OK),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function P0(){function n(h,c){return c.length-h.length}var e=[],t=[],r=[],i=[],s,o,a,l,u;for(s=0;s<7;s++)o=va([2e3,1]).day(s),a=il(this.weekdaysMin(o,"")),l=il(this.weekdaysShort(o,"")),u=il(this.weekdays(o,"")),e.push(a),t.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(n),t.sort(n),r.sort(n),i.sort(n),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function L0(){return this.hours()%12||12}function WK(){return this.hours()||24}Ye("H",["HH",2],0,"hour");Ye("h",["hh",2],0,L0);Ye("k",["kk",2],0,WK);Ye("hmm",0,0,function(){return""+L0.apply(this)+da(this.minutes(),2)});Ye("hmmss",0,0,function(){return""+L0.apply(this)+da(this.minutes(),2)+da(this.seconds(),2)});Ye("Hmm",0,0,function(){return""+this.hours()+da(this.minutes(),2)});Ye("Hmmss",0,0,function(){return""+this.hours()+da(this.minutes(),2)+da(this.seconds(),2)});function wV(n,e){Ye(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}wV("a",!0);wV("A",!1);function vV(n,e){return e._meridiemParse}_e("a",vV);_e("A",vV);_e("H",wn,O0);_e("h",wn,Yd);_e("k",wn,Yd);_e("HH",wn,ts);_e("hh",wn,ts);_e("kk",wn,ts);_e("hmm",oV);_e("hmmss",aV);_e("Hmm",oV);_e("Hmmss",aV);sn(["H","HH"],hr);sn(["k","kk"],function(n,e,t){var r=Mt(n);e[hr]=r===24?0:r});sn(["a","A"],function(n,e,t){t._isPm=t._locale.isPM(n),t._meridiem=n});sn(["h","hh"],function(n,e,t){e[hr]=Mt(n),ct(t).bigHour=!0});sn("hmm",function(n,e,t){var r=n.length-2;e[hr]=Mt(n.substr(0,r)),e[ao]=Mt(n.substr(r)),ct(t).bigHour=!0});sn("hmmss",function(n,e,t){var r=n.length-4,i=n.length-2;e[hr]=Mt(n.substr(0,r)),e[ao]=Mt(n.substr(r,2)),e[Za]=Mt(n.substr(i)),ct(t).bigHour=!0});sn("Hmm",function(n,e,t){var r=n.length-2;e[hr]=Mt(n.substr(0,r)),e[ao]=Mt(n.substr(r))});sn("Hmmss",function(n,e,t){var r=n.length-4,i=n.length-2;e[hr]=Mt(n.substr(0,r)),e[ao]=Mt(n.substr(r,2)),e[Za]=Mt(n.substr(i))});function $K(n){return(n+"").toLowerCase().charAt(0)==="p"}var GK=/[ap]\.?m?\.?/i,jK=Kd("Hours",!0);function zK(n,e,t){return n>11?t?"pm":"PM":t?"am":"AM"}var yV={calendar:LY,longDateFormat:kY,invalidDate:UY,ordinal:WY,dayOfMonthOrdinalParse:$Y,relativeTime:jY,months:aK,monthsShort:hV,week:yK,weekdays:AK,weekdaysMin:NK,weekdaysShort:pV,meridiemParse:GK},Cn={},uf={},ng;function YK(n,e){var t,r=Math.min(n.length,e.length);for(t=0;t<r;t+=1)if(n[t]!==e[t])return t;return r}function l1(n){return n&&n.toLowerCase().replace("_","-")}function KK(n){for(var e=0,t,r,i,s;e<n.length;){for(s=l1(n[e]).split("-"),t=s.length,r=l1(n[e+1]),r=r?r.split("-"):null;t>0;){if(i=MC(s.slice(0,t).join("-")),i)return i;if(r&&r.length>=t&&YK(s,r)>=t-1)break;t--}e++}return ng}function qK(n){return!!(n&&n.match("^[^/\\\\]*$"))}function MC(n){var e=null,t;if(Cn[n]===void 0&&typeof module<"u"&&module&&module.exports&&qK(n))try{e=ng._abbr,t=require,t("./locale/"+n),su(e)}catch{Cn[n]=null}return Cn[n]}function su(n,e){var t;return n&&(Ri(e)?t=ml(n):t=D0(n,e),t?ng=t:typeof console<"u"&&console.warn&&console.warn("Locale "+n+" not found. Did you forget to load it?")),ng._abbr}function D0(n,e){if(e!==null){var t,r=yV;if(e.abbr=n,Cn[n]!=null)nV("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Cn[n]._config;else if(e.parentLocale!=null)if(Cn[e.parentLocale]!=null)r=Cn[e.parentLocale]._config;else if(t=MC(e.parentLocale),t!=null)r=t._config;else return uf[e.parentLocale]||(uf[e.parentLocale]=[]),uf[e.parentLocale].push({name:n,config:e}),null;return Cn[n]=new T0(xA(r,e)),uf[n]&&uf[n].forEach(function(i){D0(i.name,i.config)}),su(n),Cn[n]}else return delete Cn[n],null}function XK(n,e){if(e!=null){var t,r,i=yV;Cn[n]!=null&&Cn[n].parentLocale!=null?Cn[n].set(xA(Cn[n]._config,e)):(r=MC(n),r!=null&&(i=r._config),e=xA(i,e),r==null&&(e.abbr=n),t=new T0(e),t.parentLocale=Cn[n],Cn[n]=t),su(n)}else Cn[n]!=null&&(Cn[n].parentLocale!=null?(Cn[n]=Cn[n].parentLocale,n===su()&&su(n)):Cn[n]!=null&&delete Cn[n]);return Cn[n]}function ml(n){var e;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return ng;if(!mo(n)){if(e=MC(n),e)return e;n=[n]}return KK(n)}function QK(){return PA(Cn)}function H0(n){var e,t=n._a;return t&&ct(n).overflow===-2&&(e=t[Qa]<0||t[Qa]>11?Qa:t[na]<1||t[na]>_0(t[Kr],t[Qa])?na:t[hr]<0||t[hr]>24||t[hr]===24&&(t[ao]!==0||t[Za]!==0||t[Th]!==0)?hr:t[ao]<0||t[ao]>59?ao:t[Za]<0||t[Za]>59?Za:t[Th]<0||t[Th]>999?Th:-1,ct(n)._overflowDayOfYear&&(e<Kr||e>na)&&(e=na),ct(n)._overflowWeeks&&e===-1&&(e=tK),ct(n)._overflowWeekday&&e===-1&&(e=nK),ct(n).overflow=e),n}var ZK=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,JK=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,e3=/Z|[+-]\d\d(?::?\d\d)?/,fp=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],zE=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],t3=/^\/?Date\((-?\d+)/i,n3=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,r3={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function CV(n){var e,t,r=n._i,i=ZK.exec(r)||JK.exec(r),s,o,a,l,u=fp.length,h=zE.length;if(i){for(ct(n).iso=!0,e=0,t=u;e<t;e++)if(fp[e][1].exec(i[1])){o=fp[e][0],s=fp[e][2]!==!1;break}if(o==null){n._isValid=!1;return}if(i[3]){for(e=0,t=h;e<t;e++)if(zE[e][1].exec(i[3])){a=(i[2]||" ")+zE[e][0];break}if(a==null){n._isValid=!1;return}}if(!s&&a!=null){n._isValid=!1;return}if(i[4])if(e3.exec(i[4]))l="Z";else{n._isValid=!1;return}n._f=o+(a||"")+(l||""),k0(n)}else n._isValid=!1}function i3(n,e,t,r,i,s){var o=[s3(n),hV.indexOf(e),parseInt(t,10),parseInt(r,10),parseInt(i,10)];return s&&o.push(parseInt(s,10)),o}function s3(n){var e=parseInt(n,10);return e<=49?2e3+e:e<=999?1900+e:e}function o3(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function a3(n,e,t){if(n){var r=pV.indexOf(n),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return ct(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function l3(n,e,t){if(n)return r3[n];if(e)return 0;var r=parseInt(t,10),i=r%100,s=(r-i)/100;return s*60+i}function SV(n){var e=n3.exec(o3(n._i)),t;if(e){if(t=i3(e[4],e[3],e[2],e[5],e[6],e[7]),!a3(e[1],t,n))return;n._a=t,n._tzm=l3(e[8],e[9],e[10]),n._d=eg.apply(null,n._a),n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),ct(n).rfc2822=!0}else n._isValid=!1}function u3(n){var e=t3.exec(n._i);if(e!==null){n._d=new Date(+e[1]);return}if(CV(n),n._isValid===!1)delete n._isValid;else return;if(SV(n),n._isValid===!1)delete n._isValid;else return;n._strict?n._isValid=!1:se.createFromInputFallback(n)}se.createFromInputFallback=xs("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))});function Qc(n,e,t){return n??e??t}function h3(n){var e=new Date(se.now());return n._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function F0(n){var e,t,r=[],i,s,o;if(!n._d){for(i=h3(n),n._w&&n._a[na]==null&&n._a[Qa]==null&&c3(n),n._dayOfYear!=null&&(o=Qc(n._a[Kr],i[Kr]),(n._dayOfYear>Cm(o)||n._dayOfYear===0)&&(ct(n)._overflowDayOfYear=!0),t=eg(o,0,n._dayOfYear),n._a[Qa]=t.getUTCMonth(),n._a[na]=t.getUTCDate()),e=0;e<3&&n._a[e]==null;++e)n._a[e]=r[e]=i[e];for(;e<7;e++)n._a[e]=r[e]=n._a[e]==null?e===2?1:0:n._a[e];n._a[hr]===24&&n._a[ao]===0&&n._a[Za]===0&&n._a[Th]===0&&(n._nextDay=!0,n._a[hr]=0),n._d=(n._useUTC?eg:wK).apply(null,r),s=n._useUTC?n._d.getUTCDay():n._d.getDay(),n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),n._nextDay&&(n._a[hr]=24),n._w&&typeof n._w.d<"u"&&n._w.d!==s&&(ct(n).weekdayMismatch=!0)}}function c3(n){var e,t,r,i,s,o,a,l,u;e=n._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,t=Qc(e.GG,n._a[Kr],tg(pn(),1,4).year),r=Qc(e.W,1),i=Qc(e.E,1),(i<1||i>7)&&(l=!0)):(s=n._locale._week.dow,o=n._locale._week.doy,u=tg(pn(),s,o),t=Qc(e.gg,n._a[Kr],u.year),r=Qc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(l=!0)):i=s),r<1||r>sl(t,s,o)?ct(n)._overflowWeeks=!0:l!=null?ct(n)._overflowWeekday=!0:(a=gV(t,r,i,s,o),n._a[Kr]=a.year,n._dayOfYear=a.dayOfYear)}se.ISO_8601=function(){};se.RFC_2822=function(){};function k0(n){if(n._f===se.ISO_8601){CV(n);return}if(n._f===se.RFC_2822){SV(n);return}n._a=[],ct(n).empty=!0;var e=""+n._i,t,r,i,s,o,a=e.length,l=0,u,h;for(i=rV(n._f,n._locale).match(A0)||[],h=i.length,t=0;t<h;t++)s=i[t],r=(e.match(ZY(s,n))||[])[0],r&&(o=e.substr(0,e.indexOf(r)),o.length>0&&ct(n).unusedInput.push(o),e=e.slice(e.indexOf(r)+r.length),l+=r.length),yd[s]?(r?ct(n).empty=!1:ct(n).unusedTokens.push(s),eK(s,r,n)):n._strict&&!r&&ct(n).unusedTokens.push(s);ct(n).charsLeftOver=a-l,e.length>0&&ct(n).unusedInput.push(e),n._a[hr]<=12&&ct(n).bigHour===!0&&n._a[hr]>0&&(ct(n).bigHour=void 0),ct(n).parsedDateParts=n._a.slice(0),ct(n).meridiem=n._meridiem,n._a[hr]=d3(n._locale,n._a[hr],n._meridiem),u=ct(n).era,u!==null&&(n._a[Kr]=n._locale.erasConvertYear(u,n._a[Kr])),F0(n),H0(n)}function d3(n,e,t){var r;return t==null?e:n.meridiemHour!=null?n.meridiemHour(e,t):(n.isPM!=null&&(r=n.isPM(t),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function f3(n){var e,t,r,i,s,o,a=!1,l=n._f.length;if(l===0){ct(n).invalidFormat=!0,n._d=new Date(NaN);return}for(i=0;i<l;i++)s=0,o=!1,e=b0({},n),n._useUTC!=null&&(e._useUTC=n._useUTC),e._f=n._f[i],k0(e),E0(e)&&(o=!0),s+=ct(e).charsLeftOver,s+=ct(e).unusedTokens.length*10,ct(e).score=s,a?s<r&&(r=s,t=e):(r==null||s<r||o)&&(r=s,t=e,o&&(a=!0));Xl(n,t||e)}function m3(n){if(!n._d){var e=N0(n._i),t=e.day===void 0?e.date:e.day;n._a=eV([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),F0(n)}}function g3(n){var e=new Vg(H0(RV(n)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function RV(n){var e=n._i,t=n._f;return n._locale=n._locale||ml(n._l),e===null||t===void 0&&e===""?RC({nullInput:!0}):(typeof e=="string"&&(n._i=e=n._locale.preparse(e)),go(e)?new Vg(H0(e)):(kg(e)?n._d=e:mo(t)?f3(n):t?k0(n):p3(n),E0(n)||(n._d=null),n))}function p3(n){var e=n._i;Ri(e)?n._d=new Date(se.now()):kg(e)?n._d=new Date(e.valueOf()):typeof e=="string"?u3(n):mo(e)?(n._a=eV(e.slice(0),function(t){return parseInt(t,10)}),F0(n)):Lh(e)?m3(n):ll(e)?n._d=new Date(e):se.createFromInputFallback(n)}function EV(n,e,t,r,i){var s={};return(e===!0||e===!1)&&(r=e,e=void 0),(t===!0||t===!1)&&(r=t,t=void 0),(Lh(n)&&R0(n)||mo(n)&&n.length===0)&&(n=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=t,s._i=n,s._f=e,s._strict=r,g3(s)}function pn(n,e,t,r){return EV(n,e,t,r,!1)}var w3=xs("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=pn.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:RC()}),v3=xs("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=pn.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:RC()});function bV(n,e){var t,r;if(e.length===1&&mo(e[0])&&(e=e[0]),!e.length)return pn();for(t=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][n](t))&&(t=e[r]);return t}function y3(){var n=[].slice.call(arguments,0);return bV("isBefore",n)}function C3(){var n=[].slice.call(arguments,0);return bV("isAfter",n)}var S3=function(){return Date.now?Date.now():+new Date},hf=["year","quarter","month","week","day","hour","minute","second","millisecond"];function R3(n){var e,t=!1,r,i=hf.length;for(e in n)if(Ft(n,e)&&!(jn.call(hf,e)!==-1&&(n[e]==null||!isNaN(n[e]))))return!1;for(r=0;r<i;++r)if(n[hf[r]]){if(t)return!1;parseFloat(n[hf[r]])!==Mt(n[hf[r]])&&(t=!0)}return!0}function E3(){return this._isValid}function b3(){return So(NaN)}function OC(n){var e=N0(n),t=e.year||0,r=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,h=e.millisecond||0;this._isValid=R3(e),this._milliseconds=+h+u*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+i+r*3+t*12,this._data={},this._locale=ml(),this._bubble()}function cv(n){return n instanceof OC}function DA(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function T3(n,e,t){var r=Math.min(n.length,e.length),i=Math.abs(n.length-e.length),s=0,o;for(o=0;o<r;o++)Mt(n[o])!==Mt(e[o])&&s++;return s+i}function TV(n,e){Ye(n,0,0,function(){var t=this.utcOffset(),r="+";return t<0&&(t=-t,r="-"),r+da(~~(t/60),2)+e+da(~~t%60,2)})}TV("Z",":");TV("ZZ","");_e("Z",NC);_e("ZZ",NC);sn(["Z","ZZ"],function(n,e,t){t._useUTC=!0,t._tzm=V0(NC,n)});var A3=/([\+\-]|\d\d)/gi;function V0(n,e){var t=(e||"").match(n),r,i,s;return t===null?null:(r=t[t.length-1]||[],i=(r+"").match(A3)||["-",0,0],s=+(i[1]*60)+Mt(i[2]),s===0?0:i[0]==="+"?s:-s)}function U0(n,e){var t,r;return e._isUTC?(t=e.clone(),r=(go(n)||kg(n)?n.valueOf():pn(n).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+r),se.updateOffset(t,!1),t):pn(n).local()}function HA(n){return-Math.round(n._d.getTimezoneOffset())}se.updateOffset=function(){};function N3(n,e,t){var r=this._offset||0,i;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=V0(NC,n),n===null)return this}else Math.abs(n)<16&&!t&&(n=n*60);return!this._isUTC&&e&&(i=HA(this)),this._offset=n,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==n&&(!e||this._changeInProgress?IV(this,So(n-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,se.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:HA(this)}function I3(n,e){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,e),this):-this.utcOffset()}function M3(n){return this.utcOffset(0,n)}function O3(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(HA(this),"m")),this}function _3(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var n=V0(XY,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function x3(n){return this.isValid()?(n=n?pn(n).utcOffset():0,(this.utcOffset()-n)%60===0):!1}function P3(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function L3(){if(!Ri(this._isDSTShifted))return this._isDSTShifted;var n={},e;return b0(n,this),n=RV(n),n._a?(e=n._isUTC?va(n._a):pn(n._a),this._isDSTShifted=this.isValid()&&T3(n._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function D3(){return this.isValid()?!this._isUTC:!1}function H3(){return this.isValid()?this._isUTC:!1}function AV(){return this.isValid()?this._isUTC&&this._offset===0:!1}var F3=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,k3=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function So(n,e){var t=n,r=null,i,s,o;return cv(n)?t={ms:n._milliseconds,d:n._days,M:n._months}:ll(n)||!isNaN(+n)?(t={},e?t[e]=+n:t.milliseconds=+n):(r=F3.exec(n))?(i=r[1]==="-"?-1:1,t={y:0,d:Mt(r[na])*i,h:Mt(r[hr])*i,m:Mt(r[ao])*i,s:Mt(r[Za])*i,ms:Mt(DA(r[Th]*1e3))*i}):(r=k3.exec(n))?(i=r[1]==="-"?-1:1,t={y:Mu(r[2],i),M:Mu(r[3],i),w:Mu(r[4],i),d:Mu(r[5],i),h:Mu(r[6],i),m:Mu(r[7],i),s:Mu(r[8],i)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(o=V3(pn(t.from),pn(t.to)),t={},t.ms=o.milliseconds,t.M=o.months),s=new OC(t),cv(n)&&Ft(n,"_locale")&&(s._locale=n._locale),cv(n)&&Ft(n,"_isValid")&&(s._isValid=n._isValid),s}So.fn=OC.prototype;So.invalid=b3;function Mu(n,e){var t=n&&parseFloat(n.replace(",","."));return(isNaN(t)?0:t)*e}function u1(n,e){var t={};return t.months=e.month()-n.month()+(e.year()-n.year())*12,n.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+n.clone().add(t.months,"M"),t}function V3(n,e){var t;return n.isValid()&&e.isValid()?(e=U0(e,n),n.isBefore(e)?t=u1(n,e):(t=u1(e,n),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function NV(n,e){return function(t,r){var i,s;return r!==null&&!isNaN(+r)&&(nV(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=t,t=r,r=s),i=So(t,r),IV(this,i,n),this}}function IV(n,e,t,r){var i=e._milliseconds,s=DA(e._days),o=DA(e._months);n.isValid()&&(r=r??!0,o&&dV(n,Jm(n,"Month")+o*t),s&&uV(n,"Date",Jm(n,"Date")+s*t),i&&n._d.setTime(n._d.valueOf()+i*t),r&&se.updateOffset(n,s||o))}var U3=NV(1,"add"),B3=NV(-1,"subtract");function MV(n){return typeof n=="string"||n instanceof String}function W3(n){return go(n)||kg(n)||MV(n)||ll(n)||G3(n)||$3(n)||n===null||n===void 0}function $3(n){var e=Lh(n)&&!R0(n),t=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,o=r.length;for(i=0;i<o;i+=1)s=r[i],t=t||Ft(n,s);return e&&t}function G3(n){var e=mo(n),t=!1;return e&&(t=n.filter(function(r){return!ll(r)&&MV(n)}).length===0),e&&t}function j3(n){var e=Lh(n)&&!R0(n),t=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<r.length;i+=1)s=r[i],t=t||Ft(n,s);return e&&t}function z3(n,e){var t=n.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function Y3(n,e){arguments.length===1&&(arguments[0]?W3(arguments[0])?(n=arguments[0],e=void 0):j3(arguments[0])&&(e=arguments[0],n=void 0):(n=void 0,e=void 0));var t=n||pn(),r=U0(t,this).startOf("day"),i=se.calendarFormat(this,r)||"sameElse",s=e&&(ya(e[i])?e[i].call(this,t):e[i]);return this.format(s||this.localeData().calendar(i,this,pn(t)))}function K3(){return new Vg(this)}function q3(n,e){var t=go(n)?n:pn(n);return this.isValid()&&t.isValid()?(e=Ps(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function X3(n,e){var t=go(n)?n:pn(n);return this.isValid()&&t.isValid()?(e=Ps(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function Q3(n,e,t,r){var i=go(n)?n:pn(n),s=go(e)?e:pn(e);return this.isValid()&&i.isValid()&&s.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,t):!this.isBefore(i,t))&&(r[1]===")"?this.isBefore(s,t):!this.isAfter(s,t))):!1}function Z3(n,e){var t=go(n)?n:pn(n),r;return this.isValid()&&t.isValid()?(e=Ps(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(r=t.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function J3(n,e){return this.isSame(n,e)||this.isAfter(n,e)}function eq(n,e){return this.isSame(n,e)||this.isBefore(n,e)}function tq(n,e,t){var r,i,s;if(!this.isValid())return NaN;if(r=U0(n,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Ps(e),e){case"year":s=dv(this,r)/12;break;case"month":s=dv(this,r);break;case"quarter":s=dv(this,r)/3;break;case"second":s=(this-r)/1e3;break;case"minute":s=(this-r)/6e4;break;case"hour":s=(this-r)/36e5;break;case"day":s=(this-r-i)/864e5;break;case"week":s=(this-r-i)/6048e5;break;default:s=this-r}return t?s:ys(s)}function dv(n,e){if(n.date()<e.date())return-dv(e,n);var t=(e.year()-n.year())*12+(e.month()-n.month()),r=n.clone().add(t,"months"),i,s;return e-r<0?(i=n.clone().add(t-1,"months"),s=(e-r)/(r-i)):(i=n.clone().add(t+1,"months"),s=(e-r)/(i-r)),-(t+s)||0}se.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";se.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function nq(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function rq(n){if(!this.isValid())return null;var e=n!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?hv(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ya(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",hv(t,"Z")):hv(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function iq(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var n="moment",e="",t,r,i,s;return this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+n+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(t+r+i+s)}function sq(n){n||(n=this.isUtc()?se.defaultFormatUtc:se.defaultFormat);var e=hv(this,n);return this.localeData().postformat(e)}function oq(n,e){return this.isValid()&&(go(n)&&n.isValid()||pn(n).isValid())?So({to:this,from:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function aq(n){return this.from(pn(),n)}function lq(n,e){return this.isValid()&&(go(n)&&n.isValid()||pn(n).isValid())?So({from:this,to:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function uq(n){return this.to(pn(),n)}function OV(n){var e;return n===void 0?this._locale._abbr:(e=ml(n),e!=null&&(this._locale=e),this)}var _V=xs("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===void 0?this.localeData():this.locale(n)});function xV(){return this._locale}var Yv=1e3,Cd=60*Yv,Kv=60*Cd,PV=(365*400+97)*24*Kv;function Sd(n,e){return(n%e+e)%e}function LV(n,e,t){return n<100&&n>=0?new Date(n+400,e,t)-PV:new Date(n,e,t).valueOf()}function DV(n,e,t){return n<100&&n>=0?Date.UTC(n+400,e,t)-PV:Date.UTC(n,e,t)}function hq(n){var e,t;if(n=Ps(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?DV:LV,n){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Sd(e+(this._isUTC?0:this.utcOffset()*Cd),Kv);break;case"minute":e=this._d.valueOf(),e-=Sd(e,Cd);break;case"second":e=this._d.valueOf(),e-=Sd(e,Yv);break}return this._d.setTime(e),se.updateOffset(this,!0),this}function cq(n){var e,t;if(n=Ps(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?DV:LV,n){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Kv-Sd(e+(this._isUTC?0:this.utcOffset()*Cd),Kv)-1;break;case"minute":e=this._d.valueOf(),e+=Cd-Sd(e,Cd)-1;break;case"second":e=this._d.valueOf(),e+=Yv-Sd(e,Yv)-1;break}return this._d.setTime(e),se.updateOffset(this,!0),this}function dq(){return this._d.valueOf()-(this._offset||0)*6e4}function fq(){return Math.floor(this.valueOf()/1e3)}function mq(){return new Date(this.valueOf())}function gq(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function pq(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function wq(){return this.isValid()?this.toISOString():null}function vq(){return E0(this)}function yq(){return Xl({},ct(this))}function Cq(){return ct(this).overflow}function Sq(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ye("N",0,0,"eraAbbr");Ye("NN",0,0,"eraAbbr");Ye("NNN",0,0,"eraAbbr");Ye("NNNN",0,0,"eraName");Ye("NNNNN",0,0,"eraNarrow");Ye("y",["y",1],"yo","eraYear");Ye("y",["yy",2],0,"eraYear");Ye("y",["yyy",3],0,"eraYear");Ye("y",["yyyy",4],0,"eraYear");_e("N",B0);_e("NN",B0);_e("NNN",B0);_e("NNNN",xq);_e("NNNNN",Pq);sn(["N","NN","NNN","NNNN","NNNNN"],function(n,e,t,r){var i=t._locale.erasParse(n,r,t._strict);i?ct(t).era=i:ct(t).invalidEra=n});_e("y",zd);_e("yy",zd);_e("yyy",zd);_e("yyyy",zd);_e("yo",Lq);sn(["y","yy","yyy","yyyy"],Kr);sn(["yo"],function(n,e,t,r){var i;t._locale._eraYearOrdinalRegex&&(i=n.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[Kr]=t._locale.eraYearOrdinalParse(n,i):e[Kr]=parseInt(n,10)});function Rq(n,e){var t,r,i,s=this._eras||ml("en")._eras;for(t=0,r=s.length;t<r;++t)switch(typeof s[t].since==="string"&&(i=se(s[t].since).startOf("day"),s[t].since=i.valueOf()),typeof s[t].until){case"undefined":s[t].until=1/0;break;case"string":i=se(s[t].until).startOf("day").valueOf(),s[t].until=i.valueOf();break}return s}function Eq(n,e,t){var r,i,s=this.eras(),o,a,l;for(n=n.toUpperCase(),r=0,i=s.length;r<i;++r)if(o=s[r].name.toUpperCase(),a=s[r].abbr.toUpperCase(),l=s[r].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(a===n)return s[r];break;case"NNNN":if(o===n)return s[r];break;case"NNNNN":if(l===n)return s[r];break}else if([o,a,l].indexOf(n)>=0)return s[r]}function bq(n,e){var t=n.since<=n.until?1:-1;return e===void 0?se(n.since).year():se(n.since).year()+(e-n.offset)*t}function Tq(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].name;return""}function Aq(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].narrow;return""}function Nq(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].abbr;return""}function Iq(){var n,e,t,r,i=this.localeData().eras();for(n=0,e=i.length;n<e;++n)if(t=i[n].since<=i[n].until?1:-1,r=this.clone().startOf("day").valueOf(),i[n].since<=r&&r<=i[n].until||i[n].until<=r&&r<=i[n].since)return(this.year()-se(i[n].since).year())*t+i[n].offset;return this.year()}function Mq(n){return Ft(this,"_erasNameRegex")||W0.call(this),n?this._erasNameRegex:this._erasRegex}function Oq(n){return Ft(this,"_erasAbbrRegex")||W0.call(this),n?this._erasAbbrRegex:this._erasRegex}function _q(n){return Ft(this,"_erasNarrowRegex")||W0.call(this),n?this._erasNarrowRegex:this._erasRegex}function B0(n,e){return e.erasAbbrRegex(n)}function xq(n,e){return e.erasNameRegex(n)}function Pq(n,e){return e.erasNarrowRegex(n)}function Lq(n,e){return e._eraYearOrdinalRegex||zd}function W0(){var n=[],e=[],t=[],r=[],i,s,o,a,l,u=this.eras();for(i=0,s=u.length;i<s;++i)o=il(u[i].name),a=il(u[i].abbr),l=il(u[i].narrow),e.push(o),n.push(a),t.push(l),r.push(o),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}Ye(0,["gg",2],0,function(){return this.weekYear()%100});Ye(0,["GG",2],0,function(){return this.isoWeekYear()%100});function _C(n,e){Ye(0,[n,n.length],0,e)}_C("gggg","weekYear");_C("ggggg","weekYear");_C("GGGG","isoWeekYear");_C("GGGGG","isoWeekYear");_e("G",AC);_e("g",AC);_e("GG",wn,ts);_e("gg",wn,ts);_e("GGGG",M0,I0);_e("gggg",M0,I0);_e("GGGGG",TC,EC);_e("ggggg",TC,EC);Bg(["gggg","ggggg","GGGG","GGGGG"],function(n,e,t,r){e[r.substr(0,2)]=Mt(n)});Bg(["gg","GG"],function(n,e,t,r){e[r]=se.parseTwoDigitYear(n)});function Dq(n){return HV.call(this,n,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Hq(n){return HV.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function Fq(){return sl(this.year(),1,4)}function kq(){return sl(this.isoWeekYear(),1,4)}function Vq(){var n=this.localeData()._week;return sl(this.year(),n.dow,n.doy)}function Uq(){var n=this.localeData()._week;return sl(this.weekYear(),n.dow,n.doy)}function HV(n,e,t,r,i){var s;return n==null?tg(this,r,i).year:(s=sl(n,r,i),e>s&&(e=s),Bq.call(this,n,e,t,r,i))}function Bq(n,e,t,r,i){var s=gV(n,e,t,r,i),o=eg(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Ye("Q",0,"Qo","quarter");_e("Q",iV);sn("Q",function(n,e){e[Qa]=(Mt(n)-1)*3});function Wq(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}Ye("D",["DD",2],"Do","date");_e("D",wn,Yd);_e("DD",wn,ts);_e("Do",function(n,e){return n?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});sn(["D","DD"],na);sn("Do",function(n,e){e[na]=Mt(n.match(wn)[0])});var FV=Kd("Date",!0);Ye("DDD",["DDDD",3],"DDDo","dayOfYear");_e("DDD",bC);_e("DDDD",sV);sn(["DDD","DDDD"],function(n,e,t){t._dayOfYear=Mt(n)});function $q(n){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?e:this.add(n-e,"d")}Ye("m",["mm",2],0,"minute");_e("m",wn,O0);_e("mm",wn,ts);sn(["m","mm"],ao);var Gq=Kd("Minutes",!1);Ye("s",["ss",2],0,"second");_e("s",wn,O0);_e("ss",wn,ts);sn(["s","ss"],Za);var jq=Kd("Seconds",!1);Ye("S",0,0,function(){return~~(this.millisecond()/100)});Ye(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ye(0,["SSS",3],0,"millisecond");Ye(0,["SSSS",4],0,function(){return this.millisecond()*10});Ye(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ye(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ye(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ye(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ye(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});_e("S",bC,iV);_e("SS",bC,ts);_e("SSS",bC,sV);var Ql,kV;for(Ql="SSSS";Ql.length<=9;Ql+="S")_e(Ql,zd);function zq(n,e){e[Th]=Mt(("0."+n)*1e3)}for(Ql="S";Ql.length<=9;Ql+="S")sn(Ql,zq);kV=Kd("Milliseconds",!1);Ye("z",0,0,"zoneAbbr");Ye("zz",0,0,"zoneName");function Yq(){return this._isUTC?"UTC":""}function Kq(){return this._isUTC?"Coordinated Universal Time":""}var de=Vg.prototype;de.add=U3;de.calendar=Y3;de.clone=K3;de.diff=tq;de.endOf=cq;de.format=sq;de.from=oq;de.fromNow=aq;de.to=lq;de.toNow=uq;de.get=iK;de.invalidAt=Cq;de.isAfter=q3;de.isBefore=X3;de.isBetween=Q3;de.isSame=Z3;de.isSameOrAfter=J3;de.isSameOrBefore=eq;de.isValid=vq;de.lang=_V;de.locale=OV;de.localeData=xV;de.max=v3;de.min=w3;de.parsingFlags=yq;de.set=sK;de.startOf=hq;de.subtract=B3;de.toArray=gq;de.toObject=pq;de.toDate=mq;de.toISOString=rq;de.inspect=iq;typeof Symbol<"u"&&Symbol.for!=null&&(de[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});de.toJSON=wq;de.toString=nq;de.unix=fq;de.valueOf=dq;de.creationData=Sq;de.eraName=Tq;de.eraNarrow=Aq;de.eraAbbr=Nq;de.eraYear=Iq;de.year=lV;de.isLeapYear=rK;de.weekYear=Dq;de.isoWeekYear=Hq;de.quarter=de.quarters=Wq;de.month=fV;de.daysInMonth=mK;de.week=de.weeks=RK;de.isoWeek=de.isoWeeks=EK;de.weeksInYear=Vq;de.weeksInWeekYear=Uq;de.isoWeeksInYear=Fq;de.isoWeeksInISOWeekYear=kq;de.date=FV;de.day=de.days=HK;de.weekday=FK;de.isoWeekday=kK;de.dayOfYear=$q;de.hour=de.hours=jK;de.minute=de.minutes=Gq;de.second=de.seconds=jq;de.millisecond=de.milliseconds=kV;de.utcOffset=N3;de.utc=M3;de.local=O3;de.parseZone=_3;de.hasAlignedHourOffset=x3;de.isDST=P3;de.isLocal=D3;de.isUtcOffset=H3;de.isUtc=AV;de.isUTC=AV;de.zoneAbbr=Yq;de.zoneName=Kq;de.dates=xs("dates accessor is deprecated. Use date instead.",FV);de.months=xs("months accessor is deprecated. Use month instead",fV);de.years=xs("years accessor is deprecated. Use year instead",lV);de.zone=xs("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",I3);de.isDSTShifted=xs("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",L3);function qq(n){return pn(n*1e3)}function Xq(){return pn.apply(null,arguments).parseZone()}function VV(n){return n}var kt=T0.prototype;kt.calendar=DY;kt.longDateFormat=VY;kt.invalidDate=BY;kt.ordinal=GY;kt.preparse=VV;kt.postformat=VV;kt.relativeTime=zY;kt.pastFuture=YY;kt.set=PY;kt.eras=Rq;kt.erasParse=Eq;kt.erasConvertYear=bq;kt.erasAbbrRegex=Oq;kt.erasNameRegex=Mq;kt.erasNarrowRegex=_q;kt.months=hK;kt.monthsShort=cK;kt.monthsParse=fK;kt.monthsRegex=pK;kt.monthsShortRegex=gK;kt.week=vK;kt.firstDayOfYear=SK;kt.firstDayOfWeek=CK;kt.weekdays=_K;kt.weekdaysMin=PK;kt.weekdaysShort=xK;kt.weekdaysParse=DK;kt.weekdaysRegex=VK;kt.weekdaysShortRegex=UK;kt.weekdaysMinRegex=BK;kt.isPM=$K;kt.meridiem=zK;function qv(n,e,t,r){var i=ml(),s=va().set(r,e);return i[t](s,n)}function UV(n,e,t){if(ll(n)&&(e=n,n=void 0),n=n||"",e!=null)return qv(n,e,t,"month");var r,i=[];for(r=0;r<12;r++)i[r]=qv(n,r,t,"month");return i}function $0(n,e,t,r){typeof n=="boolean"?(ll(e)&&(t=e,e=void 0),e=e||""):(e=n,t=e,n=!1,ll(e)&&(t=e,e=void 0),e=e||"");var i=ml(),s=n?i._week.dow:0,o,a=[];if(t!=null)return qv(e,(t+s)%7,r,"day");for(o=0;o<7;o++)a[o]=qv(e,(o+s)%7,r,"day");return a}function Qq(n,e){return UV(n,e,"months")}function Zq(n,e){return UV(n,e,"monthsShort")}function Jq(n,e,t){return $0(n,e,t,"weekdays")}function e6(n,e,t){return $0(n,e,t,"weekdaysShort")}function t6(n,e,t){return $0(n,e,t,"weekdaysMin")}su("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var e=n%10,t=Mt(n%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return n+t}});se.lang=xs("moment.lang is deprecated. Use moment.locale instead.",su);se.langData=xs("moment.langData is deprecated. Use moment.localeData instead.",ml);var Ta=Math.abs;function n6(){var n=this._data;return this._milliseconds=Ta(this._milliseconds),this._days=Ta(this._days),this._months=Ta(this._months),n.milliseconds=Ta(n.milliseconds),n.seconds=Ta(n.seconds),n.minutes=Ta(n.minutes),n.hours=Ta(n.hours),n.months=Ta(n.months),n.years=Ta(n.years),this}function BV(n,e,t,r){var i=So(e,t);return n._milliseconds+=r*i._milliseconds,n._days+=r*i._days,n._months+=r*i._months,n._bubble()}function r6(n,e){return BV(this,n,e,1)}function i6(n,e){return BV(this,n,e,-1)}function h1(n){return n<0?Math.floor(n):Math.ceil(n)}function s6(){var n=this._milliseconds,e=this._days,t=this._months,r=this._data,i,s,o,a,l;return n>=0&&e>=0&&t>=0||n<=0&&e<=0&&t<=0||(n+=h1(FA(t)+e)*864e5,e=0,t=0),r.milliseconds=n%1e3,i=ys(n/1e3),r.seconds=i%60,s=ys(i/60),r.minutes=s%60,o=ys(s/60),r.hours=o%24,e+=ys(o/24),l=ys(WV(e)),t+=l,e-=h1(FA(l)),a=ys(t/12),t%=12,r.days=e,r.months=t,r.years=a,this}function WV(n){return n*4800/146097}function FA(n){return n*146097/4800}function o6(n){if(!this.isValid())return NaN;var e,t,r=this._milliseconds;if(n=Ps(n),n==="month"||n==="quarter"||n==="year")switch(e=this._days+r/864e5,t=this._months+WV(e),n){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round(FA(this._months)),n){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+n)}}function gl(n){return function(){return this.as(n)}}var $V=gl("ms"),a6=gl("s"),l6=gl("m"),u6=gl("h"),h6=gl("d"),c6=gl("w"),d6=gl("M"),f6=gl("Q"),m6=gl("y"),g6=$V;function p6(){return So(this)}function w6(n){return n=Ps(n),this.isValid()?this[n+"s"]():NaN}function rc(n){return function(){return this.isValid()?this._data[n]:NaN}}var v6=rc("milliseconds"),y6=rc("seconds"),C6=rc("minutes"),S6=rc("hours"),R6=rc("days"),E6=rc("months"),b6=rc("years");function T6(){return ys(this.days()/7)}var $a=Math.round,ud={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function A6(n,e,t,r,i){return i.relativeTime(e||1,!!t,n,r)}function N6(n,e,t,r){var i=So(n).abs(),s=$a(i.as("s")),o=$a(i.as("m")),a=$a(i.as("h")),l=$a(i.as("d")),u=$a(i.as("M")),h=$a(i.as("w")),c=$a(i.as("y")),d=s<=t.ss&&["s",s]||s<t.s&&["ss",s]||o<=1&&["m"]||o<t.m&&["mm",o]||a<=1&&["h"]||a<t.h&&["hh",a]||l<=1&&["d"]||l<t.d&&["dd",l];return t.w!=null&&(d=d||h<=1&&["w"]||h<t.w&&["ww",h]),d=d||u<=1&&["M"]||u<t.M&&["MM",u]||c<=1&&["y"]||["yy",c],d[2]=e,d[3]=+n>0,d[4]=r,A6.apply(null,d)}function I6(n){return n===void 0?$a:typeof n=="function"?($a=n,!0):!1}function M6(n,e){return ud[n]===void 0?!1:e===void 0?ud[n]:(ud[n]=e,n==="s"&&(ud.ss=e-1),!0)}function O6(n,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,r=ud,i,s;return typeof n=="object"&&(e=n,n=!1),typeof n=="boolean"&&(t=n),typeof e=="object"&&(r=Object.assign({},ud,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),s=N6(this,!t,r,i),t&&(s=i.pastFuture(+this,s)),i.postformat(s)}var YE=Math.abs;function uc(n){return(n>0)-(n<0)||+n}function xC(){if(!this.isValid())return this.localeData().invalidDate();var n=YE(this._milliseconds)/1e3,e=YE(this._days),t=YE(this._months),r,i,s,o,a=this.asSeconds(),l,u,h,c;return a?(r=ys(n/60),i=ys(r/60),n%=60,r%=60,s=ys(t/12),t%=12,o=n?n.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=uc(this._months)!==uc(a)?"-":"",h=uc(this._days)!==uc(a)?"-":"",c=uc(this._milliseconds)!==uc(a)?"-":"",l+"P"+(s?u+s+"Y":"")+(t?u+t+"M":"")+(e?h+e+"D":"")+(i||r||n?"T":"")+(i?c+i+"H":"")+(r?c+r+"M":"")+(n?c+o+"S":"")):"P0D"}var Dt=OC.prototype;Dt.isValid=E3;Dt.abs=n6;Dt.add=r6;Dt.subtract=i6;Dt.as=o6;Dt.asMilliseconds=$V;Dt.asSeconds=a6;Dt.asMinutes=l6;Dt.asHours=u6;Dt.asDays=h6;Dt.asWeeks=c6;Dt.asMonths=d6;Dt.asQuarters=f6;Dt.asYears=m6;Dt.valueOf=g6;Dt._bubble=s6;Dt.clone=p6;Dt.get=w6;Dt.milliseconds=v6;Dt.seconds=y6;Dt.minutes=C6;Dt.hours=S6;Dt.days=R6;Dt.weeks=T6;Dt.months=E6;Dt.years=b6;Dt.humanize=O6;Dt.toISOString=xC;Dt.toString=xC;Dt.toJSON=xC;Dt.locale=OV;Dt.localeData=xV;Dt.toIsoString=xs("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",xC);Dt.lang=_V;Ye("X",0,0,"unix");Ye("x",0,0,"valueOf");_e("x",AC);_e("X",QY);sn("X",function(n,e,t){t._d=new Date(parseFloat(n)*1e3)});sn("x",function(n,e,t){t._d=new Date(Mt(n))});se.version="2.30.1";_Y(pn);se.fn=de;se.min=y3;se.max=C3;se.now=S3;se.utc=va;se.unix=qq;se.months=Qq;se.isDate=kg;se.locale=su;se.invalid=RC;se.duration=So;se.isMoment=go;se.weekdays=Jq;se.parseZone=Xq;se.localeData=ml;se.isDuration=cv;se.monthsShort=Zq;se.weekdaysMin=t6;se.defineLocale=D0;se.updateLocale=XK;se.locales=QK;se.weekdaysShort=e6;se.normalizeUnits=Ps;se.relativeTimeRounding=I6;se.relativeTimeThreshold=M6;se.calendarFormat=z3;se.prototype=de;se.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function _6(n){const e=n.length;let t=0;for(;t<e;)n[t]=[n[t]],t+=1}function c1(n,e){const t=e.length;let r=0;for(;r<t;)n.push(e[r]),r+=1}function fv(n){const e=[];if(!n||n.length===0||!n[0]||n[0].length===0)return e;const t=n.length,r=n[0].length;for(let i=0;i<t;i++)for(let s=0;s<r;s++)e[s]||(e[s]=[]),e[s][i]=n[i][s];return e}function hi(n,e,t,r){let i=-1,s=n,o=t;Array.isArray(n)||(s=Array.from(n));const a=s.length;for(i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function du(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length,s=[];let o=-1;for(;t<i;){const a=r[t];e(a,t,r)&&(o+=1,s[o]=a),t+=1}return s}function bt(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length,s=[];let o=-1;for(;t<i;){const a=r[t];o+=1,s[o]=e(a,t,r),t+=1}return s}function D(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length;for(;t<i&&e(r[t],t,r)!==!1;)t+=1;return n}function GV(n){const e=[];return D(n,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function d1(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[r,...i]=[...e];let s=r;return D(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function f1(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return n.split(e)}function zt(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return hi(n,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),u=t[a]?t[a]:"";return s+l+u},"").trim()}function Kn(n){let e;switch(typeof n){case"string":case"number":e=`${n}`;break;case"object":e=n===null?"":n.toString();break;case"undefined":e="";break;default:e=n.toString();break}return e}function Oe(n){return typeof n<"u"}function hn(n){return typeof n>"u"}function Bn(n){return n===null||n===""||hn(n)}function x6(n){return Object.prototype.toString.call(n)==="[object RegExp]"}const hm="length",Sm=n=>parseInt(n,16),m1=n=>parseInt(n,10),Xv=(n,e,t)=>n.substr(e,t),Rm=n=>n.codePointAt(0)-65,kA=n=>`${n}`.replace(/\-/g,""),P6=n=>Sm(Xv(kA(n),Sm("12"),Rm("F")))/(Sm(Xv(kA(n),Rm("B"),~~![][hm]))||9),L6=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let g1=!1;const p1={invalid:()=>zt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return zt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>zt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},w1={invalid:()=>zt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return zt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>zt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function D6(n,e){const t=!Bn(n),r=typeof n=="string"&&n.toLowerCase()==="non-commercial-and-evaluation",i="14.6.2";let s,o="invalid",a="invalid";n=kA(n||"");const l=H6(n);if(t||r||l)if(l){const u=se("10/02/2025","DD/MM/YYYY"),h=Math.floor(u.toDate().getTime()/864e5),c=P6(n);s=se((c+1)*864e5,"x").format("MMMM DD, YYYY"),h>c?(o="expired",a="expired"):(o="valid",a="valid")}else r?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(L6()&&(o="valid",a="valid"),!g1&&o!=="valid"&&(p1[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](p1[o]({keyValidityDate:s,hotVersion:i})),g1=!0),a!=="valid"&&e.parentNode&&w1[a]({keyValidityDate:s,hotVersion:i})){const h=document.createElement("div");h.className="hot-display-license-info",h.innerHTML=w1[a]({keyValidityDate:s,hotVersion:i}),e.parentNode.insertBefore(h,e.nextSibling)}}function H6(n){let e=[][hm],t=e;if(n[hm]!==Rm("Z"))return!1;for(let r="",i="B<H4P+".split(""),s=Rm(i.shift());s;s=Rm(i.shift()||"A"))--s<""[hm]?t=t|(m1(`${m1(Sm(r)+(Sm(Xv(n,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Xv(n,s,s?i[hm]===1?9:8:6);return t===e}function po(n){return n[0].toUpperCase()+n.substr(1)}function jV(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function zV(n){return/^([0-9][0-9]?%$)|(^100%$)/.test(n)}function YV(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${n}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,r)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[r]===void 0?"":e[r])}function v1(n){return G0(`${n}`,{ALLOWED_TAGS:[]})}function G0(n,e){return OY.sanitize(n,e)}const qd=n=>["tabindex",n],F6=()=>["role","treegrid"],oa=()=>["role","presentation"],k6=()=>["role","gridcell"],V6=()=>["role","rowheader"],KV=()=>["role","rowgroup"],U6=()=>["role","columnheader"],VA=()=>["role","row"],B6=()=>["role","menu"],W6=()=>["role","menuitem"],$6=()=>["role","menuitemcheckbox"],G6=()=>["role","combobox"],qV=()=>["role","listbox"],j6=()=>["role","option"],z6=()=>["role","checkbox"],Y6=()=>["scope","col"],K6=()=>["scope","row"],q6=()=>["type","text"],Qv=n=>["aria-label",n],ic=()=>["aria-hidden","true"],X6=()=>["aria-disabled","true"],Q6=()=>["aria-multiselectable","true"],XV=n=>["aria-haspopup",n],QV=n=>["aria-rowcount",n],PC=n=>["aria-colcount",n],ZV=n=>["aria-rowindex",n],j0=n=>["aria-colindex",n],Es=n=>["aria-expanded",n],Z6=n=>["aria-sort",n],y1=()=>["aria-readonly","true"],C1=()=>["aria-invalid","true"],JV=n=>["aria-checked",n],z0=()=>["aria-selected","true"],J6=()=>["aria-autocomplete","list"],e4=n=>["aria-controls",n],t4=n=>["aria-activedescendant",n],n4=n=>["aria-live",n],r4=n=>["aria-relevant",n],i4=n=>["aria-setsize",n],s4=n=>["aria-posinset",n];function o4(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,r=null,i=n;for(;i!==null;){if(t===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(t+=1,i=i.parentNode)}return r}function a4(n,e){const t=n.closest(".handsontable");return!!t&&(t.parentNode===e||t===e)}function l4(n){return Object.getPrototypeOf(n.parent)&&n.frameElement}function Pd(n){return l4(n)&&n.parent}function kh(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=n;for(;s!=null&&s!==t;){const{nodeType:o,nodeName:a}=s;if(o===r&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function mp(n,e,t){const r=[];let i=n;for(;i&&(i=kh(i,e,t),!(!i||t&&!t.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=r.length;return s?r[s-1]:null}function Dh(n,e){let t=n.parentNode,r=[];for(typeof e=="string"?n.defaultView?r=Array.prototype.slice.call(n.querySelectorAll(e),0):r=Array.prototype.slice.call(n.ownerDocument.querySelectorAll(e),0):r.push(e);t!==null;){if(r.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function u4(n){let e=0,t=n;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function Ou(n,e,t){const r=t.parentElement.querySelector(`.ht_clone_${n}`);return r?r.contains(e):null}function eU(n){return!n||!n.length?[]:n.filter(e=>!!e)}function tU(n,e){if(!n||!n.length)return{regexFree:[],regexes:[]};const t=[],r=[];return r.push(...n.filter(i=>{const s=i instanceof RegExp;return s&&e&&t.push(i),!s})),{regexFree:r,regexes:t}}function Ze(n,e){return n.classList===void 0||typeof e!="string"||e===""?!1:n.classList.contains(e)}function oe(n,e){typeof e=="string"&&(e=e.split(" ")),e=eU(e),e.length>0&&n.classList.add(...e)}function rt(n,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:t,regexes:r}=tU(e,!0);t=eU(t),t.length>0&&n.classList.remove(...t),r.forEach(i=>{n.classList.forEach(s=>{i.test(s)&&n.classList.remove(s)})})}function Xe(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,t]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&n.setAttribute(...r)})}function Xd(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:t,regexes:r}=tU(e,!0);t.forEach(i=>{i!==""&&n.removeAttribute(i)}),r.forEach(i=>{n.getAttributeNames().forEach(s=>{i.test(s)&&n.removeAttribute(s)})})}function nU(n){if(n.nodeType===3)n.parentNode.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1){const e=n.childNodes;for(let t=e.length-1;t>=0;t--)nU(e[t])}}function fa(n){let e;for(;e=n.lastChild;)n.removeChild(e)}const h4=/(<(.*)>|&(.*);)/;function Qd(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;h4.test(e)?n.innerHTML=t?G0(e):e:Vh(n,e)}function Vh(n,e){const t=n.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(fa(n),n.appendChild(n.ownerDocument.createTextNode(e)))}function Ld(n){const e=n.ownerDocument.documentElement;let t=n;for(;t!==e;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return Ld(t.host.impl);if(t.host)return Ld(t.host);throw new Error("Lost in Web Components world")}else return!1;else if(ul(t).display==="none")return!1;t=t.parentNode}return!0}function Sr(n){const e=n.ownerDocument,t=e.defaultView,r=e.documentElement;let i=n,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=t.pageXOffset||r.scrollLeft,o+=t.pageYOffset||r.scrollTop),{left:s,top:o}}function rU(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Y0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function K0(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?rU(e):n.scrollTop}function iU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?Y0(e):n.scrollLeft}function Zv(n){let e=n.ownerDocument,t=e?e.defaultView:void 0;e||(e=n.document?n.document:n,t=e.defaultView);const r=["auto","scroll"];let i=n.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=t.getComputedStyle(i),r.includes(s)||r.includes(o)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(s))||i.clientWidth<=i.scrollWidth+1&&(r.includes(o)||r.includes(s)))return i;i=i.parentNode}return t}function c4(n){return n.scrollHeight-n.clientHeight}function d4(n){return n.scrollWidth-n.clientWidth}function Dd(n){const e=n.ownerDocument,t=e.defaultView;let r=n.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=ul(r,t),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return r;r=r.parentNode}return t}function rg(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(n){if(n===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const r=n.style[e];if(r!==""&&r!==void 0)return r;const i=ul(n,t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function ul(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n.currentStyle||e.getComputedStyle(n)}function cn(n){return n.offsetWidth}function Xn(n){return n.offsetHeight}function hd(n){return n.clientHeight||n.innerHeight}function sU(n){return n.clientWidth||n.innerWidth}function oU(n){return n.selectionStart?n.selectionStart:0}function f4(n){return n.selectionEnd?n.selectionEnd:0}function S1(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;n.getSelection&&(n.getSelection().empty?n.getSelection().empty():n.getSelection().removeAllRanges&&n.getSelection().removeAllRanges())}function LC(n,e,t){if(t===void 0&&(t=e),n.setSelectionRange){n.focus();try{n.setSelectionRange(e,t)}catch{const i=n.parentNode,s=i.style.display;i.style.display="block",n.setSelectionRange(e,t),i.style.display=s}}}let KE;function m4(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=n.createElement("div");e.style.height="200px",e.style.width="100%";const t=n.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(n.body||n.documentElement).appendChild(t);const r=e.offsetWidth;t.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=t.clientWidth),(n.body||n.documentElement).removeChild(t),r-i}function Rr(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return KE===void 0&&(KE=m4(n)),KE}function g4(n){return n.offsetWidth!==n.clientWidth}function p4(n){return n.offsetHeight!==n.clientHeight}function q0(n,e,t){n.style.transform=`translate3d(${e},${t},0)`}function DC(n){n.style.transform&&n.style.transform!==""&&(n.style.transform="")}function mv(n){return n&&(["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true")}function aU(n){return mv(n)&&n.hasAttribute("data-hot-input")===!1}function lU(n){return!n.parentNode}function w4(n,e){new IntersectionObserver((r,i)=>{r.forEach(s=>{s.isIntersecting&&n.offsetParent!==null&&(e(),i.unobserve(n))})},{root:n.ownerDocument.body}).observe(n)}function uU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=n.ownerDocument,i=r.createRange(),s=r.defaultView.getSelection();Xe(n,"contenteditable",!0),t&&Xe(n,...ic()),e&&oe(n,"invisibleSelection"),i.selectNodeContents(n),s.removeAllRanges(),s.addRange(i)}function hU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const t=n.ownerDocument.defaultView.getSelection();n.hasAttribute("aria-hidden")&&n.removeAttribute("aria-hidden"),t.removeAllRanges(),e&&rt(n,"invisibleSelection"),n.removeAttribute("contenteditable")}function v4(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;uU(n,t),e(),hU(n,t)}function un(n){return typeof n=="function"}function X0(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,r;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t&&clearTimeout(t),t=setTimeout(()=>{r=n.apply(this,o)},e),r}return i}function cU(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.apply(this,t.concat(o))}}function y4(n){const e=n.length;function t(r){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=r.concat(o);let u;return l.length>=e?u=n.apply(this,l):u=t(l),u}}return t([])}function UA(n,e,t,r,i,s,o,a){return Oe(a)?n.call(e,t,r,i,s,o,a):Oe(o)?n.call(e,t,r,i,s,o):Oe(s)?n.call(e,t,r,i,s):Oe(i)?n.call(e,t,r,i):Oe(r)?n.call(e,t,r):Oe(t)?n.call(e,t):n.call(e)}var R1={},qE,E1;function C4(){if(E1)return qE;E1=1;var n=_s(),e=Hk().get;return qE=function(r){if(!n(r))return!1;var i=e(r);return!!i&&i.type==="RawJSON"},qE}var XE,b1;function S4(){if(b1)return XE;b1=1;var n=tr(),e=Co(),t=SyntaxError,r=parseInt,i=String.fromCharCode,s=n("".charAt),o=n("".slice),a=n(/./.exec),l={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},u=/^[\da-f]{4}$/i,h=/^[\u0000-\u001F]$/;return XE=function(c,d){for(var f=!0,m="";d<c.length;){var p=s(c,d);if(p==="\\"){var v=o(c,d,d+2);if(e(l,v))m+=l[v],d+=2;else if(v==="\\u"){d+=2;var y=o(c,d,d+4);if(!a(u,y))throw new t("Bad Unicode escape at: "+d);m+=i(r(y,16)),d+=4}else throw new t('Unknown escape sequence: "'+v+'"')}else if(p==='"'){f=!1,d++;break}else{if(a(h,p))throw new t("Bad control character in string literal at: "+d);m+=p,d++}}if(f)throw new t("Unterminated string at: "+d);return{value:m,end:d}},XE}var QE,T1;function R4(){if(T1)return QE;T1=1;var n=Lr();return QE=!n(function(){var e="9007199254740993",t=JSON.rawJSON(e);return!JSON.isRawJSON(t)||JSON.stringify(t)!==e}),QE}var A1;function E4(){if(A1)return R1;A1=1;var n=Dr(),e=jd(),t=CC(),r=yo(),i=tr(),s=Lr(),o=Wk(),a=Xr(),l=C4(),u=c0(),h=Qh(),c=SC(),d=S0(),f=S4(),m=g0(),p=h0(),v=R4(),y=String,C=e("JSON","stringify"),R=i(/./.exec),A=i("".charAt),I=i("".charCodeAt),H=i("".replace),k=i("".slice),W=i([].push),z=i(1.1.toString),G=/[\uD800-\uDFFF]/g,q=/^[\uD800-\uDBFF]$/,J=/^[\uDC00-\uDFFF]$/,re=m(),ie=re.length,ae=!p||s(function(){var He=e("Symbol")("stringify detection");return C([He])!=="[null]"||C({a:He})!=="{}"||C(Object(He))!=="{}"}),Ke=s(function(){return C("\uDF06\uD834")!=='"\\udf06\\ud834"'||C("\uDEAD")!=='"\\udead"'}),xe=ae?function(He,w){var S=d(arguments),b=ve(w);if(!(!a(b)&&(He===void 0||u(He))))return S[1]=function(x,L){if(a(b)&&(L=r(b,this,y(x),L)),!u(L))return L},t(C,null,S)}:C,Se=function(He,w,S){var b=A(S,w-1),x=A(S,w+1);return R(q,He)&&!R(J,x)||R(J,He)&&!R(q,b)?"\\u"+z(I(He,0),16):He},ve=function(He){if(a(He))return He;if(o(He)){for(var w=He.length,S=[],b=0;b<w;b++){var x=He[b];typeof x=="string"?W(S,x):(typeof x=="number"||h(x)==="Number"||h(x)==="String")&&W(S,c(x))}var L=S.length,$=!0;return function(ee,ne){if($)return $=!1,ne;if(o(this))return ne;for(var he=0;he<L;he++)if(S[he]===ee)return ne}}};return C&&n({target:"JSON",stat:!0,arity:3,forced:ae||Ke||!v},{stringify:function(w,S,b){var x=ve(S),L=[],$=xe(w,function(Be,Q){var Je=a(x)?r(x,this,y(Be),Q):Q;return!v&&l(Je)?re+(W(L,Je.rawJSON)-1):Je},b);if(typeof $!="string"||(Ke&&($=H($,G,Se)),v))return $;for(var ee="",ne=$.length,he=0;he<ne;he++){var we=A($,he);if(we==='"'){var le=f($,++he).end-1,$e=k($,he,le);ee+=k($e,0,ie)===re?L[k($e,ie)]:'"'+$e+'"',he=le}else ee+=we}return ee}}),R1}E4();function ig(n){let e;return Array.isArray(n)?e=n.length?new Array(n.length).fill(null):[]:(e={},gt(n,(t,r)=>{r!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[r]=ig(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[r]=[ig(t[0])]:e[r]=[]:e[r]=null)})),e}function Ca(n,e){return e.prototype.constructor=e,n.prototype=new e,n.prototype.constructor=n,n}function er(n,e,t){const r=Array.isArray(t);return gt(e,(i,s)=>{(r===!1||t.includes(s))&&(n[s]=i)}),n}function HC(n,e){gt(e,(t,r)=>{e[r]&&typeof e[r]=="object"?(n[r]||(Array.isArray(e[r])?n[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?n[r]=e[r]:n[r]={}),HC(n[r],e[r])):n[r]=e[r]})}function ui(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n}function ma(n){const e={};return gt(n,(t,r)=>{e[r]=t}),e}function Zt(n){n.MIXINS||(n.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return D(t,i=>{n.MIXINS.push(i.MIXIN_NAME),gt(i,(s,o)=>{if(n.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")n.prototype[o]=s;else{const a=function(h,c){const d=`_${h}`,f=m=>{let p=m;return(Array.isArray(p)||mt(p))&&(p=ui(p)),p};return function(){return this[d]===void 0&&(this[d]=f(c)),this[d]}},l=function(h){const c=`_${h}`;return function(d){this[c]=d}};Object.defineProperty(n.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),n}function Q0(n,e){return JSON.stringify(n)===JSON.stringify(e)}function mt(n){return Object.prototype.toString.call(n)==="[object Object]"}function pl(n,e,t,r){r.value=t,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(n,e,r)}function gt(n,e){for(const t in n)if((!n.hasOwnProperty||n.hasOwnProperty&&Object.prototype.hasOwnProperty.call(n,t))&&e(n[t],t,n)===!1)break;return n}function b4(n,e){const t=e.split(".");let r=n;return gt(t,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function ZE(n,e,t){const r=e.split(".");let i=n;r.forEach((s,o)=>{o!==r.length-1?(_n(i,s)||(i[s]={}),i=i[s]):i[s]=t})}function Z0(n){if(!mt(n))return 0;const e=function(t){let r=0;return mt(t)?gt(t,(i,s)=>{s!=="__children"&&(r+=e(i))}):r+=1,r};return e(n)}function lo(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,r={_touched:!1,[t]:n,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[t]},set(i){this._touched=!0,this[t]=i},enumerable:!0,configurable:!0}),r}function _n(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function J0(n){return window.requestAnimationFrame(n)}function Jv(n){window.cancelAnimationFrame(n)}function dU(){return"ontouchstart"in window}function T4(){return typeof window<"u"}let hc;function A4(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return hc||(typeof Intl=="object"?hc=new Intl.Collator(n,e).compare:typeof String.prototype.localeCompare=="function"?hc=(t,r)=>`${t}`.localeCompare(r):hc=(t,r)=>t===r?0:t>r?-1:1,hc)}const fs=n=>{const e={value:!1};return e.test=(t,r)=>{e.value=n(t,r)},e},wu={chrome:fs((n,e)=>/Chrome/.test(n)&&/Google/.test(e)),chromeWebKit:fs(n=>/CriOS/.test(n)),edge:fs(n=>/Edge/.test(n)),edgeWebKit:fs(n=>/EdgiOS/.test(n)),firefox:fs(n=>/Firefox/.test(n)),firefoxWebKit:fs(n=>/FxiOS/.test(n)),mobile:fs(n=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)),safari:fs((n,e)=>/Safari/.test(n)&&/Apple Computer/.test(e))},Wg={mac:fs(n=>/^Mac/.test(n)),win:fs(n=>/^Win/.test(n)),linux:fs(n=>/^Linux/.test(n)),ios:fs(n=>/iPhone|iPad|iPod/i.test(n))};function N4(){let{userAgent:n=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};gt(wu,t=>{let{test:r}=t;r(n,e)})}function I4(){let{platform:n=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};gt(Wg,e=>{let{test:t}=e;t(n)})}T4()&&(N4(),I4());function fU(){return wu.chrome.value}function M4(){return wu.chromeWebKit.value}function JE(){return wu.firefox.value}function O4(){return wu.firefoxWebKit.value}function mU(){return wu.safari.value}function _4(){return wu.edge.value}function Zl(){return wu.mobile.value}function gU(){return Wg.ios.value}function pU(){let{maxTouchPoints:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return n>2&&Wg.mac.value}function N1(){return Wg.win.value}function BA(){return Wg.mac.value}const We={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:JE()?182:174,AUDIO_MUTE:JE()?181:173,AUDIO_UP:JE()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},x4=[We.ALT,We.ARROW_DOWN,We.ARROW_LEFT,We.ARROW_RIGHT,We.ARROW_UP,We.AUDIO_DOWN,We.AUDIO_MUTE,We.AUDIO_UP,We.BACKSPACE,We.CAPS_LOCK,We.DELETE,We.END,We.ENTER,We.ESCAPE,We.F1,We.F2,We.F3,We.F4,We.F5,We.F6,We.F7,We.F8,We.F9,We.F10,We.F11,We.F12,We.F13,We.F14,We.F15,We.F16,We.F17,We.F18,We.F19,We.HOME,We.INSERT,We.MEDIA_NEXT,We.MEDIA_PLAY_PAUSE,We.MEDIA_PREV,We.MEDIA_STOP,We.NULL,We.NUM_LOCK,We.PAGE_DOWN,We.PAGE_UP,We.PAUSE,We.SCROLL_LOCK,We.SHIFT,We.TAB];function P4(n){return n===32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function wU(n){return x4.includes(n)}function L4(n){return[We.CONTROL,We.COMMAND_LEFT,We.COMMAND_RIGHT,We.COMMAND_FIREFOX].includes(n)}function $g(n,e){const t=e.split("|");let r=!1;return D(t,i=>{if(n===We[i])return r=!0,!1}),r}function Ro(n){n.isImmediatePropagationEnabled=!1,n.cancelBubble=!0}function Sh(n){return n.isImmediatePropagationEnabled===!1}function Uh(n){return n.button===2}function eI(n){return n.button===0}function D4(n){return n instanceof TouchEvent}function H4(n,e){const t={x:n.offsetX,y:n.offsetY};let r=n.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return t;for(;r!==e;)t.x+=r.offsetLeft,t.y+=r.offsetTop,r=r.offsetParent;return t}var I1={},eb={},tb,M1;function F4(){if(M1)return tb;M1=1;var n=Fk(),e=v0();return tb=Object.keys||function(r){return n(r,e)},tb}var O1;function k4(){if(O1)return eb;O1=1;var n=vo(),e=Lk(),t=Zh(),r=fl(),i=gC(),s=F4();return eb.f=n&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),h=s(l),c=h.length,d=0,f;c>d;)t.f(a,f=h[d++],u[f]);return a},eb}var nb,_1;function V4(){if(_1)return nb;_1=1;var n=fl(),e=k4(),t=v0(),r=w0(),i=Yk(),s=p0(),o=Dk(),a=">",l="<",u="prototype",h="script",c=o("IE_PROTO"),d=function(){},f=function(C){return l+h+a+C+l+"/"+h+a},m=function(C){C.write(f("")),C.close();var R=C.parentWindow.Object;return C=null,R},p=function(){var C=s("iframe"),R="java"+h+":",A;return C.style.display="none",i.appendChild(C),C.src=String(R),A=C.contentWindow.document,A.open(),A.write(f("document.F=Object")),A.close(),A.F},v,y=function(){try{v=new ActiveXObject("htmlfile")}catch{}y=typeof document<"u"?document.domain&&v?m(v):p():m(v);for(var C=t.length;C--;)delete y[u][t[C]];return y()};return r[c]=!0,nb=Object.create||function(R,A){var I;return R!==null?(d[u]=n(R),I=new d,d[u]=null,I[c]=R):I=y(),A===void 0?I:e.f(I,A)},nb}var rb,x1;function tI(){if(x1)return rb;x1=1;var n=pu(),e=V4(),t=Zh().f,r=n("unscopables"),i=Array.prototype;return i[r]===void 0&&t(i,r,{configurable:!0,value:e(null)}),rb=function(s){i[r][s]=!0},rb}var P1;function U4(){if(P1)return I1;P1=1;var n=tI();return n("flatMap"),I1}U4();function jt(){Oe(console)&&console.warn(...arguments)}function nI(){Oe(console)&&console.error(...arguments)}function B4(n,e,t){return(e=W4(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function W4(n){var e=$4(n,"string");return typeof e=="symbol"?e:e+""}function $4(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const cc=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],G4=zt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,ib=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),sb=new Map([[]]),gp=new WeakMap;class Ae{static getSingleton(){return z4()}constructor(){B4(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return D(cc,t=>{e[t]=[],this.initOrderMap(e,t)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;if(Array.isArray(t))D(t,s=>this.add(e,s,r));else{ib.has(e)&&jt(YV(G4,{hookName:e,removedInVersion:ib.get(e)})),sb.has(e)&&jt(sb.get(e));const s=this.getBucket(r);if(typeof s[e]>"u"&&(this.register(e),s[e]=[],this.initOrderMap(s,e)),t.skip=!1,s[e].indexOf(t)===-1){let o=!1;t.initialHook&&D(s[e],(a,l)=>{if(a.initialHook)return s[e][l]=t,o=!0,!1}),o||s[e].push(t)}this.setCallbackOrderIndex(s,e,t,i),this.orderBucketByOrderIndex(s,e)}return this}once(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;Array.isArray(t)?D(t,s=>this.once(e,s,r)):(t.runOnce=!0,this.add(e,t,r,i))}remove(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(t);return!!(r[e]!==void 0&&r[e].length)}run(e,t,r,i,s,o,a,l){{const u=this.globalBucket[t],h=u?u.length:0;let c=0;if(h)for(;c<h;){if(!u[c]||u[c].skip){c+=1;continue}const d=UA(u[c],e,r,i,s,o,a,l);d!==void 0&&(r=d),u[c]&&u[c].runOnce&&this.remove(t,u[c]),c+=1}}{const u=this.getBucket(e)[t],h=u?u.length:0;let c=0;if(h)for(;c<h;){if(!u[c]||u[c].skip){c+=1;continue}const d=UA(u[c],e,r,i,s,o,a,l);d!==void 0&&(r=d),u[c]&&u[c].runOnce&&this.remove(t,u[c],e),c+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;gt(this.getBucket(e),(t,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||cc.push(e)}deregister(e){this.isRegistered(e)&&cc.splice(cc.indexOf(e),1)}isDeprecated(e){return sb.has(e)||ib.has(e)}isRegistered(e){return cc.indexOf(e)>=0}getRegistered(){return cc}setCallbackOrderIndex(e,t,r,i){const s=Number.isInteger(i)?i:0,o=this.getCallbackOrderMap(e,t);o.set(s,[...o.get(s)||[],r])}orderBucketByOrderIndex(e,t){const r=this.getCallbackOrderMap(e,t);r===void 0||r.size===0||r.size===1&&r.has(0)||(e[t]=[...r].sort((i,s)=>i[0]-s[0]).flatMap(i=>{let[,s]=i;return s}))}initOrderMap(e,t){gp.has(e)||gp.set(e,[]),gp.get(e)[t]=new Map}getCallbackOrderMap(e,t){return gp.get(e)[t]}}const j4=new Ae;function z4(){return j4}const ob=new Map;function Eo(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";ob.has(n)||ob.set(n,new Map);const e=ob.get(n);function t(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function s(){return[...e.keys()]}function o(){return[...e.values()]}return{register:t,getItem:r,hasItem:i,getNames:s,getValues:o}}const WA=new WeakMap,{register:Y4,getItem:vU,hasItem:yU,getNames:RCe,getValues:ECe}=Eo("editors");function K4(n){const e={},t=n;this.getConstructor=function(){return n},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new t(r)),e[r.guid]},Ae.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function CU(n,e){let t;if(typeof n=="function")WA.get(n)||Wi(null,n),t=WA.get(n);else if(typeof n=="string")t=vU(n);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${n}"`);return t.getInstance(e)}function $A(n){if(typeof n=="function")return n;if(!yU(n))throw Error(`No registered editor found under "${n}" name`);return vU(n).getConstructor()}function Wi(n,e){n&&typeof n!="string"&&(e=n,n=e.EDITOR_TYPE);const t=new K4(e);typeof n=="string"&&Y4(n,t),WA.set(e,t)}function q4(n,e,t){return(e=X4(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function X4(n){var e=Q4(n,"string");return typeof e=="symbol"?e:e+""}function Q4(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class wo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;q4(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){r.call(this,Z4(o))}return this.context.eventListeners.push({element:e,event:t,callback:r,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(t,s,i),()=>{this.removeEventListener(e,t,r)}}removeEventListener(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===t&&o.element===e){if(r&&r!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const r=this.context.eventListeners[t];e&&r.eventManager!==this||(this.context.eventListeners.splice(t,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const s={bubbles:!0,cancelable:t!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let o;r.createEvent?(o=r.createEvent("MouseEvents"),o.initMouseEvent(t,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,r.body.parentNode)):o=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${t}`,o)}}function Z4(n){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=function(){e.apply(this),Ro(this)},n}function J4(n,e){eX(n,e),e.add(n)}function eX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _u(n,e,t){return(e=tX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tX(n){var e=nX(n,"string");return typeof e=="symbol"?e:e+""}function nX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function L1(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ab=new WeakSet;class GA{constructor(e,t,r){J4(this,ab),_u(this,"hot",void 0),_u(this,"tableMeta",void 0),_u(this,"selection",void 0),_u(this,"eventManager",void 0),_u(this,"destroyed",!1),_u(this,"activeEditor",void 0),_u(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=r,this.eventManager=new wo(e),this.hot.addHook("afterDocumentKeyDown",i=>L1(ab,this,rX).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,s,o)=>L1(ab,this,iX).call(this,i,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||t.isHeader())return;const{row:r,col:i}=t,s=this.hot.runHooks("modifyGetCellCoords",r,i);let o=r,a=i;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),h=this.hot.colToProp(a),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=CU(u,this.hot),this.activeEditor.prepare(r,i,h,l,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,t,r);if(t instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,r){this.activeEditor?this.activeEditor.finishEditing(e,t,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(r))||o.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!t||a)}moveSelectionAfterEnter(e){const t={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function rX(n){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Sh(n))return;const{keyCode:t}=n,r=(n.ctrlKey||n.metaKey)&&!n.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!wU(t)&&!L4(t)&&!r&&!this.isEditorOpened()&&this.openEditor("",n)}function iX(n,e){e.isCell()&&this.openEditor(null,n,!0)}const D1=new WeakMap;GA.getInstance=function(n,e,t){let r=D1.get(n);return r||(r=new GA(n,e,t),D1.set(n,r)),r};function sX(n,e){SU(n,e),e.add(n)}function cf(n,e,t){SU(n,e),e.set(n,t)}function SU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vn(n,e){return n.get(Xa(n,e))}function df(n,e,t){return n.set(Xa(n,e),t),t}function Xa(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Rd=Object.freeze({CELL:"cell",MIXED:"mixed"});var pr=new WeakMap,pp=new WeakMap,wp=new WeakMap,vp=new WeakMap,yp=new WeakMap,Hl=new WeakSet;class oX{constructor(e){var t=this;sX(this,Hl),cf(this,pr,void 0),cf(this,pp,void 0),cf(this,wp,1),cf(this,vp,null),cf(this,yp,new Map);const r=e.getSettings();df(pr,this,e),df(pp,this,r.imeFastEdit?Rd.MIXED:Rd.CELL),vn(pr,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Xa(Hl,t,lX).call(t,...s)}),vn(pr,this).addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Xa(Hl,t,H1).call(t,...s)}),vn(pr,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Xa(Hl,t,H1).call(t,...s)}),vn(pr,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Xa(Hl,t,aX).call(t,...s)})}getFocusMode(){return vn(pp,this)}setFocusMode(e){Object.values(Rd).includes(e)?df(pp,this,e):jt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return vn(wp,this)}setRefocusDelay(e){df(wp,this,e)}setRefocusElementGetter(e){df(vp,this,e)}getRefocusElement(){if(typeof vn(vp,this)=="function")return vn(vp,this).call(this);var e;return(e=vn(pr,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=r=>{var i,s;const o=(i=vn(pr,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!o)return;let a=vn(pr,this).runHooks("modifyFocusedElement",o.row,o.col,r);a instanceof HTMLElement||(a=r),a&&!((s=vn(pr,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?t(e):Xa(Hl,this,rI).call(this,r=>t(r))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vn(wp,this);const r=this.getRefocusElement();vn(pr,this).getSettings().imeFastEdit&&!((e=vn(pr,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(vn(yp,this).has(t)||vn(yp,this).set(t,X0(()=>{r.select()},t)),vn(yp,this).get(t)())}}function rI(n){var e;const t=(e=vn(pr,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||!vn(pr,this).selection.isCellVisible(t)){n(null);return}const r=vn(pr,this).getCell(t.row,t.col,!0);r===null?vn(pr,this).addHookOnce("afterScroll",()=>{n(vn(pr,this).getCell(t.row,t.col,!0))}):n(r)}function H1(){Xa(Hl,this,rI).call(this,n=>{const{activeElement:e}=vn(pr,this).rootDocument;e&&aU(e)&&e.blur(),this.focusOnHighlightedCell(n)})}function aX(){Xa(Hl,this,rI).call(this,n=>{this.getFocusMode()===Rd.MIXED&&n.nodeName==="TD"&&this.refocusToEditorTextarea()})}function lX(n){typeof n.imeFastEdit=="boolean"&&this.setFocusMode(n.imeFastEdit?Rd.MIXED:Rd.CELL)}var F1={},lb,k1;function uX(){if(k1)return lb;k1=1;var n=_s(),e=Qh(),t=pu(),r=t("match");return lb=function(i){var s;return n(i)&&((s=i[r])!==void 0?!!s:e(i)==="RegExp")},lb}var ub,V1;function hX(){if(V1)return ub;V1=1;var n=Ar(),e=Lr(),t=n.RegExp,r=!e(function(){var i=!0;try{t(".","d")}catch{i=!1}var s={},o="",a=i?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(s,d,{get:function(){return o+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var h in u)l(h,u[h]);var c=Object.getOwnPropertyDescriptor(t.prototype,"flags").get.call(s);return c!==a||o!==a});return ub={correct:r},ub}var hb,U1;function cX(){if(U1)return hb;U1=1;var n=fl();return hb=function(){var e=n(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},hb}var cb,B1;function dX(){if(B1)return cb;B1=1;var n=yo(),e=Co(),t=pC(),r=hX(),i=cX(),s=RegExp.prototype;return cb=r.correct?function(o){return o.flags}:function(o){return!r.correct&&t(s,o)&&!e(o,"flags")?n(i,o):o.flags},cb}var db,W1;function fX(){if(W1)return db;W1=1;var n=tr(),e=xg(),t=Math.floor,r=n("".charAt),i=n("".replace),s=n("".slice),o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return db=function(l,u,h,c,d,f){var m=h+l.length,p=c.length,v=a;return d!==void 0&&(d=e(d),v=o),i(f,v,function(y,C){var R;switch(r(C,0)){case"$":return"$";case"&":return l;case"`":return s(u,0,h);case"'":return s(u,m);case"<":R=d[s(C,1,-1)];break;default:var A=+C;if(A===0)return y;if(A>p){var I=t(A/10);return I===0?y:I<=p?c[I-1]===void 0?r(C,1):c[I-1]+r(C,1):y}R=c[A-1]}return R===void 0?"":R})},db}var $1;function mX(){if($1)return F1;$1=1;var n=Dr(),e=yo(),t=tr(),r=Og(),i=Xr(),s=_s(),o=uX(),a=SC(),l=yC(),u=dX(),h=fX(),c=pu(),d=d0(),f=c("replace"),m=TypeError,p=t("".indexOf),v=t("".replace),y=t("".slice),C=Math.max;return n({target:"String",proto:!0},{replaceAll:function(A,I){var H=r(this),k,W,z,G,q,J,re,ie,ae,Ke,xe=0,Se="";if(s(A)){if(k=o(A),k&&(W=a(r(u(A))),!~p(W,"g")))throw new m("`.replaceAll` does not allow non-global regexes");if(z=l(A,f),z)return e(z,A,H,I);if(d&&k)return v(a(H),A,I)}for(G=a(H),q=a(A),J=i(I),J||(I=a(I)),re=q.length,ie=C(1,re),ae=p(G,q);ae!==-1;)Ke=J?a(I(q,ae,G)):h(q,G,ae,[],void 0,I),Se+=y(G,xe,ae)+Ke,xe=ae+re,ae=ae+ie>G.length?-1:p(G,q,ae+ie);return xe<G.length&&(Se+=y(G,xe)),Se}}),F1}mX();const RU={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},gX=new RegExp(Object.keys(RU).map(n=>`(${n})`).join("|"),"gi");function pX(n){return(n&&n.nodeName||"")==="TABLE"}function G1(n){const e=n.hasColHeaders(),t=n.hasRowHeaders(),r=[e?-1:0,t?-1:0,n.countRows()-1,n.countCols()-1],i=n.getData(...r),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],h=t?1:0,c=e?1:0;for(let d=0;d<s;d+=1){const f=e&&d===0,m=[];for(let v=0;v<o;v+=1){const y=!f&&t&&v===0;let C="";if(f)C=`<th>${n.getColHeader(v-h)}</th>`;else if(y)C=`<th>${n.getRowHeader(d-c)}</th>`;else{const R=i[d][v],{hidden:A,rowspan:I,colspan:H}=n.getCellMeta(d-c,v-h);if(!A){const k=[];if(I&&k.push(`rowspan="${I}"`),H&&k.push(`colspan="${H}"`),Bn(R))C=`<td ${k.join(" ")}></td>`;else{const W=R.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C=`<td ${k.join(" ")}>${W}</td>`}}}m.push(C)}const p=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,p):u.splice(-1,0,p)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function j1(n){const e=n.length,t=["<table>"];for(let r=0;r<e;r+=1){const i=n[r],s=i.length,o=[];r===0&&t.push("<tbody>");for(let a=0;a<s;a+=1){const l=i[a],u=Bn(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,h=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(h.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${u}</td>`)}t.push("<tr>",...o,"</tr>"),r+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function wX(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const t={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let s=n;if(typeof s=="string"){const R=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,A=>{const I=A.match(/<td\b[^>]*?>/g)[0],H=/<p.*?>/g,k=A.substring(I.length,A.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(H,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${I}${k}</td>`});i.insertAdjacentHTML("afterbegin",`${R}`),s=i.querySelector("table")}if(!s||!pX(s))return;const o=i.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),u=l?Array.from(l.cells).reduce((R,A)=>R+A.colSpan,0)-(a?1:0):0,h=s.tFoot&&Array.from(s.tFoot.rows)||[],c=[];let d=!1,f=0,m=0;if(s.tHead){const R=Array.from(s.tHead.rows).filter(A=>{const I=A.querySelector("td")!==null;return I&&c.push(A),!I});f=R.length,d=f>0,f>1?t.nestedHeaders=Array.from(R).reduce((A,I)=>{const H=Array.from(I.cells).reduce((k,W,z)=>{if(a&&z===0)return k;const{colSpan:G,innerHTML:q}=W,J=G>1?{label:q,colspan:G}:q;return k.push(J),k},[]);return A.push(H),A},[]):d&&(t.colHeaders=Array.from(R[0].children).reduce((A,I,H)=>(a&&H===0||A.push(I.innerHTML),A),[]))}c.length&&(t.fixedRowsTop=c.length),h.length&&(t.fixedRowsBottom=h.length);const p=[...c,...Array.from(s.tBodies).reduce((R,A)=>(R.push(...Array.from(A.rows)),R),[]),...h];m=p.length;const v=new Array(m);for(let R=0;R<m;R++)v[R]=new Array(u);const y=[],C=[];for(let R=0;R<m;R++){const A=p[R],I=Array.from(A.cells),H=I.length;for(let k=0;k<H;k++){const W=I[k],{nodeName:z,innerHTML:G,rowSpan:q,colSpan:J}=W,re=v[R].findIndex(ie=>ie===void 0);if(z==="TD"){if(q>1||J>1){for(let xe=R;xe<R+q;xe++)if(xe<m)for(let Se=re;Se<re+J;Se++)v[xe][Se]=null;const ae=W.getAttribute("style");ae&&ae.includes("mso-ignore:colspan")||y.push({col:re,row:R,rowspan:q,colspan:J})}let ie="";o&&/excel/gi.test(o.content)?ie=G.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ie=G.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),v[R][re]=ie.replace(gX,ae=>RU[ae])}else C.push(G)}}return y.length&&(t.mergeCells=y),C.length&&(t.rowHeaders=C),v.length&&(t.data=v),t}function oi(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof n;if(t==="number")return!isNaN(n)&&isFinite(n);if(t==="string"){if(n.length===0)return!1;if(n.length===1)return/\d/.test(n);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(n.trim())}else if(t==="object")return!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date);return!1}function vX(n){return oi(n,[","])}function De(n,e,t){let r=-1;for(typeof e=="function"?(t=e,e=n):r=n-1;++r<=e&&t(r)!==!1;);}function z1(n,e,t){let r=n+1;for(typeof e=="function"&&(t=e,e=0);--r>=e&&t(r)!==!1;);}function EU(n,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(n*e/100,10)}function qt(n,e,t){return Math.min(n,e)===n?e:Math.max(n,t)===n?t:n}const jA="asc",yX="desc",Y1=new Map([[jA,[-1,1]],[yX,[1,-1]]]),CX=n=>`The priority '${n}' is already declared in a map.`,SX=n=>`The priority '${n}' is not a number.`;function RX(){let{errorPriorityExists:n,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;n=un(n)?n:CX,e=un(e)?e:SX;function r(s,o){if(!oi(s))throw new Error(e(s));if(t.has(s))throw new Error(n(s));t.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jA;const[o,a]=Y1.get(s)||Y1.get(jA);return[...t].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:r,getItems:i}}const EX=n=>`The id '${n}' is already declared in a map.`;function FC(){let{errorIdExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;n=un(n)?n:EX;function t(u,h){if(l(u))throw new Error(n(u));e.set(u,h)}function r(u){return e.delete(u)}function i(){e.clear()}function s(u){const[h]=a().find(c=>{let[d,f]=c;return u===f?d:!1})||[null];return h}function o(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:t,clear:i,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:r}}const bX=n=>`'${n}' value is already declared in a unique set.`;function TX(){let{errorItemExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;n=un(n)?n:bX;function t(s){if(e.has(s))throw new Error(n(s));e.add(s)}function r(){return[...e]}function i(){e.clear()}return{addItem:t,clear:i,getItems:r}}const iI=n=>`There is already registered "${n}" plugin.`,AX=n=>`There is already registered plugin on priority "${n}".`,NX=n=>`The priority "${n}" is not a number.`,bU=RX({errorPriorityExists:AX,errorPriorityNaN:NX}),TU=TX({errorItemExists:iI}),zA=FC({errorIdExists:iI});function AU(){return[...bU.getItems(),...TU.getItems()]}function sI(n){const e=po(n);return zA.getItem(e)}function IX(n){return!!sI(n)}function Ht(n,e,t){[n,e,t]=OX(n,e,t),sI(n)===void 0&&MX(n,e,t)}function MX(n,e,t){const r=po(n);if(zA.hasItem(r))throw new Error(iI(r));t===void 0?TU.addItem(r):bU.addItem(t,r),zA.addItem(r,e)}function OX(n,e,t){return typeof n=="function"&&(e=n,n=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[n,e,t]}const{register:_X,getItem:xX,hasItem:NU,getNames:bCe,getValues:TCe}=Eo("renderers");function YA(n){if(typeof n=="function")return n;if(!NU(n))throw Error(`No registered renderer found under "${n}" name`);return xX(n)}function hs(n,e){typeof n!="string"&&(e=n,n=e.RENDERER_TYPE),_X(n,e)}const{register:PX,getItem:LX,hasItem:IU,getNames:ACe,getValues:NCe}=Eo("validators");function DX(n){if(typeof n=="function")return n;if(!IU(n))throw Error(`No registered validator found under "${n}" name`);return LX(n)}function Zc(n,e){typeof n!="string"&&(e=n,n=e.VALIDATOR_TYPE),PX(n,e)}var K1={},q1;function HX(){if(q1)return K1;q1=1;var n=Dr(),e=xg(),t=Dg(),r=Lg(),i=tI();return n({target:"Array",proto:!0},{at:function(o){var a=e(this),l=t(a),u=r(o),h=u>=0?u:l+u;return h<0||h>=l?void 0:a[h]}}),i("at"),K1}HX();var X1={},Q1;function FX(){if(Q1)return X1;Q1=1;var n=Dr(),e=tr(),t=Og(),r=Lg(),i=SC(),s=Lr(),o=e("".charAt),a=s(function(){return"𠮷".at(-2)!=="\uD842"});return n({target:"String",proto:!0,forced:a},{at:function(u){var h=i(t(this)),c=h.length,d=r(u),f=d>=0?d:c+d;return f<0||f>=c?void 0:o(h,f)}}),X1}FX();function ff(n,e,t){return(e=kX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kX(n){var e=VX(n,"string");return typeof e=="symbol"?e:e+""}function VX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class UX{constructor(){ff(this,"count",0),ff(this,"startColumn",null),ff(this,"endColumn",null),ff(this,"startPosition",null),ff(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:o}=t,a=i>0?s+1:s;r>=i&&r+o<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:h}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+h-u[this.startColumn-1];if(m<=i&&(this.startColumn-=1),m>=i)break}this.startPosition=(t=u[this.startColumn])!==null&&t!==void 0?t:null;const c=o>0?i+1:i,d=r+i-c,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*s||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function mf(n,e,t){return(e=BX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function BX(n){var e=WX(n,"string");return typeof e=="symbol"?e:e+""}function WX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class $X{constructor(){mf(this,"count",0),mf(this,"startRow",null),mf(this,"endRow",null),mf(this,"startPosition",null),mf(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:o}=t;r>=i&&r+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-s&&(this.startRow-=1),d>=i-s)break}this.startPosition=(t=l[this.startRow])!==null&&t!==void 0?t:null;const h=r+i-s,c=this.startRow===null?0:e.getRowHeight(this.startRow);h<c||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function gf(n,e,t){return(e=GX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function GX(n){var e=jX(n,"string");return typeof e=="symbol"?e:e+""}function jX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class MU{constructor(){gf(this,"count",0),gf(this,"startColumn",null),gf(this,"endColumn",null),gf(this,"startPosition",null),gf(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:s}=t;r<=i&&(this.startColumn=e);const o=i>0?s+1:s;r>=i&&r<=i+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var t;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:h}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+h-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(t=u[this.startColumn])!==null&&t!==void 0?t:null;const c=o>0?i+1:i;r+i-c<-1*s||r>u.at(-1)+h||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function pf(n,e,t){return(e=zX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zX(n){var e=YX(n,"string");return typeof e=="symbol"?e:e+""}function YX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class OU{constructor(){pf(this,"count",0),pf(this,"startRow",null),pf(this,"endRow",null),pf(this,"startPosition",null),pf(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:s}=t;r<=i&&(this.startRow=e),r>=i&&r<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const c=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,c>=i-s)break}this.startPosition=(t=l[this.startRow])!==null&&t!==void 0?t:null,r+i-s<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function wf(n,e,t){return(e=KX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function KX(n){var e=qX(n,"string");return typeof e=="symbol"?e:e+""}function qX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class XX{constructor(){wf(this,"count",0),wf(this,"startColumn",0),wf(this,"endColumn",0),wf(this,"startPosition",0),wf(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function vf(n,e,t){return(e=QX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function QX(n){var e=ZX(n,"string");return typeof e=="symbol"?e:e+""}function ZX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class JX{constructor(){vf(this,"count",0),vf(this,"startRow",0),vf(this,"endRow",0),vf(this,"startPosition",0),vf(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}class e9 extends MU{finalize(e){var t;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:s}=e;this.startColumn!==null&&typeof r=="function"&&r(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(t=s[this.startColumn])!==null&&t!==void 0?t:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}class t9 extends OU{finalize(e){var t;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:s}=e;this.startRow!==null&&typeof r=="function"&&r(this),this.startRow<0&&(this.startRow=0),this.startPosition=(t=s[this.startRow])!==null&&t!==void 0?t:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Z1(n,e,t){return(e=n9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function n9(n){var e=r9(n,"string");return typeof e=="symbol"?e:e+""}function r9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class _U{constructor(e){Z1(this,"calculationTypes",[]),Z1(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[r,i]=t;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,t){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,r]=t;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function ks(n,e,t){return(e=i9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function i9(n){var e=s9(n,"string");return typeof e=="symbol"?e:e+""}function s9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const kC=50;class o9 extends _U{constructor(e){let{calculationTypes:t,viewportWidth:r,scrollOffset:i,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(t),ks(this,"viewportWidth",0),ks(this,"scrollOffset",0),ks(this,"zeroBasedScrollOffset",0),ks(this,"totalColumns",0),ks(this,"columnWidthFn",null),ks(this,"columnWidth",0),ks(this,"overrideFn",null),ks(this,"inlineStartOffset",0),ks(this,"totalCalculatedWidth",0),ks(this,"startPositions",[]),ks(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?kC:t}}function rs(n,e,t){return(e=a9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function a9(n){var e=l9(n,"string");return typeof e=="symbol"?e:e+""}function l9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const xU=23;class u9 extends _U{constructor(e){let{calculationTypes:t,viewportHeight:r,scrollOffset:i,totalRows:s,rowHeightFn:o,overrideFn:a,horizontalScrollbarHeight:l}=e;super(t),rs(this,"viewportHeight",0),rs(this,"scrollOffset",0),rs(this,"zeroBasedScrollOffset",0),rs(this,"totalRows",0),rs(this,"rowHeightFn",null),rs(this,"rowHeight",0),rs(this,"overrideFn",null),rs(this,"horizontalScrollbarHeight",0),rs(this,"innerViewportHeight",0),rs(this,"totalCalculatedHeight",0),rs(this,"startPositions",[]),rs(this,"needReverse",!0),this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=o,this.overrideFn=a,this.horizontalScrollbarHeight=l??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?xU:t}}function h9(n,e,t){c9(n,e),e.set(n,t)}function c9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function J1(n,e,t){return(e=d9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function d9(n){var e=f9(n,"string");return typeof e=="symbol"?e:e+""}function f9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function dc(n,e){return n.get(PU(n,e))}function eL(n,e,t){return n.set(PU(n,e),t),t}function PU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Aa=new WeakMap;class Bh{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;J1(this,"row",null),J1(this,"col",null),h9(this,Aa,!1),eL(Aa,this,r),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:r,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=t||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return dc(Aa,this)}isSouthEastOf(e){return this.row>=e.row&&(dc(Aa,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(dc(Aa,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(dc(Aa,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(dc(Aa,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof Bh&&eL(Aa,this,e.isRtl()),this}clone(){return new Bh(this.row,this.col,dc(Aa,this))}toObject(){return{row:this.row,col:this.col}}}function m9(n,e,t){g9(n,e),e.set(n,t)}function g9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fb(n,e,t){return(e=p9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function p9(n){var e=w9(n,"string");return typeof e=="symbol"?e:e+""}function w9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function is(n,e){return n.get(LU(n,e))}function v9(n,e,t){return n.set(LU(n,e),t),t}function LU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var gi=new WeakMap;class Gg{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;fb(this,"highlight",null),fb(this,"from",null),fb(this,"to",null),m9(this,gi,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=r.clone(),v9(gi,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:r}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=t&&s.row>=t&&i.col<=r&&s.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,o.row),u=Math.min(r.col,o.col),h=Math.max(i.row,a.row),c=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(h,c);return this.from=d,this.to=f,this.setDirection(s),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return is(gi,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return is(gi,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return is(gi,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return is(gi,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return is(gi,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return is(gi,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return is(gi,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return is(gi,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Bh))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return t.top===r.top&&i.push("top"),t.right===r.right&&i.push(is(gi,this)?"left":"right"),t.bottom===r.bottom&&i.push("bottom"),t.left===r.left&&i.push(is(gi,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=t.row;i++)for(let s=e.col;s<=t.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&r.push(this._createCellCoords(i,s));return r}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=t.row;i++)for(let s=e.col;s<=t.col;s++)e.row===i&&e.col===s?r.push(e):t.row===i&&t.col===s?r.push(t):r.push(this._createCellCoords(i,s));return r}forAll(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=t.row;i<=r.row;i++)for(let s=t.col;s<=r.col;s++)if(e(i,s)===!1)return}clone(){return new Gg(this.highlight,this.from,this.to,is(gi,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new Bh(e,t,is(gi,this))}}function Ao(n,e,t){y9(n,e),e.set(n,t)}function y9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fe(n,e){return n.get(DU(n,e))}function Sl(n,e,t){return n.set(DU(n,e),t),t}function DU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ss=new WeakMap,mb=new WeakMap,dr=new WeakMap,fc=new WeakMap,Cp=new WeakMap,Vs=new WeakMap,gb=new WeakMap,yf=new WeakMap,xu=new WeakMap,No=new WeakMap;let HU=class{constructor(e,t,r,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Ao(this,ss,void 0),Ao(this,mb,void 0),Ao(this,dr,void 0),Ao(this,fc,void 0),Ao(this,Cp,void 0),Ao(this,Vs,void 0),Ao(this,gb,void 0),Ao(this,yf,void 0),Ao(this,xu,[null,null]),Ao(this,No,[null,null]),Sl(ss,this,r),Sl(mb,this,t),Sl(dr,this,s),Sl(fc,this,o),Sl(Cp,this,a),Sl(Vs,this,i),Sl(gb,this,e),this.registerEvents()}registerEvents(){Fe(Vs,this).addEventListener(Fe(dr,this).holder,"contextmenu",r=>this.onContextMenu(r)),Fe(Vs,this).addEventListener(Fe(dr,this).TABLE,"mouseover",r=>this.onMouseOver(r)),Fe(Vs,this).addEventListener(Fe(dr,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{Fe(Vs,this).addEventListener(Fe(dr,this).holder,"touchstart",r=>this.onTouchStart(r)),Fe(Vs,this).addEventListener(Fe(dr,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),Fe(Vs,this).addEventListener(Fe(dr,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Fe(ss,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Fe(ss,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{Fe(Vs,this).addEventListener(Fe(dr,this).holder,"mouseup",r=>this.onMouseUp(r)),Fe(Vs,this).addEventListener(Fe(dr,this).holder,"mousedown",r=>this.onMouseDown(r))};Zl()?e():(dU()&&e(),t())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(Fe(yf,this)&&r){const[i,s]=[r.row,Fe(yf,this).from.row],[o,a]=[r.col,Fe(yf,this).from.col];return i===s&&o===a}return!1}parentCell(e){const t={},r=Fe(dr,this).TABLE,i=mp(e,["TD","TH"],r);return i?(t.coords=Fe(dr,this).getCoords(i),t.TD=i):Ze(e,"wtBorder")&&Ze(e,"current")?(t.coords=Fe(fc,this).getFocusSelection().cellRange.highlight,t.TD=Fe(dr,this).getCell(t.coords)):Ze(e,"wtBorder")&&Ze(e,"area")&&Fe(fc,this).getAreaSelection().cellRange&&(t.coords=Fe(fc,this).getAreaSelection().cellRange.to,t.TD=Fe(dr,this).getCell(t.coords)),t}onMouseDown(e){const t=Fe(mb,this).rootDocument.activeElement,r=cU(o4,e.target),i=e.target;if(!["TD","TH"].includes(t.nodeName)&&(i===t||r(0)===t||r(1)===t))return;const s=this.parentCell(i);Ze(i,"corner")?Fe(ss,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&Fe(ss,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(Fe(No,this)[0]=s.TD,clearTimeout(Fe(xu,this)[0]),Fe(xu,this)[0]=setTimeout(()=>{Fe(No,this)[0]=null},1e3))}onContextMenu(e){if(Fe(ss,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!Fe(ss,this).has("onCellMouseOver"))return;const t=Fe(dr,this).TABLE,r=mp(e.target,["TD","TH"],t),i=Fe(Cp,this)||this;r&&r!==i.lastMouseOver&&Dh(r,t)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,Fe(dr,this).getCoords(r),r))}onMouseOut(e){if(!Fe(ss,this).has("onCellMouseOut"))return;const t=Fe(dr,this).TABLE,r=mp(e.target,["TD","TH"],t),i=mp(e.relatedTarget,["TD","TH"],t),s=Fe(Cp,this)||this;r&&r!==i&&Dh(r,t)&&(this.callListener("onCellMouseOut",e,Fe(dr,this).getCoords(r),r),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&Fe(ss,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),!(e.button!==0&&!this.touchApplied)&&(t.TD===Fe(No,this)[0]&&t.TD===Fe(No,this)[1]?(Ze(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),Fe(No,this)[0]=null,Fe(No,this)[1]=null):t.TD===Fe(No,this)[0]&&(Fe(No,this)[1]=t.TD,clearTimeout(Fe(xu,this)[1]),Fe(xu,this)[1]=setTimeout(()=>{Fe(No,this)[1]=null},500)))}onTouchStart(e){Sl(yf,this,Fe(fc,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const r=e.target,i=(t=this.parentCell(r))===null||t===void 0?void 0:t.coords,s=Oe(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&Fe(ss,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];gU()&&(M4()||O4())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,r,i){const s=Fe(ss,this).getSettingPure(e);s&&s(t,r,i,Fe(gb,this).call(this))}destroy(){clearTimeout(Fe(xu,this)[0]),clearTimeout(Fe(xu,this)[1]),Fe(Vs,this).destroy()}};function pb(n,e,t){return(e=C9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function C9(n){var e=S9(n,"string");return typeof e=="symbol"?e:e+""}function S9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class R9{constructor(e,t,r){pb(this,"offset",void 0),pb(this,"total",void 0),pb(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function wb(n,e,t){return(e=E9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function E9(n){var e=b9(n,"string");return typeof e=="symbol"?e:e+""}function b9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class T9{constructor(e,t,r){wb(this,"offset",void 0),wb(this,"total",void 0),wb(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const A9=0,ey=1,ty=2;function Sp(n,e,t){return(e=N9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function N9(n){var e=I9(n,"string");return typeof e=="symbol"?e:e+""}function I9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class tL{constructor(){Sp(this,"currentSize",0),Sp(this,"nextSize",0),Sp(this,"currentOffset",0),Sp(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function vb(n,e,t){return(e=M9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function M9(n){var e=O9(n,"string");return typeof e=="symbol"?e:e+""}function O9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class _9{constructor(){vb(this,"size",new tL),vb(this,"workingSpace",A9),vb(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof tL}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=ey,e.workingSpace=ty,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=ty,e.workingSpace=ey,this.sharedSize=e.getViewSize()}}function mc(n,e,t){return(e=x9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function x9(n){var e=P9(n,"string");return typeof e=="symbol"?e:e+""}function P9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class FU{constructor(e,t,r){mc(this,"rootNode",void 0),mc(this,"nodesPool",void 0),mc(this,"sizeSet",new _9),mc(this,"childNodeType",void 0),mc(this,"visualIndex",0),mc(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(t.isPlaceOn(ey))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,r=this.isSharedViewSet(),{nextSize:i}=t.getViewSize();let s=this.getRenderedChildCount();for(;s<i;){const a=this.nodesPool();!r||r&&t.isPlaceOn(ty)?e.appendChild(a):e.insertBefore(a,e.firstChild),s+=1}const o=r&&t.isPlaceOn(ey);for(;s>i;)e.removeChild(o?e.firstChild:e.lastChild),s-=1}render(){const{rootNode:e,sizeSet:t}=this;let r=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(ty)&&(r+=t.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const s=this.nodesPool();e.replaceChild(s,i),i=s}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class kU extends FU{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function L9(n,e,t){return(e=D9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function D9(n){var e=H9(n,"string");return typeof e=="symbol"?e:e+""}function H9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class F9{constructor(e){L9(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Cf(n,e,t){return(e=k9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function k9(n){var e=V9(n,"string");return typeof e=="symbol"?e:e+""}function V9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class jg{constructor(e,t){Cf(this,"nodesPool",null),Cf(this,"nodeType",void 0),Cf(this,"rootNode",void 0),Cf(this,"table",null),Cf(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new F9(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function nL(n,e,t){return(e=U9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function U9(n){var e=B9(n,"string");return typeof e=="symbol"?e:e+""}function B9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class W9 extends jg{constructor(){super("TH"),nL(this,"orderViews",new WeakMap),nL(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new kU(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:r,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(l),h=s.obtainOrderView(l);u.appendView(h).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let c=0;c<r;c++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Xd(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Xe(d,[V6(),K6(),j0(c+1),qd(-1)]),t[c](a,d,c)}u.end()}}}class $9 extends jg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+t;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<s;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)r.removeChild(r.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&fa(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Xe(this.rootNode,[KV()]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Xe(o,[VA(),ZV(t+1)]);for(let a=-1*s;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),Xd(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Xe(u,[j0(a+1+this.table.rowHeadersCount),qd(-1),U6(),...a>=0?[Y6()]:[VA()]]),r[t](l,u,t)}}}}let rL=!1;class G9 extends jg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,r=e+t;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!rL&&e>1e3&&(rL=!0,jt(zt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<t;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[i+t].style.width=`${o}px`}const r=this.rootNode.firstChild;r&&oe(r,"rowHeader")}}function j9(n,e,t){return(e=z9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function z9(n){var e=Y9(n,"string");return typeof e=="symbol"?e:e+""}function Y9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Rp={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let iL=!1;class K9 extends jg{constructor(e){super("TR",e),j9(this,"orderView",void 0),this.orderView=new FU(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!iL&&e>1e3&&(iL=!0,jt(zt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Xe(this.rootNode,[KV()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var t,r;Xe(s,[VA(),ZV(o+((t=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}rt(s,[Rp.rowEven,Rp.rowOdd]),(o+1)%2===0?oe(s,Rp.rowEven):oe(s,Rp.rowOdd)}this.orderView.end()}}function sL(n,e,t){return(e=q9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function q9(n){var e=X9(n,"string");return typeof e=="symbol"?e:e+""}function X9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Q9 extends jg{constructor(){super("TD"),sL(this,"orderViews",new WeakMap),sL(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new kU(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const h=this.obtainOrderView(u),c=i.obtainOrderView(u);h.prependView(c).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<t;d++){h.render();const f=h.getCurrentNode(),m=this.table.renderedColumnToSource(d);if(Ze(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),Xd(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,m,f),this.table.isAriaEnabled()){var s,o;Xe(f,[...f.hasAttribute("role")?[]:[k6()],qd(-1),j0(m+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}h.end()}}}function sr(n,e,t){return(e=Z9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Z9(n){var e=J9(n,"string");return typeof e=="symbol"?e:e+""}function J9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class e5{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};sr(this,"rootNode",void 0),sr(this,"rootDocument",void 0),sr(this,"rowHeaders",null),sr(this,"columnHeaders",null),sr(this,"colGroup",null),sr(this,"rows",null),sr(this,"cells",null),sr(this,"rowFilter",null),sr(this,"columnFilter",null),sr(this,"rowUtils",null),sr(this,"columnUtils",null),sr(this,"rowsToRender",0),sr(this,"columnsToRender",0),sr(this,"rowHeaderFunctions",[]),sr(this,"rowHeadersCount",0),sr(this,"columnHeaderFunctions",[]),sr(this,"columnHeadersCount",0),sr(this,"cellRenderer",void 0),sr(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:r,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),r.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=r,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let r=0;r<e;r++){const i=t.getRenderedNode(r);if(i.firstChild){const s=this.renderedRowToSource(r),o=this.rowUtils.getHeightByOverlayName(s,this.activeOverlayName);o?i.firstChild.style.height=`${o-1}px`:i.firstChild.style.height=""}}}}class t5{constructor(){let{TABLE:e,THEAD:t,COLGROUP:r,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new e5(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new W9,columnHeaders:new $9(t),colGroup:new G9(r),rows:new K9(i),cells:new Q9}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Sf(n,e,t){n5(n,e),e.set(n,t)}function n5(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ep(n,e,t){return(e=r5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function r5(n){var e=i5(n,"string");return typeof e=="symbol"?e:e+""}function i5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function kr(n,e){return n.get(VU(n,e))}function Rf(n,e,t){return n.set(VU(n,e),t),t}function VU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var bp=new WeakMap,gc=new WeakMap,Ef=new WeakMap,Tp=new WeakMap,Pu=new WeakMap;class s5{constructor(e){let{totalColumns:t,stretchMode:r,stretchingColumnWidthFn:i,columnWidthFn:s}=e;Ep(this,"stretchAllRatio",0),Ep(this,"stretchLastWidth",0),Ep(this,"stretchAllColumnsWidth",[]),Sf(this,bp,0),Ep(this,"needVerifyLastColumnWidth",!0),Sf(this,gc,()=>0),Sf(this,Ef,o=>o),Sf(this,Tp,o=>o),Sf(this,Pu,()=>"none"),Rf(gc,this,t),Rf(Pu,this,r),Rf(Ef,this,i??kr(Ef,this)),Rf(Tp,this,s??kr(Tp,this))}refreshStretching(e){if(kr(Pu,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,Rf(bp,this,e);let t=0;for(let i=0;i<kr(gc,this).call(this);i++){const s=this._getColumnWidth(i),o=kr(Ef,this).call(this,void 0,i);typeof o=="number"?e-=o:t+=s}const r=e-t;if(kr(Pu,this).call(this)==="all"&&r>0)this.stretchAllRatio=e/t,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(kr(Pu,this).call(this)==="last"&&e!==1/0){const i=this._getColumnWidth(kr(gc,this).call(this)-1),s=r+i;this.stretchLastWidth=s>=0?s:i}}getStretchedColumnWidth(e,t){let r=null;return kr(Pu,this).call(this)==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,t):kr(Pu,this).call(this)==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,t){let r=0;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(t*this.stretchAllRatio),s=kr(Ef,this).call(this,i,e);s===void 0?this.stretchAllColumnsWidth[e]=i:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===kr(gc,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)r+=this.stretchAllColumnsWidth[i];r!==kr(bp,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=kr(bp,this)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===kr(gc,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=kr(Tp,this).call(this,e);return isNaN(t)&&(t=kC),t}}function Ap(n,e,t){return(e=o5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o5(n){var e=a5(n,"string");return typeof e=="symbol"?e:e+""}function a5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class l5{constructor(e,t){Ap(this,"dataAccessObject",void 0),Ap(this,"wtSettings",void 0),Ap(this,"headerWidths",new Map),Ap(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=t,this.stretching=new s5({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(r,i)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",r,i),columnWidthFn:r=>this.dataAccessObject.wtTable.getColumnWidth(r)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let t=this.getWidth(e);const r=this.stretching.getStretchedColumnWidth(e,t);return r&&(t=r),t}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(t=t?Math.max(t,r):r),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:t,cloneSource:r}=this.dataAccessObject,i=r?r.wtTable.holder:e.holder,s=i.offsetHeight<i.scrollHeight?Rr():0;this.stretching.refreshStretching(t.getViewportWidth()-s)}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),t=e.getSetting("onModifyRowHeaderWidth",t),t!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<r;s++){let o=Array.isArray(t)?t[s]:t;o=o??i,this.headerWidths.set(s,o)}}}}function oL(n,e,t){return(e=u5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function u5(n){var e=h5(n,"string");return typeof e=="symbol"?e:e+""}function h5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class c5{constructor(e,t){oL(this,"dataAccessObject",void 0),oL(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(t=t===void 0?r:Math.max(t,r)),t}getHeightByOverlayName(e,t){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function Io(n,e,t){return(e=d5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function d5(n){var e=f5(n,"string");return typeof e=="symbol"?e:e+""}function f5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Zd{constructor(e,t,r,i,s){Io(this,"wtSettings",null),Io(this,"domBindings",void 0),Io(this,"TBODY",null),Io(this,"THEAD",null),Io(this,"COLGROUP",null),Io(this,"hasTableHeight",!0),Io(this,"hasTableWidth",!0),Io(this,"isTableVisible",!1),Io(this,"tableOffset",0),Io(this,"holderOffset",0),this.domBindings=r,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,nU(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new c5(this.dataAccessObject,this.wtSettings),this.columnUtils=new l5(this.dataAccessObject,this.wtSettings),this.tableRenderer=new t5({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Ze(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",t&&t.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Xe(r,[oa()]),r}createHider(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Ze(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",t&&t.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Xe(r,[oa()]),r}createHolder(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Ze(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",t&&t.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Xe(r.parentNode,[oa()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Xe(r,[oa()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,s=t.getSetting("totalRows"),o=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),l=a.length,u=t.getSetting("columnHeaders"),h=u.length;let c=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Sr(this.holder),c=i.createCalculators(c),l&&!t.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(c=!1)}if(c)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Sr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=s>0?this.getFirstRenderedRow():0,m=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new T9(f,s,h),this.columnFilter=new R9(m,o,l);let p=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const v={};this.wtSettings.getSetting("beforeDraw",!0,v),p=v.skipRender!==!0}if(p){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(ra)||this.is(ou))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let v;if(this.isMaster&&(v=this.dataAccessObject.workspaceWidth,i.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ra))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM();const y=cn(this.hider),C=cn(this.TABLE);y!==0&&C!==y&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),v!==i.getWorkspaceWidth()&&(i.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(ra)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(c),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,s=this.getColumnHeaderHeight(r),o=this.getColumnHeader(t,r),o&&(a=hd(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(r[s]){if(!t[s]||t[s].childNodes.length===0)return;t[s].childNodes[0].style.height=`${r[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(ra))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const s=this.rowFilter.renderedToSource(i);t.oversizedRows&&t.oversizedRows[s]&&(t.oversizedRows[s]=void 0)}}}getCell(e){let t=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",t,r);if(i&&Array.isArray(i)&&([t,r]=i),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const s=this.getRow(t);if(!s&&t>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!o&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let t=null,r=null;if(e<0){var i;t=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var s;t=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),r=this.TBODY}return t!==void 0&&r!==void 0?r.childNodes.length<t+1?!1:r.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[t];return r?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[r];s&&t.push(s)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(t>=r)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[s];return a?.childNodes[t]}getRowHeaders(e){const t=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s?.childNodes[i];o&&t.push(o)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=kh(t,["TD","TH"])),t===null)return null;const r=t.parentNode,i=r.parentNode;let s=u4(r),o=t.cellIndex;return Ou(Gh,t,this.wtRootElement)||Ou(Wh,t,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):Ou(ou,t,this.wtRootElement)||Ou(ra,t,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s),Ou(Gh,t,this.wtRootElement)||Ou($h,t,this.wtRootElement)||Ou(ou,t,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),r=hd(this.TBODY)-1;let i,s,o,a,l;if(!(t===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,o=this.rowFilter.renderedToSource(e),i=this.getRowHeight(o),a=this.getTrForRow(o),l=a.querySelector("th"),l?s=hd(l):s=hd(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<s||i<s)&&(s+=1,this.dataAccessObject.wtViewport.oversizedRows[o]=s)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return cn(this.TABLE)}getHeight(){return Xn(this.TABLE)}getTotalWidth(){const e=cn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Xn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Ld(this.TABLE)}_modifyRowHeaderWidth(e){let t=un(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const m5="stickyRowsBottom",oI={getFirstRenderedRow(){const n=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=n-e;return n===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};pl(oI,"MIXIN_NAME",m5,{writable:!1,enumerable:!1});const g5="stickyColumnsStart",VC={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const n=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),n)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};pl(VC,"MIXIN_NAME",g5,{writable:!1,enumerable:!1});class aI extends Zd{constructor(e,t,r,i){super(e,t,r,i,ou)}}Zt(aI,oI);Zt(aI,VC);const Wh="top",ra="bottom",$h="inline_start",Gh="top_inline_start_corner",ou="bottom_inline_start_corner",UU=[Wh,ra,$h,Gh,ou],p5=new Map([[Wh,`ht_clone_${Wh}`],[ra,`ht_clone_${ra}`],[$h,`ht_clone_${$h} ht_clone_left`],[Gh,`ht_clone_${Gh} ht_clone_top_left_corner`],[ou,`ht_clone_${ou} ht_clone_bottom_left_corner`]]);function w5(n,e){v5(n,e),e.add(n)}function v5(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y5(n,e,t){return(e=C5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function C5(n){var e=S5(n,"string");return typeof e=="symbol"?e:e+""}function S5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Np(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var bf=new WeakSet;class R5{constructor(e){w5(this,bf),y5(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,r,i,s){const o=this.scrollViewportHorizontally(e.col,r,s),a=this.scrollViewportVertically(e.row,t,i);return o||a}scrollViewportHorizontally(e,t,r){const{drawn:i,totalColumns:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=t===void 0&&r===void 0,{fixedColumnsStart:a,inlineStartOverlay:l}=this.dataAccessObject;if(o&&e<a||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>s))return!1;const u=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn();let c=!1;return(o&&(e<u||e>h)||!o)&&(c=l.scrollTo(e,o?e>=this.getLastPartiallyVisibleColumn():t)),c}scrollViewportVertically(e,t,r){const{drawn:i,totalRows:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=t===void 0&&r===void 0,{fixedRowsBottom:a,fixedRowsTop:l,topOverlay:u}=this.dataAccessObject;if(o&&(e<l||e>s-a-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>s))return!1;const h=this.getFirstVisibleRow(),c=this.getLastVisibleRow();let d=!1;return(o&&(e<h||e>c)||!o)&&(d=u.scrollTo(e,o?e>=this.getLastPartiallyVisibleRow():r)),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Np(bf,this,lL).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Np(bf,this,lL).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Np(bf,this,aL).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Np(bf,this,aL).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function aL(n){const{wtSettings:e,inlineStartOverlay:t,wtTable:r,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(t.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const h=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(h.right-d)}else l=Sr(r.wtRootElement).left;const u=Math.abs(iU(o,o));if(l>u){const h=sU(o);let c=i.getRowHeaderWidth();for(let d=1;d<=s;d++)if(c+=t.sumCellSizes(d-1,d),l+c-u>=h){n=d-2;break}}}return n}function lL(n){const{topOverlay:e,wtTable:t,wtViewport:r,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=Sr(t.wtRootElement),a=K0(s,s);if(o.top>a){const l=hd(s);let u=r.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(u+=e.sumCellSizes(h-1,h),o.top+u-a>=l){n=h-2;break}}}return n}function Us(n,e,t){return(e=E5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function E5(n){var e=b5(n,"string");return typeof e=="symbol"?e:e+""}function b5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class lI{get eventManager(){return new wo(this)}constructor(e,t){Us(this,"wtTable",void 0),Us(this,"wtScroll",void 0),Us(this,"wtViewport",void 0),Us(this,"wtOverlays",void 0),Us(this,"selectionManager",void 0),Us(this,"wtEvent",void 0),Us(this,"guid",`wt_${jV()}`),Us(this,"drawInterrupted",!1),Us(this,"drawn",!1),Us(this,"domBindings",void 0),Us(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new R5(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;t<r;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,r){Vh(r,e[t])}])}}createCellCoords(e,t){return new Bh(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,r){return new Gg(e,t,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=r-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,r,i,s){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,r,i,s)}scrollViewportHorizontally(e,t,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function uL(n,e,t){return(e=T5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function T5(n){var e=A5(n,"string");return typeof e=="symbol"?e:e+""}function A5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class N5 extends lI{constructor(e,t,r){super(e,t),uL(this,"cloneSource",void 0),uL(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new HU(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function I5(n,e,t){return(e=M5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function M5(n){var e=O5(n,"string");return typeof e=="symbol"?e:e+""}function O5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class zg{constructor(e,t,r,i,s){I5(this,"wtSettings",null),pl(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=t,this.wtSettings=i;const{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=h,this.trimmingContainer=Dd(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Dd(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Zv(e.TABLE)}getRelativeCellPosition(e,t,r){if(this.clone.wtTable.holder.contains(e)===!1){jt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=r<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(e),top:e.offsetTop};let c=null;return i?c=this.getRelativeCellPositionWithinWindow(o,s,h,u):c=this.getRelativeCellPositionWithinHolder(o,a,s,h,u),c}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,r,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!t)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+Rr())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:r.start+o,top:r.top+a}}getRelativeCellPositionWithinHolder(e,t,r,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=o.horizontal-s.start),t){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(UU.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=r.createElement("div"),o=r.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${p5.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,t.getSetting("ariaTags")&&Xe(s,[oa()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Wh||u==="vertical"&&this.type===$h?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Zv(e.TABLE),new N5(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,r=e.style,i=t.style,s=e.parentNode.style;[r,i,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class _5 extends zg{constructor(e,t,r,i,s,o){super(e,t,ou,r,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new aI(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${s}px`,t.style.bottom=`${o}px`}else DC(t),this.repositionOverlay();let r=Xn(this.clone.wtTable.TABLE);const i=cn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),t.style.height=`${r}px`,t.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;t.hasVerticalScroll()||(s+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(s+=Rr(r)),i.style.bottom=`${s}px`}}const x5="calculatedColumns",UC={getFirstRenderedColumn(){const n=this.dataAccessObject.startColumnRendered;return n===null?-1:n},getFirstVisibleColumn(){const n=this.dataAccessObject.startColumnVisible;return n===null?-1:n},getFirstPartiallyVisibleColumn(){const n=this.dataAccessObject.startColumnPartiallyVisible;return n===null?-1:n},getLastRenderedColumn(){const n=this.dataAccessObject.endColumnRendered;return n===null?-1:n},getLastVisibleColumn(){const n=this.dataAccessObject.endColumnVisible;return n===null?-1:n},getLastPartiallyVisibleColumn(){const n=this.dataAccessObject.endColumnPartiallyVisible;return n===null?-1:n},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};pl(UC,"MIXIN_NAME",x5,{writable:!1,enumerable:!1});class uI extends Zd{constructor(e,t,r,i){super(e,t,r,i,ra)}}Zt(uI,oI);Zt(uI,UC);function P5(n,e,t){return(e=L5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function L5(n){var e=D5(n,"string");return typeof e=="symbol"?e:e+""}function D5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class H5 extends zg{constructor(e,t,r,i){super(e,t,ra,r,i),P5(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new uI(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),t.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;t.hasVerticalScroll()||(s+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(s+=Rr(r)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.mainTableScrollableElement===t?(t.scrollTo(Y0(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:r,wtSettings:i}=this.wot,s=i.getSetting("defaultRowHeight");let o=e,a=0;for(;o<t;){const l=r.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=Rr(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let h=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,e.wtRootElement.scrollWidth),a.width=`${h}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Xn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let r=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;t&&s.offsetHeight!==s.clientHeight&&(o=Rr(this.domBindings.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=o,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return K0(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==t,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((r||t===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=Ze(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(oe(o,"innerBorderBottom"),s=!a):(rt(o,"innerBorderBottom"),s=a)}return s}}const F5="calculatedRows",hI={getFirstRenderedRow(){const n=this.dataAccessObject.startRowRendered;return n===null?-1:n},getFirstVisibleRow(){const n=this.dataAccessObject.startRowVisible;return n===null?-1:n},getFirstPartiallyVisibleRow(){const n=this.dataAccessObject.startRowPartiallyVisible;return n===null?-1:n},getLastRenderedRow(){const n=this.dataAccessObject.endRowRendered;return n===null?-1:n},getLastVisibleRow(){const n=this.dataAccessObject.endRowVisible;return n===null?-1:n},getLastPartiallyVisibleRow(){const n=this.dataAccessObject.endRowPartiallyVisible;return n===null?-1:n},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};pl(hI,"MIXIN_NAME",F5,{writable:!1,enumerable:!1});class cI extends Zd{constructor(e,t,r,i){super(e,t,r,i,$h)}}Zt(cI,hI);Zt(cI,VC);const k5="localHooks",Hr={_localHooks:Object.create(null),addLocalHook(n,e){return this._localHooks[n]||(this._localHooks[n]=[]),this._localHooks[n].push(e),this},runLocalHooks(n,e,t,r,i,s,o){if(this._localHooks[n]){const a=this._localHooks[n].length;for(let l=0;l<a;l++)UA(this._localHooks[n][l],this,e,t,r,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};pl(Hr,"MIXIN_NAME",k5,{writable:!1,enumerable:!1});let BU=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};Zt(BU,Hr);const WU="active-header",dI="header",fI="area",mI="focus",V5="fill",U5="row",B5="column",W5="custom-selection",gI=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var hL={},cL;function $5(){if(cL)return hL;cL=1;var n=tI();return n("flat"),hL}$5();function G5(n,e){$U(n,e),e.add(n)}function dL(n,e,t){$U(n,e),e.set(n,t)}function $U(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $n(n,e){return n.get(Em(n,e))}function fL(n,e,t){return n.set(Em(n,e),t),t}function Em(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Bs=new WeakMap,Ci=new WeakMap,Ip=new WeakSet;class j5{constructor(){G5(this,Ip),dL(this,Bs,void 0),dL(this,Ci,void 0)}setActiveOverlay(e){return fL(Ci,this,e),this}setActiveSelection(e){return fL(Bs,this,e),this}scan(){const e=$n(Bs,this).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r))):e==="area"?this.scanCellsRange(r=>t.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r)),this.scanCellsRange(r=>t.add(r))):e==="fill"?this.scanCellsRange(r=>t.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>t.add(r)),this.scanRowsInCellsRange(r=>t.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanColumnsInCellsRange(r=>t.add(r))),t}scanColumnsInHeadersRange(e){const[t,r,i,s]=$n(Bs,this).getCorners(),{wtTable:o}=$n(Ci,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let u=0;for(let h=-o.getRowHeadersCount();h<a;h++){const c=o.columnFilter.renderedToSource(h);if(!(c<r||c>s)){for(let d=-l;d<0;d++){if(d<t||d>i)continue;const f=d+l;let m=o.getColumnHeader(c,f);const p=$n(Ci,this).getSetting("onBeforeHighlightingColumnHeader",c,f,{selectionType:$n(Bs,this).settings.selectionType,columnCursor:u,selectionWidth:s-r+1});p!==null&&(p!==c&&(m=o.getColumnHeader(p,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[t,r,i,s]=$n(Bs,this).getCorners(),{wtTable:o}=$n(Ci,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let u=0;for(let h=-o.getColumnHeadersCount();h<a;h++){const c=o.rowFilter.renderedToSource(h);if(!(c<t||c>i)){for(let d=-l;d<0;d++){if(d<r||d>s)continue;const f=d+l;let m=o.getRowHeader(c,f);const p=$n(Ci,this).getSetting("onBeforeHighlightingRowHeader",c,f,{selectionType:$n(Bs,this).settings.selectionType,rowCursor:u,selectionHeight:i-t+1});p!==null&&(p!==c&&(m=o.getRowHeader(p,f)),e(m))}u+=1}}}scanCellsRange(e){const[t,r,i,s]=$n(Bs,this).getCorners(),{wtTable:o}=$n(Ci,this);Em(Ip,this,yb).call(this,(a,l)=>{if(a>=t&&a<=i&&l>=r&&l<=s){const u=o.getCell($n(Ci,this).createCellCoords(a,l)),h=$n(Ci,this).getSetting("onAfterDrawSelection",a,l,$n(Bs,this).settings.layerLevel);typeof h=="string"&&oe(u,h),e(u)}})}scanRowsInCellsRange(e){const[t,,r]=$n(Bs,this).getCorners(),{wtTable:i}=$n(Ci,this);Em(Ip,this,yb).call(this,(s,o)=>{if(s>=t&&s<=r){const a=i.getCell($n(Ci,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,t,,r]=$n(Bs,this).getCorners(),{wtTable:i}=$n(Ci,this);Em(Ip,this,yb).call(this,(s,o)=>{if(o>=t&&o<=r){const a=i.getCell($n(Ci,this).createCellCoords(s,o));e(a)}})}}function yb(n){const{wtTable:e}=$n(Ci,this),t=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<t;i+=1){const s=e.rowFilter.renderedToSource(i);for(let o=0;o<r;o+=1)n(s,e.columnFilter.renderedToSource(o))}}class mL{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=gI,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,r=this.main.childNodes.length;t<r;t++){const i=this.main.childNodes[t];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ro(e);const r=this,i=this.wot.rootDocument.body,s=t.getBoundingClientRect();t.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),t.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=t.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Zl()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=t.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};gt(i,(o,a)=>{this.selectionHandles.styles.bottomHitArea[a]=o,this.selectionHandles.styles.topHitArea[a]=o});const s={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};gt(s,(o,a)=>{this.selectionHandles.styles.bottom[a]=o,this.selectionHandles.styles.top[a]=o}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||t!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,r,i,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:h,bottom:c,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),p=parseInt(h.width,10),v=this.wot.wtTable.getWidth(),y=this.wot.wtTable.getHeight();u.top=`${parseInt(r-m-1,10)}px`,u[l]=`${parseInt(i-m-1,10)}px`,h.top=`${parseInt(r-p/4*3,10)}px`,h[l]=`${parseInt(i-p/4*3,10)}px`;const C=Math.min(parseInt(i+s,10),v-m-f*2),R=Math.min(parseInt(i+s-p/4,10),v-p-f*2);c[l]=`${C}px`,d[l]=`${R}px`;const A=Math.min(parseInt(r+o,10),y-m-f*2),I=Math.min(parseInt(r+o-p/4,10),y-p-f*2);c.top=`${A}px`,d.top=`${I}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",h.display="block",this.isPartRange(e,t)?(c.display="none",d.display="none"):(c.display="block",d.display="block")):(u.display="none",c.display="none",h.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",h.zIndex="9999"):(u.zIndex="",h.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:r,rootWindow:i}=this.wot;let s,o,a,l,u,h;const c=t.getRenderedRowsCount();for(let Se=0;Se<c;Se+=1){const ve=t.rowFilter.renderedToSource(Se);if(ve>=e[0]&&ve<=e[2]){s=ve,u=e[0];break}}for(let Se=c-1;Se>=0;Se-=1){const ve=t.rowFilter.renderedToSource(Se);if(ve>=e[0]&&ve<=e[2]){o=ve;break}}const d=t.getRenderedColumnsCount();for(let Se=0;Se<d;Se+=1){const ve=t.columnFilter.renderedToSource(Se);if(ve>=e[1]&&ve<=e[3]){a=ve,h=e[1];break}}for(let Se=d-1;Se>=0;Se-=1){const ve=t.columnFilter.renderedToSource(Se);if(ve>=e[1]&&ve<=e[3]){l=ve;break}}if(s===void 0||a===void 0){this.disappear();return}let f=t.getCell(this.wot.createCellCoords(s,a));const m=s!==o||a!==l,p=m?t.getCell(this.wot.createCellCoords(o,l)):f,v=Sr(f),y=m?Sr(p):v,C=Sr(t.TABLE),R=cn(t.TABLE),A=v.top,I=v.left,H=this.wot.wtSettings.getSetting("rtlMode");let k=0,W=0;if(H){const Se=cn(f),ve=i.innerWidth-C.left-R;W=I+Se-y.left,k=i.innerWidth-I-Se-ve-1}else W=y.left+cn(p)-I,k=I-C.left-1;if(this.isEntireColumnSelected(s,o)){const Se=this.getDimensionsFromHeader("columns",a,l,u,C);let ve=null;Se&&([ve,k,W]=Se),ve&&(f=ve)}let z=A-C.top-1,G=y.top+Xn(p)-A;if(this.isEntireRowSelected(a,l)){const Se=this.getDimensionsFromHeader("rows",s,o,h,C);let ve=null;Se&&([ve,z,G]=Se),ve&&(f=ve)}const q=ul(f,i);parseInt(q.borderTopWidth,10)>0&&(z+=1,G=G>0?G-1:0),parseInt(q[H?"borderRightWidth":"borderLeftWidth"],10)>0&&(k+=1,W=W>0?W-1:0);const J=H?"right":"left";this.topStyle.top=`${z}px`,this.topStyle[J]=`${k}px`,this.topStyle.width=`${W}px`,this.topStyle.display="block",this.startStyle.top=`${z}px`,this.startStyle[J]=`${k}px`,this.startStyle.height=`${G}px`,this.startStyle.display="block";const re=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${z+G-re}px`,this.bottomStyle[J]=`${k}px`,this.bottomStyle.width=`${W}px`,this.bottomStyle.display="block",this.endStyle.top=`${z}px`,this.endStyle[J]=`${k+W-re}px`,this.endStyle.height=`${G+1}px`,this.endStyle.display="block";let ie=this.settings.border.cornerVisible;ie=typeof ie=="function"?ie(this.settings.layerLevel):ie;const ae=this.wot.getSetting("onModifyGetCellCoords",o,l);let[Ke,xe]=[o,l];if(ae&&Array.isArray(ae)&&([,,Ke,xe]=ae),Zl()||!ie||this.isPartRange(Ke,xe))this.cornerStyle.display="none";else{this.cornerStyle.top=`${z+G+this.cornerCenterPointOffset-1}px`,this.cornerStyle[J]=`${k+W+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Se=Dd(t.TABLE);const ve=Se===i;ve&&(Se=r.documentElement);const He=parseInt(this.cornerDefaultStyle.width,10)/2,w=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const S=ve?p.getBoundingClientRect().left:p.offsetLeft;let b=!1,x=0;H?(x=S-parseInt(this.cornerDefaultStyle.width,10)/2,b=x<0):(x=S+cn(p)+parseInt(this.cornerDefaultStyle.width,10)/2,b=x>=sU(Se)),b&&(this.cornerStyle[J]=`${Math.floor(k+W+this.cornerCenterPointOffset-He)}px`,this.cornerStyle[H?"borderLeftWidth":"borderRightWidth"]=0)}o===this.wot.getSetting("totalRows")-1&&(ve?p.getBoundingClientRect().top:p.offsetTop)+Xn(p)+parseInt(this.cornerDefaultStyle.height,10)/2>=hd(Se)&&(this.cornerStyle.top=`${Math.floor(z+G+this.cornerCenterPointOffset-w)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Zl()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(o,l,z,k,W,G)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,r,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,u=null,h=null,c=null,d=null,f=null,m=null,p=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return Xn(...arguments)},h="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return cn(...arguments)},h="ht__selection--columns",f="left";break}if(a.classList.contains(h)){const v=this.wot.getSetting("columnHeaders").length;if(m=l(t,v-i),p=l(r,v-i),!m||!p)return!1;const y=Sr(m),C=Sr(p);return m&&p&&(c=y[f]-s[f]-1,d=C[f]+u(p)-y[f]),[m,c,d]}return!1}changeBorderStyle(e,t){const r=this[e].style,i=t[e];!i||i.hide?oe(this[e],"hidden"):(Ze(this[e],"hidden")&&rt(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},r=this[e].style;r.backgroundColor=t.color,r.width=`${t.width}px`,r.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?oe(this[e],"hidden"):rt(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Zl()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function z5(n,e){GU(n,e),e.add(n)}function pc(n,e,t){GU(n,e),e.set(n,t)}function GU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yt(n,e){return n.get(pI(n,e))}function gL(n,e,t){return n.set(pI(n,e),t),t}function pI(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Wr=new WeakMap,Ei=new WeakMap,Cb=new WeakMap,cm=new WeakMap,Sb=new WeakMap,Lu=new WeakMap,pL=new WeakSet;class Y5{constructor(e){z5(this,pL),pc(this,Wr,void 0),pc(this,Ei,void 0),pc(this,Cb,new j5),pc(this,cm,new WeakMap),pc(this,Sb,new WeakSet),pc(this,Lu,new Map),gL(Ei,this,e)}setActiveOverlay(e){return gL(Wr,this,e),yt(Cb,this).setActiveOverlay(yt(Wr,this)),yt(cm,this).has(yt(Wr,this))||yt(cm,this).set(yt(Wr,this),new Set),this}getFocusSelection(){return yt(Ei,this)!==null?yt(Ei,this).getFocus():null}getAreaSelection(){return yt(Ei,this)!==null?yt(Ei,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(yt(Lu,this).has(e)){const r=yt(Lu,this).get(e);if(r.has(yt(Wr,this)))return r.get(yt(Wr,this));const i=new mL(yt(Wr,this),e.settings);return r.set(yt(Wr,this),i),i}const t=new mL(yt(Wr,this),e.settings);return yt(Lu,this).set(e,new Map([[yt(Wr,this),t]])),t}getBorderInstances(e){var t,r;return Array.from((t=(r=yt(Lu,this).get(e))===null||r===void 0?void 0:r.values())!==null&&t!==void 0?t:[])}destroyBorders(e){yt(Lu,this).get(e).forEach(t=>t.destroy()),yt(Lu,this).delete(e)}render(e){if(yt(Ei,this)===null)return;e&&pI(pL,this,K5).call(this);const t=Array.from(yt(Ei,this)),r=new Map,i=new Map;for(let s=0;s<t.length;s++){const o=t[s],{className:a,headerAttributes:l,createLayers:u,selectionType:h}=o.settings;yt(Sb,this).has(o)||(yt(Sb,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const c=this.getBorderInstance(o);if(o.isEmpty()){c?.disappear();continue}a&&yt(Cb,this).setActiveSelection(o).scan().forEach(m=>{if(r.has(m)){const p=r.get(m);p.has(a)&&u===!0?p.set(a,p.get(a)+1):p.set(a,1)}else r.set(m,new Map([[a,1]]));l&&(i.has(m)||i.set(m,[]),m.nodeName==="TH"&&i.get(m).push(...l))});const d=o.getCorners();yt(Wr,this).getSetting("onBeforeDrawBorders",d,h),c?.appear(d)}r.forEach((s,o)=>{var a;const l=Array.from(s).map(u=>{let[h,c]=u;return c===1?h:[h,...Array.from({length:c-1},(d,f)=>`${h}-${f+1}`)]}).flat();l.forEach(u=>yt(cm,this).get(yt(Wr,this)).add(u)),oe(o,l),o.nodeName==="TD"&&Array.isArray((a=yt(Ei,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Xe(o,yt(Ei,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{Xe(s,[...i.get(s)])})}}function K5(){const n=yt(cm,this).get(yt(Wr,this)),e=yt(Wr,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let t=0;t<e.length;t++)n.add(e[t]);n.forEach(t=>{var r,i;const s=yt(Wr,this).wtTable.TABLE.querySelectorAll(`.${t}`);let o=[];Array.isArray((r=yt(Ei,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(o=yt(Ei,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=yt(Ei,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(o=[...o,...yt(Ei,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)rt(s[a],t),Xd(s[a],o)}),n.clear()}class q5 extends zg{constructor(e,t,r,i){super(e,t,$h,r,i)}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new cI(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===t&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),q0(r,`${s}px`,"0px")):(s=this.getScrollPosition(),DC(r));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,rU(t)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<t;)s+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,i=Rr(t),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=cn(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(gI.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&i.length>0&&!Ze(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),h=0;if(t){const c=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();c>d&&(t=!1)}return t&&a.offsetWidth!==a.clientWidth&&(h=Rr(this.domBindings.rootDocument)),t?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=h,d4(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(iU(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,r=this.wot.wtTable.holder.parentNode,i=t.getSetting("rowHeaders"),s=t.getSetting("fixedColumnsStart"),o=t.getSetting("totalRows"),a=t.getSetting("preventOverflow")==="vertical";o?rt(r,"emptyRows"):oe(r,"emptyRows");let l=!1;if(!a){if(s&&!i.length)oe(r,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const u=Ze(r,"innerBorderInlineStart");e?(oe(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(rt(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const X5="stickyRowsTop",wI={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};pl(wI,"MIXIN_NAME",X5,{writable:!1,enumerable:!1});class vI extends Zd{constructor(e,t,r,i){super(e,t,r,i,Gh)}}Zt(vI,wI);Zt(vI,VC);function wL(n,e,t){return(e=Q5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Q5(n){var e=Z5(n,"string");return typeof e=="symbol"?e:e+""}function Z5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class J5 extends zg{constructor(e,t,r,i,s,o){super(e,t,Gh,r,i),wL(this,"topOverlay",void 0),wL(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new vI(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();q0(e,`${i}px`,`${s}px`)}else DC(e);let t=Xn(this.clone.wtTable.TABLE);const r=cn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${r}px`,!1}}class yI extends Zd{constructor(e,t,r,i){super(e,t,r,i,Wh)}}Zt(yI,wI);Zt(yI,UC);function e8(n,e,t){return(e=t8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function t8(n){var e=n8(n,"string");return typeof e=="symbol"?e:e+""}function n8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class r8 extends zg{constructor(e,t,r,i){super(e,t,Wh,r,i),e8(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new yI(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===t&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),h=e.offsetHeight;s=u===h,i=this.getOverlayOffset(),q0(e,"0px",`${i}px`)}else i=this.getScrollPosition(),DC(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const t=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(Y0(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,s=0;for(;i<t;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?r:o,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,i=Rr(t),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=Xn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(gI.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:r,wtSettings:i}=this,o=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!Ze(o.parentNode,"innerBorderTop")?1:0;let h=this.getTableParentOffset(),c=0;if(t){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(t=!1)}if(t&&o.offsetHeight!==o.clientHeight&&(c=Rr(this.domBindings.rootDocument)),t){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");h+=this.sumCellSizes(0,e+1),h-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),h+=1,h+=u}else h+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return h+=c,c4(this.mainTableScrollableElement)===h-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(h)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return K0(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,s=r.getSetting("totalColumns"),o=r.getSetting("preventOverflow")==="horizontal";s?rt(i,"emptyColumns"):oe(i,"emptyColumns");let a=!1;if(!t&&!o){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,h=r.getSetting("columnHeaders");if((u||l===0)&&h.length>0){const c=Ze(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(oe(i,"innerBorderTop"),a=!c):(rt(i,"innerBorderTop"),a=c)}}return a}}function Mp(n,e,t){i8(n,e),e.set(n,t)}function i8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Na(n,e,t){return(e=s8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function s8(n){var e=o8(n,"string");return typeof e=="symbol"?e:e+""}function o8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Du(n,e,t){return n.set(jU(n,e),t),t}function Ia(n,e){return n.get(jU(n,e))}function jU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var wc=new WeakMap,Op=new WeakMap,vc=new WeakMap,_p=new WeakMap;class a8{constructor(e,t,r,i,s,o){Na(this,"wot",null),Mp(this,wc,[]),Na(this,"topOverlay",null),Na(this,"bottomOverlay",null),Na(this,"inlineStartOverlay",null),Na(this,"topInlineStartCornerOverlay",null),Na(this,"bottomInlineStartCornerOverlay",null),Na(this,"browserLineHeight",void 0),Na(this,"wtSettings",null),Mp(this,Op,!1),Mp(this,vc,0),Mp(this,_p,null),Na(this,"resizeObserver",new ResizeObserver(h=>{J0(()=>{!Array.isArray(h)||!h.length||(Du(vc,this,Ia(vc,this)+1),Ia(vc,this)===100&&(jt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Ia(_p,this)!==null&&clearTimeout(Ia(_p,this)),Du(_p,this,setTimeout(()=>{Du(vc,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=t,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=Rr(a);const u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:Zv(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[...Ia(wc,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,r=e.getComputedStyle(t.body),i=parseInt(r.lineHeight,10),s=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new r8(...e),this.bottomOverlay=new H5(...e),this.inlineStartOverlay=new q5(...e),this.topInlineStartCornerOverlay=new J5(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new _5(...e,this.bottomOverlay,this.inlineStartOverlay),Du(wc,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Du(Op,this,Ia(wc,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),Ia(wc,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Ia(wc,this).forEach(e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",c=>this.onKeyDown(c)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",c=>this.onTableScroll(c),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",c=>this.onTableScroll(c),{passive:!0});const s=t.devicePixelRatio&&t.devicePixelRatio>1,o=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!fU())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",c=>this.onCloneWheel(c,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(c=>{if(c&&c.needFullRender){const{holder:d}=c.clone.wtTable;this.eventManager.addEventListener(d,"wheel",f=>this.onCloneWheel(f,a),l)}});let h;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(h),h=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),Du(vc,this,0)},200)}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==t&&s!==t&&!e.target.contains(i)||r!==t&&s!==t&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==r&&o!==r&&!o.contains(s),l=i!==r&&o!==r&&!o.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=$g(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,t+=t*this.browserLineHeight);const i=this.scrollVertically(t),s=this.scrollHorizontally(r);return i||s}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){if(!Ia(Op,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),Du(Op,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Zv(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,r=e.clientHeight,i=t!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,h=a+this.inlineStartOverlay.sumCellSizes(0,s),d=t.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-t.holder.clientHeight),m=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,h-t.holder.clientWidth),p=f()?1:0,v=m()?1:0;if(d.width=`${h+v}px`,d.height=`${u+p}px`,this.scrollbarSize>0){const{scrollHeight:y,scrollWidth:C}=t.wtRootElement,{scrollHeight:R,scrollWidth:A}=t.holder;this.hasScrollbarRight=y<R,this.hasScrollbarBottom=C<A,this.hasScrollbarRight&&t.hider.scrollWidth+this.scrollbarSize>C?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&t.hider.scrollHeight+this.scrollbarSize>y&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return D(t,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];D(t,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function vL(n,e,t){return(e=l8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function l8(n){var e=u8(n,"string");return typeof e=="symbol"?e:e+""}function u8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class h8{constructor(e){vL(this,"settings",{}),vL(this,"defaults",Object.freeze(this.getDefaults())),gt(this.defaults,(t,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(t===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,r)=>{const i=this.getSetting("data",e,t);Vh(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return t===void 0?gt(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=t,this}getSetting(e,t,r,i,s){return typeof this.settings[e]=="function"?this.settings[e](t,r,i,s):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class CI extends Zd{constructor(e,t,r,i){super(e,t,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Dd(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=rg(e,"height",t),s=rg(e,"overflow",t),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,h=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(s)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(ul(d,t).height,10);r.removeChild(d),f===0&&(h=0)}h=Math.min(h,l),o.height=i==="auto"?"auto":`${h}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:h>0,this.hasTableWidth=u>0}this.isTableVisible=Ld(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,r="master",s=e.getSetting("columnHeaders").length;if(s&&!t.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let h=-1*a;h<l;h++)this.markIfOversizedColumnHeader(h);t.hasOversizedColumnHeadersMarked[r]=!0}}}Zt(CI,hI);Zt(CI,UC);class c8{constructor(e,t,r,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=r,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new JX:new t9],["fullyVisible",()=>new $X],["partiallyVisible",()=>new OU]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new XX:new e9],["fullyVisible",()=>new UX],["partiallyVisible",()=>new MU]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return t===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Xn(t)>0&&t.clientHeight>0?t.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=t.documentElement.offsetWidth,o=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),h=l?u.right-s:u.left,c=s-h;let d,f;if(a)return cn(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(c,s):d=Math.min(this.getContainerFillWidth(),c,s),i===r&&o>0&&this.sumColumnWidths(0,o-1)>d)return t.documentElement.clientWidth;if(i!==r&&(f=rg(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),f==="scroll"||f==="hidden"||f==="auto"))return Math.max(d,i.clientWidth);const m=e.getSetting("stretchH");return m==="none"||!m?Math.max(d,cn(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let r=0,i=e;for(;i<t;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const r=t.offsetWidth;return this.containerWidth=r,e.removeChild(t),r}getWorkspaceOffset(){return Sr(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Xn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=t.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=t.length;i<s;i++)r?(this.rowHeaderWidth+=cn(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let i=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=t.getSetting("fixedRowsTop"),u=t.getSetting("fixedRowsBottom"),h=t.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(h-u,h),i-=o),r.holder.clientHeight===r.holder.offsetHeight?s=0:s=Rr(this.domBindings.rootDocument),new u9({calculationTypes:e.map(c=>[c,this.rowsCalculatorTypes.get(c)()]),viewportHeight:i,scrollOffset:a,totalRows:t.getSetting("totalRows"),rowHeightFn:c=>r.getRowHeight(c),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=t.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Rr(this.domBindings.rootDocument)),new o9({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:s,totalColumns:t.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const s=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!t.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:r}=e;if(t===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:s}=this.rowsRenderCalculator;return t<i||t===i&&t>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:r}=e;if(t===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:s}=this.columnsRenderCalculator;return t<i||t===i&&t>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){gt(this.hasOversizedColumnHeadersMarked,(e,t,r)=>{r[t]=void 0})}}class d8 extends lI{constructor(e,t){super(e,new h8(t));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new CI(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new c8(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Y5(this.wtSettings.getSetting("selections")),this.wtEvent=new HU(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new a8(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],r=[];gt(e,(i,s)=>{this.wtSettings.getSetting(s).length&&r.push(i),t.push(i)}),rt(this.wtTable.wtRootElement.parentNode,t),oe(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var t;if(!UU.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(t=this.wtOverlays[`${r}Overlay`])!==null&&t!==void 0?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class SI{constructor(e){e instanceof lI?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const r=new SI(t);return()=>r},this._wot=new d8(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,r){return this._wot.createCellRange(e,t,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,r,i,s){return this._wot.scrollViewport(e,t,r,i,s)}scrollViewportHorizontally(e,t,r){return this._wot.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wot.scrollViewportVertically(e,t,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,r,i,s){return this._wot.wtSettings.getSetting(e,t,r,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function yL(n){let{isShiftKey:e,isLeftClick:t,isRightClick:r,coords:i,selection:s,controller:o,cellCoordsFactory:a}=n;const l=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),h=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(u||h)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):h&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!u&&!h&&i.col<0||u&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!h&&i.row<0||h&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const c=!s.inInSelection(i),d=t||r&&c;i.row<0&&i.col>=0&&!o.column?d&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?d&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?d&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function f8(n){let{isLeftClick:e,coords:t,selection:r,controller:i,cellCoordsFactory:s}=n;if(!e)return;const o=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(s(u-1,t.col)):o&&!i.row?r.setRangeEnd(s(t.row,l-1)):i.cell||r.setRangeEnd(t),r.markEndSource()}const m8=new Map([["mousedown",yL],["mouseover",f8],["touchstart",yL]]);function CL(n,e){let{coords:t,selection:r,controller:i,cellCoordsFactory:s}=e;m8.get(n.type)({coords:t,selection:r,controller:i,cellCoordsFactory:s,isShiftKey:n.shiftKey,isLeftClick:eI(n)||n.type==="touchstart",isRightClick:Uh(n)})}const zU=new WeakMap,RI=Symbol("rootInstance");function g8(n){zU.set(n,!0)}function p8(n){return n===RI}function gv(n){return zU.has(n)}function w8(n,e){YU(n,e),e.add(n)}function Hu(n,e,t){YU(n,e),e.set(n,t)}function YU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rl(n,e,t){return(e=v8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function v8(n){var e=y8(n,"string");return typeof e=="symbol"?e:e+""}function y8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function fr(n,e){return n.get(sg(n,e))}function os(n,e,t){return n.set(sg(n,e),t),t}function sg(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Rb=new WeakMap,xp=new WeakMap,Pp=new WeakMap,Ma=new WeakMap,Ws=new WeakMap,Eb=new WeakMap,bb=new WeakMap,pv=new WeakSet;class C8{constructor(e){w8(this,pv),Rl(this,"hot",void 0),Rl(this,"eventManager",void 0),Rl(this,"settings",void 0),Rl(this,"THEAD",void 0),Rl(this,"TBODY",void 0),Rl(this,"_wt",void 0),Rl(this,"activeWt",void 0),Hu(this,Rb,0),Hu(this,xp,0),Rl(this,"postponedAdjustElementsSize",!1),Hu(this,Pp,!1),Hu(this,Ma,void 0),Hu(this,Ws,void 0),Hu(this,Eb,0),Hu(this,bb,0),this.hot=e,this.eventManager=new wo(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const r=this._wt.getCell(e,t);return r<0?null:r}scrollViewport(e,t,r,i,s){return this._wt.scrollViewport(e,t,r,i,s)}scrollViewportHorizontally(e,t,r){return this._wt.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wt.scrollViewportVertically(e,t,r)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),oe(e,"handsontable"),os(Ws,this,t.createElement("TABLE")),oe(fr(Ws,this),"htCore"),this.hot.getSettings().tableClassName&&oe(fr(Ws,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Xe(fr(Ws,this),[oa()]),Xe(e,[F6(),QV(-1),PC(this.hot.countCols()),Q6()])),this.THEAD=t.createElement("THEAD"),fr(Ws,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),fr(Ws,this).appendChild(this.TBODY),this.hot.table=fr(Ws,this),this.hot.container.insertBefore(fr(Ws,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:r,rootWindow:i}=this.hot,s=t.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{os(Pp,this,!0),this.isTextSelectionAllowed(a.target)||(S1(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{os(Pp,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{fr(Pp,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&S1(i),a.preventDefault())}),this.eventManager.addEventListener(s,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(s,"mouseup",a=>{r.isInProgress()&&eI(a)&&r.finish(),os(Ma,this,!1);const l=aU(t.activeElement);mv(t.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Uh(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",a=>{r.isInProgress()&&Uh(a)&&(r.finish(),os(Ma,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{r.isInProgress()&&r.finish(),os(Ma,this,!1)}),this.eventManager.addEventListener(s,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,h=a.y||a.clientY;let c=a.target;if(fr(Ma,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(c===d){const m=Rr(t);if(t.elementFromPoint(u+m,h)!==d||t.elementFromPoint(u,h+m)!==d)return}else for(;c!==s;){if(c===null){if(a.isTargetWebComponent)break;return}if(c===e)return;c=c.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=Pd(i);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=Pd(o);this.eventManager.addEventListener(fr(Ws,this),"selectstart",a=>{this.settings.fragmentSelection||mv(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,r))}translateFromRenderableToVisualIndex(e,t){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return r===null&&(r=e),i===null&&(i=t),[r,i]}countRenderableIndexes(e,t){const r=Math.min(e.getNotTrimmedIndexesLength(),t),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,r,i){if(isNaN(e)||e<0)return 0;const s=r.getNearestNotHiddenIndex(e,t),o=r.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return t<0?a=o+1:t>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let r=0;for(let i=e;i<=t;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,t){let r=0;for(let i=e;i<=t;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:fr(Ws,this),isDataViewInstance:()=>gv(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),os(xp,this,s.length),this.hot.getSettings().ariaTags&&sg(pv,this,KU).call(this)===this.hot.countCols()&&sg(pv,this,S8).call(this,fr(xp,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),os(Rb,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.runHooks("modifyGetCellCoords",l,u);let c=l,d=u;Array.isArray(h)&&([c,d]=h);const f=this.hot.getCellMeta(c,d),m=this.hot.colToProp(d);let p=this.hot.getDataAtRowProp(c,m);this.hot.hasHook("beforeValueRender")&&(p=this.hot.runHooks("beforeValueRender",p,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,p,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,p,f),this.hot.runHooks("afterRenderer",a,l,u,m,p,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Ld(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),h={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,os(Ma,this,!0),this.hot.runHooks("beforeOnCellMouseDown",s,u,a,h),!Sh(s)&&(CL(s,{coords:u,selection:this.hot.selection,controller:h,cellCoordsFactory:(c,d)=>this.hot._createCellCoords(c,d)}),this.hot.runHooks("afterOnCellMouseDown",s,u,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,os(Ma,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,u,a),!Sh(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,u,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,u,a),!Sh(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,u,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),h={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,u,a,h),!Sh(s)&&(fr(Ma,this)&&CL(s,{coords:u,selection:this.hot.selection,controller:h,cellCoordsFactory:(c,d)=>this.hot._createCellCoords(c,d)}),this.hot.runHooks("afterOnCellMouseOver",s,u,a),this.activeWt=this._wt)},onCellMouseUp:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,u,a),!(Sh(s)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",s,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:s=>{const o=this.hot.rowIndexMapper,a=s<0;let l=s;return!a&&(l=o.getVisualFromRenderableIndex(s),l===null)?s:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:s=>{const o=this.hot.columnIndexMapper,a=s<0;let l=s;return!a&&(l=o.getVisualFromRenderableIndex(s),l===null)?s:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=s<0;let h=s;u||(h=l.getVisualFromRenderableIndex(s));const c=this.hot.runHooks("beforeHighlightingRowHeader",h,o,a);return u?c:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(c,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,u=s<0;let h=s;u||(h=l.getVisualFromRenderableIndex(s));const c=this.hot.runHooks("beforeHighlightingColumnHeader",h,o,a);return u?c:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(c,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[u,h]=this.translateFromRenderableToVisualIndex(s,o),c=this.hot.selection.getSelectedRange();if(c.size()>0){const f=c.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,h,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,u,h]=s,c=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(h)];return this.hot.runHooks("beforeDrawBorders",c,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(s,o)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.runHooks("beforeStretchingColumnWidth",s,a)},onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,h=o>=0?u.getVisualFromRenderableIndex(o):o,c=s>=0?l.getVisualFromRenderableIndex(s):s,d=this.hot.runHooks("modifyGetCellCoords",c,h,a);if(Array.isArray(d)){const[f,m,p,v]=d;return[f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f,m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,p>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(p,-1)):p,v>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(v,-1)):v]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,u=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(u+o,a-1);else if(o==="auto"){const h=Math.ceil(u/a*12);s.startRow=Math.max(l-h,0),s.endRow=Math.min(u+h,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,u=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(u+o,a-1)),o==="auto"){const h=Math.ceil(u/a*6);s.startColumn=Math.max(l-h,0),s.endColumn=Math.min(u+h,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new SI(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(t,"mousedown",s=>{s.target===t&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",s=>{s.target===t&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(mv(e))return!0;const t=Dh(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return fr(Ma,this)}isSelectedOnlyCell(){var e,t;return(e=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const r=t.firstChild;if(!Ze(r,"relative")){fa(t),this.appendRowHeader(e,t);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,s=r.createElement("div"),o=r.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),t.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(t.firstChild){const o=t.firstChild;Ze(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,r,i),o.className="",oe(o,["relative",...s()])):(fa(t),this.appendColHeader(e,t,r,i))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),u=s();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Xe(a,...oa()),Xe(l,...oa())),this.updateCellHeader(l,e,r,i),a.appendChild(l),t.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,t,i)}updateCellHeader(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=t;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ze(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(t):Ze(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(t))),s>-1?Qd(e,r(t,i)):(Vh(e," "),oe(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,t){os(Eb,this,e),os(bb,this,t)}getLastSize(){return{width:fr(Eb,this),height:fr(bb,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return fr(Rb,this)}getRowHeadersCount(){return fr(xp,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return((t=this._wt.wtOverlays.getParentOverlay(e))!==null&&t!==void 0?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function KU(){return parseInt(this.hot.rootElement.getAttribute(PC()[0]),10)}function S8(n){const e=sg(pv,this,KU).call(this)+n;Xe(this.hot.rootElement,...PC(e))}const R8="ABCDEFGHIJKLMNOPQRSTUVWXYZ",SL=R8.length;function E8(n){let e=n+1,t="",r;for(;e>0;)r=(e-1)%SL,t=String.fromCharCode(65+r)+t,e=parseInt((e-r)/SL,10);return t}function qU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=n;const r=[];return(!Array.isArray(n)||!Array.isArray(n[0]))&&(t=[n]),t.forEach((i,s)=>{Array.isArray(i)?i.forEach((o,a)=>{r.push([s+e,a,o])}):Object.keys(i).forEach(o=>{r.push([s+e,o,i[o]])})}),r}function XU(n){let e=0;return Array.isArray(n)&&(n[0]&&Array.isArray(n[0])?e=n[0].length:n[0]&&mt(n[0])&&(e=Z0(n[0]))),e}function b8(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>Array.isArray(e)))}function T8(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function Tf(n,e,t){return(e=A8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function A8(n){var e=N8(n,"string");return typeof e=="symbol"?e:e+""}function N8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class I8{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Tf(this,"hot",void 0),Tf(this,"data",void 0),Tf(this,"dataType","array"),Tf(this,"colToProp",()=>{}),Tf(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return D(this.data,(r,i)=>{const s=this.getAtCell(i,e);t.push(s)}),t}getAtRow(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=t===void 0&&r===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((u,h)=>{l[h]=this.getAtPhysicalCell(e,h,a)}):De(t,r,u=>{l[u-t]=this.getAtPhysicalCell(e,u,a)});else if(mt(a)||un(a))if(i?l=[]:l={},!s||i){const h=this.countFirstRowKeys()-1;De(0,h,c=>{const d=this.colToProp(c);if(c>=(t||0)&&c<=(r||h)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):o?ZE(l,d,f):l[d]=f}})}else gt(a,(u,h)=>{const c=this.getAtPhysicalCell(e,h,a);o?ZE(l,h,c):l[h]=c});return l}setAtCell(e,t,r){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=lo(r);this.hot.runHooks("modifySourceData",e,t,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(t)?this.data[e][t]=r:ZE(this.data[e],t,r)}}getAtPhysicalCell(e,t,r){let i=null;if(r)if(typeof t=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?b4(r,t):r[t]}else typeof t=="function"?i=t(r):i=r[t];if(this.hot.hasHook("modifySourceData")){const s=lo(i);this.hot.runHooks("modifySourceData",e,t,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,t){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||t===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,t.row),o=Math.min(e.col,t.col),a=Math.max(e.row,t.row),l=Math.max(e.col,t.col));const u=[];return De(s,a,h=>{u.push(i?this.getAtRow(h,void 0,void 0,r):this.getAtRow(h,o,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return XU(this.data)}destroy(){this.data=null,this.hot=null}}function RL(n,e,t){return(e=M8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function M8(n){var e=O8(n,"string");return typeof e=="symbol"?e:e+""}function O8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class sc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;RL(this,"indexedValues",[]),RL(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,un(this.initValueOrFn)?De(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):De(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Zt(sc,Hr);function EI(n,e,t,r){const i=t.length?t[0]:void 0;return[...n.slice(0,i),...t.map((s,o)=>un(r)?r(s,o):r),...i===void 0?[]:n.slice(i)]}function bI(n,e){return du(n,(t,r)=>e.includes(r)===!1)}class vu extends sc{insert(e,t){this.indexedValues=EI(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=bI(this.indexedValues,e),super.remove(e)}}class BC extends vu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return hi(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}function TI(n,e,t){return[...n.slice(0,e),...t,...n.slice(e)]}function og(n,e){return du(n,t=>e.includes(t)===!1)}function AI(n,e){return bt(n,t=>t-e.filter(r=>r<t).length)}function NI(n,e){const t=e[0],r=e.length;return bt(n,i=>i>=t?i+r:i)}function _8(n,e,t){return(e=x8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function x8(n){var e=P8(n,"string");return typeof e=="symbol"?e:e+""}function P8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class WC extends sc{constructor(){super(...arguments),_8(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=og(this.orderOfIndexes,[e]),un(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=EI(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=NI(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=bI(this.indexedValues,e),this.orderOfIndexes=og(this.orderOfIndexes,e),this.orderOfIndexes=AI(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Yg extends vu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return hi(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}const EL=new Map([["indexesSequence",{getListWithInsertedItems:TI,getListWithRemovedItems:og}],["physicallyIndexed",{getListWithInsertedItems:EI,getListWithRemovedItems:bI}]]),QU=n=>{if(EL.has(n)===!1)throw new Error(`Alter strategy with ID '${n}' does not exist.`);return EL.get(n)};class ZU extends sc{constructor(){super(e=>e)}insert(e,t){const r=NI(this.indexedValues,t);this.indexedValues=TI(r,e,t),super.insert(e,t)}remove(e){const t=og(this.indexedValues,e);this.indexedValues=AI(t,e),super.remove(e)}}const bL=new Map([["hiding",BC],["index",sc],["linkedPhysicalIndexToValue",WC],["physicalIndexToValue",vu],["trimming",Yg]]);function L8(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!bL.has(n))throw new Error(`The provided map type ("${n}") does not exist.`);return new(bL.get(n))(e)}function D8(n,e,t){return(e=H8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function H8(n){var e=F8(n,"string");return typeof e=="symbol"?e:e+""}function F8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class II{constructor(){D8(this,"collection",new Map)}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)))}unregister(e){const t=this.collection.get(e);Oe(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t))}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return hn(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(r=>{r.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}Zt(II,Hr);function Tb(n,e,t){return(e=k8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function k8(n){var e=V8(n,"string");return typeof e=="symbol"?e:e+""}function V8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class TL extends II{constructor(e,t){super(),Tb(this,"mergedValuesCache",[]),Tb(this,"aggregationFunction",void 0),Tb(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=bt(this.get(),s=>s.getValues()),r=[],i=Oe(t[0])&&t[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(t[a][s]);r.push(o)}return bt(r,this.aggregationFunction)}getMergedValueAtIndex(e,t){const r=this.getMergedValues(t)[e];return Oe(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function U8(n,e,t){B8(n,e),e.set(n,t)}function B8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function W8(n,e,t){return n.set(JU(n,e),t),t}function $8(n,e){return n.get(JU(n,e))}function JU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ab=new WeakMap;class eB{constructor(){U8(this,Ab,[])}subscribe(e){return this.addLocalHook("change",e),this._write($8(Ab,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){W8(Ab,this,e)}}Zt(eB,Hr);function AL(n,e){const t=[];let r=0,i=0;for(;r<n.length&&i<e.length;r++,i++)n[r]!==e[i]&&t.push({op:"replace",index:i,oldValue:n[r],newValue:e[i]});for(;r<e.length;r++)t.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<n.length;i++)t.push({op:"remove",index:i,oldValue:n[i],newValue:void 0});return t}function Af(n,e,t){G8(n,e),e.set(n,t)}function G8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function as(n,e){return n.get(tB(n,e))}function Lp(n,e,t){return n.set(tB(n,e),t),t}function tB(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Dp=new WeakMap,Nf=new WeakMap,Hp=new WeakMap,Fp=new WeakMap,kp=new WeakMap;class j8{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Af(this,Dp,new Set),Af(this,Nf,[]),Af(this,Hp,[]),Af(this,Fp,!1),Af(this,kp,!1),Lp(kp,this,e??!1)}createObserver(){const e=new eB;return as(Dp,this).add(e),e.addLocalHook("unsubscribe",()=>{as(Dp,this).delete(e)}),e._writeInitialChanges(AL(as(Nf,this),as(Hp,this))),e}emit(e){let t=as(Hp,this);(!as(Fp,this)||as(Nf,this).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(as(kp,this)):Lp(Nf,this,new Array(e.length).fill(as(kp,this))),as(Fp,this)||(Lp(Fp,this,!0),t=as(Nf,this)));const r=AL(t,e);as(Dp,this).forEach(i=>i._write(r)),Lp(Hp,this,e)}}function Qr(n,e,t){return(e=z8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function z8(n){var e=Y8(n,"string");return typeof e=="symbol"?e:e+""}function Y8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class KA{constructor(){Qr(this,"indexesSequence",new ZU),Qr(this,"trimmingMapsCollection",new TL(e=>e.some(t=>t===!0),!1)),Qr(this,"hidingMapsCollection",new TL(e=>e.some(t=>t===!0),!1)),Qr(this,"variousMapsCollection",new II),Qr(this,"hidingChangesObservable",new j8({initialIndexValue:!1})),Qr(this,"notTrimmedIndexesCache",[]),Qr(this,"notHiddenIndexesCache",[]),Qr(this,"isBatched",!1),Qr(this,"indexesSequenceChanged",!1),Qr(this,"indexesChangeSource",void 0),Qr(this,"trimmedIndexesChanged",!1),Qr(this,"hiddenIndexesChanged",!1),Qr(this,"renderablePhysicalIndexesCache",[]),Qr(this,"fromPhysicalToVisualIndexesCache",new Map),Qr(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,r){return this.registerMap(e,L8(t,r))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof Yg?this.trimmingMapsCollection.register(e,t):t instanceof BC?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const r=this.getNumberOfIndexes();return r>0&&t.init(r),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return Oe(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return Oe(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return Oe(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return Oe(t)?t:null}getNearestNotHiddenIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return t>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?r?this.getNearestNotHiddenIndex(e,-t,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const r=bt(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=og(this.getIndexesSequence(),r),a=o.filter(u=>this.isTrimmed(u)===!1);let l=o.indexOf(a[a.length-1])+1;if(t+s<i){const u=a[t];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(TI(o,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const r=this.getNotTrimmedIndexes()[e],i=Oe(r)?r:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),o=bt(new Array(t).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,o),this.hidingMapsCollection.insertToEvery(s,o),this.variousMapsCollection.insertToEvery(s,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(r,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromRenderableIndex(t),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,t)}}}Zt(KA,Hr);function K8(n,e){return gt(e,(t,r)=>{hn(n[r])&&(n[r]=t)}),n}function nB(n){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(n);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:n}function rB(n){Oe(n)&&nI(zt`Language with code "${n}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function q8(n,e){return Array.isArray(n)&&Number.isInteger(e)?n[e]:n}const{register:X8,getValues:Q8}=Eo("phraseFormatters");function Z8(n,e){X8(n,e)}function J8(){return Q8()}Z8("pluralize",q8);const iB="ContextMenu:items",lt=iB,MI=`${lt}.noItems`,OI=`${lt}.insertRowAbove`,_I=`${lt}.insertRowBelow`,xI=`${lt}.insertColumnOnTheLeft`,PI=`${lt}.insertColumnOnTheRight`,LI=`${lt}.removeRow`,DI=`${lt}.removeColumn`,HI=`${lt}.undo`,FI=`${lt}.redo`,ny=`${lt}.readOnly`,kI=`${lt}.clearColumn`,VI=`${lt}.copy`,UI=`${lt}.copyWithHeaders`,BI=`${lt}.copyWithGroupHeaders`,WI=`${lt}.copyHeadersOnly`,$I=`${lt}.cut`,GI=`${lt}.freezeColumn`,jI=`${lt}.unfreezeColumn`,zI=`${lt}.mergeCells`,YI=`${lt}.unmergeCells`,KI=`${lt}.addComment`,qI=`${lt}.editComment`,XI=`${lt}.removeComment`,QI=`${lt}.readOnlyComment`,ZI=`${lt}.align`,ry=`${lt}.align.left`,iy=`${lt}.align.center`,sy=`${lt}.align.right`,oy=`${lt}.align.justify`,ay=`${lt}.align.top`,ly=`${lt}.align.middle`,uy=`${lt}.align.bottom`,JI=`${lt}.borders`,eM=`${lt}.borders.top`,tM=`${lt}.borders.right`,nM=`${lt}.borders.bottom`,rM=`${lt}.borders.left`,iM=`${lt}.borders.remove`,sM=`${lt}.nestedHeaders.insertChildRow`,oM=`${lt}.nestedHeaders.detachFromParent`,aM=`${lt}.hideColumn`,lM=`${lt}.showColumn`,uM=`${lt}.hideRow`,hM=`${lt}.showRow`,ci="Filters:",Pn=`${ci}conditions`,$C=`${Pn}.none`,cM=`${Pn}.isEmpty`,dM=`${Pn}.isNotEmpty`,fM=`${Pn}.isEqualTo`,mM=`${Pn}.isNotEqualTo`,gM=`${Pn}.beginsWith`,pM=`${Pn}.endsWith`,wM=`${Pn}.contains`,vM=`${Pn}.doesNotContain`,e7=`${Pn}.byValue`,yM=`${Pn}.greaterThan`,CM=`${Pn}.greaterThanOrEqualTo`,SM=`${Pn}.lessThan`,RM=`${Pn}.lessThanOrEqualTo`,EM=`${Pn}.isBetween`,bM=`${Pn}.isNotBetween`,TM=`${Pn}.after`,AM=`${Pn}.before`,NM=`${Pn}.today`,IM=`${Pn}.tomorrow`,MM=`${Pn}.yesterday`,OM=`${ci}labels.filterByCondition`,_M=`${ci}labels.filterByValue`,xM=`${ci}labels.conjunction`,GC=`${ci}labels.disjunction`,hy=`${ci}values.blankCells`,PM=`${ci}buttons.selectAll`,LM=`${ci}buttons.clear`,DM=`${ci}buttons.ok`,HM=`${ci}buttons.cancel`,FM=`${ci}buttons.placeholder.search`,kM=`${ci}buttons.placeholder.value`,VM=`${ci}buttons.placeholder.secondValue`,UM="CheckboxRenderer:",BM=`${UM}checked`,WM=`${UM}unchecked`,t7=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:BM,CHECKBOX_RENDERER_NAMESPACE:UM,CHECKBOX_UNCHECKED:WM,CONTEXTMENU_ITEMS_ADD_COMMENT:KI,CONTEXTMENU_ITEMS_ALIGNMENT:ZI,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:uy,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:iy,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:oy,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:ry,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:ly,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:sy,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:ay,CONTEXTMENU_ITEMS_BORDERS:JI,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:nM,CONTEXTMENU_ITEMS_BORDERS_LEFT:rM,CONTEXTMENU_ITEMS_BORDERS_RIGHT:tM,CONTEXTMENU_ITEMS_BORDERS_TOP:eM,CONTEXTMENU_ITEMS_CLEAR_COLUMN:kI,CONTEXTMENU_ITEMS_COPY:VI,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:WI,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:BI,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:UI,CONTEXTMENU_ITEMS_CUT:$I,CONTEXTMENU_ITEMS_EDIT_COMMENT:qI,CONTEXTMENU_ITEMS_FREEZE_COLUMN:GI,CONTEXTMENU_ITEMS_HIDE_COLUMN:aM,CONTEXTMENU_ITEMS_HIDE_ROW:uM,CONTEXTMENU_ITEMS_INSERT_LEFT:xI,CONTEXTMENU_ITEMS_INSERT_RIGHT:PI,CONTEXTMENU_ITEMS_MERGE_CELLS:zI,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:oM,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:sM,CONTEXTMENU_ITEMS_NO_ITEMS:MI,CONTEXTMENU_ITEMS_READ_ONLY:ny,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:QI,CONTEXTMENU_ITEMS_REDO:FI,CONTEXTMENU_ITEMS_REMOVE_BORDERS:iM,CONTEXTMENU_ITEMS_REMOVE_COLUMN:DI,CONTEXTMENU_ITEMS_REMOVE_COMMENT:XI,CONTEXTMENU_ITEMS_REMOVE_ROW:LI,CONTEXTMENU_ITEMS_ROW_ABOVE:OI,CONTEXTMENU_ITEMS_ROW_BELOW:_I,CONTEXTMENU_ITEMS_SHOW_COLUMN:lM,CONTEXTMENU_ITEMS_SHOW_ROW:hM,CONTEXTMENU_ITEMS_UNDO:HI,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:jI,CONTEXTMENU_ITEMS_UNMERGE_CELLS:YI,CONTEXT_MENU_ITEMS_NAMESPACE:iB,FILTERS_BUTTONS_CANCEL:HM,FILTERS_BUTTONS_CLEAR:LM,FILTERS_BUTTONS_OK:DM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:FM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:VM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:kM,FILTERS_BUTTONS_SELECT_ALL:PM,FILTERS_CONDITIONS_AFTER:TM,FILTERS_CONDITIONS_BEFORE:AM,FILTERS_CONDITIONS_BEGINS_WITH:gM,FILTERS_CONDITIONS_BETWEEN:EM,FILTERS_CONDITIONS_BY_VALUE:e7,FILTERS_CONDITIONS_CONTAINS:wM,FILTERS_CONDITIONS_EMPTY:cM,FILTERS_CONDITIONS_ENDS_WITH:pM,FILTERS_CONDITIONS_EQUAL:fM,FILTERS_CONDITIONS_GREATER_THAN:yM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:CM,FILTERS_CONDITIONS_LESS_THAN:SM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:RM,FILTERS_CONDITIONS_NAMESPACE:Pn,FILTERS_CONDITIONS_NONE:$C,FILTERS_CONDITIONS_NOT_BETWEEN:bM,FILTERS_CONDITIONS_NOT_CONTAIN:vM,FILTERS_CONDITIONS_NOT_EMPTY:dM,FILTERS_CONDITIONS_NOT_EQUAL:mM,FILTERS_CONDITIONS_TODAY:NM,FILTERS_CONDITIONS_TOMORROW:IM,FILTERS_CONDITIONS_YESTERDAY:MM,FILTERS_DIVS_FILTER_BY_CONDITION:OM,FILTERS_DIVS_FILTER_BY_VALUE:_M,FILTERS_LABELS_CONJUNCTION:xM,FILTERS_LABELS_DISJUNCTION:GC,FILTERS_NAMESPACE:ci,FILTERS_VALUES_BLANK_CELLS:hy},Symbol.toStringTag,{value:"Module"}));const sB={languageCode:"en-US",[MI]:"No available options",[OI]:"Insert row above",[_I]:"Insert row below",[xI]:"Insert column left",[PI]:"Insert column right",[LI]:["Remove row","Remove rows"],[DI]:["Remove column","Remove columns"],[HI]:"Undo",[FI]:"Redo",[ny]:"Read only",[kI]:"Clear column",[ZI]:"Alignment",[ry]:"Left",[iy]:"Center",[sy]:"Right",[oy]:"Justify",[ay]:"Top",[ly]:"Middle",[uy]:"Bottom",[GI]:"Freeze column",[jI]:"Unfreeze column",[JI]:"Borders",[eM]:"Top",[tM]:"Right",[nM]:"Bottom",[rM]:"Left",[iM]:"Remove border(s)",[KI]:"Add comment",[qI]:"Edit comment",[XI]:"Delete comment",[QI]:"Read-only comment",[zI]:"Merge cells",[YI]:"Unmerge cells",[VI]:"Copy",[UI]:["Copy with header","Copy with headers"],[BI]:["Copy with group header","Copy with group headers"],[WI]:["Copy header only","Copy headers only"],[$I]:"Cut",[sM]:"Insert child row",[oM]:"Detach from parent",[aM]:["Hide column","Hide columns"],[lM]:["Show column","Show columns"],[uM]:["Hide row","Hide rows"],[hM]:["Show row","Show rows"],[$C]:"None",[cM]:"Is empty",[dM]:"Is not empty",[fM]:"Is equal to",[mM]:"Is not equal to",[gM]:"Begins with",[pM]:"Ends with",[wM]:"Contains",[vM]:"Does not contain",[yM]:"Greater than",[CM]:"Greater than or equal to",[SM]:"Less than",[RM]:"Less than or equal to",[EM]:"Is between",[bM]:"Is not between",[TM]:"After",[AM]:"Before",[NM]:"Today",[IM]:"Tomorrow",[MM]:"Yesterday",[hy]:"Blank cells",[OM]:"Filter by condition",[_M]:"Filter by value",[xM]:"And",[GC]:"Or",[PM]:"Select all",[LM]:"Clear",[DM]:"OK",[HM]:"Cancel",[FM]:"Search",[kM]:"Value",[VM]:"Second value",[BM]:"Checked",[WM]:"Unchecked"},n7=t7,qA=sB.languageCode,{register:r7,getItem:oB,hasItem:i7,getValues:s7}=Eo("languagesDictionaries");aB(sB);function aB(n,e){let t=n,r=e;return mt(n)&&(r=n,t=r.languageCode),o7(t,r),r7(t,ui(r)),ui(r)}function o7(n,e){n!==qA&&K8(e,oB(qA))}function lB(n){return $M(n)?ui(oB(n)):null}function $M(n){return i7(n)}function a7(){return s7()}function uB(n,e,t){const r=lB(n);if(r===null)return null;const i=r[e];if(hn(i))return null;const s=l7(i,t);return Array.isArray(s)?s[0]:s}function l7(n,e){let t=n;return D(J8(),r=>{t=r(n,e)}),t}function u7(n){let e=nB(n);return $M(e)||(e=qA,rB(n)),e}function h7(n,e,t){return(e=c7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function c7(n){var e=d7(n,"string");return typeof e=="symbol"?e:e+""}function d7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class wl extends BU{constructor(e,t){super(e,null),h7(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:r}=e,i=this.getNearestNotHiddenCoords(t,1),s=this.getNearestNotHiddenCoords(r,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=t,s=r),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,t,r){return t<0?t:e.getNearestNotHiddenIndex(t,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(t,r,i)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(t);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function Nb(n){let{activeHeaderClassName:e,...t}=n;return new wl({className:e,...t,selectionType:WU})}function f7(n){let{areaCornerVisible:e,...t}=n;return new wl({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...t,selectionType:fI})}function m7(n){let{...e}=n;return new wl({className:"highlight",...e,selectionType:fI})}function g7(n){let{columnClassName:e,...t}=n;return new wl({className:e,...t,selectionType:B5})}function p7(n){let{cellCornerVisible:e,...t}=n;return new wl({className:"current",headerAttributes:[z0()],border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:mI})}function w7(n){let{border:e,visualCellRange:t,...r}=n;return new wl({...e,...r,selectionType:W5},t)}function v7(n){let{...e}=n;return new wl({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:V5})}function NL(n){let{headerClassName:e,...t}=n;return new wl({className:e,...t,selectionType:dI})}function y7(n){let{rowClassName:e,...t}=n;return new wl({className:e,...t,selectionType:U5})}function C7(n,e){S7(n,e),e.add(n)}function S7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pi(n,e,t){return(e=R7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function R7(n){var e=E7(n,"string");return typeof e=="symbol"?e:e+""}function E7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Oa(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Mo=new WeakSet;class b7{constructor(e){C7(this,Mo),pi(this,"options",void 0),pi(this,"layerLevel",0),pi(this,"focus",void 0),pi(this,"fill",void 0),pi(this,"layeredAreas",new Map),pi(this,"areas",new Map),pi(this,"rowHeaders",new Map),pi(this,"columnHeaders",new Map),pi(this,"activeRowHeaders",new Map),pi(this,"activeColumnHeaders",new Map),pi(this,"activeCornerHeaders",new Map),pi(this,"rowHighlights",new Map),pi(this,"columnHighlights",new Map),pi(this,"customSelections",[]),this.options=e,this.focus=p7(e),this.fill=v7(e)}isEnabledFor(e,t){let r=e;e===mI&&(r="current");let i=this.options.disabledCellSelection(t.row,t.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Oa(Mo,this,_a).call(this,this.layeredAreas,f7)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Oa(Mo,this,_a).call(this,this.areas,m7)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Oa(Mo,this,_a).call(this,this.rowHeaders,NL)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Oa(Mo,this,_a).call(this,this.columnHeaders,NL)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Oa(Mo,this,_a).call(this,this.activeRowHeaders,Nb)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Oa(Mo,this,_a).call(this,this.activeColumnHeaders,Nb)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Oa(Mo,this,_a).call(this,this.activeCornerHeaders,Nb)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Oa(Mo,this,_a).call(this,this.rowHighlights,y7)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Oa(Mo,this,_a).call(this,this.columnHighlights,g7)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(w7({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),D(this.areas.values(),e=>{e.clear()}),D(this.layeredAreas.values(),e=>{e.clear()}),D(this.rowHeaders.values(),e=>{e.clear()}),D(this.columnHeaders.values(),e=>{e.clear()}),D(this.activeRowHeaders.values(),e=>{e.clear()}),D(this.activeColumnHeaders.values(),e=>{e.clear()}),D(this.activeCornerHeaders.values(),e=>{e.clear()}),D(this.rowHighlights.values(),e=>{e.clear()}),D(this.columnHighlights.values(),e=>{e.clear()})}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function _a(n,e){const t=this.layerLevel;if(n.has(t))return n.get(t);const r=e({layerLevel:t,...this.options});return n.set(t,r),r}function IL(n,e,t){return(e=T7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function T7(n){var e=A7(n,"string");return typeof e=="symbol"?e:e+""}function A7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class N7{constructor(e){IL(this,"ranges",[]),IL(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function I7(n,e){hB(n,e),e.add(n)}function Ib(n,e,t){hB(n,e),e.set(n,t)}function hB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pt(n,e){return n.get(Zn(n,e))}function Vp(n,e,t){return n.set(Zn(n,e),t),t}function Zn(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Up=new WeakMap,ln=new WeakMap,ho=new WeakMap,ar=new WeakSet;class XA{constructor(e,t){I7(this,ar),Ib(this,Up,void 0),Ib(this,ln,void 0),Ib(this,ho,{x:0,y:0}),Vp(Up,this,e),Vp(ln,this,t)}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Pt(ln,this).createCellCoords(e,t);let s=Pt(Up,this).current().highlight;const o=Pt(ln,this).visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),o.row!==null&&o.col!==null){const{width:u,height:h}=Zn(ar,this,cB).call(this),{row:c,col:d}=Zn(ar,this,OL).call(this,s),f=Pt(ln,this).fixedRowsBottom(),m=Pt(ln,this).minSpareRows(),p=Pt(ln,this).minSpareCols(),v=Pt(ln,this).autoWrapRow(),y=Pt(ln,this).autoWrapCol(),C=Pt(ln,this).createCellCoords(c+i.row,d+i.col);if(C.row>=h){const I=lo(r&&m>0&&f===0),H=C.col+1,k=Pt(ln,this).createCellCoords(C.row-h,H>=u?H-u:H);this.runLocalHooks("beforeColumnWrap",I,Zn(ar,this,yc).call(this,k),H>=u),I.value?this.runLocalHooks("insertRowRequire",Pt(ln,this).countRenderableRows()):y&&C.assign(k)}else if(C.row<0){const I=lo(y),H=C.col-1,k=Pt(ln,this).createCellCoords(h+C.row,H<0?u+H:H);this.runLocalHooks("beforeColumnWrap",I,Zn(ar,this,yc).call(this,k),H<0),y&&C.assign(k)}if(C.col>=u){const I=lo(r&&p>0),H=C.row+1,k=Pt(ln,this).createCellCoords(H>=h?H-h:H,C.col-u);this.runLocalHooks("beforeRowWrap",I,Zn(ar,this,yc).call(this,k),H>=h),I.value?this.runLocalHooks("insertColRequire",Pt(ln,this).countRenderableColumns()):v&&C.assign(k)}else if(C.col<0){const I=lo(v),H=C.row-1,k=Pt(ln,this).createCellCoords(H<0?h+H:H,u+C.col);this.runLocalHooks("beforeRowWrap",I,Zn(ar,this,yc).call(this,k),H<0),v&&C.assign(k)}const{rowDir:R,colDir:A}=Zn(ar,this,ML).call(this,C);a=R,l=A,s=Zn(ar,this,yc).call(this,C)}return this.runLocalHooks("afterTransformStart",s,a,l),s}transformEnd(e,t){const r=Pt(ln,this).createCellCoords(e,t),i=Pt(Up,this).current(),s=Pt(ln,this).visualToRenderableCoords(i.highlight),o=Zn(ar,this,Mb).call(this,i.to.row,i.from.row),a=Zn(ar,this,Ob).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,h=0;if(this.runLocalHooks("beforeTransformEnd",r),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:c,col:d}=Zn(ar,this,OL).call(this,i.highlight),f=Pt(ln,this).createCellCoords(o+r.row,a+r.col),m=i.getTopStartCorner(),p=i.getTopEndCorner(),v=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const A=f.col-d;f.col=Zn(ar,this,Ob).call(this,m.col,p.col)+A}else if(r.col>0&&a<=d&&f.col>d){const A=Zn(ar,this,Ob).call(this,p.col,m.col),I=Math.max(f.col-A,1);f.col=A+I}if(r.row<0&&o>=c&&f.row<c){const A=f.row-c;f.row=Zn(ar,this,Mb).call(this,m.row,v.row)+A}else if(r.row>0&&o<=c&&f.row>c){const A=Zn(ar,this,Mb).call(this,v.row,m.row),I=Math.max(f.row-A,1);f.row=A+I}const{rowDir:y,colDir:C}=Zn(ar,this,ML).call(this,f);u=y,h=C;const R=Zn(ar,this,yc).call(this,f);r.row===0&&r.col!==0?l.col=R.col:r.row!==0&&r.col===0?l.row=R.row:(l.row=R.row,l.col=R.col)}return this.runLocalHooks("afterTransformEnd",l,u,h),l}setOffsetSize(e){let{x:t,y:r}=e;Vp(ho,this,{x:t,y:r})}resetOffsetSize(){Vp(ho,this,{x:0,y:0})}}function ML(n){const{width:e,height:t}=Zn(ar,this,cB).call(this);let r=0,i=0;return n.row<0?(r=-1,n.row=0):n.row>0&&n.row>=t&&(r=1,n.row=t-1),n.col<0?(i=-1,n.col=0):n.col>0&&n.col>=e&&(i=1,n.col=e-1),{rowDir:r,colDir:i}}function cB(){return{width:Pt(ho,this).x+Pt(ln,this).countRenderableColumns(),height:Pt(ho,this).y+Pt(ln,this).countRenderableRows()}}function Mb(n,e){const t=Pt(ln,this).findFirstNonHiddenRenderableRow(n,e);return t===null?null:Pt(ho,this).y+t}function Ob(n,e){const t=Pt(ln,this).findFirstNonHiddenRenderableColumn(n,e);return t===null?null:Pt(ho,this).x+t}function OL(n){const{row:e,col:t}=Pt(ln,this).visualToRenderableCoords(n);if(e===null||t===null)throw new Error("Renderable coords are not visible.");return Pt(ln,this).createCellCoords(Pt(ho,this).y+e,Pt(ho,this).x+t)}function yc(n){const e=n.clone();return e.col=n.col-Pt(ho,this).x,e.row=n.row-Pt(ho,this).y,Pt(ln,this).renderableToVisualCoords(e)}Zt(XA,Hr);const jC=0,zC=1,dB=2,GM=3,M7=[GM,dB],O7=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],_b=Symbol("root"),_L=Symbol("child");function Hd(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_b;if(e!==_b&&e!==_L)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(n),r=e===_b;let i=jC;if(t){const s=n[0];n.length===0?i=zC:r&&s instanceof Gg?i=GM:r&&Array.isArray(s)?i=Hd(s,_L):n.length>=2&&n.length<=4&&!n.some((a,l)=>!O7[l].includes(typeof a))&&(i=dB)}return i}function ag(n){let{createCellCoords:e,createCellRange:t,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!M7.includes(n))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=n===GM;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],u=o?s.to.row:s[2],h=o?s.to.col:s[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof h=="string"&&(h=i(h))),hn(u)&&(u=a),hn(h)&&(h=l),!r){const f=a,m=l,p=u,v=h;a=Math.min(f,p),l=Math.min(m,v),u=Math.max(f,p),h=Math.max(m,v)}const c=e(a,l),d=e(u,h);return t(c,c,d)}}function _7(n){const e=Hd(n.getSelected());if(e===jC||e===zC)return[];const t=ag(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),r=new Set;D(n.getSelected(),o=>{const{from:a,to:l}=t(o),u=Math.max(a.col,0),h=l.col-u+1;D(Array.from(new Array(h),(c,d)=>u+d),c=>{r.has(c)||r.add(c)})});const i=Array.from(r).sort((o,a)=>o-a);return hi(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function x7(n){const e=Hd(n.getSelected());if(e===jC||e===zC)return[];const t=ag(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),r=new Set;D(n.getSelected(),o=>{const{from:a,to:l}=t(o),u=Math.max(a.row,0),h=l.row-u+1;D(Array.from(new Array(h),(c,d)=>u+d),c=>{r.has(c)||r.add(c)})});const i=Array.from(r).sort((o,a)=>o-a);return hi(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function Cc(n,e,t){P7(n,e),e.set(n,t)}function P7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fu(n,e,t){return(e=L7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function L7(n){var e=D7(n,"string");return typeof e=="symbol"?e:e+""}function D7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function mn(n,e){return n.get(fB(n,e))}function Oo(n,e,t){return n.set(fB(n,e),t),t}function fB(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Vr=new WeakMap,ku=new WeakMap,Bp=new WeakMap,If=new WeakMap,Wp=new WeakMap,Mf=new WeakMap;class mB{constructor(e,t){var r=this;Fu(this,"settings",void 0),Fu(this,"tableProps",void 0),Fu(this,"inProgress",!1),Fu(this,"selectedRange",new N7((i,s,o)=>this.tableProps.createCellRange(i,s,o))),Fu(this,"highlight",void 0),Cc(this,Vr,void 0),Cc(this,ku,void 0),Fu(this,"selectedByRowHeader",new Set),Fu(this,"selectedByColumnHeader",new Set),Cc(this,Bp,!1),Cc(this,If,!1),Cc(this,Wp,"unknown"),Cc(this,Mf,-1),this.settings=e,this.tableProps=t,this.highlight=new b7({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[z0()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o)}),Oo(Vr,this,new XA(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Oo(ku,this,new XA(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),mn(Vr,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformStart",...s)}),mn(Vr,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformStart",...s)}),mn(Vr,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformEnd",...s)}),mn(Vr,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformEnd",...s)}),mn(Vr,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertRowRequire",...s)}),mn(Vr,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertColRequire",...s)}),mn(Vr,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeRowWrap",...s)}),mn(Vr,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeColumnWrap",...s)}),mn(ku,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformFocus",...s)}),mn(ku,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){Oo(Wp,this,e)}markEndSource(){Oo(Wp,this,"unknown")}getSelectionSource(){return mn(Wp,this)}setExpectedLayers(e){Oo(Mf,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Oo(Mf,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=hn(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,a=e.clone();Oo(Bp,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!s||s&&!o&&hn(t))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&t.col<0&&!s||i===0&&t.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),u=o.getVerticalDirection(),h=this.isMultiple();o.setTo(t),h&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),h&&(u!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=mn(Mf,this)===-1||this.selectedRange.size()===mn(Mf,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();t<this.highlight.layerLevel&&(D(this.highlight.getAreas(),m=>{m.clear()}),D(this.highlight.getLayeredAreas(),m=>{m.clear()}),D(this.highlight.getRowHeaders(),m=>{m.clear()}),D(this.highlight.getColumnHeaders(),m=>{m.clear()}),D(this.highlight.getActiveRowHeaders(),m=>{m.clear()}),D(this.highlight.getActiveColumnHeaders(),m=>{m.clear()}),D(this.highlight.getActiveCornerHeaders(),m=>{m.clear()}),D(this.highlight.getRowHighlights(),m=>{m.clear()}),D(this.highlight.getColumnHighlights(),m=>{m.clear()})),this.highlight.useLayerLevel(t);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),c=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),u.clear(),h.clear(),c.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(fI,e.highlight)&&(this.isMultiple()||t>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),t===1)){const m=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(dI,e.highlight)){if(!e.isSingleHeader()){const v=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),y=this.tableProps.createCellCoords(e.to.row,-1),C=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),R=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(v).commit(),l.add(C).commit(),d.add(v).commit(),f.add(C).commit()):(a.add(v).add(y).commit(),l.add(C).add(R).commit(),d.add(v).add(y).commit(),f.add(C).add(R).commit())}const m=!mn(If,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),p=!mn(If,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),p&&h.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&p&&c.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(mI,t.highlight)&&r.add(t.highlight).commit().syncWith(t),this.inProgress||(Oo(Bp,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?mn(Vr,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):mn(Vr,this).resetOffsetSize(),this.setRangeStart(mn(Vr,this).transformStart(e,t,r))}transformEnd(e,t){this.settings.navigableHeaders?mn(Vr,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):mn(Vr,this).resetOffsetSize(),this.setRangeEnd(mn(Vr,this).transformEnd(e,t))}transformFocus(e,t){const r=this.selectedRange.current(),{row:i,col:s}=r.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,s-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?mn(ku,this).setOffsetSize({x:s<0?Math.abs(s):-o,y:i<0?Math.abs(i):-a}):mn(ku,this).setOffsetSize({x:s<0?0:-o,y:i<0?0:-a});const l=mn(ku,this).transformStart(e,t);this.setRangeFocus(l.normalize())}shiftRows(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:o}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),h=u?-1:0,c=u?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(qt(i.row+c,h,a-1),i.col),f=this.tableProps.createCellCoords(qt(s.row+t,h,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(qt(o.row+t,0,a-1),o.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:o}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),h=l?-1:0,c=l?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,qt(i.col+c,h,a-1)),f=this.tableProps.createCellCoords(s.row,qt(s.col+t,h,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(o.row,qt(o.col+t,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=lo(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&mn(Bp,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=i=>{const{col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>t(i));const r=this.selectedRange.peekByIndex(e);return r?t(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=i=>{const{row:s}=i.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>t(i));const r=this.selectedRange.peekByIndex(e);return r?t(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return t.row!==null&&t.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,h=t?-a:0;if(u===0&&h===0&&(s===0||o===0))return;let c=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;Oo(If,this,f),d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(c=this.tableProps.createCellCoords(qt(d.row,u,s-1),qt(d.col,h,o-1)));const m=this.tableProps.createCellCoords(u,h),p=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(m,void 0,c),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.finish(),Oo(If,this,!1)}selectCells(e){var t=this;const r=Hd(e);if(r===zC)return!1;if(r===jC)throw new Error(zt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=ag(r,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),h=u.isValid(o);return!(h&&!u.containsHeaders()||h&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),D(e,l=>{const{from:u,to:h}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(h.clone())}),this.finish()),a}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof t=="string"?this.tableProps.propToCol(t):t,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,h=this.tableProps.createCellCoords(u,i),c=this.tableProps.createCellCoords(o-1,s),d=this.tableProps.createCellRange(h,h,c).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,m=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(f=qt(r.row,u,o-1),m=qt(r.col,Math.min(i,s),Math.max(i,s))):(f=qt(r,u,o-1),m=i);const p=this.tableProps.createCellCoords(f,m),v=l===0?0:qt(p.row,u,-1),y=o-1,C=this.tableProps.createCellCoords(v,i),R=this.tableProps.createCellCoords(y,s);this.runLocalHooks("beforeSelectColumns",C,R,p),C.row=v,R.row=y,this.setRangeStartOnly(C,void 0,p),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(R),this.runLocalHooks("afterSelectColumns",C,R,p),this.finish()}return d}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(t,s-1),h=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:s,countRowHeaders:o,countColHeaders:0});if(h){let c=0,d=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(c=qt(r.row,Math.min(e,t),Math.max(e,t)),d=qt(r.col,a,s-1)):(c=e,d=qt(r,a,s-1));const f=this.tableProps.createCellCoords(c,d),m=o===0?0:qt(f.col,a,-1),p=s-1,v=this.tableProps.createCellCoords(e,m),y=this.tableProps.createCellCoords(t,p);this.runLocalHooks("beforeSelectRows",v,y,f),v.col=m,y.col=p,this.setRangeStartOnly(v,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectRows",v,y,f),this.finish()}return h}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(e===0||t===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:s,highlight:o}=r;this.clear(),o.assign({row:qt(o.row,-1/0,e-1),col:qt(o.col,-1/0,t-1)}),i.assign({row:qt(i.row,-1/0,e-1),col:qt(i.col,-1/0,t-1)}),s.assign({row:qt(s.row,0,e-1),col:qt(s.col,0,t-1)}),this.selectedRange.ranges.push(r),this.highlight.getFocus().add(o).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const t=this.highlight.getFocus(),r=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),c=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),u.commit(),h.commit(),c.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(r)}}Zt(mB,Hr);const xL=/^(\r\n|\n\r|\r|\n)/,H7=/^[^\t\r\n]+/,PL=/^\t/;function F7(n){const e=[[""]];if(n.length===0)return e;let t=0,r=0,i;for(;n.length>0&&i!==n.length;)if(i=n.length,n.match(PL))n=n.replace(PL,""),t+=1,e[r][t]="";else if(n.match(xL))n=n.replace(xL,""),t=0,r+=1,e[r]=[""];else{let s="";if(n.startsWith('"')){let o=0,a=!0;for(;a;){const l=n.slice(0,1);l==='"'&&(o+=1),s+=l,n=n.slice(1),(n.length===0||n.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=n.match(H7);s=o?o[0]:"",n=n.slice(s.length)}e[r][t]=s}return e}function bm(n){let e,t,r,i,s="",o;for(e=0,t=n.length;e<t;e+=1){for(i=n[e].length,r=0;r<i;r+=1)r>0&&(s+="	"),o=n[e][r],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==t-1&&(s+=`
`)}return s}function Vu(n,e,t){return(e=k7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function k7(n){var e=V7(n,"string");return typeof e=="symbol"?e:e+""}function V7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class cd{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,r){Vu(this,"hot",void 0),Vu(this,"metaManager",void 0),Vu(this,"tableMeta",void 0),Vu(this,"dataSource",void 0),Vu(this,"duckSchema",void 0),Vu(this,"colToPropCache",void 0),Vu(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,t){let i=0,s=0,o=!1;if(typeof t=="function"){const a=Z0(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,t.length)}for(r=0;r<i;r++){const a=o?t(r):t[r];if(mt(a)){if(typeof a.data<"u"){const l=o?s:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return XU(this.dataSource)}recursiveDuckColumns(e,t,r){let i=t,s=r,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&gt(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.hot.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&Oe(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(Oe(t))return this.hot.toVisualColumn(t);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?ig(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,t,r)===!1||o===null)return{delta:0};const h=this.tableMeta.maxRows,c=this.getSchema().length,d=[];for(;a<t&&s+a<h;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=ui(this.getSchema()):(m=[],De(c-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},HC(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,d);const f=this.hot.toVisualRow(o);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(o,t)),this.hot.runHooks("afterCreateRow",f,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:o}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,t,r)===!1)return{delta:0};let h=a;l<this.hot.countCols()&&(h=this.hot.toPhysicalColumn(l));const c=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,m=h;i==="end"&&(m=Math.min(m+1,a));const p=m;for(;f<t&&d<o;){if(typeof l!="number"||l>=d)if(c>0)for(let y=0;y<c;y+=1)typeof s[y]>"u"&&(s[y]=[]),s[y].push(null);else s.push([null]);else for(let y=0;y<c;y++)s[y].splice(m,0,null);f+=1,m+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(p,t));const v=this.hot.toVisualColumn(p);return this.hot.runHooks("afterCreateCol",v,f,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:p}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-t;const s=this.visualRowsToPhysical(i,t),o=this.hot.countSourceRows();if(i=(o+i)%o,this.hot.runHooks("beforeRemoveRow",i,s.length,s,r)===!1)return!1;const l=s.length;if(this.filterData(i,l,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const h=Oe(this.tableMeta.columns)||Oe(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&h===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((h,c)=>c-h).forEach(h=>{this.metaManager.removeRow(h,1)}),this.hot.runHooks("afterRemoveRow",i,l,s,r),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-t:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,t),o=s.slice(0).sort((c,d)=>d-c);if(this.hot.runHooks("beforeRemoveCol",i,t,s,r)===!1)return!1;let l=!0;const u=o.length,h=this.dataSource;for(let c=0;c<u;c++)l&&s[0]!==s[c]-c&&(l=!1);if(l)for(let c=0,d=this.hot.countSourceRows();c<d;c++)h[c].splice(s[0],t),c===0&&this.metaManager.removeColumn(s[0],t);else for(let c=0,d=this.hot.countSourceRows();c<d;c++)for(let f=0;f<u;f++)h[c].splice(o[f],1),c===0&&this.metaManager.removeColumn(o[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,t,s,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,r){const i=this.hot.getDataAtCol(e),s=i.slice(t,t+r),o=i.slice(t+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];c1(l,o);let h=0;for(;h<r;)l.push(null),h+=1;return _6(l),this.hot.populateFromArray(t,e,l,null,null,"spliceCol"),s}spliceRow(e,t,r){const i=this.hot.getSourceDataAtRow(e),s=i.slice(t,t+r),o=i.slice(t+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];c1(l,o);let h=0;for(;h<r;)l.push(null),h+=1;return this.hot.populateFromArray(e,t,[l],null,null,"spliceRow"),s}spliceData(e,t,r){if(this.hot.runHooks("beforeDataSplice",e,t,r)!==!1){const s=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,t,r){let i=this.hot.runHooks("filterData",e,t,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>r.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,t){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const s=this.hot.runHooks("modifyRowData",r);i=isNaN(s)?s:i;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&_n(i,t))a=i[t];else if(o&&typeof t=="string"&&t.indexOf(".")>-1){let l=i;if(!l)return null;const u=t.split(".");for(let h=0,c=u.length;h<c;h++)if(l=l[u[h]],typeof l>"u")return null;a=l}else typeof t=="function"&&(a=t(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=lo(a);this.hot.runHooks("modifyData",r,this.propToCol(t),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,r){const i=this.hot.toPhysicalRow(e);let s=r,o=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const u=lo(s);this.hot.runHooks("modifyData",i,this.propToCol(t),u,"set"),u.isTouched()&&(s=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&_n(o,t))o[t]=s;else if(l&&typeof t=="string"&&t.indexOf(".")>-1){let u=o,h=0,c;const d=t.split(".");for(h=0,c=d.length-1;h<c;h++)typeof u[d[h]]>"u"&&(u[d[h]]={}),u=u[d[h]];u[d[h]]=s}else typeof t=="function"?t(this.dataSource.slice(i,i+1)[0],s):o[t]=s}visualRowsToPhysical(e,t){const r=this.hot.countSourceRows(),i=[];let s=(r+e)%r,o=t,a;for(;s<r&&o;)a=this.hot.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,t){const r=this.hot.countCols(),i=[];let s=(r+e)%r,o=t;for(;s<r&&o;){const a=this.hot.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,t,cd.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,r){const i=[];let s,o,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const h=r===cd.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,t.col));for(s=Math.min(e.row,t.row);s<=c;s++){a=[];const f=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,t.col);o<=d&&f!==null;o++)a.push(h.call(this,s,this.colToProp(o)));f!==null&&i.push(a)}return i}getText(e,t){return bm(this.getRange(e,t,cd.DESTINATION_RENDERER))}getCopyableText(e,t){return bm(this.getRange(e,t,cd.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:U7,getItem:B7,hasItem:gB,getNames:OCe,getValues:_Ce}=Eo("cellTypes");function W7(n){if(!gB(n))throw Error(`You declared cell type "${n}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return B7(n)}function Ks(n,e){typeof n!="string"&&(e=n,n=e.CELL_TYPE);const{editor:t,renderer:r,validator:i}=e;t&&Wi(n,t),r&&hs(n,r),i&&Zc(n,i),U7(n,e)}function $7(n,e){var t;return n==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(n))||!_n(e,n)}function YC(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=typeof e.type=="string"?W7(e.type):e.type;if(n._automaticallyAssignedMetaProps&&gt(e,(s,o)=>{n._automaticallyAssignedMetaProps.delete(o)}),!mt(r))return;t===n&&!n._automaticallyAssignedMetaProps&&(n._automaticallyAssignedMetaProps=new Set);const i={};gt(r,(s,o)=>{if($7(o,t)){var a;i[o]=s,(a=n._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),er(n,i)}function G7(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}Ca(t,n);for(let r=0;r<e.length;r++)t.prototype[e[r]]=void 0;return t}function wv(n){return Number.isInteger(n)&&n>=0}function vv(n,e){if(!n())throw new Error(`Assertion failed: ${e}`)}function $p(n){return n==null}const pB=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(n){let e,t,r;for(e=0,t=this.countRows();e<t;e++)if(r=this.getDataAtCell(e,n),Bn(r)===!1)return!1;return!0},isEmptyRow(n){let e,t,r,i;for(e=0,t=this.countCols();e<t;e++)if(r=this.getDataAtCell(n,e),Bn(r)===!1)return typeof r=="object"?(i=this.getCellMeta(n,e),Q0(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function LL(n,e,t){return(e=j7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function j7(n){var e=z7(n,"string");return typeof e=="symbol"?e:e+""}function z7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Y7(){return class{}}class K7{constructor(e){LL(this,"metaCtor",Y7()),LL(this,"meta",void 0),this.meta=this.metaCtor.prototype,er(this.meta,pB()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;er(this.meta,e),YC(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}function q7(n,e,t){return(e=X7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function X7(n){var e=Q7(n,"string");return typeof e=="symbol"?e:e+""}function Q7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Z7{constructor(e){q7(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){er(this.meta,e),YC(this.meta,e,e)}}function Gp(n,e,t){return(e=J7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function J7(n){var e=eQ(n,"string");return typeof e=="symbol"?e:e+""}function eQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class cy{constructor(e){Gp(this,"valueFactory",void 0),Gp(this,"data",[]),Gp(this,"index",[]),Gp(this,"holes",new Set),this.valueFactory=e}obtain(e){vv(()=>wv(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let r;if(t>=0)r=this.data[t],r===void 0&&(r=this.valueFactory(e),this.data[t]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;vv(()=>wv(e)||$p(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let o=0;o<t;o++)r.push(i+o),this.data.push(void 0);const s=$p(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...r,...this.index.slice(s)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;vv(()=>wv(e)||$p(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice($p(e)?this.index.length-t:e,t);for(let i=0;i<r.length;i++){const s=r[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return du(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let t=0;return{next:()=>{if(t<e.length){const r=e[t];return t+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function DL(n,e,t){return(e=tQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tQ(n){var e=nQ(n,"string");return typeof e=="symbol"?e:e+""}function nQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const rQ=["data","width"];class iQ{constructor(e){DL(this,"globalMeta",void 0),DL(this,"metas",new cy(()=>this._createMeta())),this.globalMeta=e,this.metas=new cy(()=>this._createMeta())}updateMeta(e,t){const r=this.getMeta(e);er(r,t),YC(r,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return G7(this.globalMeta.getMetaConstructor(),rQ).prototype}}function HL(n,e,t){return(e=sQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sQ(n){var e=oQ(n,"string");return typeof e=="symbol"?e:e+""}function oQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class aQ{constructor(e){HL(this,"columnMeta",void 0),HL(this,"metas",new cy(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,r){const i=this.getMeta(e,t);er(i,r),YC(i,r)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,t)}getMeta(e,t,r){const i=this.metas.obtain(e).obtain(t);return r===void 0?i:i[r]}setMeta(e,t,r,i){var s;const o=this.metas.obtain(e).obtain(t);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(r),o[r]=i}removeMeta(e,t,r){const i=this.metas.obtain(e).obtain(t);delete i[r]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let r=0;r<t.length;r++)Oe(t[r])&&e.push(...t[r].values());return e}getMetasAtRow(e){vv(()=>wv(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new cy(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class wB{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new K7(e),this.tableMeta=new Z7(this.globalMeta),this.columnMeta=new iQ(this.globalMeta),this.cellMeta=new aQ(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,r){let{visualRow:i,visualColumn:s}=r;const o=this.cellMeta.getMeta(e,t);return o.visualRow=i,o.visualCol=s,o.row=e,o.col=t,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,t,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,r)}setCellMeta(e,t,r,i){this.cellMeta.setMeta(e,t,r,i)}updateCellMeta(e,t,r){this.cellMeta.updateMeta(e,t,r)}removeCellMeta(e,t,r){this.cellMeta.removeMeta(e,t,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Zt(wB,Hr);function FL(n,e,t,r){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:h}=r,c=po(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":un(d.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),n=i.runHooks(`before${c}`,n,h,l);const f=new cd(i,n,u);if(e(f),typeof n=="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null){const m=f.getSchema();n=[];let p,v=0,y=0;for(v=0,y=d.startRows;v<y;v++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)p=ui(m),n.push(p);else if(i.dataType==="array")p=ui(m[0]),n.push(p);else{p=[];for(let C=0,R=d.startCols;C<R;C++)p.push(null);n.push(p)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof n} given)`);Array.isArray(n[0])&&(i.dataType="array"),d.data=n,f.dataSource=n,o.data=n,o.dataType=i.dataType,o.colToProp=f.colToProp.bind(f),o.propToCol=f.propToCol.bind(f),o.countCachedColumns=f.countCachedColumns.bind(f),t(f),i.runHooks(`after${c}`,n,h,l),h||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Xe(i.rootElement,[QV(-1),PC(i.countCols()+(i.view?i.countRowHeaders():0))])}function kL(n,e,t){return(e=lQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function lQ(n){var e=uQ(n,"string");return typeof e=="symbol"?e:e+""}function uQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class hQ{constructor(e){kL(this,"metaManager",void 0),kL(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),Ae.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:r,col:i}=e;if((t=this.metaSyncMemo.get(r))!==null&&t!==void 0&&t.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const u=_n(e,"type")?e.type:null;let h=un(e.cells)?e.cells(r,i,l):null;if(u)if(h){var c;h.type=(c=h.type)!==null&&c!==void 0?c:u}else h={type:u};h&&this.metaManager.updateCellMeta(r,i,h),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function cQ(n,e,t){dQ(n,e),e.set(n,t)}function dQ(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xb(n,e,t){return(e=fQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function fQ(n){var e=mQ(n,"string");return typeof e=="symbol"?e:e+""}function mQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function gQ(n,e){return n.get(pQ(n,e))}function pQ(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var VL=new WeakMap;class wQ{constructor(e){xb(this,"metaManager",void 0),xb(this,"usageTracker",new Set),xb(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),cQ(this,VL,(t,r,i)=>{if(!i)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{initOnly:r,target:i,onChange:s}=e,o=typeof i=="string",a=o?i:t,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(t,l,s),o&&this.installPropWatcher(i,l,s)):r&&(this.installPropWatcher(t,l,gQ(VL,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,s,o),this[t]=s},enumerable:!0,configurable:!0})}}const vB="gridDefault",yu="editorManager.handlingEditor",vQ={name:"editorCloseAndSave",callback(n){n._getEditorManager().closeEditorAndSaveChanges()}},yQ="hooksRefRegisterer",yB={_hooksStorage:Object.create(null),addHook(n,e){return this._hooksStorage[n]||(this._hooksStorage[n]=[]),this.hot.addHook(n,e),this._hooksStorage[n].push(e),this},removeHooksByKey(n){D(this._hooksStorage[n]||[],e=>{this.hot.removeHook(n,e)})},clearHooks(){gt(this._hooksStorage,(n,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};pl(yB,"MIXIN_NAME",yQ,{writable:!1,enumerable:!1});function $s(n,e,t){return(e=CQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function CQ(n){var e=SQ(n,"string");return typeof e=="symbol"?e:e+""}function SQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const RQ="base",kn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Jd{static get EDITOR_TYPE(){return RQ}constructor(e){$s(this,"hot",void 0),$s(this,"state",kn.VIRGIN),$s(this,"_opened",!1),$s(this,"_fullEditMode",!1),$s(this,"_closeCallback",null),$s(this,"TD",null),$s(this,"row",null),$s(this,"col",null),$s(this,"prop",null),$s(this,"originalValue",null),$s(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,r,i,s,o){this.TD=i,this.row=e,this.col=t,this.prop=r,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:kn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let r,i,s,o;if(t){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),s=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[r,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,s,o,"edit")}beginEditing(e,t){if(this.state!==kn.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,s)),this.state=kn.EDITING,this.isInFullEditMode()){const o=typeof e=="string"?e:Kn(this.originalValue);this.setValue(o)}this.open(t),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,r){let i;if(r){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),r(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===kn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===kn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=kn.WAITING,this.saveValue(i,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=kn.FINISHED,this.discardEditor(o)}):(this.state=kn.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=kn.FINISHED,this.discardEditor()}discardEditor(e){this.state===kn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=kn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=kn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===kn.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=Sr(t),a=cn(t),l=Sr(this.hot.rootElement),u=cn(this.hot.rootElement),h=r.topOverlay.holder,c=r.inlineStartOverlay.holder,d=h!==s?h.scrollTop:0,f=c!==s?c.scrollLeft:0,m=s.innerWidth-l.left-u,{wtTable:p}=(e=r.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,v=p.name,y=["master","inline_start"].includes(v)?d:0,C=["master","top","bottom"].includes(v)?f:0,R=o.top===l.top?0:1;let A=o.top-l.top-R-y,I=0;this.hot.isRtl()?I=s.innerWidth-o.left-a-m-1+C:I=o.left-l.left-1-C,["top","top_inline_start_corner"].includes(v)&&(A+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(v)&&(I+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const H=this.hot.hasColHeaders(),k=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),W=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),G=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(H&&k<=0||k===G)&&(A+=1),W<=0&&(I+=1);const q=i.rowsRenderCalculator.startPosition,J=i.columnsRenderCalculator.startPosition,re=Math.abs(r.inlineStartOverlay.getScrollPosition()),ie=r.topOverlay.getScrollPosition(),ae=Rr(this.hot.rootDocument);let Ke=t.offsetTop;if(["inline_start","master"].includes(v)&&(Ke+=q-ie),["bottom","bottom_inline_start_corner"].includes(v)){const{wtViewport:ne,wtTable:he}=r.bottomOverlay.clone;Ke+=ne.getWorkspaceHeight()-he.getHeight()-ae}let xe=t.offsetLeft;this.hot.isRtl()?(xe>=0?xe=p.getWidth()-t.offsetLeft:xe=Math.abs(xe),xe+=J-re-a):["top","master","bottom"].includes(v)&&(xe+=J-re);const Se=ul(this.TD,this.hot.rootWindow),ve=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",He=parseInt(Se[ve],10)>0?0:1,w=parseInt(Se.borderTopWidth,10)>0?0:1,S=cn(t)+He,b=Xn(t)+w,x=g4(h)?ae:0,L=p4(c)?ae:0,$=this.hot.view.maximumVisibleElementWidth(xe)-x+He,ee=Math.max(this.hot.view.maximumVisibleElementHeight(Ke)-L+w,23);return{top:A,start:I,height:b,maxHeight:ee,width:S,maxWidth:$}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}Zt(Jd,yB);const EQ={name:"editorCloseAndSaveByArrowKeys",callback(n,e,t){const r=n._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===kn.EDITING||(r.closeEditorAndSaveChanges(),n.getSelected()&&(t.includes("arrowdown")?n.selection.transformStart(1,0):t.includes("arrowup")?n.selection.transformStart(-1,0):t.includes("arrowleft")?n.selection.transformStart(0,-1*n.getDirectionFactor()):t.includes("arrowright")&&n.selection.transformStart(0,n.getDirectionFactor())),e.preventDefault())}},bQ={name:"editorCloseAndSaveByEnter",callback(n,e){const t=n._getEditorManager();t.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),t.moveSelectionAfterEnter(e)}},TQ={name:"editorCloseWithoutSaving",callback(n){const e=n._getEditorManager();e.closeEditorAndRestoreOriginalValue(n.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},AQ={name:"editorFastOpen",callback(n,e){const{highlight:t}=n.getSelectedRangeLast();t.isHeader()||n._getEditorManager().openEditor(null,e,!0)}},NQ={name:"editorOpen",callback(n,e,t){const r=n._getEditorManager(),i=n.getSelectedRangeLast(),{highlight:s}=i;if(n.selection.isMultiple()&&!i.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0){const o=n.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;t.includes("shift")?n.selection.transformFocus(-a.row,-a.col):n.selection.transformFocus(a.row,a.col);return}s.isHeader()||(n.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),Ro(e))}};function IQ(){return[vQ,EQ,bQ,TQ,AQ,NQ]}const MQ={name:"extendCellsSelectionDown",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByColumnHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(1,0)}},OQ={name:"extendCellsSelectionDownByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.min(e.row+n.countVisibleRows(),n.countRows()-1),r=n.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(r!==null){const i=n._createCellCoords(r,e.col),s=e.row-n.view.getFirstFullyVisibleRow(),o=Math.min(i.row-s,n.countRows()-1);n.selection.setRangeEnd(i),n.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},_Q={name:"extendCellsSelectionLeft",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,-1*n.getDirectionFactor())}},xQ={name:"extendCellsSelectionRight",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,n.getDirectionFactor())}},PQ={name:"extendCellsSelectionToColumns",callback(n){const{highlight:e,from:t,to:r}=n.getSelectedRangeLast();n.selection.isSelectedByRowHeader()?n.selection.selectAll(!0,!0):n.selectColumns(t.col,r.col,e)}},LQ={name:"extendCellsSelectionToMostBottom",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast(),o=r.isHeader()&&n.selection.isSelectedByRowHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(n.countRows()-1,-1),l=i.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,s.col))}}},DQ={name:"extendCellsSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast();if(!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&r.isCell()){const o=t.getNearestNotHiddenIndex(n.countCols()-1,-1),a=i.clone();a.col=r.col,e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(n._createCellCoords(s.row,o))}}},HQ={name:"extendCellsSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast();if(!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&r.isCell()){const o=parseInt(n.getSettings().fixedColumnsStart,10),a=t.getNearestNotHiddenIndex(o,1),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(n._createCellCoords(s.row,a))}}},FQ={name:"extendCellsSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast(),o=r.isHeader()&&n.selection.isSelectedByColumnHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(s.row,a))}}},kQ={name:"extendCellsSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast(),o=r.isHeader()&&n.selection.isSelectedByColumnHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(s.row,a))}}},VQ={name:"extendCellsSelectionToMostTop",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast(),o=r.isHeader()&&n.selection.isSelectedByRowHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,s.col))}}},UQ={name:"extendCellsSelectionToRows",callback(n){const{highlight:e,from:t,to:r}=n.getSelectedRangeLast();n.selection.isSelectedByColumnHeader()?n.selection.selectAll(!0,!0):n.selectRows(t.row,r.row,e)}},BQ={name:"extendCellsSelectionUp",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByColumnHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(-1,0)}},WQ={name:"extendCellsSelectionUpByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.max(e.row-n.countVisibleRows(),0),r=n.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(r!==null){const i=n._createCellCoords(r,e.col),s=e.row-n.view.getFirstFullyVisibleRow(),o=Math.max(i.row-s,0);n.selection.setRangeEnd(i),n.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}};function $Q(){return[MQ,OQ,_Q,xQ,PQ,LQ,DQ,HQ,FQ,kQ,VQ,UQ,BQ,WQ]}const GQ={name:"moveCellSelectionDown",callback(n){let{selection:e}=n;e.transformStart(1,0)}},jQ={name:"moveCellSelectionDownByViewportHeight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:r}=n.getSelectedRangeLast().highlight;let i=n.countVisibleRows()+t;r===n.countRows()-1?i=1:r+i>n.countRows()&&(i=n.countRows()-r-1),n.selection.transformStart(i,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}},zQ={name:"moveCellSelectionInlineEnd",callback(n,e){const t=n.getSettings(),r=n.getSelectedRangeLast(),i=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;n.selection.isMultiple()&&!r.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0?n.selection.transformFocus(-i.row,-i.col):n.selection.transformStart(-i.row,-i.col)}},YQ={name:"moveCellSelectionInlineStart",callback(n,e){const t=n.getSettings(),r=n.getSelectedRangeLast(),i=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;n.selection.isMultiple()&&!r.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0?n.selection.transformFocus(i.row,i.col):n.selection.transformStart(i.row,i.col)}},KQ={name:"moveCellSelectionLeft",callback(n){n.selection.transformStart(0,-1*n.getDirectionFactor())}},qQ={name:"moveCellSelectionRight",callback(n){n.selection.transformStart(0,n.getDirectionFactor())}},XQ={name:"moveCellSelectionToMostBottom",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(n.countRows()-1,-1);t===null&&(t=-1),n.selection.setRangeStart(n._createCellCoords(t,e))}},QQ={name:"moveCellSelectionToMostBottomInlineEnd",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:r}=n,i=parseInt(n.getSettings().fixedRowsBottom,10),s=t.getNearestNotHiddenIndex(n.countRows()-i-1,-1),o=r.getNearestNotHiddenIndex(n.countCols()-1,-1);e.setRangeStart(n._createCellCoords(s,o))}},ZQ={name:"moveCellSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n;e.setRangeStart(n._createCellCoords(n.getSelectedRangeLast().highlight.row,t.getNearestNotHiddenIndex(n.countCols()-1,-1)))}},JQ={name:"moveCellSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,r=parseInt(n.getSettings().fixedColumnsStart,10),i=n.getSelectedRangeLast().highlight.row,s=t.getNearestNotHiddenIndex(r,1);e.setRangeStart(n._createCellCoords(i,s))}},eZ={name:"moveCellSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,r=n.getSelectedRangeLast().highlight.row;let i=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]);i===null&&(i=n.isRtl()?-1:-n.countRowHeaders()),e.setRangeStart(n._createCellCoords(r,i))}},tZ={name:"moveCellSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{row:r}=n.getSelectedRangeLast().highlight;let i=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]);i===null&&(i=n.isRtl()?-n.countRowHeaders():-1),e.setRangeStart(n._createCellCoords(r,i))}},nZ={name:"moveCellSelectionToMostTop",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(0,1);t===null&&(t=-n.countColHeaders()),n.selection.setRangeStart(n._createCellCoords(t,e))}},rZ={name:"moveCellSelectionToMostTopInlineStart",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:r}=n,i=parseInt(n.getSettings().fixedRowsTop,10),s=parseInt(n.getSettings().fixedColumnsStart,10),o=t.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(s,1);e.setRangeStart(n._createCellCoords(o,a))}},iZ={name:"moveCellSelectionUp",callback(n){let{selection:e}=n;e.transformStart(-1,0)}},sZ={name:"moveCellSelectionUpByViewportHight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:r}=n.getSelectedRangeLast().highlight;let i=-(n.countVisibleRows()+t);r===-t?i=-1:r+i<t&&(i=-(r+t)),n.selection.transformStart(i,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}};function oZ(){return[GQ,jQ,zQ,YQ,KQ,qQ,XQ,QQ,ZQ,JQ,eZ,tZ,nZ,rZ,iZ,sZ]}const aZ={name:"emptySelectedCells",callback(n){n.emptySelectedCells(),n._getEditorManager().prepareEditor()}},lZ={name:"scrollToFocusedCell",callback(n){const{highlight:e}=n.getSelectedRangeLast(),t=n.view.getFirstFullyVisibleRow()-1,r=n.view.getFirstFullyVisibleColumn()-1,i=n.view.getLastFullyVisibleRow()+1,s=n.view.getLastFullyVisibleColumn()+1,o=n._createCellCoords(t,r),a=n._createCellCoords(i,s);if(!n._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const h=Math.floor(n.countVisibleCols()/2);u.col=Math.max(e.col-h,0)}if(e.row>=0){const h=Math.floor(n.countVisibleRows()/2);u.row=Math.max(e.row-h,0)}n.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},uZ={name:"selectAllCells",callback(n){n.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},hZ={name:"selectAllCellsAndHeaders",callback(n){n.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},cZ={name:"populateSelectedCellsData",callback(n){const e=n.getSelectedRange(),{row:t,col:r}=e[e.length-1].highlight.normalize(),i=n.getDataAtCell(t,r),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==t||l!==r)){const{readOnly:u}=n.getCellMeta(a,l);u||s.set(`${a}x${l}`,[a,l,i])}});n.setDataAtCell(Array.from(s.values()))}},dZ=[...IQ(),...$Q(),...oZ(),aZ,lZ,uZ,hZ,cZ];function CB(n){const e={};return dZ.forEach(t=>{let{name:r,callback:i}=t;e[r]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i(n,...o)}}),e}function fZ(n){const e=n.getShortcutManager().addContext("editor"),t=CB(n),r={group:yu};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>t.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>t.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:n.getShortcutManager().getContext("grid"),callback:(i,s)=>t.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>t.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>t.editorCloseWithoutSaving()}],r)}function mZ(n){const e=n.getShortcutManager().addContext("grid"),t=CB(n),r={runOnlyIf:()=>{const{navigableHeaders:i}=n.getSettings();return Oe(n.getSelected())&&(i||!i&&n.countRenderedRows()>0&&n.countRenderedCols()>0)},group:vB};e.addShortcuts([{keys:[["F2"]],callback:i=>t.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>t.editorOpen(i,s)},{keys:[["Backspace"],["Delete"]],callback:()=>t.emptySelectedCells()}],{group:yu,runOnlyIf:()=>Oe(n.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>t.selectAllCells(),runOnlyIf:()=>{var i;return!((i=n.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=n.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>t.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>t.populateSelectedCellsData(),runOnlyIf:()=>{var i,s;return!((i=n.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((s=n.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>t.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>t.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>t.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>t.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>t.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>t.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>t.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>t.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>t.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>t.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>t.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>t.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>t.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>t.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>t.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>t.scrollToFocusedCell()}],r)}function gZ(n){[mZ,fZ].forEach(e=>e(n))}function pZ(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=n.rootElement,r=UL(n),i=UL(n);return r.addEventListener("focus",()=>e?.onFocusFromTop()),i.addEventListener("focus",()=>e?.onFocusFromBottom()),t.firstChild.before(r),t.lastChild.after(i),{activate(){n._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){n._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function UL(n){const t=n.rootDocument.createElement("input");return t.type="text",t.classList.add("htFocusCatcher"),n.getSettings().ariaTags&&Xe(t,[oa(),ic()]),t}function wZ(n){const e=vZ(n);let t;const{activate:r,deactivate:i}=pZ(n,{onFocusFromTop(){var c;const d=(c=e(t))!==null&&c!==void 0?c:QA(n);d&&(n.runHooks("modifyFocusOnTabNavigation","from_above",d),n.selectCell(d.row,d.col)),n.listen()},onFocusFromBottom(){var c;const d=(c=e(t))!==null&&c!==void 0?c:ZA(n);d&&(n.runHooks("modifyFocusOnTabNavigation","from_below",d),n.selectCell(d.row,d.col)),n.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;n.addHook("afterListen",()=>i()),n.addHook("afterUnlisten",()=>r()),n.addHook("afterSelection",(c,d,f,m,p)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,p.value=!0),o){var v;t=(v=n.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight}}),n.addHook("beforeRowWrap",(c,d,f)=>{s.wrapped=!0,s.flipped=f});function u(){s.wrapped=!1,s.flipped=!1,n.deselectCell(),n.unlisten()}const h={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:vB,group:"focusCatcher"};n.getShortcutManager().getContext("grid").addShortcuts([{...h,callback:()=>{const{tabNavigation:c}=n.getSettings();a=!0,n.getSelectedRangeLast()&&!c&&(o=!1),c||(l=!0)},position:"before"},{...h,callback:c=>{const{tabNavigation:d,autoWrapRow:f}=n.getSettings();if(a=!1,o=!0,!d||!n.selection.isSelected()||f&&s.wrapped&&s.flipped||!f&&s.wrapped)return f&&s.wrapped&&s.flipped&&(t=c.shiftKey?QA(n):ZA(n)),u(),!1;c.preventDefault()},position:"after"}])}function QA(n){const{rowIndexMapper:e,columnIndexMapper:t}=n,{navigableHeaders:r}=n.getSettings();let i=r&&n.countColHeaders()>0?-n.countColHeaders():0,s=r&&n.countRowHeaders()>0?-n.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=t.getVisualFromRenderableIndex(s)),i===null||s===null?null:n._createCellCoords(i,s)}function ZA(n){var e,t;const{rowIndexMapper:r,columnIndexMapper:i}=n,{navigableHeaders:s}=n.getSettings();let o=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(o<0){if(!s||n.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||n.countColHeaders()===0)return null;a=-1}return n._createCellCoords((e=r.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(t=i.getVisualFromRenderableIndex(a))!==null&&t!==void 0?t:a)}function vZ(n){return e=>{if(!e)return null;const t=QA(n),r=ZA(n);return e.col<t.col&&(e.col=t.col),e.col>r.col&&(e.col=r.col),e.row<t.row&&(e.row=t.row),e.row>r.row&&(e.row=r.row),e}}function yZ(n){return e=>{let{col:t}=e;n.scrollViewportTo({col:t})}}function CZ(){return()=>{}}function SZ(n){return e=>{n.scrollViewportTo(e.toObject())}}function RZ(n){return e=>{n.scrollViewportTo(e.toObject())}}function EZ(n){return e=>{n.scrollViewportTo(e.toObject())}}function bZ(n){return e=>{let{row:t}=e;n.scrollViewportTo({row:t})}}function TZ(n){return e=>{const t=n.selection.getSelectionSource(),{row:r,col:i}=e;if(r<0&&i>=0)n.scrollViewportTo({col:i});else if(i<0&&r>=0)n.scrollViewportTo({row:r});else{if(t==="mouse"&&(i===n.view.getLastPartiallyVisibleColumn()||r===n.view.getLastPartiallyVisibleRow()))return;n.scrollViewportTo({row:r,col:i})}}}function AZ(n){const{selection:e}=n;let t=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){t=!0},scrollTo(i){var s;if(t||r){t=!1;return}let o;e.isFocusSelectionChanged()?o=SZ(n):e.isSelectedByCorner()?o=CZ():e.isSelectedByRowHeader()?o=bZ(n):e.isSelectedByColumnHeader()?o=yZ(n):e.getSelectedRange().size()===1&&e.isMultiple()?o=RZ(n):e.getSelectedRange().size()===1&&!e.isMultiple()?o=TZ(n):e.getSelectedRange().size()>1&&(o=EZ(n)),(s=o)===null||s===void 0||s(i)}}}const BL=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),jp=n=>n.map(e=>{const t=e.toLowerCase();return BL.has(t)?BL.get(t):t}).sort().join("+"),NZ=n=>n.split("+"),WL=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Pb=n=>{let{which:e,key:t}=n;if(WL.has(e))return WL.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:t.toLowerCase()},SB=Symbol("shortcut-context");function RB(n){return mt(n)&&n.__kindOf===SB}const IZ=n=>{const e=FC({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${n}" context.`}),t=function(){let{keys:l,callback:u,group:h,runOnlyIf:c=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:m=!1,relativeToGroup:p,position:v,forwardToContext:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(hn(h))throw new Error("You need to define the shortcut's group.");if(un(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(zt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const C={callback:u,group:h,runOnlyIf:c,captureCtrl:d,preventDefault:f,stopPropagation:m};Oe(p)&&(C.relativeToGroup=p,C.position=v),RB(y)&&(C.forwardToContext=y),l.forEach(R=>{const A=jp(R);if(e.hasItem(A)){const H=e.getItem(A);let k=H.findIndex(W=>W.group===p);k!==-1?v==="before"?k-=1:k+=1:k=H.length,H.splice(k,0,C)}else e.addItem(A,[C])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(h=>{gt(u,(c,d)=>{Object.prototype.hasOwnProperty.call(h,d)===!1&&(h[d]=u[d])}),t(h)})},i=l=>{const u=jp(l);e.removeItem(u)};return{__kindOf:SB,addShortcut:t,addShortcuts:r,getShortcuts:l=>{const u=jp(l),h=e.getItem(u);return Oe(h)?h.slice():[]},hasShortcut:l=>{const u=jp(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(h=>{let[c,d]=h;const f=d.filter(m=>m.group!==l);f.length===0?i(NZ(c)):(d.length=0,d.push(...f))})}}};function MZ(){const n=new Set;return{press(e){n.add(e)},release(e){n.delete(e)},releaseAll(){n.clear()},isPressed(e){return n.has(e)}}}const OZ=["meta","alt","shift","control"],Of=MZ(),_f=[];let zp=0;function _Z(n,e,t,r,i){const s=f=>OZ.includes(f),o=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=[];return f.altKey&&p.push("alt"),m&&(f.ctrlKey||f.metaKey)?p.push("control/meta"):(f.ctrlKey&&p.push("control"),f.metaKey&&p.push("meta")),f.shiftKey&&p.push("shift"),p},a=f=>{if(e(f)===!1)return;const m=t(f);if(f.keyCode===229||m===!1||Sh(f))return;const p=Pb(f);let v=[];s(p)||(v=o(f));const y=[p].concat(v);!i(f,y)&&(BA()&&v.includes("meta")||!BA()&&v.includes("control"))&&i(f,[p].concat(o(f,!0))),r(f)},l=f=>{if(f.key){const m=Pb(f);s(m)&&Of.press(m)}},u=f=>{if(f.key){const m=Pb(f);s(m)&&Of.release(m)}},h=()=>{Of.releaseAll()};return{mount:()=>{let f=n;for(zp+=1;f;)zp===1&&(f.document.documentElement.addEventListener("keydown",l),_f.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),_f.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",h),f=Pd(f)},unmount:()=>{let f=n;for(zp-=1;f;){if(zp===0){for(let m=0;m<_f.length;m++){const{event:p,listener:v}=_f[m];f.document.documentElement.removeEventListener(p,v)}_f.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",h),f=Pd(f)}},isPressed:f=>Of.isPressed(f),releasePressedKeys:()=>Of.releaseAll()}}const xZ=n=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:r,afterKeyDown:i}=n;const s=FC({errorIdExists:m=>`The "${m}" context name is already registered.`});let o="grid";const a=m=>{const p=IZ(m);return s.addItem(m,p),p},l=()=>o,u=m=>s.getItem(m),h=m=>{if(!s.hasItem(m))throw new Error(zt`You've tried to activate the "${m}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=m};let c=!1;const d=function(m,p){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const y=RB(v)?v:u(v);let C=!1;if(!y.hasShortcut(p))return C;const R=y.getShortcuts(p);for(let A=0;A<R.length;A++){const{callback:I,runOnlyIf:H,preventDefault:k,stopPropagation:W,captureCtrl:z,forwardToContext:G}=R[A];if(H(m)===!0){if(c=z,C=I(m,p)===!1,c=!1,k&&m.preventDefault(),W&&(Ro(m),m.stopPropagation()),C)break;G&&d(m,p,G)}}return C},f=_Z(e,t,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:h,isCtrlPressed:()=>!c&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};let Lb=null;const Db=new Map;function EB(n,e){var t,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const o=new wo(s);let a,l,u,h,c,d,f=!0;p8(i)&&g8(this),this.rootElement=n,this.rootDocument=n.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=(t=e?.layoutDirection)!==null&&t!==void 0?t:"inherit",p=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return p==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=u7(e.language);const v=new wB(s,e,[hQ,wQ]),y=v.getTableMeta(),C=v.getGlobalMeta(),R=FC();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,n.insertBefore(this.container,n.firstChild),gv(this)&&D6(e.licenseKey,n),this.guid=`ht_${jV()}`,Db.set(this.guid,this),this.columnIndexMapper=new KA,this.rowIndexMapper=new KA,this.columnIndexMapper.addLocalHook("indexesSequenceChange",w=>{s.runHooks("afterColumnSequenceChange",w)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",w=>{s.runHooks("afterRowSequenceChange",w)}),l=new I8(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const A=w=>{const{row:S,col:b}=w;return s._createCellCoords(S>=0?s.rowIndexMapper.getRenderableFromVisualIndex(S):S,b>=0?s.columnIndexMapper.getRenderableFromVisualIndex(b):b)},I=w=>{const{row:S,col:b}=w;return s._createCellCoords(S>=0?s.rowIndexMapper.getVisualFromRenderableIndex(S):S,b>=0?s.columnIndexMapper.getVisualFromRenderableIndex(b):b)},H=(w,S)=>{const b=S>w?1:-1,x=Math.min(w,S),L=Math.max(w,S),$=s.rowIndexMapper.getNearestNotHiddenIndex(w,b);return $===null||b===1&&$>L||b===-1&&$<x?null:$>=0?s.rowIndexMapper.getRenderableFromVisualIndex($):$},k=(w,S)=>{const b=S>w?1:-1,x=Math.min(w,S),L=Math.max(w,S),$=s.columnIndexMapper.getNearestNotHiddenIndex(w,b);return $===null||b===1&&$>L||b===-1&&$<x?null:$>=0?s.columnIndexMapper.getRenderableFromVisualIndex($):$};let W=new mB(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:w=>a.propToCol(w),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(w,S)=>s._createCellCoords(w,S),createCellRange:(w,S,b)=>s._createCellRange(w,S,b),visualToRenderableCoords:A,renderableToVisualCoords:I,findFirstNonHiddenRenderableRow:H,findFirstNonHiddenRenderableColumn:k,isDisabledCellSelection:(w,S)=>w<0||S<0?s.getSettings().disableVisualSelection:s.getCellMeta(w,S).disableVisualSelection});this.selection=W;const z=w=>{let{hiddenIndexesChanged:S}=w;S&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",z),this.rowIndexMapper.addLocalHook("cacheUpdated",z),this.selection.addLocalHook("afterSetRangeEnd",(w,S)=>{const b=lo(!1),x=this.selection.getSelectedRange(),{from:L,to:$}=x.current(),ee=x.size()-1;this.runHooks("afterSelection",L.row,L.col,$.row,$.col,b,ee),this.runHooks("afterSelectionByProp",L.row,s.colToProp(L.col),$.row,s.colToProp($.col),b,ee),S&&(!b.isTouched()||b.isTouched()&&!b.value)&&d.scrollTo(w);const ne=W.isSelectedByRowHeader(),he=W.isSelectedByColumnHeader();ne&&he?oe(this.rootElement,["ht__selection--rows","ht__selection--columns"]):ne?(rt(this.rootElement,"ht__selection--columns"),oe(this.rootElement,"ht__selection--rows")):he?(rt(this.rootElement,"ht__selection--rows"),oe(this.rootElement,"ht__selection--columns")):rt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),W.getSelectionSource()!=="shift"&&h.closeEditor(null),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",w=>{this.runHooks("beforeSelectionFocusSet",w.row,w.col)}),this.selection.addLocalHook("afterSetFocus",w=>{const S=lo(!1);this.runHooks("afterSelectionFocusSet",w.row,w.col,S),(!S.isTouched()||S.isTouched()&&!S.value)&&d.scrollTo(w),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",w=>{const S=w.length-1,{from:b,to:x}=w[S];this.runHooks("afterSelectionEnd",b.row,b.col,x.row,x.col,S),this.runHooks("afterSelectionEndByProp",b.row,s.colToProp(b.col),x.row,s.colToProp(x.col),S)}),this.selection.addLocalHook("afterIsMultipleSelection",w=>{const S=this.runHooks("afterIsMultipleSelection",w.value);w.value&&(w.value=S)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),rt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("beforeSetRangeStart",...S)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("beforeSetRangeStartOnly",...S)}).addLocalHook("beforeSetRangeEnd",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("beforeSetRangeEnd",...S)}).addLocalHook("beforeSelectColumns",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("beforeSelectColumns",...S)}).addLocalHook("afterSelectColumns",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("afterSelectColumns",...S)}).addLocalHook("beforeSelectRows",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("beforeSelectRows",...S)}).addLocalHook("afterSelectRows",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("afterSelectRows",...S)}).addLocalHook("beforeModifyTransformStart",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("modifyTransformStart",...S)}).addLocalHook("afterModifyTransformStart",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("afterModifyTransformStart",...S)}).addLocalHook("beforeModifyTransformFocus",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("modifyTransformFocus",...S)}).addLocalHook("afterModifyTransformFocus",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("afterModifyTransformFocus",...S)}).addLocalHook("beforeModifyTransformEnd",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("modifyTransformEnd",...S)}).addLocalHook("afterModifyTransformEnd",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("afterModifyTransformEnd",...S)}).addLocalHook("beforeRowWrap",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("beforeRowWrap",...S)}).addLocalHook("beforeColumnWrap",function(){for(var w=arguments.length,S=new Array(w),b=0;b<w;b++)S[b]=arguments[b];return r.runHooks("beforeColumnWrap",...S)}).addLocalHook("insertRowRequire",w=>this.alter("insert_row_above",w,1,"auto")).addLocalHook("insertColRequire",w=>this.alter("insert_col_start",w,1,"auto")),u={alter(w,S){var b,x;let L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,$=arguments.length>3?arguments[3]:void 0,ee=arguments.length>4?arguments[4]:void 0;const ne=he=>{if(he.length===0)return[];const we=[...he];return we.sort(($e,Be)=>{let[Q]=$e,[Je]=Be;return Q===Je?0:Q>Je?1:-1}),hi(we,($e,Be)=>{let[Q,Je]=Be;const nt=$e[$e.length-1],[wt,et]=nt,ke=wt+et;if(Q<=ke){const T=Math.max(Je-(ke-Q),0);nt[1]+=T}else $e.push([Q,Je]);return $e},[we[0]])};switch(w){case"insert_row_below":case"insert_row_above":const he=s.countSourceRows();if(y.maxRows===he)return;const we=w==="insert_row_below"?"below":"above";S=(b=S)!==null&&b!==void 0?b:we==="below"?he:0;const{delta:le,startPhysicalIndex:$e}=a.createRow(S,L,{source:$,mode:we});W.shiftRows(s.toVisualRow($e),le);break;case"insert_col_start":case"insert_col_end":const Be=w==="insert_col_end"?"end":"start";S=(x=S)!==null&&x!==void 0?x:Be==="end"?s.countSourceCols():0;const{delta:Q,startPhysicalIndex:Je}=a.createCol(S,L,{source:$,mode:Be});if(Q){if(Array.isArray(y.colHeaders)){const et=[s.toVisualColumn(Je),0];et.length+=Q,Array.prototype.splice.apply(y.colHeaders,et)}W.shiftColumns(s.toVisualColumn(Je),Q)}break;case"remove_row":const nt=et=>{let ke=0;D(et,T=>{let[O,P]=T;const Y=Bn(O)?s.countRows()-1:Math.max(O-ke,0);if(Number.isInteger(O)&&(O=Math.max(O-ke,0)),!a.removeRow(O,P,$))return;if(W.isSelected()){const{row:K}=s.getSelectedRangeLast().highlight;K>=O&&K<=O+P-1&&h.closeEditor(!0)}const X=s.countRows();X===0?W.deselect():$==="ContextMenu.removeRow"?W.refresh():W.shiftRows(O,-P);const B=y.fixedRowsTop;B>=Y+1&&(y.fixedRowsTop-=Math.min(P,B-Y));const V=y.fixedRowsBottom;V&&Y>=X-V&&(y.fixedRowsBottom-=Math.min(P,V)),ke+=P})};Array.isArray(S)?nt(ne(S)):nt([[S,L]]);break;case"remove_col":const wt=et=>{let ke=0;D(et,T=>{let[O,P]=T;const Y=Bn(O)?s.countCols()-1:Math.max(O-ke,0);let F=s.toPhysicalColumn(Y);if(Number.isInteger(O)&&(O=Math.max(O-ke,0)),!a.removeCol(O,P,$))return;if(W.isSelected()){const{col:K}=s.getSelectedRangeLast().highlight;K>=O&&K<=O+P-1&&h.closeEditor(!0)}s.countCols()===0?W.deselect():$==="ContextMenu.removeColumn"?W.refresh():W.shiftColumns(O,-P);const V=y.fixedColumnsStart;V>=Y+1&&(y.fixedColumnsStart-=Math.min(P,V-Y)),Array.isArray(y.colHeaders)&&(typeof F>"u"&&(F=-1),y.colHeaders.splice(F,P)),ke+=P})};Array.isArray(S)?wt(ne(S)):wt([[S,L]]);break;default:throw new Error(`There is no such action "${w}"`)}s.view.render(),ee||u.adjustRowsAndCols()},adjustRowsAndCols(){const w=y.minRows,S=y.minSpareRows,b=y.minCols,x=y.minSpareCols;if(w){const L=s.countRows();L<w&&a.createRow(L,w-L,{source:"auto"})}if(S){const L=s.countEmptyRows(!0);if(L<S){const $=S-L,ee=Math.min($,y.maxRows-s.countSourceRows());a.createRow(s.countRows(),ee,{source:"auto"})}}{let L;(b||x)&&(L=s.countEmptyCols(!0));let $=s.countCols();if(b&&!y.columns&&$<b){const ee=b-$;L+=ee,a.createCol($,ee,{source:"auto"})}if(x&&!y.columns&&s.dataType==="array"&&L<x){$=s.countCols();const ee=x-L,ne=Math.min(ee,y.maxCols-$);a.createCol($,ne,{source:"auto"})}}s.view&&s.view.adjustElementsSize()},populateFromArray(w,S,b,x,L){let $,ee,ne,he;const we=[],le={},$e=[],Be=w.row,Q=w.col;if(ee=S.length,ee===0)return!1;let Je=0,nt=0;switch(mt(b)&&(Je=b.col-Q+1,nt=b.row-Be+1),L){case"shift_down":const wt=fv(S),et=wt.length,ke=Math.max(et,Je),T=s.getData().slice(Be),O=fv(T).slice(Q,Q+ke);for(ne=0;ne<ke;ne+=1)if(ne<et){for($=0,ee=wt[ne].length;$<nt-ee;$+=1)wt[ne].push(wt[ne][$%ee]);ne<O.length?$e.push(wt[ne].concat(O[ne])):$e.push(wt[ne].concat(new Array(T.length).fill(null)))}else $e.push(wt[ne%et].concat(O[ne]));s.populateFromArray(Be,Q,fv($e));break;case"shift_right":const P=S.length,Y=Math.max(P,nt),F=s.getData().slice(Be).map(Re=>Re.slice(Q));for($=0;$<Y;$+=1)if($<P){for(ne=0,he=S[$].length;ne<Je-he;ne+=1)S[$].push(S[$][ne%he]);if($<F.length)for(let Re=0;Re<F[$].length;Re+=1)S[$].push(F[$][Re]);else S[$].push(...new Array(F[0].length).fill(null))}else S.push(S[$%ee].slice(0,Y).concat(F[$]));s.populateFromArray(Be,Q,S);break;default:le.row=w.row,le.col=w.col;let X=0,B=0,V=!0,K;const j=function(Ve){let ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Rt=S[Ve%S.length];return ot!==null?Rt[ot%Rt.length]:Rt},Z=S.length,me=b?b.row-w.row+1:0;for(b?ee=me:ee=Math.max(Z,me),$=0;$<ee&&!(b&&le.row>b.row&&me>Z||!y.allowInsertRow&&le.row>s.countRows()-1||le.row>=y.maxRows);$++){const Re=$-X,Ve=j(Re).length,ot=b?b.col-w.col+1:0;if(b?he=ot:he=Math.max(Ve,ot),le.col=w.col,K=s.getCellMeta(le.row,le.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&K.skipRowOnPaste){X+=1,le.row+=1,ee+=1;continue}for(B=0,ne=0;ne<he&&!(b&&le.col>b.col&&ot>Ve||!y.allowInsertColumn&&le.col>s.countCols()-1||le.col>=y.maxCols);ne++){if(K=s.getCellMeta(le.row,le.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&K.skipColumnOnPaste){B+=1,le.col+=1,he+=1;continue}if(K.readOnly&&x!=="UndoRedo.undo"){le.col+=1;continue}const Rt=ne-B;let at=j(Re,Rt),qe=s.getDataAtCell(le.row,le.col);if(at!==null&&typeof at=="object")if(Array.isArray(at)&&qe===null&&(qe=[]),qe===null||typeof qe!="object")V=!1;else{const Tt=ig(Array.isArray(qe)?qe:qe[0]||qe),dn=ig(Array.isArray(at)?at:at[0]||at);Q0(Tt,dn)||Array.isArray(Tt)&&Array.isArray(dn)?at=ui(at):V=!1}else qe!==null&&typeof qe=="object"&&(V=!1);V&&we.push([le.row,le.col,at]),V=!0,le.col+=1}le.row+=1}s.setDataAtCell(we,null,null,x||"populateFromArray");break}}};function G(w){const S=nB(w);$M(S)?(s.runHooks("beforeLanguageChange",S),C.language=S,s.runHooks("afterLanguageChange",S)):rB(w)}function q(w,S){const b=w==="className"?s.rootElement:s.table;if(f)oe(b,S);else{let x=[],L=[];C[w]&&(x=Array.isArray(C[w])?C[w]:f1(C[w])),S&&(L=Array.isArray(S)?S:f1(S));const $=d1(x,L),ee=d1(L,x);$.length&&rt(b,$),ee.length&&oe(b,ee)}C[w]=S}this.init=function(){l.setData(y.data),s.runHooks("beforeInit"),(Zl()||pU())&&oe(s.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new C8(this),h=GA.getInstance(s,y,W),d=AZ(s),c=new oX(s),gv(this)&&wZ(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&s.rootElement.offsetParent===null&&w4(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof f=="object"&&(s.runHooks("afterChange",f[0],f[1]),f=!1),s.runHooks("afterInit")};function J(){let w=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,w=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&w===!1&&(w=!0,this.onQueueEmpty(this.valid))}}}function re(w){const S=w.replace(",",".");return isNaN(parseFloat(S))===!1?parseFloat(S):w}function ie(w,S,b){if(!w.length){b();return}const x=s.getActiveEditor(),L=new J;let $=!0;L.onQueueEmpty=()=>{x&&$&&x.cancelChanges(),b()};for(let ee=w.length-1;ee>=0;ee--){const[ne,he,,we]=w[ee],le=a.propToCol(he);let $e;Number.isInteger(le)?$e=s.getCellMeta(ne,le):$e={...Object.getPrototypeOf(y),...y},$e.type==="numeric"&&typeof we=="string"&&vX(we)&&(w[ee][3]=re(we)),s.getCellValidator($e)&&(L.addValidatorToQueue(),s.validateCell(w[ee][3],$e,(function(Be,Q){return function(Je){if(typeof Je!="boolean")throw new Error("Validation error: result is not boolean");Je===!1&&Q.allowInvalid===!1&&($=!1,w.splice(Be,1),Q.valid=!0),L.removeValidatorFormQueue()}})(ee,$e),S))}L.checkIfQueueIsEmpty()}function ae(w,S){for(let x=w.length-1;x>=0;x--){let L=!1;if(w[x]===null){w.splice(x,1);continue}if(!((w[x][2]===null||w[x][2]===void 0)&&(w[x][3]===null||w[x][3]===void 0))){if(y.allowInsertRow)for(;w[x][0]>s.countRows()-1;){const{delta:$}=a.createRow(void 0,void 0,{source:S});if($===0){L=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;a.propToCol(w[x][1])>s.countCols()-1;){const{delta:$}=a.createCol(void 0,void 0,{source:S});if($===0){L=!0;break}}L||a.set(w[x][0],w[x][1],w[x][3])}}const b=w.length>0;if(s.forceFullRender=!0,b){u.adjustRowsAndCols(),s.runHooks("beforeChangeRender",w,S),h.closeEditor(),s.view.render(),h.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",w,S||"edit");const x=s.getActiveEditor();x&&Oe(x.refreshValue)&&x.refreshValue()}else s.view.render()}this._createCellCoords=function(w,S){return s.view._wt.createCellCoords(w,S)},this._createCellRange=function(w,S,b){return s.view._wt.createCellRange(w,S,b)},this.validateCell=function(w,S,b,x){let L=s.getCellValidator(S);function $(ee){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||S.hidden===!0){b(ee);return}const he=S.visualCol,we=S.visualRow,le=s.getCell(we,he,!0);if(le&&le.nodeName!=="TH"){const $e=s.rowIndexMapper.getRenderableFromVisualIndex(we),Be=s.columnIndexMapper.getRenderableFromVisualIndex(he);s.view._wt.getSetting("cellRenderer",$e,Be,le)}b(ee)}x6(L)&&(L=(function(ee){return function(ne,he){he(ee.test(ne))}})(L)),un(L)?(w=s.runHooks("beforeValidate",w,S.visualRow,S.prop,x),s._registerImmediate(()=>{L.call(S,w,ee=>{s&&(ee=s.runHooks("afterValidate",ee,w,S.visualRow,S.prop,x),S.valid=ee,$(ee),s.runHooks("postAfterValidate",ee,w,S.visualRow,S.prop,x))})})):s._registerImmediate(()=>{S.valid=!0,$(S.valid,!1)})};function Ke(w,S,b){return Array.isArray(w)?w:[[w,S,b]]}function xe(w,S){const b=s.getActiveEditor(),x=s.runHooks("beforeChange",w,S||"edit"),L=w.filter($=>$!==null);return x===!1||L.length===0?(b&&b.cancelChanges(),[]):L}this.setDataAtCell=function(w,S,b,x){const L=Ke(w,S,b),$=[];let ee=x,ne,he,we;for(ne=0,he=L.length;ne<he;ne++){if(typeof L[ne]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof L[ne][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");L[ne][1]>=this.countCols()?we=L[ne][1]:we=a.colToProp(L[ne][1]),$.push([L[ne][0],we,l.getAtCell(this.toPhysicalRow(L[ne][0]),L[ne][1]),L[ne][2]])}!ee&&typeof w=="object"&&(ee=S);const le=xe($,x);s.runHooks("afterSetDataAtCell",le,ee),ie(le,ee,()=>{ae(le,ee)})},this.setDataAtRowProp=function(w,S,b,x){const L=Ke(w,S,b),$=[];let ee=x,ne,he;for(ne=0,he=L.length;ne<he;ne++)$.push([L[ne][0],L[ne][1],l.getAtCell(this.toPhysicalRow(L[ne][0]),L[ne][1]),L[ne][2]]);!ee&&typeof w=="object"&&(ee=S);const we=xe($,x);s.runHooks("afterSetDataAtRowProp",we,ee),ie(we,ee,()=>{ae(we,ee)})},this.listen=function(){s&&!s.isListening()&&(Db.forEach(w=>{s!==w&&w.unlisten()}),Lb=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Lb=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Lb===s.guid},this.destroyEditor=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(w),s.view.render(),S&&W.isSelected()&&h.prepareEditor()},this.populateFromArray=function(w,S,b,x,L,$,ee){if(!(typeof b=="object"&&typeof b[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const ne=typeof x=="number"?s._createCellCoords(x,L):null;return u.populateFromArray(s._createCellCoords(w,S),b,ne,$,ee)},this.spliceCol=function(w,S,b){for(var x=arguments.length,L=new Array(x>3?x-3:0),$=3;$<x;$++)L[$-3]=arguments[$];return a.spliceCol(w,S,b,...L)},this.spliceRow=function(w,S,b){for(var x=arguments.length,L=new Array(x>3?x-3:0),$=3;$<x;$++)L[$-3]=arguments[$];return a.spliceRow(w,S,b,...L)},this.getSelected=function(){if(W.isSelected())return bt(W.getSelectedRange(),w=>{let{from:S,to:b}=w;return[S.row,S.col,b.row,b.col]})},this.getSelectedLast=function(){const w=this.getSelected();let S;return w&&w.length>0&&(S=w[w.length-1]),S},this.getSelectedRange=function(){if(W.isSelected())return Array.from(W.getSelectedRange())},this.getSelectedRangeLast=function(){const w=this.getSelectedRange();let S;return w&&w.length>0&&(S=w[w.length-1]),S},this.emptySelectedCells=function(w){if(!W.isSelected()||this.countRows()===0||this.countCols()===0)return;const S=[];D(W.getSelectedRange(),b=>{if(b.isSingleHeader())return;const x=b.getTopStartCorner(),L=b.getBottomEndCorner();De(x.row,L.row,$=>{De(x.col,L.col,ee=>{this.getCellMeta($,ee).readOnly||S.push([$,ee,null])})})}),S.length>0&&this.setDataAtCell(S,w)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const w=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(w,0),!this.isRenderSuspended()&&w===this.renderSuspendedCounter&&(this.renderCall?this.render():s.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(w){this.suspendRender();const S=w();return this.resumeRender(),S},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(S,0),(!this.isExecutionSuspended()&&S===this.executionSuspendedCounter||w)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(w){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const b=w();return this.resumeExecution(S),b},this.batch=function(w){this.suspendRender(),this.suspendExecution();const S=w();return this.resumeExecution(),this.resumeRender(),S},this.refreshDimensions=function(){if(!s.view)return;const{width:w,height:S}=s.view.getLastSize(),{width:b,height:x}=s.rootElement.getBoundingClientRect(),L=b!==w||x!==S;s.runHooks("beforeRefreshDimensions",{width:w,height:S},{width:b,height:x},L)!==!1&&((L||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(b,x),s.render()),s.runHooks("afterRefreshDimensions",{width:w,height:S},{width:b,height:x},L))},this.updateData=function(w,S){FL(w,b=>{a=b},b=>{a=b,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),W.refresh()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:S,metaManager:v,firstRun:f})},this.loadData=function(w,S){FL(w,b=>{a=b},()=>{v.clearCellsCache(),s.initIndexMappers(),u.adjustRowsAndCols(),W.refresh(),f&&(f=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:S,metaManager:v,firstRun:f})},this.getInitialColumnCount=function(){const w=y.columns;let S=0;if(Array.isArray(w))S=w.length;else if(un(w))if(s.dataType==="array"){const b=this.countSourceCols();for(let x=0;x<b;x+=1)w(x)&&(S+=1)}else(s.dataType==="object"||s.dataType==="function")&&(S=a.colToPropCache.length);else if(Oe(y.dataSchema)){const b=a.getSchema();S=Array.isArray(b)?b.length:Z0(b)}else S=this.countSourceCols();return S},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(w,S,b,x){return hn(w)?a.getAll():a.getRange(s._createCellCoords(w,S),s._createCellCoords(b,x),a.DESTINATION_RENDERER)},this.getCopyableText=function(w,S,b,x){return a.getCopyableText(s._createCellCoords(w,S),s._createCellCoords(b,x))},this.getCopyableData=function(w,S){return a.getCopyable(w,a.colToProp(S))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(w){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const b=(f?s.loadData:s.updateData).bind(this);let x=!1,L,$;if(Oe(w.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Oe(w.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Oe(w.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(L in w)L==="data"||(L==="language"?G(w.language):L==="className"?q("className",w.className):L==="tableClassName"&&s.table?(q("tableClassName",w.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):Ae.getSingleton().isRegistered(L)||Ae.getSingleton().isDeprecated(L)?(un(w[L])||Array.isArray(w[L]))&&(w[L].initialHook=!0,s.addHook(L,w[L])):!S&&_n(w,L)&&(C[L]=w[L]));w.data===void 0&&y.data===void 0?b(null,"updateSettings"):w.data!==void 0?b(w.data,"updateSettings"):w.columns!==void 0&&(a.createMap(),s.initIndexMappers());const ee=s.countCols(),ne=y.columns;if(ne&&un(ne)&&(x=!0),(w.cell!==void 0||w.cells!==void 0||w.columns!==void 0)&&v.clearCache(),ee>0)for(L=0,$=0;L<ee;L++){if(ne){const le=x?ne(L):ne[$];le&&v.updateColumnMeta($,le)}$+=1}Oe(w.cell)&&gt(w.cell,le=>{s.setCellMetaObject(le.row,le.col,le)}),s.runHooks("afterCellMetaReset");let he=s.rootElement.style.height;he!==""&&(he=parseInt(s.rootElement.style.height,10));let we=w.height;if(un(we)&&(we=we()),S&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),we===null){const le=s.rootElement.getAttribute("data-initialstyle");le&&(le.indexOf("height")>-1||le.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",le):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else we!==void 0&&(s.rootElement.style.height=isNaN(we)?`${we}`:`${we}px`,s.rootElement.style.overflow="hidden");if(typeof w.width<"u"){let le=w.width;un(le)&&(le=le()),s.rootElement.style.width=isNaN(le)?`${le}`:`${le}px`}S||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",w)),u.adjustRowsAndCols(),s.view&&!f&&(s.forceFullRender=!0,s.view.render(),s.view._wt.wtOverlays.adjustElementsSize()),!S&&s.view&&(he===""||we===""||we===void 0)&&he!==we&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const w=s.getSelectedLast();if(y.getValue){if(un(y.getValue))return y.getValue.call(s);if(w)return s.getData()[w[0][0]][y.getValue]}else if(w)return s.getDataAtCell(w[0],w[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(w,S,b,x,L){u.alter(w,S,b,x,L)},this.getCell=function(w,S){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,x=S,L=w;if(S>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(S)))return null;x=this.columnIndexMapper.getRenderableFromVisualIndex(S)}if(w>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(w)))return null;L=this.rowIndexMapper.getRenderableFromVisualIndex(w)}return L===null||x===null||L===void 0||x===void 0?null:s.view.getCellAtCoords(s._createCellCoords(L,x),b)},this.getCoords=function(w){const S=this.view._wt.wtTable.getCoords(w);if(S===null)return null;const{row:b,col:x}=S;let L=b,$=x;return b>=0&&(L=this.rowIndexMapper.getVisualFromRenderableIndex(b)),x>=0&&($=this.columnIndexMapper.getVisualFromRenderableIndex(x)),s._createCellCoords(L,$)},this.colToProp=function(w){return a.colToProp(w)},this.propToCol=function(w){return a.propToCol(w)},this.toVisualRow=w=>this.rowIndexMapper.getVisualFromPhysicalIndex(w),this.toVisualColumn=w=>this.columnIndexMapper.getVisualFromPhysicalIndex(w),this.toPhysicalRow=w=>this.rowIndexMapper.getPhysicalFromVisualIndex(w),this.toPhysicalColumn=w=>this.columnIndexMapper.getPhysicalFromVisualIndex(w),this.getDataAtCell=function(w,S){return a.get(w,a.colToProp(S))},this.getDataAtRowProp=function(w,S){return a.get(w,S)},this.getDataAtCol=function(w){const S=[],b=a.getRange(s._createCellCoords(0,w),s._createCellCoords(y.data.length-1,w),a.DESTINATION_RENDERER);for(let x=0;x<b.length;x+=1)for(let L=0;L<b[x].length;L+=1)S.push(b[x][L]);return S},this.getDataAtProp=function(w){const S=[],b=a.getRange(s._createCellCoords(0,a.propToCol(w)),s._createCellCoords(y.data.length-1,a.propToCol(w)),a.DESTINATION_RENDERER);for(let x=0;x<b.length;x+=1)for(let L=0;L<b[x].length;L+=1)S.push(b[x][L]);return S},this.getSourceData=function(w,S,b,x){let L;return w===void 0?L=l.getData():L=l.getByRange(s._createCellCoords(w,S),s._createCellCoords(b,x)),L},this.getSourceDataArray=function(w,S,b,x){let L;return w===void 0?L=l.getData(!0):L=l.getByRange(s._createCellCoords(w,S),s._createCellCoords(b,x),!0),L},this.getSourceDataAtCol=function(w){return l.getAtColumn(w)},this.setSourceDataAtCell=function(w,S,b,x){const L=Ke(w,S,b),$=this.hasHook("afterSetSourceDataAtCell"),ee=[];$&&D(L,he=>{let[we,le,$e]=he;ee.push([we,le,l.getAtCell(we,le),$e])}),D(L,he=>{let[we,le,$e]=he;l.setAtCell(we,le,$e)}),$&&this.runHooks("afterSetSourceDataAtCell",ee,x),this.render();const ne=s.getActiveEditor();ne&&Oe(ne.refreshValue)&&ne.refreshValue()},this.getSourceDataAtRow=function(w){return l.getAtRow(w)},this.getSourceDataAtCell=function(w,S){return l.getAtCell(w,S)},this.getDataAtRow=function(w){return a.getRange(s._createCellCoords(w,0),s._createCellCoords(w,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(w,S,b,x){const L=w===void 0?[0,0,this.countRows(),this.countCols()]:[w,S,b,x],[$,ee]=L;let[,,ne,he]=L,we=null,le=null;ne===void 0&&(ne=$),he===void 0&&(he=ee);let $e="mixed";return De(Math.max(Math.min($,ne),0),Math.max($,ne),Be=>{let Q=!0;return De(Math.max(Math.min(ee,he),0),Math.max(ee,he),Je=>(le=this.getCellMeta(Be,Je).type,we?Q=we===le:we=le,Q)),$e=Q?le:"mixed",Q}),$e},this.removeCellMeta=function(w,S,b){const[x,L]=[this.toPhysicalRow(w),this.toPhysicalColumn(S)];let $=v.getCellMetaKeyValue(x,L,b);s.runHooks("beforeRemoveCellMeta",w,S,b,$)!==!1&&(v.removeCellMeta(x,L,b),s.runHooks("afterRemoveCellMeta",w,S,b,$)),$=null},this.spliceCellsMeta=function(w){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var b=arguments.length,x=new Array(b>2?b-2:0),L=2;L<b;L++)x[L-2]=arguments[L];if(x.length>0&&!Array.isArray(x[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");S>0&&v.removeRow(this.toPhysicalRow(w),S),x.length>0&&D(x.reverse(),$=>{v.createRow(this.toPhysicalRow(w)),D($,(ee,ne)=>this.setCellMetaObject(w,ne,ee))}),s.render()},this.setCellMetaObject=function(w,S,b){typeof b=="object"&&gt(b,(x,L)=>{this.setCellMeta(w,S,L,x)})},this.setCellMeta=function(w,S,b,x){if(s.runHooks("beforeSetCellMeta",w,S,b,x)===!1)return;let $=w,ee=S;w<this.countRows()&&($=this.toPhysicalRow(w)),S<this.countCols()&&(ee=this.toPhysicalColumn(S)),v.setCellMeta($,ee,b,x),s.runHooks("afterSetCellMeta",w,S,b,x)},this.getCellsMeta=function(){return v.getCellsMeta()},this.getCellMeta=function(w,S){let b=this.toPhysicalRow(w),x=this.toPhysicalColumn(S);return b===null&&(b=w),x===null&&(x=S),v.getCellMeta(b,x,{visualRow:w,visualColumn:S})},this.getColumnMeta=function(w){return v.getColumnMeta(this.toPhysicalColumn(w))},this.getCellMetaAtRow=function(w){return v.getCellsMetaAtRow(w)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(w,S){const b=typeof w=="number"?s.getCellMeta(w,S).renderer:w.renderer;return typeof b=="string"?YA(b):hn(b)?YA("text"):b},this.getCellEditor=function(w,S){const b=typeof w=="number"?s.getCellMeta(w,S).editor:w.editor;return typeof b=="string"?$A(b):hn(b)?$A("text"):b},this.getCellValidator=function(w,S){const b=typeof w=="number"?s.getCellMeta(w,S).validator:w.validator;return typeof b=="string"?DX(b):b},this.validateCells=function(w){this._validateCells(w)},this.validateRows=function(w,S){if(!Array.isArray(w))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(S,w)},this.validateColumns=function(w,S){if(!Array.isArray(w))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(S,void 0,w)},this._validateCells=function(w,S,b){const x=new J;w&&(x.onQueueEmpty=w);let L=s.countRows()-1;for(;L>=0;){if(S!==void 0&&S.indexOf(L)===-1){L-=1;continue}let $=s.countCols()-1;for(;$>=0;){if(b!==void 0&&b.indexOf($)===-1){$-=1;continue}x.addValidatorToQueue(),s.validateCell(s.getDataAtCell(L,$),s.getCellMeta(L,$),ee=>{if(typeof ee!="boolean")throw new Error("Validation error: result is not boolean");ee===!1&&(x.valid=!1),x.removeValidatorFormQueue()},"validateCells"),$-=1}L-=1}x.checkIfQueueIsEmpty()},this.getRowHeader=function(w){let S=y.rowHeaders,b=w;return b!==void 0&&(b=s.runHooks("modifyRowHeader",b)),b===void 0?(S=[],De(s.countRows()-1,x=>{S.push(s.getRowHeader(x))})):Array.isArray(S)&&S[b]!==void 0?S=S[b]:un(S)?S=S(b):S&&typeof S!="string"&&typeof S!="number"&&(S=b+1),S},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let w=0,S=s.countCols();w<S;w++)if(s.getColHeader(w))return!0;return!1},this.getColHeader=function(w){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const b=s.runHooks("modifyColHeader",w);if(b===void 0){const ne=[],he=s.countCols();for(let we=0;we<he;we++)ne.push(s.getColHeader(we));return ne}let x=y.colHeaders;const L=function(ne){const he=[],we=s.countCols();let le=0;for(;le<we;le++)un(y.columns)&&y.columns(le)&&he.push(le);return he[ne]},$=s.toPhysicalColumn(b),ee=L($);return y.colHeaders===!1?x=null:y.columns&&un(y.columns)&&y.columns(ee)&&y.columns(ee).title?x=y.columns(ee).title:y.columns&&y.columns[$]&&y.columns[$].title?x=y.columns[$].title:Array.isArray(y.colHeaders)&&y.colHeaders[$]!==void 0?x=y.colHeaders[$]:un(y.colHeaders)?x=y.colHeaders($):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(x=E8(b)),x=s.runHooks("modifyColumnHeaderValue",x,w,S),x},this._getColWidthFromSettings=function(w){let S;if(w>=0&&(S=s.getCellMeta(0,w).width),(S===void 0||S===y.width)&&(S=y.colWidths),S!=null){switch(typeof S){case"object":S=S[w];break;case"function":S=S(w);break}typeof S=="string"&&(S=parseInt(S,10))}return S},this.getColWidth=function(w){let S=s._getColWidthFromSettings(w);return S=s.runHooks("modifyColWidth",S,w),S===void 0&&(S=kC),S},this._getRowHeightFromSettings=function(w){let S=y.rowHeights;if(S!=null){switch(typeof S){case"object":S=S[w];break;case"function":S=S(w);break}typeof S=="string"&&(S=parseInt(S,10))}return S},this.getRowHeight=function(w){let S=s._getRowHeightFromSettings(w);return S=s.runHooks("modifyRowHeight",S,w),S},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const w=y.maxCols,S=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(w,S)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=0;return z1(s.countRows()-1,b=>{if(s.isEmptyRow(b))S+=1;else if(w===!0)return!1}),S},this.countEmptyCols=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=0;return z1(s.countCols()-1,b=>{if(s.isEmptyCol(b))S+=1;else if(w===!0)return!1}),S},this.isEmptyRow=function(w){return y.isEmptyRow.call(s,w)},this.isEmptyCol=function(w){return y.isEmptyCol.call(s,w)},this.selectCell=function(w,S,b,x){let L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,$=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return hn(w)||hn(S)?!1:this.selectCells([[w,S,b,x]],L,$)},this.selectCells=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;S===!1&&d.suspend();const x=W.selectCells(w);return x&&b&&s.listen(),d.resume(),x},this.selectColumns=function(w){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,b=arguments.length>2?arguments[2]:void 0;return W.selectColumns(w,S,b)},this.selectRows=function(w){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,b=arguments.length>2?arguments[2]:void 0;return W.selectRows(w,S,b)},this.deselectCell=function(){W.deselect()},this.selectAll=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,b=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),W.selectAll(w,S,b)};const Se=(w,S)=>w.getNearestNotHiddenIndex(S,1,!0);this.scrollViewportTo=function(w){var S;if(typeof w=="number"){var b;w={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(b=arguments[4])!==null&&b!==void 0?b:!0}}const{row:x,col:L,verticalSnap:$,horizontalSnap:ee,considerHiddenIndexes:ne}=(S=w)!==null&&S!==void 0?S:{};let he,we,le,$e;$!==void 0&&(he=$==="top",we=!he),ee!==void 0&&(le=ee==="start",$e=!le);let Be=x,Q=L;if(ne===void 0||ne){const wt=Number.isInteger(x)&&x>=0,et=Number.isInteger(L)&&L>=0,ke=wt?Se(this.rowIndexMapper,x):void 0,T=et?Se(this.columnIndexMapper,L):void 0;if(ke===null||T===null)return!1;Be=wt?s.rowIndexMapper.getRenderableFromVisualIndex(ke):x,Q=et?s.columnIndexMapper.getRenderableFromVisualIndex(T):L}const Je=Number.isInteger(Be),nt=Number.isInteger(Q);return Je&&Be>=0&&nt&&Q>=0?s.view.scrollViewport(s._createCellCoords(Be,Q),he,$e,we,le):Je&&Be>=0&&(nt&&Q<0||!nt)?s.view.scrollViewportVertically(Be,he,we):nt&&Q>=0&&(Je&&Be<0||!Je)?s.view.scrollViewportHorizontally(Q,$e,le):!1},this.scrollToFocusedCell=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",w);const{highlight:S}=this.getSelectedRangeLast();this.scrollViewportTo(S.toObject())?this.view.render():(this.removeHook("afterScroll",w),this._registerImmediate(()=>w()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),v.clearCache(),Db.delete(this.guid),gv(s)){const w=this.rootDocument.querySelector(".hot-display-license-info");w&&w.parentNode.removeChild(w)}fa(s.rootElement),o.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),R.getItems().forEach(w=>{let[,S]=w;S.destroy()}),R.clear(),s.runHooks("afterDestroy")},!0),Ae.getSingleton().destroy(s),gt(s,(w,S,b)=>{un(w)?b[S]=ve(S):S!=="guid"&&(b[S]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,u=null,W=null,h=null,s=null};function ve(w){return()=>{throw new Error(`The "${w}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(w){const S=po(w);return S==="UndoRedo"?this.undoRedo:R.getItem(S)},this.getPluginName=function(w){return w===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:R.getId(w)},this.getInstance=function(){return s},this.addHook=function(w,S,b){Ae.getSingleton().add(w,S,s,b)},this.hasHook=function(w){return Ae.getSingleton().has(w,s)||Ae.getSingleton().has(w)},this.addHookOnce=function(w,S,b){Ae.getSingleton().once(w,S,s,b)},this.removeHook=function(w,S){Ae.getSingleton().remove(w,S,s)},this.runHooks=function(w,S,b,x,L,$,ee){return Ae.getSingleton().run(s,w,S,b,x,L,$,ee)},this.getTranslatedPhrase=function(w,S){return uB(y.language,w,S)},this.toHTML=()=>G1(this),this.toTableElement=()=>{const w=this.rootDocument.createElement("div");return w.insertAdjacentHTML("afterbegin",G1(this)),w.firstElementChild},this.timeouts=[],this._registerTimeout=function(w){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=w;typeof b=="function"&&(b=setTimeout(b,S)),this.timeouts.push(b)},this._clearTimeouts=function(){D(this.timeouts,w=>{clearTimeout(w)})},this.immediates=[],this._registerImmediate=function(w){this.immediates.push(setImmediate(w))},this._clearImmediates=function(){D(this.immediates,w=>{clearImmediate(w)})},this._getEditorManager=function(){return h},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const He=xZ({handleEvent(){return s.isListening()},beforeKeyDown:w=>this.runHooks("beforeKeyDown",w),afterKeyDown:w=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",w)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",w=>{w.ctrlKey===!1&&w.metaKey===!1&&He.releasePressedKeys()}),this.getShortcutManager=function(){return He},this.getFocusManager=function(){return c},AU().forEach(w=>{const S=sI(w);R.addItem(w,new S(this))}),gZ(s),He.setActiveContextName("grid"),Ae.getSingleton().run(s,"construct")}function $L(n,e,t){n.addEventListener(e,t,!1)}function GL(n,e,t){n.removeEventListener(e,t,!1)}function jL(n){return n.ownerDocument.defaultView.getComputedStyle(n)}function PZ(n){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t=n.body,r=n.createTextNode(""),i=n.createElement("span");let s;function o(){r.textContent=s.value,i.style.position="absolute",i.style.fontSize=jL(s).fontSize,i.style.fontFamily=jL(s).fontFamily,i.style.whiteSpace="pre",t.appendChild(i);const h=i.clientWidth+2;t.removeChild(i);const c=s.style;c.height=`${e.minHeight}px`,e.minWidth>h?c.width=`${e.minWidth}px`:h>e.maxWidth?c.width=`${e.maxWidth}px`:c.width=`${h}px`;const d=s.scrollHeight?s.scrollHeight-1:0;e.minHeight>d?c.height=`${e.minHeight}px`:e.maxHeight<d?(c.height=`${e.maxHeight}px`,c.overflowY="visible"):c.height=`${d}px`}function a(){n.defaultView.setTimeout(o,0)}function l(h){if(h&&h.minHeight)if(h.minHeight==="inherit")e.minHeight=s.clientHeight;else{const c=parseInt(h.minHeight,10);isNaN(c)||(e.minHeight=c)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")e.maxHeight=s.clientHeight;else{const c=parseInt(h.maxHeight,10);isNaN(c)||(e.maxHeight=c)}if(h&&h.minWidth)if(h.minWidth==="inherit")e.minWidth=s.clientWidth;else{const c=parseInt(h.minWidth,10);isNaN(c)||(e.minWidth=c)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")e.maxWidth=s.clientWidth;else{const c=parseInt(h.maxWidth,10);isNaN(c)||(e.maxWidth=c)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function u(h,c){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,l(c),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${e.minHeight}px`,s.style.minWidth=`${e.minWidth}px`,s.style.maxWidth=`${e.maxWidth}px`,s.style.overflowY="hidden"),d&&($L(s,"input",o),$L(s,"keydown",a)),o()}return{init:u,resize:o,unObserve(){GL(s,"input",o),GL(s,"keydown",a)}}}function zL(n,e){const t=oU(e),r=e.value.split(`
`);let i=t,s=0;for(let o=0;o<r.length;o++){const a=r[o];o!==0&&(s+=r[o-1].length+1);const l=s+a.length;if(n==="home"?i=s:n==="end"&&(i=l),t<=l)break}LC(e,i)}function Uu(n,e,t){return(e=LZ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function LZ(n){var e=DZ(n,"string");return typeof e=="symbol"?e:e+""}function DZ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const HZ="ht_editor_visible",Yp="ht_editor_hidden",YL="textEditor",FZ="text";class oc extends Jd{static get EDITOR_TYPE(){return FZ}constructor(e){super(e),Uu(this,"eventManager",new wo(this)),Uu(this,"autoResize",PZ(this.hot.rootDocument)),Uu(this,"TEXTAREA",void 0),Uu(this,"textareaStyle",void 0),Uu(this,"TEXTAREA_PARENT",void 0),Uu(this,"textareaParentStyle",void 0),Uu(this,"layerClass",void 0),this.eventManager=new wo(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),a4(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,r,i,s,o){const a=this.state;if(super.prepare(e,t,r,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==kn.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,t){this.state===kn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),LC(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Xe(this.TEXTAREA,[["data-hot-input",""],qd(-1)]),oe(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),oe(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ze(this.TEXTAREA_PARENT,this.layerClass)&&rt(this.TEXTAREA_PARENT,this.layerClass),oe(this.TEXTAREA_PARENT,Yp),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){_4()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",rt(this.TEXTAREA_PARENT,this.layerClass),oe(this.TEXTAREA_PARENT,Yp)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;De(e.length-1,r=>{const i=e[r];if(Ze(i,"handsontableEditor"))return t=!0,!1}),Ze(this.TEXTAREA_PARENT,Yp)&&rt(this.TEXTAREA_PARENT,Yp),t?(this.layerClass=HZ,oe(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),oe(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==kn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:r,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=ul(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=ul(this.TEXTAREA),h=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),c=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),d=i-h,f=o-c,m=s-h,p=a-c;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,m),minHeight:Math.min(f,p),maxWidth:m,maxHeight:p},!0)}bindEvents(){gU()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===kn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===kn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>Oe(this.hot.getSelected()),group:YL},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;zL(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;zL(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(YL)}}const kZ="base";function Kg(n,e,t,r,i,s,o){const a=o.ariaTags,l=[],u=[],h=[],c=[];o.className&&oe(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&c.push(y1())):a&&h.push(y1()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&c.push(C1())):(u.push(o.invalidCellClassName),a&&h.push(C1()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),rt(e,u),oe(e,l),Xd(e,h),Xe(e,c)}Kg.RENDERER_TYPE=kZ;const VZ="text";function vl(n,e,t,r,i,s,o){Kg.apply(this,[n,e,t,r,i,s,o]);let a=s;if(!a&&o.placeholder&&(a=o.placeholder),a=Kn(a),o.trimWhitespace&&(a=a.trim()),o.rendererTemplate){fa(e);const l=n.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=n.getSourceDataAtRow(t),e.appendChild(l)}else Vh(e,a)}vl.RENDERER_TYPE=VZ;const UZ="text",bB={CELL_TYPE:UZ,editor:oc,renderer:vl};Ks(bB);Et.editors={BaseEditor:Jd};function Et(n,e){const t=new EB(n,e||{},RI);return t.init(),t}Et.Core=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new EB(n,e,RI)};Et.DefaultSettings=pB();Et.hooks=Ae.getSingleton();Et.CellCoords=Bh;Et.CellRange=Gg;Et.packageName="handsontable";Et.buildDate="07/02/2025 16:13:23";Et.version="14.6.2";Et.languages={dictionaryKeys:n7,getLanguageDictionary:lB,getLanguagesDictionaries:a7,registerLanguageDictionary:aB,getTranslatedPhrase:uB};function JA(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function BZ(n){if(Array.isArray(n))return JA(n)}function WZ(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function lg(n,e,t){return e=dy(e),qZ(n,TB()?Reflect.construct(e,t||[],dy(n).constructor):e.apply(n,t))}function Fd(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function KL(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,AB(r.key),r)}}function kd(n,e,t){return e&&KL(n.prototype,e),t&&KL(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function $Z(n,e,t){return(e=AB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function dy(n){return dy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dy(n)}function ug(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&eN(n,e)}function TB(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(TB=function(){return!!n})()}function GZ(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function jZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qL(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function zZ(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qL(Object(t),!0).forEach(function(r){$Z(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):qL(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function YZ(n,e){if(n==null)return{};var t,r,i=KZ(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}function KZ(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.includes(r))continue;t[r]=n[r]}return t}function qZ(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WZ(n)}function eN(n,e){return eN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},eN(n,e)}function XZ(n){return BZ(n)||GZ(n)||ZZ(n)||jZ()}function QZ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function AB(n){var e=QZ(n,"string");return typeof e=="symbol"?e:e+""}function ZZ(n,e){if(n){if(typeof n=="string")return JA(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?JA(n,e):void 0}}var Hb=null,JZ="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",eJ="The Handsontable instance bound to this component was destroyed and cannot be used properly.",fy="global",tJ="hot-wrapper-editor-container";function nJ(){if(typeof console<"u"){var n;(n=console).warn.apply(n,arguments)}}function tN(n,e){var t=In.Children.toArray(n),r=In.Children.count(n),i=null;return r!==0&&(r===1&&t[0].props[e]?i=t[0]:i=t.find(function(s){return s.props[e]!==void 0})),i||null}function NB(n){return n?n.type.WrappedComponent?n.type.WrappedComponent:n.type:null}function IB(n,e){if(typeof n>"u"||e===null)return null;var t=OB(e.props,!1);return t.className="".concat(tJ," ").concat(t.className),Nk.createPortal(In.createElement("div",Object.assign({},t),e),n.body)}function MB(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fy,r=tN(n,"hot-editor"),i=NB(r);return r?In.cloneElement(r,{emitEditorInstance:function(o,a){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(a??fy,o)},editorColumnScope:t,isEditor:!0}):null}function rJ(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;t||(t=document),Hb||(Hb=t.createDocumentFragment());var s=i??t.createElement("DIV");Hb.appendChild(s);var o=In.cloneElement(n,zZ({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:Nk.createPortal(o,s,r),portalContainer:s}}function OB(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:n.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:n.className||"",style:n.style||{}}}function iJ(){return typeof window<"u"}var _B=(function(){function n(){Fd(this,n)}return kd(n,null,[{key:"getSettings",value:(function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=r.prevProps,s=i===void 0?{}:i,o=r.isInit,a=o===void 0?!1:o,l=r.initOnlySettingKeys,u=l===void 0?[]:l,h=function(v){return!a&&u.includes(v)?s[v]===t[v]:!1},c={};if(t.settings){var d=t.settings;for(var f in d)d.hasOwnProperty(f)&&!h(f)&&(c[f]=d[f])}for(var m in t)m!=="settings"&&m!=="children"&&!h(m)&&t.hasOwnProperty(m)&&(c[m]=t[m]);return c})}])})(),sJ=(function(n){function e(){return Fd(this,e),lg(this,e,arguments)}return ug(e,n),kd(e,[{key:"getSettingsProps",value:(function(){var r=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!r.internalProps.includes(i)}).reduce(function(i,s){return i[s]=r.props[s],i},{})})},{key:"getLocalEditorElement",value:function(){return MB(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var r=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=_B.getSettings(this.getSettingsProps()),r!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(r),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),i!==null&&(this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var r=this.props._getOwnerDocument(),i=IB(r,this.getLocalEditorElement());return In.createElement(In.Fragment,null,i)}}])})(In.Component),oJ=(function(n){function e(){var t;return Fd(this,e),t=lg(this,e,arguments),t.state={portals:[]},t}return ug(e,n),kd(e,[{key:"render",value:function(){return In.createElement(In.Fragment,null,this.state.portals)}}])})(In.Component),aJ="14.6.2";function lJ(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var xB={exports:{}},Fb,XL;function uJ(){if(XL)return Fb;XL=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Fb=n,Fb}var kb,QL;function hJ(){if(QL)return kb;QL=1;var n=uJ();function e(){}function t(){}return t.resetWarningCache=e,kb=function(){function i(a,l,u,h,c,d){if(d!==n){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}i.isRequired=i;function s(){return i}var o={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:s,element:i,elementType:i,instanceOf:s,node:i,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:t,resetWarningCache:e};return o.PropTypes=o,o},kb}xB.exports=hJ()();var cJ=xB.exports,Vb=lJ(cJ),jM=(function(n){function e(){var t;return Fd(this,e),t=lg(this,e,arguments),t.id=null,t.__hotInstance=null,t.hotElementRef=null,t.columnSettings=[],t.renderersPortalManager=null,t.portalCache=new Map,t.portalContainerCache=new Map,t.renderedCellCache=new Map,t.editorCache=new Map,t.componentRendererColumns=new Map,t}return ug(e,n),kd(e,[{key:"hotInstance",get:(function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(eJ),null)}),set:(function(r){this.__hotInstance=r})},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return iJ()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(r){this.hotElementRef=r}},{key:"getRendererWrapper",value:function(r){var i=this;return function(o,a,l,u,h,c,d){var f=i.getRenderedCellCache(),m=i.getPortalContainerCache(),p="".concat(l,"-").concat(u),v=o.guid,y="".concat(v,"-").concat(p),C="".concat(p,"-").concat(v);if(f.has(p)&&(a.innerHTML=f.get(p).innerHTML),a&&!a.getAttribute("ghost-table")){for(var R=i.portalCache.get(C),A=m.get(y);a.firstChild;)a.removeChild(a.firstChild);if(R&&A)a.appendChild(A);else{var I=rJ(r,{TD:a,row:l,col:u,prop:h,value:c,cellProperties:d,isRenderer:!0},a.ownerDocument,C,A),H=I.portal,k=I.portalContainer;m.set(y,k),a.appendChild(k),i.portalCache.set(C,H)}}return f.set(p,a),a}}},{key:"getEditorClass",value:function(r){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fy,o=NB(r),a=(i=this.getEditorCache().get(o))===null||i===void 0?void 0:i.get(s);return this.makeEditorClass(a)}},{key:"makeEditorClass",value:function(r){var i=(function(s){function o(a){var l;return Fd(this,o),l=lg(this,o,[a]),r.hotCustomEditorInstance=l,l.editorComponent=r,l}return ug(o,s),kd(o,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])})(Et.editors.BaseEditor);return Object.getOwnPropertyNames(Et.editors.BaseEditor.prototype).forEach(function(s){s!=="constructor"&&(i.prototype[s]=function(){for(var o,a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return(o=r[s]).call.apply(o,[r].concat(l))})}),i}},{key:"getGlobalRendererElement",value:function(){return tN(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return MB(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var r,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this._isHotInstanceDestroyed()?[]:((r=this.hotInstance)===null||r===void 0||(r=r.getSettings())===null||r===void 0?void 0:r._initOnlySettings)||[],a=_B.getSettings(this.props,{prevProps:s,isInit:i,initOnlySettingKeys:o}),l=this.getGlobalRendererElement(),u=this.getGlobalEditorElement();if(a.columns=this.columnSettings.length?this.columnSettings:a.columns,u)a.editor=this.getEditorClass(u,fy);else{var h;this.props.editor||(h=this.props.settings)!==null&&h!==void 0&&h.editor?a.editor=this.props.editor||this.props.settings.editor:a.editor=$A("text")}if(l)a.renderer=this.getRendererWrapper(l),this.componentRendererColumns.set("global",!0);else{var c;this.props.renderer||(c=this.props.settings)!==null&&c!==void 0&&c.renderer?a.renderer=this.props.renderer||this.props.settings.renderer:a.renderer=YA("text")}return a}},{key:"displayAutoSizeWarning",value:function(r){var i,s;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(s=this.hotInstance.getPlugin("autoColumnSize"))!==null&&s!==void 0&&s.enabled)&&this.componentRendererColumns.size>0&&nJ(JZ)}},{key:"setHotColumnSettings",value:function(r,i){this.columnSettings[i]=r}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:XZ(this.portalCache.values())})}},{key:"updateHot",value:function(r){this.hotInstance&&this.hotInstance.updateSettings(r,!1)}},{key:"setRenderersPortalManagerRef",value:function(r){this.renderersPortalManager=r}},{key:"componentDidMount",value:function(){var r=this,i=this.createNewGlobalSettings(!0);this.hotInstance=new Et.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(){return r.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return r.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentDidUpdate",value:function(r){this.clearCache();var i=this.createNewGlobalSettings(!1,r);this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var r=this,i=function(h){return h.type===sJ},s=In.Children.toArray(this.props.children),o=s.filter(function(u){return i(u)}).map(function(u,h){return In.cloneElement(u,{_componentRendererColumns:r.componentRendererColumns,_emitColumnSettings:r.setHotColumnSettings.bind(r),_columnIndex:h,_getChildElementByType:tN.bind(r),_getRendererWrapper:r.getRendererWrapper.bind(r),_getEditorClass:r.getEditorClass.bind(r),_getOwnerDocument:r.getOwnerDocument.bind(r),_getEditorCache:r.getEditorCache.bind(r),children:u.props.children})}),a=OB(this.props),l=IB(this.getOwnerDocument(),this.getGlobalEditorElement());return In.createElement(In.Fragment,null,In.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},a),o),In.createElement(oJ,{ref:this.setRenderersPortalManagerRef.bind(this)}),l)}}],[{key:"version",get:function(){return aJ}}])})(In.Component);jM.propTypes={style:Vb.object,id:Vb.string,className:Vb.string};var dJ=["children"],PB=In.forwardRef(function(n,e){var t,r=n.children,i=YZ(n,dJ),s=typeof In.useId=="function"?In.useId():void 0,o=(t=i.id)!==null&&t!==void 0?t:s;return In.createElement(jM,Object.assign({id:o},i,{ref:e}),r)});PB.version=jM.version;In.Component;const ZL="handsontableEditor",fJ="handsontable";let zM=class extends oc{static get EDITOR_TYPE(){return fJ}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),LC(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,h){const c=this.getSourceData(h.row,h.col);c!==void 0&&a.setValue(c),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&er(l,o.handsontable),this.htOptions=l}beginEditing(e,t){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,t,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:ZL,relativeToGroup:yu,position:"before"},i=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||a.flipped&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),Ro(o),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedLast()&&o.flipped?a=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),i(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedLast()&&!o.flipped)a=0;else if(o.getSelectedLast()){if(o.flipped)a=o.getSelectedLast()[0]+1;else if(!o.flipped){const u=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,s)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(ZL)}};function mJ(n,e,t){gJ(n,e),e.set(n,t)}function gJ(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kp(n,e,t){return(e=pJ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pJ(n){var e=wJ(n,"string");return typeof e=="symbol"?e:e+""}function wJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function JL(n,e){return n.get(vJ(n,e))}function vJ(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const yJ="autocomplete";var Ub=new WeakMap;class YM extends zM{constructor(){super(...arguments),Kp(this,"query",null),Kp(this,"strippedChoices",[]),Kp(this,"rawChoices",[]),mJ(this,Ub,this.hot.guid.slice(0,9)),Kp(this,"sortByRelevance",function(e,t,r){const i=[],s=[],o=e.length;let a=t.length,l,u,h,c;if(o===0){for(h=0;h<a;h++)s.push(h);return s}for(h=0;h<a;h++){if(u=v1(Kn(t[h])),r)c=u.indexOf(e);else{const d=this.cellProperties.locale;c=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}c!==-1&&(l=u.length-c-o,i.push({baseIndex:h,index:c,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),h=0,a=i.length;h<a;h++)s.push(i[h].baseIndex);return s})}static get EDITOR_TYPE(){return yJ}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return Oe(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),oe(this.htContainer,"autocompleteEditor"),oe(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Xe(this.TEXTAREA,[q6(),G6(),XV("listbox"),J6()])}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o),this.hot.getSettings().ariaTags&&Xe(this.TEXTAREA,[Es("false"),e4(`${JL(Ub,this)}-listbox-${e}-${t}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r?.length,{row:s,col:o}=this;this.showEditableElement(),this.focus();let a=Rr();a===0&&BA()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[cn(this.TEXTAREA)-2]:void 0,width:e?cn(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,h,c,d,f,m)=>{vl(l,u,h,c,d,f,m);const{filteringCaseSensitive:p,allowHtml:v,locale:y}=this.cellProperties,C=this.query;let R=Kn(f),A,I;R&&!v&&(A=p===!0?R.indexOf(C):R.toLocaleLowerCase(y).indexOf(C.toLocaleLowerCase(y)),A!==-1&&(I=R.substr(A,C.length),R=R.replace(I,`<strong>${I}</strong>`))),t&&Xe(u,[j6(),...r?[i4(i)]:[],...r?[s4(r.indexOf(f)+1)]:[],["id",`${this.htEditor.rootElement.id}_${h}-${c}`]]),u.innerHTML=R},afterSelectionEnd:(l,u)=>{if(t){const h=this.htEditor.getCell(l,u,!0);Xe(h,[z0()]),Xe(this.TEXTAREA,...t4(h.id))}}}),t&&(Xe(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...oa()),Xe(this.htEditor.rootElement,[qV(),n4("polite"),r4("text"),["id",`${JL(Ub,this)}-listbox-${s}-${o}`]]),Xe(this.TEXTAREA,...Es("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Xe(this.TEXTAREA,[Es("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=oU(this.TEXTAREA),r=f4(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;i&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(o)?o.length:0;if(s===!1)u&&(a=o[0]);else{const h=[];for(let c=0,d=l.length;c<d&&!(i&&u<=c);c++)u?h.push(l[o[c]]):h.push(l[c]);a=0,l=h}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(fv([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),LC(this.TEXTAREA,t,t===r?void 0:r)}flipDropdownIfNeeded(){const e=Dd(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(t||!t&&(r||r==="horizontal"))return!1;const i=Sr(this.TEXTAREA),s=Xn(this.TEXTAREA),o=this.getDropdownHeight(),a=e.scrollTop,l=Xn(this.hot.view._wt.wtTable.THEAD),u=Sr(e),h=i.top-u.top-l+a,c=e.scrollHeight-h-l-s,d=o>c&&h>c;return d?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(d?h:c,o),d}limitDropdownIfNeeded(e,t){if(t>e){let r=0,i=0,s=0,o=null;do s=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=s,i+=1;while(r<e);o=r-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-o}px`),this.setDropdownHeight(r-s)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const e=this.htEditor.getColWidth(0)+Rr(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,r=bt(e,s=>Kn(s));return bt(r,s=>t?s:v1(s))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),r={row:t?t.from.row:-1};let i=!1;return e===We.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===We.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(P4(e.keyCode)||e.keyCode===We.BACKSPACE||e.keyCode===We.DELETE||e.keyCode===We.INSERT){let t=10;if(e.keyCode===We.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}}const CJ="checkbox";class LB extends Jd{static get EDITOR_TYPE(){return CJ}beginEditing(e,t){if(t&&t.type==="mouseup"&&t.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');Ze(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}const Jl=()=>window,ps=()=>window.document,nN=(n,e)=>window.setTimeout(n,e),jo=function(n,e,t,r){n.addEventListener(e,t,!!r)},xa=function(n,e,t,r){n.removeEventListener(e,t,!!r)},SJ=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},Bi=function(n,e){return(" "+n.className+" ").indexOf(" "+e+" ")!==-1},Bb=function(n,e){Bi(n,e)||(n.className=n.className===""?e:n.className+" "+e)},Wb=function(n,e){n.className=SJ((" "+n.className+" ").replace(" "+e+" "," "))},KM=function(n){return/Array/.test(Object.prototype.toString.call(n))},ji=function(n){return/Date/.test(Object.prototype.toString.call(n))&&!isNaN(n.getTime())},RJ=function(n){let e=n.getDay();return e===0||e===6},EJ=function(n){return n%4===0&&n%100!==0||n%400===0},eD=function(n,e){return[31,EJ(n)?29:28,31,30,31,30,31,31,30,31,30,31][e]},qp=function(n){ji(n)&&n.setHours(0,0,0,0)},Xp=function(n,e){return n.getTime()===e.getTime()},my=function(n,e,t){let r,i;for(r in e)i=n[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?ji(e[r])?t&&(n[r]=new Date(e[r].getTime())):KM(e[r])?t&&(n[r]=e[r].slice(0)):n[r]=my({},e[r],t):(t||!i)&&(n[r]=e[r]);return n},tD=function(n,e,t){let r=ps().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=my(r,t),n.dispatchEvent(r)},nD=function(n){return n.month<0&&(n.year-=Math.ceil(Math.abs(n.month)/12),n.month+=12),n.month>11&&(n.year+=Math.floor(Math.abs(n.month)/12),n.month-=12),n},_o={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},rD=function(n,e,t){for(e+=n.firstDay;e>=7;)e-=7;return t?n.i18n.weekdaysShort[e]:n.i18n.weekdays[e]},bJ=function(n){let e=[],t="false";if(n.isEmpty)if(n.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),n.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return n.isDisabled&&e.push("is-disabled"),n.isToday&&e.push("is-today"),n.isSelected&&(e.push("is-selected"),t="true"),n.hasEvent&&e.push("has-event"),n.isInRange&&e.push("is-inrange"),n.isStartRange&&e.push("is-startrange"),n.isEndRange&&e.push("is-endrange"),'<td data-day="'+n.day+'" class="'+e.join(" ")+'" aria-selected="'+t+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n.year+'" data-pika-month="'+n.month+'" data-pika-day="'+n.day+'">'+n.day+"</button></td>"},TJ=function(n,e){n.setHours(0,0,0,0);let t=n.getDate(),r=n.getDay(),i=e,s=i-1,o=7,a=function(d){return(d+o-1)%o};n.setDate(t+s-a(r));let l=new Date(n.getFullYear(),0,i),u=1440*60*1e3,h=(n.getTime()-l.getTime())/u;return 1+Math.round((h-s+a(l.getDay()))/o)},AJ=function(n,e,t,r,i){let s=new Date(r,t,e);return'<td class="pika-week">'+(n.hasMoment?n.moment(s).isoWeek():TJ(s,i))+"</td>"},NJ=function(n,e,t,r){return'<tr class="pika-row'+(t?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?n.reverse():n).join("")+"</tr>"},IJ=function(n){return"<tbody>"+n.join("")+"</tbody>"},MJ=function(n){let e,t=[];for(n.showWeekNumber&&t.push("<th></th>"),e=0;e<7;e++)t.push('<th scope="col"><abbr title="'+rD(n,e)+'">'+rD(n,e,!0)+"</abbr></th>");return"<thead><tr>"+(n.isRTL?t.reverse():t).join("")+"</tr></thead>"},OJ=function(n,e,t,r,i,s){let o,a,l,u=n._o,h=t===u.minYear,c=t===u.maxYear,d='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',f,m,p=!0,v=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(t===i?o-e:12+o-e)+'"'+(o===r?' selected="selected"':"")+(h&&o<u.minMonth||c&&o>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[o]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",KM(u.yearRange)?(o=u.yearRange[0],a=u.yearRange[1]+1):(o=t-u.yearRange,a=1+t+u.yearRange),l=[];o<a&&o<=u.maxYear;o++)o>=u.minYear&&l.push('<option value="'+o+'"'+(o===t?' selected="selected"':"")+">"+o+"</option>");return m='<div class="pika-label">'+t+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,h&&(r===0||u.minMonth>=r)&&(p=!1),c&&(r===11||u.maxMonth<=r)&&(v=!1),e===0&&(d+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===n._o.numberOfMonths-1&&(d+='<button class="pika-next'+(v?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},_J=function(n,e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+t+'">'+MJ(n)+IJ(e)+"</table>"};function rN(n){let e=this,t=e.config(n);e._onMouseDown=function(i){if(!e._v)return;i=i||Jl().event;let s=i.target||i.srcElement;if(s)if(Bi(s,"is-disabled")||(Bi(s,"pika-button")&&!Bi(s,"is-empty")&&!Bi(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),t.bound&&nN(function(){e.hide(),t.blurFieldOnSelect&&t.field&&t.field.blur()},100)):Bi(s,"pika-prev")?e.prevMonth():Bi(s,"pika-next")&&e.nextMonth()),Bi(s,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Jl().event;let s=i.target||i.srcElement;s&&(Bi(s,"pika-select-month")?e.gotoMonth(s.value):Bi(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(i){if(i=i||Jl().event,e.isVisible())switch(i.keyCode){case 13:case 27:t.field&&t.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(t.parse)return t.parse(t.field.value,t.format);if(this.hasMoment){let i=this.moment(t.field.value,t.format,t.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(t.field.value))},e._onInputChange=function(i){let s;i.firedBy!==e&&(s=e._parseFieldValue(),ji(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=ps().activeElement;do if(Bi(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=nN(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Jl().event;let s=i.target||i.srcElement,o=s;if(s){!hasEventListeners&&Bi(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),jo(s,"change",e._onChange)));do if(Bi(o,"pika-single")||o===t.trigger)return;while(o=o.parentNode);e._v&&s!==t.trigger&&o!==t.trigger&&e.hide()}},e.el=ps().createElement("div"),e.el.className="pika-single"+(t.isRTL?" is-rtl":"")+(t.theme?" "+t.theme:""),jo(e.el,"mousedown",e._onMouseDown,!0),jo(e.el,"touchend",e._onMouseDown,!0),jo(e.el,"change",e._onChange),t.keyboardInput&&jo(ps(),"keydown",e._onKeyChange),t.field&&(t.container?t.container.appendChild(e.el):t.bound?ps().body.appendChild(e.el):t.field.parentNode.insertBefore(e.el,t.field.nextSibling),jo(t.field,"change",e._onInputChange),t.defaultDate||(t.defaultDate=e._parseFieldValue(),t.setDefaultDate=!0));let r=t.defaultDate;ji(r)?t.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),t.bound?(this.hide(),e.el.className+=" is-bound",jo(t.trigger,"click",e._onInputClick),jo(t.trigger,"focus",e._onInputFocus),jo(t.trigger,"blur",e._onInputBlur)):this.show()}rN.prototype={config:function(n){this._o||(this._o=my({},_o,!0));let e=my(this._o,n,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let t=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=t>4?4:t,ji(e.minDate)||(e.minDate=!1),ji(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),KM(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||_o.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return n=n||this._o.format,ji(this._d)?this._o.toString?this._o.toString(this._d,n):this.hasMoment?this.moment(this._d).format(n):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(n,e){this.hasMoment&&this.moment.isMoment(n)&&this.setDate(n.toDate(),e)},useMoment:function(n){this.hasMoment=!0,this.moment=n},getDate:function(){return ji(this._d)?new Date(this._d.getTime()):null},setDate:function(n,e){if(!n)return this._d=null,this._o.field&&(this._o.field.value="",tD(this._o.field,"change",{firedBy:this})),this.draw();if(typeof n=="string"&&(n=new Date(Date.parse(n))),!ji(n))return;let t=this._o.minDate,r=this._o.maxDate;ji(t)&&n<t?n=t:ji(r)&&n>r&&(n=r),this._d=new Date(n.getTime()),qp(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),tD(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(n){let e=!0;if(ji(n)){if(this.calendars){let t=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=n.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<t.getTime()||r.getTime()<i}e&&(this.calendars=[{month:n.getMonth(),year:n.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,e){let t=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;n==="add"?i=new Date(t.valueOf()+r):n==="subtract"&&(i=new Date(t.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=nD(this.calendars[0]);for(let n=1;n<this._o.numberOfMonths;n++)this.calendars[n]=nD({month:this.calendars[0].month+n,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(n){isNaN(n)||(this.calendars[0].month=parseInt(n,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(n){isNaN(n)||(this.calendars[0].year=parseInt(n,10),this.adjustCalendars())},setMinDate:function(n){n instanceof Date?(qp(n),this._o.minDate=n,this._o.minYear=n.getFullYear(),this._o.minMonth=n.getMonth()):(this._o.minDate=_o.minDate,this._o.minYear=_o.minYear,this._o.minMonth=_o.minMonth,this._o.startRange=_o.startRange),this.draw()},setMaxDate:function(n){n instanceof Date?(qp(n),this._o.maxDate=n,this._o.maxYear=n.getFullYear(),this._o.maxMonth=n.getMonth()):(this._o.maxDate=_o.maxDate,this._o.maxYear=_o.maxYear,this._o.maxMonth=_o.maxMonth,this._o.endRange=_o.endRange),this.draw()},setStartRange:function(n){this._o.startRange=n},setEndRange:function(n){this._o.endRange=n},draw:function(n){if(!this._v&&!n)return;let e=this._o,t=e.minYear,r=e.maxYear,i=e.minMonth,s=e.maxMonth,o="",a;this._y<=t&&(this._y=t,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+OJ(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&nN(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let n,e,t,r,i,s,o,a,l,u,h;this._o.container||(this.el.style.position="absolute",n=this._o.trigger,e=this.el.offsetWidth,t=this.el.offsetHeight,r=Jl().innerWidth||ps().documentElement.clientWidth,i=Jl().innerHeight||ps().documentElement.clientHeight,s=ps().body.scrollTop||ps().documentElement.scrollTop,u=!0,h=!0,l=n.getBoundingClientRect(),o=l.left+Jl().pageXOffset,a=l.bottom+Jl().pageYOffset,(this._o.reposition&&o+e>r||this._o.position.indexOf("right")>-1&&o-e+n.offsetWidth>0)&&(o=o-e+n.offsetWidth,u=!1),(this._o.reposition&&a+t>i+s||this._o.position.indexOf("top")>-1&&a-t-n.offsetHeight>0)&&(a=a-t-n.offsetHeight,h=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",Bb(this.el,u?"left-aligned":"right-aligned"),Bb(this.el,h?"bottom-aligned":"top-aligned"),Wb(this.el,u?"right-aligned":"left-aligned"),Wb(this.el,h?"top-aligned":"bottom-aligned"))},render:function(n,e,t){let r=this._o,i=new Date,s=eD(n,e),o=new Date(n,e,1).getDay(),a=[],l=[];qp(i),r.firstDay>0&&(o-=r.firstDay,o<0&&(o+=7));let u=e===0?11:e-1,h=e===11?0:e+1,c=e===0?n-1:n,d=e===11?n+1:n,f=eD(c,u),m=s+o,p=m;for(;p>7;)p-=7;m+=7-p;let v=!1;for(let y=0,C=0;y<m;y++){let R=new Date(n,e,1+(y-o)),A=ji(this._d)?Xp(R,this._d):!1,I=Xp(R,i),H=r.events.indexOf(R.toDateString())!==-1,k=y<o||y>=s+o,W=1+(y-o),z=e,G=n,q=r.startRange&&Xp(r.startRange,R),J=r.endRange&&Xp(r.endRange,R),re=r.startRange&&r.endRange&&r.startRange<R&&R<r.endRange,ie=r.minDate&&R<r.minDate||r.maxDate&&R>r.maxDate||r.disableWeekends&&RJ(R)||r.disableDayFn&&r.disableDayFn(R);k&&(y<o?(W=f+W,z=u,G=c):(W=W-s,z=h,G=d));let ae={day:W,month:z,year:G,hasEvent:H,isSelected:A,isToday:I,isDisabled:ie,isEmpty:k,isStartRange:q,isEndRange:J,isInRange:re,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&A&&(v=!0),l.push(bJ(ae)),++C===7&&(r.showWeekNumber&&l.unshift(AJ(this,y-o,e,n,r.firstWeekOfYearMinDays)),a.push(NJ(l,r.isRTL,r.pickWholeWeek,v)),l=[],C=0,v=!1)}return _J(r,a,t)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Wb(this.el,"is-hidden"),this._o.bound&&(jo(ps(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let n=this._v;n!==!1&&(this._o.bound&&xa(ps(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Bb(this.el,"is-hidden"),this._v=!1,n!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let n=this._o;this.hide(),xa(this.el,"mousedown",this._onMouseDown,!0),xa(this.el,"touchend",this._onMouseDown,!0),xa(this.el,"change",this._onChange),n.keyboardInput&&xa(ps(),"keydown",this._onKeyChange),n.field&&(xa(n.field,"change",this._onInputChange),n.bound&&(xa(n.trigger,"click",this._onInputClick),xa(n.trigger,"focus",this._onInputFocus),xa(n.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function $b(n,e,t){return(e=xJ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xJ(n){var e=PJ(n,"string");return typeof e=="symbol"?e:e+""}function PJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const DB="date",iD="dateEditor";class HB extends oc{constructor(){super(...arguments),$b(this,"defaultDateFormat","DD/MM/YYYY"),$b(this,"parentDestroyed",!1),$b(this,"$datePicker",null)}static get EDITOR_TYPE(){return DB}init(){if(typeof se!="function")throw new Error("You need to include moment.js to your project.");if(typeof rN!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),oe(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Ze(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:iD})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(iD),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,t)}showDatepicker(e){const t=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.hot.view.isMouseDown(),i=e?wU(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new rN(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(se),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,se(s,t,!0).isValid()&&this.$datePicker.setMoment(se(s,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,se(s,t,!0).isValid()&&this.$datePicker.setMoment(se(s,t),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&HC(t,this.cellProperties.datePickerConfig);const r=t.onSelect,i=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.keyboardInput=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=s=>{let o=s;isNaN(o.getTime())||(o=se(o).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(o),r&&r()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},t}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==kn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(t=s.getParentOverlay(this.TD))!==null&&t!==void 0?t:this.hot.view._wt,a=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),h=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=h){const c=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+c.top+Xn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=c.right-cn(this.datePicker):d+=c.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}const LJ="dropdown";class qM extends YM{static get EDITOR_TYPE(){return LJ}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}Ae.getSingleton().add("beforeValidate",function(n,e,t){const r=this.propToCol(t);if(Number.isInteger(r)){const i=this.getCellMeta(e,r);i.editor===qM&&i.strict===void 0&&(i.filter=!1,i.strict=!0)}});const DJ="numeric";class FB extends oc{static get EDITOR_TYPE(){return DJ}}const HJ="password";class kB extends oc{static get EDITOR_TYPE(){return HJ}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,fa(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Gb="ht_editor_visible",sD="selectEditor",FJ="select";class VB extends Jd{static get EDITOR_TYPE(){return FJ}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",oe(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Ze(this.select,Gb)&&rt(this.select,Gb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),fa(this.select),gt(l,(u,h)=>{const c=this.hot.rootDocument.createElement("OPTION");c.value=h,Qd(c,u),this.select.appendChild(c)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)t[e[r]]=e[r];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==kn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:r,height:i}=this.getEditedCellRect(),s=this.select.style;s.height=`${i}px`,s.width=`${r}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${t}px`,s.margin="0px",oe(this.select,Gb)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={group:sD};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(sD)}}const kJ="time";class UB extends oc{static get EDITOR_TYPE(){return kJ}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o),this.TEXTAREA.dir="ltr"}}function VJ(){Wi(Jd),Wi(YM),Wi(LB),Wi(HB),Wi(qM),Wi(zM),Wi(FB),Wi(kB),Wi(VB),Wi(oc),Wi(UB)}const UJ="html";function XM(n,e,t,r,i,s,o){Kg.apply(this,[n,e,t,r,i,s,o]),Qd(e,s??"",!1)}XM.RENDERER_TYPE=UJ;const BJ="autocomplete";function ef(n,e,t,r,i,s,o){const{rootDocument:a}=n,l=o.allowHtml?XM:vl,u=a.createElement("DIV"),h=n.getSettings().ariaTags;if(u.className="htAutocompleteArrow",h&&u.setAttribute(...ic()),u.appendChild(a.createTextNode("▼")),l.apply(this,[n,e,t,r,i,s,o]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),oe(e,"htAutocomplete"),!n.acArrowListener){const c=new wo(n);n.acArrowListener=function(d){Ze(d.target,"htAutocompleteArrow")&&n.view._wt.getSetting("onCellDblClick",null,n._createCellCoords(t,r),e)},c.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",()=>{c.destroy()})}}ef.RENDERER_TYPE=BJ;const WJ="dropdown";function QM(n,e,t,r,i,s,o){ef.apply(this,[n,e,t,r,i,s,o])}QM.RENDERER_TYPE=WJ;const oD=new WeakMap,aD=new WeakMap,$J="htBadValue",Vd="data-row",Ud="data-col",GJ="checkboxRenderer",BB="checkbox";Ae.getSingleton().add("modifyAutoColumnSizeSeed",function(n,e,t){const{label:r,type:i,row:s,column:o,prop:a}=e;if(i===BB){if(r){const{value:l,property:u}=r;let h=t;if(l)h=typeof l=="function"?l(s,o,a,t):l;else if(u){const c=this.getDataAtRowProp(s,u);h=c!==null?c:t}n=h}return n}});function ZM(n,e,t,r,i,s,o){const{rootDocument:a}=n,l=n.getSettings().ariaTags;Kg.apply(this,[n,e,t,r,i,s,o]),jJ(n);let u=zJ(a);const h=o.label;let c=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),fa(e),s===o.checkedTemplate||Kn(s).toLocaleLowerCase(o.locale)===Kn(o.checkedTemplate).toLocaleLowerCase(o.locale)?u.checked=!0:s===o.uncheckedTemplate||Kn(s).toLocaleLowerCase(o.locale)===Kn(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?u.checked=!1:Bn(s)?oe(u,"noValue"):(u.style.display="none",oe(u,$J),c=!0),Xe(u,[[Vd,t],[Ud,r]]),l&&Xe(u,[Qv(u.checked?n.getTranslatedPhrase(BM):n.getTranslatedPhrase(WM)),JV(u.checked),z6()]),!c&&h){let p="";if(h.value)p=typeof h.value=="function"?h.value.call(this,t,r,i,s):h.value;else if(h.property){const y=n.getDataAtRowProp(t,h.property);p=y!==null?y:""}const v=YJ(a,p,h.separated!==!0);h.position==="before"?h.separated?(e.appendChild(v),e.appendChild(u)):(v.appendChild(u),u=v):(!h.position||h.position==="after")&&(h.separated?(e.appendChild(u),e.appendChild(v)):(v.insertBefore(u,v.firstChild),u=v))}(!h||h&&!h.separated)&&e.appendChild(u),c&&e.appendChild(a.createTextNode("#bad-value#")),oD.has(n)||(oD.set(n,!0),d());function d(){const v=n.getShortcutManager().getContext("grid"),y={group:GJ,relativeToGroup:yu,position:"before"};v.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var C;return(C=n.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{const C=n.getSelectedRangeLast();return n.getSettings().enterBeginsEditing&&C?.isSingle()&&C.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var C;return(C=n.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}}],y)}function f(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const v=n.getSelectedRange(),y=[],C=new Map;let R=[],A=0;if(v){for(let I=0;I<v.length;I++){const{row:H,col:k}=v[I].getTopStartCorner(),{row:W,col:z}=v[I].getBottomEndCorner();for(let G=H;G<=W;G+=1)for(let q=k;q<=z;q+=1){const J=n.getCellMeta(G,q),re={checkedTemplate:J.checkedTemplate,uncheckedTemplate:J.uncheckedTemplate};if(J.type!=="checkbox"){p===!0&&!J.readOnly&&(C.has(y.length)?C.set(y.length,[...C.get(y.length),[G,q,null]]):C.set(y.length,[[G,q,null]]));continue}if(J.readOnly===!0)continue;typeof J.checkedTemplate>"u"&&(J.checkedTemplate=!0),typeof J.uncheckedTemplate>"u"&&(J.uncheckedTemplate=!1);const ie=n.getDataAtCell(G,q);p===!1?[J.checkedTemplate,J.checkedTemplate.toString()].includes(ie)?R.push([G,q,J.uncheckedTemplate,re]):[J.uncheckedTemplate,J.uncheckedTemplate.toString(),null,void 0].includes(ie)&&R.push([G,q,J.checkedTemplate,re]):R.push([G,q,J.uncheckedTemplate,re]),A+=1}y.push(A),A=0}R.every(I=>{let[,,H]=I;return H===R[0][2]})?R=R.map(I=>{let[H,k,W]=I;return[H,k,W]}):R=R.map(I=>{let[H,k,,W]=I;return[H,k,W.checkedTemplate]}),R.length>0&&y.forEach((I,H)=>{let k=R.splice(0,I);C.size&&C.has(H)&&(k=[...k,...C.get(H)]),n.setDataAtCell(k)})}}function m(){const p=n.getSelectedRange();if(p){for(let v=0;v<p.length;v++){const y=p[v].getTopStartCorner(),C=p[v].getBottomEndCorner();for(let R=y.row;R<=C.row;R++)for(let A=y.col;A<=C.col;A++){const I=n.getCellMeta(R,A),H=n.getCell(R,A);if(H==null)return!0;if(H.querySelectorAll("input[type=checkbox]").length>0&&!I.readOnly)return!0}}return!1}}}ZM.RENDERER_TYPE=BB;function jJ(n){let e=aD.get(n);if(!e){const{rootElement:t}=n;e=new wo(n),e.addEventListener(t,"click",r=>qJ(r,n)),e.addEventListener(t,"mouseup",r=>KJ(r,n)),e.addEventListener(t,"change",r=>XJ(r,n)),aD.set(n,e)}return e}function zJ(n){const e=n.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function YJ(n,e,t){const r=n.createElement("label");return r.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`,r.appendChild(n.createTextNode(e)),r.cloneNode(!0)}function KJ(n,e){const{target:t}=n;JM(t)&&(!t.hasAttribute(Vd)||!t.hasAttribute(Ud)||setTimeout(e.listen,10))}function qJ(n,e){const{target:t}=n;if(!JM(t)||!t.hasAttribute(Vd)||!t.hasAttribute(Ud))return;const r=parseInt(t.getAttribute(Vd),10),i=parseInt(t.getAttribute(Ud),10);e.getCellMeta(r,i).readOnly&&n.preventDefault()}function XJ(n,e){const{target:t}=n;if(!JM(t)||!t.hasAttribute(Vd)||!t.hasAttribute(Ud))return;const r=parseInt(t.getAttribute(Vd),10),i=parseInt(t.getAttribute(Ud),10),s=e.getCellMeta(r,i);if(!s.readOnly){let o=null;n.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(r,i,o)}}function JM(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}const QJ="handsontable";function eO(n,e,t,r,i,s,o){ef.apply(this,[n,e,t,r,i,s,o])}eO.RENDERER_TYPE=QJ;function Qp(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var jb={exports:{}},lD;function ZJ(){return lD||(lD=1,(function(n,e){(function(t){n.exports=t()})(function(){return(function t(r,i,s){function o(u,h){if(!i[u]){if(!r[u]){var c=typeof Qp=="function"&&Qp;if(!h&&c)return c(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=i[u]={exports:{}};r[u][0].call(f.exports,function(m){return o(r[u][1][m]||m)},f,f.exports,t,r,i,s)}return i[u].exports}for(var a=typeof Qp=="function"&&Qp,l=0;l<s.length;l++)o(s[l]);return o})({1:[function(t,r,i){(function(s){var o,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,h="[BigNumber Error] ",c=h+"Number primitive has more than 15 significant digits: ",d=1e14,f=14,m=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],v=1e7,y=1e9;function C(z){var G=0|z;return 0<z||z===G?G:G-1}function R(z){for(var G,q,J=1,re=z.length,ie=z[0]+"";J<re;){for(G=z[J++]+"",q=f-G.length;q--;G="0"+G);ie+=G}for(re=ie.length;ie.charCodeAt(--re)===48;);return ie.slice(0,re+1||1)}function A(z,G){var q,J,re=z.c,ie=G.c,ae=z.s,Ke=G.s,xe=z.e,Se=G.e;if(!ae||!Ke)return null;if(q=re&&!re[0],J=ie&&!ie[0],q||J)return q?J?0:-Ke:ae;if(ae!=Ke)return ae;if(q=ae<0,J=xe==Se,!re||!ie)return J?0:!re^q?1:-1;if(!J)return Se<xe^q?1:-1;for(Ke=(xe=re.length)<(Se=ie.length)?xe:Se,ae=0;ae<Ke;ae++)if(re[ae]!=ie[ae])return re[ae]>ie[ae]^q?1:-1;return xe==Se?0:Se<xe^q?1:-1}function I(z,G,q,J){if(z<G||q<z||z!==(z<0?l(z):u(z)))throw Error(h+(J||"Argument")+(typeof z=="number"?z<G||q<z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(z))}function H(z){var G=z.c.length-1;return C(z.e/f)==G&&z.c[G]%2!=0}function k(z,G){return(1<z.length?z.charAt(0)+"."+z.slice(1):z)+(G<0?"e":"e+")+G}function W(z,G,q){var J,re;if(G<0){for(re=q+".";++G;re+=q);z=re+z}else if(++G>(J=z.length)){for(re=q,G-=J;--G;re+=q);z+=re}else G<J&&(z=z.slice(0,G)+"."+z.slice(G));return z}(o=(function z(G){var q,J,re,ie,ae,Ke,xe,Se,ve,He,w=Q.prototype={constructor:Q,toString:null,valueOf:null},S=new Q(1),b=20,x=4,L=-7,$=21,ee=-1e7,ne=1e7,he=!1,we=1,le=0,$e={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Be="0123456789abcdefghijklmnopqrstuvwxyz";function Q(T,O){var P,Y,F,X,B,V,K,j,Z=this;if(!(Z instanceof Q))return new Q(T,O);if(O==null){if(T instanceof Q)return Z.s=T.s,Z.e=T.e,void(Z.c=(T=T.c)?T.slice():T);if((V=typeof T=="number")&&0*T==0){if(Z.s=1/T<0?(T=-T,-1):1,T===~~T){for(X=0,B=T;10<=B;B/=10,X++);return Z.e=X,void(Z.c=[T])}j=String(T)}else{if(j=String(T),!a.test(j))return re(Z,j,V);Z.s=j.charCodeAt(0)==45?(j=j.slice(1),-1):1}-1<(X=j.indexOf("."))&&(j=j.replace(".","")),0<(B=j.search(/e/i))?(X<0&&(X=B),X+=+j.slice(B+1),j=j.substring(0,B)):X<0&&(X=j.length)}else{if(I(O,2,Be.length,"Base"),j=String(T),O==10)return et(Z=new Q(T instanceof Q?T:j),b+Z.e+1,x);if(V=typeof T=="number"){if(0*T!=0)return re(Z,j,V,O);if(Z.s=1/T<0?(j=j.slice(1),-1):1,Q.DEBUG&&15<j.replace(/^0\.0*|\./,"").length)throw Error(c+T);V=!1}else Z.s=j.charCodeAt(0)===45?(j=j.slice(1),-1):1;for(P=Be.slice(0,O),X=B=0,K=j.length;B<K;B++)if(P.indexOf(Y=j.charAt(B))<0){if(Y=="."){if(X<B){X=K;continue}}else if(!F&&(j==j.toUpperCase()&&(j=j.toLowerCase())||j==j.toLowerCase()&&(j=j.toUpperCase()))){F=!0,B=-1,X=0;continue}return re(Z,String(T),V,O)}-1<(X=(j=J(j,O,10,Z.s)).indexOf("."))?j=j.replace(".",""):X=j.length}for(B=0;j.charCodeAt(B)===48;B++);for(K=j.length;j.charCodeAt(--K)===48;);if(j=j.slice(B,++K)){if(K-=B,V&&Q.DEBUG&&15<K&&(m<T||T!==u(T)))throw Error(c+Z.s*T);if(ne<(X=X-B-1))Z.c=Z.e=null;else if(X<ee)Z.c=[Z.e=0];else{if(Z.e=X,Z.c=[],B=(X+1)%f,X<0&&(B+=f),B<K){for(B&&Z.c.push(+j.slice(0,B)),K-=f;B<K;)Z.c.push(+j.slice(B,B+=f));j=j.slice(B),B=f-j.length}else B-=K;for(;B--;j+="0");Z.c.push(+j)}}else Z.c=[Z.e=0]}function Je(T,O,P,Y){var F,X,B,V,K;if(P==null?P=x:I(P,0,8),!T.c)return T.toString();if(F=T.c[0],B=T.e,O==null)K=R(T.c),K=Y==1||Y==2&&(B<=L||$<=B)?k(K,B):W(K,B,"0");else if(X=(T=et(new Q(T),O,P)).e,V=(K=R(T.c)).length,Y==1||Y==2&&(O<=X||X<=L)){for(;V<O;K+="0",V++);K=k(K,X)}else if(O-=B,K=W(K,X,"0"),V<X+1){if(0<--O)for(K+=".";O--;K+="0");}else if(0<(O+=X-V))for(X+1==V&&(K+=".");O--;K+="0");return T.s<0&&F?"-"+K:K}function nt(T,O){for(var P,Y=1,F=new Q(T[0]);Y<T.length;Y++){if(!(P=new Q(T[Y])).s){F=P;break}O.call(F,P)&&(F=P)}return F}function wt(T,O,P){for(var Y=1,F=O.length;!O[--F];O.pop());for(F=O[0];10<=F;F/=10,Y++);return(P=Y+P*f-1)>ne?T.c=T.e=null:T.c=P<ee?[T.e=0]:(T.e=P,O),T}function et(T,O,P,Y){var F,X,B,V,K,j,Z,me=T.c,Re=p;if(me){e:{for(F=1,V=me[0];10<=V;V/=10,F++);if((X=O-F)<0)X+=f,B=O,Z=(K=me[j=0])/Re[F-B-1]%10|0;else if((j=l((X+1)/f))>=me.length){if(!Y)break e;for(;me.length<=j;me.push(0));K=Z=0,B=(X%=f)-f+(F=1)}else{for(K=V=me[j],F=1;10<=V;V/=10,F++);Z=(B=(X%=f)-f+F)<0?0:K/Re[F-B-1]%10|0}if(Y=Y||O<0||me[j+1]!=null||(B<0?K:K%Re[F-B-1]),Y=P<4?(Z||Y)&&(P==0||P==(T.s<0?3:2)):5<Z||Z==5&&(P==4||Y||P==6&&(0<X?0<B?K/Re[F-B]:0:me[j-1])%10&1||P==(T.s<0?8:7)),O<1||!me[0])return me.length=0,Y?(O-=T.e+1,me[0]=Re[(f-O%f)%f],T.e=-O||0):me[0]=T.e=0,T;if(X==0?(me.length=j,V=1,j--):(me.length=j+1,V=Re[f-X],me[j]=0<B?u(K/Re[F-B]%Re[B])*V:0),Y)for(;;){if(j==0){for(X=1,B=me[0];10<=B;B/=10,X++);for(B=me[0]+=V,V=1;10<=B;B/=10,V++);X!=V&&(T.e++,me[0]==d&&(me[0]=1));break}if(me[j]+=V,me[j]!=d)break;me[j--]=0,V=1}for(X=me.length;me[--X]===0;me.pop());}T.e>ne?T.c=T.e=null:T.e<ee&&(T.c=[T.e=0])}return T}function ke(T){var O,P=T.e;return P===null?T.toString():(O=R(T.c),O=P<=L||$<=P?k(O,P):W(O,P,"0"),T.s<0?"-"+O:O)}return Q.clone=z,Q.ROUND_UP=0,Q.ROUND_DOWN=1,Q.ROUND_CEIL=2,Q.ROUND_FLOOR=3,Q.ROUND_HALF_UP=4,Q.ROUND_HALF_DOWN=5,Q.ROUND_HALF_EVEN=6,Q.ROUND_HALF_CEIL=7,Q.ROUND_HALF_FLOOR=8,Q.EUCLID=9,Q.config=Q.set=function(T){var O,P;if(T!=null){if(typeof T!="object")throw Error(h+"Object expected: "+T);if(T.hasOwnProperty(O="DECIMAL_PLACES")&&(I(P=T[O],0,y,O),b=P),T.hasOwnProperty(O="ROUNDING_MODE")&&(I(P=T[O],0,8,O),x=P),T.hasOwnProperty(O="EXPONENTIAL_AT")&&((P=T[O])&&P.pop?(I(P[0],-y,0,O),I(P[1],0,y,O),L=P[0],$=P[1]):(I(P,-y,y,O),L=-($=P<0?-P:P))),T.hasOwnProperty(O="RANGE"))if((P=T[O])&&P.pop)I(P[0],-y,-1,O),I(P[1],1,y,O),ee=P[0],ne=P[1];else{if(I(P,-y,y,O),!P)throw Error(h+O+" cannot be zero: "+P);ee=-(ne=P<0?-P:P)}if(T.hasOwnProperty(O="CRYPTO")){if((P=T[O])!==!!P)throw Error(h+O+" not true or false: "+P);if(P){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw he=!P,Error(h+"crypto unavailable");he=P}else he=P}if(T.hasOwnProperty(O="MODULO_MODE")&&(I(P=T[O],0,9,O),we=P),T.hasOwnProperty(O="POW_PRECISION")&&(I(P=T[O],0,y,O),le=P),T.hasOwnProperty(O="FORMAT")){if(typeof(P=T[O])!="object")throw Error(h+O+" not an object: "+P);$e=P}if(T.hasOwnProperty(O="ALPHABET")){if(typeof(P=T[O])!="string"||/^.$|[+-.\s]|(.).*\1/.test(P))throw Error(h+O+" invalid: "+P);Be=P}}return{DECIMAL_PLACES:b,ROUNDING_MODE:x,EXPONENTIAL_AT:[L,$],RANGE:[ee,ne],CRYPTO:he,MODULO_MODE:we,POW_PRECISION:le,FORMAT:$e,ALPHABET:Be}},Q.isBigNumber=function(T){return T instanceof Q||T&&T._isBigNumber===!0||!1},Q.maximum=Q.max=function(){return nt(arguments,w.lt)},Q.minimum=Q.min=function(){return nt(arguments,w.gt)},Q.random=(ie=9007199254740992,ae=Math.random()*ie&2097151?function(){return u(Math.random()*ie)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(T){var O,P,Y,F,X,B=0,V=[],K=new Q(S);if(T==null?T=b:I(T,0,y),F=l(T/f),he)if(crypto.getRandomValues){for(O=crypto.getRandomValues(new Uint32Array(F*=2));B<F;)9e15<=(X=131072*O[B]+(O[B+1]>>>11))?(P=crypto.getRandomValues(new Uint32Array(2)),O[B]=P[0],O[B+1]=P[1]):(V.push(X%1e14),B+=2);B=F/2}else{if(!crypto.randomBytes)throw he=!1,Error(h+"crypto unavailable");for(O=crypto.randomBytes(F*=7);B<F;)9e15<=(X=281474976710656*(31&O[B])+1099511627776*O[B+1]+4294967296*O[B+2]+16777216*O[B+3]+(O[B+4]<<16)+(O[B+5]<<8)+O[B+6])?crypto.randomBytes(7).copy(O,B):(V.push(X%1e14),B+=7);B=F/7}if(!he)for(;B<F;)(X=ae())<9e15&&(V[B++]=X%1e14);for(F=V[--B],T%=f,F&&T&&(X=p[f-T],V[B]=u(F/X)*X);V[B]===0;V.pop(),B--);if(B<0)V=[Y=0];else{for(Y=-1;V[0]===0;V.splice(0,1),Y-=f);for(B=1,X=V[0];10<=X;X/=10,B++);B<f&&(Y-=f-B)}return K.e=Y,K.c=V,K}),Q.sum=function(){for(var T=1,O=arguments,P=new Q(O[0]);T<O.length;)P=P.plus(O[T++]);return P},J=(function(){var T="0123456789";function O(P,Y,F,X){for(var B,V,K=[0],j=0,Z=P.length;j<Z;){for(V=K.length;V--;K[V]*=Y);for(K[0]+=X.indexOf(P.charAt(j++)),B=0;B<K.length;B++)K[B]>F-1&&(K[B+1]==null&&(K[B+1]=0),K[B+1]+=K[B]/F|0,K[B]%=F)}return K.reverse()}return function(P,Y,F,X,B){var V,K,j,Z,me,Re,Ve,ot,Rt=P.indexOf("."),at=b,qe=x;for(0<=Rt&&(Z=le,le=0,P=P.replace(".",""),Re=(ot=new Q(Y)).pow(P.length-Rt),le=Z,ot.c=O(W(R(Re.c),Re.e,"0"),10,F,T),ot.e=ot.c.length),j=Z=(Ve=O(P,Y,F,B?(V=Be,T):(V=T,Be))).length;Ve[--Z]==0;Ve.pop());if(!Ve[0])return V.charAt(0);if(Rt<0?--j:(Re.c=Ve,Re.e=j,Re.s=X,Ve=(Re=q(Re,ot,at,qe,F)).c,me=Re.r,j=Re.e),Rt=Ve[K=j+at+1],Z=F/2,me=me||K<0||Ve[K+1]!=null,me=qe<4?(Rt!=null||me)&&(qe==0||qe==(Re.s<0?3:2)):Z<Rt||Rt==Z&&(qe==4||me||qe==6&&1&Ve[K-1]||qe==(Re.s<0?8:7)),K<1||!Ve[0])P=me?W(V.charAt(1),-at,V.charAt(0)):V.charAt(0);else{if(Ve.length=K,me)for(--F;++Ve[--K]>F;)Ve[K]=0,K||(++j,Ve=[1].concat(Ve));for(Z=Ve.length;!Ve[--Z];);for(Rt=0,P="";Rt<=Z;P+=V.charAt(Ve[Rt++]));P=W(P,j,V.charAt(0))}return P}})(),q=(function(){function T(Y,F,X){var B,V,K,j,Z=0,me=Y.length,Re=F%v,Ve=F/v|0;for(Y=Y.slice();me--;)Z=((V=Re*(K=Y[me]%v)+(B=Ve*K+(j=Y[me]/v|0)*Re)%v*v+Z)/X|0)+(B/v|0)+Ve*j,Y[me]=V%X;return Z&&(Y=[Z].concat(Y)),Y}function O(Y,F,X,B){var V,K;if(X!=B)K=B<X?1:-1;else for(V=K=0;V<X;V++)if(Y[V]!=F[V]){K=Y[V]>F[V]?1:-1;break}return K}function P(Y,F,X,B){for(var V=0;X--;)Y[X]-=V,V=Y[X]<F[X]?1:0,Y[X]=V*B+Y[X]-F[X];for(;!Y[0]&&1<Y.length;Y.splice(0,1));}return function(Y,F,X,B,V){var K,j,Z,me,Re,Ve,ot,Rt,at,qe,Tt,dn,Ea,Fi,bu,di,ue,Ue=Y.s==F.s?1:-1,Nt=Y.c,Qe=F.c;if(!(Nt&&Nt[0]&&Qe&&Qe[0]))return new Q(Y.s&&F.s&&(Nt?!Qe||Nt[0]!=Qe[0]:Qe)?Nt&&Nt[0]==0||!Qe?0*Ue:Ue/0:NaN);for(at=(Rt=new Q(Ue)).c=[],Ue=X+(j=Y.e-F.e)+1,V||(V=d,j=C(Y.e/f)-C(F.e/f),Ue=Ue/f|0),Z=0;Qe[Z]==(Nt[Z]||0);Z++);if(Qe[Z]>(Nt[Z]||0)&&j--,Ue<0)at.push(1),me=!0;else{for(Fi=Nt.length,di=Qe.length,Ue+=2,1<(Re=u(V/(Qe[Z=0]+1)))&&(Qe=T(Qe,Re,V),Nt=T(Nt,Re,V),di=Qe.length,Fi=Nt.length),Ea=di,Tt=(qe=Nt.slice(0,di)).length;Tt<di;qe[Tt++]=0);ue=Qe.slice(),ue=[0].concat(ue),bu=Qe[0],Qe[1]>=V/2&&bu++;do{if(Re=0,(K=O(Qe,qe,di,Tt))<0){if(dn=qe[0],di!=Tt&&(dn=dn*V+(qe[1]||0)),1<(Re=u(dn/bu)))for(V<=Re&&(Re=V-1),ot=(Ve=T(Qe,Re,V)).length,Tt=qe.length;O(Ve,qe,ot,Tt)==1;)Re--,P(Ve,di<ot?ue:Qe,ot,V),ot=Ve.length,K=1;else Re==0&&(K=Re=1),ot=(Ve=Qe.slice()).length;if(ot<Tt&&(Ve=[0].concat(Ve)),P(qe,Ve,Tt,V),Tt=qe.length,K==-1)for(;O(Qe,qe,di,Tt)<1;)Re++,P(qe,di<Tt?ue:Qe,Tt,V),Tt=qe.length}else K===0&&(Re++,qe=[0]);at[Z++]=Re,qe[0]?qe[Tt++]=Nt[Ea]||0:(qe=[Nt[Ea]],Tt=1)}while((Ea++<Fi||qe[0]!=null)&&Ue--);me=qe[0]!=null,at[0]||at.splice(0,1)}if(V==d){for(Z=1,Ue=at[0];10<=Ue;Ue/=10,Z++);et(Rt,X+(Rt.e=Z+j*f-1)+1,B,me)}else Rt.e=j,Rt.r=+me;return Rt}})(),Ke=/^(-?)0([xbo])(?=\w[\w.]*$)/i,xe=/^([^.]+)\.$/,Se=/^\.([^.]+)$/,ve=/^-?(Infinity|NaN)$/,He=/^\s*\+(?=[\w.])|^\s+|\s+$/g,re=function(T,O,P,Y){var F,X=P?O:O.replace(He,"");if(ve.test(X))T.s=isNaN(X)?null:X<0?-1:1,T.c=T.e=null;else{if(!P&&(X=X.replace(Ke,function(B,V,K){return F=(K=K.toLowerCase())=="x"?16:K=="b"?2:8,Y&&Y!=F?B:V}),Y&&(F=Y,X=X.replace(xe,"$1").replace(Se,"0.$1")),O!=X))return new Q(X,F);if(Q.DEBUG)throw Error(h+"Not a"+(Y?" base "+Y:"")+" number: "+O);T.c=T.e=T.s=null}},w.absoluteValue=w.abs=function(){var T=new Q(this);return T.s<0&&(T.s=1),T},w.comparedTo=function(T,O){return A(this,new Q(T,O))},w.decimalPlaces=w.dp=function(T,O){var P,Y,F;if(T!=null)return I(T,0,y),O==null?O=x:I(O,0,8),et(new Q(this),T+this.e+1,O);if(!(P=this.c))return null;if(Y=((F=P.length-1)-C(this.e/f))*f,F=P[F])for(;F%10==0;F/=10,Y--);return Y<0&&(Y=0),Y},w.dividedBy=w.div=function(T,O){return q(this,new Q(T,O),b,x)},w.dividedToIntegerBy=w.idiv=function(T,O){return q(this,new Q(T,O),0,1)},w.exponentiatedBy=w.pow=function(T,O){var P,Y,F,X,B,V,K,j,Z=this;if((T=new Q(T)).c&&!T.isInteger())throw Error(h+"Exponent not an integer: "+ke(T));if(O!=null&&(O=new Q(O)),B=14<T.e,!Z.c||!Z.c[0]||Z.c[0]==1&&!Z.e&&Z.c.length==1||!T.c||!T.c[0])return j=new Q(Math.pow(+ke(Z),B?2-H(T):+ke(T))),O?j.mod(O):j;if(V=T.s<0,O){if(O.c?!O.c[0]:!O.s)return new Q(NaN);(Y=!V&&Z.isInteger()&&O.isInteger())&&(Z=Z.mod(O))}else{if(9<T.e&&(0<Z.e||Z.e<-1||(Z.e==0?1<Z.c[0]||B&&24e7<=Z.c[1]:Z.c[0]<8e13||B&&Z.c[0]<=9999975e7)))return X=Z.s<0&&H(T)?-0:0,-1<Z.e&&(X=1/X),new Q(V?1/X:X);le&&(X=l(le/f+2))}for(K=B?(P=new Q(.5),V&&(T.s=1),H(T)):(F=Math.abs(+ke(T)))%2,j=new Q(S);;){if(K){if(!(j=j.times(Z)).c)break;X?j.c.length>X&&(j.c.length=X):Y&&(j=j.mod(O))}if(F){if((F=u(F/2))===0)break;K=F%2}else if(et(T=T.times(P),T.e+1,1),14<T.e)K=H(T);else{if((F=+ke(T))==0)break;K=F%2}Z=Z.times(Z),X?Z.c&&Z.c.length>X&&(Z.c.length=X):Y&&(Z=Z.mod(O))}return Y?j:(V&&(j=S.div(j)),O?j.mod(O):X?et(j,le,x,void 0):j)},w.integerValue=function(T){var O=new Q(this);return T==null?T=x:I(T,0,8),et(O,O.e+1,T)},w.isEqualTo=w.eq=function(T,O){return A(this,new Q(T,O))===0},w.isFinite=function(){return!!this.c},w.isGreaterThan=w.gt=function(T,O){return 0<A(this,new Q(T,O))},w.isGreaterThanOrEqualTo=w.gte=function(T,O){return(O=A(this,new Q(T,O)))===1||O===0},w.isInteger=function(){return!!this.c&&C(this.e/f)>this.c.length-2},w.isLessThan=w.lt=function(T,O){return A(this,new Q(T,O))<0},w.isLessThanOrEqualTo=w.lte=function(T,O){return(O=A(this,new Q(T,O)))===-1||O===0},w.isNaN=function(){return!this.s},w.isNegative=function(){return this.s<0},w.isPositive=function(){return 0<this.s},w.isZero=function(){return!!this.c&&this.c[0]==0},w.minus=function(T,O){var P,Y,F,X,B=this,V=B.s;if(O=(T=new Q(T,O)).s,!V||!O)return new Q(NaN);if(V!=O)return T.s=-O,B.plus(T);var K=B.e/f,j=T.e/f,Z=B.c,me=T.c;if(!K||!j){if(!Z||!me)return Z?(T.s=-O,T):new Q(me?B:NaN);if(!Z[0]||!me[0])return me[0]?(T.s=-O,T):new Q(Z[0]?B:x==3?-0:0)}if(K=C(K),j=C(j),Z=Z.slice(),V=K-j){for((F=(X=V<0)?(V=-V,Z):(j=K,me)).reverse(),O=V;O--;F.push(0));F.reverse()}else for(Y=(X=(V=Z.length)<(O=me.length))?V:O,V=O=0;O<Y;O++)if(Z[O]!=me[O]){X=Z[O]<me[O];break}if(X&&(F=Z,Z=me,me=F,T.s=-T.s),0<(O=(Y=me.length)-(P=Z.length)))for(;O--;Z[P++]=0);for(O=d-1;V<Y;){if(Z[--Y]<me[Y]){for(P=Y;P&&!Z[--P];Z[P]=O);--Z[P],Z[Y]+=d}Z[Y]-=me[Y]}for(;Z[0]==0;Z.splice(0,1),--j);return Z[0]?wt(T,Z,j):(T.s=x==3?-1:1,T.c=[T.e=0],T)},w.modulo=w.mod=function(T,O){var P,Y,F=this;return T=new Q(T,O),!F.c||!T.s||T.c&&!T.c[0]?new Q(NaN):!T.c||F.c&&!F.c[0]?new Q(F):(we==9?(Y=T.s,T.s=1,P=q(F,T,0,3),T.s=Y,P.s*=Y):P=q(F,T,0,we),(T=F.minus(P.times(T))).c[0]||we!=1||(T.s=F.s),T)},w.multipliedBy=w.times=function(T,O){var P,Y,F,X,B,V,K,j,Z,me,Re,Ve,ot,Rt,at,qe=this,Tt=qe.c,dn=(T=new Q(T,O)).c;if(!(Tt&&dn&&Tt[0]&&dn[0]))return!qe.s||!T.s||Tt&&!Tt[0]&&!dn||dn&&!dn[0]&&!Tt?T.c=T.e=T.s=null:(T.s*=qe.s,Tt&&dn?(T.c=[0],T.e=0):T.c=T.e=null),T;for(Y=C(qe.e/f)+C(T.e/f),T.s*=qe.s,(K=Tt.length)<(me=dn.length)&&(ot=Tt,Tt=dn,dn=ot,F=K,K=me,me=F),F=K+me,ot=[];F--;ot.push(0));for(Rt=d,at=v,F=me;0<=--F;){for(P=0,Re=dn[F]%at,Ve=dn[F]/at|0,X=F+(B=K);F<X;)P=((j=Re*(j=Tt[--B]%at)+(V=Ve*j+(Z=Tt[B]/at|0)*Re)%at*at+ot[X]+P)/Rt|0)+(V/at|0)+Ve*Z,ot[X--]=j%Rt;ot[X]=P}return P?++Y:ot.splice(0,1),wt(T,ot,Y)},w.negated=function(){var T=new Q(this);return T.s=-T.s||null,T},w.plus=function(T,O){var P,Y=this,F=Y.s;if(O=(T=new Q(T,O)).s,!F||!O)return new Q(NaN);if(F!=O)return T.s=-O,Y.minus(T);var X=Y.e/f,B=T.e/f,V=Y.c,K=T.c;if(!X||!B){if(!V||!K)return new Q(F/0);if(!V[0]||!K[0])return K[0]?T:new Q(V[0]?Y:0*F)}if(X=C(X),B=C(B),V=V.slice(),F=X-B){for((P=0<F?(B=X,K):(F=-F,V)).reverse();F--;P.push(0));P.reverse()}for((F=V.length)-(O=K.length)<0&&(P=K,K=V,V=P,O=F),F=0;O;)F=(V[--O]=V[O]+K[O]+F)/d|0,V[O]=d===V[O]?0:V[O]%d;return F&&(V=[F].concat(V),++B),wt(T,V,B)},w.precision=w.sd=function(T,O){var P,Y,F;if(T!=null&&T!==!!T)return I(T,1,y),O==null?O=x:I(O,0,8),et(new Q(this),T,O);if(!(P=this.c))return null;if(Y=(F=P.length-1)*f+1,F=P[F]){for(;F%10==0;F/=10,Y--);for(F=P[0];10<=F;F/=10,Y++);}return T&&this.e+1>Y&&(Y=this.e+1),Y},w.shiftedBy=function(T){return I(T,-m,m),this.times("1e"+T)},w.squareRoot=w.sqrt=function(){var T,O,P,Y,F,X=this,B=X.c,V=X.s,K=X.e,j=b+4,Z=new Q("0.5");if(V!==1||!B||!B[0])return new Q(!V||V<0&&(!B||B[0])?NaN:B?X:1/0);if((P=(V=Math.sqrt(+ke(X)))==0||V==1/0?(((O=R(B)).length+K)%2==0&&(O+="0"),V=Math.sqrt(+O),K=C((K+1)/2)-(K<0||K%2),new Q(O=V==1/0?"1e"+K:(O=V.toExponential()).slice(0,O.indexOf("e")+1)+K)):new Q(V+"")).c[0]){for((V=(K=P.e)+j)<3&&(V=0);;)if(F=P,P=Z.times(F.plus(q(X,F,j,1))),R(F.c).slice(0,V)===(O=R(P.c)).slice(0,V)){if(P.e<K&&--V,(O=O.slice(V-3,V+1))!="9999"&&(Y||O!="4999")){+O&&(+O.slice(1)||O.charAt(0)!="5")||(et(P,P.e+b+2,1),T=!P.times(P).eq(X));break}if(!Y&&(et(F,F.e+b+2,0),F.times(F).eq(X))){P=F;break}j+=4,V+=4,Y=1}}return et(P,P.e+b+1,x,T)},w.toExponential=function(T,O){return T!=null&&(I(T,0,y),T++),Je(this,T,O,1)},w.toFixed=function(T,O){return T!=null&&(I(T,0,y),T=T+this.e+1),Je(this,T,O)},w.toFormat=function(T,O,P){var Y;if(P==null)T!=null&&O&&typeof O=="object"?(P=O,O=null):T&&typeof T=="object"?(P=T,T=O=null):P=$e;else if(typeof P!="object")throw Error(h+"Argument not an object: "+P);if(Y=this.toFixed(T,O),this.c){var F,X=Y.split("."),B=+P.groupSize,V=+P.secondaryGroupSize,K=P.groupSeparator||"",j=X[0],Z=X[1],me=this.s<0,Re=me?j.slice(1):j,Ve=Re.length;if(V&&(F=B,B=V,Ve-=V=F),0<B&&0<Ve){for(F=Ve%B||B,j=Re.substr(0,F);F<Ve;F+=B)j+=K+Re.substr(F,B);0<V&&(j+=K+Re.slice(F)),me&&(j="-"+j)}Y=Z?j+(P.decimalSeparator||"")+((V=+P.fractionGroupSize)?Z.replace(new RegExp("\\d{"+V+"}\\B","g"),"$&"+(P.fractionGroupSeparator||"")):Z):j}return(P.prefix||"")+Y+(P.suffix||"")},w.toFraction=function(T){var O,P,Y,F,X,B,V,K,j,Z,me,Re,Ve=this,ot=Ve.c;if(T!=null&&(!(V=new Q(T)).isInteger()&&(V.c||V.s!==1)||V.lt(S)))throw Error(h+"Argument "+(V.isInteger()?"out of range: ":"not an integer: ")+ke(V));if(!ot)return new Q(Ve);for(O=new Q(S),j=P=new Q(S),Y=K=new Q(S),Re=R(ot),X=O.e=Re.length-Ve.e-1,O.c[0]=p[(B=X%f)<0?f+B:B],T=!T||0<V.comparedTo(O)?0<X?O:j:V,B=ne,ne=1/0,V=new Q(Re),K.c[0]=0;Z=q(V,O,0,1),(F=P.plus(Z.times(Y))).comparedTo(T)!=1;)P=Y,Y=F,j=K.plus(Z.times(F=j)),K=F,O=V.minus(Z.times(F=O)),V=F;return F=q(T.minus(P),Y,0,1),K=K.plus(F.times(j)),P=P.plus(F.times(Y)),K.s=j.s=Ve.s,me=q(j,Y,X*=2,x).minus(Ve).abs().comparedTo(q(K,P,X,x).minus(Ve).abs())<1?[j,Y]:[K,P],ne=B,me},w.toNumber=function(){return+ke(this)},w.toPrecision=function(T,O){return T!=null&&I(T,1,y),Je(this,T,O,2)},w.toString=function(T){var O,P=this,Y=P.s,F=P.e;return F===null?Y?(O="Infinity",Y<0&&(O="-"+O)):O="NaN":(O=T==null?F<=L||$<=F?k(R(P.c),F):W(R(P.c),F,"0"):T===10?W(R((P=et(new Q(P),b+F+1,x)).c),P.e,"0"):(I(T,2,Be.length,"Base"),J(W(R(P.c),F,"0"),10,T,Y,!0)),Y<0&&P.c[0]&&(O="-"+O)),O},w.valueOf=w.toJSON=function(){return ke(this)},w._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(w[Symbol.toStringTag]="BigNumber",w[Symbol.for("nodejs.util.inspect.custom")]=w.valueOf),G!=null&&Q.set(G),Q})()).default=o.BigNumber=o,r!==void 0&&r.exports?r.exports=o:(s||(s=typeof self<"u"&&self?self:window),s.BigNumber=o)})(this)},{}],2:[function(t,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(s){var o=s%10;return~~(s%100/10)==1?"th":o===1?"st":o===2?"nd":o===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,r,i){function s(C,R){return(function(A){if(Array.isArray(A))return A})(C)||(function(A,I){var H=[],k=!0,W=!1,z=void 0;try{for(var G,q=A[Symbol.iterator]();!(k=(G=q.next()).done)&&(H.push(G.value),!I||H.length!==I);k=!0);}catch(J){W=!0,z=J}finally{try{k||q.return==null||q.return()}finally{if(W)throw z}}return H})(C,R)||(function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")})()}var o=t("./globalState"),a=t("./validating"),l=t("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],h={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(C){var R=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},A=2<arguments.length?arguments[2]:void 0;if(typeof R=="string"&&(R=l.parseFormat(R)),!a.validateFormat(R))return"ERROR: invalid format";var I=R.prefix||"",H=R.postfix||"",k=(function(W,z,G){switch(z.output){case"currency":return z=y(z,o.currentCurrencyDefaultFormat()),(function(Be,Q,Je){var nt=Je.currentCurrency(),wt=Object.assign({},c,Q),et=void 0,ke="",T=!!wt.totalLength||!!wt.forceAverage||wt.average,O=Q.currencyPosition||nt.position,P=Q.currencySymbol||nt.symbol;wt.spaceSeparated&&(ke=" "),O==="infix"&&(et=ke+P+ke);var Y=v({instance:Be,providedFormat:Q,state:Je,decimalSeparator:et});return O==="prefix"&&(Y=Be._value<0&&wt.negative==="sign"?"-".concat(ke).concat(P).concat(Y.slice(1)):P+ke+Y),O&&O!=="postfix"||(Y=Y+(ke=T?"":ke)+P),Y})(W,z,o);case"percent":return z=y(z,o.currentPercentageDefaultFormat()),(function(Be,Q,Je,nt){var wt=Q.prefixSymbol,et=v({instance:nt(100*Be._value),providedFormat:Q,state:Je}),ke=Object.assign({},c,Q);return wt?"%".concat(ke.spaceSeparated?" ":"").concat(et):"".concat(et).concat(ke.spaceSeparated?" ":"","%")})(W,z,o,G);case"byte":return z=y(z,o.currentByteDefaultFormat()),S=W,x=o,L=G,$=(b=z).base||"binary",ee=h[$],ne=f(S._value,ee.suffixes,ee.scale),he=ne.value,we=ne.suffix,le=v({instance:L(he),providedFormat:b,state:x,defaults:x.currentByteDefaultFormat()}),$e=x.currentAbbreviations(),"".concat(le).concat($e.spaced?" ":"").concat(we);case"time":return z=y(z,o.currentTimeDefaultFormat()),Se=W,ve=Math.floor(Se._value/60/60),He=Math.floor((Se._value-60*ve*60)/60),w=Math.round(Se._value-60*ve*60-60*He),"".concat(ve,":").concat(He<10?"0":"").concat(He,":").concat(w<10?"0":"").concat(w);case"ordinal":return z=y(z,o.currentOrdinalDefaultFormat()),q=W,J=z,ie=(re=o).currentOrdinal(),ae=Object.assign({},c,J),Ke=v({instance:q,providedFormat:J,state:re}),xe=ie(q._value),"".concat(Ke).concat(ae.spaceSeparated?" ":"").concat(xe);default:return v({instance:W,providedFormat:z})}var q,J,re,ie,ae,Ke,xe,Se,ve,He,w,S,b,x,L,$,ee,ne,he,we,le,$e})(C,R,A);return k=(k=I+k)+H}function f(C,R,A){var I=R[0],H=Math.abs(C);if(A<=H){for(var k=1;k<R.length;++k){var W=Math.pow(A,k),z=Math.pow(A,k+1);if(W<=H&&H<z){I=R[k],C/=W;break}}I===R[0]&&(C/=Math.pow(A,R.length-1),I=R[R.length-1])}return{value:C,suffix:I}}function m(C){for(var R="",A=0;A<C;A++)R+="0";return R}function p(C,R){return C.toString().indexOf("e")!==-1?(function(A,I){var H=A.toString(),k=s(H.split("e"),2),W=k[0],z=k[1],G=s(W.split("."),2),q=G[0],J=G[1],re=J===void 0?"":J;if(0<+z)H=q+re+m(z-re.length);else{var ie=".";ie=+q<0?"-0".concat(ie):"0".concat(ie);var ae=(m(-z-1)+Math.abs(q)+re).substr(0,I);ae.length<I&&(ae+=m(I-ae.length)),H=ie+ae}return 0<+z&&0<I&&(H+=".".concat(m(I))),H})(C,R):(Math.round(+"".concat(C,"e+").concat(R))/Math.pow(10,R)).toFixed(R)}function v(C){var R=C.instance,A=C.providedFormat,I=C.state,H=I===void 0?o:I,k=C.decimalSeparator,W=C.defaults,z=W===void 0?H.currentDefaults():W,G=R._value;if(G===0&&H.hasZeroFormat())return H.getZeroFormat();if(!isFinite(G))return G.toString();var q,J,re,ie,ae,Ke,xe,Se,ve=Object.assign({},c,z,A),He=ve.totalLength,w=He?0:ve.characteristic,S=ve.optionalCharacteristic,b=ve.forceAverage,x=!!He||!!b||ve.average,L=He?-1:x&&A.mantissa===void 0?0:ve.mantissa,$=!He&&(A.optionalMantissa===void 0?L===-1:ve.optionalMantissa),ee=ve.trimMantissa,ne=ve.thousandSeparated,he=ve.spaceSeparated,we=ve.negative,le=ve.forceSign,$e=ve.exponential,Be="";if(x){var Q=(function(T){var O=T.value,P=T.forceAverage,Y=T.abbreviations,F=T.spaceSeparated,X=F!==void 0&&F,B=T.totalLength,V=B===void 0?0:B,K="",j=Math.abs(O),Z=-1;if(j>=Math.pow(10,12)&&!P||P==="trillion"?(K=Y.trillion,O/=Math.pow(10,12)):j<Math.pow(10,12)&&j>=Math.pow(10,9)&&!P||P==="billion"?(K=Y.billion,O/=Math.pow(10,9)):j<Math.pow(10,9)&&j>=Math.pow(10,6)&&!P||P==="million"?(K=Y.million,O/=Math.pow(10,6)):(j<Math.pow(10,6)&&j>=Math.pow(10,3)&&!P||P==="thousand")&&(K=Y.thousand,O/=Math.pow(10,3)),K&&(K=(X?" ":"")+K),V){var me=O.toString().split(".")[0];Z=Math.max(V-me.length,0)}return{value:O,abbreviation:K,mantissaPrecision:Z}})({value:G,forceAverage:b,abbreviations:H.currentAbbreviations(),spaceSeparated:he,totalLength:He});G=Q.value,Be+=Q.abbreviation,He&&(L=Q.mantissaPrecision)}if($e){var Je=(J=(q={value:G,characteristicPrecision:w}).value,re=q.characteristicPrecision,ie=re===void 0?0:re,ae=s(J.toExponential().split("e"),2),Ke=ae[0],xe=ae[1],Se=+Ke,ie&&1<ie&&(Se*=Math.pow(10,ie-1),xe=0<=(xe=+xe-(ie-1))?"+".concat(xe):xe),{value:Se,abbreviation:"e".concat(xe)});G=Je.value,Be=Je.abbreviation+Be}var nt,wt,et,ke=(function(T,O,P,Y,F){if(Y===-1)return T;var X=p(O,Y),B=s(X.toString().split("."),2),V=B[0],K=B[1],j=K===void 0?"":K;if(j.match(/^0+$/)&&(P||F))return V;var Z=j.match(/0+$/);return F&&Z?"".concat(V,".").concat(j.toString().slice(0,Z.index)):X.toString()})(G.toString(),G,$,L,ee);return ke=(function(T,O,P,Y,F){var X=Y.currentDelimiters(),B=X.thousands;F=F||X.decimal;var V=X.thousandsSize||3,K=T.toString(),j=K.split(".")[0],Z=K.split(".")[1];return P&&(O<0&&(j=j.slice(1)),(function(me,Re){for(var Ve=[],ot=0,Rt=me;0<Rt;Rt--)ot===Re&&(Ve.unshift(Rt),ot=0),ot++;return Ve})(j.length,V).forEach(function(me,Re){j=j.slice(0,me+Re)+B+j.slice(me+Re)}),O<0&&(j="-".concat(j))),K=Z?j+F+Z:j})(ke=(function(T,O,P,Y){var F=T,X=s(F.toString().split("."),2),B=X[0],V=X[1];if(B.match(/^-?0$/)&&P)return V?"".concat(B.replace("0",""),".").concat(V):B.replace("0","");if(B.length<Y)for(var K=Y-B.length,j=0;j<K;j++)F="0".concat(F);return F.toString()})(ke,0,S,w),G,ne,H,k),(x||$e)&&(ke=ke+Be),(le||G<0)&&(nt=ke,et=we,ke=(wt=G)===0?nt:+nt==0?nt.replace("-",""):0<wt?"+".concat(nt):et==="sign"?nt:"(".concat(nt.replace("-",""),")")),ke}function y(C,R){if(!C)return R;var A=Object.keys(C);return A.length===1&&A[0]==="output"?R:C}r.exports=function(C){return{format:function(){for(var R=arguments.length,A=new Array(R),I=0;I<R;I++)A[I]=arguments[I];return d.apply(void 0,A.concat([C]))},getByteUnit:function(){for(var R=arguments.length,A=new Array(R),I=0;I<R;I++)A[I]=arguments[I];return(function(H){var k=h.general;return f(H._value,k.suffixes,k.scale).suffix}).apply(void 0,A.concat([C]))},getBinaryByteUnit:function(){for(var R=arguments.length,A=new Array(R),I=0;I<R;I++)A[I]=arguments[I];return(function(H){var k=h.binary;return f(H._value,k.suffixes,k.scale).suffix}).apply(void 0,A.concat([C]))},getDecimalByteUnit:function(){for(var R=arguments.length,A=new Array(R),I=0;I<R;I++)A[I]=arguments[I];return(function(H){var k=h.decimal;return f(H._value,k.suffixes,k.scale).suffix}).apply(void 0,A.concat([C]))},formatOrDefault:y}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,r,i){var s=t("./en-US"),o=t("./validating"),a=t("./parsing"),l={},u=void 0,h={},c=null,d={};function f(p){u=p}function m(){return h[u]}l.languages=function(){return Object.assign({},h)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return m().currency},l.currentAbbreviations=function(){return m().abbreviations},l.currentDelimiters=function(){return m().delimiters},l.currentOrdinal=function(){return m().ordinal},l.currentDefaults=function(){return Object.assign({},m().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().timeFormat)},l.setDefaults=function(p){p=a.parseFormat(p),o.validateFormat(p)&&(d=p)},l.getZeroFormat=function(){return c},l.setZeroFormat=function(p){return c=typeof p=="string"?p:null},l.hasZeroFormat=function(){return c!==null},l.languageData=function(p){if(p){if(h[p])return h[p];throw new Error('Unknown tag "'.concat(p,'"'))}return m()},l.registerLanguage=function(p){var v=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!o.validateLanguage(p))throw new Error("Invalid language data");h[p.languageTag]=p,v&&f(p.languageTag)},l.setLanguage=function(p){var v=1<arguments.length&&arguments[1]!==void 0?arguments[1]:s.languageTag;if(!h[p]){var y=p.split("-")[0],C=Object.keys(h).find(function(R){return R.split("-")[0]===y});return h[C]?void f(C):void f(v)}f(p)},l.registerLanguage(s),u=s.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,r,i){r.exports=function(s){return{loadLanguagesInNode:function(o){return a=s,void o.forEach(function(l){var u=void 0;try{u=t("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(t,r,i){var s=t("bignumber.js");function o(a,l,u){var h=new s(a._value),c=l;return u.isNumbro(l)&&(c=l._value),c=new s(c),a._value=h.minus(c).toNumber(),a}r.exports=function(a){return{add:function(l,u){return c=u,d=a,f=new s((h=l)._value),m=c,d.isNumbro(c)&&(m=c._value),m=new s(m),h._value=f.plus(m).toNumber(),h;var h,c,d,f,m},subtract:function(l,u){return o(l,u,a)},multiply:function(l,u){return c=u,d=a,f=new s((h=l)._value),m=c,d.isNumbro(c)&&(m=c._value),m=new s(m),h._value=f.times(m).toNumber(),h;var h,c,d,f,m},divide:function(l,u){return c=u,d=a,f=new s((h=l)._value),m=c,d.isNumbro(c)&&(m=c._value),m=new s(m),h._value=f.dividedBy(m).toNumber(),h;var h,c,d,f,m},set:function(l,u){return h=l,d=c=u,a.isNumbro(c)&&(d=c._value),h._value=d,h;var h,c,d},difference:function(l,u){return h=u,o(d=(c=a)(l._value),h,c),Math.abs(d._value);var h,c,d}}}},{"bignumber.js":1}],7:[function(t,r,i){function s(v,y){for(var C=0;C<y.length;C++){var R=y[C];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(v,R.key,R)}}var o=t("./globalState"),a=t("./validating"),l=t("./loading")(p),u=t("./unformatting"),h=t("./formatting")(p),c=t("./manipulating")(p),d=t("./parsing"),f=(function(){function v(R){(function(A,I){if(!(A instanceof I))throw new TypeError("Cannot call a class as a function")})(this,v),this._value=R}var y,C;return y=v,(C=[{key:"clone",value:function(){return p(this._value)}},{key:"format",value:function(){var R=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return h.format(this,R)}},{key:"formatCurrency",value:function(R){return typeof R=="string"&&(R=d.parseFormat(R)),(R=h.formatOrDefault(R,o.currentCurrencyDefaultFormat())).output="currency",h.format(this,R)}},{key:"formatTime",value:function(){var R=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return R.output="time",h.format(this,R)}},{key:"binaryByteUnits",value:function(){return h.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return h.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return h.getByteUnit(this)}},{key:"difference",value:function(R){return c.difference(this,R)}},{key:"add",value:function(R){return c.add(this,R)}},{key:"subtract",value:function(R){return c.subtract(this,R)}},{key:"multiply",value:function(R){return c.multiply(this,R)}},{key:"divide",value:function(R){return c.divide(this,R)}},{key:"set",value:function(R){return c.set(this,m(R))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&s(y.prototype,C),v})();function m(v){var y=v;return p.isNumbro(v)?y=v._value:typeof v=="string"?y=p.unformat(v):isNaN(v)&&(y=NaN),y}function p(v){return new f(m(v))}p.version="2.1.2",p.isNumbro=function(v){return v instanceof f},p.language=o.currentLanguage,p.registerLanguage=o.registerLanguage,p.setLanguage=o.setLanguage,p.languages=o.languages,p.languageData=o.languageData,p.zeroFormat=o.setZeroFormat,p.defaultFormat=o.currentDefaults,p.setDefaults=o.setDefaults,p.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,p.validate=a.validate,p.loadLanguagesInNode=l.loadLanguagesInNode,p.unformat=u.unformat,r.exports=p},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,r,i){r.exports={parseFormat:function(s){var o,a,l,u,h,c,d,f,m,p,v,y,C,R,A,I,H,k,W,z,G=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof s!="string"?s:(a=G,s=(l=(o=s).match(/^{([^}]*)}/))?(a.prefix=l[1],o.slice(l[0].length)):o,h=G,(function(q,J){if(q.indexOf("$")===-1){if(q.indexOf("%")===-1)return q.indexOf("bd")!==-1?(J.output="byte",J.base="general"):q.indexOf("b")!==-1?(J.output="byte",J.base="binary"):q.indexOf("d")!==-1?(J.output="byte",J.base="decimal"):q.indexOf(":")===-1?q.indexOf("o")!==-1&&(J.output="ordinal"):J.output="time";J.output="percent"}else J.output="currency"})(s=(c=(u=s).match(/{([^}]*)}$/))?(h.postfix=c[1],u.slice(0,-c[0].length)):u,G),d=G,(f=s.match(/[1-9]+[0-9]*/))&&(d.totalLength=+f[0]),m=G,(p=s.split(".")[0].match(/0+/))&&(m.characteristic=p[0].length),(function(q,J){if(q.indexOf(".")!==-1){var re=q.split(".")[0];J.optionalCharacteristic=re.indexOf("0")===-1}})(s,G),v=G,s.indexOf("a")!==-1&&(v.average=!0),C=G,(y=s).indexOf("K")!==-1?C.forceAverage="thousand":y.indexOf("M")!==-1?C.forceAverage="million":y.indexOf("B")!==-1?C.forceAverage="billion":y.indexOf("T")!==-1&&(C.forceAverage="trillion"),(function(q,J){var re=q.split(".")[1];if(re){var ie=re.match(/0+/);ie&&(J.mantissa=ie[0].length)}})(s,G),A=G,(R=s).match(/\[\.]/)?A.optionalMantissa=!0:R.match(/\./)&&(A.optionalMantissa=!1),I=G,s.indexOf(",")!==-1&&(I.thousandSeparated=!0),H=G,s.indexOf(" ")!==-1&&(H.spaceSeparated=!0),W=G,(k=s).match(/^\+?\([^)]*\)$/)&&(W.negative="parenthesis"),k.match(/^\+?-/)&&(W.negative="sign"),z=G,s.match(/^\+/)&&(z.forceSign=!0),G)}}},{}],9:[function(t,r,i){var s=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,f=5<arguments.length?arguments[5]:void 0,m=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:(function p(v,y){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",R=3<arguments.length?arguments[3]:void 0,A=4<arguments.length?arguments[4]:void 0,I=5<arguments.length?arguments[5]:void 0,H=6<arguments.length?arguments[6]:void 0;if(!isNaN(+v))return+v;var k="",W=v.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(W!==v)return-1*p(W,y,C,R,A,I,H);for(var z=0;z<s.length;z++){var G=s[z];if((k=v.replace(G.key,""))!==v)return p(k,y,C,R,A,I,H)*G.factor}if((k=v.replace("%",""))!==v)return p(k,y,C,R,A,I,H)/100;var q=parseFloat(v);if(!isNaN(q)){var J=R(q);if(J&&J!=="."&&(k=v.replace(new RegExp("".concat(o(J),"$")),""))!==v)return p(k,y,C,R,A,I,H);var re={};Object.keys(I).forEach(function(He){re[I[He]]=He});for(var ie=Object.keys(re).sort().reverse(),ae=ie.length,Ke=0;Ke<ae;Ke++){var xe=ie[Ke],Se=re[xe];if((k=v.replace(xe,""))!==v){var ve=void 0;switch(Se){case"thousand":ve=Math.pow(10,3);break;case"million":ve=Math.pow(10,6);break;case"billion":ve=Math.pow(10,9);break;case"trillion":ve=Math.pow(10,12)}return p(k,y,C,R,A,I,H)*ve}}}})((function(p,v){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=p.replace(y,"");return C=(C=C.replace(new RegExp("([0-9])".concat(o(v.thousands),"([0-9])"),"g"),"$1$2")).replace(v.decimal,".")})(l,u,h),u,h,c,d,f,m)}r.exports={unformat:function(l,u){var h,c,d,f=t("./globalState"),m=f.currentDelimiters(),p=f.currentCurrency().symbol,v=f.currentOrdinal(),y=f.getZeroFormat(),C=f.currentAbbreviations(),R=void 0;if(typeof l=="string")R=(function(A,I){if(!A.indexOf(":")||I.thousands===":")return!1;var H=A.split(":");if(H.length!==3)return!1;var k=+H[0],W=+H[1],z=+H[2];return!isNaN(k)&&!isNaN(W)&&!isNaN(z)})(l,m)?(h=l.split(":"),c=+h[0],d=+h[1],+h[2]+60*d+3600*c):a(l,m,p,v,y,C,u);else{if(typeof l!="number")return;R=l}if(R!==void 0)return R}}},{"./globalState":4}],10:[function(t,r,i){function s(m){return(function(p){if(Array.isArray(p)){for(var v=0,y=new Array(p.length);v<p.length;v++)y[v]=p[v];return y}})(m)||(function(p){if(Symbol.iterator in Object(p)||Object.prototype.toString.call(p)==="[object Arguments]")return Array.from(p)})(m)||(function(){throw new TypeError("Invalid attempt to spread non-iterable instance")})()}function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(m)}var a=t("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(m,p){return p.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(m){return m.output==="byte"}},characteristic:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(m){return 0<=m},message:"value must be positive"},{restriction:function(m,p){return!p.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(m,p){return p.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},h={languageTag:{type:"string",mandatory:!0,restriction:function(m){return m.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(m){return!!a.unformat(m)}function d(m,p,v){var y=3<arguments.length&&arguments[3]!==void 0&&arguments[3],C=Object.keys(m).map(function(R){if(!p[R])return console.error("".concat(v," Invalid key: ").concat(R)),!1;var A=m[R],I=p[R];if(typeof I=="string"&&(I={type:I}),I.type==="format"){if(!d(A,u,"[Validate ".concat(R,"]"),!0))return!1}else if(o(A)!==I.type)return console.error("".concat(v," ").concat(R,' type mismatched: "').concat(I.type,'" expected, "').concat(o(A),'" provided')),!1;if(I.restrictions&&I.restrictions.length)for(var H=I.restrictions.length,k=0;k<H;k++){var W=I.restrictions[k],z=W.restriction,G=W.message;if(!z(A,m))return console.error("".concat(v," ").concat(R," invalid value: ").concat(G)),!1}return I.restriction&&!I.restriction(A,m)?(console.error("".concat(v," ").concat(R," invalid value: ").concat(I.message)),!1):I.validValues&&I.validValues.indexOf(A)===-1?(console.error("".concat(v," ").concat(R," invalid value: must be among ").concat(JSON.stringify(I.validValues),', "').concat(A,'" provided')),!1):!(I.children&&!d(A,I.children,"[Validate ".concat(R,"]")))});return y||C.push.apply(C,s(Object.keys(p).map(function(R){var A=p[R];if(typeof A=="string"&&(A={type:A}),A.mandatory){var I=A.mandatory;if(typeof I=="function"&&(I=I(m)),I&&m[R]===void 0)return console.error("".concat(v,' Missing mandatory key "').concat(R,'"')),!1}return!0}))),C.reduce(function(R,A){return R&&A},!0)}function f(m){return d(m,u,"[Validate format]")}r.exports={validate:function(m,p){var v=c(m),y=f(p);return v&&y},validateFormat:f,validateInput:c,validateLanguage:function(m){return d(m,h,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(jb)),jb.exports}var JJ=ZJ();const Bu=B2(JJ),eee="numeric";function WB(n,e){if(oi(n)){const t=e.numericFormat,r=t&&t.culture||"-",i=t&&t.pattern;if(typeof r<"u"&&!Bu.languages()[r]){const s=r.replace("-",""),o=Bu.allLanguages?Bu.allLanguages[r]:Bu[s];o&&Bu.registerLanguage(o)}Bu.setLanguage(r),n=Bu(n).format(i||"0")}return n}function tO(n,e,t,r,i,s,o){let a=s;if(oi(a)){const l=o.className||"",u=l.length?l.split(" "):[];a=WB(a,o),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),o.className=u.join(" "),e.dir="ltr"}vl(n,e,t,r,i,a,o)}tO.RENDERER_TYPE=eee;const tee="password";function nO(n,e,t,r,i,s,o){vl.apply(this,[n,e,t,r,i,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let u="";De(a-1,()=>{u+=l}),Qd(e,u)}nO.RENDERER_TYPE=tee;const nee="select";function rO(n,e,t,r,i,s,o){vl.apply(this,[n,e,t,r,i,s,o])}rO.RENDERER_TYPE=nee;const ree="time";function iO(n,e,t,r,i,s,o){vl.apply(this,[n,e,t,r,i,s,o]),e.dir="ltr"}iO.RENDERER_TYPE=ree;function iee(){hs(ef),hs(Kg),hs(ZM),hs(QM),hs(eO),hs(XM),hs(tO),hs(nO),hs(rO),hs(vl),hs(iO)}const see="autocomplete";function KC(n,e){let t=n;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,uD(t,e)):uD(t,e)(this.source):e(!0)}KC.VALIDATOR_TYPE=see;function uD(n,e){const t=n;return function(r){let i=!1;for(let s=0,o=r.length;s<o;s++)if(t===r[s]){i=!0;break}e(i)}}function oee(n){const e=new Date(n);return isNaN(new Date(`${n}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const aee="date";function sO(n,e){const t=CU(DB,this.instance);let r=n,i=!0;r==null&&(r="");let s=se(r,this.dateFormat||t.defaultDateFormat,!0).isValid(),o=se(new Date(r)).isValid()||s;if(this.allowEmpty&&r===""&&(o=!0,s=!0),o||(i=!1),!o&&s&&(i=!0),o&&!s)if(this.correctFormat===!0){const a=lee(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}sO.VALIDATOR_TYPE=aee;function lee(n,e){const t=se(oee(n)),r=se(n,e),i=n.search(/[A-z]/g)>-1;let s;return t.isValid()&&t.format("x")===r.format("x")||!r.isValid()||i?s=t:s=r,s.format(e)}const uee="dropdown";function oO(n,e){KC.apply(this,[n,e])}oO.VALIDATOR_TYPE=uee;const hee="numeric";function aO(n,e){let t=n;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:oi(n))}aO.VALIDATOR_TYPE=hee;const cee=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],dee="time";function lO(n,e){const t=this.timeFormat||"h:mm:ss a";let r=!0,i=n;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const o=se(i,cee,!0).isValid()?se(i):se(i,t);let a=o.isValid(),l=se(i,t,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=o.format(t);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}lO.VALIDATOR_TYPE=dee;function fee(){Zc(KC),Zc(oO),Zc(sO),Zc(aO),Zc(lO)}const mee="autocomplete",gee={CELL_TYPE:mee,editor:YM,renderer:ef,validator:KC},pee="checkbox",wee={CELL_TYPE:pee,editor:LB,renderer:ZM},vee="date";function $B(n,e,t,r,i,s,o){ef.apply(this,[n,e,t,r,i,s,o])}$B.RENDERER_TYPE=vee;const yee="date",Cee={CELL_TYPE:yee,editor:HB,renderer:$B,validator:sO},See="dropdown",Ree={CELL_TYPE:See,editor:qM,renderer:QM,validator:oO},Eee="handsontable",bee={CELL_TYPE:Eee,editor:zM,renderer:eO},Tee="numeric",Aee={CELL_TYPE:Tee,editor:FB,renderer:tO,validator:aO,dataType:"number"},Nee="password",Iee={CELL_TYPE:Nee,editor:kB,renderer:nO,copyable:!1},Mee="select",Oee={CELL_TYPE:Mee,editor:VB,renderer:rO},_ee="time",xee={CELL_TYPE:_ee,editor:UB,renderer:iO,validator:lO};function Pee(){Ks(gee),Ks(wee),Ks(Cee),Ks(Ree),Ks(bee),Ks(Aee),Ks(Iee),Ks(Oee),Ks(bB),Ks(xee)}function Lee(n,e){GB(n,e),e.add(n)}function Dee(n,e,t){GB(n,e),e.set(n,t)}function GB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sc(n,e,t){return(e=Hee(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Hee(n){var e=Fee(n,"string");return typeof e=="symbol"?e:e+""}function Fee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Rc(n,e){return n.get(jB(n,e))}function jB(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const hD=new Map([["plugin",IX],["cell-type",gB],["editor",yU],["renderer",NU],["validator",IU]]),kee="base",zb=[];let xo=null;var Wu=new WeakMap,cD=new WeakSet;class Wt{static get PLUGIN_KEY(){return kee}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){Lee(this,cD),Sc(this,"eventManager",new wo(this)),Sc(this,"pluginName",null),Sc(this,"pluginsInitializedCallbacks",[]),Sc(this,"isPluginsReady",!1),Sc(this,"enabled",!1),Sc(this,"initialized",!1),Dee(this,Wu,{}),pl(this,"hot",e,{writable:!1}),xo=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const i=[];if(t.forEach(s=>{const[o,a]=s.split(":");if(!hD.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);hD.get(o)(a)||i.push(` - ${a} (${o})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");zb.push(s)}}if(xo||(xo=AU()),xo.indexOf("UndoRedo")>=0&&xo.splice(xo.indexOf("UndoRedo"),1),xo.indexOf(this.pluginName)>=0&&xo.splice(xo.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),xo.length===0){if(zb.length>0){const i=[`${zb.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t,r){Rc(Wu,this)[e]=Rc(Wu,this)[e]||[];const i=Rc(Wu,this)[e];this.hot.addHook(e,t,r),i.push(t),Rc(Wu,this)[e]=i}removeHooks(e){D(Rc(Wu,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=Rc(Wu,this);gt(e,(t,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){D(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=jB(cD,this,Vee).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),gt(this,(t,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function Vee(n){if(!n)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(n[e[t]]!==void 0)return!0;return!1}function $u(n,e,t){return(e=Uee(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Uee(n){var e=Bee(n,"string");return typeof e=="symbol"?e:e+""}function Bee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let zB=class{constructor(e){$u(this,"hot",null),$u(this,"container",null),$u(this,"injected",!1),$u(this,"rows",[]),$u(this,"columns",[]),$u(this,"samples",null),$u(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),D(this.rows,t=>{const{height:r}=t.table.getBoundingClientRect();e(t.row,Math.ceil(r)-1)})}getWidths(e){this.injected||this.injectTable(),D(this.columns,t=>{const{width:r}=t.table.getBoundingClientRect();e(t.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{D(r.strings,i=>{t.appendChild(this.createColElement(i.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(s=>{D(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),h=t.createElement("td");h.setAttribute("ghost-table",1),u(this.hot,h,e,a,this.hot.colToProp(a),o.value,l),r.appendChild(h)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),t.appendChild(i)}this.samples.forEach(i=>{D(i.strings,s=>{const o=s.col,a=e.createElement("th");r.push([o,a]),t.appendChild(a)})}),this.table.tHead.appendChild(t),D(r,i=>{const[s,o]=i;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment();return this.samples.forEach(i=>{D(i.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),u=t.createElement("td"),h=t.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,o,e,this.hot.colToProp(e),s.value,a),h.appendChild(u),r.appendChild(h)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const r=this.hot.rootDocument.createElement("col");let i=0;t>=0&&e>=0&&(i=this.hot.getCellMeta(t,e).colspan);let s=this.hot.getColWidth(e);if(i>1)for(let o=e+1;o<e+i;o++)s+=this.hot.getColWidth(o);return r.style.width=`${s}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("table"),s=t.createElement("thead"),o=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),u=t.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),s.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&o.appendChild(l),i.appendChild(o),oe(i,e),r.appendChild(i),{fragment:r,table:i,tHead:s,tBody:o,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return oe(i,s),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Zp(n,e,t){return(e=Wee(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Wee(n){var e=$ee(n,"string");return typeof e=="symbol"?e:e+""}function $ee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class qC{static get SAMPLE_COUNT(){return 3}constructor(e){Zp(this,"samples",null),Zp(this,"dataFactory",null),Zp(this,"customSampleCount",null),Zp(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:qC.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,r){const i=new Map,{from:s,to:o}=typeof r=="number"?{from:r,to:r}:r;return De(s,o,a=>{const l=this.generateSample(e,t,a);i.set(a,l)}),i}generateSample(e,t,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",o=[];return De(t.from,t.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:h}=l,c=typeof h=="string"&&h.length>0;let d;c?d=h:mt(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Kn(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(o.indexOf(u)>-1)||this.allowDuplicates||c)&&(f.strings.push({value:u,[s]:a}),o.push(u),f.needed-=1)}),i}}function Gee(n,e){YB(n,e),e.add(n)}function dD(n,e,t){YB(n,e),e.set(n,t)}function YB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xf(n,e,t){return(e=jee(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function jee(n){var e=zee(n,"string");return typeof e=="symbol"?e:e+""}function zee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ah(n,e){return n.get(Qo(n,e))}function uO(n,e,t){return n.set(Qo(n,e),t),t}function Qo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("modifyAutoColumnSizeSeed");const Pf="autoColumnSize",Yee=10,Kee="autoColumnSize";var Jc=new WeakMap,Bd=new WeakMap,Ua=new WeakSet;class Tm extends Wt{static get PLUGIN_KEY(){return Pf}static get PLUGIN_PRIORITY(){return Yee}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Gee(this,Ua),xf(this,"ghostTable",new zB(this.hot)),xf(this,"samplesGenerator",new qC((t,r)=>{const i=this.hot.toPhysicalRow(t),s=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(t,r);let a="";o.spanned||(a=this.hot.getDataAtCell(t,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),xf(this,"inProgress",!1),xf(this,"measuredColumns",0),xf(this,"columnWidthsMap",new vu),dD(this,Jc,[]),dD(this,Bd,[]),this.hot.columnIndexMapper.registerMap(Kee,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,r,i)=>Qo(Ua,this,fD).call(this,t,r,i))}isEnabled(){return this.hot.getSettings()[Pf]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Pf];t&&t.useHeaders!==null&&t.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Qo(Ua,e,Qee).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Qo(Ua,e,Zee).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Qo(Ua,e,ete).call(e,...i)}),this.addHook("beforeRender",()=>Qo(Ua,this,Xee).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>Qo(Ua,this,Jee).call(this)),super.enablePlugin()}updatePlugin(){uO(Bd,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,r)=>Qo(Ua,this,fD).call(this,e,t,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(e===-1||t===-1)return;const r=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:t},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof t=="number"?{from:t,to:t}:t;De(i.from,i.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&this.samplesGenerator.generateColumnSamples(o,s).forEach((u,h)=>this.ghostTable.addColumn(h,u))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((o,a)=>{const l=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){Jv(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Tm.CALCULATION_STEP,i)},e,t),r=r+Tm.CALCULATION_STEP+1,r<i?s=J0(o):(Jv(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,t),r=a+1),r<i?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Pf],t=e&&_n(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&_n(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Pf];let t=Tm.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return mt(e)&&(t=e.syncLimit,zV(t)?t=EU(r,t):t>>=0),Math.min(t,r)}getColumnWidth(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=t;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,kC))),i}getFirstVisibleColumn(){var e;return(e=this.hot.view.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.view.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,s)=>{const o=Ah(Jc,this).length;return(o-1<s||Ah(Jc,this)[s]!==i)&&r.push(this.hot.toVisualColumn(s)),o-1<s?Ah(Jc,this).push(i):Ah(Jc,this)[s]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function qee(n){const e={from:0,to:this.hot.countRows()-1};n.forEach(t=>{const r=this.hot.toPhysicalColumn(t);r!==null&&(this.hot._getColWidthFromSettings(r)||this.samplesGenerator.generateColumnSamples(t,e).forEach((s,o)=>this.ghostTable.addColumn(o,s)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,r)=>{const i=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function Xee(){this.calculateVisibleColumnsWidth(),this.inProgress||(Qo(Ua,this,qee).call(this,Ah(Bd,this)),uO(Bd,this,[]))}function Qee(n,e){e||this.recalculateAllColumnsWidth()}function Zee(n){const e=n.reduce((t,r)=>{let[,i]=r;const s=this.hot.propToCol(i);return Number.isInteger(s)&&t.indexOf(s)===-1&&t.push(s),t},[]);Ah(Bd,this).push(...e)}function fD(n,e,t){let r=n;return t&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function Jee(){uO(Jc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function ete(n){const e=n.reduce((t,r)=>{var i;const s=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);t.indexOf(o)===-1&&t.push(o)}return t},[]);Ah(Bd,this).push(...e)}const Nh={horizontal:"horizontal",vertical:"vertical"};function tte(n,e,t){let r,i,s;return e[0]===n[0]&&e[1]<n[1]?(s="left",r=t(e[0],e[1]),i=t(e[2],n[1]-1)):e[2]===n[2]&&e[0]===n[0]&&e[3]>n[3]?(s="right",r=t(e[0],n[3]+1),i=t(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(s="up",r=t(e[0],e[1]),i=t(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(s="down",r=t(n[2]+1,e[1]),i=t(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:r,endOfDragCoords:i}}function nte(n){const e={};return n===!0?(e.directions=Object.keys(Nh),e.autoInsertRow=!0):mt(n)?(Oe(n.autoInsertRow)?n.direction===Nh.horizontal?e.autoInsertRow=!1:e.autoInsertRow=n.autoInsertRow:e.autoInsertRow=!1,Oe(n.direction)?e.directions=[n.direction]:e.directions=Object.keys(Nh)):typeof n=="string"?(e.directions=[n],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function rte(n,e){ite(n,e),e.add(n)}function ite(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ec(n,e,t){return(e=ste(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ste(n){var e=ote(n,"string");return typeof e=="symbol"?e:e+""}function ote(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Lf(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("modifyAutofillRange");Ae.getSingleton().register("beforeAutofill");Ae.getSingleton().register("afterAutofill");const mD="autofill",ate=20,lte=["fillHandle"],ute="insert_row_below",hte=200;var bc=new WeakSet;class cte extends Wt{constructor(){super(...arguments),rte(this,bc),Ec(this,"addingStarted",!1),Ec(this,"mouseDownOnCellCorner",!1),Ec(this,"mouseDragOutside",!1),Ec(this,"handleDraggedCells",0),Ec(this,"directions",[]),Ec(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return mD}static get PLUGIN_PRIORITY(){return ate}static get SETTING_KEYS(){return[mD,...lte]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Lf(bc,this,fte).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Lf(bc,this,dte).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>Lf(bc,this,mte).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:r}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:r,endRow:i,endCol:s}]),a=[],l=[],u=[];return D(o,h=>{for(let c=h.startRow;c<=h.endRow;c+=1)a.indexOf(c)===-1&&a.push(c);for(let c=h.startCol;c<=h.endCol;c+=1)l.indexOf(c)===-1&&l.push(c)}),D(a,h=>{const c=[];D(l,d=>{c.push(this.hot.getCopyableData(h,d))}),u.push(c)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,t),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:h,startOfDragCoords:c,endOfDragCoords:d}=tte(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(c&&c.row>-1&&c.col>-1){const f=this.getSelectionData(),m=s.clone(),p=this.hot._createCellRange(c,c,d),v=this.hot.runHooks("beforeAutofill",f,m,p,h);if(v===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let y=v;const C=v;if(["up","left"].indexOf(h)>-1&&!(C.length===1&&C[0].length===0))if(y=[],h==="up"){const R=d.row-c.row+1,A=R%C.length;for(let I=0;I<R;I++)y.push(C[(I+(C.length-A))%C.length])}else{const R=d.col-c.col+1,A=R%C[0].length;for(let I=0;I<C.length;I++){y.push([]);for(let H=0;H<R;H++)y[I].push(C[I][(H+(C[I].length-A))%C[I].length])}}this.hot.populateFromArray(c.row,c.col,y,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",y,m,p,h),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),r=t.getBottomEndCorner();let i=e;if(this.directions.includes(Nh.vertical)&&this.directions.includes(Nh.horizontal)){const s=t.getTopStartCorner();(r.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Nh.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Nh.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(ute,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},hte)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&t[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),r=this.hot.countRows();let i;for(let s=e[2]+1;s<r;s++){for(let l=e[1];l<=e[3];l++){const u=t[s][l];if(!Bn(u))return-1}const o=t[s][e[1]-1],a=t[s][e[3]+1];(!Bn(o)||!Bn(a))&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...bt(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,r=Sr(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+Xn(this.hot.table),i=Sr(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+cn(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Lf(bc,this,gte).call(this)),this.eventManager.addEventListener(e,"mousemove",t=>Lf(bc,this,pte).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=nte(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function dte(){this.selectAdjacent()&&this.fillIn()}function fte(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function mte(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(n),this.addNewRowIfNeeded())}function gte(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function pte(n){const e=this.getIfMouseWasDraggedOutside(n);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function wte(n,e){KB(n,e),e.add(n)}function vte(n,e,t){KB(n,e),e.set(n,t)}function KB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tc(n,e,t){return(e=yte(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yte(n){var e=Cte(n,"string");return typeof e=="symbol"?e:e+""}function Cte(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ste(n,e,t){return n.set(Zo(n,e),t),t}function hO(n,e){return n.get(Zo(n,e))}function Zo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Jp="autoRowSize",Rte=40,Ete="autoRowSize";var hg=new WeakMap,Ba=new WeakSet;class Am extends Wt{static get PLUGIN_KEY(){return Jp}static get PLUGIN_PRIORITY(){return Rte}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),wte(this,Ba),Tc(this,"headerHeight",null),Tc(this,"ghostTable",new zB(this.hot)),Tc(this,"samplesGenerator",new qC((t,r)=>{const i=this.hot.toPhysicalRow(t),s=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s)||t>=0&&r>=0&&this.hot.getCellMeta(t,r).hidden)return!1;let o;return t>=0?o=this.hot.getDataAtCell(t,r):t===-1&&(o=this.hot.getColHeader(r)),{value:o}})),Tc(this,"inProgress",!1),Tc(this,"measuredRows",0),Tc(this,"rowHeightsMap",new vu),vte(this,hg,[]),this.hot.rowIndexMapper.registerMap(Ete,this.rowHeightsMap),this.addHook("beforeRowResize",(t,r,i)=>Zo(Ba,this,gD).call(this,t,r,i))}isEnabled(){const e=this.hot.getSettings()[Jp];return e===!0||mt(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Zo(Ba,e,Ate).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Zo(Ba,e,Nte).call(e,...r)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Zo(Ba,e,Mte).call(e,...r)}),this.addHook("beforeRender",()=>Zo(Ba,this,Tte).call(this)),this.addHook("modifyRowHeight",(t,r)=>this.getRowHeight(r,t)),this.addHook("init",()=>Zo(Ba,this,Ite).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,r)=>Zo(Ba,this,gD).call(this,e,t,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(e===-1||t===-1)return;const r=this.hot.renderCall;this.calculateRowsHeight({from:e,to:t},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}De(i.from,i.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((u,h)=>this.ghostTable.addRow(h,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){Jv(s),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+Am.CALCULATION_STEP,i)},e,t),r=r+Am.CALCULATION_STEP+1,r<i?s=J0(o):(Jv(s),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,t),r=a+1),r<i?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const e=this.hot.getSettings()[Jp],t=e&&_n(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&_n(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Jp];let t=Am.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return mt(e)&&(t=e.syncLimit,zV(t)?t=EU(r,t):t>>=0),Math.min(t,r)}getRowHeight(e,t){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=t;return r!==null&&r>(t||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.view.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.view.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{De(Math.min(t,r),Math.max(t,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function bte(n){const e={from:0,to:this.hot.countCols()-1};n.forEach(t=>{this.samplesGenerator.generateRowSamples(t,e).forEach((i,s)=>this.ghostTable.addRow(s,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,r)=>{const i=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function Tte(){this.calculateVisibleRowsHeight(),this.inProgress||(Zo(Ba,this,bte).call(this,hO(hg,this)),Ste(hg,this,[]))}function gD(n,e,t){let r=n;return t&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function Ate(n,e){e||this.recalculateAllRowsHeight()}function Nte(n){const e=n.reduce((t,r)=>{let[i]=r;return t.indexOf(i)===-1&&t.push(i),t},[]);hO(hg,this).push(...e)}function Ite(){this.recalculateAllRowsHeight()}function Mte(n){const e=n.reduce((t,r)=>{var i;const s=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);t.indexOf(o)===-1&&t.push(o)}return t},[]);hO(hg,this).push(...e)}const{getListWithInsertedItems:Ote,getListWithRemovedItems:_te}=QU("physicallyIndexed");class xte extends sc{constructor(){super(e=>e)}insert(e,t){const r=NI(this.indexedValues,t);this.indexedValues=Ote(r,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=_te(this.indexedValues,e);this.indexedValues=AI(t,e),super.remove(e)}}const{getListWithInsertedItems:Pte,getListWithRemovedItems:Lte}=QU("physicallyIndexed");class Dte extends sc{constructor(){super(e=>e)}insert(e,t){this.indexedValues=Pte(this.indexedValues,e,t,(r,i)=>this.getNextValue(i)),super.insert(e,t)}remove(e){this.indexedValues=Lte(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function Hte(n,e){Fte(n,e),e.add(n)}function Fte(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kte(n,e,t){return(e=Vte(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Vte(n){var e=Ute(n,"string");return typeof e=="symbol"?e:e+""}function Ute(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Bte(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Yb="bindRowsWithHeaders",Wte=210,$te="loose",Gte=new Map([["loose",xte],["strict",Dte]]);var pD=new WeakSet;class jte extends Wt{constructor(){super(...arguments),Hte(this,pD),kte(this,"headerIndexes",null)}static get PLUGIN_KEY(){return Yb}static get PLUGIN_PRIORITY(){return Wte}isEnabled(){return!!this.hot.getSettings()[Yb]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[Yb];typeof e!="string"&&(e=$te);const t=Gte.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",r=>Bte(pD,this,zte).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function zte(n){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(n))}function Yte(n,e){qB(n,e),e.add(n)}function Kte(n,e,t){qB(n,e),e.set(n,t)}function qB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wD(n,e,t){return(e=qte(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function qte(n){var e=Xte(n,"string");return typeof e=="symbol"?e:e+""}function Xte(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vD(n,e){return n.get(dd(n,e))}function Kb(n,e,t){return n.set(dd(n,e),t),t}function dd(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const yv="collapsibleColumns",Qte=290,Zte=["nestedHeaders"],Ed="collapsibleIndicator",yD=yv,CD=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Ac=new WeakMap,Df=new WeakSet;class Jte extends Wt{constructor(){super(...arguments),Yte(this,Df),wD(this,"nestedHeadersPlugin",null),wD(this,"headerStateManager",null),Kte(this,Ac,null)}static get PLUGIN_KEY(){return yv}static get PLUGIN_PRIORITY(){return Qte}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[yv,...Zte]}isEnabled(){return!!this.hot.getSettings()[yv]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||jt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Kb(Ac,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>dd(Df,this,nne).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return dd(Df,e,rne).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return dd(Df,e,ene).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,s)=>dd(Df,this,tne).call(this,r,i,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Kb(Ac,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(t,r))!==null&&e!==void 0?e:{};if(i)return s?this.expandSection({row:t,col:o}):this.collapseSection({row:t,col:o}),!1},runOnlyIf:()=>{var e,t;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight.isHeader())},group:yD,relativeToGroup:yu,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yD)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};De(0,e-1,o=>{const a=t.childNodes[o],l=r.childNodes[o],u=i?i.childNodes[o]:null;De(0,a.childNodes.length-1,h=>{let c=a.childNodes[h].querySelector(`.${Ed}`);s(c),l&&l.childNodes[h]&&(c=l.childNodes[h].querySelector(`.${Ed}`),s(c)),i&&u&&u.childNodes[h]&&(c=u.childNodes[h].querySelector(`.${Ed}`),s(c))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=r;if(i===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!CD.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const r=du(e,f=>{let{row:m}=f;return m<0});let i=r.length>0;D(r,f=>{var m;let{row:p,col:v}=f;const{collapsible:y,isCollapsed:C}=(m=this.headerStateManager.getHeaderSettings(p,v))!==null&&m!==void 0?m:{};if(!y||C&&t==="collapse"||!C&&t==="expand")return i=!1,!1});const s=[],o=[];i&&D(r,f=>{let{row:m,col:p}=f;const{colspanCompensation:v,affectedColumns:y,rollbackModification:C}=this.headerStateManager.triggerNodeModification(t,m,p);v>0&&(o.push(...y),s.push(C))});const a=this.getCollapsedColumns();let l=[];t==="collapse"?l=GV([...a,...o]):t==="expand"&&(l=du(a,f=>!o.includes(f)));const u=CD.get(t);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){D(s,f=>{f()});return}this.hot.batchExecution(()=>{D(o,f=>{vD(Ac,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const c=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(t==="collapse"&&c&&d){const{row:f,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&o.includes(m)){const v=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,y=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;v!==null&&y!==null&&this.hot.selectCell(v,y)}}this.hot.runHooks(u.afterHook,a,l,i,c),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return vD(Ac,this).getHiddenIndexes()}destroy(){Kb(Ac,this,null),super.destroy()}}function ene(n,e,t){var r;const{collapsible:i,origColspan:s,isCollapsed:o}=(r=this.headerStateManager.getHeaderSettings(t,n))!==null&&r!==void 0?r:{},a=i&&s>1&&n>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Ed}`);if(Xd(e,[Es("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),oe(u,Ed),e.querySelector("div:first-child").appendChild(u)),rt(u,["collapsed","expanded"]),o?(oe(u,"collapsed"),Vh(u,"+"),l&&Xe(e,...Es(!1))):(oe(u,"expanded"),Vh(u,"-"),l&&Xe(e,...Es(!0))),l&&Xe(u,...ic());else{var h;(h=u)===null||h===void 0||h.remove()}}function tne(n,e){Ze(n.target,Ed)&&(Ze(n.target,"expanded")?(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ze(n.target,"collapsed")&&(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ro(n))}function nne(){this.updatePlugin()}function rne(n,e){e||this.updatePlugin()}function Gu(n,e,t){return(e=ine(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ine(n){var e=sne(n,"string");return typeof e=="symbol"?e:e+""}function sne(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const one=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],ane=!1,lne=!0,une=!0;class hne{constructor(e,t){Gu(this,"hot",void 0),Gu(this,"sortingStates",new WC),Gu(this,"sortEmptyCells",ane),Gu(this,"indicator",lne),Gu(this,"headerAction",une),Gu(this,"compareFunctionFactory",void 0),Gu(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){mt(e)&&gt(e,(t,r)=>{one.includes(r)&&(this[r]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[r]=t;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return mt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[r,i]=t;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(Oe(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function XB(n,e,t){const r=e.locale;return function(i,s){const{sortEmptyCells:o}=t;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof s=="string"&&(s=s.toLocaleLowerCase(r)),i===s?ha:Bn(i)?Bn(s)?ha:o&&n==="asc"?Mn:On:Bn(s)?o&&n==="asc"?On:Mn:isNaN(i)&&!isNaN(s)?n==="asc"?On:Mn:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?n==="asc"?Mn:On:i>s?n==="asc"?On:Mn:ha}}const QB="default";function cne(n,e,t){return function(r,i){const s=parseFloat(r),o=parseFloat(i),{sortEmptyCells:a}=t;if(s===o||isNaN(s)&&isNaN(o))return ha;if(a){if(Bn(r))return n==="asc"?Mn:On;if(Bn(i))return n==="asc"?On:Mn}return isNaN(s)?On:isNaN(o)?Mn:s<o?n==="asc"?Mn:On:s>o?n==="asc"?On:Mn:ha}}const dne="numeric";function fne(n,e,t){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=t;return function(o,a){const l=Bn(o),u=Bn(a),h=l?i:o,c=u?i:a,d=h===i||h===r,f=c===i||c===r;if(s===!1){if(l&&u===!1)return On;if(l===!1&&u)return Mn}return d===!1&&f?n==="asc"?Mn:On:d&&f===!1?n==="asc"?On:Mn:d===!1&&f===!1?XB(n,e,t)(o,a):h===i&&c===r?n==="asc"?Mn:On:h===r&&c===i?n==="asc"?On:Mn:ha}}const mne="checkbox";function gne(n,e,t){return rW(n,e.dateFormat,t)}const pne="date";function wne(n,e,t){return rW(n,e.timeFormat,t)}const vne="time",{register:qg,getItem:SD,hasItem:yne}=Eo("sorting.compareFunctionFactory"),{register:ZB,getItem:Cne}=Eo("sorting.mainSortComparator");function JB(n){return yne(n)?SD(n):SD(QB)}qg(mne,fne);qg(pne,gne);qg(QB,XB);qg(dne,cne);qg(vne,wne);const ha=0,Mn=-1,On=1;function Sne(n,e){const t=Cne(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];n.sort(t(...i))}const gy="asc",py="desc",eW="colHeader";function Rne(n){if(mt(n)===!1)return!1;const{column:e,sortOrder:t}=n;return Number.isInteger(e)&&[gy,py].includes(t)}function Ene(n){if(n.some(t=>Rne(t)===!1))return!1;const e=n.map(t=>{let{column:r}=t;return r});return new Set(e).size===e.length}function RD(n){if(n!==py)return n===gy?py:gy}function tW(n){return n.querySelector(`.${eW}`)}function nW(n,e){if(n<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function cO(n,e,t){return n===-1&&e>=0&&Uh(t)===!1}function rW(n,e,t){return function(r,i){const{sortEmptyCells:s}=t;if(r===i)return ha;if(Bn(r))return Bn(i)?ha:s&&n==="asc"?Mn:On;if(Bn(i))return s&&n==="asc"?On:Mn;const o=se(r,e),a=se(i,e);return o.isValid()?a.isValid()?a.isAfter(o)?n==="asc"?Mn:On:a.isBefore(o)?n==="asc"?On:Mn:ha:Mn:On}}const bne="ascending",Tne="descending",iW="indicatorDisabled",sW="columnSorting",oW="sortAction",aW=new Map([[gy,bne],[py,Tne]]);function Ane(n,e,t,r){const i=[sW];if(r&&i.push(oW),t===!1)return i.push(iW),i;const s=n.getSortOrderOfColumn(e);return Oe(s)&&i.push(aW.get(s)),i}function Nne(){return Array.from(aW.values()).concat(oW,iW,sW)}function Ine(n,e){return function(t,r){const[,...i]=t,[,...s]=r;return(function(a){const l=n[a],u=e[a],h=i[a],c=s[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:JB(u.type))(l,u,d)(h,c)})(0)}}function Mne(n,e){One(n,e),e.add(n)}function One(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ew(n,e,t){return(e=_ne(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _ne(n){var e=xne(n,"string");return typeof e=="symbol"?e:e+""}function xne(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ed(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const wy="columnSorting",Pne=50,vy="append",Lne="replace",ED=wy;ZB(wy,Ine);Ae.getSingleton().register("beforeColumnSort");Ae.getSingleton().register("afterColumnSort");var vh=new WeakSet;class lW extends Wt{constructor(){super(...arguments),Mne(this,vh),ew(this,"columnStatesManager",null),ew(this,"columnMetaCache",null),ew(this,"pluginKey",wy),ew(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return wy}static get PLUGIN_PRIORITY(){return Pne}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new hne(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new vu(t=>{let r=this.hot.toVisualColumn(t);return r===null&&(r=t),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,r)=>ed(vh,this,Dne).call(this,t,r)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ed(vh,e,Fne).call(e,...r)}),this.addHook("afterOnCellMouseDown",(t,r)=>this.onAfterOnCellMouseDown(t,r)),this.addHook("afterInit",()=>ed(vh,this,iN).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ed(vh,e,Hne).call(e,...r)}),this.hot.view&&ed(vh,this,iN).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,r)=>{const i=tW(r);nW(t,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:yu,position:"before",group:ED})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ED)}sort(e){const t=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",t,r,i)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new ZU),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",t,i?r:t,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Oe(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return Ene(e)&&e.every(r=>{let{column:i}=r;return i<=t&&i>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:s,...o}=i;return{column:this.hot.toPhysicalColumn(s),...o}};t.initialConfig=bt(e,r),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,r=i=>{let{column:s,...o}=i;return{column:this.hot.toVisualColumn(s),...o}};return Oe(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=bt(t.initialConfig,r)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(Oe(t)){const i=RD(t);return Oe(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:RD()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vy;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(i){if(hn(o))return[...s.slice(0,r),...s.slice(r+1)];if(t===vy)return[...s.slice(0,r),...s.slice(r+1),o];if(t===Lne)return[...s.slice(0,r),o,...s.slice(r+1)]}return Oe(o)?s.concat(o):s}getPluginColumnConfig(e){if(mt(e)){const t=e[this.pluginKey];if(mt(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(r,t,this.getPluginColumnConfig(s.columns[e])):un(s.columns)?Object.assign(r,t,this.getPluginColumnConfig(s.columns(e))):Object.assign(r,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),r=Object.create(t);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const t=[],r=this.hot.countRows(),i=u=>bt(e,h=>this.hot.getDataAtCell(u,h.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)t.push([this.hot.toPhysicalRow(u)].concat(i(u)));const s=bt(t,u=>u[0]);Sne(t,this.pluginKey,bt(e,u=>u.sortOrder),bt(e,u=>this.getFirstCellSettings(u.column)));for(let u=t.length;u<r;u+=1)t.push([u].concat(i(u)));const o=bt(t,u=>u[0]),a=new Map(bt(s,(u,h)=>[u,o[h]])),l=bt(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(mt(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||mt(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(rt(e,Nne()),this.enabled!==!1){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];oe(e,Ane(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Oe(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&Ze(e.target,eW)}onAfterOnCellMouseDown(e,t){if(cO(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(t.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function iN(){const n=this.getAllSavedSortSettings();if(mt(n))this.sortBySettings(n);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Dne(n,e){const t=tW(e);if(nW(n,e)===!1||t===null)return;const r=this.getFirstCellSettings(n)[this.pluginKey],i=r.indicator,s=r.headerAction;if(this.updateHeaderClasses(t,this.columnStatesManager,n,i,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(n);Xe(e,...Z6(o?`${o}ending`:"none"))}}function Hne(n){n===!0&&this.hot.view&&ed(vh,this,iN).call(this)}function Fne(n,e,t,r){cO(e.row,e.col,n)!==!1&&this.wasClickableHeaderClicked(n,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function ju(n,e,t){return(e=kne(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kne(n){var e=Vne(n,"string");return typeof e=="symbol"?e:e+""}function Vne(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Une{constructor(e,t){ju(this,"plugin",void 0),ju(this,"hot",void 0),ju(this,"endpoints",[]),ju(this,"settings",void 0),ju(this,"settingsType","array"),ju(this,"currentEndpoint",null),ju(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),D(r,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),t.push(s)}),t}assignSetting(e,t,r,i){if(r==="ranges"&&e[r]===void 0){t[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;t[r]=i}else r==="destinationRow"&&t.reversedRowCoords?t[r]=this.hot.countRows()-e[r]-1:t[r]=e[r]}resetSetupBeforeStructureAlteration(e,t,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();D(s,o=>{i==="row"&&o.destinationRow>=t&&(e==="insert_row"?o.alterRowOffset=r:e==="remove_row"&&(o.alterRowOffset=-1*r)),i==="col"&&o.destinationColumn>=t&&(e==="insert_col"?o.alterColumnOffset=r:e==="remove_col"&&(o.alterColumnOffset=-1*r))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,t,r,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),h=e.indexOf("move_row")===0,c=t;D(u,d=>{a==="row"&&d.destinationRow>=c&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=c&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!h),h?D(u,d=>{this.extendEndpointRanges(d,c,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):D(u,d=>{this.shiftEndpointCoordinates(d,c)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,r,i){D(e.ranges,s=>{s[1]&&(t>=s[0]&&t<=s[1]?r>s[1]?s[1]+=i:r<s[0]&&(s[0]-=i):r>=s[0]&&r<=s[1]&&(s[1]-=i,t<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,r=[],i=[];D(t,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));i.push(o)}),D(i,s=>{let o=[];D(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),r.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),r.push(o))})}),e.ranges=r}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,D(e.ranges,r=>{D(r,(i,s)=>{i>=t&&(r[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,o=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],D(e,i=>{this.resetEndpointValue(i,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],D(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],D(e,(r,i,s)=>{`${r[2]||""}`!=`${r[3]}`&&D(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[i][1])===o.sourceColumn&&t.indexOf(a)===-1&&t.push(a)})}),D(t,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(t!==null){const r=this.hot.getCellMeta(t,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?r:0)),this.hot.toVisualColumn(e.destinationColumn+(t?i:0)),""])}setEndpointValue(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(t==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let a=0;Number.isInteger(o)&&(a=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){jt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function qb(n){return n==null||isNaN(n)}function Bne(n,e){Wne(n,e),e.add(n)}function Wne(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $ne(n,e,t){return(e=Gne(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Gne(n){var e=jne(n,"string");return typeof e=="symbol"?e:e+""}function jne(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function tw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Xb="columnSummary",zne=220;var Hf=new WeakSet;class Yne extends Wt{constructor(){super(...arguments),Bne(this,Hf),$ne(this,"endpoints",null)}static get PLUGIN_KEY(){return Xb}static get PLUGIN_PRIORITY(){return zne}isEnabled(){return!!this.hot.getSettings()[Xb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Xb],this.endpoints=new Une(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return tw(Hf,e,Kne).call(e,...r)}),this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return tw(Hf,e,Xne).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return tw(Hf,e,qne).call(e,...r)}),this.addHook("beforeCreateRow",(t,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,r,null,i)),this.addHook("beforeCreateCol",(t,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(t,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,r,null,i)),this.addHook("afterCreateCol",(t,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,r,null,i)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return tw(Hf,e,Qne).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return gt(e.ranges,r=>{t+=this.getPartialSum(r,e.sourceColumn)}),t}getPartialSum(e,t){let r=0,i=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(i,t),s=qb(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}r+=s||0,i-=1}while(i>=e[0]);return Math.round(r*10**o)/10**o}calculateMinMax(e,t){let r=null;return gt(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,t);if(r===null&&s!==null&&(r=s),s!==null)switch(t){case"min":r=Math.min(r,s);break;case"max":r=Math.max(r,s);break}}),r===null?"Not enough data":r}getPartialMinMax(e,t,r){let i=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,t),o=qb(o)?null:o,i===null)i=o;else if(o!==null)switch(r){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}s-=1}while(s>=e[0]);return i}countEmpty(e,t){let r,i=0,s=e[1]||e[0];do r=this.getCellValue(s,t),r=qb(r)?null:r,r===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let t=0;const r=e.ranges;return gt(r,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,o=this.countEmpty(i,e.sourceColumn);t+=s,t-=o}),t}calculateAverage(e){const t=this.calculateSum(e),r=this.countEntries(e);return t/r}getCellValue(e,t){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(t);let s=this.hot.getSourceDataAtCell(e,t),o="";if(r!==null&&i!==null&&(o=this.hot.getCellMeta(r,i).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(zt`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function Kne(){this.endpoints.initEndpoints()}function qne(n){n.columns!==void 0&&this.endpoints.refreshCellMetas()}function Xne(n,e){n&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(n)}function Qne(n,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",n[0],n.length,n,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,n.length,n,this.pluginName)}function Zne(n,e){uW(n,e),e.add(n)}function Qb(n,e,t){uW(n,e),e.set(n,t)}function uW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function td(n,e){return n.get(dO(n,e))}function sN(n,e,t){return n.set(dO(n,e),t),t}function dO(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var yy=new WeakMap,nw=new WeakMap,rw=new WeakMap,bD=new WeakSet;class hW{constructor(){Zne(this,bD),Qb(this,yy,!0),Qb(this,nw,null),Qb(this,rw,new ResizeObserver(e=>dO(bD,this,Jne).call(this,e)))}setObservedElement(e){sN(nw,this,e)}unobserve(){td(rw,this).unobserve(td(nw,this))}observe(){sN(yy,this,!0),td(rw,this).observe(td(nw,this))}destroy(){td(rw,this).disconnect()}}function Jne(n){if(td(yy,this)||!Array.isArray(n)||!n.length){sN(yy,this,!1);return}n.forEach(e=>{let{borderBoxSize:t}=e;const{inlineSize:r,blockSize:i}=t[0];this.runLocalHooks("resize",r,i)})}Zt(hW,Hr);function zu(n,e,t){ere(n,e),e.set(n,t)}function ere(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jt(n,e){return n.get(cW(n,e))}function Pa(n,e,t){return n.set(cW(n,e),t),t}function cW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Yu=new WeakMap,Zb=new WeakMap,La=new WeakMap,Ku=new WeakMap,El=new WeakMap,iw=new WeakMap,Nc=new WeakMap;class Ih{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var r=this;zu(this,Yu,void 0),zu(this,Zb,!1),zu(this,La,null),zu(this,Ku,void 0),zu(this,El,void 0),zu(this,iw,!0),zu(this,Nc,new hW),Pa(Yu,this,e),Pa(Zb,this,t),Pa(Ku,this,this.createEditor()),Pa(El,this,Jt(Ku,this).style),Jt(Nc,this).setObservedElement(this.getInputElement()),Jt(Nc,this).addLocalHook("resize",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,t){Jt(El,this).left=`${e}px`,Jt(El,this).top=`${t}px`}setSize(e,t){if(e&&t){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${t}px`}}getSize(){return{width:cn(this.getInputElement()),height:Xn(this.getInputElement())}}observeSize(){Jt(Nc,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){Jt(El,this).display="block",Pa(iw,this,!1)}hide(){Jt(Nc,this).unobserve(),Jt(iw,this)||(Jt(El,this).display="none"),Pa(iw,this,!0)}isVisible(){return Jt(El,this).display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return Jt(Yu,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=Jt(Yu,this).createElement("div"),t=Jt(Yu,this).createElement("textarea");return e.style.display="none",Pa(La,this,Jt(Yu,this).createElement("div")),Jt(La,this).setAttribute("dir",Jt(Zb,this)?"rtl":"ltr"),oe(Jt(La,this),Ih.CLASS_EDITOR_CONTAINER),Jt(Yu,this).body.appendChild(Jt(La,this)),oe(e,Ih.CLASS_EDITOR),oe(t,Ih.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),Jt(La,this).appendChild(e),e}getInputElement(){return Jt(Ku,this).querySelector(`.${Ih.CLASS_INPUT}`)}destroy(){const e=Jt(La,this)?Jt(La,this).parentNode:null;Jt(Ku,this).parentNode.removeChild(Jt(Ku,this)),Pa(Ku,this,null),Pa(El,this,null),Jt(Nc,this).destroy(),e&&e.removeChild(Jt(La,this))}}Zt(Ih,Hr);function Jb(n,e,t){return(e=tre(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tre(n){var e=nre(n,"string");return typeof e=="symbol"?e:e+""}function nre(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const rre=250,ire=250;class dW{constructor(e){Jb(this,"wasLastActionShow",!0),Jb(this,"showDebounced",null),Jb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},ire)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rre;this.showDebounced=X0(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}Zt(dW,Hr);function sre(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function ore(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function qu(n,e){const t={};return D(n,r=>{r.forAll((i,s)=>{i>=0&&s>=0&&(t[i]||(t[i]=[]),t[i][s]=e(i,s))})}),t}function Dl(n,e,t,r,i){D(n,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&are(o,a,e,t,r,i)})})}function are(n,e,t,r,i,s){const o=i(n,e);let a=r;o.className&&(t==="vertical"?a=sre(o.className,r):a=ore(o.className,r)),s(n,e,"className",a)}function Ga(n){return`<span class="selected">✓</span>${n}`}function Nm(n,e){let t=!1;return Array.isArray(n)&&D(n,r=>(r.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return t=!0,!1}),t)),t}function XC(n,e){const t={top:0,left:0};if(e!==n.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:s}=r.getBoundingClientRect();t.top=i,t.left=s}return t}function lre(n){return function(e,t){const r=this.getCellMeta(e,t).className;return r&&r.indexOf(n)!==-1}}function wi(n,e){return Nm(n.getSelectedRange(),lre(e).bind(n))}const dt="---------";function ure(){return{name:dt}}const ms="alignment";function hre(){return{key:ms,name(){return this.getTranslatedPhrase(ZI)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${ms}:left`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(ry)},ariaChecked(){return wi(this,"htLeft")},name(){let n=this.getTranslatedPhrase(ry);return wi(this,"htLeft")&&(n=Ga(n)),n},callback(){const n=this.getSelectedRange(),e=qu(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,n,t,r),Dl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${ms}:center`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(iy)},ariaChecked(){return wi(this,"htCenter")},name(){let n=this.getTranslatedPhrase(iy);return wi(this,"htCenter")&&(n=Ga(n)),n},callback(){const n=this.getSelectedRange(),e=qu(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,n,t,r),Dl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${ms}:right`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(sy)},ariaChecked(){return wi(this,"htRight")},name(){let n=this.getTranslatedPhrase(sy);return wi(this,"htRight")&&(n=Ga(n)),n},callback(){const n=this.getSelectedRange(),e=qu(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,n,t,r),Dl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${ms}:justify`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(oy)},ariaChecked(){return wi(this,"htJustify")},name(){let n=this.getTranslatedPhrase(oy);return wi(this,"htJustify")&&(n=Ga(n)),n},callback(){const n=this.getSelectedRange(),e=qu(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,n,t,r),Dl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{name:dt},{key:`${ms}:top`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(ay)},ariaChecked(){return wi(this,"htTop")},name(){let n=this.getTranslatedPhrase(ay);return wi(this,"htTop")&&(n=Ga(n)),n},callback(){const n=this.getSelectedRange(),e=qu(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,n,t,r),Dl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${ms}:middle`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(ly)},ariaChecked(){return wi(this,"htMiddle")},name(){let n=this.getTranslatedPhrase(ly);return wi(this,"htMiddle")&&(n=Ga(n)),n},callback(){const n=this.getSelectedRange(),e=qu(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,n,t,r),Dl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${ms}:bottom`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(uy)},ariaChecked(){return wi(this,"htBottom")},name(){let n=this.getTranslatedPhrase(uy);return wi(this,"htBottom")&&(n=Ga(n)),n},callback(){const n=this.getSelectedRange(),e=qu(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,n,t,r),Dl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1}]}}}const QC="clear_column";function cre(){return{key:QC,name(){return this.getTranslatedPhrase(kI)},callback(n,e){const t=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const Xg="col_left";function dre(){return{key:Xg,name(){return this.getTranslatedPhrase(xI)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,n.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Qg="col_right";function fre(){return{key:Qg,name(){return this.getTranslatedPhrase(PI)},callback(){const n=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,n.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Zg="make_read_only";function mre(){return{key:Zg,checkable:!0,ariaChecked(){return Nm(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly)},ariaLabel(){return this.getTranslatedPhrase(ny)},name(){let n=this.getTranslatedPhrase(ny);return Nm(this.getSelectedRange(),(t,r)=>this.getCellMeta(t,r).readOnly)&&(n=Ga(n)),n},callback(){const n=this.getSelectedRange(),e=Nm(n,(t,r)=>this.getCellMeta(t,r).readOnly);D(n,t=>{t.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const n=this.getSelectedRangeLast();return!!(!n||n.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const ZC="redo";function gre(){return{key:ZC,name(){return this.getTranslatedPhrase(FI)},callback(){this.redo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Jg="remove_col";function pre(){return{key:Jg,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[,t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(DI,e)},callback(){this.alter("remove_col",_7(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const JC="remove_row";function wre(){return{key:JC,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(LI,e)},callback(){this.alter("remove_row",x7(this),1,"ContextMenu.removeRow")},disabled(){const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const eS="row_above";function vre(){return{key:eS,name(){return this.getTranslatedPhrase(OI)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",n.row,1,"ContextMenu.rowAbove")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const tS="row_below";function yre(){return{key:tS,name(){return this.getTranslatedPhrase(_I)},callback(){const n=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",n.row,1,"ContextMenu.rowBelow")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const cg="no_items";function Cre(){return{key:cg,name(){return this.getTranslatedPhrase(MI)},disabled:!0,isCommand:!1}}const nS="undo";function Sre(){return{key:nS,name(){return this.getTranslatedPhrase(HI)},callback(){this.undo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Rre=[eS,tS,Xg,Qg,QC,JC,Jg,nS,ZC,Zg,ms,dt,cg],Ere={[dt]:ure,[cg]:Cre,[eS]:vre,[tS]:yre,[Xg]:dre,[Qg]:fre,[QC]:cre,[JC]:wre,[Jg]:pre,[nS]:Sre,[ZC]:gre,[Zg]:mre,[ms]:hre};function fW(){const n={};return gt(Ere,(e,t)=>{n[t]=e()}),n}function bre(n){return{key:"commentsAddEdit",name(){var e;const t=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t!=null&&t.isCell()&&n.getCommentAtCell(t.row,t.col)?this.getTranslatedPhrase(qI):this.getTranslatedPhrase(KI)},callback(){const e=this.getSelectedRangeLast();n.setRange(e),n.show(),n.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Tre(n){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(XI)},callback(){this.getSelectedRangeLast().forAll((t,r)=>{t>=0&&r>=0&&n.removeCommentAtCell(t,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Are(n){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(QI);return Nm(this.getSelectedRange(),(r,i)=>n.getCommentMeta(r,i,Cv))?Ga(e):e},callback(){this.getSelectedRangeLast().forAll((t,r)=>{if(t>=0&&r>=0){const i=!!n.getCommentMeta(t,r,Cv);n.updateCommentMeta(t,r,{[Cv]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!n.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Nre(n,e){mW(n,e),e.add(n)}function Ic(n,e,t){mW(n,e),e.set(n,t)}function mW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ire(n,e,t){return(e=Mre(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Mre(n){var e=Ore(n,"string");return typeof e=="symbol"?e:e+""}function Ore(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function eu(n,e,t){return n.set(Xs(n,e),t),t}function St(n,e){return n.get(Xs(n,e))}function Xs(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Im="comments",_re=60,ja="comment",dm="value",gW="style",Cv="readOnly",sw=Im,oN=`plugin:${Im}`;var tn=new WeakMap,Yo=new WeakMap,rS=new WeakMap,Sv=new WeakMap,aN=new WeakMap,Cy=new WeakMap,Po=new WeakSet;class xre extends Wt{constructor(){super(...arguments),Nre(this,Po),Ire(this,"range",{}),Ic(this,tn,null),Ic(this,Yo,null),Ic(this,rS,!1),Ic(this,Sv,!1),Ic(this,aN,null),Ic(this,Cy,"")}static get PLUGIN_KEY(){return Im}static get PLUGIN_PRIORITY(){return _re}isEnabled(){return!!this.hot.getSettings()[Im]}enablePlugin(){var e=this;this.enabled||(St(tn,this)||(eu(tn,this,new Ih(this.hot.rootDocument,this.hot.isRtl())),St(tn,this).addLocalHook("resize",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Xs(Po,e,Vre).call(e,...r)})),St(Yo,this)||eu(Yo,this,new dW(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,r,i,s,o,a)=>Xs(Po,this,Hre).call(this,t,a)),this.addHook("afterScroll",()=>Xs(Po,this,Bre).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>Xs(Po,this,Ure).call(this,t)),St(Yo,this).addLocalHook("hide",()=>this.hide()),St(Yo,this).addLocalHook("show",(t,r)=>this.showAtCell(t,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){St(Yo,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),r=e.addContext(oN);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();eu(Sv,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(oN),this.hot._registerTimeout(()=>{eu(Sv,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!St(tn,this).isVisible()},group:sw}),r.addShortcut({keys:[["Escape"]],callback:()=>{St(tn,this).setValue(St(Cy,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>St(tn,this).isVisible()&&St(tn,this).isFocused(),group:sw}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>St(tn,this).isVisible()&&St(tn,this).isFocused(),group:sw})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sw)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Xs(Po,this,Lre).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Xs(Po,this,Pre).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Xs(Po,this,Dre).call(this)),this.eventManager.addEventListener(t,"focus",()=>Xs(Po,this,kre).call(this)),this.eventManager.addEventListener(t,"blur",()=>Xs(Po,this,Fre).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=kh(e.target,"TD","TBODY");return!!(t&&Ze(t,"htCommentCell")&&kh(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=St(tn,this).getValue();let r="";e!=null?r=e:t!=null&&(r=t);const i=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(i,s,{[dm]:r}),this.hot.render()}setCommentAtCell(e,t,r){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,ja),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(r)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,dm)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,dm)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:r}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return St(Yo,this).cancelHiding(),St(tn,this).setValue((e=i[ja]?i[ja][dm]:null)!==null&&e!==void 0?e:""),St(tn,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){St(tn,this).hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!St(tn,this).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:s}=this.hot,{row:o,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(o),u=s.getRenderableFromVisualIndex(a);const h=l===null;St(tn,this).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1))),u===null&&(u=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1)));const c=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(t=u)!==null&&t!==void 0?t:0;const{rootWindow:f,view:{_wt:m}}=this.hot,{wtTable:p}=m,v=m.getCell({row:l,col:u},!0),y=this.getCommentMeta(o,a,gW);y?St(tn,this).setSize(y.width,y.height):St(tn,this).resetSize();const C=d?0:p.getStretchedColumnWidth(u),R=h&&!c?Xn(v):0,{left:A,top:I,width:H,height:k}=v.getBoundingClientRect(),{width:W,height:z}=St(tn,this).getSize(),{innerWidth:G,innerHeight:q}=this.hot.rootWindow,J=this.hot.rootDocument.documentElement;let re=A+f.scrollX+C,ie=I+f.scrollY+R;this.hot.isRtl()&&(re-=W+C),this.hot.isLtr()&&A+H+W>G?re=A+f.scrollX-W-1:this.hot.isRtl()&&re<-(J.scrollWidth-J.clientWidth)&&(re=A+f.scrollX+C+1),I+z>q&&(ie-=z-k+1),St(tn,this).setPosition(re,ie),St(tn,this).setReadOnlyState(this.getCommentMeta(o,a,Cv)),St(tn,this).observeSize()}focusEditor(){St(tn,this).focus()}updateCommentMeta(e,t,r){const i=this.hot.getCellMeta(e,t)[ja];let s;i?(s=ui(i),HC(s,r)):s=r,this.hot.setCellMeta(e,t,ja,s)}getCommentMeta(e,t,r){const i=this.hot.getCellMeta(e,t);if(i[ja])return i[ja][r]}addToContextMenu(e){e.items.push({name:dt},bre(this),Tre(this),Are(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Im];if(mt(e))return e.displayDelay}getEditorInputElement(){return St(tn,this).getInputElement()}destroy(){var e,t;(e=St(tn,this))===null||e===void 0||e.destroy(),(t=St(Yo,this))===null||t===void 0||t.destroy(),super.destroy()}}function Pre(n){if(!(!this.hot.view||!this.hot.view._wt)&&!St(rS,this)&&!this.targetIsCommentTextArea(n)){const e=kh(n.target,"TD","TBODY");let t=null;e&&(t=this.hot.getCoords(e)),(!e||this.range.from&&t&&(this.range.from.row!==t.row||this.range.from.col!==t.col))&&this.hide()}}function Lre(n){const{rootDocument:e}=this.hot;if(!(St(rS,this)||St(tn,this).isFocused()||Ze(n.target,"wtBorder")||St(aN,this)===n.target||!St(tn,this)))if(eu(aN,this,e.elementFromPoint(n.clientX,n.clientY)),this.targetIsCellWithComment(n)){const t=this.hot._createCellRange(this.hot.getCoords(n.target));St(Yo,this).show(t)}else Dh(n.target,e)&&!this.targetIsCommentTextArea(n)&&St(Yo,this).hide()}function Dre(){eu(rS,this,!1)}function Hre(n,e){e[ja]&&e[ja][dm]&&oe(n,e.commentedCellClassName)}function Fre(){eu(Cy,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function kre(){eu(Cy,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(oN)}function Vre(n,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[gW]:{width:n,height:e}})}function Ure(n){St(tn,this).isVisible()&&Ro(n)}function Bre(){St(Sv,this)||this.hide()}var TD={},eT,AD;function Wre(){if(AD)return eT;AD=1;var n=vC(),e=TypeError;return eT=function(t,r){if(!delete t[r])throw new e("Cannot delete property "+n(r)+" of "+n(t))},eT}var ND;function $re(){if(ND)return TD;ND=1;var n=Dr(),e=xg(),t=Dg(),r=$k(),i=Wre(),s=Gk(),o=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=o||!a();return n({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(h){var c=e(this),d=t(c),f=arguments.length;if(f){s(d+f);for(var m=d;m--;){var p=m+f;m in c?c[p]=c[m]:i(c,p)}for(var v=0;v<f;v++)c[v]=arguments[v]}return r(c,d+f)}}),TD}$re();function tT(n,e,t){return(e=Gre(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Gre(n){var e=jre(n,"string");return typeof e=="symbol"?e:e+""}function jre(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class pW{constructor(e){tT(this,"hot",void 0),tT(this,"commands",{}),tT(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=zre(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||_n(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(s.join(":")),D(u,h=>h.apply(this.hot,r))}}function zre(n,e){let t;return D(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===n)return t=r,!1}),t}function nT(n,e,t){return(e=Yre(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Yre(n){var e=Kre(n,"string");return typeof e=="symbol"?e:e+""}function Kre(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class wW{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;nT(this,"hot",void 0),nT(this,"predefinedItems",fW()),nT(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,gt(e,(r,i)=>{let s="";r.name===dt?(t[dt]=r,s=dt):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,t[i]=r,s=r.key):(t[r.key]=r,s=r.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return qre(e,this.defaultOrderPattern,this.predefinedItems)}}function qre(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=n;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),mt(i)?gt(i,(s,o)=>{let a=t[typeof s=="string"?s:o];a||(a=s),mt(s)?er(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),r.push(a)}):D(i,(s,o)=>{let a=t[s];!a&&Rre.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),mt(s)&&er(a,s),a.key===void 0&&(a.key=o),r.push(a))}),r}function bl(n,e,t){return(e=Xre(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Xre(n){var e=Qre(n,"string");return typeof e=="symbol"?e:e+""}function Qre(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Zre{constructor(e,t){bl(this,"top",void 0),bl(this,"topRelative",void 0),bl(this,"left",void 0),bl(this,"leftRelative",void 0),bl(this,"scrollTop",void 0),bl(this,"scrollLeft",void 0),bl(this,"cellHeight",void 0),bl(this,"cellWidth",void 0);const r=t.scrollY,i=t.scrollX;let s,o,a,l,u,h;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,h=e.width||0,o=s,l=a,s+=r,a+=i):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,h=e.target.clientWidth,o=s-r,l=a-i),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=h}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Ff(n,e,t){Jre(n,e),e.set(n,t)}function Jre(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function At(n,e){return n.get(vW(n,e))}function ow(n,e,t){return n.set(vW(n,e),t),t}function vW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Zr=new WeakMap,Tl=new WeakMap,vi=new WeakMap,rT=new WeakMap,Mc=new WeakMap;class eie{constructor(e){Ff(this,Zr,void 0),Ff(this,Tl,void 0),Ff(this,vi,void 0),Ff(this,rT,!1),Ff(this,Mc,{above:0,below:0,left:0,right:0}),ow(rT,this,e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return At(Mc,this)[e]=t,this}setElement(e){return ow(Zr,this,e),this}setParentElement(e){return ow(Tl,this,e),this}updatePosition(e){ow(vi,this,new Zre(e,At(Zr,this).ownerDocument.defaultView)),At(rT,this)?(At(vi,this).fitsBelow(At(Zr,this))?this.setPositionBelowCursor():At(vi,this).fitsAbove(At(Zr,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){At(Zr,this).dir==="rtl"?At(vi,this).fitsOnLeft(At(Zr,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():At(vi,this).fitsOnRight(At(Zr,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=At(Mc,this).above+At(vi,this).top-At(Zr,this).offsetHeight;At(Tl,this)&&(e=At(vi,this).top+At(vi,this).cellHeight-At(Zr,this).offsetHeight+3),At(Zr,this).style.top=`${e}px`}setPositionBelowCursor(){let e=At(Mc,this).below+At(vi,this).top+1;At(Tl,this)&&(e=At(vi,this).top-1),At(Zr,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=At(vi,this).left;if(At(Tl,this)){const t=Number.parseInt(getComputedStyle(At(Tl,this).querySelector(".htCore")).borderRightWidth,10);e+=At(vi,this).cellWidth+t}else e+=At(Mc,this).right;At(Zr,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=At(Mc,this).left+At(vi,this).left-At(Zr,this).offsetWidth;if(At(Tl,this)){const t=Number.parseInt(getComputedStyle(At(Tl,this).querySelector(".htCore")).borderLeftWidth,10);e-=t}At(Zr,this).style.left=`${e}px`}}function yW(n){let{initialPage:e=-1,size:t=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=n;const s=new Set;let o=qt(e,-1,m()-1);function a(v,y){const C=m()-1;return v<0&&(v=C),v>C&&(v=0),s.has(v)?-1:(s.add(v),r(v,!1)===!1&&(v=a(y===1?++v:--v,y)),v)}function l(v){v>-1&&v<m()&&r(v,!0)!==!1&&(o=v)}function u(){return o}function h(){m()>0&&(s.clear(),o=a(0,1))}function c(){m()>0&&(s.clear(),o=a(m()-1,-1))}function d(){m()>0&&(s.clear(),o=a(++o,1))}function f(){m()>0&&(s.clear(),o=a(--o,-1))}function m(){return Math.max(t(),0)}function p(){s.clear(),o=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:h,toLastItem:c,toNextItem:d,toPreviousItem:f,getSize:m,clear:p}}function tie(n){return bt(n,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function lN(n){return _n(n,"submenu")}function uN(n){return new RegExp(dt,"i").test(n.name)}function Rv(n,e){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(e)===!0}function ID(n){return _n(n,"disableSelection")}function nie(n){return Ze(n,"htSeparator")}function rie(n){return Ze(n,"htSubmenu")}function iie(n){return Ze(n,"htDisabled")}function sie(n){return Ze(n,"htSelectionDisabled")}function oie(n,e){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(e))}function CW(n,e){const t=n.slice(0);for(let r=0;r<t.length&&t[r].name===e;)t.shift();return t}function aie(n,e){let t=n.slice(0);return t.reverse(),t=CW(t,e),t.reverse(),t}function lie(n){const e=[];return D(n,(t,r)=>{r>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function uie(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dt,t=n.slice(0);return t=CW(t,e),t=aie(t,e),t=lie(t),t}function hie(n){return n.checkable===!0}function cie(n){return yW({size:()=>n.countRows(),onItemSelect(e,t){const r=n.getCell(e,0);if(!r||nie(r)||iie(r)||sie(r))return!1;n.selectCell(e,0,...t?[e,0,!1,!1]:[])},onClear(){n.deselectCell()}})}function die(n){const{hot:e,hotMenu:t}=n;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>n.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(r):s.tabMoves;i.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),n.close(!0)}},{keys:[["Escape"]],callback:()=>n.close()},{keys:[["ArrowDown"]],callback:()=>n.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>n.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const r=t.getSelectedLast();if(r){const i=n.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.getSelectedLast()&&n.isSubMenu()&&(n.close(),n.isSubMenu()&&n.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>n.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>n.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=t.getSelectedLast();i&&(t.getSourceDataAtRow(i[0]).submenu?n.openSubMenu(i[0]).getNavigator().toFirstItem():(n.executeCommand(r),n.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(-t.countVisibleRows(),0):n.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(t.countVisibleRows(),0):n.getNavigator().toLastItem()}}]}const SW="menu",MD=SW;function fie(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=[];r(die(n)),e.forEach(u=>{let{shortcuts:h,contextName:c}=u;i(h,c)});function r(u,h){a(h).addShortcuts(u,{group:SW})}function i(u,h){const c=a(h);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>c.removeShortcutsByKeys(m))}),t.push({shortcuts:u,contextName:h}),r(u,h)}function s(){return[...t]}function o(u){return u?`${MD}:${u}`:MD}function a(u){var h;const c=n.hotMenu.getShortcutManager(),d=o(u);return(h=c.getContext(d))!==null&&h!==void 0?h:c.addContext(d)}function l(u){n.hotMenu.getShortcutManager().setActiveContextName(o(u))}return{addCustomShortcuts:i,getCustomShortcuts:s,getContext:a,listen:l}}function mie(n){return(e,t,r,i,s,o)=>{const a=e.getSourceDataAtRow(r),l=n.rootDocument.createElement("div"),u=typeof o=="function"?o.call(n):o,h=typeof a.ariaLabel=="function"?a.ariaLabel.call(n):a.ariaLabel,c=typeof a.ariaChecked=="function"?a.ariaChecked.call(n):a.ariaChecked;if(fa(t),oe(l,"htItemWrapper"),n.getSettings().ariaTags){const d=!Rv(a,n)&&!ID(a)&&!uN(a);Xe(t,[...hie(a)?[$6(),Qv(h),JV(c)]:[W6(),Qv(u)],...d?[qd(-1)]:[],...Rv(a,n)?[X6()]:[],...lN(a)?[Es(!1)]:[]])}t.className="",t.appendChild(l),uN(a)?oe(t,"htSeparator"):typeof a.renderer=="function"?(oe(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,r,i,s,u))):Qd(l,u),Rv(a,n)?oe(t,"htDisabled"):ID(a)?oe(t,"htSelectionDisabled"):lN(a)&&oe(t,"htSubmenu")}}function iT(n,e,t){gie(n,e),e.set(n,t)}function gie(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lo(n,e,t){return(e=pie(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pie(n){var e=wie(n,"string");return typeof e=="symbol"?e:e+""}function wie(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function sT(n,e,t){return n.set(RW(n,e),t),t}function Xu(n,e){return n.get(RW(n,e))}function RW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const OD=215;var kf=new WeakMap,aw=new WeakMap,lw=new WeakMap;class tf{get tableBorderWidth(){return Xu(lw,this)===void 0&&this.hotMenu&&sT(lw,this,parseInt(ul(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Xu(lw,this)}constructor(e,t){var r=this;Lo(this,"hot",void 0),Lo(this,"options",void 0),Lo(this,"eventManager",new wo(this)),Lo(this,"container",void 0),Lo(this,"positioner",void 0),Lo(this,"hotMenu",null),Lo(this,"hotSubMenus",{}),Lo(this,"parentMenu",void 0),Lo(this,"menuItems",null),Lo(this,"origOutsideClickDeselects",null),iT(this,kf,void 0),iT(this,aw,void 0),iT(this,lw,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:OD,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new eie(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.parentMenu.runLocalHooks("afterSelectionChange",...s)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"touchstart",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=Pd(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Xu(kf,this)}getKeyboardShortcutsCtrl(){return Xu(aw,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=X0(a=>this.openSubMenu(a),300),t=this.options.minWidth||OD;let r=!1,i=du(this.menuItems,a=>(a.key===cg&&(r=!0),oie(a,this.hot)));if(i.length<1&&!r)i.push(fW()[cg]);else if(i.length===0)return;i=uie(i,dt);let s=!1;const o={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return Oe(a)&&a<t?t:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:mie(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Xu(kf,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===dt?1:void 0,afterOnCellContextMenu:a=>{a.preventDefault(),N1()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,h,c)=>{this.hotMenu.view.isMouseDown()&&(c.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!N1()||!Uh(a))&&s&&this.hasSelectedItem()&&(Zl()||pU()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),sT(kf,this,cie(this.hotMenu)),sT(aw,this,fie(this)),Xu(aw,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Xu(kf,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const r=this.parentMenu.hotMenu.getCell(t[0],0);Xe(r,[Es(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!rie(t))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new tf(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(t.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Xe(t,[Es(!0)]),i}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[t.key];if(r){r.destroy(),delete this.hotSubMenus[t.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Xe(i,[Es(!1)])}}closeAllSubMenus(){D(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const r=this.hot.getSelectedRange(),i=r?tie(r):[];this.runLocalHooks("executeCommand",t.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,i,e)}isCommandPassive(e){return e.isCommand===!1||uN(e)||Rv(e,this.hot)||lN(e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,s=parseInt(r.width,10),o=hi(t,(a,l,u)=>{const c=this.hotMenu.getCell(u,0)?Xn(this.hotMenu.getCell(u,0)):0;return a+(l.name===dt?1:c)},0);i.width=`${s+3}px`,i.height=`${o+3}px`,r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let r=e,i;return r&&(un(r)&&(r=r.call(this.hot),r===null||hn(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=t.querySelector(`.${this.options.className}.${r}`)),i||(i=t.createElement("div"),oe(i,`htMenu ${this.options.className}`),r&&oe(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Xe(this.hotMenu.rootElement,[B6(),qd(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Dh(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Dh(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ze(e.target,"htCore")&&Dh(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Zt(tf,Hr);function vie(n,e){yie(n,e),e.add(n)}function yie(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oT(n,e,t){return(e=Cie(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Cie(n){var e=Sie(n,"string");return typeof e=="symbol"?e:e+""}function Sie(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function uw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const fm="contextMenu",Rie=70,_D=fm;Ae.getSingleton().register("afterContextMenuDefaultOptions");Ae.getSingleton().register("beforeContextMenuShow");Ae.getSingleton().register("afterContextMenuShow");Ae.getSingleton().register("afterContextMenuHide");Ae.getSingleton().register("afterContextMenuExecute");var Vf=new WeakSet;class iS extends Wt{constructor(){super(...arguments),vie(this,Vf),oT(this,"commandExecutor",new pW(this.hot)),oT(this,"itemsFactory",null),oT(this,"menu",null)}static get PLUGIN_KEY(){return fm}static get PLUGIN_PRIORITY(){return Rie}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[eS,tS,dt,Xg,Qg,dt,JC,Jg,dt,nS,ZC,dt,Zg,dt,ms]}isEnabled(){return!!this.hot.getSettings()[fm]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[fm];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new tf(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>uw(Vf,this,bie).call(this)),this.menu.addLocalHook("afterOpen",()=>uw(Vf,this,Tie).call(this)),this.menu.addLocalHook("afterClose",()=>uw(Vf,this,Aie).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>uw(Vf,this,Eie).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=XC(this.menu.container,this.hot.rootDocument);this.open({left:t.left+r.left,top:t.top+r.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:_D})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_D)}open(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((t=this.menu)!==null&&t!==void 0&&t.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(r.below+=1,r.right+=1,r.above-=1,r.left-=1),gt(r,(s,o)=>{this.menu.setOffset(o,s)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new wW(this.hot,iS.DEFAULT_ITEMS);const e=this.hot.getSettings()[fm],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),D(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Eie(n){const e=this.hot.getSettings(),t=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=n.target;if(this.close(),Ze(s,"handsontableInput")||(n.preventDefault(),n.stopPropagation(),!(t||r)&&!i(s)&&!(Ze(s,"current")&&Ze(s,"wtBorder"))))return;const o=XC(this.menu.container,this.hot.rootDocument);this.open({top:n.clientY+o.top,left:n.clientX+o.left})}function bie(){this.hot.runHooks("beforeContextMenuShow",this)}function Tie(){this.hot.runHooks("afterContextMenuShow",this)}function Aie(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}iS.SEPARATOR={name:dt};function Nie(n){return{key:"copy",name(){return this.getTranslatedPhrase(VI)},callback(){n.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Iie(n){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?qt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(WI,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Mie(n){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?qt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(BI,t)},callback(){n.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Oie(n){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?qt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(UI,t)},callback(){n.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function _ie(n){return{key:"cut",name(){return this.getTranslatedPhrase($I)},callback(){n.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}class xie{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class Pie{constructor(){this.clipboardData=new xie}preventDefault(){}}function Lie(n,e){EW(n,e),e.add(n)}function Oc(n,e,t){EW(n,e),e.set(n,t)}function EW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ti(n,e){return n.get(fd(n,e))}function _c(n,e,t){return n.set(fd(n,e),t),t}function fd(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Al=new WeakMap,aT=new WeakMap,Uf=new WeakMap,hN=new WeakMap,cN=new WeakMap,Bf=new WeakMap,Wf=new WeakSet;class Die{constructor(e){let{countRows:t,countColumns:r,rowsLimit:i,columnsLimit:s,countColumnHeaders:o}=e;Lie(this,Wf),Oc(this,Al,void 0),Oc(this,aT,void 0),Oc(this,Uf,void 0),Oc(this,hN,void 0),Oc(this,cN,void 0),Oc(this,Bf,void 0),_c(aT,this,t),_c(Uf,this,r),_c(hN,this,i),_c(cN,this,s),_c(Bf,this,o)}setSelectedRange(e){_c(Al,this,e)}getCellsRange(){if(ti(aT,this).call(this)===0||ti(Uf,this).call(this)===0)return null;const{row:e,col:t}=ti(Al,this).getTopStartCorner(),{row:r,col:i}=ti(Al,this).getBottomEndCorner(),s=fd(Wf,this,Hie).call(this,e,r),o=fd(Wf,this,lT).call(this,t,i);return{isRangeTrimmed:r!==s||i!==o,startRow:e,startCol:t,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(ti(Uf,this).call(this)===0||ti(Bf,this).call(this)===0)return null;const{col:e}=ti(Al,this).getTopStartCorner(),{col:t}=ti(Al,this).getBottomEndCorner(),r=fd(Wf,this,lT).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(ti(Uf,this).call(this)===0||ti(Bf,this).call(this)===0)return null;const{col:e}=ti(Al,this).getTopStartCorner(),{col:t}=ti(Al,this).getBottomEndCorner(),r=fd(Wf,this,lT).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-ti(Bf,this).call(this),startCol:e,endRow:-1,endCol:r}}}function lT(n,e){return Math.min(e,Math.max(n+ti(cN,this).call(this)-1,n))}function Hie(n,e){return Math.min(e,Math.max(n+ti(hN,this).call(this)-1,n))}function bW(n){const e=[],t=[];return D(n,r=>{const i=Math.min(r.startRow,r.endRow),s=Math.max(r.startRow,r.endRow);De(i,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);De(o,a,l=>{t.indexOf(l)===-1&&t.push(l)})}),{rows:e,columns:t}}function Fie(n,e){TW(n,e),e.add(n)}function Nl(n,e,t){TW(n,e),e.set(n,t)}function TW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $f(n,e,t){return(e=kie(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kie(n){var e=Vie(n,"string");return typeof e=="symbol"?e:e+""}function Vie(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function bi(n,e){return n.get(Ti(n,e))}function qs(n,e,t){return n.set(Ti(n,e),t),t}function Ti(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("afterCopyLimit");Ae.getSingleton().register("modifyCopyableRange");Ae.getSingleton().register("beforeCut");Ae.getSingleton().register("afterCut");Ae.getSingleton().register("beforePaste");Ae.getSingleton().register("afterPaste");Ae.getSingleton().register("beforeCopy");Ae.getSingleton().register("afterCopy");const hw="copyPaste",Uie=80,Bie=["fragmentSelection"],xD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var dN=new WeakMap,fN=new WeakMap,mN=new WeakMap,xc=new WeakMap,cw=new WeakMap,dw=new WeakMap,Pc=new WeakMap,Sy=new WeakMap,Gi=new WeakSet;class Wie extends Wt{constructor(){super(...arguments),Fie(this,Gi),$f(this,"columnsLimit",1/0),$f(this,"rowsLimit",1/0),$f(this,"pasteMode","overwrite"),$f(this,"uiContainer",this.hot.rootDocument.body),Nl(this,dN,!1),Nl(this,fN,!1),Nl(this,mN,!1),Nl(this,xc,"cells-only"),Nl(this,cw,!1),Nl(this,dw,!1),Nl(this,Pc,new Die({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Nl(this,Sy,!1),$f(this,"copyableRanges",[])}static get PLUGIN_KEY(){return hw}static get SETTING_KEYS(){return[hw,...Bie]}static get PLUGIN_PRIORITY(){return Uie}isEnabled(){return!!this.hot.getSettings()[hw]}enablePlugin(){var e=this;if(this.enabled)return;const{[hw]:t}=this.hot.getSettings();if(typeof t=="object"){var r,i;this.pasteMode=(r=t.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(t.rowsLimit)?this.rowsLimit:t.rowsLimit,this.columnsLimit=isNaN(t.columnsLimit)?this.columnsLimit:t.columnsLimit,qs(dN,this,!!t.copyColumnHeaders),qs(fN,this,!!t.copyColumnGroupHeaders),qs(mN,this,!!t.copyColumnHeadersOnly),this.uiContainer=(i=t.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",s=>Ti(Gi,this,jie).call(this,s)),this.addHook("afterSelection",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return Ti(Gi,e,zie).call(e,...o)}),this.addHook("afterSelectionEnd",()=>Ti(Gi,this,Yie).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),mU()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return Ti(Gi,e,Kie).call(e,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return Ti(Gi,e,qie).call(e,...o)}),this.addHook("afterSelection",()=>Ti(Gi,this,Xie).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";qs(xc,this,e),qs(cw,this,!0),Ti(Gi,this,PD).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){qs(dw,this,!0),Ti(Gi,this,PD).call(this,"cut")}getRangedCopyableData(e){return bm(this.getRangedData(e))}getRangedData(e){const t=[],{rows:r,columns:i}=bW(e);return D(r,s=>{const o=[];D(i,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),t.push(o)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const r=new Pie;e&&r.clipboardData.setData("text/plain",e),t&&r.clipboardData.setData("text/html",t),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}bi(Pc,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);bi(xc,this)==="column-headers-only"?t.set("headers",bi(Pc,this).getMostBottomColumnHeadersRange()):(bi(xc,this)==="with-column-headers"?t.set("headers",bi(Pc,this).getMostBottomColumnHeadersRange()):bi(xc,this)==="with-column-group-headers"&&t.set("headers",bi(Pc,this).getAllColumnHeadersRange()),t.set("cells",bi(Pc,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=i;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=t.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:s,endRow:o,endCol:a}=r;this.hot.runHooks("afterCopyLimit",o-i+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,s=[],{row:o,col:a}=t.getTopStartCorner(),{row:l,col:u}=t.getBottomEndCorner();let h=o,c=a,d=o,f=a;for(;s.length<r||h<=l;){const{skipRowOnPaste:m,visualRow:p}=this.hot.getCellMeta(h,a);if(h=p+1,m===!0)continue;d=p,c=a;const v=[],y=s.length%r;for(;v.length<i||c<=u;){const{skipColumnOnPaste:C,visualCol:R}=this.hot.getCellMeta(o,c);if(c=R+1,C===!0)continue;f=R;const A=v.length%i;v.push(e[y][A])}s.push(v)}return qs(Sy,this,!0),this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,d,f]}onCopy(e){var t,r;const i=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input"),o=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight,a=o?this.hot.getCell(o.row,o.col,!0):null;if(!this.hot.isListening()&&!bi(cw,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body&&a!==e.target))return;e.preventDefault(),this.setCopyableText(),qs(cw,this,!1);const l=this.getRangedData(this.copyableRanges),u=Ti(Gi,this,$ie).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",l,this.copyableRanges,u)){const c=bm(l);if(e&&e.clipboardData){const d=j1(l,this.hot.rootDocument);e.clipboardData.setData("text/plain",c),e.clipboardData.setData("text/html",[xD,d].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",c);this.hot.runHooks("afterCopy",l,this.copyableRanges,u)}qs(xc,this,"cells-only")}onCut(e){var t,r;const i=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input"),o=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight,a=o?this.hot.getCell(o.row,o.col,!0):null;if(!this.hot.isListening()&&!bi(dw,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body&&a!==e.target))return;e.preventDefault(),this.setCopyableText(),qs(dw,this,!1);const l=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",l,this.copyableRanges)){const h=bm(l);if(e&&e.clipboardData){const c=j1(l,this.hot.rootDocument);e.clipboardData.setData("text/plain",h),e.clipboardData.setData("text/html",[xD,c].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",h);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",l,this.copyableRanges)}}onPaste(e){var t,r;const i=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input"),o=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight,a=o?this.hot.getCell(o.row,o.col,!0):null;if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body&&a!==e.target))return;e.preventDefault();let l;if(e&&typeof e.clipboardData<"u"){const f=G0(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});f&&/(<table)|(<TABLE)/g.test(f)?l=wX(f,this.hot.rootDocument).data:l=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(l=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof l=="string"&&(l=F7(l)),l===void 0||l&&l.length===0||this.hot.runHooks("beforePaste",l,this.copyableRanges)===!1)return;const[u,h,c,d]=this.populateValues(l);this.hot.selectCell(u,h,Math.min(this.hot.countRows()-1,c),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",l,this.copyableRanges)}destroy(){super.destroy()}}function PD(n){if(mU()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:r}=e.highlight,i=this.hot.getCell(t,r,!0);i&&v4(i,()=>{this.hot.rootDocument.execCommand(n)})}}else this.hot.rootDocument.execCommand(n)}function $ie(n){const{rows:e}=bW(n);let t=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)t+=1;return{columnHeadersCount:t}}function Gie(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,r=this.hot.getCell(e,t,!0);r&&uU(r)}}}function AW(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,r=this.hot.getCell(e,t,!0);r!=null&&r.hasAttribute("contenteditable")&&hU(r)}}}function jie(n){n.items.push({name:"---------"},Nie(this)),bi(dN,this)&&n.items.push(Oie(this)),bi(fN,this)&&n.items.push(Mie(this)),bi(mN,this)&&n.items.push(Iie(this)),n.items.push(_ie(this))}function zie(n,e,t,r,i){bi(Sy,this)&&(i.value=!0),qs(Sy,this,!1)}function Yie(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Kie(){Ti(Gi,this,AW).call(this)}function qie(){Ti(Gi,this,Gie).call(this)}function Xie(){Ti(Gi,this,AW).call(this)}function NW(n,e){return`border_row${n}col${e}`}function mm(){return{width:1,color:"#000"}}function Ja(){return{hide:!0}}function Qie(){return{width:1,color:"#000",cornerVisible:!1}}function uT(n){if(Oe(n.start)||Oe(n.left)){var e;n.start=(e=n.start)!==null&&e!==void 0?e:n.left}if(Oe(n.end)||Oe(n.right)){var t;n.end=(t=n.end)!==null&&t!==void 0?t:n.right}return delete n.left,delete n.right,n}function Gf(n){return Oe(n.start)&&(n.left=n.start),Oe(n.end)&&(n.right=n.end),n}function hT(n,e){return{id:NW(n,e),border:Qie(),row:n,col:e,top:Ja(),bottom:Ja(),start:Ja(),end:Ja()}}function Zie(n,e){return _n(e,"border")&&e.border&&(n.border=e.border),_n(e,"top")&&Oe(e.top)&&(e.top?(mt(e.top)||(e.top=mm()),n.top=e.top):(e.top=Ja(),n.top=e.top)),_n(e,"bottom")&&Oe(e.bottom)&&(e.bottom?(mt(e.bottom)||(e.bottom=mm()),n.bottom=e.bottom):(e.bottom=Ja(),n.bottom=e.bottom)),_n(e,"start")&&Oe(e.start)&&(e.start?(mt(e.start)||(e.start=mm()),n.start=e.start):(e.start=Ja(),n.start=e.start)),_n(e,"end")&&Oe(e.end)&&(e.end?(mt(e.end)||(e.end=mm()),n.end=e.end):(e.end=Ja(),n.end=e.end)),n}function hl(n,e){let t=!1;return D(n.getSelectedRange(),r=>{r.forAll((i,s)=>{if(i<0||s<0)return;const o=n.getCellMeta(i,s).borders;if(o)if(e){if(!_n(o[e],"hide")||o[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function sS(n){return`<span class="selected">✓</span>${n}`}function Jie(n){return n.some(e=>Oe(e.left)||Oe(e.right))}function ese(n){return n.some(e=>Oe(e.start)||Oe(e.end))}const tse=new Map([["left","start"],["right","end"]]);function nse(n){var e;return(e=tse.get(n))!==null&&e!==void 0?e:n}function rse(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(nM);return hl(this,"bottom")&&(e=sS(e)),e},callback(e,t){const r=hl(this,"bottom");n.prepareBorder(t,"bottom",r)}}}function ise(n){const e=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(rM);return hl(this,e)&&(t=sS(t)),t},callback(t,r){const i=hl(this,e);n.prepareBorder(r,e,i)}}}function sse(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(iM)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!hl(this)}}}function ose(n){const e=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(tM);return hl(this,e)&&(t=sS(t)),t},callback(t,r){const i=hl(this,e);n.prepareBorder(r,e,i)}}}function ase(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(eM);return hl(this,"top")&&(e=sS(e)),e},callback(e,t){const r=hl(this,"top");n.prepareBorder(t,"top",r)}}}function lse(n,e){use(n,e),e.add(n)}function use(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hse(n,e,t){return(e=cse(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cse(n){var e=dse(n,"string");return typeof e=="symbol"?e:e+""}function dse(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function LD(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Ev="customBorders",fse=90;var cT=new WeakSet;class mse extends Wt{constructor(){super(...arguments),lse(this,cT),hse(this,"savedBorders",[])}static get PLUGIN_KEY(){return Ev}static get PLUGIN_PRIORITY(){return fse}isEnabled(){return!!this.hot.getSettings()[Ev]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>LD(cT,this,gse).call(this,e)),this.addHook("init",()=>LD(cT,this,pse).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let r=["top","bottom","start","end"],i=null;t&&(this.checkSettingsCohesion([t]),r=Object.keys(t),i=uT(t));const s=Hd(e),o=ag(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});D(e,a=>{o(a).forAll((l,u)=>{D(r,h=>{this.prepareBorderFromCustomAdded(l,u,i,nse(h))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=Hd(e),r=ag(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return D(e,s=>{r(s).forAll((o,a)=>{D(this.savedBorders,l=>{l.row===o&&l.col===a&&i.push(Gf(l))})})}),i}clearBorders(e){e?this.setBorders(e):(D(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,t,r,i){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||t>=o)return;let a=hT(e,t);r&&(a=Zie(a,r),D(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",Gf(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,t){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);De(e.from.row,r,s=>{De(e.from.col,i,o=>{const a=hT(s,o);let l=0;s===e.from.row&&_n(t,"top")&&(l+=1,a.top=t.top),s===e.to.row&&_n(t,"bottom")&&(l+=1,a.bottom=t.bottom),o===e.from.col&&_n(t,"start")&&(l+=1,a.start=t.start),o===e.to.col&&_n(t,"end")&&(l+=1,a.end=t.end),l>0&&(this.hot.setCellMeta(s,o,"borders",Gf(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,t){const r=NW(e,t);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,r,i){let s=this.hot.getCellMeta(e,t).borders;!s||s.border===void 0?s=hT(e,t):s=uT(s),i?(s[r]=Ja(),this.countHide(s)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,t,"borders",Gf(s)))):(s[r]=mm(),this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,t,"borders",Gf(s)))}prepareBorder(e,t,r){D(e,i=>{let{start:s,end:o}=i;if(s.row===o.row&&s.col===o.col)t==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,t,r);else switch(t){case"noBorders":De(s.col,o.col,a=>{De(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":De(s.col,o.col,a=>{this.setBorder(s.row,a,t,r)});break;case"bottom":De(s.col,o.col,a=>{this.setBorder(o.row,a,t,r)});break;case"start":De(s.row,o.row,a=>{this.setBorder(a,s.col,t,r)});break;case"end":De(s.row,o.row,a=>{this.setBorder(a,o.col,t,r)});break}})}createCustomBorders(e){D(e,t=>{const r=uT(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,r):this.prepareBorderFromCustomAdded(t.row,t.col,r)})}countHide(e){const{top:t,bottom:r,start:i,end:s}=e;return hi([t,r,i,s],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const t=bt(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){D(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){D(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=bt(this.savedBorders,r=>r.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):D(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,r){let i=!1;return D(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return D(o,a=>{a.toggleHiddenClass(t,r)}),i=!0,!1}}),i}checkCustomSelections(e,t,r){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):D(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=t,o.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);D(a,l=>{l.changeBorderStyle(r,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[Ev];if(Array.isArray(e)){const t=ui(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=Jie(e),r=ese(e);if(t&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function gse(n){this.hot.getSettings()[Ev]&&n.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(JI)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[ase(this),ose(this),rse(this),ise(this),sse(this)]}})}function pse(){this.changeBorderSettings()}function wse(n,e){vse(n,e),e.add(n)}function vse(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dT(n,e,t){return(e=yse(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yse(n){var e=Cse(n,"string");return typeof e=="symbol"?e:e+""}function Cse(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function DD(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const HD="dragToScroll",Sse=100;var fT=new WeakSet;class Rse extends Wt{constructor(){super(...arguments),wse(this,fT),dT(this,"boundaries",null),dT(this,"callback",null),dT(this,"listening",!1)}static get PLUGIN_KEY(){return HD}static get PLUGIN_PRIORITY(){return Sse}isEnabled(){return!!this.hot.getSettings()[HD]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>DD(fT,this,FD).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>DD(fT,this,FD).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let r=0,i=0;t<this.boundaries.top?i=t-this.boundaries.top:t>this.boundaries.bottom&&(i=t-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",r=>this.onMouseMove(r)),t=Pd(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function FD(n){if(Uh(n))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,r)=>{var i,s;const o=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(t)*50,a+Math.sign(r)*20)}),this.listen()}function Ese(n,e){IW(n,e),e.add(n)}function bse(n,e,t){IW(n,e),e.set(n,t)}function IW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mT(n,e,t){return(e=Tse(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Tse(n){var e=Ase(n,"string");return typeof e=="symbol"?e:e+""}function Ase(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Nse(n,e){return n.get(gs(n,e))}function MW(n,e,t){return n.set(gs(n,e),t),t}function gs(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("afterDropdownMenuDefaultOptions");Ae.getSingleton().register("beforeDropdownMenuShow");Ae.getSingleton().register("afterDropdownMenuShow");Ae.getSingleton().register("afterDropdownMenuHide");Ae.getSingleton().register("afterDropdownMenuExecute");const bv="dropdownMenu",Ise=230,dg="changeType",gT=bv;var oS=new WeakMap,Qs=new WeakSet;class aS extends Wt{static get PLUGIN_KEY(){return bv}static get PLUGIN_PRIORITY(){return Ise}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Xg,Qg,dt,Jg,dt,QC,dt,Zg,dt,ms]}constructor(e){super(e),Ese(this,Qs),mT(this,"commandExecutor",new pW(this.hot)),mT(this,"itemsFactory",null),mT(this,"menu",null),bse(this,oS,!1),this.hot.addHook("afterGetColHeader",(t,r)=>gs(Qs,this,Ose).call(this,t,r))}isEnabled(){return this.hot.getSettings()[bv]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new wW(this.hot,aS.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return gs(Qs,e,Hse).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return gs(Qs,e,Dse).call(e,...s)});const t=this.hot.getSettings()[bv],r={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new tf(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>gs(Qs,this,_se).call(this)),this.menu.addLocalHook("afterOpen",()=>gs(Qs,this,xse).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>gs(Qs,this,Pse).call(this,s)),this.menu.addLocalHook("afterClose",()=>gs(Qs,this,Lse).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),D(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),s=XC(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,i.col,!0).querySelector(`.${dg}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:gT},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:gT}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gT)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>gs(Qs,this,Mse).call(this,e))}open(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(t=this.menu)!==null&&t!==void 0&&t.isOpened()||(this.menu.open(),gt(r,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function OW(n){n.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Mse(n){if(Ze(n.target,dg)){const e=XC(this.menu.container,this.hot.rootDocument),t=n.target.getBoundingClientRect();n.stopPropagation(),MW(oS,this,!1),this.open({left:t.left+e.left,top:t.top+n.target.offsetHeight+e.top},{left:t.width,right:0,above:0,below:3})}}function Ose(n,e){const t=e.parentNode;if(!t)return;const r=t.parentNode.childNodes,i=Array.prototype.indexOf.call(r,t);if(n<0||i!==r.length-1)return;const s=e.querySelector(`.${dg}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=dg,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(Xe(o,[ic(),Qv(" ")]),Xe(e,[XV("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function _se(){this.hot.runHooks("beforeDropdownMenuShow",this)}function xse(){this.hot.runHooks("afterDropdownMenuShow",this),gs(Qs,this,OW).call(this,this.menu)}function Pse(n){gs(Qs,this,OW).call(this,n)}function Lse(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Dse(n){return Nse(oS,this)?null:n}function Hse(n){Ze(n.target,dg)&&MW(oS,this,!0)}aS.SEPARATOR={name:dt};function kD(n,e,t){return(e=Fse(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Fse(n){var e=kse(n,"string");return typeof e=="symbol"?e:e+""}function kse(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Vse{constructor(e){kD(this,"hot",void 0),kD(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:r,endCol:i}=this._getDataRange(),s=this.options,o=[];return De(e,r,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(De(t,i,u=>{!s.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();De(t,r,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();De(t,r,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[r=0,i=0,s=t,o=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),s=Math.min(s,t),o=Math.min(o,e),{startRow:r,startCol:i,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function VD(n,e,t){return(e=Use(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Use(n){var e=Bse(n,"string");return typeof e=="symbol"?e:e+""}function Bse(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class fO{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){VD(this,"dataProvider",void 0),VD(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=ma(this.constructor.DEFAULT_OPTIONS);const r=new Date;return t=er(ma(fO.DEFAULT_OPTIONS),t),t=er(t,e),t.filename=YV(t.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),t}}const Wse="\r",$se='"',Gse=`
`;class jse extends fO{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=bt(r,l=>this._escapeCell(l,!0)),o&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),D(t,(l,u)=>{u>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[u])+e.columnDelimiter),a+=l.map(h=>this._escapeCell(h)).join(e.columnDelimiter)}),a}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Kn(e);return r!==""&&(t||r.indexOf(Wse)>=0||r.indexOf($se)>=0||r.indexOf(Gse)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const zse="csv",gN={[zse]:jse};function Yse(n,e,t){return typeof gN[n]=="function"?new gN[n](e,t):null}const Kse="exportFile",qse=240;class Xse extends Wt{static get PLUGIN_KEY(){return Kse}static get PLUGIN_PRIORITY(){return qse}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,t),o=this._createBlob(s),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const h=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",h),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(h)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,u)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!gN[e])throw new Error(`Export format type "${e}" is not supported.`);return Yse(e,new Vse(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function Lc(n,e,t){return(e=Qse(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Qse(n){var e=Zse(n,"string");return typeof e=="symbol"?e:e+""}function Zse(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ep{constructor(e,t){let{id:r,stateless:i=!0}=t;Lc(this,"hot",void 0),Lc(this,"id",void 0),Lc(this,"elements",[]),Lc(this,"hidden",!1),Lc(this,"stateId",""),Lc(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new WC)}getElements(){return this.elements}reset(){D(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),D(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}Zt(ep,Hr);const fg={};function fu(n,e){if(!fg[n])throw Error(`Filter condition "${n}" does not exist.`);const{condition:t,descriptor:r}=fg[n];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(s){return t.apply(s.meta.instance,[].concat([s],[i]))}}function Mh(n){if(!fg[n])throw Error(`Filter condition "${n}" does not exist.`);return fg[n].descriptor}function Qn(n,e,t){t.key=n,fg[n]={condition:e,descriptor:t}}const yr="none";function Jse(){return!0}Qn(yr,Jse,{name:$C,inputsCount:0,showOperators:!1});const Mm="empty";function eoe(n){return Bn(n.value)}Qn(Mm,eoe,{name:cM,inputsCount:0,showOperators:!0});const Tv="not_empty";function toe(n,e){return!fu(Mm,e)(n)}Qn(Tv,toe,{name:dM,inputsCount:0,showOperators:!0});const Om="eq";function noe(n,e){let[t]=e;return Kn(n.value).toLocaleLowerCase(n.meta.locale)===Kn(t)}Qn(Om,noe,{name:fM,inputsCount:1,showOperators:!0});const Av="neq";function roe(n,e){return!fu(Om,e)(n)}Qn(Av,roe,{name:mM,inputsCount:1,showOperators:!0});const _W="gt";function ioe(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>r}Qn(_W,ioe,{name:yM,inputsCount:1,showOperators:!0});const xW="gte";function soe(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>=r}Qn(xW,soe,{name:CM,inputsCount:1,showOperators:!0});const PW="lt";function ooe(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<r}Qn(PW,ooe,{name:SM,inputsCount:1,showOperators:!0});const LW="lte";function aoe(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<=r}Qn(LW,aoe,{name:RM,inputsCount:1,showOperators:!0});const mO="date_after";function loe(n,e){let[t]=e;const r=se(n.value,n.meta.dateFormat),i=se(t,n.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Qn(mO,loe,{name:TM,inputsCount:1,showOperators:!0});const gO="date_before";function uoe(n,e){let[t]=e;const r=se(n.value,n.meta.dateFormat),i=se(t,n.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Qn(gO,uoe,{name:AM,inputsCount:1,showOperators:!0});const Ry="between";function hoe(n,e){let[t,r]=e,i=t,s=r;if(n.meta.type==="numeric"){const o=parseFloat(i,10),a=parseFloat(s,10);i=Math.min(o,a),s=Math.max(o,a)}else if(n.meta.type==="date"){const o=fu(gO,[s]),a=fu(mO,[i]);return o(n)&&a(n)}return n.value>=i&&n.value<=s}Qn(Ry,hoe,{name:EM,inputsCount:2,showOperators:!0});const DW="not_between";function coe(n,e){return!fu(Ry,e)(n)}Qn(DW,coe,{name:bM,inputsCount:2,showOperators:!0});const HW="begins_with";function doe(n,e){let[t]=e;return Kn(n.value).toLocaleLowerCase(n.meta.locale).startsWith(Kn(t))}Qn(HW,doe,{name:gM,inputsCount:1,showOperators:!0});const FW="ends_with";function foe(n,e){let[t]=e;return Kn(n.value).toLocaleLowerCase(n.meta.locale).endsWith(Kn(t))}Qn(FW,foe,{name:pM,inputsCount:1,showOperators:!0});const pO="contains";function moe(n,e){let[t]=e;return Kn(n.value).toLocaleLowerCase(n.meta.locale).indexOf(Kn(t))>=0}Qn(pO,moe,{name:wM,inputsCount:1,showOperators:!0});const kW="not_contains";function goe(n,e){return!fu(pO,e)(n)}Qn(kW,goe,{name:vM,inputsCount:1,showOperators:!0});const VW="date_tomorrow";function poe(n){const e=se(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(se().subtract(-1,"days").startOf("day"),"d"):!1}Qn(VW,poe,{name:IM,inputsCount:0});const UW="date_today";function woe(n){const e=se(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(se().startOf("day"),"d"):!1}Qn(UW,woe,{name:NM,inputsCount:0});const BW="date_yesterday";function voe(n){const e=se(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(se().subtract(1,"days").startOf("day"),"d"):!1}Qn(BW,voe,{name:MM,inputsCount:0});A4();function yoe(n,e){let t=n;return t===""&&(t=`(${e})`),t}const pN=new Set([1]).has(1),Coe=pN&&typeof Array.from=="function";function tp(n){let e=n;return pN&&(e=new Set(e)),function(t){let r;return pN?r=e.has(t):r=!!~e.indexOf(t),r}}function WW(n){return n??""}function wN(n){let e=n;return Coe?e=Array.from(new Set(e)):e=GV(e),e=e.sort((t,r)=>typeof t=="number"&&typeof r=="number"?t-r:t===r?0:t>r?1:-1),e}function UD(n,e,t,r){const i=[],s=n===e;let o;return s||(o=tp(e)),D(n,a=>{let l=!1;(s||o(a))&&(l=!0);const u={checked:l,value:a,visualValue:yoe(a,t)};r&&r(u),i.push(u)}),i}const Oh="by_value";function Soe(n,e){let[t]=e;return t(n.value)}Qn(Oh,Soe,{name:"By value",inputsCount:0,inputValuesDecorator(n){let[e]=n;return[tp(e)]},showOperators:!1});const mg={};function Roe(n){if(!mg[n])throw Error(`Operation with id "${n}" does not exist.`);const e=mg[n].func;return function(t,r){return e(t,r)}}function Eoe(n){return mg[n].name}function wO(n,e,t){mg[n]={name:e,func:t}}const au="conjunction",boe=xM;function Toe(n,e){return n.every(t=>t.func(e))}wO(au,boe,Toe);const Ey="disjunction",Aoe=GC;function Noe(n,e){return n.some(t=>t.func(e))}wO(Ey,Aoe,Noe);const vO="disjunctionWithExtraCondition",Ioe=GC;function Moe(n,e){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(t=>t.func(e))&&n[n.length-1].func(e)}wO(vO,Ioe,Moe);const Ooe="numeric",$W="text",_oe="date",BD={[Ooe]:[yr,dt,Mm,Tv,dt,Om,Av,dt,_W,xW,PW,LW,Ry,DW],[$W]:[yr,dt,Mm,Tv,dt,Om,Av,dt,HW,FW,dt,pO,kW],[_oe]:[yr,dt,Mm,Tv,dt,Om,Av,dt,gO,mO,Ry,dt,VW,UW,BW]};function xoe(n){const e=[];let t=n;return BD[t]||(t=$W),D(BD[t],r=>{let i;r===dt?i={name:dt}:i=ma(Mh(r)),e.push(i)}),e}function jf(n,e,t){return(e=Poe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Poe(n){var e=Loe(n,"string");return typeof e=="symbol"?e:e+""}function Loe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const pT="built",wT="building",WD=["click","input","keydown","keypress","keyup","focus","blur","change"];let co=class GW{static get DEFAULTS(){return ma({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){jf(this,"hot",void 0),jf(this,"eventManager",new wo(this)),jf(this,"options",void 0),jf(this,"_element",void 0),jf(this,"buildState",void 0),this.hot=e,this.options=er(GW.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===wT?this._element:this.buildState===pT?(this.update(),this._element):(this.buildState=wT,this.build(),this.buildState=pT,this._element)}isBuilt(){return this.buildState===pT}translateIfPossible(e){return typeof e=="string"&&e.startsWith(ci)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,r)=>{this.eventManager.addEventListener(t,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=wT),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&oe(this._element,this.options.className),this.options.children.length)D(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),gt(this.options,(r,i)=>{t[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(t[i]=this.translateIfPossible(r))}),this._element.appendChild(t),D(WD,r=>e(t,r))}else D(WD,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Zt(co,Hr);function Doe(n,e){jW(n,e),e.add(n)}function Hoe(n,e,t){jW(n,e),e.set(n,t)}function jW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fw(n,e){return n.get(yO(n,e))}function Foe(n,e,t){return n.set(yO(n,e),t),t}function yO(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Dc=new WeakMap,$D=new WeakSet;class lu extends co{static get DEFAULTS(){return ma({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,er(lu.DEFAULTS,t)),Doe(this,$D),Hoe(this,Dc,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>yO($D,this,koe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Foe(Dc,this,this._element.firstChild),oe(this._element,"htUIInput"),oe(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(fw(Dc,this).type=this.options.type,fw(Dc,this).placeholder=this.translateIfPossible(this.options.placeholder),fw(Dc,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&fw(Dc,this).focus()}}function koe(n){this.options.value=n.target.value}function Voe(n,e){zW(n,e),e.add(n)}function zf(n,e,t){zW(n,e),e.set(n,t)}function zW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hc(n,e,t){return n.set(_m(n,e),t),t}function En(n,e){return n.get(_m(n,e))}function _m(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var or=new WeakMap,mw=new WeakMap,gw=new WeakMap,vT=new WeakMap,pw=new WeakMap,ww=new WeakSet;class gg extends co{static get DEFAULTS(){return ma({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,er(gg.DEFAULTS,t)),Voe(this,ww),zf(this,or,null),zf(this,mw,[]),zf(this,gw,void 0),zf(this,vT,void 0),zf(this,pw,void 0),this.registerHooks()}getMenu(){return En(or,this)}registerHooks(){this.addLocalHook("click",()=>_m(ww,this,Woe).call(this))}setItems(e){Hc(mw,this,this.translateNames(e)),En(or,this)&&En(or,this).setMenuItems(En(mw,this))}translateNames(e){return D(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),Hc(or,this,new tf(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),En(or,this).setMenuItems(En(mw,this));const e=new co(this.hot,{className:"htUISelectCaption"}),t=new co(this.hot,{className:"htUISelectDropdown"});Hc(gw,this,e),Hc(vT,this,e.element),Hc(pw,this,t),this.hot.getSettings().ariaTags&&(Xe(t.element,[ic()]),Xe(this._element,[qV()])),D([e,t],r=>this._element.appendChild(r.element)),En(or,this).addLocalHook("select",r=>_m(ww,this,Uoe).call(this,r)),En(or,this).addLocalHook("afterClose",()=>_m(ww,this,Boe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=En(or,this).hot.getTranslatedPhrase($C),En(vT,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();En(or,this)&&(En(or,this).open(),En(or,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),En(or,this).getNavigator().toFirstItem(),En(or,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){En(or,this)&&En(or,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){En(or,this)&&(En(or,this).destroy(),Hc(or,this,null)),En(gw,this)&&En(gw,this).destroy(),En(pw,this)&&En(pw,this).destroy(),super.destroy()}}function Uoe(n){n.name!==dt&&(this.options.value=n,this.update(),this.runLocalHooks("select",this.options.value))}function Boe(){this.runLocalHooks("afterClose")}function Woe(){this.openOptions()}function $oe(n,e){Goe(n,e),e.add(n)}function Goe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GD(n,e,t){return(e=joe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function joe(n){var e=zoe(n,"string");return typeof e=="symbol"?e:e+""}function zoe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function jD(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var yT=new WeakSet;class vN extends ep{constructor(e,t){super(e,{id:t.id,stateless:!1}),$oe(this,yT),GD(this,"name",""),GD(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new gg(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new lu(this.hot,{placeholder:kM})),this.elements.push(new lu(this.hot,{placeholder:VM})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>jD(yT,this,Yoe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),D(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>jD(yT,this,Koe).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=ma(e.command);t.name.startsWith(Pn)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),D(e.args,(r,i)=>{if(i>t.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(r),s[t.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Mh(yr),t=[];return D(this.getInputElements(),(r,i)=>{e.inputsCount>i&&t.push(r.getValue())}),{command:e,args:t}}updateState(e,t){const r=Mh(e?e.name:yr);this.state.setValueAtIndex(t,{command:r,args:e?e.args:[]}),e||D(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof gg)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof lu)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,i,s,o)=>{oe(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&oe(t.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return oe(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||D(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[Mh(yr)];if(e!==null){const{visualIndex:r}=e;t=xoe(this.hot.getDataType(0,r,this.hot.countRows(),r))}D(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function Yoe(n){D(this.getInputElements(),(e,t)=>{e[n.inputsCount>t?"show":"hide"](),t===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",n)}function Koe(n){$g(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ro(n))}function zD(n,e,t){qoe(n,e),e.set(n,t)}function qoe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yf(n,e){return n.get(YW(n,e))}function YD(n,e,t){return n.set(YW(n,e),t),t}function YW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Fc=new WeakMap,CT=new WeakMap;class by extends co{static get DEFAULTS(){return ma({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,er(by.DEFAULTS,t)),zD(this,Fc,void 0),zD(this,CT,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),YD(CT,this,e),YD(Fc,this,this._element.firstChild),Yf(Fc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Yf(CT,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Yf(Fc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Yf(Fc,this).checked=e)}focus(){this.isBuilt()&&Yf(Fc,this).focus()}}function Xoe(n,e){Qoe(n,e),e.add(n)}function Qoe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zoe(n,e,t){return(e=Joe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Joe(n){var e=eae(n,"string");return typeof e=="symbol"?e:e+""}function eae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function tae(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const KD=0;var qD=new WeakSet;class nae extends ep{constructor(e,t){super(e,{id:t.id,stateless:!1}),Xoe(this,qD),Zoe(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(oe(t.parentNode,"htFiltersMenuOperators"),D(this.elements,r=>t.appendChild(r.element)),t)}}buildOperatorsElement(){const e=[au,Ey];D(e,t=>{const r=new by(this.hot,{name:"operator",label:{htmlFor:t,textContent:Eoe(t)},value:t,checked:t===e[KD],id:t});r.addLocalHook("change",i=>tae(qD,this,rae).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(zt`Radio button with index ${e} doesn't exist.`);D(this.elements,(t,r)=>{t.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof by&&t.isChecked());return e?e.getValue():au}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&D(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:au,t=arguments.length>1?arguments[1]:void 0,r=e;r===vO&&(r=Ey),this.state.setValueAtIndex(t,r)}reset(){this.setChecked(KD)}}function rae(n){this.setState(n.target.value)}function iae(n,e,t){sae(n,e),e.set(n,t)}function sae(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ST(n,e){return n.get(KW(n,e))}function oae(n,e,t){return n.set(KW(n,e),t),t}function KW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Kf=new WeakMap;class pg extends co{static get DEFAULTS(){return ma({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,er(pg.DEFAULTS,t)),iae(this,Kf,void 0)}build(){super.build(),oae(Kf,this,this._element.firstChild)}update(){this.isBuilt()&&(ST(Kf,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&ST(Kf,this).focus()}activate(){ST(Kf,this).click()}}function aae(n,e){qW(n,e),e.add(n)}function kc(n,e,t){qW(n,e),e.set(n,t)}function qW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ut(n,e){return n.get(md(n,e))}function Gs(n,e,t){return n.set(md(n,e),t),t}function md(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const XD="multipleSelect.itemBox";var Zs=new WeakMap,Gn=new WeakMap,RT=new WeakMap,Da=new WeakMap,Il=new WeakMap,Ml=new WeakMap,qf=new WeakSet;class wg extends co{static get DEFAULTS(){return ma({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,er(wg.DEFAULTS,t)),aae(this,qf),kc(this,Zs,[]),kc(this,Gn,void 0),kc(this,RT,void 0),kc(this,Da,void 0),kc(this,Il,void 0),kc(this,Ml,void 0),Gs(Da,this,new lu(this.hot,{placeholder:FM,className:"htUIMultipleSelectSearch"})),Gs(Il,this,new pg(this.hot,{textContent:PM,className:"htUISelectAll"})),Gs(Ml,this,new pg(this.hot,{textContent:LM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return ut(Gn,this)}registerHooks(){ut(Da,this).addLocalHook("keydown",e=>md(qf,this,uae).call(this,e)),ut(Da,this).addLocalHook("input",e=>md(qf,this,lae).call(this,e)),ut(Il,this).addLocalHook("click",e=>md(qf,this,hae).call(this,e)),ut(Ml,this).addLocalHook("click",e=>md(qf,this,cae).call(this,e))}setItems(e){var t;Gs(Zs,this,e),(t=ut(Gn,this))===null||t===void 0||t.loadData(ut(Zs,this))}setLocale(e){Gs(RT,this,e)}getLocale(){return ut(RT,this)}getItems(){return[...ut(Zs,this)]}getValue(){return fae(ut(Zs,this))}getSearchInputElement(){return ut(Da,this)}getSelectAllElement(){return ut(Il,this)}getClearAllElement(){return ut(Ml,this)}isSelectedAllValues(){return ut(Zs,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),r=new co(this.hot,{className:"htUISelectionControls",children:[ut(Il,this),ut(Ml,this)]});this._element.appendChild(ut(Da,this).element),this._element.appendChild(r.element),this._element.appendChild(t);const i=s=>{var o;if(!this._element)return;(o=ut(Gn,this))===null||o===void 0||o.destroy(),oe(s,"htUIMultipleSelectHot"),Gs(Gn,this,new this.hot.constructor(s,{data:ut(Zs,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,h,c,d,f,m)=>{u.title=m.instance.getDataAtRowProp(h,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{ut(Gn,this).listen()},colWidths:()=>ut(Gn,this).container.scrollWidth-Rr(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),ut(Gn,this).init();const l=ut(Gn,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:XD}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{ut(Gn,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:XD})};i(t),this.hot._registerTimeout(()=>i(t),100)}focus(){this.isBuilt()&&ut(Gn,this).listen()}reset(){ut(Da,this).reset(),ut(Il,this).reset(),ut(Ml,this).reset()}update(){this.isBuilt()&&(ut(Gn,this).loadData(dae(ut(Zs,this),this.options.value)),super.update())}destroy(){var e;(e=ut(Gn,this))===null||e===void 0||e.destroy(),ut(Da,this).destroy(),ut(Ml,this).destroy(),ut(Il,this).destroy(),Gs(Da,this,null),Gs(Ml,this,null),Gs(Il,this,null),Gs(Gn,this,null),Gs(Zs,this,null),super.destroy()}}function lae(n){const e=n.target.value.toLocaleLowerCase(this.getLocale());let t;e===""?t=[...ut(Zs,this)]:t=ut(Zs,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),ut(Gn,this).loadData(t)}function uae(n){this.runLocalHooks("keydown",n,this),cU($g,n.keyCode)("ARROW_DOWN")&&(n.preventDefault(),Ro(n),ut(Gn,this).listen(),ut(Gn,this).selectCell(0,0))}function hae(n){const e=[];n.preventDefault(),ut(Gn,this).getSourceData().forEach((t,r)=>{t.checked=!0,e.push(qU(t,r)[0])}),ut(Gn,this).setSourceDataAtCell(e)}function cae(n){const e=[];n.preventDefault(),ut(Gn,this).getSourceData().forEach((t,r)=>{t.checked=!1,e.push(qU(t,r)[0])}),ut(Gn,this).setSourceDataAtCell(e)}function dae(n,e){const t=tp(e);return n.map(r=>(r.checked=t(r.value),r))}function fae(n){const e=[];return n.forEach(t=>{t.checked&&e.push(t.value)}),e}function mae(n,e){gae(n,e),e.add(n)}function gae(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pae(n,e,t){return(e=wae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wae(n){var e=vae(n,"string");return typeof e=="symbol"?e:e+""}function vae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Xf=new WeakSet;class yae extends ep{constructor(e,t){super(e,{id:t.id,stateless:!1}),mae(this,Xf),pae(this,"name",""),this.name=t.name,this.elements.push(new wg(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>vw(Xf,this,Cae).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>vw(Xf,this,Sae).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Oh){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?yr:Oh},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(r,i,s,o,a)=>{const[l]=du(i,c=>c.name===Oh),u={},h=this.hot.getTranslatedPhrase(hy);if(l){const c=o(r,a),d=bt(c,C=>C.value),f=new Map(c.map(C=>[C.value,this.hot.getCellMeta(C.meta.visualRow,C.meta.visualCol)])),m=wN(d);s&&(l.args[0]=s);const p=[],v=UD(m,l.args[0],h,C=>{C.checked&&p.push(C.value),vw(Xf,this,QD).call(this,C,f)}),y=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,y).locale,u.args=[p],u.command=Mh(Oh),u.itemsSnapshot=v}else u.args=[],u.command=Mh(yr);this.state.setValueAtIndex(r,u)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof wg)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,i,s,o)=>{oe(t.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return oe(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||D(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(hy),t=this._getColumnVisibleValues(),r=t.map(l=>l.value),i=new Map(t.map(l=>[l.value,l.meta])),s=wN(r),o=UD(s,s,e,l=>{vw(Xf,this,QD).call(this,l,i)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:bt(this.hot.getDataAtCol(e.visualIndex),(t,r)=>({value:WW(t),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function Cae(n){$g(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ro(n))}function QD(n,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(n.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",n.visualValue,e.get(n.value)))}function Sae(n,e){return e.type==="numeric"?WB(n,e):n}var XW;function Rae(n,e){Eae(n,e),e.add(n)}function Eae(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bae(n,e,t){return(e=Tae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Tae(n){var e=Aae(n,"string");return typeof e=="symbol"?e:e+""}function Aae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Nae(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ZD=new WeakSet;class vg extends ep{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),Rae(this,ZD),bae(this,"name",""),this.name=t.name,this.elements.push(new lu(this.hot,{type:"button",value:DM,className:"htUIButton htUIButtonOK",identifier:vg.BUTTON_OK})),this.elements.push(new lu(this.hot,{type:"button",value:HM,className:"htUIButton htUIButtonCancel",identifier:vg.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){D(this.elements,e=>{e.addLocalHook("click",(t,r)=>Nae(ZD,this,Iae).call(this,t,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(oe(t.parentNode,"htFiltersMenuActionBar"),D(this.elements,r=>t.appendChild(r.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}XW=vg;function Iae(n,e){e.options.identifier===XW.BUTTON_OK?this.accept():this.cancel()}function yw(n,e,t){return(e=Mae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Mae(n){var e=Oae(n,"string");return typeof e=="symbol"?e:e+""}function Oae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const JD="ConditionCollection.filteringStates";class CO{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;yw(this,"hot",void 0),yw(this,"isMapRegistrable",void 0),yw(this,"filteringStates",new WC),yw(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=t,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(JD,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var r;const i=this.filteringStates.getValueAtIndex(t),s=(r=i?.conditions)!==null&&r!==void 0?r:[],o=i?.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:au;return e.length?Roe(r)(e,t):!0}addCondition(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:au,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=bt(t.args,h=>typeof h=="string"?h.toLocaleLowerCase(s):h),a=t.name||t.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(zt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(hn(mg[r]))throw new Error(zt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:o,func:fu(a,o)}]},i):u.push({name:a,args:o,func:fu(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,r;return(t=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return hi(this.filteringStates.getEntries(),(e,t)=>{let[r,{operation:i,conditions:s}]=t;return e.push({column:r,operation:i,conditions:bt(s,o=>{let{name:a,args:l}=o;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),D(e,t=>{D(t.conditions,r=>this.addCondition(t.column,r))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const r=this.getConditions(e);return t?r.some(i=>i.name===t):r.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(JD),this.filteringStates=null,this.clearLocalHooks()}}Zt(CO,Hr);function eH(n,e,t){return(e=_ae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _ae(n){var e=xae(n,"string");return typeof e=="symbol"?e:e+""}function xae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class QW{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];eH(this,"conditionCollection",void 0),eH(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return D(this.conditionCollection.getFilteredColumns(),(t,r)=>{let i=this.columnDataFactory(t);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(t,i)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return D(t,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,t){const r=[];return D(t,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(r[s]=e[s])}),r}}function Pae(n,e){Lae(n,e),e.add(n)}function Lae(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qu(n,e,t){return(e=Dae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Dae(n){var e=Hae(n,"string");return typeof e=="symbol"?e:e+""}function Hae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ET(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Cw=new WeakSet;class ZW{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Pae(this,Cw),Qu(this,"hot",void 0),Qu(this,"conditionCollection",void 0),Qu(this,"columnDataFactory",void 0),Qu(this,"changes",[]),Qu(this,"grouping",!1),Qu(this,"latestEditedColumnPosition",-1),Qu(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>ET(Cw,this,Fae).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>ET(Cw,this,kae).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>ET(Cw,this,Vae).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,D(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=i.slice(0,s),a=i.slice(s);a.length&&a[0].column===e&&a.shift();const l=y4(function(h,c){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new CO(r.hot,!1),m=[].concat(h,d);f.importAllConditions(m);const p=r.columnDataFactory(c);let v;f.isEmpty()?v=p:v=new QW(f,C=>r.columnDataFactory(C)).filter(),v=bt(v,C=>C.meta.visualRow);const y=tp(v);return f.destroy(),du(p,C=>y(C.meta.visualRow))})(o),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),gt(this,(e,t)=>{this[t]=null})}}function Fae(n){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(n)}function kae(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Vae(){D(this.latestOrderStack,n=>{this.updateStatesAtColumn(n)})}Zt(ZW,Hr);function Uae(n){return yW({initialPage:0,size:()=>n.length,onItemSelect:(t,r)=>{const i=n[t];if(i instanceof wg)return r;if(i.element&&!Ld(i.element))return!1;i.focus()}})}const Qf="filters";function Bae(n,e){let t=-1;const r=Uae(e),i=l=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(Qf),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof co&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),n.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function s(l){const u=n.getKeyboardShortcutsCtrl(),h=l.getKeyboardShortcutsCtrl();r.clear(),h.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(Qf),callback:()=>{l.isSubMenu()&&l.close(),u.listen(Qf)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:c=>{const d=n.getNavigator();d.getCurrentPage()>-1&&(t=d.getCurrentPage()),d.clear(),c.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:c=>{const d=e[r.getCurrentPage()];d instanceof gg&&(d.openOptions(),c.preventDefault()),d instanceof pg&&(d.activate(),c.preventDefault()),d instanceof co||c.preventDefault()}}],Qf)}n.addLocalHook("afterSubmenuOpen",s),n.addLocalHook("afterOpen",s);function o(){n.focus(),n.getKeyboardShortcutsCtrl().listen(Qf)}function a(){return t}return{...r,listen:o,getLastMenuPage:a}}function Wae(n,e){JW(n,e),e.add(n)}function $ae(n,e,t){JW(n,e),e.set(n,t)}function JW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zf(n,e,t){return(e=Gae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Gae(n){var e=jae(n,"string");return typeof e=="symbol"?e:e+""}function jae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function zae(n,e,t){return n.set($i(n,e),t),t}function Jf(n,e){return n.get($i(n,e))}function $i(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const yN="filters",Yae=250,tH=yN;var Zu=new WeakMap,ls=new WeakSet;class Kae extends Wt{static get PLUGIN_KEY(){return yN}static get PLUGIN_PRIORITY(){return Yae}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),Wae(this,ls),Zf(this,"dropdownMenuPlugin",null),Zf(this,"conditionCollection",null),Zf(this,"conditionUpdateObserver",null),Zf(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Zf(this,"filtersRowsMap",null),$ae(this,Zu,void 0),this.hot.addHook("afterGetColHeader",(t,r)=>$i(ls,this,ele).call(this,t,r))}isEnabled(){return!!this.hot.getSettings()[yN]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Yg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,r=o=>(o.addLocalHook("accept",()=>$i(ls,this,nH).call(this,"accept")),o.addLocalHook("cancel",()=>$i(ls,this,nH).call(this,"cancel")),o.addLocalHook("change",a=>$i(ls,this,Jae).call(this,o,a)),o),i=()=>`${this.hot.getTranslatedPhrase(OM)}:`,s=()=>`${this.hot.getTranslatedPhrase(_M)}:`;if(!this.components.get("filter_by_condition")){const o=new vN(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:t});o.addLocalHook("afterClose",()=>$i(ls,this,rH).call(this)),this.components.set("filter_by_condition",r(o))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new nae(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const o=new vN(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});o.addLocalHook("afterClose",()=>$i(ls,this,rH).call(this)),this.components.set("filter_by_condition2",r(o))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new yae(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new vg(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new CO(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new ZW(this.hot,this.conditionCollection,o=>this.getDataMapAtColumn(o)),this.conditionUpdateObserver.addLocalHook("update",o=>$i(ls,this,tle).call(this,o))),this.components.forEach(o=>o.show()),this.addHook("afterDropdownMenuDefaultOptions",o=>$i(ls,this,Zae).call(this,o)),this.addHook("afterDropdownMenuShow",()=>$i(ls,this,Xae).call(this)),this.addHook("afterDropdownMenuHide",()=>$i(ls,this,Qae).call(this)),this.addHook("afterChange",o=>$i(ls,this,qae).call(this,o)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Jf(Zu,this)&&this.dropdownMenuPlugin.enabled){const o=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=o.getNavigator(),h=Jf(Zu,this).getLastMenuPage();o.focus(),h>0?u.setCurrentPage(h):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,h]=u;return h.getElements()}).flat()];zae(Zu,this,Bae(o,a));const l=u=>{Jf(Zu,this).listen(),u.preventDefault(),$g(u.keyCode,"TAB")&&(u.shiftKey?Jf(Zu,this).toPreviousItem():Jf(Zu,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,r)=>{t.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:tH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tH)}addCondition(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:au;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:t},args:r},i)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const s=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",s,this.conditionCollection.previousConditionStack)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=bt(t.filter(),u=>u.meta.visualRow);const l=tp(i);De(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),D(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),r=[];return D(this.hot.getSourceDataAtCol(t),(i,s)=>{var o;const{row:a,col:l,visualCol:u,visualRow:h,type:c,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(s,t),p=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),t))!==null&&o!==void 0?o:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:h,type:c,instance:d,dateFormat:f,locale:m},value:WW(p)})}),r}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),r=wN(t);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var t;const r=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,r,i){let s=e;return s===Ey&&t.command.key!==yr&&r.command.key!==yr&&i.command.key!==yr?s=vO:i.command.key!==yr&&(t.command.key===yr||r.command.key===yr)&&(s=au),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new QW(e,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return D(i,o=>{D(t.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function qae(n){n&&D(n,e=>{const[,t]=e,r=this.hot.propToCol(t);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Xae(){const n=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),n.updateMenuDimensions()}function Qae(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Zae(n){n.items.push({name:dt}),this.components.forEach(e=>{n.items.push(e.getMenuItemDescriptor())})}function nH(n){var e;if(n==="accept"){const r=this.getSelectedColumn();if(r===null){var t;(t=this.dropdownMenuPlugin)===null||t===void 0||t.close();return}const{physicalIndex:i}=r,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),s.command.key!==yr&&(this.conditionCollection.addCondition(i,s,l,u),o.command.key!==yr&&this.conditionCollection.addCondition(i,o,l,u)),a.command.key!==yr&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(h=>h.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Jae(n,e){this.updateDependentComponentsVisibility(),n.constructor===vN&&!e.inputsCount&&this.setListeningDropdownMenu()}function rH(){this.setListeningDropdownMenu()}function ele(n,e){const t=this.hot.toPhysicalColumn(n);this.enabled&&this.conditionCollection.hasConditions(t)?oe(e,"htFiltersActive"):rt(e,"htFiltersActive")}function tle(n){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:t,column:r}}=n,i=t.filter(o=>o.name===Oh),s=t.filter(o=>o.name!==Oh);if(i.length>=2||s.length>=3)jt(zt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const o=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(o,r),this.components.get("filter_by_value").updateState(n)}}const e$="internal-use-in-handsontable",CN={licenseKey:e$,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function t$(n){var e;return{maxColumns:n.maxColumns,maxRows:n.maxRows,language:(e=n[jr])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function n$(n){return Object.keys(n).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=n[t]),e),{})}function nle(n){var e;const t=n[jr],r=n$(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),i=t$(n);return{...CN,...r,...i}}function rle(n){var e;const t=n[jr],r=n$(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),i=t$(n);return{...r,...i}}function ile(n,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==n[t])}function lS(){const n="engine_relationship",e=Eo(jr);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function SO(){const n="shared_engine_usage",e=Eo(jr);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function sle(n){const e=n.getSettings(),t=e[jr],r=t?.engine;if(t===!0||hn(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return ole((i=r.hyperformula)!==null&&i!==void 0?i:r,e,n)}else if(typeof r=="object"&&hn(r.hyperformula)){const s=lS(),o=SO().get(r);return s.has(r)||s.set(r,[]),s.get(r).push(n),o&&o.push(n.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:e$}),(r.getConfig().leapYear1900!==CN.leapYear1900||Q0(r.getConfig().nullDate,CN.nullDate)===!1)&&jt(zt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function ole(n,e,t){const r=e[jr],i=nle(e),s=lS(),o=SO();ale(n,r.functions),lle(n,r.language);const a=n.buildEmpty(i);return s.set(a,[t]),o.set(a,[t.guid]),ule(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function iH(n){var e;const t=lS(),r=t.size===0?[]:Array.from((e=t.get(n))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function sH(n,e){if(n){const t=lS(),r=t.get(n),i=SO(),s=i.get(n);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&t.delete(n)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(n),n.destroy()))}}function ale(n,e){e&&e.forEach(t=>{const{name:r,plugin:i,translations:s}=t;try{n.registerFunction(r,i,s)}catch(o){jt(o.message)}})}function lle(n,e){if(e){const{langCode:t}=e;try{n.registerLanguage(t,e)}catch(r){jt(r.message)}}}function ule(n,e){e&&(n.suspendEvaluation(),e.forEach(t=>{const{name:r,expression:i,scope:s,options:o}=t;try{n.addNamedExpression(r,i,s,o)}catch(a){jt(a.message)}}),n.resumeEvaluation())}function hle(n,e){return(hn(e)||!n.doesSheetExist(e))&&(e=n.addSheet(e)),e}const r$="DD/MM/YYYY";function i$(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function cle(n){return i$(n)?n.substr(1):n}function dle(n){return typeof n=="string"&&n.startsWith("=")}function RO(n,e){return typeof n=="string"&&e==="date"}function s$(n,e){return se(n,e,!0).isValid()}function o$(n,e){return se(n,e,!0).format(r$)}function fle(n,e){return se(n,r$,!0).format(e)}function a$(n,e){const r=new Date(Date.UTC(0,0,n+-1));return se(r).format(e)}function mle(n,e,t){const r=Array.from(Array(t).keys()).filter(s=>n.includes(s)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function gle(n,e){const t=[];return n.forEach(r=>{const i={from:r,to:e};t.forEach(s=>{const o=s.from>s.to,a=s.to<=i.from;s.from>i.from&&a&&o&&(i.from+=1)}),i.from>=e&&(e+=1),t.push(i)}),t}function ple(n){return n.forEach((e,t)=>{n.slice(t+1).forEach(i=>{const s=i.from<i.to;i.from>e.from&&s&&(i.from-=1)})}),n}function EO(n,e,t){const r=gle(n,mle(n,e,t));return ple(r)}function Ju(n,e,t){wle(n,e),e.set(n,t)}function wle(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gn(n,e){return n.get(l$(n,e))}function Ol(n,e,t){return n.set(l$(n,e),t),t}function l$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var em=new WeakMap,_l=new WeakMap,ki=new WeakMap,Sw=new WeakMap,bT=new WeakMap,TT=new WeakMap,Rw=new WeakMap;class oH{constructor(e,t,r){Ju(this,em,void 0),Ju(this,_l,void 0),Ju(this,ki,void 0),Ju(this,Sw,[]),Ju(this,bT,[]),Ju(this,TT,void 0),Ju(this,Rw,[]),Ol(em,this,e),Ol(_l,this,t),Ol(ki,this,r)}setRemovedHfIndexes(e){return Ol(Rw,this,e.map(t=>{const r=gn(_l,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(r)})),gn(Rw,this)}getRemovedHfIndexes(){return gn(Rw,this)}getHfIndexFromVisualIndex(e){const t=gn(_l,this).getIndexesSequence(),r=gn(_l,this).getNotTrimmedIndexes();return t.indexOf(r[e])}syncMoves(e){const r=`move${po(gn(em,this))}s`;gn(ki,this).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,o=i.from+1!==i.to;s&&o&&gn(ki,this).getEngine()[r](gn(ki,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,t,r){r!==!1&&(Ol(bT,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),Ol(TT,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(gn(ki,this).isPerformingUndoRedo()||e===!1||t===!1)return;const r=EO(gn(bT,this),gn(TT,this),gn(_l,this).getNumberOfIndexes());gn(ki,this).getSheetId()===null?gn(ki,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${po(gn(em,this))}Order`;return t=>{if(gn(ki,this).isPerformingUndoRedo())return;const r=gn(_l,this).getIndexesSequence();if(t==="update"&&r.length>0){const i=gn(Sw,this).map(l=>r.indexOf(l)),s=gn(ki,this).getEngine().getSheetDimensions(gn(ki,this).getSheetId());let o;gn(em,this)==="row"?o=s.height:o=s.width;const a=i.length;for(let l=a;l<o;l+=1)i.push(l);gn(ki,this).getEngine()[e](gn(ki,this).getSheetId(),i)}Ol(Sw,this,r)}}init(){Ol(Sw,this,gn(_l,this).getIndexesSequence())}}function eh(n,e,t){vle(n,e),e.set(n,t)}function vle(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ha(n,e){return n.get(u$(n,e))}function th(n,e,t){return n.set(u$(n,e),t),t}function u$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ew=new WeakMap,bw=new WeakMap,AT=new WeakMap,NT=new WeakMap,IT=new WeakMap,MT=new WeakMap,OT=new WeakMap;class yle{constructor(e,t,r){eh(this,Ew,void 0),eh(this,bw,void 0),eh(this,AT,void 0),eh(this,NT,!1),eh(this,IT,!1),eh(this,MT,null),eh(this,OT,null),th(Ew,this,new oH("row",e,this)),th(bw,this,new oH("column",t,this)),th(AT,this,r)}getForAxis(e){return e==="row"?Ha(Ew,this):Ha(bw,this)}setPerformUndo(e){th(NT,this,e)}setPerformRedo(e){th(IT,this,e)}isPerformingUndoRedo(){return Ha(NT,this)||Ha(IT,this)}getSheetId(){return Ha(OT,this)}getEngine(){return Ha(MT,this)}getPostponeAction(){return Ha(AT,this)}setupSyncEndpoint(e,t){th(MT,this,e),th(OT,this,t),Ha(Ew,this).init(),Ha(bw,this).init()}}function Cle(n,e){h$(n,e),e.add(n)}function Vc(n,e,t){return(e=Sle(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Sle(n){var e=Rle(n,"string");return typeof e=="symbol"?e:e+""}function Rle(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function _T(n,e,t){h$(n,e),e.set(n,t)}function h$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mu(n,e,t){return n.set(Kt(n,e),t),t}function bd(n,e){return n.get(Kt(n,e))}function Kt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const jr="formulas",Ele=["maxRows","maxColumns","language"],ble=260;Ae.getSingleton().register("afterNamedExpressionAdded");Ae.getSingleton().register("afterNamedExpressionRemoved");Ae.getSingleton().register("afterSheetAdded");Ae.getSingleton().register("afterSheetRemoved");Ae.getSingleton().register("afterSheetRenamed");Ae.getSingleton().register("afterFormulasValuesUpdate");const nf=n=>n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto";var cl=new WeakMap,bO=new WeakMap,tm=new WeakMap,en=new WeakSet;class Tle extends Wt{constructor(){var e;super(...arguments),e=this,Cle(this,en),_T(this,cl,!1),_T(this,bO,!1),_T(this,tm,[["valuesUpdated",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Kt(en,e,Ble).call(e,...r)}],["namedExpressionAdded",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Kt(en,e,Wle).call(e,...r)}],["namedExpressionRemoved",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Kt(en,e,$le).call(e,...r)}],["sheetAdded",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Kt(en,e,Gle).call(e,...r)}],["sheetRenamed",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Kt(en,e,jle).call(e,...r)}],["sheetRemoved",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Kt(en,e,zle).call(e,...r)}]]),Vc(this,"staticRegister",Eo("formulas")),Vc(this,"engine",null),Vc(this,"sheetName",null),Vc(this,"indexSyncer",null),Vc(this,"rowAxisSyncer",null),Vc(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return jr}static get PLUGIN_PRIORITY(){return ble}static get SETTING_KEYS(){return[jr,...Ele]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[jr]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=sle(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){jt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,aH).call(t,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,lH).call(t,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,aH).call(t,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,lH).call(t,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,Mle).call(t,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,Ole).call(t,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,Ale).call(t,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,_le).call(t,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,uH).call(t,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,uH).call(t,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,xle).call(t,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,Ple).call(t,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,Hle).call(t,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,Fle).call(t,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,Lle).call(t,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,Dle).call(t,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,kle).call(t,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,Vle).call(t,...i)}),this.indexSyncer=new yle(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,s,o)=>{this.rowAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("beforeColumnMove",(r,i,s,o)=>{this.columnAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("afterRowMove",(r,i,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(r,i,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,Ile).call(t,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,Ule).call(t,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kt(en,t,Nle).call(t,...i)}),bd(tm,this).forEach(r=>{let[i,s]=r;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){bd(tm,this).forEach(e=>{let[t,r]=e;return this.engine.off(t,r)}),sH(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=rle(this.hot.getSettings());ile(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const r=this.hot.getSettings()[jr];if(Oe(r)&&Oe(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[jr].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){bd(tm,this).forEach(e=>{var t;let[r,i]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(r,i)}),mu(tm,this,null),sH(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(Oe(t)&&!b8(t))return jt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return jt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(r),t),r}catch(r){return jt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){nI(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${po(jr)}.switchSheet`)}getCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(t);return i!==null&&s!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var s;const o=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(r.has(o)||r.add(o))}),iH(this.engine).forEach((i,s)=>{if((t||s!==this.sheetId)&&r.has(s)){var o;i.render(),(o=i.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=s=>{var o;const{row:a,col:l,sheet:u}=(o=s?.address)!==null&&o!==void 0?o:{};return Oe(u)?`${u}:${a}x${l}`:""},i=new Set(t.map(s=>r(s)));e.forEach(s=>{var o,a;const{row:l,col:u}=(o=s.address)!==null&&o!==void 0?o:{};if(Oe(l)===!1||Oe(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const h=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,c=r(s);if(h!==void 0&&!i.has(c)){const d=iH(this.engine).get(h);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,t,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){jt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,t);return RO(r,s.type)&&(s$(r,s.dateFormat)?r=o$(r,s.dateFormat):dle(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Ale(n,e,t){const r=this.hot.propToCol(t);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},s=this.hot.getCellMeta(e,r);let o=this.engine.getCellValue(i);return s.type==="date"&&oi(o)&&(o=a$(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return n}function Nle(n,e,t){const{row:r,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=t.getTopStartCorner(),{row:u,col:h}=t.getBottomEndCorner(),c={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(c,d),{row:m,col:p}=c.start,{row:v,col:y}=c.end,C=v-m+1,R=y-p+1;for(let A=0;A<f.length;A+=1)for(let I=0;I<f[A].length;I+=1){const H=f[A][I],k=m+A%C,W=p+I%R,z=this.hot.getCellMeta(k,W);RO(H,z.type)&&(H.startsWith("'")?f[A][I]=H.slice(1):this.isFormulaCellType(k,W,this.sheetId)===!1&&(f[A][I]=fle(H,z.dateFormat)))}return f}function aH(n,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(po(jr))||mu(bO,this,hn(this.hot.getSettings().data))}function Ile(){const n=this.hot.getSourceDataArray();let e=!1;n.forEach((t,r)=>{t.forEach((i,s)=>{const o=this.hot.getCellMeta(r,s),a=o.dateFormat;RO(i,o.type)&&(e=!0,s$(i,a)?n[r][s]=o$(i,a):this.isFormulaCellType(r,s)===!1&&(n[r][s]=`'${i}`))})}),e===!0&&(mu(cl,this,!0),this.engine.setSheetContent(this.sheetId,n),mu(cl,this,!1))}function lH(n,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(po(jr)))if(this.sheetName=hle(this.engine,this.hot.getSettings()[jr].sheetName),bd(bO,this))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){mu(cl,this,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),mu(cl,this,!1)}}}function Mle(n,e,t,r){if(r!=="get"||bd(cl,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(n);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){i$(t.value)&&(t.value=cle(t.value));return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(o),l=this.hot.getCellsMeta().find(h=>h.visualRow===i&&h.visualCol===e);l===void 0&&(l={}),l.type==="date"&&oi(a)&&(a=a$(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;t.value=u}function Ole(n,e,t,r){if(r!=="get"||bd(cl,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(n),s=this.hot.propToCol(e);if(i===null||s===null||!this.isFormulaCellType(i,s)&&this.getCellType(i,s)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};t.value=this.engine.getCellSerialized(l)}function uH(n,e){if(nf(e))return;const t=[],r=[],i=this.engine.batch(()=>{n.forEach(s=>{let[o,a,,l]=s;const u=this.hot.propToCol(a),h=this.hot.toPhysicalRow(o),c=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};h!==null&&c!==null?this.syncChangeWithEngine(o,u,l):t.push([o,u,l]),r.push({address:d})})});t.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{t.forEach(o=>{let[a,l,u]=o;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function _le(n,e){if(nf(e))return;const t=[],r=[];n.forEach(i=>{let[s,o,,a]=i;const l=this.hot.propToCol(o);if(!oi(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){jt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),t.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(t),this.validateDependentCells(t,r)}function xle(n,e){let t=this.rowAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countRows()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[t,e]))return!1}function Ple(n,e){let t=this.columnAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countCols()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[t,e]))return!1}function Lle(n,e,t){return this.rowAxisSyncer.setRemovedHfIndexes(t).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function Dle(n,e,t){return this.columnAxisSyncer.setRemovedHfIndexes(t).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function Hle(n,e,t){if(nf(t))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(r)}function Fle(n,e,t){if(nf(t))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(r)}function kle(n,e,t,r){if(nf(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function Vle(n,e,t,r){if(nf(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function Ule(n,e,t){var r;mu(cl,this,!0);const i=this.hot.getSourceDataArray(t,0,t+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());mu(cl,this,!1),i.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:t+o,sheet:this.sheetId},[[a]])})})}function Ble(n){this.hot.runHooks("afterFormulasValuesUpdate",n)}function Wle(n,e){this.hot.runHooks("afterNamedExpressionAdded",n,e)}function $le(n,e){this.hot.runHooks("afterNamedExpressionRemoved",n,e)}function Gle(n){this.hot.runHooks("afterSheetAdded",n)}function jle(n,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",n,e)}function zle(n,e){this.hot.runHooks("afterSheetRemoved",n,e)}function Yle(n){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(t=1)}return this.getTranslatedPhrase(aM,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,t.col),0),i=Math.max(e.col,t.col),s=[];for(let l=r;l<=i;l+=1)s.push(l);n.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Kle(n){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(lM,t)},callback(){var t,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(t=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&t!==void 0?t:0,s=(r=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countCols()-1,n.showColumns(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const t=bt(n.getHiddenColumns(),c=>this.toPhysicalColumn(c));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,s=r.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),h=[];if(i!==s){const c=s-i+1,d=l-a+1;if(c>d){const f=u.slice(i,s+1);h.push(...f.filter(m=>t.includes(m)))}}else if(a===0&&a<i)h.push(...u.slice(0,i));else if(a===null)h.push(...u.slice(0,this.countCols()));else{const c=this.countCols()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,-1));l===d&&c>s&&h.push(...u.slice(s+1))}return D(h,c=>{e.push(this.toVisualColumn(c))}),e.length===0}}}function qle(n,e){c$(n,e),e.add(n)}function hH(n,e,t){c$(n,e),e.set(n,t)}function c$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qi(n,e){return n.get(Fl(n,e))}function nm(n,e,t){return n.set(Fl(n,e),t),t}function Fl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("beforeHideColumns");Ae.getSingleton().register("afterHideColumns");Ae.getSingleton().register("beforeUnhideColumns");Ae.getSingleton().register("afterUnhideColumns");const xT="hiddenColumns",Xle=310;var aa=new WeakMap,Do=new WeakMap,nh=new WeakSet;class Qle extends Wt{constructor(){super(...arguments),qle(this,nh),hH(this,aa,{}),hH(this,Do,null)}static get PLUGIN_KEY(){return xT}static get PLUGIN_PRIORITY(){return Xle}isEnabled(){return!!this.hot.getSettings()[xT]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[xT];mt(t)&&(nm(aa,this,t),hn(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),nm(Do,this,new BC),qi(Do,this).addLocalHook("init",()=>Fl(nh,this,rue).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,qi(Do,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Fl(nh,e,nue).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,s)=>Fl(nh,this,Jle).call(this,r,i,s)),this.addHook("modifyColWidth",(r,i)=>Fl(nh,this,Zle).call(this,r,i),2),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Fl(nh,e,tue).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Fl(nh,this,eue).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),nm(aa,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let i=t;const s=qi(Do,this).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalColumn(u));D(l,u=>{s[u]=!1}),i=hi(s,(u,h,c)=>(h&&u.push(this.hot.toVisualColumn(c)),u),[])}this.hot.runHooks("beforeUnhideColumns",t,i,r&&o)!==!1&&(r&&o&&qi(Do,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,i,r&&o,r&&i.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{D(e,o=>{qi(Do,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",t,i,r,r&&i.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideColumns(t)}getHiddenColumns(){return bt(qi(Do,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return qi(Do,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){D(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){nm(aa,this,null),nm(Do,this,null),super.destroy()}}function Zle(n,e){if(this.isHidden(e))return 0;if(qi(aa,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof n=="number"&&this.hot.hasColHeaders())return n+15}function Jle(n,e,t){if(qi(aa,this).copyPasteEnabled===!1&&this.isHidden(e)&&(t.skipColumnOnPaste=!0),this.isHidden(e-1))t.className=t.className||"",t.className.indexOf("afterHiddenColumn")===-1&&(t.className+=" afterHiddenColumn");else if(t.className){const r=t.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),t.className=r.join(" ")}}}function eue(n){if(qi(aa,this).copyPasteEnabled)return n;const e=[],t=(r,i,s,o)=>{e.push({startRow:r,endRow:i,startCol:s,endCol:o})};return D(n,r=>{let i=!0,s=0;De(r.startCol,r.endCol,o=>{this.isHidden(o)?(i||t(r.startRow,r.endRow,s,o-1),i=!0):(i&&(s=o),o===r.endCol&&t(r.startRow,r.endRow,s,o),i=!1)})}),e}function tue(n,e){if(!qi(aa,this).indicators||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenColumn"),n<this.hot.countCols()-1&&this.isHidden(n+1)&&t.push("beforeHiddenColumn"),oe(e,t)}function nue(n){n.items.push({name:dt},Yle(this),Kle(this))}function rue(){Array.isArray(qi(aa,this).columns)&&this.hideColumns(qi(aa,this).columns)}function iue(n){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(t=1)}return this.getTranslatedPhrase(uM,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,t.row),0),i=Math.max(e.row,t.row),s=[];for(let l=r;l<=i;l+=1)s.push(l);n.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function sue(n){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(hM,t)},callback(){var t,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(t=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&t!==void 0?t:0,s=(r=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countRows()-1,n.showRows(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const t=bt(n.getHiddenRows(),c=>this.toPhysicalRow(c));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,s=r.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),h=[];if(i!==s){const c=s-i+1,d=l-a+1;if(c>d){const f=u.slice(i,s+1);h.push(...f.filter(m=>t.includes(m)))}}else if(a===0&&a<i)h.push(...u.slice(0,i));else if(a===null)h.push(...u.slice(0,this.countRows()));else{const c=this.countRows()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,-1));l===d&&c>s&&h.push(...u.slice(s+1))}return D(h,c=>{e.push(this.toVisualRow(c))}),e.length===0}}}function oue(n,e){d$(n,e),e.add(n)}function cH(n,e,t){d$(n,e),e.set(n,t)}function d$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ws(n,e){return n.get(kl(n,e))}function rm(n,e,t){return n.set(kl(n,e),t),t}function kl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("beforeHideRows");Ae.getSingleton().register("afterHideRows");Ae.getSingleton().register("beforeUnhideRows");Ae.getSingleton().register("afterUnhideRows");const PT="hiddenRows",aue=320;var el=new WeakMap,Ho=new WeakMap,rh=new WeakSet;class lue extends Wt{constructor(){super(...arguments),oue(this,rh),cH(this,el,{}),cH(this,Ho,null)}static get PLUGIN_KEY(){return PT}static get PLUGIN_PRIORITY(){return aue}isEnabled(){return!!this.hot.getSettings()[PT]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[PT];mt(t)&&(rm(el,this,t),hn(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),rm(Ho,this,new BC),ws(Ho,this).addLocalHook("init",()=>kl(rh,this,mue).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ws(Ho,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return kl(rh,e,fue).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,s)=>kl(rh,this,hue).call(this,r,i,s)),this.addHook("modifyRowHeight",(r,i)=>kl(rh,this,uue).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return kl(rh,e,due).call(e,...i)}),this.addHook("modifyCopyableRange",r=>kl(rh,this,cue).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),rm(el,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let i=t;const s=ws(Ho,this).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalRow(u));D(l,u=>{s[u]=!1}),i=hi(s,(u,h,c)=>(h&&u.push(this.hot.toVisualRow(c)),u),[])}this.hot.runHooks("beforeUnhideRows",t,i,r&&o)!==!1&&(r&&o&&ws(Ho,this).setValues(s),this.hot.runHooks("afterUnhideRows",t,i,r&&o,r&&i.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{D(e,o=>{ws(Ho,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",t,i,r,r&&i.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideRows(t)}getHiddenRows(){return bt(ws(Ho,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return ws(Ho,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){D(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){rm(el,this,null),rm(Ho,this,null),super.destroy()}}function uue(n,e){return this.isHidden(e)?0:n}function hue(n,e,t){if(ws(el,this).copyPasteEnabled===!1&&this.isHidden(n)&&(t.skipRowOnPaste=!0),this.isHidden(n-1))t.className=t.className||"",t.className.indexOf("afterHiddenRow")===-1&&(t.className+=" afterHiddenRow");else if(t.className){const r=t.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),t.className=r.join(" ")}}}function cue(n){if(ws(el,this).copyPasteEnabled)return n;const e=[],t=(r,i,s,o)=>{e.push({startRow:r,endRow:i,startCol:s,endCol:o})};return D(n,r=>{let i=!0,s=0;De(r.startRow,r.endRow,o=>{this.isHidden(o)?(i||t(s,o-1,r.startCol,r.endCol),i=!0):(i&&(s=o),o===r.endRow&&t(s,o,r.startCol,r.endCol),i=!1)})}),e}function due(n,e){if(!ws(el,this).indicators||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenRow"),n<this.hot.countRows()-1&&this.isHidden(n+1)&&t.push("beforeHiddenRow"),oe(e,t)}function fue(n){n.items.push({name:dt},iue(this),sue(this))}function mue(){Array.isArray(ws(el,this).rows)&&this.hideRows(ws(el,this).rows)}function gue(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase(GI)},callback(e,t){const[{start:{col:r}}]=t;n.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function pue(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(jI)},callback(e,t){const[{start:{col:r}}]=t;n.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}function wue(n,e){f$(n,e),e.add(n)}function vue(n,e,t){f$(n,e),e.set(n,t)}function f$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SN(n,e){return n.get(Ty(n,e))}function LT(n,e,t){return n.set(Ty(n,e),t),t}function Ty(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("beforeColumnFreeze");Ae.getSingleton().register("afterColumnFreeze");Ae.getSingleton().register("beforeColumnUnfreeze");Ae.getSingleton().register("afterColumnUnfreeze");const dH="manualColumnFreeze",yue=110;var yh=new WeakMap,DT=new WeakSet;class Cue extends Wt{constructor(){super(...arguments),wue(this,DT),vue(this,yh,!1)}static get PLUGIN_KEY(){return dH}static get PLUGIN_PRIORITY(){return yue}isEnabled(){return!!this.hot.getSettings()[dH]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Ty(DT,this,Sue).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>Ty(DT,this,Rue).call(this,e,t)),super.enablePlugin())}disablePlugin(){LT(yh,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;SN(yh,this)||LT(yh,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;SN(yh,this)||LT(yh,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Sue(n){n.items.push({name:"---------"},gue(this),pue(this))}function Rue(n,e){if(SN(yh,this)){const t=this.hot.getSettings().fixedColumnsStart;if(e<t||n.some(r=>r<t))return!1}}function Tw(n,e,t){return(e=Eue(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Eue(n){var e=bue(n,"string");return typeof e=="symbol"?e:e+""}function bue(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const HT=0,fH=1,mH=2,Uc="px";let m$=class{constructor(e){Tw(this,"hot",void 0),Tw(this,"_element",null),Tw(this,"state",HT),Tw(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=mH}build(){this.state===HT&&(this._element=this.hot.rootDocument.createElement("div"),this.state=fH)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=HT}isAppended(){return this.state===mH}isBuilt(){return this.state>=fH}setPosition(e,t){oi(e)&&(this._element.style.top=e+Uc),oi(t)&&(this._element.style[this.inlineProperty]=t+Uc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){oi(e)&&(this._element.style.width=e+Uc),oi(t)&&(this._element.style.height=t+Uc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){oi(e)&&(this._element.style.marginTop=e+Uc),oi(t)&&(this._element.style[`margin${po(this.inlineProperty)}`]=t+Uc)}getOffset(){const e=this._element.style,t=`margin${po(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const Tue="ht__manualColumnMove--backlight";let Aue=class extends m${build(){super.build(),oe(this._element,Tue)}};const Nue="ht__manualColumnMove--guideline";let Iue=class extends m${build(){super.build(),oe(this._element,Nue)}};function Mue(n,e){g$(n,e),e.add(n)}function js(n,e,t){g$(n,e),e.set(n,t)}function g$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ai(n,e,t){return n.set(Vl(n,e),t),t}function Pe(n,e){return n.get(Vl(n,e))}function Vl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("beforeColumnMove");Ae.getSingleton().register("afterColumnMove");const FT="manualColumnMove",Oue=120,gH="ht__manualColumnMove",Ay="show-ui",RN="on-moving--columns",EN="after-selection--columns";var ri=new WeakMap,zl=new WeakMap,tl=new WeakMap,Nv=new WeakMap,tu=new WeakMap,ni=new WeakMap,Aw=new WeakMap,cs=new WeakMap,nd=new WeakMap,Ny=new WeakMap,xm=new WeakMap,ih=new WeakSet;class _ue extends Wt{constructor(){super(...arguments),Mue(this,ih),js(this,ri,new Aue(this.hot)),js(this,zl,new Iue(this.hot)),js(this,tl,[]),js(this,Nv,0),js(this,tu,!1),js(this,ni,{}),js(this,Aw,void 0),js(this,cs,void 0),js(this,nd,void 0),js(this,Ny,void 0),js(this,xm,void 0)}static get PLUGIN_KEY(){return FT}static get PLUGIN_PRIORITY(){return Oue}isEnabled(){return!!this.hot.getSettings()[FT]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Vl(ih,e,xue).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Vl(ih,e,Lue).call(e,...r)}),this.addHook("afterScrollVertically",()=>Vl(ih,this,Hue).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Vl(ih,e,Fue).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),oe(this.hot.rootElement,gH),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){rt(this.hot.rootElement,gH),this.unregisterEvents(),Pe(ri,this).destroy(),Pe(zl,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const r=Pe(Aw,this),i=this.isMovePossible(e,t),s=this.hot.runHooks("beforeColumnMove",e,t,r,i);if(Ai(Aw,this,void 0),s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,t);const o=i&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,r,i,o),o}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const r=this.countFinalIndex(e,t);return Ai(Aw,this,t),this.moveColumns(e,r)}isMovePossible(e,t){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>r,s=t<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isColumnOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}countFinalIndex(e,t){const r=hi(e,(i,s)=>(s<t&&(i+=1),i),0);return t-r}getColumnsWidth(e,t){const r=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=t;s+=1){const o=r.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[FT];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const r=[];return De(e,t,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Pe(cs,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Pe(cs,this)-1);const o=t.hider.offsetWidth,a=t.TBODY.offsetLeft,l=Pe(ri,this).getOffset().start,u=Pe(ri,this).getSize().width;let h=0,c=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,p=cn(this.hot.rootElement),v=m.innerWidth-Pe(nd,this)-p;c=m.innerWidth-Pe(ni,this).eventPageX-v-(r.scrollX===void 0?i:0)}else c=Pe(ni,this).eventPageX-(Pe(nd,this)-(r.scrollX===void 0?i:0));if(Pe(Ny,this)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Pe(cs,this))&&(s+=i),s+=h,Pe(cs,this)<0)Pe(xm,this)>0?Pe(ni,this).col=0:Pe(ni,this).col=e>0?e-1:e;else if(Pe(ni,this).TD.offsetWidth/2+s<=c){const m=Pe(cs,this)>=Pe(Nv,this)?Pe(Nv,this)-1:Pe(cs,this);Pe(ni,this).col=m+1,s+=Pe(ni,this).TD.offsetWidth}else Pe(ni,this).col=Pe(cs,this);let d=c,f=s;c+u+l>=o?d=o-u-l:c+l<a+h&&(d=a+h+Math.abs(l)),s>=o-1?f=o-1:f===0?f=1:r.scrollX!==void 0&&Pe(cs,this)<Pe(xm,this)&&(f-=Pe(nd,this)<=r.scrollX?Pe(nd,this):0),Pe(ri,this).setPosition(null,d),Pe(zl,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>Vl(ih,this,Pue).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>Vl(ih,this,Due).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Pe(ri,this).build(),Pe(zl,this).build()}destroy(){Pe(ri,this).destroy(),Pe(zl,this).destroy(),super.destroy()}}function xue(n,e,t,r){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),a=Ze(n.target,"sortAction");if(!o||!s||Pe(tu,this)||n.button!==0||a){Ai(tu,this,!1),Pe(tl,this).length=0,rt(this.hot.rootElement,[RN,Ay]);return}const l=Pe(zl,this).isBuilt()&&!Pe(zl,this).isAppended(),u=Pe(ri,this).isBuilt()&&!Pe(ri,this).isAppended();l&&u&&(Pe(zl,this).appendTo(i.hider),Pe(ri,this).appendTo(i.hider));const{from:h,to:c}=o,d=Math.min(h.col,c.col),f=Math.max(h.col,c.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,Ai(tu,this,!0);const m=t.firstChild?H4(n,t.firstChild).x:n.offsetX;Pe(ni,this).eventPageX=n.pageX,Ai(cs,this,e.col),Pe(ni,this).TD=t,Pe(ni,this).col=e.col,Ai(tl,this,this.prepareColumnsToMoving(d,f)),Ai(Ny,this,!!this.hot.getSettings().rowHeaders),Ai(Nv,this,this.hot.countCols()),Ai(xm,this,this.hot.getSettings().fixedColumnsStart),Ai(nd,this,Sr(this.hot.rootElement).left);const p=Pe(Ny,this)?-1:0,v=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,y=e.col<Pe(xm,this),C=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),R=Math.abs(m-(this.hot.isRtl()?t.offsetWidth:0)),A=this.getColumnsWidth(d,e.col-1)+R,I=this.getColumnsWidth(p,d-1)+(y?C:0)+A;Pe(ri,this).setPosition(v,I),Pe(ri,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-v),Pe(ri,this).setOffset(null,-A),oe(this.hot.rootElement,RN)}else rt(this.hot.rootElement,EN),Ai(tu,this,!1),Pe(tl,this).length=0}function Pue(n){Pe(tu,this)&&(Pe(ni,this).eventPageX=n.pageX,this.refreshPositions())}function Lue(n,e,t,r){!this.hot.getSelectedRangeLast()||!Pe(tu,this)||(Pe(tl,this).indexOf(e.col)>-1?rt(this.hot.rootElement,Ay):oe(this.hot.rootElement,Ay),r.row=!0,r.column=!0,r.cell=!0,Ai(cs,this,e.col),Pe(ni,this).TD=t)}function Due(){const n=Pe(ni,this).col,e=Pe(tl,this).length;if(Ai(cs,this,void 0),Ai(tu,this,!1),rt(this.hot.rootElement,[RN,Ay,EN]),this.hot.selection.isSelectedByColumnHeader()&&oe(this.hot.rootElement,EN),e<1||n===void 0)return;const t=Pe(tl,this)[0],r=this.hot.toPhysicalColumn(t),i=this.dragColumns(Pe(tl,this),n);if(Pe(tl,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(r),o=s+e-1;this.hot.selectColumns(s,o)}}function Hue(){const n=this.hot.view._wt.wtTable,e=n.getColumnHeaderHeight(0)+1,t=n.holder.scrollTop,r=e+t;Pe(ri,this).setPosition(r),Pe(ri,this).setSize(null,n.hider.offsetHeight-r)}function Fue(){this.moveBySettingsOrLoad()}function kue(n,e){p$(n,e),e.add(n)}function Ur(n,e,t){p$(n,e),e.set(n,t)}function p$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vn(n,e,t){return n.set(Js(n,e),t),t}function Ee(n,e){return n.get(Js(n,e))}function Js(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Iy="manualColumnResize",Vue=130,pH="manualColumnWidths";var za=new WeakMap,Nw=new WeakMap,zi=new WeakMap,My=new WeakMap,ia=new WeakMap,Uue=new WeakMap,Td=new WeakMap,Iw=new WeakMap,Si=new WeakMap,Wa=new WeakMap,jh=new WeakMap,Oy=new WeakMap,Pm=new WeakMap,Lm=new WeakMap,Ki=new WeakMap,Dm=new WeakMap,Fo=new WeakSet;class Bue extends Wt{static get PLUGIN_KEY(){return Iy}static get PLUGIN_PRIORITY(){return Vue}constructor(e){super(e),kue(this,Fo),Ur(this,za,null),Ur(this,Nw,null),Ur(this,zi,[]),Ur(this,My,null),Ur(this,ia,null),Ur(this,Uue,null),Ur(this,Td,null),Ur(this,Iw,null),Ur(this,Si,this.hot.rootDocument.createElement("DIV")),Ur(this,Wa,this.hot.rootDocument.createElement("DIV")),Ur(this,jh,null),Ur(this,Oy,!1),Ur(this,Pm,0),Ur(this,Lm,null),Ur(this,Ki,void 0),Ur(this,Dm,void 0),oe(Ee(Si,this),"manualColumnResizer"),oe(Ee(Wa,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Iy]}enablePlugin(){this.enabled||(Vn(Ki,this,new vu),Ee(Ki,this).addLocalHook("init",()=>Js(Fo,this,Wue).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ee(Ki,this)),this.addHook("modifyColWidth",(e,t)=>Js(Fo,this,Kue).call(this,e,t),1),this.addHook("beforeStretchingColumnWidth",(e,t)=>Js(Fo,this,que).call(this,e,t)),this.addHook("beforeColumnResize",(e,t,r)=>Js(Fo,this,Xue).call(this,e,t,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Vn(Dm,this,Ee(Ki,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",pH,Ee(Ki,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",pH,e),e.value}setManualSize(e,t){const r=Math.max(t,20),i=this.hot.toPhysicalColumn(e);return Ee(Ki,this).setValueAtIndex(i,r),r}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);Ee(Ki,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;Vn(za,this,e);const{_wt:t}=this.hot.view,r=t.wtTable.getCoords(Ee(za,this)),i=r.col;if(i<0)return;const s=Xn(Ee(za,this)),o=Ee(za,this).getBoundingClientRect(),a=i<t.getSetting("fixedColumnsStart");let l;a&&(l=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Ee(za,this),r.row,r.col)),l||(l=t.wtOverlays.topOverlay.getRelativeCellPosition(Ee(za,this),r.row,r.col)),Vn(Nw,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Vn(zi,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const h=this.hot.getSelectedRange();D(h,c=>{const d=c.getTopStartCorner().col,f=c.getBottomEndCorner().col;De(d,f,m=>{Ee(zi,this).includes(m)||Ee(zi,this).push(m)})})}Ee(zi,this).includes(Ee(Nw,this))||Vn(zi,this,[Ee(Nw,this)]),Vn(Iw,this,l.start-6),Vn(Td,this,parseInt(o.width,10)),Ee(Si,this).style.top=`${l.top}px`,Ee(Si,this).style[this.inlineDir]=`${Ee(Iw,this)+Ee(Td,this)}px`,Ee(Si,this).style.height=`${s}px`,this.hot.rootElement.appendChild(Ee(Si,this))}refreshHandlePosition(){Ee(Si,this).style[this.inlineDir]=`${Ee(Iw,this)+Ee(My,this)}px`}setupGuidePosition(){const e=parseInt(Xn(Ee(Si,this)),10),t=parseInt(Ee(Si,this).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);oe(Ee(Si,this),"active"),oe(Ee(Wa,this),"active"),Ee(Wa,this).style.top=`${t}px`,this.refreshGuidePosition(),Ee(Wa,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(Ee(Wa,this))}refreshGuidePosition(){Ee(Wa,this).style[this.inlineDir]=Ee(Si,this).style[this.inlineDir]}hideHandleAndGuide(){rt(Ee(Si,this),"active"),rt(Ee(Wa,this),"active")}checkIfColumnHeader(e){const t=kh(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(r,i)=>{const s=this.hot.runHooks("beforeColumnResize",Ee(ia,this),r,!0);s!==void 0&&Vn(ia,this,s),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,Ee(ia,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Ee(ia,this),r,!0),i&&e()};Ee(Pm,this)>=2&&(Ee(zi,this).length>1?(D(Ee(zi,this),i=>{t(i)}),e()):D(Ee(zi,this),i=>{t(i,!0)})),Vn(Pm,this,0),Vn(Lm,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",r=>Js(Fo,this,$ue).call(this,r)),this.eventManager.addEventListener(t,"mousedown",r=>Js(Fo,this,Gue).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Js(Fo,this,jue).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Js(Fo,this,zue).call(this)),this.eventManager.addEventListener(Ee(Si,this),"contextmenu",()=>Js(Fo,this,Yue).call(this))}destroy(){super.destroy()}}function Wue(){const n=this.hot.getSettings()[Iy],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((t,r)=>{Ee(Ki,this).setValueAtIndex(r,t)})},!0):Array.isArray(n)?(this.hot.batchExecution(()=>{n.forEach((t,r)=>{Ee(Ki,this).setValueAtIndex(r,t)})},!0),Vn(Dm,this,n)):n===!0&&Array.isArray(Ee(Dm,this))&&this.hot.batchExecution(()=>{Ee(Dm,this).forEach((t,r)=>{Ee(Ki,this).setValueAtIndex(r,t)})},!0)}function $ue(n){if(!lU(n.target)&&Ee(Oy,this)!==!0&&this.checkIfColumnHeader(n.target)){const e=this.getClosestTHParent(n.target);if(!e)return;const t=e.getAttribute("colspan");e&&(t===null||t==="1")&&(Ee(jh,this)||this.setupHandlePosition(e))}}function Gue(n){n.target.parentNode===this.hot.rootElement&&Ze(n.target,"manualColumnResizer")&&(this.setupHandlePosition(Ee(za,this)),this.setupGuidePosition(),Vn(jh,this,!0),Ee(Lm,this)===null&&(Vn(Lm,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Ee(Lm,this))),Vn(Pm,this,Ee(Pm,this)+1),this.startX=n.pageX,Vn(ia,this,Ee(Td,this)))}function jue(n){if(Ee(jh,this)){const e=(n.pageX-this.startX)*this.hot.getDirectionFactor();Vn(My,this,Ee(Td,this)+e),D(Ee(zi,this),t=>{Vn(ia,this,this.setManualSize(t,Ee(My,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function zue(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,r)=>{this.hot.runHooks("beforeColumnResize",Ee(ia,this),t,!1),r&&n(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Ee(ia,this),t,!1)};Ee(jh,this)&&(this.hideHandleAndGuide(),Vn(jh,this,!1),Ee(ia,this)!==Ee(Td,this)&&(Ee(zi,this).length>1?(D(Ee(zi,this),r=>{e(r)}),n()):D(Ee(zi,this),r=>{e(r,!0)})),this.setupHandlePosition(Ee(za,this)))}function Yue(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Ee(Si,this)),this.hot.rootElement.removeChild(Ee(Wa,this)),Vn(jh,this,!1),Vn(Oy,this,!0),this.hot._registerImmediate(()=>{Vn(Oy,this,!1)})}function Kue(n,e){let t=n;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=Ee(Ki,this).getValueAtIndex(r);this.hot.getSettings()[Iy]&&i&&(t=i)}return t}function que(n,e){let t=Ee(Ki,this).getValueAtIndex(e);return t===null&&(t=n),t}function Xue(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function kT(n,e,t){return(e=Que(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Que(n){var e=Zue(n,"string");return typeof e=="symbol"?e:e+""}function Zue(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const VT=0,wH=1,vH=2,Bc="px";let w$=class{constructor(e){kT(this,"hot",void 0),kT(this,"_element",null),kT(this,"state",VT),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=vH}build(){this.state===VT&&(this._element=this.hot.rootDocument.createElement("div"),this.state=wH)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=VT}isAppended(){return this.state===vH}isBuilt(){return this.state>=wH}setPosition(e,t){e!==void 0&&(this._element.style.top=e+Bc),t!==void 0&&(this._element.style.left=t+Bc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+Bc),t&&(this._element.style.height=t+Bc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+Bc),t&&(this._element.style.marginLeft=t+Bc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Jue="ht__manualRowMove--backlight";class ehe extends w${build(){super.build(),oe(this._element,Jue)}}const the="ht__manualRowMove--guideline";class nhe extends w${build(){super.build(),oe(this._element,the)}}function rhe(n,e){v$(n,e),e.add(n)}function Wc(n,e,t){v$(n,e),e.set(n,t)}function v$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _h(n,e,t){return n.set(Ul(n,e),t),t}function it(n,e){return n.get(Ul(n,e))}function Ul(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("beforeRowMove");Ae.getSingleton().register("afterRowMove");const UT="manualRowMove",ihe=140,yH="ht__manualRowMove",_y="show-ui",bN="on-moving--rows",TN="after-selection--rows";var ii=new WeakMap,Yl=new WeakMap,nl=new WeakMap,nu=new WeakMap,Ni=new WeakMap,Mw=new WeakMap,sh=new WeakSet;class she extends Wt{constructor(){super(...arguments),rhe(this,sh),Wc(this,ii,new ehe(this.hot)),Wc(this,Yl,new nhe(this.hot)),Wc(this,nl,[]),Wc(this,nu,void 0),Wc(this,Ni,{}),Wc(this,Mw,void 0)}static get PLUGIN_KEY(){return UT}static get PLUGIN_PRIORITY(){return ihe}isEnabled(){return!!this.hot.getSettings()[UT]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ul(sh,e,ohe).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ul(sh,e,lhe).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Ul(sh,this,hhe).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ul(sh,e,che).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),oe(this.hot.rootElement,yH),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){rt(this.hot.rootElement,yH),this.unregisterEvents(),it(ii,this).destroy(),it(Yl,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const r=it(Mw,this),i=this.isMovePossible(e,t),s=this.hot.runHooks("beforeRowMove",e,t,r,i);if(_h(Mw,this,void 0),s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,t);const o=i&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,r,i,o),o}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const r=this.countFinalIndex(e,t);return _h(Mw,this,t),this.moveRows(e,r)}isMovePossible(e,t){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>r,s=t<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isRowOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}countFinalIndex(e,t){const r=hi(e,(i,s)=>(s<t&&(i+=1),i),0);return t-r}getRowsHeight(e,t){const r=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=t;s++){const o=r.getRenderableFromVisualIndex(s);o!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[UT];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:r,to:i}=e,s=Math.min(r.row,i.row),o=Math.max(r.row,i.row);return De(s,o,a=>{t.push(a)}),t}refreshPositions(){const e=it(Ni,this).coords,t=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=it(Ni,this).TD,a=this.hot.rootElement,l=Sr(a),u=Dd(a),h=s.holder.scrollTop,c=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-c,f=it(Ni,this).eventPageY-d+h,m=s.hider.offsetHeight,p=s.TBODY.offsetTop,v=it(ii,this).getOffset().top,y=it(ii,this).getSize().height,C=o.offsetHeight/2,R=o.offsetHeight;let A=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const I=f>=A+C;this.isFixedRowTop(e.row)&&(A+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?it(Ni,this).row=t>0?t-1:t:I?(it(Ni,this).row=e.row+1,A+=e.row===0?R-1:R):it(Ni,this).row=e.row;let H=f,k=A;f+y+v>=m?H=m-y-v:f+v<p&&(H=p+Math.abs(v)),A>=m-1&&(k=m-1),it(ii,this).setPosition(H),it(Yl,this).setPosition(k)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>Ul(sh,this,ahe).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>Ul(sh,this,uhe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){it(ii,this).build(),it(Yl,this).build()}destroy(){it(ii,this).destroy(),it(Yl,this).destroy(),super.destroy()}}function ohe(n,e,t,r){const{wtTable:i,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!o||it(nu,this)||n.button!==0){_h(nu,this,!1),it(nl,this).length=0,rt(this.hot.rootElement,[bN,_y]);return}const l=it(Yl,this).isBuilt()&&!it(Yl,this).isAppended(),u=it(ii,this).isBuilt()&&!it(ii,this).isAppended();l&&u&&(it(Yl,this).appendTo(i.hider),it(ii,this).appendTo(i.hider));const{from:h,to:c}=a,d=Math.min(h.row,c.row),f=Math.max(h.row,c.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,_h(nu,this,!0),it(Ni,this).eventPageY=n.pageY,it(Ni,this).coords=e,it(Ni,this).TD=t,_h(nl,this,this.prepareRowsToMoving());const m=i.holder.scrollLeft+s.getRowHeaderWidth(),p=this.getRowsHeight(d,e.row-1)+n.offsetY;it(ii,this).setPosition(null,m),it(ii,this).setSize(i.hider.offsetWidth-m,this.getRowsHeight(d,f)),it(ii,this).setOffset(-p,null),oe(this.hot.rootElement,bN),this.refreshPositions()}else rt(this.hot.rootElement,TN),_h(nu,this,!1),it(nl,this).length=0}function ahe(n){it(nu,this)&&(it(Ni,this).eventPageY=n.pageY,this.refreshPositions())}function lhe(n,e,t,r){!this.hot.getSelectedRangeLast()||!it(nu,this)||(it(nl,this).indexOf(e.row)>-1?rt(this.hot.rootElement,_y):oe(this.hot.rootElement,_y),r.row=!0,r.column=!0,r.cell=!0,it(Ni,this).coords=e,it(Ni,this).TD=t)}function uhe(){const n=it(Ni,this).row,e=it(nl,this).length;if(_h(nu,this,!1),rt(this.hot.rootElement,[bN,_y,TN]),this.hot.selection.isSelectedByRowHeader()&&oe(this.hot.rootElement,TN),e<1||n===void 0)return;const t=it(nl,this)[0],r=this.hot.toPhysicalRow(t),i=this.dragRows(it(nl,this),n);if(it(nl,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(r),o=s+e-1;this.hot.selectRows(s,o)}}function hhe(){const n=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),t=n.holder.scrollLeft,r=e+t;it(ii,this).setPosition(null,r),it(ii,this).setSize(n.hider.offsetWidth-r)}function che(){this.moveBySettingsOrLoad()}function dhe(n,e){y$(n,e),e.add(n)}function Br(n,e,t){y$(n,e),e.set(n,t)}function y$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function An(n,e,t){return n.set(Ya(n,e),t),t}function ye(n,e){return n.get(Ya(n,e))}function Ya(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const xy="manualRowResize",fhe=30,CH="manualRowHeights";var Ko=new WeakMap,Ow=new WeakMap,Yi=new WeakMap,Hm=new WeakMap,Kl=new WeakMap,TO=new WeakMap,Ad=new WeakMap,_w=new WeakMap,ei=new WeakMap,zo=new WeakMap,zh=new WeakMap,Py=new WeakMap,Fm=new WeakMap,km=new WeakMap,ro=new WeakMap,Vm=new WeakMap,xl=new WeakSet;class mhe extends Wt{static get PLUGIN_KEY(){return xy}static get PLUGIN_PRIORITY(){return fhe}constructor(e){super(e),dhe(this,xl),Br(this,Ko,null),Br(this,Ow,null),Br(this,Yi,[]),Br(this,Hm,null),Br(this,Kl,null),Br(this,TO,null),Br(this,Ad,null),Br(this,_w,null),Br(this,ei,this.hot.rootDocument.createElement("DIV")),Br(this,zo,this.hot.rootDocument.createElement("DIV")),Br(this,zh,!1),Br(this,Py,!1),Br(this,Fm,0),Br(this,km,null),Br(this,ro,void 0),Br(this,Vm,void 0),oe(ye(ei,this),"manualRowResizer"),oe(ye(zo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[xy]}enablePlugin(){this.enabled||(An(ro,this,new vu),ye(ro,this).addLocalHook("init",()=>Ya(xl,this,She).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ye(ro,this)),this.addHook("modifyRowHeight",(e,t)=>Ya(xl,this,Che).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){An(Vm,this,ye(ro,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",CH,ye(ro,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",CH,e),e.value}setManualSize(e,t){const r=this.hot.toPhysicalRow(e),i=Math.max(t,xU);return ye(ro,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return ye(Hm,this)}setupHandlePosition(e){An(Ko,this,e);const{view:t}=this.hot,{_wt:r}=t,i=r.wtTable.getCoords(ye(Ko,this)),s=i.row;if(s<0)return;const o=cn(ye(Ko,this)),a=ye(Ko,this).getBoundingClientRect(),l=s<r.getSetting("fixedRowsTop"),u=s>=t.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let h;l?h=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ye(Ko,this),i.row,i.col):u&&(h=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ye(Ko,this),i.row,i.col)),h||(h=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ye(Ko,this),i.row,i.col)),An(Ow,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),An(Yi,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){const d=this.hot.getSelectedRange();D(d,f=>{const m=f.getTopStartCorner().row,p=f.getBottomStartCorner().row;De(m,p,v=>{ye(Yi,this).includes(v)||ye(Yi,this).push(v)})})}ye(Yi,this).includes(ye(Ow,this))||An(Yi,this,[ye(Ow,this)]),An(_w,this,h.top-6),An(Ad,this,parseInt(a.height,10)),ye(ei,this).style.top=`${ye(_w,this)+ye(Ad,this)}px`,ye(ei,this).style[this.inlineDir]=`${h.start}px`,ye(ei,this).style.width=`${o}px`,this.hot.rootElement.appendChild(ye(ei,this))}refreshHandlePosition(){ye(ei,this).style.top=`${ye(_w,this)+ye(Hm,this)}px`}setupGuidePosition(){const e=parseInt(cn(ye(ei,this)),10),t=parseInt(ye(ei,this).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);oe(ye(ei,this),"active"),oe(ye(zo,this),"active"),ye(zo,this).style.top=ye(ei,this).style.top,ye(zo,this).style[this.inlineDir]=`${t}px`,ye(zo,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ye(zo,this))}refreshGuidePosition(){ye(zo,this).style.top=ye(ei,this).style.top}hideHandleAndGuide(){rt(ye(ei,this),"active"),rt(ye(zo,this),"active")}checkIfRowHeader(e){const t=kh(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&ye(Kl,this)<t?t:ye(Kl,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(r,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);s!==void 0&&An(Kl,this,s),this.setManualSize(r,ye(Kl,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ye(Fm,this)>=2&&(ye(Yi,this).length>1?(D(ye(Yi,this),i=>{t(i)}),e()):D(ye(Yi,this),i=>{t(i,!0)})),An(Fm,this,0),An(km,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Ya(xl,this,ghe).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Ya(xl,this,phe).call(this,r)),this.eventManager.addEventListener(t,"mousemove",r=>Ya(xl,this,whe).call(this,r)),this.eventManager.addEventListener(t,"mouseup",()=>Ya(xl,this,vhe).call(this)),this.eventManager.addEventListener(ye(ei,this),"contextmenu",()=>Ya(xl,this,yhe).call(this))}destroy(){super.destroy()}}function ghe(n){if(!lU(n.target)&&ye(Py,this)!==!0&&this.checkIfRowHeader(n.target)){const e=this.getClosestTHParent(n.target);e&&(ye(zh,this)||this.setupHandlePosition(e))}}function phe(n){Ze(n.target,"manualRowResizer")&&(this.setupHandlePosition(ye(Ko,this)),this.setupGuidePosition(),An(zh,this,!0),ye(km,this)===null&&(An(km,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ye(km,this))),An(Fm,this,ye(Fm,this)+1),An(TO,this,n.pageY),An(Kl,this,ye(Ad,this)))}function whe(n){ye(zh,this)&&(An(Hm,this,ye(Ad,this)+(n.pageY-ye(TO,this))),D(ye(Yi,this),e=>{An(Kl,this,this.setManualSize(e,ye(Hm,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function vhe(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),r&&n(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};ye(zh,this)&&(this.hideHandleAndGuide(),An(zh,this,!1),ye(Kl,this)!==ye(Ad,this)&&(ye(Yi,this).length>1?(D(ye(Yi,this),r=>{e(r)}),n()):D(ye(Yi,this),r=>{e(r,!0)})),this.setupHandlePosition(ye(Ko,this)))}function yhe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ye(ei,this)),this.hot.rootElement.removeChild(ye(zo,this)),An(zh,this,!1),An(Py,this,!0),this.hot._registerImmediate(()=>{An(Py,this,!1)})}function Che(n,e){let t=n;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ye(ro,this).getValueAtIndex(r);this.hot.getSettings()[xy]&&i&&(t=i)}return t}function She(){const n=this.hot.getSettings()[xy],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((t,r)=>{ye(ro,this).setValueAtIndex(r,t)}):Array.isArray(n)?(n.forEach((t,r)=>{ye(ro,this).setValueAtIndex(r,t)}),An(Vm,this,n)):n===!0&&Array.isArray(ye(Vm,this))&&ye(Vm,this).forEach((t,r)=>{ye(ro,this).setValueAtIndex(r,t)})},!0)}function Rhe(n,e,t){Ehe(n,e),e.set(n,t)}function Ehe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oh(n,e,t){return(e=bhe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bhe(n){var e=The(n,"string");return typeof e=="symbol"?e:e+""}function The(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function SH(n,e){return n.get(C$(n,e))}function xw(n,e,t){return n.set(C$(n,e),t),t}function C$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ah=new WeakMap;class qo{constructor(e,t,r,i,s,o){oh(this,"row",void 0),oh(this,"col",void 0),oh(this,"rowspan",void 0),oh(this,"colspan",void 0),oh(this,"removed",!1),oh(this,"cellCoordsFactory",void 0),oh(this,"cellRangeFactory",void 0),Rhe(this,ah,null),this.row=e,this.col=t,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:r,rowspan:i,colspan:s}=e;return zt`The merged cell declared with {row: ${t}, col: ${r},\x20
      rowspan: ${i}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:r}=e;return zt`The merged cell declared at [${t}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:r}=e;return zt`The merged cell declared at [${t}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:r}=e;return zt`The merged cell declared at [${t}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:r,rowspan:i,colspan:s}=e;return t<0||r<0||i<0||s<0}static isSingleCell(e){let{rowspan:t,colspan:r}=e;return r===1&&t===1}static containsZeroSpan(e){let{rowspan:t,colspan:r}=e;return r===0||t===0}static isOutOfBounds(e,t,r){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const t=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),xw(ah,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const r=e[0]||e[1],i=t+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(t,i),l=Math.max(t,i),u=this[o],h=this[o]+this[s]-1;if(u>=t&&(this[o]+=r),r>0)t<=h&&t>u&&(this[s]+=r);else if(r<0){if(a<=u&&l>=h)return this.removed=!0,xw(ah,this,null),!1;if(u>=a&&u<=l){const c=l-u+1,d=Math.abs(r)-c;this[o]-=d+r,this[s]-=c}else if(u<=a&&h>=l)this[s]+=r;else if(u<=a&&h>=a&&h<l){const c=h-a+1;this[s]-=c}}return xw(ah,this,null),!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return SH(ah,this)||xw(ah,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),SH(ah,this)}}function Ahe(n,e){Nhe(n,e),e.add(n)}function Nhe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pw(n,e,t){return(e=Ihe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ihe(n){var e=Mhe(n,"string");return typeof e=="symbol"?e:e+""}function Mhe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function lh(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Pl=new WeakSet;class Ly{constructor(e){Ahe(this,Pl),Pw(this,"plugin",void 0),Pw(this,"mergedCells",[]),Pw(this,"mergedCellsMatrix",new Map),Pw(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:r}=e;return zt`The merged cell declared at [${t}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(t))!==null&&r!==void 0?r:!1}getByRange(e){let t=!1;return D(this.mergedCells,r=>r.row<=e.from.row&&r.row+r.rowspan-1>=e.to.row&&r.col<=e.from.col&&r.col+r.colspan-1>=e.to.col?(t=r,t):!0),t}filterOverlappingMergeCells(e){const t=new Set;return this.mergedCells.forEach(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i;for(let u=s;u<s+l;u++)for(let h=o;h<o+a;h++)t.add(`r${u},c${h}`)}),e.filter(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i,u=new Set;let h=!1;for(let c=s;c<s+l;c++){for(let d=o;d<o+a;d++){const f=`r${c},c${d}`;if(t.has(f)){jt(Ly.IS_OVERLAPPING_WARNING(i)),h=!0;break}u.add(f)}if(h)break}return h||t.add(...u),!h})}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=r;l<=s;l++)for(let u=i;u<=o;u++){const h=this.get(l,u);h&&(t||!t&&h.row===l&&h.col===u)&&a.push(h)}return a}add(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,s=e.rowspan,o=e.colspan,a=new qo(r,i,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=t?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),lh(Pl,this,RH).call(this,a),a):(jt(Ly.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,t){const r=this.get(e,t),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),lh(Pl,this,Ohe).call(this,r),r):!1}clear(){D(this.mergedCells,e=>{let{row:t,col:r,rowspan:i,colspan:s}=e;De(t,t+i,o=>{De(r,r+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(t))return!0;return!1}isFirstRenderableMergedCell(e,t){const r=this.get(e,t);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===t}getFirstRenderableCoords(e,t){const r=this.get(e,t);if(!r||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,s)}getStartMostColumnIndex(e,t){const r=lh(Pl,this,Lw).call(this,e,"col",-1);let i=t;for(let s=0;s<r.length;s++)if(r[s]<=t){i=r[s];break}return i}getEndMostColumnIndex(e,t){const r=lh(Pl,this,Lw).call(this,e,"col",1);let i=t;for(let s=0;s<r.length;s++)if(r[s]>=t){i=r[s];break}return i}getTopMostRowIndex(e,t){const r=lh(Pl,this,Lw).call(this,e,"row",-1);let i=t;for(let s=0;s<r.length;s++)if(r[s]<=t){i=r[s];break}return i}getBottomMostRowIndex(e,t){const r=lh(Pl,this,Lw).call(this,e,"row",1);let i=t;for(let s=0;s<r.length;s++)if(r[s]>=t){i=r[s];break}return i}shiftCollections(e,t,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const s=[];this.mergedCells.forEach(o=>{o.shift(i,t),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{lh(Pl,this,RH).call(this,o)})}}function Lw(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=t===1?n.getTopStartCorner():n.getBottomEndCorner(),s=t===1?n.getBottomEndCorner():n.getTopStartCorner();for(let o=i.row;t===1?o<=s.row:o>=s.row;o+=t)for(let a=i.col;t===1?a<=s.col:a>=s.col;a+=t){const l=e==="row"?o:a,u=this.get(o,a);let h=l;u&&(h=t===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(h)}return Array.from(new Set(Array.from(r.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function RH(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(t,n)}function Ohe(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.get(e).delete(t)}function BT(n,e,t){return(e=_he(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _he(n){var e=xhe(n,"string");return typeof e=="symbol"?e:e+""}function xhe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Phe{constructor(e){BT(this,"plugin",void 0),BT(this,"mergedCellsCollection",void 0),BT(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let r=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?r="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?r="up":t[1]===e[1]&&t[2]===e[2]?r="right":r="left",r}snapDragArea(e,t,r,i){const s=t.slice(0),o=this.getAutofillSize(e,t,r),[a,l,u,h]=e,d=["up","down"].indexOf(r)>-1?u-a+1:h-l+1,f=Math.floor(o/d)*d,m=o-f,p=this.getFarthestCollection(e,t,r,i);if(p){if(r==="down"){const v=p.row+p.rowspan-a-m;s[2]+v>=this.plugin.hot.countRows()?s[2]-=m:s[2]+=m?v:0}else if(r==="right"){const v=p.col+p.colspan-l-m;s[3]+v>=this.plugin.hot.countCols()?s[3]-=m:s[3]+=m?v:0}else if(r==="up"){const v=u-m-p.row+1;s[0]+v<0?s[0]+=m:s[0]-=m?v:0}else if(r==="left"){const v=h-m-p.col+1;s[1]+v<0?s[1]+=m:s[1]-=m?v:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:o,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),er(this.currentFillData,e)}getAutofillSize(e,t,r){const[i,s,o,a]=e,[l,u,h,c]=t;switch(r){case"up":return i-l;case"down":return h-o;case"left":return s-u;case"right":return c-a;default:return null}}getDragArea(e,t,r){const[i,s,o,a]=e,[l,u,h,c]=t;switch(r){case"up":return[l,u,i-1,a];case"down":return[o+1,s,h,a];case"left":return[l,u,o,s-1];case"right":return[i,a+1,h,c];default:return null}}getFarthestCollection(e,t,r,i){const[s,o,a,l]=e,u=["up","down"].indexOf(r)>-1,h=u?a:l,c=u?s:o,d=this.getAutofillSize(e,t,r),f=u?a-s+1:l-o+1,m=Math.floor(d/f)*f,p=d-m;let v=null,y=null,C=null;switch(r){case"up":v="includesVertically",C=h-p+1;break;case"left":v="includesHorizontally",C=h-p+1;break;case"down":v="includesVertically",C=c+p-1;break;case"right":v="includesHorizontally",C=c+p-1;break}return D(i,R=>{R[v](C)&&R.isFarther(y,r)&&(y=R)}),y}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(u,h)=>{switch(i){case"up":return u.row-h>=t.from.row;case"down":return u.row+u.rowspan-1+h<=t.to.row;case"left":return u.col-h>=t.from.column;case"right":return u.col+u.colspan-1+h<=t.to.column;default:return null}};let o=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],o=l*this.currentFillData.cycleLength,s(a,o))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},r={min:null,max:null};return D(e,i=>{const s=i[0],o=this.plugin.hot.propToCol(i[1]);(t.min===null||s<t.min)&&(t.min=s),(t.max===null||s>t.max)&&(t.max=s),(r.min===null||o<r.min)&&(r.min=o),(r.max===null||o>r.max)&&(r.max=o)}),{from:{row:t.min,column:r.min},to:{row:t.max,column:r.max}}}dragAreaOverlapsCollections(e,t,r){const i=this.getDragArea(e,t,r),[s,o,a,l]=i,u=this.plugin.hot._createCellCoords(s,o),h=this.plugin.hot._createCellCoords(a,l),c=this.plugin.hot._createCellRange(u,u,h);return this.mergedCellsCollection.getWithinRange(c,!0).length>0}}function WT(n,e,t){return(e=Lhe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Lhe(n){var e=Dhe(n,"string");return typeof e=="symbol"?e:e+""}function Dhe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Hhe{constructor(e){WT(this,"plugin",void 0),WT(this,"hot",void 0),WT(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,r,i){const s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const h=this.plugin.mergedCellsCollection.get(e,t);if(!h)return;const c=h.getLastRow(),d=h.getLastColumn();if(s<=h.row&&o<=h.col&&a>=c&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(h,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const r=[];if(!t||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<r.length;i+=1){const s=[];for(let o=0;o<t.length;o+=1)s[o]=t[o].includes(r[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function Fhe(n){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(YI)}return this.getTranslatedPhrase(zI)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;n.toggleMerge(e),this.selectCell(t.row,t.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?qo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Um(n,e,t){return(e=khe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function khe(n){var e=Vhe(n,"string");return typeof e=="symbol"?e:e+""}function Vhe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class EH{constructor(e){Um(this,"data",void 0),Um(this,"next",null),Um(this,"prev",null),this.data=e}}class Dw{constructor(){Um(this,"first",null),Um(this,"last",null)}push(e){const t=new EH(e);if(this.first===null)this.first=t,this.last=t;else{const r=this.last;this.last=t,t.prev=r,r.next=t}return t}unshift(e){const t=new EH(e);if(this.first===null)this.first=t,this.last=t;else{const r=this.first;this.first=t,t.next=r,r.prev=t}}inorder(e){let t=this.first;for(;t;){const r=e(t);if(t===this.last||r===!0)break;t=t.next}}remove(e){if(this.first===null)return!1;let t=this.first,r,i;for(;t;){if(t.data===e)return r=t.next,i=t.prev,r&&(r.prev=i),i&&(i.next=r),t===this.first&&(this.first=r),t===this.last&&(this.last=i),!0;t=t.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,t=this.first,r;for(;e;)r=e.next,e.next=t,t.prev=e,t=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=t,this.last=r}}function Uhe(n,e){S$(n,e),e.add(n)}function uh(n,e,t){S$(n,e),e.set(n,t)}function S$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bt(n,e){return n.get(Dy(n,e))}function Vi(n,e,t){return n.set(Dy(n,e),t),t}function Dy(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ko=new WeakMap,Vo=new WeakMap,Uo=new WeakMap,Bo=new WeakMap,AN=new WeakMap,Hw=new WeakMap,Fw=new WeakMap,$T=new WeakSet;class Bhe{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:r,columnIndexMapper:i}=e;Uhe(this,$T),uh(this,ko,new Dw),uh(this,Vo,new Dw),uh(this,Uo,null),uh(this,Bo,null),uh(this,AN,null),uh(this,Hw,null),uh(this,Fw,null),Vi(AN,this,t),Vi(Hw,this,r),Vi(Fw,this,i)}getCurrentVerticalNode(){return Bt(Bo,this).data}getFirstVerticalNode(){return Bt(Vo,this).first.data}getNextVerticalNode(){return Bt(Bo,this).next.data}getPrevVerticalNode(){return Bt(Bo,this).prev.data}getCurrentHorizontalNode(){return Bt(Uo,this).data}getFirstHorizontalNode(){return Bt(ko,this).first.data}getNextHorizontalNode(){return Bt(Uo,this).next.data}getPrevHorizontalNode(){return Bt(Uo,this).prev.data}setPrevNodeAsActive(){Vi(Bo,this,Bt(Bo,this).prev),Vi(Uo,this,Bt(Uo,this).prev)}setNextNodeAsActive(){Vi(Bo,this,Bt(Bo,this).next),Vi(Uo,this,Bt(Uo,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Vi(ko,this,new Dw);for(let o=t.row;o<=r.row;o++)if(!Bt(Hw,this).isHidden(o))for(let a=t.col;a<=r.col;a++){if(Bt(Fw,this).isHidden(a))continue;const l=Dy($T,this,bH).call(this,e,Bt(ko,this),i,o,a);l&&Vi(Uo,this,l)}Bt(ko,this).first&&(Bt(ko,this).first.prev=Bt(ko,this).last,Bt(ko,this).last.next=Bt(ko,this).first);const s=new WeakSet;Vi(Vo,this,new Dw);for(let o=t.col;o<=r.col;o++)if(!Bt(Fw,this).isHidden(o))for(let a=t.row;a<=r.row;a++){if(Bt(Hw,this).isHidden(a))continue;const l=Dy($T,this,bH).call(this,e,Bt(Vo,this),s,a,o);l&&Vi(Bo,this,l)}Bt(Vo,this).first&&(Bt(Vo,this).first.prev=Bt(Vo,this).last,Bt(Vo,this).last.next=Bt(Vo,this).first)}setActiveNode(e,t){return Bt(ko,this).inorder(r=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=r.data;if(e>=i&&e<=s&&t>=o&&t<=a)return Vi(Uo,this,r),!1}),Bt(Vo,this).inorder(r=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=r.data;if(e>=i&&e<=s&&t>=o&&t<=a)return Vi(Bo,this,r),!1}),this}}function bH(n,e,t,r,i){const s=n.getTopStartCorner(),o=n.getBottomEndCorner(),a=n.highlight.clone().normalize(),l=Bt(AN,this).call(this,r,i);if(l&&t.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(t.add(l),l.row<s.row||l.row+l.rowspan-1>o.row||l.col<s.col||l.col+l.colspan-1>o.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const h=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?h:null}function Whe(n){const{hot:e}=n,{rowIndexMapper:t,columnIndexMapper:r}=e;function i(){}function s(o,a,l){const u=n.mergedCellsCollection.get(a,l);if(!mt(u)){o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="";return}const{row:h,col:c,colspan:d,rowspan:f}=u,[m,p]=n.translateMergedCellToRenderable(h,f,c,d),v=t.getRenderableFromVisualIndex(a),y=r.getRenderableFromVisualIndex(l),C=m-v+1,R=p-y+1,A=t.getNearestNotHiddenIndex(h,1),I=r.getNearestNotHiddenIndex(c,1),H=Math.min(f,C),k=Math.min(d,R);A===a&&I===l?(o.setAttribute("rowspan",H),o.setAttribute("colspan",k)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}return{before:i,after:s}}function $he(n,e){R$(n,e),e.add(n)}function kw(n,e,t){R$(n,e),e.set(n,t)}function R$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GT(n,e,t){return(e=Ghe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ghe(n){var e=jhe(n,"string");return typeof e=="symbol"?e:e+""}function jhe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function yg(n,e,t){return n.set($t(n,e),t),t}function on(n,e){return n.get($t(n,e))}function $t(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("beforeMergeCells");Ae.getSingleton().register("afterMergeCells");Ae.getSingleton().register("beforeUnmergeCells");Ae.getSingleton().register("afterUnmergeCells");const Bm="mergeCells",zhe=150,TH=Bm;var Cs=new WeakMap,Ss=new WeakMap,sa=new WeakMap,AH=new WeakMap,Yt=new WeakSet;class Yhe extends Wt{constructor(){super(...arguments),$he(this,Yt),GT(this,"mergedCellsCollection",null),GT(this,"autofillCalculations",null),GT(this,"selectionCalculations",null),kw(this,Cs,null),kw(this,Ss,{row:0,col:0}),kw(this,sa,new Bhe({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),kw(this,AH,Whe(this))}static get PLUGIN_KEY(){return Bm}static get PLUGIN_PRIORITY(){return zhe}isEnabled(){return!!this.hot.getSettings()[Bm]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Ly(this),this.autofillCalculations=new Phe(this),this.selectionCalculations=new Hhe(this),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,Khe).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,Xhe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,Qhe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,Zhe).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,Jhe).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,NH).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,NH).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,nce).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,rce).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,ice).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,ece).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,qhe).call(e,...r)}),this.addHook("afterRenderer",function(){return on(AH,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,tce).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,sce).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,oce).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,ace).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,lce).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,uce).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,hce).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,cce).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,dce).call(e,...r)}),this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,fce).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,mce).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,gce).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,pce).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,wce).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return $t(Yt,e,vce).call(e,...r)}),this.addHook("beforeUndoStackChange",(t,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Bm];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!fU())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:s}=r;for(let o=i+1;o<i+s;o++)t.push(o)}),t=[...new Set(t)],t.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>s?.name==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(i);o&&(o.style.background=rg(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=rg(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?qo.containsNegativeValues(e)?(jt(qo.NEGATIVE_VALUES_WARNING(e)),!1):qo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(jt(qo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):qo.isSingleCell(e)?(jt(qo.IS_SINGLE_CELL(e)),!1):qo.containsZeroSpan(e)?(jt(qo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(e){if(!Array.isArray(e))return;const t=e.filter(s=>this.validateSetting(s)),r=this.mergedCellsCollection.filterOverlappingMergeCells(t),i=[];r.forEach(s=>{const{row:o,col:a,rowspan:l,colspan:u}=s,h=this.hot._createCellCoords(o,a),c=this.hot._createCellCoords(o+l-1,a+u-1),d=this.hot._createCellRange(h,h,c);this.mergeRange(d,!0,!0);for(let f=o;f<o+l;f++)for(let m=a;m<a+u;m++)(f!==o||m!==a)&&i.push([f,m,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},a=[];let l=null;return this.canMergeRange(o,t)?(this.hot.runHooks("beforeMergeCells",e,t),De(0,o.rowspan-1,h=>{De(0,o.colspan-1,c=>{let d=null;a[h]||(a[h]=[]),h===0&&c===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+h,o.col+c,"hidden",!0),a[h][c]=d})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,t)?(r?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,t),l):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,t),D(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),De(0,i.rowspan-1,s=>{De(0,i.colspan-1,o=>{this.hot.removeCellMeta(i.row+s,i.col+o,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+o,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,r,i){const s=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,t,r,i){const s=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:TH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(TH)}modifyViewportRowStart(e,t){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(i,s);if(mt(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(i,s);if(mt(o)){const a=o.row+o.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,t);return}}}}modifyViewportColumnStart(e,t){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(s,i);if(mt(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(s,i);if(mt(o)){const a=o.col+o.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,r,i){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;t===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+t-1,-1),i===0?l=o.getNearestNotHiddenIndex(r,1):l=o.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?s.getRenderableFromVisualIndex(a):e,h=r>=0?o.getRenderableFromVisualIndex(l):r;return[u,h]}}function Khe(){this.generateFromSettings(this.hot.getSettings()[Bm]),this.hot.render()}function qhe(n){if(n){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),r=t.getTopStartCorner(),i=t.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(r.row===e[s].row&&r.col===e[s].col&&i.row===e[s].row+e[s].rowspan-1&&i.col===e[s].col+e[s].colspan-1)return!1}return n}function Xhe(n){on(Ss,this).row=n.row,on(Ss,this).col=n.col}function Qhe(n){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;on(Cs,this)&&(i.getRenderableFromVisualIndex(on(Cs,this).row)!==null&&(t.row=on(Cs,this).row),r.getRenderableFromVisualIndex(on(Cs,this).col)!==null&&(t.col=on(Cs,this).col),yg(Cs,this,null));const s=this.mergedCellsCollection.get(t.row,t.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(n.col<0){const h=t.col>=o&&t.col<=a?o-1:a,c=r.getNearestNotHiddenIndex(h,-1);c===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(c,t.col)-1,1)}else if(n.col>0){const h=t.col>=o&&t.col<=a?a+1:o,c=r.getNearestNotHiddenIndex(h,1);c===null?n.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,c)-1,1)}const l=s.row,u=s.row+s.rowspan-1;if(n.row<0){const h=t.row>=l&&t.row<=u?l-1:u,c=i.getNearestNotHiddenIndex(h,-1);c===null?n.row=-this.hot.view.countRenderableRowsInRange(0,t.row):n.row=-Math.max(this.hot.view.countRenderableRowsInRange(c,t.row)-1,1)}else if(n.row>0){const h=t.row>=l&&t.row<=u?u+1:l,c=i.getNearestNotHiddenIndex(h,1);c===null?n.row=this.hot.view.countRenderableRowsInRange(t.row,this.hot.countRows()):n.row=Math.max(this.hot.view.countRenderableRowsInRange(t.row,c)-1,1)}}function Zhe(n){const e=this.hot.getSelectedRangeLast(),t=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot,o=(a,l)=>{t.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(n.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+n.col;o(r.row,a),e.getHorizontalDirection()==="E-W"&&t.getHorizontalDirection()==="E-W"&&(a=t.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(n.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+n.col;o(r.row,a),e.getHorizontalDirection()==="W-E"&&t.getHorizontalDirection()==="W-E"&&(a=t.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(n.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(n.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+n.row;o(a,r.col),e.getVerticalDirection()==="S-N"&&t.getVerticalDirection()==="S-N"&&(a=t.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(n.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(n.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+n.row;o(a,r.col),e.getVerticalDirection()==="N-S"&&t.getVerticalDirection()==="N-S"&&(a=t.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(n.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function Jhe(){const n=this.hot.getSelectedRangeLast(),{highlight:e}=n;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){yg(Cs,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const t=this.mergedCellsCollection.get(e.row,e.col);yg(Cs,this,e.clone()),t&&e.assign(t)}function ece(n,e){if(n<0||e<0)return;const t=this.mergedCellsCollection.get(n,e);if(!t)return;const{row:r,col:i,colspan:s,rowspan:o}=t;return[r,i,r+o-1,i+s-1]}function tce(n){n.items.push({name:"---------"},Fhe(this))}function NH(){yg(Cs,this,null)}function nce(){if(on(Cs,this).isCell())return;const n=this.hot.getSelectedRangeLast(),e=n.getVerticalDirection(),t=n.getHorizontalDirection(),r=on(Cs,this).clone().normalize();on(sa,this).setActiveNode(r.row,r.col),on(Ss,this).row>0||on(Ss,this).col>0?on(sa,this).setPrevNodeAsActive():(t==="E-W"&&on(Ss,this).col<0||e==="S-N"&&on(Ss,this).row<0)&&on(sa,this).setNextNodeAsActive()}function rce(n,e){const t=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let s=null,o=null;if(on(Ss,this).col<0){const{rowEnd:a,colEnd:l}=on(sa,this).getPrevHorizontalNode();o=r.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(on(Ss,this).col>0){const{rowStart:a,colStart:l}=on(sa,this).getNextHorizontalNode();o=r.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}else if(on(Ss,this).row<0){const{rowEnd:a,colEnd:l}=on(sa,this).getPrevVerticalNode();o=r.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(on(Ss,this).row>0){const{rowStart:a,colStart:l}=on(sa,this).getNextVerticalNode();o=r.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}if(s!==null||o!==null){const a=this.hot._createCellCoords(s,o),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();n=a.row,e=a.col,l?t.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):t.highlight.assign(a),u.clear(),u.add(a).commit()}on(sa,this).setActiveNode(n,e),yg(Ss,this,{row:0,col:0})}function ice(){this.hot.getSelectedRangeLast().isHeader()||on(sa,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function sce(n,e,t){const r=this.mergedCellsCollection.get(n,e);r&&(r.row!==n||r.col!==e?t.copyable=!1:(t.rowspan=r.rowspan,t.colspan=r.colspan))}function oce(n){const e=this.hot.countCols();this.modifyViewportRowStart(n,e),this.modifyViewportRowEnd(n,e)}function ace(n){const e=this.hot.countRows();this.modifyViewportColumnStart(n,e),this.modifyViewportColumnEnd(n,e)}function lce(n,e){this.autofillCalculations.correctSelectionAreaSize(e);const t=this.autofillCalculations.getDirection(e,n);let r=n;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,t))return r=e,r;const i=this.hot._createCellCoords(e[0],e[1]),s=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,s),a=this.mergedCellsCollection.getWithinRange(o);return a.length===0||(r=this.autofillCalculations.snapDragArea(e,r,t,a)),r}function uce(n,e){this.mergedCellsCollection.shiftCollections("right",n,e)}function hce(n,e){this.mergedCellsCollection.shiftCollections("left",n,e)}function cce(n,e,t){t!=="auto"&&this.mergedCellsCollection.shiftCollections("down",n,e)}function dce(n,e){this.mergedCellsCollection.shiftCollections("up",n,e)}function fce(n,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(n)}function mce(n,e){if(e&&e==="area"){const t=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(t);D(r,i=>{t.getBottomEndCorner().row===i.getLastRow()&&t.getBottomEndCorner().col===i.getLastColumn()&&(n[2]=i.row,n[3]=i.col)})}}function gce(n,e,t,r){if(t)return this.selectionCalculations.getSelectedMergedCellClassName(n,e,t,r)}function pce(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function wce(n,e,t,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(i);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(o,o,a))}function vce(n,e,t){if(this.hot.getSettings().rowHeaders||t==="bottom"||t==="bottom_inline_start_corner")return n;let r,i;if(t==="master")r=this.hot.view.getFirstRenderedVisibleColumn(),i=this.hot.view.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(t);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return n;const o=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(o,o,a),u=this.mergedCellsCollection.getWithinRange(l),h=u.reduce((d,f)=>{let{rowspan:m}=f;return Math.max(d,m)},1);let c=0;return u.length>1&&u[0].rowspan<h&&(c=h-u[0].rowspan),u.forEach(d=>{var f;let{rowspan:m}=d,p=0;t==="top"||t==="top_inline_start_corner"?p=Math.min(h,this.hot.view.countNotHiddenFixedRowsTop()-e):p=m-c,n=Math.max((f=n)!==null&&f!==void 0?f:0,$t(Yt,this,yce).call(this,e,p))}),n}function yce(n,e){const t=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),r=this.hot.getPlugin("autoRowSize");let i=0;for(let o=n;o<n+e;o++)if(!this.hot.rowIndexMapper.isHidden(o)){var s;i+=(s=r?.getRowHeight(o))!==null&&s!==void 0?s:t}return i}function Cce(n,e){return function(t,r){const[,...i]=t,[,...s]=r;return(function o(a){const l=n[a],u=e[a],h=i[a],c=s[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:JB(u.type))(l,u,d)(h,c);if(m===ha){const p=a+1;if(typeof e[p]<"u")return o(p)}return m})(0)}}function IH(){jt(zt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const E$="sort";function Sce(n,e,t){const r=[];return t===!1||n.isColumnSorted(e)&&n.getNumberOfSortedColumns()>1&&r.push(`${E$}-${n.getIndexOfColumnInSortQueue(e)+1}`),r}function Rce(n){const e=n.className.split(" "),t=new RegExp(`^${E$}-[0-9]{1,2}$`);return e.filter(r=>t.test(r))}function Ece(n,e,t){return(e=bce(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bce(n){var e=Tce(n,"string");return typeof e=="symbol"?e:e+""}function Tce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Hy="multiColumnSorting",Ace=170,jT="columnSorting",MH=Hy;ZB(Hy,Cce);class Nce extends lW{constructor(){super(...arguments),Ece(this,"pluginKey",Hy)}static get PLUGIN_KEY(){return Hy}static get PLUGIN_PRIORITY(){return Ace}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[jT]&&(IH(),this.hot.getPlugin(jT).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,vy)),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:yu,position:"before",group:MH})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(MH)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),rt(e,Rce(e)),this.enabled!==!1&&oe(e,Sce(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[jT]&&IH(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){cO(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,vy))):this.sort(this.getColumnNextConfig(t.col)))}}function OH(n,e,t){return(e=Ice(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ice(n){var e=Mce(n,"string");return typeof e=="symbol"?e:e+""}function Mce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Oce="multipleSelectionHandles",_ce=160;class xce extends Wt{constructor(){super(...arguments),OH(this,"dragged",[]),OH(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Oce}static get PLUGIN_PRIORITY(){return _ce}isEnabled(){return Zl()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",i=>{let s;if(Ze(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(Ze(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",i=>{if(Ze(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Ze(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",i=>{const{rootDocument:s}=this.hot;let o,a,l,u,h,c;if(e.dragged.length===0)return;const d=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(o=e.hot.getCoords(d),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),h=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(o),c=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,h,e.dragged[0]),c.start!==null&&e.hot.selection.setRangeStart(c.start),e.hot.selection.setRangeEnd(c.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,t,r,i,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let h={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?h={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:h={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,o.col)};break;case"SE-NW":s==="bottom"&&(h={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,o.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?h={start:t,end:l}:h.end=t;break;case"NW-SE":s==="top"?h={start:t,end:a}:h.end=t;break;case"SE-NW":s==="top"?h={start:t,end:o}:h.end=t;break;case"SW-NE":s==="top"?h={start:t,end:u}:h.end=t;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?h={start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(l.row,t.col)}:h={start:this.hot._createCellCoords(o.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":s==="top"?h={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:h={start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(o.row,t.col)};break;case"SE-NW":s==="bottom"?h={start:this.hot._createCellCoords(t.row,u.col),end:this.hot._createCellCoords(o.row,t.col)}:s==="top"&&(h={start:l,end:t});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(h.end=t);break;case"SE-NW":s==="top"?h.end=t:h={start:t,end:o};break}break}return h}isDragged(){return this.dragged.length>0}}function NN(){let{label:n="",colspan:e=1,origColspan:t=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:n,colspan:e,origColspan:t,collapsible:r,isCollapsed:s,crossHiddenColumns:i,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:u}}function b$(){return{label:"",isPlaceholder:!0}}function Pce(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;D(n,i=>{const s=[];let o=0;t.push(s),D(i,a=>{const l=NN();if(mt(a)){const{label:h,colspan:c,headerClassName:d}=a;l.label=Kn(h),typeof c=="number"&&c>1&&(l.colspan=c,l.origColspan=c),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Kn(a);o+=l.origColspan;let u=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,u=!0),s.push(l),l.colspan>1)for(let h=0;h<l.colspan-1;h++)s.push(b$());return!u})});const r=Math.max(...bt(t,i=>i.length));return D(t,i=>{if(i.length<r){const s=bt(new Array(r-i.length),()=>NN());i.splice(i.length,0,...s)}}),t}function zT(n,e,t){Lce(n,e),e.set(n,t)}function Lce(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zs(n,e){return n.get(T$(n,e))}function im(n,e,t){return n.set(T$(n,e),t),t}function T$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const _H=["label","collapsible"];var Fa=new WeakMap,hh=new WeakMap,YT=new WeakMap;class Dce{constructor(){zT(this,Fa,[]),zT(this,hh,0),zT(this,YT,1/0)}setColumnsLimit(e){im(YT,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];im(Fa,this,Pce(e,zs(YT,this))),im(hh,this,zs(Fa,this).length)}getData(){return zs(Fa,this)}mergeWith(e){D(e,t=>{let{row:r,col:i,...s}=t;const o=this.getHeaderSettings(r,i);o!==null&&er(o,s,_H)})}map(e){D(zs(Fa,this),t=>{D(t,r=>{const i=e({...r});mt(i)&&er(r,i,_H)})})}getHeaderSettings(e,t){var r;if(e>=zs(hh,this)||e<0)return null;const i=zs(Fa,this)[e];return Array.isArray(i)===!1||t>=i.length?null:(r=i[t])!==null&&r!==void 0?r:null}getHeadersSettings(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=zs(hh,this)||e<0)return i;const s=zs(Fa,this)[e];let o=0;for(let a=t;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),o===r)break;if(o>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return zs(hh,this)}getColumnsCount(){return zs(hh,this)>0?zs(Fa,this)[0].length:0}clear(){im(Fa,this,[]),im(hh,this,0)}}function KT(n,e,t){return(e=Hce(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Hce(n){var e=Fce(n,"string");return typeof e=="symbol"?e:e+""}function Fce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const A$="DF-pre-order";function N$(n,e){let t=n.call(e,this);for(let r=0;r<this.childs.length;r++){if(t===!1)return!1;t=N$.call(this.childs[r],n,e)}return t}const kce="DF-post-order";function I$(n,e){for(let t=0;t<this.childs.length;t++)if(I$.call(this.childs[t],n,e)===!1)return!1;return n.call(e,this)}const M$="BF";function Vce(n,e){const t=[this];function r(){if(t.length===0)return;const i=t.shift();t.push(...i.childs),n.call(e,i)!==!1&&r()}r()}const Uce=M$,xH=new Map([[A$,N$],[kce,I$],[M$,Vce]]);class Fy{constructor(e){KT(this,"data",{}),KT(this,"parent",null),KT(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new Fy({...e.data});for(let r=0;r<e.childs.length;r++)t.addChild(this.cloneTree(e.childs[r]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Uce;if(!xH.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);xH.get(t).call(this,e,this)}walkUp(e){const t=this,r=i=>{e.call(t,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function qT(n,e,t){Bce(n,e),e.set(n,t)}function Bce(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jr(n,e){return n.get(O$(n,e))}function Wce(n,e,t){return n.set(O$(n,e),t),t}function O$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var $c=new WeakMap,ch=new WeakMap,Gc=new WeakMap;class $ce{constructor(e){qT(this,$c,new Map),qT(this,ch,new Map),qT(this,Gc,null),Wce(Gc,this,e)}getRoots(){return Array.from(Jr($c,this).values())}getRootByColumn(e){let t;return Jr(ch,this).has(e)&&(t=Jr($c,this).get(Jr(ch,this).get(e))),t}getNode(e,t){const r=this.getRootByColumn(t);if(!r)return;const i=t-Jr(ch,this).get(t);let s=0,o;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=s&&i<=s+l-1)return o=a,o.data.isRoot=t===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;Jr(ch,this).clear(),D(Jr($c,this),t=>{let[,{data:{colspan:r}}]=t;for(let i=e;i<e+r;i++)Jr(ch,this).set(i,e);e+=r})}buildTree(){this.clear();const e=Jr(Gc,this).getColumnsCount();let t=0;for(;t<e;){const r=Jr(Gc,this).getHeaderSettings(0,t),i=new Fy;Jr($c,this).set(t,i),this.buildLeaves(i,t,0,r.origColspan),t+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=Jr(Gc,this).getHeadersSettings(r,t,i);r+=1,D(s,o=>{const a={...o,headerLevel:r-1,columnIndex:t};let l;r===1?(e.data=a,l=e):(l=new Fy(a),e.addChild(l)),r<Jr(Gc,this).getLayersCount()&&this.buildLeaves(l,t,r,o.origColspan),t+=o.origColspan})}clear(){Jr($c,this).clear(),Jr(ch,this).clear()}}function _$(n,e){n.walkDown(t=>{let{data:r,childs:i}=t;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let s=1;s<r.colspan;s++)e(r.columnIndex+s)})}function ky(n,e){let{childs:t}=n;if(t.length!==0)return t[0].data[e]}function Vy(n){return ky(n,"origColspan")===n.data.origColspan}function AO(n){const{data:e,childs:t}=n;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Vy(n))return AO(t[0]);e.isCollapsed=!1;const i=t.slice(1),s=new Set;let o=0;if(i.length>0)D(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,_$(a,u=>{s.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;o=l-a;for(let h=1;h<l;h++)s.add(u+h)}return n.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Vy(a)&&(l.isCollapsed=ky(a,"isCollapsed"))}),{rollbackModification:()=>NO(n),affectedColumns:Array.from(s),colspanCompensation:o}}function NO(n){var e;const{data:t,childs:r}=n;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Vy(n))return NO(r[0]);t.isCollapsed=!0;const s=r.slice(1),o=new Set;if(s.length>0)D(s,l=>{_$(l,u=>{o.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:h}=u;h.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=t;for(let h=1;h<l;h++){const c=u+h;o.add(c)}}const a=t.colspan-((e=ky(n,"colspan"))!==null&&e!==void 0?e:1);return n.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Vy(l)&&(u.isCollapsed=ky(l,"isCollapsed"))}),{rollbackModification:()=>AO(n),affectedColumns:Array.from(o),colspanCompensation:a}}function Gce(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(zt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(t.includes(e))return;let r=!1;n.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&n.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function jce(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(zt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(!t.includes(e))return;let r=!1;n.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&n.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const PH=new Map([["collapse",NO],["expand",AO],["hide-column",Gce],["show-column",jce]]);function zce(n,e,t){if(!PH.has(n))throw new Error(`The node modifier action ("${n}") does not exist.`);return PH.get(n)(e,t)}function Vw(n){const e=[];return D(n,t=>{t.walkDown(r=>{const i=r.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=i,u=Kce(e,a);let h=!1;for(let c=o;c<o+s;c++)if(l.includes(c)||h)u.push(b$());else{const f=Yce(i);f.isRoot=!0,u.push(f),h=!0}})}),e}function Yce(n){const{crossHiddenColumns:e,...t}=NN(n);return t}function Kce(n,e){let t;return Array.isArray(n[e])?t=n[e]:(t=[],n[e]=t),t}function XT(n,e,t){qce(n,e),e.set(n,t)}function qce(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sm(n,e,t){return n.set(x$(n,e),t),t}function bn(n,e){return n.get(x$(n,e))}function x$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Wo=new WeakMap,yi=new WeakMap,dh=new WeakMap;class Xce{constructor(){XT(this,Wo,new Dce),XT(this,yi,new $ce(bn(Wo,this))),XT(this,dh,[[]])}setState(e){bn(Wo,this).setData(e);let t=!1;try{bn(yi,this).buildTree()}catch{bn(yi,this).clear(),bn(Wo,this).clear(),t=!0}return sm(dh,this,Vw(bn(yi,this).getRoots())),t}setColumnsLimit(e){bn(Wo,this).setColumnsLimit(e)}mergeStateWith(e){const t=bt(e,r=>{let{row:i,...s}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});bn(Wo,this).mergeWith(t),bn(yi,this).buildTree(),sm(dh,this,Vw(bn(yi,this).getRoots()))}mapState(e){bn(Wo,this).map(e),bn(yi,this).buildTree(),sm(dh,this,Vw(bn(yi,this).getRoots()))}mapNodes(e){return hi(bn(yi,this).getRoots(),(t,r)=>(r.walkDown(i=>{const s=e(i.data);s!==void 0&&t.push(s)}),t),[])}triggerNodeModification(e,t,r){t<0&&(t=this.rowCoordsToLevel(t));const i=bn(yi,this).getNode(t,r);let s;return i&&(s=zce(e,i,r),sm(dh,this,Vw(bn(yi,this).getRoots()))),s}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=bn(dh,this)[e])===null||i===void 0?void 0:i[t])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,t){const r=this.getHeaderTreeNode(e,t);return r?{...r.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=bn(yi,this).getNode(e,t);return r||null}findTopMostEntireHeaderLevel(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let s=!1,o=null;for(let a=e;a<=r;a++){const l=bn(yi,this).getRootByColumn(a);if(!l)break;s=!0,l.walkDown(u=>{const{columnIndex:h,headerLevel:c,origColspan:d,isHidden:f}=u.data;f||d<=i&&h>=e&&h+d-1<=r&&(o===null||c<o)&&(o=c)},A$)}return s&&o===null?-1:this.levelToRowCoords((t=o)!==null&&t!==void 0?t:0)}findLeftMostColumnIndex(e,t){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0};if(i)return t;let s=t-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,t){var r;const{isRoot:i,origColspan:s}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return t+s-1;let o=t+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return bn(Wo,this).getLayersCount()}getColumnsCount(){return bn(Wo,this).getColumnsCount()}clear(){sm(dh,this,[]),bn(Wo,this).clear(),bn(yi,this).clear()}}function om(n,e,t){return(e=Qce(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Qce(n){var e=Zce(n,"string");return typeof e=="symbol"?e:e+""}function Zce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Jce{constructor(e,t){om(this,"hot",void 0),om(this,"nestedHeaderSettingsGetter",void 0),om(this,"layersCount",0),om(this,"container",void 0),om(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let r=0;r<t;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),s=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(s,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:r}=this.hot,i=t.createDocumentFragment(),s=t.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=t.createElement("tr");for(let h=0;h<a;h++){let c=r.getVisualFromRenderableIndex(h);c===null&&(c=h);const d=t.createElement("th"),f=this.nestedHeaderSettingsGetter(l,c);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;o&&(m+='<button class="changeType"></button>'),Qd(d,m),d.colSpan=f.colspan,u.appendChild(d)}}s.appendChild(u)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function ede(n,e){P$(n,e),e.add(n)}function LH(n,e,t){return(e=tde(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tde(n){var e=nde(n,"string");return typeof e=="symbol"?e:e+""}function nde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Uw(n,e,t){P$(n,e),e.set(n,t)}function P$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xh(n,e,t){return n.set(Tn(n,e),t),t}function _t(n,e){return n.get(Tn(n,e))}function Tn(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const DH="nestedHeaders",rde=280;var Xt=new WeakMap,Ll=new WeakMap,Wm=new WeakMap,uS=new WeakMap,Ln=new WeakSet;class ide extends Wt{constructor(){super(...arguments),ede(this,Ln),Uw(this,Xt,new Xce),Uw(this,Ll,null),Uw(this,Wm,null),Uw(this,uS,!1),LH(this,"ghostTable",new Jce(this.hot,(e,t)=>this.getHeaderSettings(e,t))),LH(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return DH}static get PLUGIN_PRIORITY(){return rde}isEnabled(){return!!this.hot.getSettings()[DH]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&jt(zt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Tn(Ln,this,Cde).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,Sde).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,lde).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,ude).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,hde).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,cde).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,dde).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,fde).call(e,...i)}),this.addHook("afterSelection",()=>Tn(Ln,this,Bw).call(this)),this.addHook("afterSelectionFocusSet",()=>Tn(Ln,this,Bw).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,sde).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Tn(Ln,this,gde).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,wde).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,vde).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,ode).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,ade).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,mde).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,pde).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Tn(Ln,e,yde).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Tn(Ln,this,Bw).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Tn(Ln,this,Bw).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();_t(Xt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=_t(Xt,this).setState(e)),this.detectedOverlappedHeaders&&jt(zt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,r)=>{const i=t===!0?"hide-column":"show-column";_t(Xt,this).triggerColumnModification(i,r)}),!_t(Ll,this)&&this.enabled&&xh(Ll,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(r=>{let{op:i,index:s,newValue:o}=r;if(i==="replace"){const a=o===!0?"hide-column":"show-column";_t(Xt,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),_t(Xt,this).clear(),_t(Ll,this).unsubscribe(),xh(Ll,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return _t(Xt,this)}getLayersCount(){return _t(Xt,this).getLayersCount()}getHeaderSettings(e,t){return _t(Xt,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<t;o++){const a=r.childNodes[o];if(!a)break;const l=i.childNodes[o],u=s?s.childNodes[o]:null;for(let h=0,c=a.childNodes.length;h<c;h++)a.childNodes[h].removeAttribute("colspan"),rt(a.childNodes[h],"hiddenHeader"),l&&l.childNodes[h]&&(l.childNodes[h].removeAttribute("colspan"),rt(l.childNodes[h],"hiddenHeader")),s&&u&&u.childNodes[h]&&(u.childNodes[h].removeAttribute("colspan"),rt(u.childNodes[h],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),s.removeAttribute("colspan"),rt(s,"hiddenHeader");const{colspan:h,isHidden:c,isPlaceholder:d,headerClassNames:f}=(o=_t(Xt,this).getHeaderSettings(e,u))!==null&&o!==void 0?o:{};if(d||c)oe(s,"hiddenHeader");else if(h>1){var m,p;const{wtOverlays:v}=l._wt,y=(m=v.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s),C=(p=v.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(s),R=y||C?Math.min(h,r-i):h;R>1&&s.setAttribute("colspan",R)}if(this.hot.view.appendColHeader(u,s,function(){return t.getColumnHeaderValue(...arguments)},e),!d&&!c){const v=s.querySelector("div.relative");v&&f&&f.length>0&&(rt(v,this.hot.getColumnMeta(u).headerClassName),oe(v,f))}}}getColumnHeaderValue(e,t){var r;const{isHidden:i,isPlaceholder:s}=(r=_t(Xt,this).getHeaderSettings(t,e))!==null&&r!==void 0?r:{};return s||i?"":this.hot.getColHeader(e,t)}destroy(){xh(Xt,this,null),_t(Ll,this)!==null&&(_t(Ll,this).unsubscribe(),xh(Ll,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return _t(Xt,this).getHeaderTreeNodeData(e.row,e.col)}}function Bw(){var n;const e=(n=this.hot)===null||n===void 0?void 0:n.getSelectedRangeLast();if(!e)return;const{highlight:t}=e;if(t.isHeader()&&t.col>=0){const i=_t(Xt,this).findLeftMostColumnIndex(t.row,t.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=i,s.visualCellRange.from.col=i,s.visualCellRange.to.col=i,s.commit()}}function sde(n){const e=this.hot.getSelectedRangeLast();if(!e)return n;const{highlight:t}=e;if(!(t.isHeader()&&t.col>=0))return n;const i=this.hot.view.getFirstFullyVisibleColumn(),s=this.hot.view.getLastFullyVisibleColumn(),o=_t(Xt,this).findLeftMostColumnIndex(t.row,t.col),a=_t(Xt,this).findRightMostColumnIndex(t.row,t.col);return o<i&&a>s?n:o<i?o:a}function ode(n,e,t){const r=_t(Xt,this).getHeaderTreeNodeData(e,n);if(!r)return n;const{columnCursor:i,selectionType:s,selectionWidth:o}=t,{isRoot:a,colspan:l}=_t(Xt,this).getHeaderSettings(e,n);if(s===dI){if(!a)return r.columnIndex}else if(s===WU&&(l>o-i||!a))return null;return n}function ade(n,e,t){let{columnHeadersCount:r}=t;if(r!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:u}=e[s],h=l-o+1,c=a-u+1;if(o>=0||c===1)break;for(let d=a;d<=u;d++)for(let f=o;f<=l;f++){var i;const m=h+f,p=d-a;if(p===0)continue;((i=_t(Xt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(n[m][p]="")}}}function lde(n,e,t,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function ude(n,e){const t=this._getHeaderTreeNodeDataByCoords(e);if(!t)return;xh(Wm,this,e.clone()),xh(uS,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=t,l=!r.inInSelection(e);n.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,o,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(eI(n)||Uh(n)&&l||D4(n))&&s.push(o,o+a-1,e.row),r.selectColumns(...s)}function hde(n,e,t,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:o}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:h}=a;r.column=!0,r.cell=!0;const c=[],d=qt(e.row,-1/0,-1);e.col<h.col?c.push(u.col,s,d):e.col>h.col?c.push(l.col,s+o-1,d):c.push(s,s+o-1,d),this.hot.selection.selectColumns(...c)}function cde(){xh(uS,this,!1)}function dde(){const{navigableHeaders:n}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!_t(uS,this)||!n)return;const e=this.hot.getSelectedRangeLast(),t=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=_t(Xt,this).getHeaderTreeNodeData(_t(Wm,this).row,_t(Wm,this).col);if(e.setHighlight(_t(Wm,this)),s>e.getWidth()||i<t||i+s-1>r){const o=_t(Xt,this).findTopMostEntireHeaderLevel(qt(t,i,i+s-1),qt(r,i,i+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function fde(n){const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.hot._createCellCoords(e.row+n.row,e.col+n.col);if(!(t.isHeader()&&t.col>=0))return;const i=_t(Xt,this).findLeftMostColumnIndex(t.row,t.col),s=_t(Xt,this).findRightMostColumnIndex(t.row,t.col);if(n.col<0){const o=e.col>=i&&e.col<=s?i-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(n.col>0){const o=e.col>=i&&e.col<=s?s+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?n.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function mde(n,e){const t=n.row,r=this._getHeaderTreeNodeDataByCoords({row:t,col:n.col}),i=this._getHeaderTreeNodeDataByCoords({row:t,col:e.col});e.col<n.col?(r&&(n.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=n.col&&(r&&(n.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function gde(n){n.length=0;for(let e=0;e<_t(Xt,this).getLayersCount();e++)n.push(this.headerRendererFactory(e))}function pde(n){const e=_t(Xt,this).getLayersCount();let t=n.startColumn,r=!!e;for(let i=0;i<e;i++){const s=_t(Xt,this).findLeftMostColumnIndex(i,n.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(r=!1),oi(o)&&o<n.startColumn){t=o;break}}n.startColumn=r?_t(Xt,this).getHeaderTreeNodeData(0,t).columnIndex:t}function wde(n,e){const t=this.ghostTable.getWidth(e);return n>t?n:t}function vde(n,e,t){var r;const{label:i}=(r=_t(Xt,this).getHeaderTreeNodeData(t,e))!==null&&r!==void 0?r:{label:""};return i}function yde(n,e){if(n<0)return this.hot.getCell(n,_t(Xt,this).findLeftMostColumnIndex(n,e),!0)}function Cde(){this.updatePlugin()}function Sde(n,e){e||this.updatePlugin()}function am(n,e,t){return(e=Rde(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Rde(n){var e=Ede(n,"string");return typeof e=="symbol"?e:e+""}function Ede(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class bde{constructor(e,t){am(this,"hot",void 0),am(this,"data",null),am(this,"plugin",void 0),am(this,"parentReference",new WeakMap),am(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},De(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,r){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&D(e.__children,i=>{this.cacheNode(i,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,r,i){let s=!1,o=t;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),r!=null&&o===r?{result:a,end:!0}:i!=null&&a===i?{result:o,end:!0}:(o+=1,a.__children&&D(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,r,i),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return gt(this.data[0],(t,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(t):r.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(D(r.__children,i=>{t+=1,i.__children&&(t+=this.countChildren(i))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var r;return((r=e.__children)===null||r===void 0?void 0:r[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((t=r.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let r=t;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),r||(r=this.mockNode()),s.__children.push(r),this.rewriteCache();const o=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,t,r){let i=r,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,t),e){const a=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(t,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[t]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),s=this.getRowIndexWithinParent(r);switch(t){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(De(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),De(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const s=this.getRowIndex(r),o=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),h=this.getRowIndex(u);let c=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,d,this.plugin.pluginName),u){c=h+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,o+1,this.plugin.pluginName),u.__children.push(r)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,o+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),t&&this.hot.render()}filterData(e,t,r){const i=[];D(r,s=>{i.push(this.getDataObject(s))}),D(i,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,t,r){const i=this.getDataObject(e-1);let s=null,o=e;i&&i.__children&&i.__children.length===0?(s=i,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?r?s.__children.splice(o,t,...r):s.__children.splice(o,t):r?this.data.splice(o,t,...r):this.data.splice(o,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,r=null;do r=this.getRowParent(r),r!==null&&(t=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,r,i){const s=t===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),u=e>t;let h=s?this.getRowParent(t-1):this.getRowParent(t);h==null&&(h=this.getRowParent(t-1)),h==null&&(h=this.getDataObject(t-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(t),h.__children=[]);const c=s||r||i?h.__children.length:this.getRowIndexWithinParent(t),d=o===h;h.__children.splice(c,0,l[0]),o.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(h)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function HH(n,e,t){return(e=Tde(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Tde(n){var e=Ade(n,"string");return typeof e=="symbol"?e:e+""}function Ade(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class IO{constructor(e,t){HH(this,"hot",void 0),HH(this,"plugin",void 0),this.hot=t,this.plugin=e}}class Jo extends IO{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),s=this.dataManager.getDataObject(r),o=t.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(D(l,h=>{h&&o.removeChild(h)}),oe(t,Jo.CSS_CLASSES.indicatorContainer),i){const{rootDocument:h}=this.hot,c=a.cloneNode(!0);o.innerHTML="",De(0,i-1,()=>{const d=h.createElement("SPAN");oe(d,Jo.CSS_CLASSES.emptyIndicator),o.appendChild(d)}),o.appendChild(c)}if(this.dataManager.hasChildren(s)){const h=this.hot.rootDocument.createElement("DIV");u&&Xe(h,[ic()]),oe(t,Jo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(oe(h,`${Jo.CSS_CLASSES.button} ${Jo.CSS_CLASSES.expandButton}`),u&&Xe(t,[Es(!1)])):(oe(h,`${Jo.CSS_CLASSES.button} ${Jo.CSS_CLASSES.collapseButton}`),u&&Xe(t,[Es(!0)])),o.appendChild(h)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}class Nde extends IO{constructor(e,t){var r;super(e,t),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),D(r.lastCollapsedRows,(a,l)=>{a>=i&&a<s&&(r.lastCollapsedRows[l]=a+o)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,s)=>{De(i,i+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&D(s.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];D(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),r&&this.trimRows(i),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return D(e,s=>{i.push(s),t&&this.collapseChildRows(s,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);D(i.__children,s=>{const o=this.dataManager.getRowIndex(s);t.push(o),this.collapseChildRows(o,t)})}r&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return D(e,s=>{i.push(s),t&&this.expandChildRows(s,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);D(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);t.push(o),this.expandChildRows(o,t)}})}r&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&D(s.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),t&&this.renderAndAdjust(),a}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];D(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),r&&this.untrimRows(i),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];D(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];D(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{D(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{D(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&D(t.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return r=!1,!1}),r}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const r=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const r=this.translateTrimmedRow(t.row);Ze(e.target,Jo.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Ro(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Ide(n,e,t){Mde(n,e),e.set(n,t)}function Mde(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ode(n,e,t){return(e=_de(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _de(n){var e=xde(n,"string");return typeof e=="symbol"?e:e+""}function xde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Pde(n,e){return n.get(Lde(n,e))}function Lde(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var FH=new WeakMap;class Dde extends IO{constructor(){super(...arguments),Ode(this,"dataManager",this.plugin.dataManager),Ide(this,FH,{row_above:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(sM)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(oM)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return De(0,e.items.length-1,r=>{if(r===0)return D(t,(i,s)=>{e.items.splice(r+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return De(0,e.items.length-1,t=>{const r=Pde(FH,this)[e.items[t].key];r!=null&&(e.items[t].callback=r)}),e}}function Ww(n,e,t){return(e=Hde(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Hde(n){var e=Fde(n,"string");return typeof e=="symbol"?e:e+""}function Fde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class kde{constructor(e){Ww(this,"plugin",void 0),Ww(this,"hot",void 0),Ww(this,"dataManager",void 0),Ww(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=r===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(m=>{if(!l)return!1;const p=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(p,a),p}),h=u.indexOf(a)===-1;if(!l||!h)return!1;const c=this.getBaseParent(u),d=this.getTargetParent(o,a),f=c===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,r,i,i&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:r,dropIndex:i,movePossible:s}=e;let o=!1;return hn(i)&&(jt(zt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,r,i,s,!1),o=!0),o}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let r=this.dataManager.getRowParent(e?t-1:t);return r==null&&(r=this.dataManager.getRowParent(t-1)),r}shiftCollapsibleParentsLocations(e,t,r){r||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,r){const i=t===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,t,this.movedToCollapsed,i)})})}moveCellsMeta(e,t){const r=[],i=Math.max(...e)<t;e.forEach(s=>{r.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(i?r.length:0),0,...r)}selectCells(e,t){const r=e.length;let i=0,s=0,o=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<t?l=this.dataManager.translateTrimmedRow(t-r):l=this.dataManager.translateTrimmedRow(t);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),h=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(h),s=i}else e[r-1]<t?(s=t-1,i=s-r+1):(i=t,s=i+r-1);o=this.hot.selection,a=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(i,0)),o.setRangeEnd(this.hot._createCellCoords(s,a),!0)}isRowOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}}function Vde(n,e){L$(n,e),e.add(n)}function kH(n,e,t){L$(n,e),e.set(n,t)}function L$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QT(n,e,t){return(e=Ude(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ude(n){var e=Bde(n,"string");return typeof e=="symbol"?e:e+""}function Bde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Iv(n,e){return n.get(lr(n,e))}function Uy(n,e,t){return n.set(lr(n,e),t),t}function lr(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const By="nestedRows",Wde=300,VH=By,$de="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var hS=new WeakMap,jc=new WeakMap,mr=new WeakSet;class Gde extends Wt{constructor(){super(...arguments),Vde(this,mr),QT(this,"dataManager",null),QT(this,"headersUI",null),QT(this,"collapsedRowsMap",null),kH(this,hS,!1),kH(this,jc,!1)}static get PLUGIN_KEY(){return By}static get PLUGIN_PRIORITY(){return Wde}isEnabled(){return!!this.hot.getSettings()[By]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Yg),this.dataManager=new bde(this,this.hot),this.collapsingUI=new Nde(this,this.hot),this.headersUI=new Jo(this,this.hot),this.contextMenuUI=new Dde(this,this.hot),this.rowMoveController=new kde(this),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,ife).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,sfe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,Yde).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,Kde).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,qde).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,zde).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,Zde).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,Qde).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,Jde).call(e,...r)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,efe).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,tfe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,nfe).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,Xde).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,rfe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return lr(mr,e,jde).call(e,...r)}),this.addHook("beforeLoadData",t=>lr(mr,this,UH).call(this,t)),this.addHook("beforeUpdateData",t=>lr(mr,this,UH).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:VH,relativeToGroup:yu,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(VH)}disableCoreAPIModifiers(){Uy(jc,this,!0)}enableCoreAPIModifiers(){Uy(jc,this,!1)}onModifyRowData(e){if(!Iv(jc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Iv(jc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,r){return Iv(jc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,r),!1)}destroy(){super.destroy()}}function jde(n,e,t,r){return this.rowMoveController.onBeforeRowMove(n,e,t,r)}function zde(n,e,t){this.collapsingUI.toggleState(n,e,t)}function Yde(n,e,t){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(t[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(t[0],null,-1*e),this.dataManager.filterData(n,e,t),Uy(hS,this,!0),this.dataManager.getData().slice()}function Kde(n){return this.contextMenuUI.appendOptions(n)}function qde(n,e){this.headersUI.appendLevelIndicators(n,e)}function Xde(n){return Math.max(this.headersUI.rowHeaderWidthCache,n)}function Qde(n,e,t,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{Uy(hS,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Zde(n,e,t){const r=Array.from(t.reduce((i,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(o)&&o.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(s)},new Set));t.length=0,t.push(...r)}function Jde(){this.collapsingUI.collapsedRowsStash.stash()}function efe(n,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function tfe(){this.collapsingUI.collapsedRowsStash.stash()}function nfe(n,e,t){this.collapsingUI.collapsedRowsStash.shiftStash(t,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function rfe(){this.dataManager.rewriteCache()}function ife(){this.headersUI.updateRowHeaderWidth()}function sfe(n,e){Iv(hS,this)&&(e.skipRender=!0)}function UH(n){if(!T8(n)){nI($de),this.hot.getSettings()[By]=!1,this.disablePlugin();return}this.dataManager.setData(n),this.dataManager.rewriteCache()}function ZT(n,e,t){return(e=ofe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ofe(n){var e=afe(n,"string");return typeof e=="symbol"?e:e+""}function afe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class lfe{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;ZT(this,"rootWindow",void 0),ZT(this,"prefix",void 0),ZT(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const r=typeof e>"u"?t:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){D(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function ufe(n,e,t){return(e=hfe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hfe(n){var e=cfe(n,"string");return typeof e=="symbol"?e:e+""}function cfe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}Ae.getSingleton().register("persistentStateSave");Ae.getSingleton().register("persistentStateLoad");Ae.getSingleton().register("persistentStateReset");const BH="persistentState",dfe=0;class ffe extends Wt{constructor(){super(...arguments),ufe(this,"storage",void 0)}static get PLUGIN_KEY(){return BH}static get PLUGIN_PRIORITY(){return dfe}isEnabled(){return!!this.hot.getSettings()[BH]}enablePlugin(){this.enabled||(this.storage||(this.storage=new lfe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function mfe(n,e){gfe(n,e),e.add(n)}function gfe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JT(n,e,t){return(e=pfe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pfe(n){var e=wfe(n,"string");return typeof e=="symbol"?e:e+""}function wfe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function WH(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const eA="search",vfe=190,yfe="htSearchResult",Cfe=function(n,e,t,r,i){n.getCellMeta(e,t).isSearchResult=i},Sfe=function(n,e,t){return hn(n)||n===null||!n.toLocaleLowerCase||n.length===0||hn(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(n.toLocaleLowerCase(t.locale))!==-1};var tA=new WeakSet;class Rfe extends Wt{constructor(){super(...arguments),mfe(this,tA),JT(this,"callback",Cfe),JT(this,"queryMethod",Sfe),JT(this,"searchResultClass",yfe)}static get PLUGIN_KEY(){return eA}static get PLUGIN_PRIORITY(){return vfe}isEnabled(){return this.hot.getSettings()[eA]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[eA];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return WH(tA,e,$H).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return WH(tA,e,$H).call(e,...i)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return De(0,i-1,l=>{De(0,s-1,u=>{const h=this.hot.getDataAtCell(l,u),c=this.hot.getCellMeta(l,u),d=c.search.callback||t,m=(c.search.queryMethod||r)(e,h,c);if(m){const p={row:l,col:u,data:h};o.push(p)}d&&d(a,l,u,h,m)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){mt(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function $H(n,e,t,r,i,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function Efe(n,e){bfe(n,e),e.add(n)}function bfe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $w(n,e,t){return(e=Tfe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Tfe(n){var e=Afe(n,"string");return typeof e=="symbol"?e:e+""}function Afe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function nA(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Nfe="touchScroll",Ife=200;var Gw=new WeakSet;class Mfe extends Wt{constructor(){super(...arguments),Efe(this,Gw),$w(this,"scrollbars",[]),$w(this,"clones",[]),$w(this,"lockedCollection",!1),$w(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Nfe}static get PLUGIN_PRIORITY(){return Ife}static get SETTING_KEYS(){return!0}isEnabled(){return dU()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>nA(Gw,this,Ofe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>nA(Gw,this,_fe).call(this)),this.addHook("afterMomentumScroll",()=>nA(Gw,this,xfe).call(this))}}function Ofe(){if(this.lockedCollection)return;const{topOverlay:n,bottomOverlay:e,inlineStartOverlay:t,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(n),e.clone&&this.scrollbars.push(e),this.scrollbars.push(t),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function _fe(){this.freezeOverlays=!0,D(this.clones,n=>{oe(n,"hide-tween")})}function xfe(){this.freezeOverlays=!1,D(this.clones,n=>{rt(n,"hide-tween"),oe(n,"show-tween")}),this.hot._registerTimeout(()=>{D(this.clones,n=>{rt(n,"show-tween")})},400),D(this.scrollbars,n=>{n.refresh(),n.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Pfe(n,e){Lfe(n,e),e.add(n)}function Lfe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dfe(n,e,t){return(e=Hfe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Hfe(n){var e=Ffe(n,"string");return typeof e=="symbol"?e:e+""}function Ffe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function kfe(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Mv="trimRows",Vfe=330;var GH=new WeakSet;class Ufe extends Wt{constructor(){super(...arguments),Pfe(this,GH),Dfe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Mv}static get PLUGIN_PRIORITY(){return Vfe}isEnabled(){return!!this.hot.getSettings()[Mv]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Yg),this.trimmedRowsMap.addLocalHook("init",()=>kfe(GH,this,Bfe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Mv];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),D(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{D(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",t,i,r,r&&i.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let i=t;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;r&&o&&(D(e,l=>{s[l]=!1}),i=hi(s,(l,u,h)=>(u&&l.push(h),l),[])),this.hot.runHooks("beforeUntrimRow",t,i,r&&o)!==!1&&(r&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",t,i,r&&o,r&&i.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<t)}destroy(){super.destroy()}}function Bfe(){const n=this.hot.getSettings()[Mv];Array.isArray(n)&&this.hot.batchExecution(()=>{D(n,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var jH={},rA,zH;function D$(){return zH||(zH=1,rA={}),rA}var iA,YH;function Wfe(){if(YH)return iA;YH=1;var n=pu(),e=D$(),t=n("iterator"),r=Array.prototype;return iA=function(i){return i!==void 0&&(e.Array===i||r[t]===i)},iA}var sA,KH;function H$(){if(KH)return sA;KH=1;var n=Bk(),e=yC(),t=u0(),r=D$(),i=pu(),s=i("iterator");return sA=function(o){if(!t(o))return e(o,s)||e(o,"@@iterator")||r[n(o)]},sA}var oA,qH;function $fe(){if(qH)return oA;qH=1;var n=yo(),e=_g(),t=fl(),r=vC(),i=H$(),s=TypeError;return oA=function(o,a){var l=arguments.length<2?i(o):a;if(e(l))return t(n(l,o));throw new s(r(o)+" is not iterable")},oA}var aA,XH;function Gfe(){if(XH)return aA;XH=1;var n=zk(),e=yo(),t=fl(),r=vC(),i=Wfe(),s=Dg(),o=pC(),a=$fe(),l=H$(),u=C0(),h=TypeError,c=function(f,m){this.stopped=f,this.result=m},d=c.prototype;return aA=function(f,m,p){var v=p&&p.that,y=!!(p&&p.AS_ENTRIES),C=!!(p&&p.IS_RECORD),R=!!(p&&p.IS_ITERATOR),A=!!(p&&p.INTERRUPTED),I=n(m,v),H,k,W,z,G,q,J,re=function(ae){return H&&u(H,"normal"),new c(!0,ae)},ie=function(ae){return y?(t(ae),A?I(ae[0],ae[1],re):I(ae[0],ae[1])):A?I(ae,re):I(ae)};if(C)H=f.iterator;else if(R)H=f;else{if(k=l(f),!k)throw new h(r(f)+" is not iterable");if(i(k)){for(W=0,z=s(f);z>W;W++)if(G=ie(f[W]),G&&o(d,G))return G;return new c(!1)}H=a(f,k)}for(q=C?f.next:H.next;!(J=e(q,H)).done;){try{G=ie(J.value)}catch(ae){u(H,"throw",ae)}if(typeof G=="object"&&G&&o(d,G))return G}return new c(!1)},aA}var lA,QH;function jfe(){if(QH)return lA;QH=1;var n=vo(),e=Zh(),t=mC();return lA=function(r,i,s){n?e.f(r,i,t(0,s)):r[i]=s},lA}var ZH;function zfe(){if(ZH)return jH;ZH=1;var n=Dr(),e=Gfe(),t=jfe();return n({target:"Object",stat:!0},{fromEntries:function(i){var s={};return e(i,function(o,a){t(s,o,a)},{AS_ENTRIES:!0}),s}}),jH}zfe();const F$="undoRedo",Yfe="undoRedo";function ge(n){const e=this;this.instance=n,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,n.addHook("afterChange",function(r,i){const s=r&&r.length;if(!s||!r.find(l=>{const[,,u,h]=l;return u!==h}))return;const a=()=>{const l=r.reduce((h,c)=>(h.push([...c]),h),[]);D(l,h=>{h[1]=n.propToCol(h[1])});const u=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new ge.ChangeAction(l,u)};e.done(a,i)}),n.addHook("afterCreateRow",(r,i,s)=>{e.done(()=>new ge.CreateRowAction(r,i),s)});const t=(r,i,s,o)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return De(s,o,h=>{De(r,i,c=>{const d=n.getCellMeta(c,h);if(Object.keys(d).length!==l){const f=Object.fromEntries(Object.entries(d).filter(m=>{let[p]=m;return a.includes(p)===!1}));u.push([d.visualRow,d.visualCol,f])}})}),u};n.addHook("beforeRemoveRow",(r,i,s,o)=>{const a=()=>{const l=n.toPhysicalRow(r),u=l+i-1,h=ui(e.instance.getSourceData(l,0,l+i-1,e.instance.countSourceCols()-1));return new ge.RemoveRowAction(l,h,n.getSettings().fixedRowsBottom,n.getSettings().fixedRowsTop,n.rowIndexMapper.getIndexesSequence(),t(l,u,0,n.countCols()-1))};e.done(a,o)}),n.addHook("afterCreateCol",(r,i,s)=>{e.done(()=>new ge.CreateColumnAction(r,i),s)}),n.addHook("beforeRemoveCol",(r,i,s,o)=>{const a=()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+r)%e.instance.countCols(),h=u+i-1,c=[],d=[],f=[];De(l.length-1,v=>{const y=[],C=l[v];De(u,h,R=>{y.push(C[n.toPhysicalColumn(R)])}),c.push(y)}),De(i-1,v=>{f.push(n.toPhysicalColumn(u+v))}),Array.isArray(n.getSettings().colHeaders)&&De(i-1,v=>{d.push(n.getSettings().colHeaders[n.toPhysicalColumn(u+v)]||null)});const m=n.columnIndexMapper.getIndexesSequence(),p=n.rowIndexMapper.getIndexesSequence();return new ge.RemoveColumnAction(u,f,c,d,m,p,n.getSettings().fixedColumnsStart,t(0,n.countRows(),u,h))};e.done(a,o)}),n.addHook("beforeCellAlignment",(r,i,s,o)=>{e.done(()=>new ge.CellAlignmentAction(r,i,s,o))}),n.addHook("beforeFilter",(r,i)=>{e.done(()=>new ge.FiltersAction(r,i))}),n.addHook("beforeRowMove",(r,i)=>{r!==!1&&e.done(()=>new ge.RowMoveAction(r,i))}),n.addHook("beforeColumnMove",(r,i)=>{r!==!1&&e.done(()=>new ge.ColumnMoveAction(r,i))}),n.addHook("beforeMergeCells",(r,i)=>{i||e.done(()=>new ge.MergeCellsAction(n,r))}),n.addHook("afterUnmergeCells",(r,i)=>{i||e.done(()=>new ge.UnmergeCellsAction(n,r))}),n.addHook("beforeColumnSort",(r,i,s)=>{s&&e.done(()=>new ge.ColumnSortAction(r,i))}),n.addHook("afterInit",()=>{e.init()})}ge.prototype.done=function(n,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const s=n(),o=this.undoneActions.slice();this.doneActions.push(s),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())};ge.prototype.undo=function(){if(this.isUndoAvailable()){const n=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",n);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice());const t=ui(e);if(this.instance.runHooks("beforeUndo",t)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}};ge.prototype.redo=function(){if(this.isRedoAvailable()){const n=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",n);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",n,this.undoneActions.slice());const t=ui(e);if(this.instance.runHooks("beforeRedo",t)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}};ge.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ge.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ge.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ge.prototype.isEnabled=function(){return this.enabled};ge.prototype.enable=function(){if(this.isEnabled())return;const n=this.instance;this.enabled=!0,Xfe(n),this.registerShortcuts(),n.addHook("afterChange",k$)};ge.prototype.disable=function(){if(!this.isEnabled())return;const n=this.instance;this.enabled=!1,Qfe(n),this.unregisterShortcuts(),n.removeHook("afterChange",k$)};ge.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ge.Action=function(){};ge.Action.prototype.undo=function(){};ge.Action.prototype.redo=function(){};ge.ChangeAction=function(n,e){this.changes=n,this.selected=e,this.actionType="change"};Ca(ge.ChangeAction,ge.Action);ge.ChangeAction.prototype.undo=function(n,e){const t=ui(this.changes),r=n.countEmptyRows(!0),i=n.countEmptyCols(!0);for(let o=0,a=t.length;o<a;o++)t[o].splice(3,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.undo");for(let o=0,a=t.length;o<a;o++){const[l,u]=t[o];n.getSettings().minSpareRows&&l+1+n.getSettings().minSpareRows===n.countRows()&&r===n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(l+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&u+1+n.getSettings().minSpareCols===n.countCols()&&i===n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(u+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())}const s=n.getSelectedLast();if(s!==void 0){const[o,a]=t[0],[l,u]=s,h=n.view.getFirstFullyVisibleRow(),c=n.view.getFirstFullyVisibleColumn(),d=o>=h,f=a>=c;if((d&&f)===!1&&(l!==o||u!==a)===!0){const v={row:o,col:a};d===!1&&(v.verticalSnap="top"),f===!1&&(v.horizontalSnap="start"),n.scrollViewportTo(v)}}n.selectCells(this.selected,!1,!1)};ge.ChangeAction.prototype.redo=function(n,e){const t=ui(this.changes);for(let r=0,i=t.length;r<i;r++)t[r].splice(2,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&n.selectCells(this.selected,!1,!1)};ge.CreateRowAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_row"};Ca(ge.CreateRowAction,ge.Action);ge.CreateRowAction.prototype.undo=function(n,e){const t=n.countRows(),r=n.getSettings().minSpareRows;this.index>=t&&this.index-r<t&&(this.index-=r),n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ge.CreateRowAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateRow",e),n.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ge.RemoveRowAction=function(n,e,t,r,i,s){this.index=n,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=r,this.rowIndexesSequence=i,this.removedCellMetas=s};Ca(ge.RemoveRowAction,ge.Action);ge.RemoveRowAction.prototype.undo=function(n,e){const t=n.getSettings(),r=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,s)=>{Object.keys(i).forEach(o=>{const a=parseInt(o,10);r.push([this.index+s,isNaN(a)?o:a,i[o]])})}),n.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(i=>{let[s,o,a]=i;n.setCellMetaObject(s,o,a)}),n.addHookOnce("afterViewRender",e),n.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),n.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ge.RemoveRowAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ge.CreateColumnAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_col"};Ca(ge.CreateColumnAction,ge.Action);ge.CreateColumnAction.prototype.undo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ge.CreateColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateCol",e),n.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ge.RemoveColumnAction=function(n,e,t,r,i,s,o,a){this.index=n,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o,this.removedCellMetas=a};Ca(ge.RemoveColumnAction,ge.Action);ge.RemoveColumnAction.prototype.undo=function(n,e){const t=n.getSettings();t.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,h,c)=>c[this.indexes.indexOf(r[h])],s=this.data.length,o=[];for(let u=0;u<s;u++)o.push(bt(this.data[u],i));const a=bt(this.headers,i),l=[];n.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),D(n.getSourceDataArray(),(u,h)=>{D(r,(c,d)=>{u[c]=o[h][d],l.push([h,c,u[c]])})}),n.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&D(a,(u,h)=>{n.getSettings().colHeaders[r[h]]=u}),this.removedCellMetas.forEach(u=>{let[h,c,d]=u;n.setCellMetaObject(h,c,d)}),n.batchExecution(()=>{n.rowIndexMapper.setIndexesSequence(this.rowPositions),n.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),n.addHookOnce("afterViewRender",e),n.render()};ge.RemoveColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ge.CellAlignmentAction=function(n,e,t,r){this.stateBefore=n,this.range=e,this.type=t,this.alignment=r};ge.CellAlignmentAction.prototype.undo=function(n,e){D(this.range,t=>{t.forAll((r,i)=>{r>=0&&i>=0&&n.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),n.addHookOnce("afterViewRender",e),n.render()};ge.CellAlignmentAction.prototype.redo=function(n,e){Dl(this.range,this.type,this.alignment,(t,r)=>n.getCellMeta(t,r),(t,r,i,s)=>n.setCellMeta(t,r,i,s)),n.addHookOnce("afterViewRender",e),n.render()};ge.FiltersAction=function(n,e){this.previousConditionsStack=e,this.conditionsStack=n,this.actionType="filter"};Ca(ge.FiltersAction,ge.Action);ge.FiltersAction.prototype.undo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),this.previousConditionsStack&&t.conditionCollection.importAllConditions(this.previousConditionsStack),t.filter()};ge.FiltersAction.prototype.redo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};class Kfe extends ge.Action{constructor(e,t){super(),this.cellRange=t;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange)}}ge.MergeCellsAction=Kfe;class qfe extends ge.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange,!0)}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0),e.render()}}ge.UnmergeCellsAction=qfe;ge.RowMoveAction=function(n,e){this.rows=n.slice(),this.finalRowIndex=e,this.actionType="row_move"};Ca(ge.RowMoveAction,ge.Action);ge.RowMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),EO(this.rows,this.finalRowIndex,n.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),t.moveRow(o,s)}),n.render(),n.deselectCell(),n.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ge.RowMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalRowIndex),n.render(),n.deselectCell(),n.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};ge.ColumnMoveAction=function(n,e){this.columns=n.slice(),this.finalColumnIndex=e,this.actionType="col_move"};Ca(ge.ColumnMoveAction,ge.Action);ge.ColumnMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualColumnMove");n.addHookOnce("afterViewRender",e),EO(this.columns,this.finalColumnIndex,n.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),t.moveColumn(o,s)}),n.render(),n.deselectCell(),n.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};ge.ColumnMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualColumnMove");n.addHookOnce("afterViewRender",e),t.moveColumns(this.columns.slice(),this.finalColumnIndex),n.render(),n.deselectCell(),n.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};ge.ColumnSortAction=function(n,e){this.previousSortState=n,this.nextSortState=e};Ca(ge.ColumnSortAction,ge.Action);ge.ColumnSortAction.prototype.undo=function(n,e){const t=n.getPlugin("columnSorting"),r=n.getPlugin("multiColumnSorting"),i=r.isEnabled()?r:t;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),e()};ge.ColumnSortAction.prototype.redo=function(n,e){const t=n.getPlugin("columnSorting"),r=n.getPlugin("multiColumnSorting");(r.isEnabled()?r:t).sort(this.nextSortState),e()};ge.prototype.init=function(){const n=this.instance.getSettings().undo,e=typeof n>"u"||n;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ge.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:F$};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};ge.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(F$)};function k$(n,e){const t=this;if(e==="loadData")return t.undoRedo.clear()}function Xfe(n){n.undo=function(){return n.undoRedo.undo()},n.redo=function(){return n.undoRedo.redo()},n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()},n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()},n.clearUndo=function(){return n.undoRedo.clear()}}function Qfe(n){delete n.undo,delete n.redo,delete n.isUndoAvailable,delete n.isRedoAvailable,delete n.clearUndo}const np=Ae.getSingleton();np.add("afterUpdateSettings",function(){var n;(n=this.getPlugin("undoRedo"))===null||n===void 0||n.init()});np.register("beforeUndo");np.register("afterUndo");np.register("beforeRedo");np.register("afterRedo");ge.PLUGIN_KEY=Yfe;ge.SETTING_KEYS=!0;function Zfe(){Ht(Tm),Ht(cte),Ht(Am),Ht(jte),Ht(Jte),Ht(lW),Ht(Yne),Ht(xre),Ht(iS),Ht(Wie),Ht(mse),Ht(Rse),Ht(aS),Ht(Xse),Ht(Kae),Ht(Tle),Ht(Qle),Ht(lue),Ht(Cue),Ht(_ue),Ht(Bue),Ht(she),Ht(mhe),Ht(Yhe),Ht(Nce),Ht(xce),Ht(ide),Ht(Gde),Ht(ffe),Ht(Rfe),Ht(Mfe),Ht(Ufe),Ht(ge)}function Jfe(){VJ(),iee(),fee(),Pee(),Zfe()}var Un;(function(n){n.RELATIVE="RELATIVE",n.ABSOLUTE="ABSOLUTE"})(Un||(Un={}));class si{constructor(e,t,r){this.type=e,this.col=t,this.sheet=r}static absolute(e,t){return new si(Un.ABSOLUTE,e,t)}static relative(e,t){return new si(Un.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleColumnAddress(e).col-r.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===Un.ABSOLUTE}isColumnRelative(){return this.type===Un.RELATIVE}isAbsolute(){return this.type===Un.ABSOLUTE&&this.sheet!==void 0}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new si(this.type,this.col+t,i)}shiftedByColumns(e){return new si(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=fo(this,e);let r=this.col;return this.isColumnRelative()&&(r=e.col+this.col),dj(t,r)}shiftRelativeDimensions(e,t){const r=this.isColumnRelative()?this.col+e:this.col;return new si(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnAbsolute()?this.col+e:this.col;return new si(this.type,r,this.sheet)}withSheet(e){return new si(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Un.RELATIVE:return`${t}#COLR${this.col}`;case Un.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(Lwe(t))return;const r=dS(t.col);return`${this.type===Un.ABSOLUTE?"$":""}${r}`}exceedsSheetSizeLimits(e){return this.col>=e}}class Gr{constructor(e,t,r){this.type=e,this.row=t,this.sheet=r}static absolute(e,t){return new Gr(Un.ABSOLUTE,e,t)}static relative(e,t){return new Gr(Un.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleRowAddress(e).row-r.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===Un.ABSOLUTE}isRowRelative(){return this.type===Un.RELATIVE}isAbsolute(){return this.type===Un.ABSOLUTE&&this.sheet!==void 0}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new Gr(this.type,this.row+r,i)}shiftedByRows(e){return new Gr(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=fo(this,e);let r=this.row;return this.isRowRelative()&&(r=e.row+this.row),cj(t,r)}shiftRelativeDimensions(e,t){const r=this.isRowRelative()?this.row+t:this.row;return new Gr(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isRowAbsolute()?this.row+t:this.row;return new Gr(this.type,r,this.sheet)}withSheet(e){return new Gr(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Un.RELATIVE:return`${t}#ROWR${this.row}`;case Un.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);return Pwe(t)?void 0:`${this.type===Un.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}var Gt;(function(n){n.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",n.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",n.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",n.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(Gt||(Gt={}));class nn{constructor(e,t,r,i){this.col=e,this.row=t,this.type=r,this.sheet=i}static fromColAndRow(e,t,r){return(e.isColumnAbsolute()&&t.isRowAbsolute()?nn.absolute.bind(this):e.isColumnAbsolute()?nn.absoluteCol.bind(this):t.isRowAbsolute()?nn.absoluteRow.bind(this):nn.relative.bind(this))(e.col,t.row,r)}static relative(e,t,r){return new nn(e,t,Gt.CELL_REFERENCE_RELATIVE,r)}static absolute(e,t,r){return new nn(e,t,Gt.CELL_REFERENCE_ABSOLUTE,r)}static absoluteCol(e,t,r){return new nn(e,t,Gt.CELL_REFERENCE_ABSOLUTE_COL,r)}static absoluteRow(e,t,r){return new nn(e,t,Gt.CELL_REFERENCE_ABSOLUTE_ROW,r)}toSimpleCellAddress(e){const t=fo(this,e);return this.type===Gt.CELL_REFERENCE_ABSOLUTE?Ce(t,this.col,this.row):this.type===Gt.CELL_REFERENCE_ABSOLUTE_ROW?Ce(t,e.col+this.col,this.row):this.type===Gt.CELL_REFERENCE_ABSOLUTE_COL?Ce(t,this.col,e.row+this.row):Ce(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?Un.RELATIVE:Un.ABSOLUTE;return new si(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?Un.RELATIVE:Un.ABSOLUTE;return new Gr(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=fo(this,e);let r=this.col;return this.isColumnRelative()&&(r+=e.col),dj(t,r)}toSimpleRowAddress(e){const t=fo(this,e);let r=this.row;return this.isRowRelative()&&(r+=e.row),cj(t,r)}isRowAbsolute(){return this.type===Gt.CELL_REFERENCE_ABSOLUTE||this.type===Gt.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===Gt.CELL_REFERENCE_ABSOLUTE||this.type===Gt.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===Gt.CELL_REFERENCE_RELATIVE||this.type===Gt.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===Gt.CELL_REFERENCE_RELATIVE||this.type===Gt.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===Gt.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}shiftedByRows(e){return new nn(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new nn(this.col+e,this.row,this.type,this.sheet)}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new nn(this.col+t,this.row+r,this.type,i)}withSheet(e){return new nn(this.col,this.row,this.type,e)}isInvalid(e){return _i(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const r=this.isColumnAbsolute()?this.col:this.col+e,i=this.isRowAbsolute()?this.row:this.row+t;return new nn(r,i,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnRelative()?this.col:this.col+e,i=this.isRowRelative()?this.row:this.row+t;return new nn(r,i,this.type,this.sheet)}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Gt.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case Gt.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case Gt.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case Gt.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if(_i(t))return;const r=dS(t.col),i=this.type===Gt.CELL_REFERENCE_ABSOLUTE||this.type===Gt.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===Gt.CELL_REFERENCE_ABSOLUTE||this.type===Gt.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${r}${i}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}const rp=":",ai="$",eme="\\s+",tme="[ \\t\\n\\r]+",cS="A-Za-zÀ-ʯ",MO=`${cS}0-9_.`,V$=`[${cS}0-9_]+`,nme="'(((?!').|'')*)'",rf=`(${V$}|${nme})!`,U$=`(${rf})?\\${ai}?[A-Za-z]+\\${ai}?[0-9]+`,JH=`(${rf})?\\${ai}?[A-Za-z]+`,eF=`(${rf})?\\${ai}?[0-9]+`,B$="[rR][0-9]*[cC][0-9]*",rme=`(${U$})[^${MO}]`,W$=`[${cS}_][${MO}]*`,ime=["0","1","2","3","4","5","6","7","8","9"],$$=[...Array.from(Array(26)).map((n,e)=>e+65),...Array.from(Array(26)).map((n,e)=>e+97),...Array.from(Array(496)).map((n,e)=>e+192)].map(n=>String.fromCharCode(n));const G$=new RegExp(`^(${rf})?(\\${ai}?)([A-Za-z]+)(\\${ai}?)([0-9]+)$`),sme=new RegExp(`^(${rf})?(\\${ai}?)([A-Za-z]+)$`),ome=new RegExp(`^(${rf})?(\\${ai}?)([0-9]+)$`),ame=new RegExp(`^${V$}$`),rd=(n,e,t)=>{const r=G$.exec(e),i=OO(r[6]);let s=fS(r,n);if(s===void 0)return;s===null&&(s=void 0);const o=Number(r[8])-1;return r[5]===ai&&r[7]===ai?nn.absolute(i,o,s):r[5]===ai?nn.absoluteCol(i,o-t.row,s):r[7]===ai?nn.absoluteRow(i-t.col,o,s):nn.relative(i-t.col,o-t.row,s)},Wy=(n,e,t)=>{const r=sme.exec(e);let i=fS(r,n);if(i===void 0)return;i===null&&(i=void 0);const s=OO(r[6]);return r[5]===ai?si.absolute(s,i):si.relative(s-t.col,i)},$y=(n,e,t)=>{const r=ome.exec(e);let i=fS(r,n);if(i===void 0)return;i===null&&(i=void 0);const s=Number(r[6])-1;return r[5]===ai?Gr.absolute(s,i):Gr.relative(s-t.row,i)},IN=(n,e,t)=>{const r=G$.exec(e);if(!r)return;const i=OO(r[6]);let s=fS(r,n);if(s===void 0)return;s===null&&(s=t);const o=Number(r[8])-1;return Ce(s,i,o)},lme=(n,e,t)=>{const r=e.split(rp);if(r.length!==2)return;const[i,s]=r,o=IN(n,i,t);if(o===void 0)return;const a=IN(n,s,o.sheet);if(a!==void 0&&o.sheet===a.sheet)return $N(o,a)},Gy=(n,e,t)=>{const r=dS(e.col),i=j$(e.sheet,n);if(i!==void 0)return t!==e.sheet?`${i}!${r}${e.row+1}`:`${r}${e.row+1}`},ume=(n,e,t)=>{const r=Gy(n,e.start,t),i=Gy(n,e.end,e.start.sheet);if(!(r===void 0||i===void 0))return`${r}${rp}${i}`};function OO(n){return n.length===1?n.toUpperCase().charCodeAt(0)-65:n.split("").reduce((e,t)=>e*26+(t.toUpperCase().charCodeAt(0)-64),0)-1}function dS(n){let e="";for(;n>=0;)e=String.fromCharCode(n%26+97)+e,n=Math.floor(n/26)-1;return e.toUpperCase()}function j$(n,e){let t=e(n);if(t!==void 0)return ame.test(t)?t:(t=t.replace(/'/g,"''"),`'${t}'`)}function fS(n,e){var t;let r=(t=n[3])!==null&&t!==void 0?t:n[2];return r?(r=r.replace(/''/g,"'"),e(r)):null}function rn(n){return n&&n.length===0}function yl(n){return n==null?[]:Object.keys(n)}function zr(n){for(var e=[],t=Object.keys(n),r=0;r<t.length;r++)e.push(n[t[r]]);return e}function hme(n,e){for(var t=[],r=yl(n),i=0;i<r.length;i++){var s=r[i];t.push(e.call(null,n[s],s))}return t}function Te(n,e){for(var t=[],r=0;r<n.length;r++)t.push(e.call(null,n[r],r));return t}function Li(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];Array.isArray(r)?e=e.concat(Li(r)):e.push(r)}return e}function Ns(n){return rn(n)?void 0:n[0]}function z$(n){var e=n&&n.length;return e?n[e-1]:void 0}function ze(n,e){if(Array.isArray(n))for(var t=0;t<n.length;t++)e.call(null,n[t],t);else if(xO(n))for(var r=yl(n),t=0;t<r.length;t++){var i=r[t],s=n[i];e.call(null,s,i)}else throw Error("non exhaustive match")}function ga(n){return typeof n=="string"}function Is(n){return n===void 0}function Cu(n){return n instanceof Function}function Or(n,e){return e===void 0&&(e=1),n.slice(e,n.length)}function Cg(n,e){return e===void 0&&(e=1),n.slice(0,n.length-e)}function bo(n,e){var t=[];if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];e.call(null,i)&&t.push(i)}return t}function Yh(n,e){return bo(n,function(t){return!e(t)})}function Ls(n,e){for(var t=Object.keys(n),r={},i=0;i<t.length;i++){var s=t[i],o=n[s];e(o)&&(r[s]=o)}return r}function je(n,e){return xO(n)?n.hasOwnProperty(e):!1}function cr(n,e){return Wd(n,function(t){return t===e})!==void 0}function Di(n){for(var e=[],t=0;t<n.length;t++)e.push(n[t]);return e}function ip(n){var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}function Wd(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(e.call(null,r))return r}}function cme(n,e){for(var t=[],r=0;r<n.length;r++){var i=n[r];e.call(null,i)&&t.push(i)}return t}function Pr(n,e,t){for(var r=Array.isArray(n),i=r?n:zr(n),s=r?[]:yl(n),o=t,a=0;a<i.length;a++)o=e.call(null,o,i[a],r?a:s[a]);return o}function sp(n){return Yh(n,function(e){return e==null})}function _O(n,e){e===void 0&&(e=function(r){return r});var t=[];return Pr(n,function(r,i){var s=e(i);return cr(t,s)?r:(t.push(s),r.concat(i))},[])}function uo(n){return Array.isArray(n)}function dl(n){return n instanceof RegExp}function xO(n){return n instanceof Object}function bs(n,e){for(var t=0;t<n.length;t++)if(!e(n[t],t))return!1;return!0}function mS(n,e){return Yh(n,function(t){return cr(e,t)})}function Y$(n,e){for(var t=0;t<n.length;t++)if(e(n[t]))return!0;return!1}function dme(n,e){for(var t=0;t<n.length;t++)if(n[t]===e)return t;return-1}function To(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++)for(var i=e[r],s=yl(i),o=0;o<s.length;o++){var a=s[o];n[a]=i[a]}return n}function fme(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++){var i=e[r];if(!Is(i))for(var s=yl(i),o=0;o<s.length;o++){var a=s[o];je(n,a)||(n[a]=i[a])}}return n}function gS(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return fme.apply(null,[{}].concat(n))}function K$(n,e){var t={};return ze(n,function(r){var i=e(r),s=t[i];s?s.push(r):t[i]=[r]}),t}function tF(n,e){for(var t=ip(n),r=yl(e),i=0;i<r.length;i++){var s=r[i],o=e[s];t[s]=o}return t}function gr(){}function nF(n){return n}function mme(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];e.push(r!==void 0?r:void 0)}return e}function MN(n){console&&console.error&&console.error("Error: "+n)}function PO(n){console&&console.warn&&console.warn("Warning: "+n)}function rF(){return typeof Map=="function"}function gme(n,e){e.forEach(function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach(function(i){if(i!=="constructor"){var s=Object.getOwnPropertyDescriptor(r,i);s&&(s.get||s.set)?Object.defineProperty(n.prototype,i,s):n.prototype[i]=t.prototype[i]}})})}function q$(n){function e(){}e.prototype=n;var t=new e;function r(){return typeof t.bar}return r(),r(),n}function jy(n){return n[n.length-1]}function X$(n){var e=new Date().getTime(),t=n(),r=new Date().getTime(),i=r-e;return{time:i,value:t}}var Ov={exports:{}},pme=Ov.exports,iF;function wme(){return iF||(iF=1,(function(n){(function(e,t){n.exports?n.exports=t():e.regexpToAst=t()})(typeof self<"u"?self:pme,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(p){this.idx=p.idx,this.input=p.input,this.groupIdx=p.groupIdx},e.prototype.pattern=function(p){this.idx=0,this.input=p,this.groupIdx=0,this.consumeChar("/");var v=this.disjunction();this.consumeChar("/");for(var y={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":a(y,"global");break;case"i":a(y,"ignoreCase");break;case"m":a(y,"multiLine");break;case"u":a(y,"unicode");break;case"y":a(y,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:y,value:v}},e.prototype.disjunction=function(){var p=[];for(p.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),p.push(this.alternative());return{type:"Disjunction",value:p}},e.prototype.alternative=function(){for(var p=[];this.isTerm();)p.push(this.term());return{type:"Alternative",value:p}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var p;switch(this.popChar()){case"=":p="Lookahead";break;case"!":p="NegativeLookahead";break}l(p);var v=this.disjunction();return this.consumeChar(")"),{type:p,value:v}}u()},e.prototype.quantifier=function(p){var v;switch(this.popChar()){case"*":v={atLeast:0,atMost:1/0};break;case"+":v={atLeast:1,atMost:1/0};break;case"?":v={atLeast:0,atMost:1};break;case"{":var y=this.integerIncludingZero();switch(this.popChar()){case"}":v={atLeast:y,atMost:y};break;case",":var C;this.isDigit()?(C=this.integerIncludingZero(),v={atLeast:y,atMost:C}):v={atLeast:y,atMost:1/0},this.consumeChar("}");break}if(p===!0&&v===void 0)return;l(v);break}if(!(p===!0&&v===void 0))return l(v),this.peekChar(0)==="?"?(this.consumeChar("?"),v.greedy=!1):v.greedy=!0,v.type="Quantifier",v},e.prototype.atom=function(){var p;switch(this.peekChar()){case".":p=this.dotAll();break;case"\\":p=this.atomEscape();break;case"[":p=this.characterClass();break;case"(":p=this.group();break}return p===void 0&&this.isPatternCharacter()&&(p=this.patternCharacter()),l(p),this.isQuantifier()&&(p.quantifier=this.quantifier()),p},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[s(`
`),s("\r"),s("\u2028"),s("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var p=this.positiveInteger();return{type:"GroupBackReference",value:p}},e.prototype.characterClassEscape=function(){var p,v=!1;switch(this.popChar()){case"d":p=c;break;case"D":p=c,v=!0;break;case"s":p=f;break;case"S":p=f,v=!0;break;case"w":p=d;break;case"W":p=d,v=!0;break}return l(p),{type:"Set",value:p,complement:v}},e.prototype.controlEscapeAtom=function(){var p;switch(this.popChar()){case"f":p=s("\f");break;case"n":p=s(`
`);break;case"r":p=s("\r");break;case"t":p=s("	");break;case"v":p=s("\v");break}return l(p),{type:"Character",value:p}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var p=this.popChar();if(/[a-zA-Z]/.test(p)===!1)throw Error("Invalid ");var v=p.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:v}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:s("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var p=this.popChar();return{type:"Character",value:s(p)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var p=this.popChar();return{type:"Character",value:s(p)}}},e.prototype.characterClass=function(){var p=[],v=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),v=!0);this.isClassAtom();){var y=this.classAtom(),C=y.type==="Character";if(C&&this.isRangeDash()){this.consumeChar("-");var R=this.classAtom(),A=R.type==="Character";if(A){if(R.value<y.value)throw Error("Range out of order in character class");p.push({from:y.value,to:R.value})}else o(y.value,p),p.push(s("-")),o(R.value,p)}else o(y.value,p)}return this.consumeChar("]"),{type:"Set",complement:v,value:p}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:s("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var p=!0;this.consumeChar("("),this.peekChar(0)==="?"?(this.consumeChar("?"),this.consumeChar(":"),p=!1):this.groupIdx++;var v=this.disjunction();this.consumeChar(")");var y={type:"Group",capturing:p,value:v};return p&&(y.idx=this.groupIdx),y},e.prototype.positiveInteger=function(){var p=this.popChar();if(i.test(p)===!1)throw Error("Expecting a positive integer");for(;r.test(this.peekChar(0));)p+=this.popChar();return parseInt(p,10)},e.prototype.integerIncludingZero=function(){var p=this.popChar();if(r.test(p)===!1)throw Error("Expecting an integer");for(;r.test(this.peekChar(0));)p+=this.popChar();return parseInt(p,10)},e.prototype.patternCharacter=function(){var p=this.popChar();switch(p){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:s(p)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return r.test(this.peekChar(0))},e.prototype.isClassAtom=function(p){switch(p===void 0&&(p=0),this.peekChar(p)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var p=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(p)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(p){for(var v="",y=0;y<p;y++){var C=this.popChar();if(t.test(C)===!1)throw Error("Expecting a HexDecimal digits");v+=C}var R=parseInt(v,16);return{type:"Character",value:R}},e.prototype.peekChar=function(p){return p===void 0&&(p=0),this.input[this.idx+p]},e.prototype.popChar=function(){var p=this.peekChar(0);return this.consumeChar(),p},e.prototype.consumeChar=function(p){if(p!==void 0&&this.input[this.idx]!==p)throw Error("Expected: '"+p+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t=/[0-9a-fA-F]/,r=/[0-9]/,i=/[1-9]/;function s(p){return p.charCodeAt(0)}function o(p,v){p.length!==void 0?p.forEach(function(y){v.push(y)}):v.push(p)}function a(p,v){if(p[v]===!0)throw"duplicate flag "+v;p[v]=!0}function l(p){if(p===void 0)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}var h,c=[];for(h=s("0");h<=s("9");h++)c.push(h);var d=[s("_")].concat(c);for(h=s("a");h<=s("z");h++)d.push(h);for(h=s("A");h<=s("Z");h++)d.push(h);var f=[s(" "),s("\f"),s(`
`),s("\r"),s("	"),s("\v"),s("	"),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s("\u2028"),s("\u2029"),s(" "),s(" "),s("　"),s("\uFEFF")];function m(){}return m.prototype.visitChildren=function(p){for(var v in p){var y=p[v];p.hasOwnProperty(v)&&(y.type!==void 0?this.visit(y):Array.isArray(y)&&y.forEach(function(C){this.visit(C)},this))}},m.prototype.visit=function(p){switch(p.type){case"Pattern":this.visitPattern(p);break;case"Flags":this.visitFlags(p);break;case"Disjunction":this.visitDisjunction(p);break;case"Alternative":this.visitAlternative(p);break;case"StartAnchor":this.visitStartAnchor(p);break;case"EndAnchor":this.visitEndAnchor(p);break;case"WordBoundary":this.visitWordBoundary(p);break;case"NonWordBoundary":this.visitNonWordBoundary(p);break;case"Lookahead":this.visitLookahead(p);break;case"NegativeLookahead":this.visitNegativeLookahead(p);break;case"Character":this.visitCharacter(p);break;case"Set":this.visitSet(p);break;case"Group":this.visitGroup(p);break;case"GroupBackReference":this.visitGroupBackReference(p);break;case"Quantifier":this.visitQuantifier(p);break}this.visitChildren(p)},m.prototype.visitPattern=function(p){},m.prototype.visitFlags=function(p){},m.prototype.visitDisjunction=function(p){},m.prototype.visitAlternative=function(p){},m.prototype.visitStartAnchor=function(p){},m.prototype.visitEndAnchor=function(p){},m.prototype.visitWordBoundary=function(p){},m.prototype.visitNonWordBoundary=function(p){},m.prototype.visitLookahead=function(p){},m.prototype.visitNegativeLookahead=function(p){},m.prototype.visitCharacter=function(p){},m.prototype.visitSet=function(p){},m.prototype.visitGroup=function(p){},m.prototype.visitGroupBackReference=function(p){},m.prototype.visitQuantifier=function(p){},{RegExpParser:e,BaseRegExpVisitor:m,VERSION:"0.4.0"}})})(Ov)),Ov.exports}var op=wme(),_v={},vme=new op.RegExpParser;function pS(n){var e=n.toString();if(_v.hasOwnProperty(e))return _v[e];var t=vme.pattern(e);return _v[e]=t,t}function yme(){_v={}}var Cme=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),Q$="Complement Sets are not supported for first char optimization",zy=`Unable to use "first char" lexer optimizations:
`;function Sme(n,e){e===void 0&&(e=!1);try{var t=pS(n),r=ON(t.value,{},t.flags.ignoreCase);return r}catch(s){if(s.message===Q$)e&&PO(""+zy+("	Unable to optimize: < "+n.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var i="";e&&(i=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),MN(zy+`
`+("	Failed parsing: < "+n.toString()+` >
`)+("	Using the regexp-to-ast library version: "+op.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+i)}}return[]}function ON(n,e,t){switch(n.type){case"Disjunction":for(var r=0;r<n.value.length;r++)ON(n.value[r],e,t);break;case"Alternative":for(var i=n.value,r=0;r<i.length;r++){var s=i[r];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var o=s;switch(o.type){case"Character":jw(o.value,e,t);break;case"Set":if(o.complement===!0)throw Error(Q$);ze(o.value,function(u){if(typeof u=="number")jw(u,e,t);else{var h=u;if(t===!0)for(var c=h.from;c<=h.to;c++)jw(c,e,t);else{for(var c=h.from;c<=h.to&&c<gm;c++)jw(c,e,t);if(h.to>=gm)for(var d=h.from>=gm?h.from:gm,f=h.to,m=gu(d),p=gu(f),v=m;v<=p;v++)e[v]=v}}});break;case"Group":ON(o.value,e,t);break;default:throw Error("Non Exhaustive Match")}var a=o.quantifier!==void 0&&o.quantifier.atLeast===0;if(o.type==="Group"&&_N(o)===!1||o.type!=="Group"&&a===!1)break}break;default:throw Error("non exhaustive match!")}return zr(e)}function jw(n,e,t){var r=gu(n);e[r]=r,t===!0&&Rme(n,e)}function Rme(n,e){var t=String.fromCharCode(n),r=t.toUpperCase();if(r!==t){var i=gu(r.charCodeAt(0));e[i]=i}else{var s=t.toLowerCase();if(s!==t){var i=gu(s.charCodeAt(0));e[i]=i}}}function sF(n,e){return Wd(n.value,function(t){if(typeof t=="number")return cr(e,t);var r=t;return Wd(e,function(i){return r.from<=i&&i<=r.to})!==void 0})}function _N(n){return n.quantifier&&n.quantifier.atLeast===0?!0:n.value?uo(n.value)?bs(n.value,_N):_N(n.value):!1}var Eme=(function(n){Cme(e,n);function e(t){var r=n.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return e.prototype.visitChildren=function(t){if(this.found!==!0){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}n.prototype.visitChildren.call(this,t)}},e.prototype.visitCharacter=function(t){cr(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?sF(t,this.targetCharCodes)===void 0&&(this.found=!0):sF(t,this.targetCharCodes)!==void 0&&(this.found=!0)},e})(op.BaseRegExpVisitor);function LO(n,e){if(e instanceof RegExp){var t=pS(e),r=new Eme(n);return r.visit(t),r.found}else return Wd(e,function(i){return cr(n,i.charCodeAt(0))})!==void 0}var Z$=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),pa="PATTERN",Ph="defaultMode",zw="modes",J$=typeof new RegExp("(?:)").sticky=="boolean";function bme(n,e){e=gS(e,{useSticky:J$,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(C,R){return R()}});var t=e.tracer;t("initCharCodeToOptimizedIndexMap",function(){Yme()});var r;t("Reject Lexer.NA",function(){r=Yh(n,function(C){return C[pa]===Pi.NA})});var i=!1,s;t("Transform Patterns",function(){i=!1,s=Te(r,function(C){var R=C[pa];if(dl(R)){var A=R.source;return A.length===1&&A!=="^"&&A!=="$"&&A!=="."?A:A.length===2&&A[0]==="\\"&&!cr(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],A[1])?A[1]:e.useSticky?aF(R):oF(R)}else{if(Cu(R))return i=!0,{exec:R};if(je(R,"exec"))return i=!0,R;if(typeof R=="string"){if(R.length===1)return R;var I=R.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),H=new RegExp(I);return e.useSticky?aF(H):oF(H)}else throw Error("non exhaustive match")}})});var o,a,l,u,h;t("misc mapping",function(){o=Te(r,function(C){return C.tokenTypeIdx}),a=Te(r,function(C){var R=C.GROUP;if(R!==Pi.SKIPPED){if(ga(R))return R;if(Is(R))return!1;throw Error("non exhaustive match")}}),l=Te(r,function(C){var R=C.LONGER_ALT;if(R){var A=dme(r,R);return A}}),u=Te(r,function(C){return C.PUSH_MODE}),h=Te(r,function(C){return je(C,"POP_MODE")})});var c;t("Line Terminator Handling",function(){var C=nG(e.lineTerminatorCharacters);c=Te(r,function(R){return!1}),e.positionTracking!=="onlyOffset"&&(c=Te(r,function(R){if(je(R,"LINE_BREAKS"))return R.LINE_BREAKS;if(tG(R,C)===!1)return LO(C,R.PATTERN)}))});var d,f,m,p;t("Misc Mapping #2",function(){d=Te(r,eG),f=Te(s,Gme),m=Pr(r,function(C,R){var A=R.GROUP;return ga(A)&&A!==Pi.SKIPPED&&(C[A]=[]),C},{}),p=Te(s,function(C,R){return{pattern:s[R],longerAlt:l[R],canLineTerminator:c[R],isCustom:d[R],short:f[R],group:a[R],push:u[R],pop:h[R],tokenTypeIdx:o[R],tokenType:r[R]}})});var v=!0,y=[];return e.safeMode||t("First Char Optimization",function(){y=Pr(r,function(C,R,A){if(typeof R.PATTERN=="string"){var I=R.PATTERN.charCodeAt(0),H=gu(I);uA(C,H,p[A])}else if(uo(R.START_CHARS_HINT)){var k;ze(R.START_CHARS_HINT,function(z){var G=typeof z=="string"?z.charCodeAt(0):z,q=gu(G);k!==q&&(k=q,uA(C,q,p[A]))})}else if(dl(R.PATTERN))if(R.PATTERN.unicode)v=!1,e.ensureOptimizations&&MN(""+zy+("	Unable to analyze < "+R.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var W=Sme(R.PATTERN,e.ensureOptimizations);rn(W)&&(v=!1),ze(W,function(z){uA(C,z,p[A])})}else e.ensureOptimizations&&MN(""+zy+("	TokenType: <"+R.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),v=!1;return C},[])}),t("ArrayPacking",function(){y=mme(y)}),{emptyGroups:m,patternIdxToConfig:p,charCodeToPatternIdxToConfig:y,hasCustom:i,canBeOptimized:v}}function Tme(n,e){var t=[],r=Nme(n);t=t.concat(r.errors);var i=Ime(r.valid),s=i.valid;return t=t.concat(i.errors),t=t.concat(Ame(s)),t=t.concat(Hme(s)),t=t.concat(Fme(s,e)),t=t.concat(kme(s)),t}function Ame(n){var e=[],t=bo(n,function(r){return dl(r[pa])});return e=e.concat(Ome(t)),e=e.concat(Pme(t)),e=e.concat(Lme(t)),e=e.concat(Dme(t)),e=e.concat(_me(t)),e}function Nme(n){var e=bo(n,function(i){return!je(i,pa)}),t=Te(e,function(i){return{message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:qn.MISSING_PATTERN,tokenTypes:[i]}}),r=mS(n,e);return{errors:t,valid:r}}function Ime(n){var e=bo(n,function(i){var s=i[pa];return!dl(s)&&!Cu(s)&&!je(s,"exec")&&!ga(s)}),t=Te(e,function(i){return{message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:qn.INVALID_PATTERN,tokenTypes:[i]}}),r=mS(n,e);return{errors:t,valid:r}}var Mme=/[^\\][\$]/;function Ome(n){var e=(function(i){Z$(s,i);function s(){var o=i!==null&&i.apply(this,arguments)||this;return o.found=!1,o}return s.prototype.visitEndAnchor=function(o){this.found=!0},s})(op.BaseRegExpVisitor),t=bo(n,function(i){var s=i[pa];try{var o=pS(s),a=new e;return a.visit(o),a.found}catch{return Mme.test(s.source)}}),r=Te(t,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:qn.EOI_ANCHOR_FOUND,tokenTypes:[i]}});return r}function _me(n){var e=bo(n,function(r){var i=r[pa];return i.test("")}),t=Te(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:qn.EMPTY_MATCH_PATTERN,tokenTypes:[r]}});return t}var xme=/[^\\[][\^]|^\^/;function Pme(n){var e=(function(i){Z$(s,i);function s(){var o=i!==null&&i.apply(this,arguments)||this;return o.found=!1,o}return s.prototype.visitStartAnchor=function(o){this.found=!0},s})(op.BaseRegExpVisitor),t=bo(n,function(i){var s=i[pa];try{var o=pS(s),a=new e;return a.visit(o),a.found}catch{return xme.test(s.source)}}),r=Te(t,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:qn.SOI_ANCHOR_FOUND,tokenTypes:[i]}});return r}function Lme(n){var e=bo(n,function(r){var i=r[pa];return i instanceof RegExp&&(i.multiline||i.global)}),t=Te(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:qn.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}});return t}function Dme(n){var e=[],t=Te(n,function(s){return Pr(n,function(o,a){return s.PATTERN.source===a.PATTERN.source&&!cr(e,a)&&a.PATTERN!==Pi.NA&&(e.push(a),o.push(a)),o},[])});t=sp(t);var r=bo(t,function(s){return s.length>1}),i=Te(r,function(s){var o=Te(s,function(l){return l.name}),a=Ns(s).PATTERN;return{message:"The same RegExp pattern ->"+a+"<-"+("has been used in all of the following Token Types: "+o.join(", ")+" <-"),type:qn.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}});return i}function Hme(n){var e=bo(n,function(r){if(!je(r,"GROUP"))return!1;var i=r.GROUP;return i!==Pi.SKIPPED&&i!==Pi.NA&&!ga(i)}),t=Te(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:qn.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}});return t}function Fme(n,e){var t=bo(n,function(i){return i.PUSH_MODE!==void 0&&!cr(e,i.PUSH_MODE)}),r=Te(t,function(i){var s="Token Type: ->"+i.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+i.PUSH_MODE+"<-which does not exist";return{message:s,type:qn.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}});return r}function kme(n){var e=[],t=Pr(n,function(r,i,s){var o=i.PATTERN;return o===Pi.NA||(ga(o)?r.push({str:o,idx:s,tokenType:i}):dl(o)&&Ume(o)&&r.push({str:o.source,idx:s,tokenType:i})),r},[]);return ze(n,function(r,i){ze(t,function(s){var o=s.str,a=s.idx,l=s.tokenType;if(i<a&&Vme(o,r.PATTERN)){var u="Token: ->"+l.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+r.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:u,type:qn.UNREACHABLE_PATTERN,tokenTypes:[r,l]})}})}),e}function Vme(n,e){if(dl(e)){var t=e.exec(n);return t!==null&&t.index===0}else{if(Cu(e))return e(n,0,[],{});if(je(e,"exec"))return e.exec(n,0,[],{});if(typeof e=="string")return e===n;throw Error("non exhaustive match")}}function Ume(n){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return Wd(e,function(t){return n.source.indexOf(t)!==-1})===void 0}function oF(n){var e=n.ignoreCase?"i":"";return new RegExp("^(?:"+n.source+")",e)}function aF(n){var e=n.ignoreCase?"iy":"y";return new RegExp(""+n.source,e)}function Bme(n,e,t){var r=[];return je(n,Ph)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Ph+`> property in its definition
`,type:qn.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),je(n,zw)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+zw+`> property in its definition
`,type:qn.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),je(n,zw)&&je(n,Ph)&&!je(n.modes,n.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a "+Ph+": <"+n.defaultMode+`>which does not exist
`,type:qn.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),je(n,zw)&&ze(n.modes,function(i,s){ze(i,function(o,a){Is(o)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+s+"> at index: <"+a+`>
`),type:qn.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),r}function Wme(n,e,t){var r=[],i=!1,s=sp(Li(hme(n.modes,function(l){return l}))),o=Yh(s,function(l){return l[pa]===Pi.NA}),a=nG(t);return e&&ze(o,function(l){var u=tG(l,a);if(u!==!1){var h=zme(l,u),c={message:h,type:u.issue,tokenType:l};r.push(c)}else je(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(i=!0):LO(a,l.PATTERN)&&(i=!0)}),e&&!i&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:qn.NO_LINE_BREAKS_FLAGS}),r}function $me(n){var e={},t=yl(n);return ze(t,function(r){var i=n[r];if(uo(i))e[r]=[];else throw Error("non exhaustive match")}),e}function eG(n){var e=n.PATTERN;if(dl(e))return!1;if(Cu(e))return!0;if(je(e,"exec"))return!0;if(ga(e))return!1;throw Error("non exhaustive match")}function Gme(n){return ga(n)&&n.length===1?n.charCodeAt(0):!1}var jme={test:function(n){for(var e=n.length,t=this.lastIndex;t<e;t++){var r=n.charCodeAt(t);if(r===10)return this.lastIndex=t+1,!0;if(r===13)return n.charCodeAt(t+1)===10?this.lastIndex=t+2:this.lastIndex=t+1,!0}return!1},lastIndex:0};function tG(n,e){if(je(n,"LINE_BREAKS"))return!1;if(dl(n.PATTERN)){try{LO(e,n.PATTERN)}catch(t){return{issue:qn.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}else{if(ga(n.PATTERN))return!1;if(eG(n))return{issue:qn.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function zme(n,e){if(e.issue===qn.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+n.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===qn.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+n.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function nG(n){var e=Te(n,function(t){return ga(t)&&t.length>0?t.charCodeAt(0):t});return e}function uA(n,e,t){n[e]===void 0?n[e]=[t]:n[e].push(t)}var gm=256;function gu(n){return n<gm?n:xv[n]}var xv=[];function Yme(){if(rn(xv)){xv=new Array(65536);for(var n=0;n<65536;n++)xv[n]=n>255?255+~~(n/255):n}}function wS(n,e){var t=n.tokenTypeIdx;return t===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[t]===!0}function Yy(n,e){return n.tokenTypeIdx===e.tokenTypeIdx}var lF=1,rG={};function ap(n){var e=Kme(n);qme(e),Qme(e),Xme(e),ze(e,function(t){t.isParent=t.categoryMatches.length>0})}function Kme(n){for(var e=Di(n),t=n,r=!0;r;){t=sp(Li(Te(t,function(s){return s.CATEGORIES})));var i=mS(t,e);e=e.concat(i),rn(i)?r=!1:t=i}return e}function qme(n){ze(n,function(e){sG(e)||(rG[lF]=e,e.tokenTypeIdx=lF++),uF(e)&&!uo(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),uF(e)||(e.CATEGORIES=[]),Zme(e)||(e.categoryMatches=[]),Jme(e)||(e.categoryMatchesMap={})})}function Xme(n){ze(n,function(e){e.categoryMatches=[],ze(e.categoryMatchesMap,function(t,r){e.categoryMatches.push(rG[r].tokenTypeIdx)})})}function Qme(n){ze(n,function(e){iG([],e)})}function iG(n,e){ze(n,function(t){e.categoryMatchesMap[t.tokenTypeIdx]=!0}),ze(e.CATEGORIES,function(t){var r=n.concat(e);cr(r,t)||iG(r,t)})}function sG(n){return je(n,"tokenTypeIdx")}function uF(n){return je(n,"CATEGORIES")}function Zme(n){return je(n,"categoryMatches")}function Jme(n){return je(n,"categoryMatchesMap")}function ege(n){return je(n,"tokenTypeIdx")}var tge={buildUnableToPopLexerModeMessage:function(n){return"Unable to pop Lexer Mode after encountering Token ->"+n.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(n,e,t,r,i){return"unexpected character: ->"+n.charAt(e)+"<- at offset: "+e+","+(" skipped "+t+" characters.")}},qn;(function(n){n[n.MISSING_PATTERN=0]="MISSING_PATTERN",n[n.INVALID_PATTERN=1]="INVALID_PATTERN",n[n.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",n[n.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",n[n.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",n[n.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",n[n.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",n[n.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",n[n.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",n[n.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",n[n.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",n[n.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",n[n.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",n[n.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",n[n.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",n[n.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",n[n.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(qn||(qn={}));var pm={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:tge,traceInitPerf:!1,skipValidations:!1};Object.freeze(pm);var Pi=(function(){function n(e,t){var r=this;if(t===void 0&&(t=pm),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof t=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=tF(pm,t);var i=this.config.traceInitPerf;i===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof i=="number"&&(this.traceInitMaxIdent=i,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var s,o=!0;r.TRACE_INIT("Lexer Config handling",function(){if(r.config.lineTerminatorsPattern===pm.lineTerminatorsPattern)r.config.lineTerminatorsPattern=jme;else if(r.config.lineTerminatorCharacters===pm.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),uo(e)?(s={modes:{}},s.modes[Ph]=Di(e),s[Ph]=Ph):(o=!1,s=ip(e))}),r.config.skipValidations===!1&&(r.TRACE_INIT("performRuntimeChecks",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Bme(s,r.trackStartLines,r.config.lineTerminatorCharacters))}),r.TRACE_INIT("performWarningRuntimeChecks",function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(Wme(s,r.trackStartLines,r.config.lineTerminatorCharacters))})),s.modes=s.modes?s.modes:{},ze(s.modes,function(h,c){s.modes[c]=Yh(h,function(d){return Is(d)})});var a=yl(s.modes);if(ze(s.modes,function(h,c){r.TRACE_INIT("Mode: <"+c+"> processing",function(){if(r.modes.push(c),r.config.skipValidations===!1&&r.TRACE_INIT("validatePatterns",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Tme(h,a))}),rn(r.lexerDefinitionErrors)){ap(h);var d;r.TRACE_INIT("analyzeTokenTypes",function(){d=bme(h,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:r.TRACE_INIT.bind(r)})}),r.patternIdxToConfig[c]=d.patternIdxToConfig,r.charCodeToPatternIdxToConfig[c]=d.charCodeToPatternIdxToConfig,r.emptyGroups=tF(r.emptyGroups,d.emptyGroups),r.hasCustom=d.hasCustom||r.hasCustom,r.canModeBeOptimized[c]=d.canBeOptimized}})}),r.defaultMode=s.defaultMode,!rn(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var l=Te(r.lexerDefinitionErrors,function(h){return h.message}),u=l.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}ze(r.lexerDefinitionWarning,function(h){PO(h.message)}),r.TRACE_INIT("Choosing sub-methods implementations",function(){if(J$?(r.chopInput=nF,r.match=r.matchWithTest):(r.updateLastIndex=gr,r.match=r.matchWithExec),o&&(r.handleModes=gr),r.trackStartLines===!1&&(r.computeNewColumn=nF),r.trackEndLines===!1&&(r.updateTokenEndLineColumnLocation=gr),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else if(/onlyOffset/i.test(r.config.positionTracking))r.createTokenInstance=r.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)}),r.TRACE_INIT("Failed Optimization Warnings",function(){var h=Pr(r.canModeBeOptimized,function(c,d,f){return d===!1&&c.push(f),c},[]);if(t.ensureOptimizations&&!rn(h))throw Error("Lexer Modes: < "+h.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),r.TRACE_INIT("clearRegExpParserCache",function(){yme()}),r.TRACE_INIT("toFastProperties",function(){q$(r)})})}return n.prototype.tokenize=function(e,t){if(t===void 0&&(t=this.defaultMode),!rn(this.lexerDefinitionErrors)){var r=Te(this.lexerDefinitionErrors,function(o){return o.message}),i=r.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}var s=this.tokenizeInternal(e,t);return s},n.prototype.tokenizeInternal=function(e,t){var r=this,i,s,o,a,l,u,h,c,d,f,m,p,v,y,C=e,R=C.length,A=0,I=0,H=this.hasCustom?0:Math.floor(e.length/10),k=new Array(H),W=[],z=this.trackStartLines?1:void 0,G=this.trackStartLines?1:void 0,q=$me(this.emptyGroups),J=this.trackStartLines,re=this.config.lineTerminatorsPattern,ie=0,ae=[],Ke=[],xe=[],Se=[];Object.freeze(Se);var ve=void 0;function He(){return ae}function w(T){var O=gu(T),P=Ke[O];return P===void 0?Se:P}var S=function(T){if(xe.length===1&&T.tokenType.PUSH_MODE===void 0){var O=r.config.errorMessageProvider.buildUnableToPopLexerModeMessage(T);W.push({offset:T.startOffset,line:T.startLine!==void 0?T.startLine:void 0,column:T.startColumn!==void 0?T.startColumn:void 0,length:T.image.length,message:O})}else{xe.pop();var P=z$(xe);ae=r.patternIdxToConfig[P],Ke=r.charCodeToPatternIdxToConfig[P],ie=ae.length;var Y=r.canModeBeOptimized[P]&&r.config.safeMode===!1;Ke&&Y?ve=w:ve=He}};function b(T){xe.push(T),Ke=this.charCodeToPatternIdxToConfig[T],ae=this.patternIdxToConfig[T],ie=ae.length,ie=ae.length;var O=this.canModeBeOptimized[T]&&this.config.safeMode===!1;Ke&&O?ve=w:ve=He}b.call(this,t);for(var x;A<R;){l=null;var L=C.charCodeAt(A),$=ve(L),ee=$.length;for(i=0;i<ee;i++){x=$[i];var ne=x.pattern;u=null;var he=x.short;if(he!==!1?L===he&&(l=ne):x.isCustom===!0?(y=ne.exec(C,A,k,q),y!==null?(l=y[0],y.payload!==void 0&&(u=y.payload)):l=null):(this.updateLastIndex(ne,A),l=this.match(ne,e,A)),l!==null){if(a=x.longerAlt,a!==void 0){var we=ae[a],le=we.pattern;h=null,we.isCustom===!0?(y=le.exec(C,A,k,q),y!==null?(o=y[0],y.payload!==void 0&&(h=y.payload)):o=null):(this.updateLastIndex(le,A),o=this.match(le,e,A)),o&&o.length>l.length&&(l=o,u=h,x=we)}break}}if(l!==null){if(c=l.length,d=x.group,d!==void 0&&(f=x.tokenTypeIdx,m=this.createTokenInstance(l,A,f,x.tokenType,z,G,c),this.handlePayload(m,u),d===!1?I=this.addToken(k,I,m):q[d].push(m)),e=this.chopInput(e,c),A=A+c,G=this.computeNewColumn(G,c),J===!0&&x.canLineTerminator===!0){var $e=0,Be=void 0,Q=void 0;re.lastIndex=0;do Be=re.test(l),Be===!0&&(Q=re.lastIndex-1,$e++);while(Be===!0);$e!==0&&(z=z+$e,G=c-Q,this.updateTokenEndLineColumnLocation(m,d,Q,$e,z,G,c))}this.handleModes(x,S,b,m)}else{for(var Je=A,nt=z,wt=G,et=!1;!et&&A<R;)for(C.charCodeAt(A),e=this.chopInput(e,1),A++,s=0;s<ie;s++){var ke=ae[s],ne=ke.pattern,he=ke.short;if(he!==!1?C.charCodeAt(A)===he&&(et=!0):ke.isCustom===!0?et=ne.exec(C,A,k,q)!==null:(this.updateLastIndex(ne,A),et=ne.exec(e)!==null),et===!0)break}p=A-Je,v=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(C,Je,p,nt,wt),W.push({offset:Je,line:nt,column:wt,length:p,message:v})}}return this.hasCustom||(k.length=I),{tokens:k,groups:q,errors:W}},n.prototype.handleModes=function(e,t,r,i){if(e.pop===!0){var s=e.push;t(i),s!==void 0&&r.call(this,s)}else e.push!==void 0&&r.call(this,e.push)},n.prototype.chopInput=function(e,t){return e.substring(t)},n.prototype.updateLastIndex=function(e,t){e.lastIndex=t},n.prototype.updateTokenEndLineColumnLocation=function(e,t,r,i,s,o,a){var l,u;t!==void 0&&(l=r===a-1,u=l?-1:0,i===1&&l===!0||(e.endLine=s+u,e.endColumn=o-1+-u))},n.prototype.computeNewColumn=function(e,t){return e+t},n.prototype.createTokenInstance=function(){return null},n.prototype.createOffsetOnlyToken=function(e,t,r,i){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:i}},n.prototype.createStartOnlyToken=function(e,t,r,i,s,o){return{image:e,startOffset:t,startLine:s,startColumn:o,tokenTypeIdx:r,tokenType:i}},n.prototype.createFullToken=function(e,t,r,i,s,o,a){return{image:e,startOffset:t,endOffset:t+a-1,startLine:s,endLine:s,startColumn:o,endColumn:o+a-1,tokenTypeIdx:r,tokenType:i}},n.prototype.addToken=function(e,t,r){return 666},n.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},n.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,t++,t},n.prototype.handlePayload=function(e,t){},n.prototype.handlePayloadNoCustom=function(e,t){},n.prototype.handlePayloadWithCustom=function(e,t){t!==null&&(e.payload=t)},n.prototype.match=function(e,t,r){return null},n.prototype.matchWithTest=function(e,t,r){var i=e.test(t);return i===!0?t.substring(r,e.lastIndex):null},n.prototype.matchWithExec=function(e,t){var r=e.exec(t);return r!==null?r[0]:r},n.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var i=X$(t),s=i.time,o=i.value,a=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(r+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,o}else return t()},n.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",n.NA=/NOT_APPLICABLE/,n})();function Nd(n){return oG(n)?n.LABEL:n.name}function oG(n){return ga(n.LABEL)&&n.LABEL!==""}var nge="parent",hF="categories",cF="label",dF="group",fF="push_mode",mF="pop_mode",gF="longer_alt",pF="line_breaks",wF="start_chars_hint";function It(n){return rge(n)}function rge(n){var e=n.pattern,t={};if(t.name=n.name,Is(e)||(t.PATTERN=e),je(n,nge))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return je(n,hF)&&(t.CATEGORIES=n[hF]),ap([t]),je(n,cF)&&(t.LABEL=n[cF]),je(n,dF)&&(t.GROUP=n[dF]),je(n,mF)&&(t.POP_MODE=n[mF]),je(n,fF)&&(t.PUSH_MODE=n[fF]),je(n,gF)&&(t.LONGER_ALT=n[gF]),je(n,pF)&&(t.LINE_BREAKS=n[pF]),je(n,wF)&&(t.START_CHARS_HINT=n[wF]),t}var Kh=It({name:"EOF",pattern:Pi.NA});ap([Kh]);function DO(n,e,t,r,i,s,o,a){return{image:e,startOffset:t,endOffset:r,startLine:i,endLine:s,startColumn:o,endColumn:a,tokenTypeIdx:n.tokenTypeIdx,tokenType:n}}function Qt(n,e){return wS(n,e)}var Cl=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),Sa=(function(){function n(e){this.definition=e}return n.prototype.accept=function(e){e.visit(this),ze(this.definition,function(t){t.accept(e)})},n})(),Zi=(function(n){Cl(e,n);function e(t){var r=n.call(this,[])||this;return r.idx=1,To(r,Ls(t,function(i){return i!==void 0})),r}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e})(Sa),sf=(function(n){Cl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.orgText="",To(r,Ls(t,function(i){return i!==void 0})),r}return e})(Sa),Hi=(function(n){Cl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.ignoreAmbiguities=!1,To(r,Ls(t,function(i){return i!==void 0})),r}return e})(Sa),xr=(function(n){Cl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,To(r,Ls(t,function(i){return i!==void 0})),r}return e})(Sa),Ms=(function(n){Cl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,To(r,Ls(t,function(i){return i!==void 0})),r}return e})(Sa),Os=(function(n){Cl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,To(r,Ls(t,function(i){return i!==void 0})),r}return e})(Sa),Yn=(function(n){Cl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,To(r,Ls(t,function(i){return i!==void 0})),r}return e})(Sa),Ji=(function(n){Cl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,To(r,Ls(t,function(i){return i!==void 0})),r}return e})(Sa),es=(function(n){Cl(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,To(r,Ls(t,function(i){return i!==void 0})),r}return e})(Sa),xn=(function(){function n(e){this.idx=1,To(this,Ls(e,function(t){return t!==void 0}))}return n.prototype.accept=function(e){e.visit(this)},n})();function ige(n){return Te(n,Pv)}function Pv(n){function e(i){return Te(i,Pv)}if(n instanceof Zi)return{type:"NonTerminal",name:n.nonTerminalName,idx:n.idx};if(n instanceof Hi)return{type:"Flat",definition:e(n.definition)};if(n instanceof xr)return{type:"Option",idx:n.idx,definition:e(n.definition)};if(n instanceof Ms)return{type:"RepetitionMandatory",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof Os)return{type:"RepetitionMandatoryWithSeparator",name:n.name,idx:n.idx,separator:Pv(new xn({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof Ji)return{type:"RepetitionWithSeparator",name:n.name,idx:n.idx,separator:Pv(new xn({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof Yn)return{type:"Repetition",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof es)return{type:"Alternation",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof xn){var t={type:"Terminal",name:n.terminalType.name,label:Nd(n.terminalType),idx:n.idx},r=n.terminalType.PATTERN;return n.terminalType.PATTERN&&(t.pattern=dl(r)?r.source:r),t}else{if(n instanceof sf)return{type:"Rule",name:n.name,orgText:n.orgText,definition:e(n.definition)};throw Error("non exhaustive match")}}var vS=(function(){function n(){}return n.prototype.walk=function(e,t){var r=this;t===void 0&&(t=[]),ze(e.definition,function(i,s){var o=Or(e.definition,s+1);if(i instanceof Zi)r.walkProdRef(i,o,t);else if(i instanceof xn)r.walkTerminal(i,o,t);else if(i instanceof Hi)r.walkFlat(i,o,t);else if(i instanceof xr)r.walkOption(i,o,t);else if(i instanceof Ms)r.walkAtLeastOne(i,o,t);else if(i instanceof Os)r.walkAtLeastOneSep(i,o,t);else if(i instanceof Ji)r.walkManySep(i,o,t);else if(i instanceof Yn)r.walkMany(i,o,t);else if(i instanceof es)r.walkOr(i,o,t);else throw Error("non exhaustive match")})},n.prototype.walkTerminal=function(e,t,r){},n.prototype.walkProdRef=function(e,t,r){},n.prototype.walkFlat=function(e,t,r){var i=t.concat(r);this.walk(e,i)},n.prototype.walkOption=function(e,t,r){var i=t.concat(r);this.walk(e,i)},n.prototype.walkAtLeastOne=function(e,t,r){var i=[new xr({definition:e.definition})].concat(t,r);this.walk(e,i)},n.prototype.walkAtLeastOneSep=function(e,t,r){var i=vF(e,t,r);this.walk(e,i)},n.prototype.walkMany=function(e,t,r){var i=[new xr({definition:e.definition})].concat(t,r);this.walk(e,i)},n.prototype.walkManySep=function(e,t,r){var i=vF(e,t,r);this.walk(e,i)},n.prototype.walkOr=function(e,t,r){var i=this,s=t.concat(r);ze(e.definition,function(o){var a=new Hi({definition:[o]});i.walk(a,s)})},n})();function vF(n,e,t){var r=[new xr({definition:[new xn({terminalType:n.separator})].concat(n.definition)})],i=r.concat(e,t);return i}var ac=(function(){function n(){}return n.prototype.visit=function(e){var t=e;switch(t.constructor){case Zi:return this.visitNonTerminal(t);case Hi:return this.visitFlat(t);case xr:return this.visitOption(t);case Ms:return this.visitRepetitionMandatory(t);case Os:return this.visitRepetitionMandatoryWithSeparator(t);case Ji:return this.visitRepetitionWithSeparator(t);case Yn:return this.visitRepetition(t);case es:return this.visitAlternation(t);case xn:return this.visitTerminal(t);case sf:return this.visitRule(t);default:throw Error("non exhaustive match")}},n.prototype.visitNonTerminal=function(e){},n.prototype.visitFlat=function(e){},n.prototype.visitOption=function(e){},n.prototype.visitRepetition=function(e){},n.prototype.visitRepetitionMandatory=function(e){},n.prototype.visitRepetitionMandatoryWithSeparator=function(e){},n.prototype.visitRepetitionWithSeparator=function(e){},n.prototype.visitAlternation=function(e){},n.prototype.visitTerminal=function(e){},n.prototype.visitRule=function(e){},n})(),sge=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})();function oge(n){return n instanceof Hi||n instanceof xr||n instanceof Yn||n instanceof Ms||n instanceof Os||n instanceof Ji||n instanceof xn||n instanceof sf}function Ky(n,e){e===void 0&&(e=[]);var t=n instanceof xr||n instanceof Yn||n instanceof Ji;return t?!0:n instanceof es?Y$(n.definition,function(r){return Ky(r,e)}):n instanceof Zi&&cr(e,n)?!1:n instanceof Sa?(n instanceof Zi&&e.push(n),bs(n.definition,function(r){return Ky(r,e)})):!1}function age(n){return n instanceof es}function io(n){if(n instanceof Zi)return"SUBRULE";if(n instanceof xr)return"OPTION";if(n instanceof es)return"OR";if(n instanceof Ms)return"AT_LEAST_ONE";if(n instanceof Os)return"AT_LEAST_ONE_SEP";if(n instanceof Ji)return"MANY_SEP";if(n instanceof Yn)return"MANY";if(n instanceof xn)return"CONSUME";throw Error("non exhaustive match")}var lge=(function(n){sge(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var r=t.terminalType.name+this.separator+"Terminal";je(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(t)},e.prototype.visitNonTerminal=function(t){var r=t.nonTerminalName+this.separator+"Terminal";je(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e})(ac),Yw=new lge;function uge(n){Yw.reset(),n.accept(Yw);var e=Yw.dslMethods;return Yw.reset(),e}function lp(n){if(n instanceof Zi)return lp(n.referencedRule);if(n instanceof xn)return dge(n);if(oge(n))return hge(n);if(age(n))return cge(n);throw Error("non exhaustive match")}function hge(n){for(var e=[],t=n.definition,r=0,i=t.length>r,s,o=!0;i&&o;)s=t[r],o=Ky(s),e=e.concat(lp(s)),r=r+1,i=t.length>r;return _O(e)}function cge(n){var e=Te(n.definition,function(t){return lp(t)});return _O(Li(e))}function dge(n){return[n.terminalType]}var aG="_~IN~_",fge=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),mge=(function(n){fge(e,n);function e(t){var r=n.call(this)||this;return r.topProd=t,r.follows={},r}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,r,i){},e.prototype.walkProdRef=function(t,r,i){var s=pge(t.referencedRule,t.idx)+this.topProd.name,o=r.concat(i),a=new Hi({definition:o}),l=lp(a);this.follows[s]=l},e})(vS);function gge(n){var e={};return ze(n,function(t){var r=new mge(t).startWalking();To(e,r)}),e}function pge(n,e){return n.name+e+aG}var wge=4,Su=8,vge=8,Id=1<<Su,qy=2<<Su,$m=3<<Su,Gm=4<<Su,jm=5<<Su,gd=6<<Su;function zm(n,e,t){return t|e|n}var yge=32-vge;function lG(n,e,t,r){var i=r+1<<yge;return zm(n,e,t)|i}var Cge=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})();function yF(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.endOffset=e.endOffset):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset)}function CF(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.startColumn=e.startColumn,n.startLine=e.startLine,n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine)}function Sge(n,e,t){n.children[t]===void 0?n.children[t]=[e]:n.children[t].push(e)}function SF(n,e,t){n.children[e]===void 0?n.children[e]=[t]:n.children[e].push(t)}var HO=(function(n){Cge(e,n);function e(t){var r=n.call(this)||this;return r.result=[],r.ruleIdx=t,r}return e.prototype.collectNamedDSLMethod=function(t,r,i){if(!Is(t.name)){var s=void 0;if(t instanceof xr||t instanceof Yn||t instanceof Ms||t instanceof es)s=new r({definition:t.definition,idx:t.idx});else if(t instanceof Os||t instanceof Ji)s=new r({definition:t.definition,idx:t.idx,separator:t.separator});else throw Error("non exhaustive match");var o=[s],a=zm(this.ruleIdx,i,t.idx);this.result.push({def:o,key:a,name:t.name,orgProd:t})}},e.prototype.visitOption=function(t){this.collectNamedDSLMethod(t,xr,qy)},e.prototype.visitRepetition=function(t){this.collectNamedDSLMethod(t,Yn,$m)},e.prototype.visitRepetitionMandatory=function(t){this.collectNamedDSLMethod(t,Ms,Gm)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.collectNamedDSLMethod(t,Os,gd)},e.prototype.visitRepetitionWithSeparator=function(t){this.collectNamedDSLMethod(t,Ji,jm)},e.prototype.visitAlternation=function(t){var r=this;this.collectNamedDSLMethod(t,es,Id);var i=t.definition.length>1;ze(t.definition,function(s,o){if(!Is(s.name)){var a=s.definition;i?a=[new xr({definition:s.definition})]:a=s.definition;var l=lG(r.ruleIdx,Id,t.idx,o);r.result.push({def:a,key:l,name:s.name,orgProd:s})}})},e})(ac);function Rge(n,e){var t={allRuleNames:[]};return ze(n,function(r){var i=e[r.name];t.allRuleNames.push(r.name);var s=new HO(i);r.accept(s),ze(s.result,function(o){o.def,o.key;var a=o.name;t.allRuleNames.push(r.name+a)})}),t}var lc=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),Ege=(function(n){lc(e,n);function e(t,r){var i=n.call(this)||this;return i.topProd=t,i.path=r,i.possibleTokTypes=[],i.nextProductionName="",i.nextProductionOccurrence=0,i.found=!1,i.isAtEndOfPath=!1,i}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Di(this.path.ruleStack).reverse(),this.occurrenceStack=Di(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(t,r){r===void 0&&(r=[]),this.found||n.prototype.walk.call(this,t,r)},e.prototype.walkProdRef=function(t,r,i){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var s=r.concat(i);this.updateExpectedNext(),this.walk(t.referencedRule,s)}},e.prototype.updateExpectedNext=function(){rn(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e})(vS),bge=(function(n){lc(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.path=r,i.nextTerminalName="",i.nextTerminalOccurrence=0,i.nextTerminalName=i.path.lastTok.name,i.nextTerminalOccurrence=i.path.lastTokOccurrence,i}return e.prototype.walkTerminal=function(t,r,i){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var s=r.concat(i),o=new Hi({definition:s});this.possibleTokTypes=lp(o),this.found=!0}},e})(Ege),yS=(function(n){lc(e,n);function e(t,r){var i=n.call(this)||this;return i.topRule=t,i.occurrence=r,i.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},i}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e})(vS),Tge=(function(n){lc(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkMany=function(t,r,i){if(t.idx===this.occurrence){var s=Ns(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof xn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkMany.call(this,t,r,i)},e})(yS),RF=(function(n){lc(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkManySep=function(t,r,i){if(t.idx===this.occurrence){var s=Ns(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof xn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkManySep.call(this,t,r,i)},e})(yS),Age=(function(n){lc(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(t,r,i){if(t.idx===this.occurrence){var s=Ns(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof xn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkAtLeastOne.call(this,t,r,i)},e})(yS),EF=(function(n){lc(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(t,r,i){if(t.idx===this.occurrence){var s=Ns(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof xn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkAtLeastOneSep.call(this,t,r,i)},e})(yS);function xN(n,e,t){t===void 0&&(t=[]),t=Di(t);var r=[],i=0;function s(u){return u.concat(Or(n,i+1))}function o(u){var h=xN(s(u),e,t);return r.concat(h)}for(;t.length<e&&i<n.length;){var a=n[i];if(a instanceof Hi)return o(a.definition);if(a instanceof Zi)return o(a.definition);if(a instanceof xr)r=o(a.definition);else if(a instanceof Ms){var l=a.definition.concat([new Yn({definition:a.definition})]);return o(l)}else if(a instanceof Os){var l=[new Hi({definition:a.definition}),new Yn({definition:[new xn({terminalType:a.separator})].concat(a.definition)})];return o(l)}else if(a instanceof Ji){var l=a.definition.concat([new Yn({definition:[new xn({terminalType:a.separator})].concat(a.definition)})]);r=o(l)}else if(a instanceof Yn){var l=a.definition.concat([new Yn({definition:a.definition})]);r=o(l)}else{if(a instanceof es)return ze(a.definition,function(u){r=o(u.definition)}),r;if(a instanceof xn)t.push(a.terminalType);else throw Error("non exhaustive match")}i++}return r.push({partialPath:t,suffixDef:Or(n,i)}),r}function uG(n,e,t,r){var i="EXIT_NONE_TERMINAL",s=[i],o="EXIT_ALTERNATIVE",a=!1,l=e.length,u=l-r-1,h=[],c=[];for(c.push({idx:-1,def:n,ruleStack:[],occurrenceStack:[]});!rn(c);){var d=c.pop();if(d===o){a&&z$(c).idx<=u&&c.pop();continue}var f=d.def,m=d.idx,p=d.ruleStack,v=d.occurrenceStack;if(!rn(f)){var y=f[0];if(y===i){var C={idx:m,def:Or(f),ruleStack:Cg(p),occurrenceStack:Cg(v)};c.push(C)}else if(y instanceof xn)if(m<l-1){var R=m+1,A=e[R];if(t(A,y.terminalType)){var C={idx:R,def:Or(f),ruleStack:p,occurrenceStack:v};c.push(C)}}else if(m===l-1)h.push({nextTokenType:y.terminalType,nextTokenOccurrence:y.idx,ruleStack:p,occurrenceStack:v}),a=!0;else throw Error("non exhaustive match");else if(y instanceof Zi){var I=Di(p);I.push(y.nonTerminalName);var H=Di(v);H.push(y.idx);var C={idx:m,def:y.definition.concat(s,Or(f)),ruleStack:I,occurrenceStack:H};c.push(C)}else if(y instanceof xr){var k={idx:m,def:Or(f),ruleStack:p,occurrenceStack:v};c.push(k),c.push(o);var W={idx:m,def:y.definition.concat(Or(f)),ruleStack:p,occurrenceStack:v};c.push(W)}else if(y instanceof Ms){var z=new Yn({definition:y.definition,idx:y.idx}),G=y.definition.concat([z],Or(f)),C={idx:m,def:G,ruleStack:p,occurrenceStack:v};c.push(C)}else if(y instanceof Os){var q=new xn({terminalType:y.separator}),z=new Yn({definition:[q].concat(y.definition),idx:y.idx}),G=y.definition.concat([z],Or(f)),C={idx:m,def:G,ruleStack:p,occurrenceStack:v};c.push(C)}else if(y instanceof Ji){var k={idx:m,def:Or(f),ruleStack:p,occurrenceStack:v};c.push(k),c.push(o);var q=new xn({terminalType:y.separator}),J=new Yn({definition:[q].concat(y.definition),idx:y.idx}),G=y.definition.concat([J],Or(f)),W={idx:m,def:G,ruleStack:p,occurrenceStack:v};c.push(W)}else if(y instanceof Yn){var k={idx:m,def:Or(f),ruleStack:p,occurrenceStack:v};c.push(k),c.push(o);var J=new Yn({definition:y.definition,idx:y.idx}),G=y.definition.concat([J],Or(f)),W={idx:m,def:G,ruleStack:p,occurrenceStack:v};c.push(W)}else if(y instanceof es)for(var re=y.definition.length-1;re>=0;re--){var ie=y.definition[re],ae={idx:m,def:ie.definition.concat(Or(f)),ruleStack:p,occurrenceStack:v};c.push(ae),c.push(o)}else if(y instanceof Hi)c.push({idx:m,def:y.definition.concat(Or(f)),ruleStack:p,occurrenceStack:v});else if(y instanceof sf)c.push(Nge(y,m,p,v));else throw Error("non exhaustive match")}}return h}function Nge(n,e,t,r){var i=Di(t);i.push(n.name);var s=Di(r);return s.push(1),{idx:e,def:n.definition,ruleStack:i,occurrenceStack:s}}var hG=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),an;(function(n){n[n.OPTION=0]="OPTION",n[n.REPETITION=1]="REPETITION",n[n.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",n[n.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",n[n.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",n[n.ALTERNATION=5]="ALTERNATION"})(an||(an={}));function Ige(n){if(n instanceof xr)return an.OPTION;if(n instanceof Yn)return an.REPETITION;if(n instanceof Ms)return an.REPETITION_MANDATORY;if(n instanceof Os)return an.REPETITION_MANDATORY_WITH_SEPARATOR;if(n instanceof Ji)return an.REPETITION_WITH_SEPARATOR;if(n instanceof es)return an.ALTERNATION;throw Error("non exhaustive match")}function Mge(n,e,t,r,i,s){var o=FO(n,e,t),a=fG(o)?Yy:wS;return s(o,r,a,i)}function Oge(n,e,t,r,i,s){var o=kO(n,e,i,t),a=fG(o)?Yy:wS;return s(o[0],a,r)}function _ge(n,e,t,r){var i=n.length,s=bs(n,function(l){return bs(l,function(u){return u.length===1})});if(e)return function(l){for(var u=Te(l,function(R){return R.GATE}),h=0;h<i;h++){var c=n[h],d=c.length,f=u[h];if(!(f!==void 0&&f.call(this)===!1))e:for(var m=0;m<d;m++){for(var p=c[m],v=p.length,y=0;y<v;y++){var C=this.LA(y+1);if(t(C,p[y])===!1)continue e}return h}}};if(s&&!r){var o=Te(n,function(l){return Li(l)}),a=Pr(o,function(l,u,h){return ze(u,function(c){je(l,c.tokenTypeIdx)||(l[c.tokenTypeIdx]=h),ze(c.categoryMatches,function(d){je(l,d)||(l[d]=h)})}),l},[]);return function(){var l=this.LA(1);return a[l.tokenTypeIdx]}}else return function(){for(var l=0;l<i;l++){var u=n[l],h=u.length;e:for(var c=0;c<h;c++){for(var d=u[c],f=d.length,m=0;m<f;m++){var p=this.LA(m+1);if(t(p,d[m])===!1)continue e}return l}}}}function xge(n,e,t){var r=bs(n,function(u){return u.length===1}),i=n.length;if(r&&!t){var s=Li(n);if(s.length===1&&rn(s[0].categoryMatches)){var o=s[0],a=o.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===a}}else{var l=Pr(s,function(u,h,c){return u[h.tokenTypeIdx]=!0,ze(h.categoryMatches,function(d){u[d]=!0}),u},[]);return function(){var u=this.LA(1);return l[u.tokenTypeIdx]===!0}}}else return function(){e:for(var u=0;u<i;u++){for(var h=n[u],c=h.length,d=0;d<c;d++){var f=this.LA(d+1);if(e(f,h[d])===!1)continue e}return!0}return!1}}var Pge=(function(n){hG(e,n);function e(t,r,i){var s=n.call(this)||this;return s.topProd=t,s.targetOccurrence=r,s.targetProdType=i,s}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,r,i,s){return t.idx===this.targetOccurrence&&this.targetProdType===r?(this.restDef=i.concat(s),!0):!1},e.prototype.walkOption=function(t,r,i){this.checkIsTarget(t,an.OPTION,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkAtLeastOne=function(t,r,i){this.checkIsTarget(t,an.REPETITION_MANDATORY,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkAtLeastOneSep=function(t,r,i){this.checkIsTarget(t,an.REPETITION_MANDATORY_WITH_SEPARATOR,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkMany=function(t,r,i){this.checkIsTarget(t,an.REPETITION,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkManySep=function(t,r,i){this.checkIsTarget(t,an.REPETITION_WITH_SEPARATOR,r,i)||n.prototype.walkOption.call(this,t,r,i)},e})(vS),cG=(function(n){hG(e,n);function e(t,r,i){var s=n.call(this)||this;return s.targetOccurrence=t,s.targetProdType=r,s.targetRef=i,s.result=[],s}return e.prototype.checkIsTarget=function(t,r){t.idx===this.targetOccurrence&&this.targetProdType===r&&(this.targetRef===void 0||t===this.targetRef)&&(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,an.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,an.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,an.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,an.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,an.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,an.ALTERNATION)},e})(ac);function bF(n){for(var e=new Array(n),t=0;t<n;t++)e[t]=[];return e}function hA(n){for(var e=[""],t=0;t<n.length;t++){for(var r=n[t],i=[],s=0;s<e.length;s++){var o=e[s];i.push(o+"_"+r.tokenTypeIdx);for(var a=0;a<r.categoryMatches.length;a++){var l="_"+r.categoryMatches[a];i.push(o+l)}}e=i}return e}function Lge(n,e,t){for(var r=0;r<n.length;r++)if(r!==t)for(var i=n[r],s=0;s<e.length;s++){var o=e[s];if(i[o]===!0)return!1}return!0}function dG(n,e){for(var t=Te(n,function(h){return xN([h],1)}),r=bF(t.length),i=Te(t,function(h){var c={};return ze(h,function(d){var f=hA(d.partialPath);ze(f,function(m){c[m]=!0})}),c}),s=t,o=1;o<=e;o++){var a=s;s=bF(a.length);for(var l=function(h){for(var c=a[h],d=0;d<c.length;d++){var f=c[d].partialPath,m=c[d].suffixDef,p=hA(f),v=Lge(i,p,h);if(v||rn(m)||f.length===e){var y=r[h];if(PN(y,f)===!1){y.push(f);for(var C=0;C<p.length;C++){var R=p[C];i[h][R]=!0}}}else{var A=xN(m,o+1,f);s[h]=s[h].concat(A),ze(A,function(I){var H=hA(I.partialPath);ze(H,function(k){i[h][k]=!0})})}}},u=0;u<a.length;u++)l(u)}return r}function FO(n,e,t,r){var i=new cG(n,an.ALTERNATION,r);return e.accept(i),dG(i.result,t)}function kO(n,e,t,r){var i=new cG(n,t);e.accept(i);var s=i.result,o=new Pge(e,n,t),a=o.startWalking(),l=new Hi({definition:s}),u=new Hi({definition:a});return dG([l,u],r)}function PN(n,e){e:for(var t=0;t<n.length;t++){var r=n[t];if(r.length===e.length){for(var i=0;i<r.length;i++){var s=e[i],o=r[i],a=s===o||o.categoryMatchesMap[s.tokenTypeIdx]!==void 0;if(a===!1)continue e}return!0}}return!1}function Dge(n,e){return n.length<e.length&&bs(n,function(t,r){var i=e[r];return t===i||i.categoryMatchesMap[t.tokenTypeIdx]})}function fG(n){return bs(n,function(e){return bs(e,function(t){return bs(t,function(r){return rn(r.categoryMatches)})})})}var VO=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})();function Hge(n,e,t,r,i,s){var o=Te(n,function(C){return kge(C,i)}),a=Te(n,function(C){return pG(C,C,i)}),l=[],u=[],h=[];bs(a,rn)&&(l=Te(n,function(C){return zge(C,i)}),u=Te(n,function(C){return Yge(C,e,r,i)}),h=Xge(n,e,i));var c=Jge(n,t,i),d=Te(t,function(C){return $ge(C,i)}),f=Fge(n,i),m=epe(n,i),p=Te(n,function(C){return qge(C,i)}),v=Te(n,function(C){return Bge(C,i)}),y=Te(n,function(C){return Gge(C,n,s,i)});return Li(o.concat(d,f,m,h,a,l,u,c,p,v,y))}function Fge(n,e){var t=[];return ze(n,function(r){var i=new HO("");r.accept(i);var s=Te(i.result,function(o){return o.orgProd});t.push(Te(s,function(o){return Wge(r,o,e)}))}),Li(t)}function kge(n,e){var t=new Uge;n.accept(t);var r=t.allProductions,i=K$(r,Vge),s=Ls(i,function(a){return a.length>1}),o=Te(zr(s),function(a){var l=Ns(a),u=e.buildDuplicateFoundError(n,a),h=io(l),c={message:u,type:br.DUPLICATE_PRODUCTIONS,ruleName:n.name,dslName:h,occurrence:l.idx},d=mG(l);return d&&(c.parameter=d),c});return o}function Vge(n){return io(n)+"_#_"+n.idx+"_#_"+mG(n)}function mG(n){return n instanceof xn?n.terminalType.name:n instanceof Zi?n.nonTerminalName:""}var Uge=(function(n){VO(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e})(ac),qh=/^[a-zA-Z_]\w*$/,gG=new RegExp(qh.source.replace("^","^\\$"));function Bge(n,e){var t=[],r=n.name;return r.match(qh)||t.push({message:e.buildInvalidRuleNameError({topLevelRule:n,expectedPattern:qh}),type:br.INVALID_RULE_NAME,ruleName:r}),t}function Wge(n,e,t){var r=[],i;return e.name.match(gG)||(i=t.buildInvalidNestedRuleNameError(n,e),r.push({message:i,type:br.INVALID_NESTED_RULE_NAME,ruleName:n.name})),r}function $ge(n,e){var t=[],r=n.name;return r.match(qh)||t.push({message:e.buildTokenNameError({tokenType:n,expectedPattern:qh}),type:br.INVALID_TOKEN_NAME}),t}function Gge(n,e,t,r){var i=[],s=Pr(e,function(a,l){return l.name===n.name?a+1:a},0);if(s>1){var o=r.buildDuplicateRuleNameError({topLevelRule:n,grammarName:t});i.push({message:o,type:br.DUPLICATE_RULE_NAME,ruleName:n.name})}return i}function jge(n,e,t){var r=[],i;return cr(e,n)||(i="Invalid rule override, rule: ->"+n+"<- cannot be overridden in the grammar: ->"+t+"<-as it is not defined in any of the super grammars ",r.push({message:i,type:br.INVALID_RULE_OVERRIDE,ruleName:n})),r}function pG(n,e,t,r){r===void 0&&(r=[]);var i=[],s=Lv(e.definition);if(rn(s))return[];var o=n.name,a=cr(s,n);a&&i.push({message:t.buildLeftRecursionError({topLevelRule:n,leftRecursionPath:r}),type:br.LEFT_RECURSION,ruleName:o});var l=mS(s,r.concat([n])),u=Te(l,function(h){var c=Di(r);return c.push(h),pG(n,h,t,c)});return i.concat(Li(u))}function Lv(n){var e=[];if(rn(n))return e;var t=Ns(n);if(t instanceof Zi)e.push(t.referencedRule);else if(t instanceof Hi||t instanceof xr||t instanceof Ms||t instanceof Os||t instanceof Ji||t instanceof Yn)e=e.concat(Lv(t.definition));else if(t instanceof es)e=Li(Te(t.definition,function(o){return Lv(o.definition)}));else if(!(t instanceof xn))throw Error("non exhaustive match");var r=Ky(t),i=n.length>1;if(r&&i){var s=Or(n);return e.concat(Lv(s))}else return e}var UO=(function(n){VO(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.alternations=[],t}return e.prototype.visitAlternation=function(t){this.alternations.push(t)},e})(ac);function zge(n,e){var t=new UO;n.accept(t);var r=t.alternations,i=Pr(r,function(s,o){var a=Cg(o.definition),l=Te(a,function(u,h){var c=uG([u],[],null,1);return rn(c)?{message:e.buildEmptyAlternationError({topLevelRule:n,alternation:o,emptyChoiceIdx:h}),type:br.NONE_LAST_EMPTY_ALT,ruleName:n.name,occurrence:o.idx,alternative:h+1}:null});return s.concat(sp(l))},[]);return i}function Yge(n,e,t,r){var i=new UO;n.accept(i);var s=i.alternations,o=t[n.name];o&&(s=Yh(s,function(l){return o[io(l)+(l.idx===0?"":l.idx)]})),s=Yh(s,function(l){return l.ignoreAmbiguities===!0});var a=Pr(s,function(l,u){var h=u.idx,c=u.maxLookahead||e,d=FO(h,n,c,u),f=Qge(d,u,n,r),m=Zge(d,u,n,r);return l.concat(f,m)},[]);return a}var Kge=(function(n){VO(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e})(ac);function qge(n,e){var t=new UO;n.accept(t);var r=t.alternations,i=Pr(r,function(s,o){return o.definition.length>255&&s.push({message:e.buildTooManyAlternativesError({topLevelRule:n,alternation:o}),type:br.TOO_MANY_ALTS,ruleName:n.name,occurrence:o.idx}),s},[]);return i}function Xge(n,e,t){var r=[];return ze(n,function(i){var s=new Kge;i.accept(s);var o=s.allProductions;ze(o,function(a){var l=Ige(a),u=a.maxLookahead||e,h=a.idx,c=kO(h,i,l,u),d=c[0];if(rn(Li(d))){var f=t.buildEmptyRepetitionError({topLevelRule:i,repetition:a});r.push({message:f,type:br.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),r}function Qge(n,e,t,r){var i=[],s=Pr(n,function(a,l,u){return e.definition[u].ignoreAmbiguities===!0||ze(l,function(h){var c=[u];ze(n,function(d,f){u!==f&&PN(d,h)&&e.definition[f].ignoreAmbiguities!==!0&&c.push(f)}),c.length>1&&!PN(i,h)&&(i.push(h),a.push({alts:c,path:h}))}),a},[]),o=Te(s,function(a){var l=Te(a.alts,function(h){return h+1}),u=r.buildAlternationAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:l,prefixPath:a.path});return{message:u,type:br.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:e.idx,alternatives:[a.alts]}});return o}function Zge(n,e,t,r){var i=[],s=Pr(n,function(o,a,l){var u=Te(a,function(h){return{idx:l,path:h}});return o.concat(u)},[]);return ze(s,function(o){var a=e.definition[o.idx];if(a.ignoreAmbiguities!==!0){var l=o.idx,u=o.path,h=cme(s,function(d){return e.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<l&&Dge(d.path,u)}),c=Te(h,function(d){var f=[d.idx+1,l+1],m=e.idx===0?"":e.idx,p=r.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:f,prefixPath:d.path});return{message:p,type:br.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:m,alternatives:f}});i=i.concat(c)}}),i}function Jge(n,e,t){var r=[],i=Te(e,function(s){return s.name});return ze(n,function(s){var o=s.name;if(cr(i,o)){var a=t.buildNamespaceConflictError(s);r.push({message:a,type:br.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:o})}}),r}function epe(n,e){var t=[];return ze(n,function(r){var i=new HO("");r.accept(i);var s=K$(i.result,function(a){return a.name}),o=Ls(s,function(a){return a.length>1});ze(zr(o),function(a){var l=Te(a,function(h){return h.orgProd}),u=e.buildDuplicateNestedRuleNameError(r,l);t.push({message:u,type:br.DUPLICATE_NESTED_NAME,ruleName:r.name})})}),t}var wG={buildMismatchTokenMessage:function(n){var e=n.expected,t=n.actual;n.previous,n.ruleName;var r=oG(e),i=r?"--> "+Nd(e)+" <--":"token of type --> "+e.name+" <--",s="Expecting "+i+" but found --> '"+t.image+"' <--";return s},buildNotAllInputParsedMessage:function(n){var e=n.firstRedundant;return n.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(n){var e=n.expectedPathsPerAlt,t=n.actual;n.previous;var r=n.customUserDescription;n.ruleName;var i="Expecting: ",s=Ns(t).image,o=`
but found: '`+s+"'";if(r)return i+r+o;var a=Pr(e,function(c,d){return c.concat(d)},[]),l=Te(a,function(c){return"["+Te(c,function(d){return Nd(d)}).join(", ")+"]"}),u=Te(l,function(c,d){return"  "+(d+1)+". "+c}),h=`one of these possible Token sequences:
`+u.join(`
`);return i+h+o},buildEarlyExitMessage:function(n){var e=n.expectedIterationPaths,t=n.actual,r=n.customUserDescription;n.ruleName;var i="Expecting: ",s=Ns(t).image,o=`
but found: '`+s+"'";if(r)return i+r+o;var a=Te(e,function(u){return"["+Te(u,function(h){return Nd(h)}).join(",")+"]"}),l=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+a.join(" ,")+">");return i+l+o}};Object.freeze(wG);var tpe={buildRuleNotFoundError:function(n,e){var t="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+n.name+"<-";return t}},BO={buildDuplicateFoundError:function(n,e){function t(h){return h instanceof xn?h.terminalType.name:h instanceof Zi?h.nonTerminalName:""}var r=n.name,i=Ns(e),s=i.idx,o=io(i),a=t(i),l=s>0,u="->"+o+(l?s:"")+"<- "+(a?"with argument: ->"+a+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+r+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,`
`),u},buildInvalidNestedRuleNameError:function(n,e){var t="Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+n.name+`<-
`+("it must match the pattern: ->"+gG.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return t},buildDuplicateNestedRuleNameError:function(n,e){var t=Ns(e).name,r="Duplicate nested rule name: ->"+t+"<- inside rule: ->"+n.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return r},buildNamespaceConflictError:function(n){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+n.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(n){var e=Te(n.prefixPath,function(i){return Nd(i)}).join(", "),t=n.alternation.idx===0?"":n.alternation.idx,r="Ambiguous alternatives: <"+n.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+t+"> inside <"+n.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return r},buildAlternationAmbiguityError:function(n){var e=Te(n.prefixPath,function(i){return Nd(i)}).join(", "),t=n.alternation.idx===0?"":n.alternation.idx,r="Ambiguous Alternatives Detected: <"+n.ambiguityIndices.join(" ,")+"> in <OR"+t+">"+(" inside <"+n.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return r=r+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError:function(n){var e=io(n.repetition);n.repetition.idx!==0&&(e+=n.repetition.idx);var t="The repetition <"+e+"> within Rule <"+n.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return t},buildTokenNameError:function(n){var e=n.tokenType.name,t="Invalid Grammar Token name: ->"+e+"<- it must match the pattern: ->"+n.expectedPattern.toString()+"<-";return t},buildEmptyAlternationError:function(n){var e="Ambiguous empty alternative: <"+(n.emptyChoiceIdx+1)+">"+(" in <OR"+n.alternation.idx+"> inside <"+n.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(n){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+n.alternation.idx+"> inside <"+n.topLevelRule.name+`> Rule.
 has `+(n.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(n){var e=n.topLevelRule.name,t=Te(n.leftRecursionPath,function(s){return s.name}),r=e+" --> "+t.concat([e]).join(" --> "),i=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+r+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return i},buildInvalidRuleNameError:function(n){var e=n.topLevelRule.name,t=n.expectedPattern.toString(),r="Invalid grammar rule name: ->"+e+"<- it must match the pattern: ->"+t+"<-";return r},buildDuplicateRuleNameError:function(n){var e;n.topLevelRule instanceof sf?e=n.topLevelRule.name:e=n.topLevelRule;var t="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+n.grammarName+"<-";return t}},npe=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})();function rpe(n,e){var t=new ipe(n,e);return t.resolveRefs(),t.errors}var ipe=(function(n){npe(e,n);function e(t,r){var i=n.call(this)||this;return i.nameToTopRule=t,i.errMsgProvider=r,i.errors=[],i}return e.prototype.resolveRefs=function(){var t=this;ze(zr(this.nameToTopRule),function(r){t.currTopLevel=r,r.accept(t)})},e.prototype.visitNonTerminal=function(t){var r=this.nameToTopRule[t.nonTerminalName];if(r)t.referencedRule=r;else{var i=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:i,type:br.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e})(ac);function spe(n){n=gS(n,{errMsgProvider:tpe});var e={};return ze(n.rules,function(t){e[t.name]=t}),rpe(e,n.errMsgProvider)}function ope(n){return n=gS(n,{errMsgProvider:BO,ignoredIssues:{}}),Hge(n.rules,n.maxLookahead,n.tokenTypes,n.ignoredIssues,n.errMsgProvider,n.grammarName)}var vG="MismatchedTokenException",yG="NoViableAltException",CG="EarlyExitException",SG="NotAllInputParsedException",RG=[vG,yG,CG,SG];Object.freeze(RG);function Xy(n){return cr(RG,n.name)}function WO(n,e,t){this.name=vG,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}WO.prototype=Error.prototype;function EG(n,e,t){this.name=yG,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}EG.prototype=Error.prototype;function bG(n,e){this.name=SG,this.message=n,this.token=e,this.resyncedTokens=[]}bG.prototype=Error.prototype;function TG(n,e,t){this.name=CG,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}TG.prototype=Error.prototype;var cA={},AG="InRuleRecoveryException";function NG(n){this.name=AG,this.message=n}NG.prototype=Error.prototype;var ape=(function(){function n(){}return n.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=je(e,"recoveryEnabled")?e.recoveryEnabled:Oi.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=lpe)},n.prototype.getTokenToInsert=function(e){var t=DO(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},n.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},n.prototype.tryInRepetitionRecovery=function(e,t,r,i){for(var s=this,o=this.findReSyncTokenType(),a=this.exportLexerState(),l=[],u=!1,h=this.LA(1),c=this.LA(1),d=function(){var f=s.LA(0),m=s.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:h,previous:f,ruleName:s.getCurrRuleFullName()}),p=new WO(m,h,s.LA(0));p.resyncedTokens=Cg(l),s.SAVE_ERROR(p)};!u;)if(this.tokenMatcher(c,i)){d();return}else if(r.call(this)){d(),e.apply(this,t);return}else this.tokenMatcher(c,o)?u=!0:(c=this.SKIP_TOKEN(),this.addToResyncTokens(c,l));this.importLexerState(a)},n.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!(r===!1||e===void 0||t===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))},n.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t),i=this.getNextPossibleTokenTypes(r);return i},n.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t)){var r=this.getTokenToInsert(e);return r}if(this.canRecoverWithSingleTokenDeletion(e)){var i=this.SKIP_TOKEN();return this.consumeToken(),i}throw new NG("sad sad panda")},n.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},n.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||rn(t))return!1;var i=this.LA(1),s=Wd(t,function(o){return r.tokenMatcher(i,o)})!==void 0;return s},n.prototype.canRecoverWithSingleTokenDeletion=function(e){var t=this.tokenMatcher(this.LA(2),e);return t},n.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return cr(r,e)},n.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var i=t.tokenType;if(cr(e,i))return i;t=this.LA(r),r++}},n.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return cA;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}},n.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return rn(this.LAST_EXPLICIT_RULE_STACK)||(t=Te(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_STACK[i]}),r=Te(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_OCCURRENCE_STACK[i]})),Te(t,function(i,s){return s===0?cA:{ruleName:e.shortRuleNameToFullName(i),idxInCallingRule:r[s],inRule:e.shortRuleNameToFullName(t[s-1])}})},n.prototype.flattenFollowSet=function(){var e=this,t=Te(this.buildFullFollowKeyStack(),function(r){return e.getFollowSetFromFollowKey(r)});return Li(t)},n.prototype.getFollowSetFromFollowKey=function(e){if(e===cA)return[Kh];var t=e.ruleName+e.idxInCallingRule+aG+e.inRule;return this.resyncFollows[t]},n.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,Kh)||t.push(e),t},n.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);this.tokenMatcher(r,e)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return Cg(t)},n.prototype.attemptInRepetitionRecovery=function(e,t,r,i,s,o,a){},n.prototype.getCurrentGrammarPath=function(e,t){var r=this.getHumanReadableRuleStack(),i=Di(this.RULE_OCCURRENCE_STACK),s={ruleStack:r,occurrenceStack:i,lastTok:e,lastTokOccurrence:t};return s},n.prototype.getHumanReadableRuleStack=function(){var e=this;return rn(this.LAST_EXPLICIT_RULE_STACK)?Te(this.RULE_STACK,function(t){return e.shortRuleNameToFullName(t)}):Te(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])})},n})();function lpe(n,e,t,r,i,s,o){var a=this.getKeyForAutomaticLookahead(r,i),l=this.firstAfterRepMap[a];if(l===void 0){var u=this.getCurrRuleFullName(),h=this.getGAstProductions()[u],c=new s(h,i);l=c.startWalking(),this.firstAfterRepMap[a]=l}var d=l.token,f=l.occurrence,m=l.isEndOfRule;this.RULE_STACK.length===1&&m&&d===void 0&&(d=Kh,f=1),this.shouldInRepetitionRecoveryBeTried(d,f,o)&&this.tryInRepetitionRecovery(n,e,t,d)}var upe=(function(){function n(){}return n.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=je(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:Oi.dynamicTokensEnabled,this.maxLookahead=je(e,"maxLookahead")?e.maxLookahead:Oi.maxLookahead,this.lookAheadFuncsCache=rF()?new Map:[],rF()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},n.prototype.preComputeLookaheadFunctions=function(e){var t=this;ze(e,function(r){t.TRACE_INIT(r.name+" Rule Lookahead",function(){var i=uge(r),s=i.alternation,o=i.repetition,a=i.option,l=i.repetitionMandatory,u=i.repetitionMandatoryWithSeparator,h=i.repetitionWithSeparator;ze(s,function(c){var d=c.idx===0?"":c.idx;t.TRACE_INIT(""+io(c)+d,function(){var f=Mge(c.idx,r,c.maxLookahead||t.maxLookahead,c.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),m=zm(t.fullRuleNameToShort[r.name],Id,c.idx);t.setLaFuncCache(m,f)})}),ze(o,function(c){t.computeLookaheadFunc(r,c.idx,$m,an.REPETITION,c.maxLookahead,io(c))}),ze(a,function(c){t.computeLookaheadFunc(r,c.idx,qy,an.OPTION,c.maxLookahead,io(c))}),ze(l,function(c){t.computeLookaheadFunc(r,c.idx,Gm,an.REPETITION_MANDATORY,c.maxLookahead,io(c))}),ze(u,function(c){t.computeLookaheadFunc(r,c.idx,gd,an.REPETITION_MANDATORY_WITH_SEPARATOR,c.maxLookahead,io(c))}),ze(h,function(c){t.computeLookaheadFunc(r,c.idx,jm,an.REPETITION_WITH_SEPARATOR,c.maxLookahead,io(c))})})})},n.prototype.computeLookaheadFunc=function(e,t,r,i,s,o){var a=this;this.TRACE_INIT(""+o+(t===0?"":t),function(){var l=Oge(t,e,s||a.maxLookahead,a.dynamicTokensEnabled,i,a.lookAheadBuilderForOptional),u=zm(a.fullRuleNameToShort[e.name],r,t);a.setLaFuncCache(u,l)})},n.prototype.lookAheadBuilderForOptional=function(e,t,r){return xge(e,t,r)},n.prototype.lookAheadBuilderForAlternatives=function(e,t,r,i){return _ge(e,t,r,i)},n.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return zm(r,e,t)},n.prototype.getLaFuncFromCache=function(e){},n.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},n.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},n.prototype.setLaFuncCache=function(e,t){},n.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},n.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},n})();function hpe(n){return CS(n.constructor)}var cpe=/^\s*function\s*(\S*)\s*\(/,TF="name";function CS(n){var e=n.name;if(e)return e;var t=n.toString().match(cpe)[1];return t}function IG(n,e){var t=Object.getOwnPropertyDescriptor(n,TF);return Is(t)||t.configurable?(Object.defineProperty(n,TF,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}function dpe(n,e){for(var t=yl(n),r=t.length,i=0;i<r;i++)for(var s=t[i],o=n[s],a=o.length,l=0;l<a;l++){var u=o[l];u.tokenTypeIdx===void 0&&(u.fullName!==void 0?this[u.fullName](u.children,e):this[u.name](u.children,e))}}function fpe(n,e){var t=function(){};IG(t,n+"BaseSemantics");var r={visit:function(i,s){if(uo(i)&&(i=i[0]),!Is(i))return i.fullName!==void 0?this[i.fullName](i.children,s):this[i.name](i.children,s)},validateVisitor:function(){var i=gpe(this,e);if(!rn(i)){var s=Te(i,function(o){return o.msg});throw Error("Errors Detected in CST Visitor <"+CS(this.constructor)+`>:
	`+(""+s.join(`

`).replace(/\n/g,`
	`)))}}};return t.prototype=r,t.prototype.constructor=t,t._RULE_NAMES=e,t}function mpe(n,e,t){var r=function(){};IG(r,n+"BaseSemanticsWithDefaults");var i=Object.create(t.prototype);return ze(e,function(s){i[s]=dpe}),r.prototype=i,r.prototype.constructor=r,r}var Qy;(function(n){n[n.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",n[n.MISSING_METHOD=1]="MISSING_METHOD"})(Qy||(Qy={}));function gpe(n,e){var t=ppe(n,e),r=vpe(n,e);return t.concat(r)}function ppe(n,e){var t=Te(e,function(r){if(!Cu(n[r]))return{msg:"Missing visitor method: <"+r+"> on "+CS(n.constructor)+" CST Visitor.",type:Qy.MISSING_METHOD,methodName:r}});return sp(t)}var wpe=["constructor","visit","validateVisitor"];function vpe(n,e){var t=[];for(var r in n)qh.test(r)&&Cu(n[r])&&!cr(wpe,r)&&!cr(e,r)&&t.push({msg:"Redundant visitor method: <"+r+"> on "+CS(n.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+qh.source+"/."),type:Qy.REDUNDANT_METHOD,methodName:r});return t}var ype=(function(){function n(){}return n.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=je(e,"outputCst")?e.outputCst:Oi.outputCst,this.nodeLocationTracking=je(e,"nodeLocationTracking")?e.nodeLocationTracking:Oi.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=gr,this.cstFinallyStateUpdate=gr,this.cstPostTerminal=gr,this.cstPostNonTerminal=gr,this.cstPostRule=gr,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=CF,this.setNodeLocationFromNode=CF,this.cstPostRule=gr,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=gr,this.setNodeLocationFromNode=gr,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=yF,this.setNodeLocationFromNode=yF,this.cstPostRule=gr,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=gr,this.setNodeLocationFromNode=gr,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=gr,this.setNodeLocationFromNode=gr,this.cstPostRule=gr,this.setInitialNodeLocation=gr;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},n.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},n.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},n.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},n.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},n.prototype.cstNestedInvocationStateUpdate=function(e,t){var r={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},n.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var r={name:e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},n.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},n.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},n.prototype.cstPostRuleFull=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},n.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?r.endOffset=t.endOffset:r.startOffset=NaN},n.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];Sge(r,t,e),this.setNodeLocationFromToken(r.location,t)},n.prototype.cstPostNonTerminal=function(e,t){if(this.isBackTracking()!==!0){var r=this.CST_STACK[this.CST_STACK.length-1];SF(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}},n.prototype.getBaseCstVisitorConstructor=function(){if(Is(this.baseCstVisitorConstructor)){var e=fpe(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},n.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(Is(this.baseCstVisitorWithDefaultsConstructor)){var e=mpe(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},n.prototype.nestedRuleBeforeClause=function(e,t){var r;if(e.NAME!==void 0)return r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r},n.prototype.nestedAltBeforeClause=function(e,t,r,i){var s=this.getLastExplicitRuleShortName(),o=lG(s,r,t,i),a;if(e.NAME!==void 0)return a=e.NAME,this.nestedRuleInvocationStateUpdate(a,o),{shortName:o,nestedName:a}},n.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,i=r[r.length-1];this.nestedRuleFinallyStateUpdate();var s=r[r.length-1];SF(s,t,i),this.setNodeLocationFromNode(s.location,i.location)},n.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},n.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},n.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},n.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},n.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},n.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},n.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},n.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},n})(),Cpe=(function(){function n(){}return n.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(n.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),n.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Jy},n.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?Jy:this.tokVector[t]},n.prototype.consumeToken=function(){this.currIdx++},n.prototype.exportLexerState=function(){return this.currIdx},n.prototype.importLexerState=function(e){this.currIdx=e},n.prototype.resetLexerState=function(){this.currIdx=-1},n.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},n.prototype.getLexerPosition=function(){return this.exportLexerState()},n})(),Spe=(function(){function n(){}return n.prototype.ACTION=function(e){return e.call(this)},n.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},n.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},n.prototype.option=function(e,t){return this.optionInternal(t,e)},n.prototype.or=function(e,t){return this.orInternal(t,e)},n.prototype.many=function(e,t){return this.manyInternal(e,t)},n.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},n.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},n.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},n.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},n.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},n.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},n.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},n.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},n.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},n.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},n.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},n.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},n.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},n.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},n.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},n.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},n.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},n.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},n.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},n.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},n.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},n.prototype.OPTION=function(e){return this.optionInternal(e,0)},n.prototype.OPTION1=function(e){return this.optionInternal(e,1)},n.prototype.OPTION2=function(e){return this.optionInternal(e,2)},n.prototype.OPTION3=function(e){return this.optionInternal(e,3)},n.prototype.OPTION4=function(e){return this.optionInternal(e,4)},n.prototype.OPTION5=function(e){return this.optionInternal(e,5)},n.prototype.OPTION6=function(e){return this.optionInternal(e,6)},n.prototype.OPTION7=function(e){return this.optionInternal(e,7)},n.prototype.OPTION8=function(e){return this.optionInternal(e,8)},n.prototype.OPTION9=function(e){return this.optionInternal(e,9)},n.prototype.OR=function(e){return this.orInternal(e,0)},n.prototype.OR1=function(e){return this.orInternal(e,1)},n.prototype.OR2=function(e){return this.orInternal(e,2)},n.prototype.OR3=function(e){return this.orInternal(e,3)},n.prototype.OR4=function(e){return this.orInternal(e,4)},n.prototype.OR5=function(e){return this.orInternal(e,5)},n.prototype.OR6=function(e){return this.orInternal(e,6)},n.prototype.OR7=function(e){return this.orInternal(e,7)},n.prototype.OR8=function(e){return this.orInternal(e,8)},n.prototype.OR9=function(e){return this.orInternal(e,9)},n.prototype.MANY=function(e){this.manyInternal(0,e)},n.prototype.MANY1=function(e){this.manyInternal(1,e)},n.prototype.MANY2=function(e){this.manyInternal(2,e)},n.prototype.MANY3=function(e){this.manyInternal(3,e)},n.prototype.MANY4=function(e){this.manyInternal(4,e)},n.prototype.MANY5=function(e){this.manyInternal(5,e)},n.prototype.MANY6=function(e){this.manyInternal(6,e)},n.prototype.MANY7=function(e){this.manyInternal(7,e)},n.prototype.MANY8=function(e){this.manyInternal(8,e)},n.prototype.MANY9=function(e){this.manyInternal(9,e)},n.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},n.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},n.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},n.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},n.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},n.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},n.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},n.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},n.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},n.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},n.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},n.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},n.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},n.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},n.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},n.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},n.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},n.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},n.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},n.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},n.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},n.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},n.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},n.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},n.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},n.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},n.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},n.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},n.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},n.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},n.prototype.RULE=function(e,t,r){if(r===void 0&&(r=eC),cr(this.definedRulesNames,e)){var i=BO.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),s={message:i,type:br.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(s)}this.definedRulesNames.push(e);var o=this.defineRule(e,t,r);return this[e]=o,o},n.prototype.OVERRIDE_RULE=function(e,t,r){r===void 0&&(r=eC);var i=[];i=i.concat(jge(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,i);var s=this.defineRule(e,t,r);return this[e]=s,s},n.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(i){if(Xy(i))return!1;throw i}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},n.prototype.getGAstProductions=function(){return this.gastProductionsCache},n.prototype.getSerializedGastProductions=function(){return ige(zr(this.gastProductionsCache))},n})(),Rpe=(function(){function n(){}return n.prototype.initRecognizerEngine=function(e,t){if(this.className=hpe(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=Yy,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},je(t,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(uo(e)){if(rn(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(uo(e))this.tokensMap=Pr(e,function(o,a){return o[a.name]=a,o},{});else if(je(e,"modes")&&bs(Li(zr(e.modes)),ege)){var r=Li(zr(e.modes)),i=_O(r);this.tokensMap=Pr(i,function(o,a){return o[a.name]=a,o},{})}else if(xO(e))this.tokensMap=ip(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=Kh;var s=bs(zr(e),function(o){return rn(o.categoryMatches)});this.tokenMatcher=s?Yy:wS,ap(zr(this.tokensMap))},n.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var i=je(r,"resyncEnabled")?r.resyncEnabled:eC.resyncEnabled,s=je(r,"recoveryValueFunc")?r.recoveryValueFunc:eC.recoveryValueFunc,o=this.ruleShortNameIdx<<wge+Su;this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=e,this.fullRuleNameToShort[e]=o;function a(h){try{if(this.outputCst===!0){t.apply(this,h);var c=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(c),c}else return t.apply(this,h)}catch(d){return this.invokeRuleCatch(d,i,s)}finally{this.ruleFinallyStateUpdate()}}var l;l=function(h,c){return h===void 0&&(h=0),this.ruleInvocationStateUpdate(o,e,h),a.call(this,c)};var u="ruleName";return l[u]=e,l.originalGrammarAction=t,l},n.prototype.invokeRuleCatch=function(e,t,r){var i=this.RULE_STACK.length===1,s=t&&!this.isBackTracking()&&this.recoveryEnabled;if(Xy(e)){var o=e;if(s){var a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))if(o.resyncedTokens=this.reSyncTo(a),this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return r();else{if(this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,o.partialCstResult=l}throw o}}else{if(i)return this.moveToTerminatedState(),r();throw o}}else throw e},n.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(qy,t),i=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(qy,t);return this.optionInternalLogic(e,t,r)},n.prototype.optionInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(e.DEF!==void 0){if(o=e.DEF,a=e.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=e;if(s.call(this)===!0)return o.call(this)},n.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Gm,e),i=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Gm,e);this.atLeastOneInternalLogic(e,t,r)},n.prototype.atLeastOneInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=t;if(s.call(this)===!0)for(var u=this.doSingleRepetition(o);s.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);else throw this.raiseEarlyExitException(e,an.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],s,Gm,e,Age)},n.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(gd,e),i=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(gd,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},n.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var i=this,s=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(r);if(a.call(this)===!0){s.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,s,EF],l,gd,e,EF)}else throw this.raiseEarlyExitException(e,an.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)},n.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead($m,e),i=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead($m,e);return this.manyInternalLogic(e,t,r)},n.prototype.manyInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=t;for(var u=!0;s.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],s,$m,e,Tge,u)},n.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(jm,e),i=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(jm,e);this.manySepFirstInternalLogic(e,t,r)},n.prototype.manySepFirstInternalLogic=function(e,t,r){var i=this,s=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(r);if(a.call(this)===!0){s.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,s,RF],l,jm,e,RF)}},n.prototype.repetitionSepSecondInternal=function(e,t,r,i,s){for(;r();)this.CONSUME(t),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,i,s],r,gd,e,s)},n.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();e.call(this);var r=this.getLexerPosition();return r>t},n.prototype.orInternalNoCst=function(e,t){var r=uo(e)?e:e.DEF,i=this.getKeyForAutomaticLookahead(Id,t),s=this.getLaFuncFromCache(i),o=s.call(this,r);if(o!==void 0){var a=r[o];return a.ALT.call(this)}this.raiseNoAltException(t,e.ERR_MSG)},n.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Id,t),i=this.nestedRuleBeforeClause(e,r);try{var s=uo(e)?e:e.DEF,o=this.getLaFuncFromCache(r),a=o.call(this,s);if(a!==void 0){var l=s[a],u=this.nestedAltBeforeClause(l,t,Id,a);try{return l.ALT.call(this)}finally{u!==void 0&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new bG(t,e))}},n.prototype.subruleInternal=function(e,t,r){var i;try{var s=r!==void 0?r.ARGS:void 0;return i=e.call(this,t,s),this.cstPostNonTerminal(i,r!==void 0&&r.LABEL!==void 0?r.LABEL:e.ruleName),i}catch(o){this.subruleInternalError(o,r,e.ruleName)}},n.prototype.subruleInternalError=function(e,t,r){throw Xy(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,t!==void 0&&t.LABEL!==void 0?t.LABEL:r),delete e.partialCstResult),e},n.prototype.consumeInternal=function(e,t,r){var i;try{var s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):this.consumeInternalError(e,s,r)}catch(o){i=this.consumeInternalRecovery(e,t,o)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:e.name,i),i},n.prototype.consumeInternalError=function(e,t,r){var i,s=this.LA(0);throw r!==void 0&&r.ERR_MSG?i=r.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new WO(i,t,s))},n.prototype.consumeInternalRecovery=function(e,t,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){var i=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===AG?r:s}}else throw r},n.prototype.saveRecogState=function(){var e=this.errors,t=Di(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},n.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},n.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},n.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},n.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},n.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},n.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),Kh)},n.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},n})(),Epe=(function(){function n(){}return n.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=gS(e.errorMessageProvider,Oi.errorMessageProvider)},n.prototype.SAVE_ERROR=function(e){if(Xy(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Di(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(n.prototype,"errors",{get:function(){return Di(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),n.prototype.raiseEarlyExitException=function(e,t,r){for(var i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],o=kO(e,s,t,this.maxLookahead),a=o[0],l=[],u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));var h=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:l,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new TG(h,this.LA(1),this.LA(0)))},n.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=FO(e,i,this.maxLookahead),o=[],a=1;a<=this.maxLookahead;a++)o.push(this.LA(a));var l=this.LA(0),u=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:o,previous:l,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new EG(u,this.LA(1),l))},n})(),bpe=(function(){function n(){}return n.prototype.initContentAssist=function(){},n.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if(Is(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return uG([r],t,this.tokenMatcher,this.maxLookahead)},n.prototype.getNextPossibleTokenTypes=function(e){var t=Ns(e.ruleStack),r=this.getGAstProductions(),i=r[t],s=new bge(i,e).startWalking();return s},n})(),SS={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(SS);var AF=!0,NF=Math.pow(2,Su)-1,MG=It({name:"RECORDING_PHASE_TOKEN",pattern:Pi.NA});ap([MG]);var OG=DO(MG,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(OG);var Tpe={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},Ape=(function(){function n(){}return n.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},n.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var t=function(i){var s=i>0?i:"";e["CONSUME"+s]=function(o,a){return this.consumeInternalRecord(o,i,a)},e["SUBRULE"+s]=function(o,a){return this.subruleInternalRecord(o,i,a)},e["OPTION"+s]=function(o){return this.optionInternalRecord(o,i)},e["OR"+s]=function(o){return this.orInternalRecord(o,i)},e["MANY"+s]=function(o){this.manyInternalRecord(i,o)},e["MANY_SEP"+s]=function(o){this.manySepFirstInternalRecord(i,o)},e["AT_LEAST_ONE"+s]=function(o){this.atLeastOneInternalRecord(i,o)},e["AT_LEAST_ONE_SEP"+s]=function(o){this.atLeastOneSepFirstInternalRecord(i,o)}},r=0;r<10;r++)t(r);e.consume=function(i,s,o){return this.consumeInternalRecord(s,i,o)},e.subrule=function(i,s,o){return this.subruleInternalRecord(s,i,o)},e.option=function(i,s){return this.optionInternalRecord(s,i)},e.or=function(i,s){return this.orInternalRecord(s,i)},e.many=function(i,s){this.manyInternalRecord(i,s)},e.atLeastOne=function(i,s){this.atLeastOneInternalRecord(i,s)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},n.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var t=0;t<10;t++){var r=t>0?t:"";delete e["CONSUME"+r],delete e["SUBRULE"+r],delete e["OPTION"+r],delete e["OR"+r],delete e["MANY"+r],delete e["MANY_SEP"+r],delete e["AT_LEAST_ONE"+r],delete e["AT_LEAST_ONE_SEP"+r]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},n.prototype.ACTION_RECORD=function(e){},n.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},n.prototype.LA_RECORD=function(e){return Jy},n.prototype.topLevelRuleRecord=function(e,t){try{var r=new sf({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(i){if(i.KNOWN_RECORDER_ERROR!==!0)try{i.message=i.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw i}throw i}},n.prototype.optionInternalRecord=function(e,t){return lm.call(this,xr,e,t)},n.prototype.atLeastOneInternalRecord=function(e,t){lm.call(this,Ms,t,e)},n.prototype.atLeastOneSepFirstInternalRecord=function(e,t){lm.call(this,Os,t,e,AF)},n.prototype.manyInternalRecord=function(e,t){lm.call(this,Yn,t,e)},n.prototype.manySepFirstInternalRecord=function(e,t){lm.call(this,Ji,t,e,AF)},n.prototype.orInternalRecord=function(e,t){return Npe.call(this,e,t)},n.prototype.subruleInternalRecord=function(e,t,r){if(Zy(t),!e||je(e,"ruleName")===!1){var i=new Error("<SUBRULE"+IF(t)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=jy(this.recordingProdStack),o=e.ruleName,a=new Zi({idx:t,nonTerminalName:o,referencedRule:void 0});return s.definition.push(a),this.outputCst?Tpe:SS},n.prototype.consumeInternalRecord=function(e,t,r){if(Zy(t),!sG(e)){var i=new Error("<CONSUME"+IF(t)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=jy(this.recordingProdStack),o=new xn({idx:t,terminalType:e});return s.definition.push(o),OG},n})();function lm(n,e,t,r){r===void 0&&(r=!1),Zy(t);var i=jy(this.recordingProdStack),s=Cu(e)?e:e.DEF,o=new n({definition:[],idx:t});return je(e,"NAME")&&(o.name=e.NAME),r&&(o.separator=e.SEP),je(e,"MAX_LOOKAHEAD")&&(o.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(o),s.call(this),i.definition.push(o),this.recordingProdStack.pop(),SS}function Npe(n,e){var t=this;Zy(e);var r=jy(this.recordingProdStack),i=uo(n)===!1,s=i===!1?n:n.DEF,o=new es({definition:[],idx:e,ignoreAmbiguities:i&&n.IGNORE_AMBIGUITIES===!0});je(n,"NAME")&&(o.name=n.NAME),je(n,"MAX_LOOKAHEAD")&&(o.maxLookahead=n.MAX_LOOKAHEAD);var a=Y$(s,function(l){return Cu(l.GATE)});return o.hasPredicates=a,r.definition.push(o),ze(s,function(l){var u=new Hi({definition:[]});o.definition.push(u),je(l,"NAME")&&(u.name=l.NAME),je(l,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=l.IGNORE_AMBIGUITIES:je(l,"GATE")&&(u.ignoreAmbiguities=!0),t.recordingProdStack.push(u),l.ALT.call(t),t.recordingProdStack.pop()}),SS}function IF(n){return n===0?"":""+n}function Zy(n){if(n<0||n>NF){var e=new Error("Invalid DSL Method idx value: <"+n+`>
	`+("Idx value must be a none negative value smaller than "+(NF+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}var Ipe=(function(){function n(){}return n.prototype.initPerformanceTracer=function(e){if(je(e,"traceInitPerf")){var t=e.traceInitPerf,r=typeof t=="number";this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=Oi.traceInitPerf;this.traceInitIndent=-1},n.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var i=X$(t),s=i.time,o=i.value,a=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(r+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,o}else return t()},n})(),_G=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),Jy=DO(Kh,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Jy);var Oi=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:wG,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),eC=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),br;(function(n){n[n.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",n[n.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",n[n.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",n[n.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",n[n.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",n[n.LEFT_RECURSION=5]="LEFT_RECURSION",n[n.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",n[n.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",n[n.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",n[n.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",n[n.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",n[n.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",n[n.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",n[n.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",n[n.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(br||(br={}));function Mpe(n){return n===void 0&&(n=void 0),function(){return n}}var $O=(function(){function n(e,t){t===void 0&&(t=Oi),this.ignoredIssues=Oi.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var r=this;r.initErrorHandler(t),r.initLexerAdapter(),r.initLooksAhead(t),r.initRecognizerEngine(e,t),r.initRecoverable(t),r.initTreeBuilder(t),r.initContentAssist(),r.initGastRecorder(t),r.initPerformanceTracer(t),je(t,"ignoredIssues")&&t.ignoredIssues!==Oi.ignoredIssues&&PO(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=je(t,"ignoredIssues")?t.ignoredIssues:Oi.ignoredIssues,this.skipValidations=je(t,"skipValidations")?t.skipValidations:Oi.skipValidations}return n.performSelfAnalysis=function(e){e.performSelfAnalysis()},n.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var t;e.selfAnalysisDone=!0;var r=e.className;e.TRACE_INIT("toFastProps",function(){q$(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),ze(e.definedRulesNames,function(s){var o=e[s],a=o.originalGrammarAction,l=void 0;e.TRACE_INIT(s+" Rule",function(){l=e.topLevelRuleRecord(s,a)}),e.gastProductionsCache[s]=l})}finally{e.disableRecording()}});var i=[];if(e.TRACE_INIT("Grammar Resolving",function(){i=spe({rules:zr(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,i)}),e.TRACE_INIT("Grammar Validations",function(){if(rn(i)&&e.skipValidations===!1){var s=ope({rules:zr(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:zr(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:BO,grammarName:r});e.definitionErrors.push.apply(e.definitionErrors,s)}}),rn(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var s=gge(zr(e.gastProductionsCache));e.resyncFollows=s}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(zr(e.gastProductionsCache))})),e.TRACE_INIT("expandAllNestedRuleNames",function(){var s=Rge(zr(e.gastProductionsCache),e.fullRuleNameToShort);e.allRuleNames=s.allRuleNames}),!n.DEFER_DEFINITION_ERRORS_HANDLING&&!rn(e.definitionErrors))throw t=Te(e.definitionErrors,function(s){return s.message}),new Error(`Parser Definition Errors detected:
 `+t.join(`
-------------------------------
`))})},n.DEFER_DEFINITION_ERRORS_HANDLING=!1,n})();gme($O,[ape,upe,ype,Cpe,Rpe,Spe,Epe,bpe,Ape,Ipe]);(function(n){_G(e,n);function e(t,r){r===void 0&&(r=Oi);var i=this,s=ip(r);return s.outputCst=!0,i=n.call(this,t,s)||this,i}return e})($O);var Ope=(function(n){_G(e,n);function e(t,r){r===void 0&&(r=Oi);var i=this,s=ip(r);return s.outputCst=!1,i=n.call(this,t,s)||this,i}return e})($O);const MF=(n,e)=>({type:n,message:e});var Fn;(function(n){n.LexingError="LexingError",n.ParserError="ParsingError",n.StaticOffsetError="StaticOffsetError",n.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",n.RangeOffsetNotAllowed="RangeOffsetNotAllowed",n.InvalidRangeSize="InvalidRangeSize"})(Fn||(Fn={}));var M;(function(n){n.EMPTY="EMPTY",n.NUMBER="NUMBER",n.STRING="STRING",n.MINUS_UNARY_OP="MINUS_UNARY_OP",n.PLUS_UNARY_OP="PLUS_UNARY_OP",n.PERCENT_OP="PERCENT_OP",n.CONCATENATE_OP="CONCATENATE_OP",n.EQUALS_OP="EQUALS_OP",n.NOT_EQUAL_OP="NOT_EQUAL_OP",n.GREATER_THAN_OP="GREATER_THAN_OP",n.LESS_THAN_OP="LESS_THAN_OP",n.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",n.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",n.PLUS_OP="PLUS_OP",n.MINUS_OP="MINUS_OP",n.TIMES_OP="TIMES_OP",n.DIV_OP="DIV_OP",n.POWER_OP="POWER_OP",n.FUNCTION_CALL="FUNCTION_CALL",n.NAMED_EXPRESSION="NAMED_EXPRESSION",n.PARENTHESIS="PARENTHESES",n.CELL_REFERENCE="CELL_REFERENCE",n.CELL_RANGE="CELL_RANGE",n.COLUMN_RANGE="COLUMN_RANGE",n.ROW_RANGE="ROW_RANGE",n.ERROR="ERROR",n.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",n.ARRAY="ARRAY"})(M||(M={}));var Rs;(function(n){n[n.RELATIVE=0]="RELATIVE",n[n.START_ABSOLUTE=1]="START_ABSOLUTE",n[n.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(Rs||(Rs={}));const _pe=n=>({type:M.EMPTY,leadingWhitespace:n?.image}),xpe=(n,e)=>({type:M.NUMBER,value:n,leadingWhitespace:e?.image}),Ppe=n=>{var e;return{type:M.STRING,value:n.image.slice(1,-1),leadingWhitespace:(e=n.leadingWhitespace)===null||e===void 0?void 0:e.image}},OF=(n,e)=>({type:M.CELL_REFERENCE,reference:n,leadingWhitespace:e?.image}),_F=(n,e,t,r)=>(GO(n,e,t),{type:M.CELL_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r}),Lpe=(n,e,t,r)=>(GO(n,e,t),{type:M.COLUMN_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r?.image}),Dpe=(n,e,t,r)=>(GO(n,e,t),{type:M.ROW_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r?.image}),Hpe=(n,e,t)=>({type:M.CONCATENATE_OP,left:n,right:e,leadingWhitespace:t?.image}),Fpe=(n,e,t)=>({type:M.EQUALS_OP,left:n,right:e,leadingWhitespace:t?.image}),kpe=(n,e,t)=>({type:M.NOT_EQUAL_OP,left:n,right:e,leadingWhitespace:t?.image}),Vpe=(n,e,t)=>({type:M.GREATER_THAN_OP,left:n,right:e,leadingWhitespace:t?.image}),Upe=(n,e,t)=>({type:M.LESS_THAN_OP,left:n,right:e,leadingWhitespace:t?.image}),Bpe=(n,e,t)=>({type:M.GREATER_THAN_OR_EQUAL_OP,left:n,right:e,leadingWhitespace:t?.image}),Wpe=(n,e,t)=>({type:M.LESS_THAN_OR_EQUAL_OP,left:n,right:e,leadingWhitespace:t?.image}),$pe=(n,e,t)=>({type:M.PLUS_OP,left:n,right:e,leadingWhitespace:t?.image}),Gpe=(n,e,t)=>({type:M.MINUS_OP,left:n,right:e,leadingWhitespace:t?.image}),jpe=(n,e,t)=>({type:M.TIMES_OP,left:n,right:e,leadingWhitespace:t?.image}),zpe=(n,e,t)=>({type:M.DIV_OP,left:n,right:e,leadingWhitespace:t?.image}),Ype=(n,e,t)=>({type:M.POWER_OP,left:n,right:e,leadingWhitespace:t?.image}),Kpe=(n,e)=>({type:M.MINUS_UNARY_OP,value:n,leadingWhitespace:e?.image}),qpe=(n,e)=>({type:M.PLUS_UNARY_OP,value:n,leadingWhitespace:e?.image}),Xpe=(n,e)=>({type:M.PERCENT_OP,value:n,leadingWhitespace:e?.image}),Qpe=(n,e,t,r,i)=>({type:M.FUNCTION_CALL,procedureName:n,args:e,leadingWhitespace:t?.image,internalWhitespace:r?.image,hyperlink:i}),xF=(n,e,t)=>({type:M.ARRAY,args:n,leadingWhitespace:e?.image,internalWhitespace:t?.image}),Zpe=(n,e)=>({type:M.NAMED_EXPRESSION,expressionName:n,leadingWhitespace:e?.image}),Jpe=(n,e,t)=>({type:M.PARENTHESIS,expression:n,leadingWhitespace:e?.image,internalWhitespace:t?.image}),ea=(n,e)=>({type:M.ERROR,error:n,leadingWhitespace:e?.image}),zc=(n,e,t)=>({type:M.ERROR_WITH_RAW_INPUT,error:e,rawInput:n,leadingWhitespace:t?.image}),LN=()=>({type:M.ERROR,error:E.parsingError()});function GO(n,e,t){if(n.sheet!==void 0&&e.sheet===void 0||n.sheet===void 0&&e.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(n.sheet===void 0&&t!==Rs.RELATIVE||n.sheet!==void 0&&t===Rs.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function Ot(n,e){return(e??"")+n}const xG={[M.PLUS_OP]:"+",[M.MINUS_OP]:"-",[M.TIMES_OP]:"*",[M.DIV_OP]:"/",[M.CONCATENATE_OP]:"&",[M.POWER_OP]:"^",[M.EQUALS_OP]:"=",[M.NOT_EQUAL_OP]:"<>",[M.GREATER_THAN_OP]:">",[M.GREATER_THAN_OR_EQUAL_OP]:">=",[M.LESS_THAN_OP]:"<",[M.LESS_THAN_OR_EQUAL_OP]:"<="};const ewe=(n,e,t,r)=>({ast:n,relativeDependencies:e,hasVolatileFunction:t,hasStructuralChangeFunction:r});class twe{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const r=ES(t,this.functionRegistry),i=ewe(t,r,Bl(t,this.functionRegistry.isFunctionVolatile),Bl(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,i),i}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const r=this.cache.get(e);return r!==void 0?r.ast:(this.set(e,t),t)}}const Bl=(n,e)=>{switch(n.type){case M.EMPTY:case M.NUMBER:case M.STRING:case M.ERROR:case M.ERROR_WITH_RAW_INPUT:case M.CELL_REFERENCE:case M.CELL_RANGE:case M.COLUMN_RANGE:case M.ROW_RANGE:case M.NAMED_EXPRESSION:return!1;case M.PERCENT_OP:case M.PLUS_UNARY_OP:case M.MINUS_UNARY_OP:return Bl(n.value,e);case M.CONCATENATE_OP:case M.EQUALS_OP:case M.NOT_EQUAL_OP:case M.LESS_THAN_OP:case M.GREATER_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.PLUS_OP:case M.TIMES_OP:case M.DIV_OP:case M.POWER_OP:return Bl(n.left,e)||Bl(n.right,e);case M.PARENTHESIS:return Bl(n.expression,e);case M.FUNCTION_CALL:return e(n.procedureName)?!0:n.args.some(t=>Bl(t,e));case M.ARRAY:return n.args.some(t=>t.some(r=>Bl(r,e)))}};class _{}_.DistinctSigns="Distinct signs.";_.WrongArgNumber="Wrong number of arguments.";_.EmptyArg="Empty function argument.";_.EmptyArray="Empty array not allowed.";_.ArrayDimensions="Array dimensions are not compatible.";_.NoSpaceForArrayResult="No space for array result.";_.ValueSmall="Value too small.";_.ValueLarge="Value too large.";_.BadCriterion="Incorrect criterion.";_.RangeManySheets="Range spans more than one sheet.";_.CellRangeExpected="Cell range expected.";_.WrongDimension="Wrong range dimension.";_.ScalarExpected="Cell range not allowed.";_.NumberCoercion="Value cannot be coerced to number.";_.NumberExpected="Number argument expected.";_.IntegerExpected="Value needs to be an integer.";_.BadMode="Mode not recognized.";_.DateBounds="Date outside of bounds.";_.OutOfSheet="Resulting reference is out of the sheet.";_.WrongType="Wrong type of argument.";_.NaN="NaN or infinite value encountered.";_.EqualLength="Ranges need to be of equal length.";_.Negative="Value cannot be negative.";_.NotBinary="String does not represent a binary number.";_.NotOctal="String does not represent an octal number.";_.NotHex="String does not represent a hexadecimal number.";_.EndStartPeriod="End period needs to be at least start period.";_.CellRefExpected="Cell reference expected.";_.EmptyRange="Empty range not allowed.";_.BadRef="Address is not correct.";_.NumberRange="Number-only range expected.";_.ValueNotFound="Value not found.";_.ValueBaseLarge="Value in base too large.";_.ValueBaseSmall="Value in base too small.";_.ValueBaseLong="Value in base too long.";_.NegativeLength="Length cannot be negative.";_.PatternNotFound="Pattern not found.";_.OneValue="Needs at least one value.";_.TwoValues="Range needs to contain at least two elements.";_.ThreeValues="Range needs to contain at least three elements.";_.IndexBounds="Index out of bounds.";_.IndexLarge="Index too large.";_.Formula="Expected formula.";_.NegativeCount="Count cannot be negative.";_.ParseError="Parsing error.";_.SheetRef="Sheet does not exist.";_.PeriodLong="Period number cannot exceed life length.";_.InvalidDate="Invalid date.";_.BitshiftLong="Result of bitshift is too long.";_.EmptyString="Empty-string argument not allowed.";_.LengthBounds="Length out of bounds.";_.NegativeTime="Time cannot be negative.";_.NoDefault="No default option.";_.NoConditionMet="None of the conditions were met.";_.Selector="Selector cannot exceed the number of arguments.";_.StartEndDate="Start date needs to be earlier than end date.";_.IncorrectDateTime="String does not represent correct DateTime.";_.CharacterCodeBounds="Character code out of bounds.";_.NonZero="Argument cannot be 0.";_.LessThanOne="Argument cannot be less than 1.";_.WeekendString="Incorrect weekend bitmask string.";_.InvalidRoman="Invalid roman numeral.";_.WrongOrder="Wrong order of values.";_.ComplexNumberExpected="Complex number expected.";_.ShouldBeIorJ="Should be 'i' or 'j'.";_.SizeMismatch="Array dimensions mismatched.";_.FunctionName=n=>`Function name ${n} not recognized.`;_.NamedExpressionName=n=>`Named expression ${n} not recognized.`;_.LicenseKey=n=>`License key is ${n}.`;class nwe{constructor(){this.POSSIBLE_START_CHARACTERS=[...$$,...ime,ai,"'","_"],this.cellReferenceRegexp=new RegExp(rme,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const r=this.cellReferenceRegexp.exec(e+"@");return r==null||r[1]==null?null:(r[0]=r[1],r)}}class rwe{constructor(){this.POSSIBLE_START_CHARACTERS=[...$$,"_"],this.namedExpressionRegexp=new RegExp(W$,"y"),this.r1c1CellRefRegexp=new RegExp(`^${B$}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const r=this.namedExpressionRegexp.exec(e);return r==null||r[0]==null||this.r1c1CellRefRegexp.test(r[0])?null:r}}const Sg=It({name:"AdditionOp",pattern:Pi.NA}),DN=It({name:"PlusOp",pattern:/\+/,categories:Sg}),HN=It({name:"MinusOp",pattern:/-/,categories:Sg}),RS=It({name:"MultiplicationOp",pattern:Pi.NA}),PG=It({name:"TimesOp",pattern:/\*/,categories:RS}),LG=It({name:"DivOp",pattern:/\//,categories:RS}),FN=It({name:"PowerOp",pattern:/\^/}),DG=It({name:"PercentOp",pattern:/%/}),Ru=It({name:"BooleanOp",pattern:Pi.NA}),kN=It({name:"EqualsOp",pattern:/=/,categories:Ru}),HG=It({name:"NotEqualOp",pattern:/<>/,categories:Ru}),FG=It({name:"GreaterThanOp",pattern:/>/,categories:Ru}),kG=It({name:"LessThanOp",pattern:/</,categories:Ru}),VG=It({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:Ru}),UG=It({name:"LessThanOrEqualOp",pattern:/<=/,categories:Ru}),BG=It({name:"ConcatenateOp",pattern:/&/}),VN=It({name:"LParen",pattern:/\(/}),Dv=It({name:"RParen",pattern:/\)/}),WG=It({name:"ArrayLParen",pattern:/{/}),$G=It({name:"ArrayRParen",pattern:/}/}),GG=It({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),jG=It({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),Rg=It({name:"RangeSeparator",pattern:new RegExp(rp)}),jO=It({name:"ColumnRange",pattern:new RegExp(`${JH}${rp}${JH}`)}),zO=It({name:"RowRange",pattern:new RegExp(`${eF}${rp}${eF}`)}),YO=It({name:"ProcedureName",pattern:new RegExp(`([${cS}][${MO}]*)\\(`)}),dA=new nwe,ru=It({name:"CellReference",pattern:dA.match.bind(dA),start_chars_hint:dA.POSSIBLE_START_CHARACTERS,line_breaks:!1}),fA=new rwe,zG=It({name:"NamedExpression",pattern:fA.match.bind(fA),start_chars_hint:fA.POSSIBLE_START_CHARACTERS,line_breaks:!1}),KO=n=>{const e=n.translationPackage.getFunctionTranslation("OFFSET"),t=n.errorMapping,r=n.translationPackage.buildFunctionMapping(),i=new RegExp(n.ignoreWhiteSpace==="standard"?tme:eme),s=It({name:"WhiteSpace",pattern:i}),o=It({name:"ArrayRowSep",pattern:n.arrayRowSeparator}),a=It({name:"ArrayColSep",pattern:n.arrayColumnSeparator}),l=It({name:"NumberLiteral",pattern:new RegExp(`(([${n.decimalSeparator}]\\d+)|(\\d+([${n.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),u=It({name:"OffsetProcedureName",pattern:new RegExp(e,"i")});let h,c;n.functionArgSeparator===n.arrayColumnSeparator?(h=a,c=[]):n.functionArgSeparator===n.arrayRowSeparator?(h=o,c=[]):(h=It({name:"ArgSeparator",pattern:n.functionArgSeparator}),c=[h]);const d=[s,DN,HN,PG,LG,FN,kN,HG,DG,VG,UG,FG,kG,VN,Dv,WG,$G,u,YO,Rg,...c,jO,zO,l,GG,jG,BG,Ru,Sg,RS,ru,zG,o,a];return{ArgSeparator:h,NumberLiteral:l,OffsetProcedureName:u,ArrayRowSeparator:o,ArrayColSeparator:a,WhiteSpace:s,allTokens:d,errorMapping:t,functionMapping:r,decimalSeparator:n.decimalSeparator,maxColumns:n.maxColumns,maxRows:n.maxRows}};class pd extends Ope{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:Mpe(_pe())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var r;const i=this.CONSUME(YO),s=i.image.toUpperCase().slice(0,-1),o=(r=this.lexerConfig.functionMapping[s])!==null&&r!==void 0?r:s,a=[];let l=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var h;const c=this.CONSUME(this.lexerConfig.ArgSeparator);l.type===M.EMPTY&&(l.leadingWhitespace=(h=c.leadingWhitespace)===null||h===void 0?void 0:h.image),a.push(l),l=this.SUBRULE2(this.booleanExpressionOrEmpty)}),a.push(l),a.length===1&&a[0].type===M.EMPTY&&(a.length=0);const u=this.CONSUME(Dv);return Qpe(o,a,i.leadingWhitespace,u.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const r=this.CONSUME(zG);return Zpe(r.image,r.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const r=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(VN),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{r.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(Dv),this.handleOffsetHeuristic(r)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const r=this.CONSUME(jO),[i,s]=r.image.split(":"),o=this.ACTION(()=>Wy(this.sheetMapping,i,this.formulaAddress)),a=this.ACTION(()=>Wy(this.sheetMapping,s,this.formulaAddress));if(o===void 0||a===void 0)return ea(new E(N.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return zc(r.image,new E(N.NAME),r.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Fn.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:h}=pd.fixSheetIdsForRangeEnds(o,a);return Lpe(l,u,h,r.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const r=this.CONSUME(zO),[i,s]=r.image.split(":"),o=this.ACTION(()=>$y(this.sheetMapping,i,this.formulaAddress)),a=this.ACTION(()=>$y(this.sheetMapping,s,this.formulaAddress));if(o===void 0||a===void 0)return ea(new E(N.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return zc(r.image,new E(N.NAME),r.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Fn.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:h}=pd.fixSheetIdsForRangeEnds(o,a);return Dpe(l,u,h,r.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const r=this.CONSUME(ru),i=this.ACTION(()=>rd(this.sheetMapping,r.image,this.formulaAddress));return i===void 0?zc(r.image,new E(N.REF),r.leadingWhitespace):i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?zc(r.image,new E(N.NAME),r.leadingWhitespace):OF(i,r.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",r=>{var i;const s=this.CONSUME(ru),o=this.ACTION(()=>rd(this.sheetMapping,r.image,this.formulaAddress)),a=this.ACTION(()=>rd(this.sheetMapping,s.image,this.formulaAddress));return o===void 0||a===void 0?this.ACTION(()=>zc(`${r.image}:${s.image}`,new E(N.REF),r.leadingWhitespace)):o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>zc(`${r.image}:${s.image}`,new E(N.NAME),r.leadingWhitespace)):this.buildCellRange(o,a,(i=r.leadingWhitespace)===null||i===void 0?void 0:i.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",r=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[r]})},{ALT:()=>{var i;const s=this.SUBRULE(this.offsetProcedureExpression),o=this.ACTION(()=>rd(this.sheetMapping,r.image,this.formulaAddress));return o===void 0?ea(new E(N.REF)):s.type===M.CELL_REFERENCE?this.buildCellRange(o,s.reference,(i=r.leadingWhitespace)===null||i===void 0?void 0:i.image):this.parsingError(Fn.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const r=this.CONSUME(ru);return this.CONSUME2(Rg),this.SUBRULE(this.endOfRangeExpression,{ARGS:[r]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",r=>{const i=this.CONSUME(ru),s=this.ACTION(()=>rd(this.sheetMapping,i.image,this.formulaAddress));return s===void 0?this.ACTION(()=>ea(new E(N.REF))):this.buildCellRange(r.reference,s,r.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",r=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[r]})},{ALT:()=>{const i=this.SUBRULE(this.offsetProcedureExpression);return i.type===M.CELL_REFERENCE?this.buildCellRange(r.reference,i.reference,r.leadingWhitespace):this.parsingError(Fn.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const r=this.SUBRULE(this.offsetProcedureExpression);let i;return this.OPTION(()=>{this.CONSUME(Rg),r.type===M.CELL_RANGE?i=this.parsingError(Fn.RangeOffsetNotAllowed,"Range offset not allowed here"):i=this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[r]})}),i!==void 0?i:r}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const r=[[]];return r[r.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),r[r.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),r.push([]),r[r.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),xF(r)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const r=this.CONSUME(VN),i=this.SUBRULE(this.booleanExpression),s=this.CONSUME(Dv);return Jpe(i,r.leadingWhitespace,s.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const r=this.CONSUME(WG),i=this.SUBRULE(this.insideArrayExpression),s=this.CONSUME($G);return xF(i.args,r.leadingWhitespace,s.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=r=>{const i=r.replace(this.lexerConfig.decimalSeparator,".");return Number(i)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var r;return this.OR((r=this.atomicExpCache)!==null&&r!==void 0?r:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const i=this.CONSUME(this.lexerConfig.NumberLiteral);return xpe(this.numericStringToNumber(i.image),i.leadingWhitespace)}},{ALT:()=>{const i=this.CONSUME(GG);return Ppe(i)}},{ALT:()=>{const i=this.CONSUME(jG),s=i.image.toUpperCase(),o=this.lexerConfig.errorMapping[s];return o?ea(new E(o),i.leadingWhitespace):this.parsingError(Fn.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const r=this.SUBRULE(this.positiveAtomicExpression),i=this.OPTION(()=>this.CONSUME(DG));return i?Xpe(r,i.leadingWhitespace):r}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const r=this.CONSUME(Sg),i=this.SUBRULE(this.atomicExpression);return Qt(r,DN)?qpe(i,r.leadingWhitespace):Qt(r,HN)?Kpe(i,r.leadingWhitespace):(this.customParsingError=MF(Fn.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let r=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const i=this.CONSUME(FN),s=this.SUBRULE2(this.atomicExpression);Qt(i,FN)?r=Ype(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let r=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const i=this.CONSUME(RS),s=this.SUBRULE2(this.powerExpression);Qt(i,PG)?r=jpe(r,s,i.leadingWhitespace):Qt(i,LG)?r=zpe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.additionExpression=this.RULE("additionExpression",()=>{let r=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const i=this.CONSUME(Sg),s=this.SUBRULE2(this.multiplicationExpression);Qt(i,DN)?r=$pe(r,s,i.leadingWhitespace):Qt(i,HN)?r=Gpe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let r=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const i=this.CONSUME(BG),s=this.SUBRULE2(this.additionExpression);r=Hpe(r,s,i.leadingWhitespace)}),r}),this.booleanExpression=this.RULE("booleanExpression",()=>{let r=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const i=this.CONSUME(Ru),s=this.SUBRULE2(this.concatenateExpression);Qt(i,kN)?r=Fpe(r,s,i.leadingWhitespace):Qt(i,HG)?r=kpe(r,s,i.leadingWhitespace):Qt(i,FG)?r=Vpe(r,s,i.leadingWhitespace):Qt(i,kG)?r=Upe(r,s,i.leadingWhitespace):Qt(i,VG)?r=Bpe(r,s,i.leadingWhitespace):Qt(i,UG)?r=Wpe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.formula=this.RULE("formula",()=>(this.CONSUME(kN),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=Ce(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let r=this.formulaWithContext(t),i=[];return this.customParsingError&&i.push(this.customParsingError),i=i.concat(this.errors.map(s=>({type:Fn.ParserError,message:s.message}))),i.length>0&&(r=LN()),{ast:r,errors:i}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,r){if(e.sheet===void 0&&t.sheet!==void 0)return this.parsingError(Fn.ParserError,"Malformed range expression");const{firstEnd:i,secondEnd:s,sheetRefType:o}=pd.fixSheetIdsForRangeEnds(e,t);return _F(i,s,o,r)}static fixSheetIdsForRangeEnds(e,t){const r=pd.rangeSheetReferenceType(e.sheet,t.sheet),i=e.sheet!==void 0&&t.sheet===void 0?t.withSheet(e.sheet):t;return{firstEnd:e,secondEnd:i,sheetRefType:r}}handleOffsetHeuristic(e){const t=e[0];if(t.type!==M.CELL_REFERENCE)return this.parsingError(Fn.StaticOffsetError,"First argument to OFFSET is not a reference");const r=e[1];let i;if(r.type===M.NUMBER&&Number.isInteger(r.value))i=r.value;else if(r.type===M.PLUS_UNARY_OP&&r.value.type===M.NUMBER&&Number.isInteger(r.value.value))i=r.value.value;else if(r.type===M.MINUS_UNARY_OP&&r.value.type===M.NUMBER&&Number.isInteger(r.value.value))i=-r.value.value;else return this.parsingError(Fn.StaticOffsetError,"Second argument to OFFSET is not a static number");const s=e[2];let o;if(s.type===M.NUMBER&&Number.isInteger(s.value))o=s.value;else if(s.type===M.PLUS_UNARY_OP&&s.value.type===M.NUMBER&&Number.isInteger(s.value.value))o=s.value.value;else if(s.type===M.MINUS_UNARY_OP&&s.value.type===M.NUMBER&&Number.isInteger(s.value.value))o=-s.value.value;else return this.parsingError(Fn.StaticOffsetError,"Third argument to OFFSET is not a static number");const a=e[3];let l;if(a===void 0)l=1;else if(a.type===M.NUMBER){if(l=a.value,l<1)return this.parsingError(Fn.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(l))return this.parsingError(Fn.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(Fn.StaticOffsetError,"Fourth argument to OFFSET is not a static number");const u=e[4];let h;if(u===void 0)h=1;else if(u.type===M.NUMBER){if(h=u.value,h<1)return this.parsingError(Fn.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(h))return this.parsingError(Fn.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(Fn.StaticOffsetError,"Fifth argument to OFFSET is not a static number");const c=new nn(t.reference.col+o,t.reference.row+i,t.reference.type);let d=c.col,f=c.row;if((t.reference.type===Gt.CELL_REFERENCE_RELATIVE||t.reference.type===Gt.CELL_REFERENCE_ABSOLUTE_COL)&&(f=f+this.formulaAddress.row),(t.reference.type===Gt.CELL_REFERENCE_RELATIVE||t.reference.type===Gt.CELL_REFERENCE_ABSOLUTE_ROW)&&(d=d+this.formulaAddress.col),d<0||f<0)return ea(new E(N.REF,_.OutOfSheet));if(h===1&&l===1)return OF(c);{const m=new nn(c.col+h-1,c.row+l-1,c.type);return _F(c,m,Rs.RELATIVE)}}parsingError(e,t){return this.customParsingError=MF(e,t),LN()}static rangeSheetReferenceType(e,t){return e===void 0?Rs.RELATIVE:t===void 0?Rs.START_ABSOLUTE:Rs.BOTH_ABSOLUTE}}class tC{constructor(e){this.lexerConfig=e,this.lexer=new Pi(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let r=t.tokens;return r=this.trimTrailingWhitespaces(r),r=this.skipWhitespacesInsideRanges(r),r=this.skipWhitespacesBeforeArgSeparators(r),t.tokens=r,t}skipWhitespacesInsideRanges(e){return tC.filterTokensByNeighbors(e,(t,r,i)=>(Qt(t,ru)||Qt(t,Rg))&&Qt(r,this.lexerConfig.WhiteSpace)&&(Qt(i,ru)||Qt(i,Rg)))}skipWhitespacesBeforeArgSeparators(e){return tC.filterTokensByNeighbors(e,(t,r,i)=>!Qt(t,this.lexerConfig.ArgSeparator)&&Qt(r,this.lexerConfig.WhiteSpace)&&Qt(i,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let r=0;const i=[e[r++]];for(;r<e.length-1;)t(e[r-1],e[r],e[r+1])||i.push(e[r]),++r;return i.push(e[r]),i}trimTrailingWhitespaces(e){return e.length>0&&Qt(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}class YG{constructor(e,t,r,i){this.config=e,this.lexerConfig=t,this.sheetMappingFn=r,this.namedExpressions=i}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var r,i;switch(e.type){case M.EMPTY:return Ot("",e.leadingWhitespace);case M.NUMBER:return Ot(KG(e.value,this.config.decimalSeparator),e.leadingWhitespace);case M.STRING:return Ot('"'+e.value+'"',e.leadingWhitespace);case M.FUNCTION_CALL:{const s=e.args.map(l=>l!==void 0?this.unparseAst(l,t):"").join(this.config.functionArgSeparator),a=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+s+Ot(")",e.internalWhitespace);return Ot(a,e.leadingWhitespace)}case M.NAMED_EXPRESSION:{const s=(r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))===null||r===void 0?void 0:r.displayName;return Ot(s||e.expressionName,e.leadingWhitespace)}case M.CELL_REFERENCE:{let s;return e.reference.sheet!==void 0?s=this.unparseSheetName(e.reference.sheet)+"!":s="",s+=(i=e.reference.unparse(t))!==null&&i!==void 0?i:this.config.translationPackage.getErrorTranslation(N.REF),Ot(s,e.leadingWhitespace)}case M.COLUMN_RANGE:case M.ROW_RANGE:case M.CELL_RANGE:return Ot(this.formatRange(e,t),e.leadingWhitespace);case M.PLUS_UNARY_OP:{const s=this.unparseAst(e.value,t);return Ot("+",e.leadingWhitespace)+s}case M.MINUS_UNARY_OP:{const s=this.unparseAst(e.value,t);return Ot("-",e.leadingWhitespace)+s}case M.PERCENT_OP:return this.unparseAst(e.value,t)+Ot("%",e.leadingWhitespace);case M.ERROR:{const s=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:N.ERROR);return Ot(s,e.leadingWhitespace)}case M.ERROR_WITH_RAW_INPUT:return Ot(e.rawInput,e.leadingWhitespace);case M.PARENTHESIS:{const o="("+this.unparseAst(e.expression,t)+Ot(")",e.internalWhitespace);return Ot(o,e.leadingWhitespace)}case M.ARRAY:{const s="{"+e.args.map(o=>o.map(a=>this.unparseAst(a,t)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+Ot("}",e.internalWhitespace);return Ot(s,e.leadingWhitespace)}default:{const s=this.unparseAst(e.left,t),o=this.unparseAst(e.right,t);return s+Ot(xG[e.type],e.leadingWhitespace)+o}}}unparseSheetName(e){const t=j$(e,this.sheetMappingFn);if(t===void 0)throw new Nn(e);return t}formatRange(e,t){let r="",i="";e.start.sheet!==void 0&&e.sheetReferenceType!==Rs.RELATIVE&&(r=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===Rs.BOTH_ABSOLUTE&&(i=this.unparseSheetName(e.end.sheet)+"!");const s=e.start.unparse(t),o=e.end.unparse(t);return s===void 0||o===void 0?this.config.translationPackage.getErrorTranslation(N.REF):`${r}${s}:${i}${o}`}}function KG(n,e){return n.toString().replace(".",e)}class Ym{constructor(e,t,r){this.config=e,this.functionRegistry=t,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=KO(e),this.lexer=new tC(this.lexerConfig),this.formulaParser=new pd(this.lexerConfig,this.sheetMapping),this.cache=new twe(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const r=this.tokenizeFormula(e);if(r.errors.length>0){const c=r.errors.map(d=>({type:Fn.LexingError,message:d.message}));return{ast:LN(),errors:c,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const i=this.computeHashFromTokens(r.tokens,t);let s=this.cache.get(i);if(s!==void 0)++this.statsCacheUsed;else{const c=this.bindWhitespacesToTokens(r.tokens),d=this.formulaParser.parseFromTokens(c,t);if(d.errors.length>0)return Object.assign(Object.assign({},d),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});s=this.cache.set(i,d.ast)}const{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l}=s,u=this.convertReversedRangesToRegularRanges(o),h=ES(u,this.functionRegistry);return{ast:u,errors:[],hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:h}}convertReversedRangesToRegularRanges(e){switch(e.type){case M.EMPTY:case M.NUMBER:case M.STRING:case M.ERROR:case M.ERROR_WITH_RAW_INPUT:case M.CELL_REFERENCE:case M.NAMED_EXPRESSION:return e;case M.CELL_RANGE:{const{start:t,end:r}=e,i=this.orderCellRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case M.COLUMN_RANGE:{const{start:t,end:r}=e,i=this.orderColumnRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case M.ROW_RANGE:{const{start:t,end:r}=e,i=this.orderRowRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case M.PERCENT_OP:case M.PLUS_UNARY_OP:case M.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case M.CONCATENATE_OP:case M.EQUALS_OP:case M.NOT_EQUAL_OP:case M.LESS_THAN_OP:case M.GREATER_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.PLUS_OP:case M.TIMES_OP:case M.DIV_OP:case M.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),r=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:r})}case M.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case M.FUNCTION_CALL:{const t=e.args.map(r=>this.convertReversedRangesToRegularRanges(r));return Object.assign(Object.assign({},e),{args:t})}case M.ARRAY:{const t=e.args.map(r=>r.map(i=>this.convertReversedRangesToRegularRanges(i)));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const r=[e,t],[i,s]=r.map(h=>h.toColumnAddress()).sort(si.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(h=>h.toRowAddress()).sort(Gr.compareByAbsoluteAddress(this.formulaAddress)),[l,u]=r.map(h=>h.sheet).sort(Ym.compareSheetIds.bind(this));return{start:nn.fromColAndRow(i,o,l),end:nn.fromColAndRow(s,a,u)}}orderColumnRangeEnds(e,t){const r=[e,t],[i,s]=r.sort(si.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(l=>l.sheet).sort(Ym.compareSheetIds.bind(this));return{start:new si(i.type,i.col,o),end:new si(s.type,s.col,a)}}orderRowRangeEnds(e,t){const r=[e,t],[i,s]=r.sort(Gr.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(l=>l.sheet).sort(Ym.compareSheetIds.bind(this));return{start:new Gr(i.type,i.row,o),end:new Gr(s.type,s.row,a)}}static compareSheetIds(e,t){return e=e??1/0,t=t??1/0,e-t}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(t===void 0)throw new Error("There is no AST with such key in the cache");{const{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,relativeDependencies:o}=t;return{ast:r,errors:[],hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}}}computeHashFromTokens(e,t){var r;let i="",s=0;for(;s<e.length;){const o=e[s];if(Qt(o,ru)){const a=rd(this.sheetMapping,o.image,t);a===void 0?i=i.concat(o.image):i=i.concat(a.hash(!0))}else if(Qt(o,YO)){const a=o.image.toUpperCase().slice(0,-1),l=(r=this.lexerConfig.functionMapping[a])!==null&&r!==void 0?r:a;i=i.concat(l,"(")}else if(Qt(o,jO)){const[a,l]=o.image.split(":"),u=Wy(this.sheetMapping,a,t),h=Wy(this.sheetMapping,l,t);u===void 0||h===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",h.hash(!0))}else if(Qt(o,zO)){const[a,l]=o.image.split(":"),u=$y(this.sheetMapping,a,t),h=$y(this.sheetMapping,l,t);u===void 0||h===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",h.hash(!0))}else i=i.concat(o.image);s++}return i}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case M.EMPTY:return e.leadingWhitespace||"";case M.NUMBER:return Ot(KG(e.value,this.config.decimalSeparator),e.leadingWhitespace);case M.STRING:return Ot('"'+e.value+'"',e.leadingWhitespace);case M.NAMED_EXPRESSION:return Ot(e.expressionName,e.leadingWhitespace);case M.FUNCTION_CALL:{const t=e.args.map(i=>this.computeHashOfAstNode(i)).join(this.config.functionArgSeparator),r=e.procedureName+"("+t+Ot(")",e.internalWhitespace);return Ot(r,e.leadingWhitespace)}case M.CELL_REFERENCE:return Ot(e.reference.hash(!0),e.leadingWhitespace);case M.COLUMN_RANGE:case M.ROW_RANGE:case M.CELL_RANGE:{const t=e.start.hash(e.sheetReferenceType!==Rs.RELATIVE),r=e.end.hash(e.sheetReferenceType===Rs.BOTH_ABSOLUTE);return Ot(t+":"+r,e.leadingWhitespace)}case M.MINUS_UNARY_OP:return Ot("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case M.PLUS_UNARY_OP:return Ot("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case M.PERCENT_OP:return this.computeHashOfAstNode(e.value)+Ot("%",e.leadingWhitespace);case M.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:N.ERROR);return Ot(t,e.leadingWhitespace)}case M.ERROR_WITH_RAW_INPUT:return Ot(e.rawInput,e.leadingWhitespace);case M.ARRAY:{const t=e.args.map(r=>r.map(i=>this.computeHashOfAstNode(i)).join(",")).join(";");return Ot("{"+t+Ot("}",e.internalWhitespace),e.leadingWhitespace)}case M.PARENTHESIS:{const r="("+this.computeHashOfAstNode(e.expression)+Ot(")",e.internalWhitespace);return Ot(r,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+Ot(xG[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],r=e[0];Qt(r,this.lexerConfig.WhiteSpace)||t.push(r);for(let i=1;i<e.length;++i){const s=e[i];if(Qt(s,this.lexerConfig.WhiteSpace))continue;const o=e[i-1];Qt(o,this.lexerConfig.WhiteSpace)&&(s.leadingWhitespace=o),t.push(s)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}const id=(n,e,t,r)=>{switch(n.type){case M.EMPTY:case M.NUMBER:case M.STRING:case M.ERROR:return;case M.NAMED_EXPRESSION:{r&&t.push(new rl(n.expressionName));return}case M.CELL_REFERENCE:{r&&t.push(new qG(n.reference));return}case M.CELL_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new iwe(n.start,n.end));return}case M.COLUMN_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new swe(n.start,n.end));return}case M.ROW_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new owe(n.start,n.end));return}case M.PERCENT_OP:case M.PLUS_UNARY_OP:case M.MINUS_UNARY_OP:{id(n.value,e,t,!0);return}case M.CONCATENATE_OP:case M.EQUALS_OP:case M.NOT_EQUAL_OP:case M.LESS_THAN_OP:case M.GREATER_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.PLUS_OP:case M.TIMES_OP:case M.DIV_OP:case M.POWER_OP:id(n.left,e,t,!0),id(n.right,e,t,!0);return;case M.PARENTHESIS:id(n.expression,e,t,r);return;case M.FUNCTION_CALL:{const i=!e.doesFunctionNeedArgumentToBeComputed(n.procedureName);n.args.forEach(s=>id(s,e,t,i));return}}},ES=(n,e)=>{const t=new Array;return id(n,e,t,!0),t};class qG{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class iwe{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new Le(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class swe{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),r=this.end.toSimpleColumnAddress(e);return new ol(t.sheet,t.col,r.col)}}class owe{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),r=this.end.toSimpleRowAddress(e);return new al(t.sheet,t.row,r.row)}}class rl{constructor(e){this.name=e}absolutize(e){return this}}const ta=(n,e)=>n.map(t=>t.absolutize(e)),awe=n=>n.filter(e=>e instanceof rl?!0:e instanceof Le?!(_i(e.start)||_i(e.end)):!_i(e));const ft=Symbol("Empty value");function pe(n){return n instanceof Ra?n.val:n}class Ra{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function qO(n,e){if(typeof n=="number")return e;{const t=n.fromNumber(e);return t.format=n.format,t}}class XO extends Ra{getDetailedType(){return Ie.NUMBER_DATE}}class UN extends Ra{getDetailedType(){return Ie.NUMBER_CURRENCY}}class QO extends Ra{getDetailedType(){return Ie.NUMBER_TIME}}class ZO extends Ra{getDetailedType(){return Ie.NUMBER_DATETIME}}class Hv extends Ra{getDetailedType(){return Ie.NUMBER_PERCENT}}function Lt(n){return typeof n=="number"||n instanceof Ra}var Ie;(function(n){n.NUMBER_RAW="NUMBER_RAW",n.NUMBER_DATE="NUMBER_DATE",n.NUMBER_TIME="NUMBER_TIME",n.NUMBER_DATETIME="NUMBER_DATETIME",n.NUMBER_CURRENCY="NUMBER_CURRENCY",n.NUMBER_PERCENT="NUMBER_PERCENT"})(Ie||(Ie={}));function lwe(n){return n instanceof Ra?n.getDetailedType():Ie.NUMBER_RAW}function uwe(n){if(n instanceof Ra)return n.format}function nC(n){return n instanceof Ra?{type:n.getDetailedType(),format:n.format}:{type:Ie.NUMBER_RAW}}class Me{constructor(e,t,r,i){this._data=e,this.range=t,this.dependencyGraph=r,this._hasOnlyNumbers=i,this.size=e===void 0?new Ct(t.effectiveWidth(r),t.effectiveHeight(r)):new Ct(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,r){return new Me(e,t,r,!0)}static onlyNumbers(e){return new Me(e,void 0,void 0,!0)}static onlyValues(e){return new Me(e,void 0,void 0,void 0)}static onlyRange(e,t){return new Me(void 0,e,t,void 0)}static fromScalar(e){return new Me([[e]],void 0,void 0,void 0)}isAdHoc(){return this.range===void 0}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let r=0;r<this._data[0].length;r++)e.push(this._data[t][r]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const r=this.data[t];for(let i=0;i<r.length;++i)yield Ce(e.sheet,e.col+i,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let r=0;r<this.size.width;++r)yield[this._data[t][r],Ce(e.sheet,e.col+r,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if(typeof t!="number")return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof Me?(this._hasOnlyNumbers=!1,new E(N.VALUE,_.ScalarExpected)):(Lt(t)||(this._hasOnlyNumbers=!1),t)}))}}class uu{constructor(){this.changes=new Map}static empty(){return new uu}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,r){this.addInterpreterValue(e,t,r)}exportChanges(e){let t=[];return this.changes.forEach(r=>{const i=e.exportChange(r);Array.isArray(i)?t=t.concat(i):t.push(i)}),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return this.changes.size===0}add(e,t){const r=t.value;if(r instanceof Me)for(const i of r.effectiveAddressesFromData(e))this.changes.delete(Km(i));this.changes.set(Km(e),t)}addInterpreterValue(e,t,r){this.add(t,{address:t,value:e,oldValue:r})}}class xi{constructor(e,t,r){if(this.sheet=e,this.rowStart=t,this.rowEnd=r,t<0)throw Error("Starting row cant be less than 0");if(r<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,r){return new xi(e,t,t+r-1)}static fromRowStartAndEnd(e,t,r){return new xi(e,t,r)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),r=Math.min(this.rowEnd,e.rowEnd);return t>r?null:new xi(this.sheet,t,r)}firstRow(){return new xi(this.sheet,this.rowStart,this.rowStart)}}class Xi{constructor(e,t,r){if(this.sheet=e,this.columnStart=t,this.columnEnd=r,t<0)throw Error("Starting column cant be less than 0");if(r<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,r){return new Xi(e,t,t+r-1)}static fromColumnStartAndEnd(e,t,r){return new Xi(e,t,r)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),r=Math.min(this.columnEnd,e.columnEnd);return t>r?null:new Xi(this.sheet,t,r)}firstColumn(){return new Xi(this.sheet,this.columnStart,this.columnStart)}}var tt;(function(n){n.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",n.PARSER="PARSER",n.GRAPH_BUILD="GRAPH_BUILD",n.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",n.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",n.TOP_SORT="TOP_SORT",n.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",n.EVALUATION="EVALUATION",n.VLOOKUP="VLOOKUP",n.TRANSFORM_ASTS="TRANSFORM_ASTS",n.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",n.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",n.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",n.ADJUSTING_RANGES="ADJUSTING_RANGES",n.ADJUSTING_GRAPH="ADJUSTING_GRAPH",n.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",n.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(tt||(tt={}));class XG{constructor(){this.stats=new Map([[tt.CRITERION_FUNCTION_FULL_CACHE_USED,0],[tt.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=((e=this.stats.get(tt.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(tt.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=((e=this.stats.get(tt.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(tt.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(tt.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(tt.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const r=Date.now(),i=this.startTimes.get(e);if(i){let s=(t=this.stats.get(e))!==null&&t!==void 0?t:0;s+=r-i,this.stats.set(e,s),this.startTimes.delete(e)}else throw Error(`Statistics ${e} not started`)}measure(e,t){this.start(e);const r=t();return this.end(e),r}snapshot(){return new Map(this.stats)}}class hwe extends XG{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}class Nn extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class QG extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class Eg extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class Hh extends Error{constructor(){super("Sheet size limit exceeded")}}class Fv extends Error{constructor(){super("This is not a formula")}}class ZG extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class Jn extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class bg extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class JG extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class ej extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class Tg extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class tj extends Error{constructor(){super("There is no operation to undo")}}class nj extends Error{constructor(){super("There is no operation to redo")}}class rj extends Error{constructor(){super("There is nothing to paste")}}function cwe(n,e){switch(typeof e){case"function":case"symbol":return e.toString();case"bigint":return"BigInt("+e.toString()+")";default:return e instanceof RegExp?"RegExp("+e.toString()+")":e}}class ij extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,cwe,4)}`)}}class xt extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class dwe extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class sj extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class oj extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class aj extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class lj extends Error{constructor(){super("Computations are suspended")}}class sd extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class uj extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class BN extends Error{constructor(){super("Language not registered.")}}class hj extends Error{constructor(){super("Language already registered.")}}class $d extends Error{static functionNotDeclaredInPlugin(e,t){return new $d(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new $d(`Function method ${e} not found in plugin ${t}`)}}class Fh extends Error{static cannotRegisterFunctionWithId(e){return new Fh(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new Fh(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new Fh("Cannot unregister protected plugin")}}class wd extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class rC extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class JO extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class fwe extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}class mwe{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new Nn(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new Nn(e.sheet);const r=t.getCell(e);if(!r)throw Error("Vertex for address missing in AddressMapping");return r}strategyFor(e){const t=this.mapping.get(e);if(t===void 0)throw new Nn(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){const{height:r,width:i,fill:s}=t,o=this.policy.call(s);this.addSheet(e,new o(i,r))}getCellValue(e){const t=this.getCell(e);return t===void 0?ft:t instanceof zn?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof hu?t.getValues().rawValue:t instanceof zn?t.getArrayCellRawValue(e):null}setCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.setCell(e,t)}moveCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(r.has(t))throw new Error("Cannot move cell. Destination already occupied.");const i=r.getCell(e);if(i===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,i),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return t===void 0?!1:t.has(e)}getHeight(e){const t=this.mapping.get(e);if(t===void 0)throw new Nn(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new Nn(e);return t.getWidth()}addRows(e,t,r){const i=this.mapping.get(e);if(i===void 0)throw new Nn(e);i.addRows(t,r)}removeRows(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new Nn(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,r){const i=this.mapping.get(e);if(i===void 0)throw new Nn(e);i.addColumns(t,r)}removeColumns(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new Nn(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(t!==void 0)yield*t.getEntries(e);else throw new Nn(e)}}class gwe{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(t?.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(Km(e))}setArray(e,t){this.arrayMapping.set(Km(e.start),t)}removeArray(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(Km(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,r])}*arraysInCols(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,r])}isFormulaArrayInRow(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const r of e.rows())this.isFormulaArrayInRow(e.sheet,r)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const r of e.columns())this.isFormulaArrayInColumn(e.sheet,r)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,r){this.updateArrayVerticesInSheet(e,(i,s)=>{const o=s.getRange();return t<=o.start.row?[o.shifted(0,r),s]:void 0})}moveArrayVerticesAfterColumnByColumns(e,t,r){this.updateArrayVerticesInSheet(e,(i,s)=>{const o=s.getRange();return t<=o.start.col?[o.shifted(r,0),s]:void 0})}updateArrayVerticesInSheet(e,t){const r=Array();for(const[i,s]of this.arrayMapping.entries()){if(s.sheet!==e)continue;const o=t(i,s);o!==void 0&&(this.removeArray(i),r.push(o))}r.forEach(([i,s])=>{this.setArray(i,s)})}}class wm{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class Gd{constructor(e){if(this.size=new Ct(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return e instanceof Me?new Gd(e.data):new Gd([[e]])}simpleRangeValue(){return Me.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let r=0;r<this.height();r++)this.array[r].splice(e,0,...new Array(t).fill(ft));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const r=t-e+1;this.array.splice(e,r),this.size.height-=r}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const r=t-e+1;for(const i of this.array)i.splice(e,r);this.size.width-=r}nullArrays(e,t){const r=[];for(let i=0;i<e;++i)r.push(new Array(t).fill(ft));return r}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,r){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=r}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class mA{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}class Qi{constructor(e,t,r){this.formula=e,this.cellAddress=t,this.version=r}get width(){return 1}get height(){return 1}static fromAst(e,t,r,i){return r.isScalar()?new la(e,t,i):new zn(e,t,r,i)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,r,i]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=r,this.version=i}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class zn extends Qi{constructor(e,t,r,i=0){super(e,t,i),r.isRef?this.array=new mA(new E(N.REF,_.NoSpaceForArrayResult),Ct.error()):this.array=new wm(r)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof E)return this.setErrorValue(e),e;const t=Gd.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof wm)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof wm))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;try{return this.array.get(t,r)}catch{return new E(N.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);if(!(t instanceof E||t===ft))return pe(t)}setArrayCellValue(e,t){const r=e.col-this.cellAddress.col,i=e.row-this.cellAddress.row;this.array instanceof Gd&&this.array.set(r,i,t)}setNoSpace(){return this.array=new mA(new E(N.SPILL,_.NoSpaceForArrayResult),Ct.error()),this.getCellValue()}getRange(){return Le.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return Le.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof wm)}columnsFromArray(){return Xi.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return xi.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return Ng(this.cellAddress,e)}setErrorValue(e){this.array=new mA(e,this.array.size)}}class la extends Qi{constructor(e,t,r){super(e,t,r)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return this.cachedCellValue!==void 0}}class $r{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var r;return(r=this.getCriterionFunctionValues(e).get(t))===null||r===void 0?void 0:r[0]}getCriterionFunctionValues(e){var t;return(t=this.criterionFunctionCache.get(e))!==null&&t!==void 0?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}const pwe=(n,e,t,r,i)=>{if(e instanceof $r){const a=e.range.intersectionWith(t);return a!==void 0?Array.from(a.addresses(i)):[]}let s,o;if(e instanceof Qi)s=e.getFormula(r),o=e.getAddress(r);else return[];return ES(s,n).filter(a=>a instanceof qG).map(a=>a.dependency.toSimpleCellAddress(o)).filter(a=>t.addressInRange(a))};var Ka;(function(n){n[n.ON_STACK=0]="ON_STACK",n[n.PROCESSED=1]="PROCESSED",n[n.POPPED=2]="POPPED"})(Ka||(Ka={}));class wwe{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,r){const i=e.reverse();return i.forEach(s=>this.runDFS(s)),this.postprocess(i,r,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter(t=>t!==void 0&&this.nodesSparseArray[t])}runDFS(e){if(this.nodeStatus[e]!==void 0)return;this.nodeStatus[e]=Ka.ON_STACK;const t=[e],r=[];for(;t.length>0;){const i=t[t.length-1];switch(this.nodeStatus[i]){case Ka.ON_STACK:{this.handleOnStack(i,r,t);break}case Ka.PROCESSED:{this.handleProcessed(i,r,t);break}case Ka.POPPED:{t.pop();break}}}}handleOnStack(e,t,r){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach(i=>{this.entranceTime[i]===void 0&&(r.push(i),this.parent[i]=e,this.nodeStatus[i]=Ka.ON_STACK)}),this.nodeStatus[e]=Ka.PROCESSED}handleProcessed(e,t,r){let i=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach(s=>{this.inSCC[s]||(i=this.parent[s]===e?Math.min(i,this.low[s]):Math.min(i,this.entranceTime[s]))}),this.low[e]=i,i===this.entranceTime[e]){const s=[];do s.push(t[t.length-1]),t.pop();while(s[s.length-1]!==e);s.forEach(o=>{this.inSCC[o]=!0}),this.order.push(...s),s.length>1&&s.forEach(o=>{this.sccNonSingletons[o]=!0})}r.pop(),this.nodeStatus[e]=Ka.POPPED}postprocess(e,t,r){const i=[];e.forEach(a=>{i[a]=!0});const s=[],o=[];return this.order.reverse(),this.order.forEach(a=>{const l=this.getAdjacentNodeIds(a);this.sccNonSingletons[a]||l.includes(a)?(o.push(this.nodesSparseArray[a]),t(this.nodesSparseArray[a]),l.forEach(u=>i[u]=!0)):(s.push(this.nodesSparseArray[a]),i[a]&&r(this.nodesSparseArray[a])&&l.forEach(u=>i[u]=!0))}),{sorted:s,cycled:o}}}class vwe{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return this.processedValue===null&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}class ywe{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new vwe({dirty:[],volatile:[]},t=>this.processDirtyAndVolatileNodeIds(t)),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter(e=>e!==void 0)}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const r=this.getNodeId(e),i=this.getNodeId(t);return r===void 0||i===void 0?!1:this.edgesSparseArray[r].includes(i)}adjacentNodes(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter(r=>r!==void 0).map(r=>this.nodesSparseArray[r]))}adjacentNodesCount(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(t!==void 0)return t;const r=this.nextId;return this.nextId++,this.nodesSparseArray[r]=e,this.edgesSparseArray[r]=[],this.nodesIds.set(e,r),r}addEdge(e,t){const r=this.getNodeIdIfNotNumber(e),i=this.getNodeIdIfNotNumber(t);if(r===void 0)throw this.missingNodeError(e);if(i===void 0)throw this.missingNodeError(t);this.edgesSparseArray[r].includes(i)||this.edgesSparseArray[r].push(i)}removeNode(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach(i=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(i)),this.dirtyAndVolatileNodeIds.markAsModified());const r=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),r}removeEdge(e,t){const r=this.getNodeIdIfNotNumber(e),i=this.getNodeIdIfNotNumber(t);if(r===void 0)throw this.missingNodeError(e);if(i===void 0)throw this.missingNodeError(t);const s=this.edgesSparseArray[r].indexOf(i);if(s===-1)throw new Error("Edge does not exist");delete this.edgesSparseArray[r][s]}removeEdgeIfExists(e,t){const r=this.getNodeId(e),i=this.getNodeId(t);if(r===void 0||i===void 0)return;const s=this.edgesSparseArray[r].indexOf(i);s!==-1&&delete this.edgesSparseArray[r][s]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,r){const i=new wwe(this.nodesSparseArray,this.edgesSparseArray),s=e.map(o=>this.getNodeId(o)).filter(o=>o!==void 0);return i.getTopSortedWithSccSubgraphFrom(s,t,r)}markNodeAsVolatile(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);t!==void 0&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);t!==void 0&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map(e=>({node:this.nodesSparseArray[e],id:e}))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return typeof e=="number"?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter(r=>r!==void 0&&this.nodesSparseArray[r]),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach(([r,i])=>{this.removeEdgeIfExists(i,e)}),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map(r=>this.nodesSparseArray[r]).filter(r=>r!==void 0)}missingNodeError(e){return new Error(`Unknown node ${e}`)}}class Cwe{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,r;return(r=(t=this.rangeMapping.get(e))===null||t===void 0?void 0:t.size)!==null&&r!==void 0?r:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);t===void 0&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const r=kv(e.getStart(),e.getEnd());t.set(r,e)}removeRange(e){const t=e.getStart().sheet,r=this.rangeMapping.get(t);if(r===void 0)return;const i=kv(e.getStart(),e.getEnd());r.delete(i),r.size===0&&this.rangeMapping.delete(t)}getRange(e,t){const r=this.rangeMapping.get(e.sheet),i=kv(e,t);return r?.get(i)}fetchRange(e,t){const r=this.getRange(e,t);if(!r)throw Error("Range does not exist");return r}truncateRanges(e,t){const r=Array(),i=Array(),s=Array(),o=e.sheet;for(const[l,u]of this.entriesFromSheet(e.sheet)){const h=u.range;e.start<=t(u.range.end)&&(h.removeSpan(e),h.shouldBeRemoved()?(this.removeByKey(o,l),r.push(u)):i.push([l,u]),s.push(u))}const a=[];i.sort((l,u)=>Rwe(l[1],u[1],t));for(const[l,u]of i){const h=Swe(u.range);if(h===l)continue;const c=this.getByKey(o,h);this.removeByKey(o,l),c!==void 0&&u!=c?a.push([c,u]):this.setRange(u)}return{verticesToRemove:r,verticesToMerge:a,verticesWithChangedSize:s}}moveAllRangesInSheetAfterRowByRows(e,t,r){return this.updateVerticesFromSheet(e,(i,s)=>t<=s.start.row?(s.range.shiftByRows(r),{changedSize:!1,vertex:s}):t>s.start.row&&t<=s.end.row?(s.range.expandByRows(r),{changedSize:!0,vertex:s}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,t,r){return this.updateVerticesFromSheet(e,(i,s)=>t<=s.start.col?(s.range.shiftByColumns(r),{changedSize:!1,vertex:s}):t>s.start.col&&t<=s.end.col?(s.range.expandByColumns(r),{changedSize:!0,vertex:s}):void 0)}moveRangesInsideSourceRange(e,t,r,i){this.updateVerticesFromSheet(e.sheet,(s,o)=>{if(e.containsRange(o.range))return o.range.shiftByColumns(t),o.range.shiftByRows(r),o.range.moveToSheet(i),{changedSize:!1,vertex:o}})}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=Ce(e.end.sheet,e.end.col,e.end.row-1),r=this.getRange(e.start,t);if(r!==void 0){const i=Le.fromSimpleCellAddresses(Ce(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:r,restRange:i}}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var r;return(r=this.rangeMapping.get(e))===null||r===void 0?void 0:r.get(t)}updateVerticesFromSheet(e,t){const r=Array();for(const[i,s]of this.entriesFromSheet(e)){const o=t(i,s);o!==void 0&&(this.removeByKey(e,i),r.push(o))}return r.forEach(i=>{this.setRange(i.vertex)}),{verticesWithChangedSize:r.filter(i=>i.changedSize).map(i=>i.vertex)}}}function kv(n,e){return`${n.col},${n.row},${e.col},${e.row}`}function Swe(n){return kv(n.start,n.end)}const Rwe=(n,e,t)=>{const r=t(n.range.start),i=t(n.range.start);if(r===i){const s=t(n.range.end),o=t(e.range.end);return s-o}else return r-i};class Ewe{constructor(e,t,r){this.functions=e,this.errors=t,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return this.functions[e]!==void 0}getFunctionTranslations(e){const t=[];for(const r of e)this.isFunctionTranslated(r)&&t.push(this.functions[r]);return t}getFunctionTranslation(e){const t=this.functions[e];if(t===void 0)throw new sd(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===N.LIC)return`#${N.LIC}!`;const t=this.errors[e];if(t===void 0)throw new sd(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(t===void 0)throw new sd(`ui.${e}`);return t}checkUI(){for(const e of Object.values(Ag))if(!(e in this.ui))throw new sd(`ui.${e}`)}checkErrors(){for(const e of Object.values(N))if(!(e in this.errors)&&e!==N.LIC)throw new sd(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const r of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(r))throw new uj(r)}}function bwe(n){return new Ewe(Object.assign({},n.functions),Object.assign({},n.errors),Object.assign({},n.ui))}var Ag;(function(n){n.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(Ag||(Ag={}));function od(n){return n.toLowerCase()}class Twe{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return od(this.displayName)}}class Awe{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=t=>{const r=this.mappingFromCanonicalName.get(od(t));if(r===void 0)throw new QG(t);return r.id},this.get=t=>{var r;return(r=this.mappingFromCanonicalName.get(od(t)))===null||r===void 0?void 0:r.id},this.fetchDisplayName=t=>this.fetchSheetById(t).displayName,this.sheetNamePrefix=e.getUITranslation(Ag.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=od(e);if(this.mappingFromCanonicalName.has(t))throw new Eg(e);this.lastSheetId++;const r=new Twe(this.lastSheetId,e);return this.store(r),r.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return(t=this.mappingFromId.get(e))===null||t===void 0?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(od(e))}renameSheet(e,t){const r=this.fetchSheetById(e),i=r.displayName;if(i===t)return;const s=this.mappingFromCanonicalName.get(od(t));if(s!==void 0&&s.id!==r.id)throw new Eg(t);const o=r.canonicalName;return this.mappingFromCanonicalName.delete(o),r.displayName=t,this.store(r),i}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(t===void 0)throw new Nn(e);return t}}class e_{constructor(e,t,r,i,s,o,a,l){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=r,this.arrayMapping=i,this.stats=s,this.lazilyTransformingAstService=o,this.functionRegistry=a,this.namedExpressions=l,this.changes=uu.empty(),this.dependencyQueryAddresses=u=>{if(u instanceof $r)return this.rangeDependencyQuery(u).map(([h,c])=>h);{const h=this.formulaDependencyQuery(u);if(h!==void 0){const[c,d]=h;return d.map(f=>f instanceof rl?this.namedExpressions.namedExpressionOrPlaceholder(f.name,c.sheet).address:Hn(f)?f:$N(f.start,f.end))}else return[]}},this.dependencyQueryVertices=u=>{if(u instanceof $r)return this.rangeDependencyQuery(u);{const h=this.formulaDependencyQuery(u);if(h!==void 0){const[c,d]=h;return d.map(f=>{if(f instanceof Le)return[f.start,this.rangeMapping.fetchRange(f.start,f.end)];if(f instanceof rl){const m=this.namedExpressions.namedExpressionOrPlaceholder(f.name,c.sheet);return[m.address,this.addressMapping.fetchCell(m.address)]}else return[f,this.addressMapping.fetchCell(f)]})}else return[]}},this.rangeDependencyQuery=u=>{const h=[],{smallerRangeVertex:c,restRange:d}=this.rangeMapping.findSmallerRange(u.range);let f;c!==void 0&&this.graph.adjacentNodes(c).has(u)?(f=d,h.push([new Le(c.start,c.end),c])):f=u.range;for(const m of f.addresses(this)){const p=this.addressMapping.getCell(m);p!==void 0&&h.push([m,p])}return h},this.formulaDependencyQuery=u=>{let h,c;if(u instanceof Qi)c=u.getAddress(this.lazilyTransformingAstService),h=u.getFormula(this.lazilyTransformingAstService);else return;const d=ES(h,this.functionRegistry);return[c,ta(d,c)]},this.graph=new ywe(this.dependencyQueryVertices)}static buildEmpty(e,t,r,i,s){return new e_(new mwe(t.chooseAddressMappingPolicy),new Cwe,new Awe(t.translationPackage),new gwe,s,e,r,i)}setFormulaToCell(e,t,r,i,s,o){const a=Qi.fromAst(t,e,i,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(a),this.processCellDependencies(r,a),this.graph.markNodeAsDirty(a),s&&this.markAsVolatile(a),o&&this.markAsDependentOnStructureChange(a),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);if(r instanceof zn&&this.arrayMapping.removeArray(r.getRange()),r instanceof hu)r.getValues().rawValue!==t.rawValue&&(r.setValues(t),this.graph.markNodeAsDirty(r));else{const i=new hu(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(r,i),this.addressMapping.setCell(e,i),this.graph.markNodeAsDirty(i)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(t===void 0)return uu.empty();if(this.graph.adjacentNodes(t).size>0){const r=new ql;this.exchangeGraphNode(t,r),this.graph.adjacentNodesCount(r)===0?(this.removeVertex(r),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(r),this.addressMapping.setCell(e,r))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const r=this.graph.getNodeId(t);e.forEach(i=>{if(i instanceof Le){const s=i;let o=this.getRange(s.start,s.end);o===void 0&&(o=new $r(s),this.rangeMapping.setRange(o)),this.graph.addNodeAndReturnId(o);const a=this.graph.getNodeId(o);s.isFinite()||this.graph.markNodeAsInfiniteRange(a);const{smallerRangeVertex:l,restRange:u}=this.rangeMapping.findSmallerRange(s);if(l!==void 0){if(this.graph.addEdge(l,a),o.bruteForce){o.bruteForce=!1;for(const c of s.addresses(this))this.graph.removeEdge(this.fetchCell(c),a)}}else o.bruteForce=!0;const h=this.arrayMapping.getArray(u);if(h!==void 0)this.graph.addEdge(h,a);else for(const c of u.addresses(this)){const{vertex:d,id:f}=this.fetchCellOrCreateEmpty(c);this.graph.addEdge(f??d,a)}this.graph.addEdge(a,r),s.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(i instanceof rl){const s=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:o,id:a}=this.fetchNamedExpressionVertex(i.name,s);this.graph.addEdge(a??o,r)}else{const{vertex:s,id:o}=this.fetchCellOrCreateEmpty(i);this.graph.addEdge(o??s,r)}})}fetchNamedExpressionVertex(e,t){const r=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(r.address)}exchangeNode(e,t){const r=this.fetchCellOrCreateEmpty(e).vertex,i=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(r,i)}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(t!==void 0)return{vertex:t,id:void 0};const r=new ql,i=this.graph.addNodeAndReturnId(r);return this.addressMapping.setCell(e,r),{vertex:r,id:i}}removeRows(e){this.stats.measure(tt.ADJUSTING_GRAPH,()=>{for(const[r,i]of this.addressMapping.entriesFromRowsSpan(e)){for(const s of this.graph.adjacentNodes(i))this.graph.markNodeAsDirty(s);if(i instanceof zn)if(i.isLeftCorner(r))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(tt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const t=this.stats.measure(tt.ADJUSTING_RANGES,()=>{const r=this.truncateRanges(e,i=>i.row);return this.getArrayVerticesRelatedToRanges(r)});return this.stats.measure(tt.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[t,r]of this.addressMapping.sheetEntries(e)){for(const i of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(i);this.removeVertex(r),this.addressMapping.removeCell(t)}this.stats.measure(tt.ADJUSTING_RANGES,()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const r of t)this.removeVertex(r);this.stats.measure(tt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){const t=new Set;for(const[r,i]of this.addressMapping.sheetEntries(e))i instanceof zn?t.add(i):this.setCellEmpty(r);for(const r of t.values())this.setArrayEmpty(r);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(tt.ADJUSTING_GRAPH,()=>{for(const[r,i]of this.addressMapping.entriesFromColumnsSpan(e)){for(const s of this.graph.adjacentNodes(i))this.graph.markNodeAsDirty(s);if(i instanceof zn)if(i.isLeftCorner(r))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(tt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const t=this.stats.measure(tt.ADJUSTING_RANGES,()=>{const r=this.truncateRanges(e,i=>i.col);return this.getArrayVerticesRelatedToRanges(r)});return this.stats.measure(tt.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(tt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const t=this.stats.measure(tt.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(r.verticesWithChangedSize)});this.stats.measure(tt.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const r of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(tt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const t=this.stats.measure(tt.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(r.verticesWithChangedSize)});this.stats.measure(tt.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const r of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(t===void 0)return!1;for(const r of t.addresses(this)){const i=this.addressMapping.getCell(r);if(i!==void 0&&!(i instanceof ql)&&i!==e)return!1}return!0}moveCells(e,t,r,i){for(const s of e.addressesWithDirection(t,r,this)){const o=Ce(i,s.col+t,s.row+r);let a=this.addressMapping.getCell(s);const l=this.addressMapping.getCell(o);if(this.addressMapping.removeCell(s),a!==void 0){this.graph.markNodeAsDirty(a),this.addressMapping.setCell(o,a);let u;for(const h of this.graph.adjacentNodes(a))h instanceof $r&&!e.containsRange(h.range)&&(u=u??this.fetchCellOrCreateEmpty(s).vertex,this.graph.addEdge(u,h),this.graph.removeEdge(a,h));u&&(this.graph.markNodeAsDirty(u),this.addressMapping.setCell(s,u))}if(l!==void 0){a===void 0&&this.addressMapping.removeCell(o);for(const u of this.graph.adjacentNodes(l))a=a??this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(a,u),this.graph.markNodeAsDirty(a);this.removeVertex(l)}}for(const s of this.rangeMapping.rangeVerticesContainedInRange(e))for(const o of this.graph.adjacentNodes(s))if(o instanceof $r&&!e.containsRange(o.range)){this.graph.removeEdge(s,o);for(const a of s.range.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,o),this.addressMapping.setCell(a,l),this.graph.markNodeAsDirty(l)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,r,i)}setArrayEmpty(e){const t=Le.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),r=this.graph.adjacentNodes(e);for(const i of t.addresses(this))this.addressMapping.removeCell(i);for(const i of r.values()){const s=pwe(this.functionRegistry,i,e.getRange(),this.lazilyTransformingAstService,this);for(const o of s){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,i)}s.length>0&&this.graph.markNodeAsDirty(i)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof zn&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof Me?new E(N.VALUE,_.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof la&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const r=this.getScalarValue(t);r!==ft&&(yield[pe(r),t])}}computeListOfValuesInRange(e){const t=[];for(const r of e.addresses(this)){const i=this.getScalarValue(r);t.push(i)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let r;t instanceof Qi?r=this.formulaDirectDependenciesToArray(t,e):r=this.rangeDirectDependenciesToArray(t,e);let i=!1;for(const[s,o]of r)e.isLeftCorner(s)&&(i=!0),this.graph.addEdge(o,t),this.graph.markNodeAsDirty(o);i||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof zn&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=uu.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),r=[];return t.forEach(i=>{const s=i;s instanceof $r?r.push($N(s.start,s.end)):r.push(s.getAddress(this.lazilyTransformingAstService))}),r}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const r=this.graph.adjacentNodes(e);this.removeVertex(e),r.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(t,i)})}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter(({node:o})=>o.range.addressInRange(e));if(t.length<=0)return;const{vertex:r,id:i}=this.fetchCellOrCreateEmpty(e),s=i??this.graph.getNodeId(r);t.forEach(({id:o})=>{this.graph.addEdge(s,o)})}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach(r=>{this.graph.hasNode(r)&&this.graph.adjacentNodes(r).forEach(i=>{i instanceof zn&&t.add(i)})}),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach(({id:t,node:r})=>{const i=e.range.intersectionWith(r.range);i!==void 0&&i.addresses(this).forEach(s=>{const{vertex:o,id:a}=this.fetchCellOrCreateEmpty(s);this.graph.addEdge(a??o,t)})})}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const r of t.addresses(this)){const i=e.getArrayCellValue(r);this.getCell(r)===e?e.isLeftCorner(r)?this.changes.addChange(new E(N.REF),r,i):(this.addressMapping.removeCell(r),this.changes.addChange(ft,r,i)):this.changes.addChange(ft,r,i)}}*formulaDirectDependenciesToArray(e,t){var r;const[,i]=(r=this.formulaDependencyQuery(e))!==null&&r!==void 0?r:[];if(i!==void 0){for(const s of i)if(!(s instanceof rl||s instanceof Le)&&t.getRange().addressInRange(s)){const o=this.fetchCellOrCreateEmpty(s).vertex;yield[s,o]}}}*rangeDirectDependenciesToArray(e,t){const{restRange:r}=this.rangeMapping.findSmallerRange(e.range);for(const i of r.addresses(this))if(t.getRange().addressInRange(i)){const s=this.fetchCellOrCreateEmpty(i).vertex;yield[i,s]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const r of t)(r instanceof Qi||r instanceof $r)&&(yield r)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,r){const i=Array.from(this.rangeMapping.rangesInSheet(e));for(const s of i)if(s.range.includesRow(t+r))if(s.bruteForce){const o=s.range.rangeWithSameWidth(t,r);for(const a of o.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,s)}}else{let o=s,a=this.rangeMapping.findSmallerRange(o.range);if(a.smallerRangeVertex!==void 0)continue;for(;a.smallerRangeVertex===void 0;){const l=new $r(Le.spanFrom(o.range.start,o.range.width(),o.range.height()-1));this.rangeMapping.setRange(l),this.graph.addNodeAndReturnId(l);const u=new Le(Ce(o.range.start.sheet,o.range.start.col,o.range.end.row),o.range.end);this.addAllFromRange(u,o),this.graph.addEdge(l,o),o=l,a=this.rangeMapping.findSmallerRange(o.range)}this.graph.addEdge(a.smallerRangeVertex,o),this.addAllFromRange(a.restRange,o),this.graph.removeEdge(a.smallerRangeVertex,s)}}addAllFromRange(e,t){for(const r of e.addresses(this)){const{vertex:i,id:s}=this.fetchCellOrCreateEmpty(r);this.graph.addEdge(s??i,t)}}fixRangesWhenAddingColumns(e,t,r){for(const i of this.rangeMapping.rangesInSheet(e))if(i.range.includesColumn(t+r)){let s;i.bruteForce?s=i.range.rangeWithSameHeight(t,r):s=Le.spanFrom(Ce(e,t,i.range.end.row),r,1);for(const o of s.addresses(this)){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,i)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),r=Le.spanFrom(t,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof zn&&this.setArray(r,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(t,e),e instanceof zn){if(!this.isThereSpaceForArray(e))return;for(const s of r.addresses(this)){if(e.isLeftCorner(s))continue;const o=this.getCell(s);this.exchangeOrAddGraphNode(o,e)}}for(const s of r.addresses(this))this.addressMapping.setCell(s,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof zn))return;const r=Le.spanFromOrUndef(t,e.width,e.height);if(r!==void 0&&(this.setArray(r,e),!!this.isThereSpaceForArray(e)))for(const i of r.addresses(this))this.addressMapping.setCell(i,e)}truncateRanges(e,t){const{verticesToRemove:r,verticesToMerge:i,verticesWithChangedSize:s}=this.rangeMapping.truncateRanges(e,t);for(const[o,a]of i)this.mergeRangeVertices(o,a);for(const o of r)this.removeVertexAndCleanupDependencies(o);return s}fixArraysAfterAddingRow(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInRows(xi.fromRowStartAndEnd(e,t-1,t-1))){const s=i.getRange();for(let o=s.start.col;o<=s.end.col;++o)for(let a=t;a<=s.end.row;++a){const l=Ce(e,o,a),u=Ce(e,o,a+r),h=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(ft,u,h)}}}fixArraysAfterRemovingRows(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInRows(xi.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(i))for(const s of i.getRange().addresses(this))this.addressMapping.setCell(s,i);else this.setNoSpaceIfArray(i)}fixArraysAfterAddingColumn(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInCols(Xi.fromColumnStartAndEnd(e,t-1,t-1))){const s=i.getRange();for(let o=s.start.row;o<=s.end.row;++o)for(let a=t;a<=s.end.col;++a){const l=Ce(e,a,o),u=Ce(e,a+r,o),h=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(ft,u,h)}}}fixArraysAfterRemovingColumns(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInCols(Xi.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(i))for(const s of i.getRange().addresses(this))this.addressMapping.setCell(s,i);else this.setNoSpaceIfArray(i)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof zn?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof zn&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof $r&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const r=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),r.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(e,i)})}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;t.size>0;){const r=t.values().next().value;t.delete(r);const[i,s]=r;this.graph.hasNode(s)&&this.graph.adjacentNodesCount(s)===0&&((s instanceof $r||s instanceof ql)&&this.graph.removeNode(s).forEach(o=>t.add(o)),s instanceof $r?this.rangeMapping.removeRange(s):s instanceof ql&&this.addressMapping.removeCell(i))}}}class ql{constructor(){}getCellValue(){return ft}}class hu{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw Error("SetCellValue is deprecated for ValueCellVertex")}}class Md{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){const e=this.errors.map(t=>t.message).find(t=>t);return E.parsingError(e)}getFormula(){return this.rawInput}}class Nwe{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return(t=this.mapping.get(e.col))===null||t===void 0?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let r=this.mapping.get(e.col);r||(r=new Map,this.mapping.set(e.col,r)),r.set(e.row,t)}has(e){var t;return!!(!((t=this.mapping.get(e.col))===null||t===void 0)&&t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;(t=this.mapping.get(e.col))===null||t===void 0||t.delete(e.row)}addRows(e,t){this.mapping.forEach(r=>{const i=new Map;r.forEach((s,o)=>{o>=e&&(i.set(o+t,s),r.delete(o))}),i.forEach((s,o)=>{r.set(o,s)})}),this.height+=t}addColumns(e,t){const r=new Map;this.mapping.forEach((i,s)=>{s>=e&&(r.set(s+t,i),this.mapping.delete(s))}),r.forEach((i,s)=>{this.mapping.set(s,i)}),this.width+=t}removeRows(e){this.mapping.forEach(i=>{const s=new Map;i.forEach((o,a)=>{a>=e.rowStart&&(i.delete(a),a>e.rowEnd&&s.set(a-e.numberOfRows,o))}),s.forEach((o,a)=>{i.set(a,o)})});const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){const t=new Map;this.mapping.forEach((s,o)=>{o>=e.columnStart&&(this.mapping.delete(o),o>e.columnEnd&&t.set(o-e.numberOfColumns,s))}),t.forEach((s,o)=>{this.mapping.set(o,s)});const r=Math.min(this.width-1,e.columnEnd),i=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-i)}*getEntries(e){for(const[t,r]of this.mapping)for(const[i,s]of r)yield[Ce(e,t,i),s]}*verticesFromColumn(e){const t=this.mapping.get(e);if(t!==void 0)for(const[r,i]of t)yield i}*verticesFromRow(e){for(const t of this.mapping.values()){const r=t.get(e);r!==void 0&&(yield r)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(r!==void 0)for(const[i,s]of r)yield s}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const r of e.rows()){const i=t.get(r);i!==void 0&&(yield i)}}*entriesFromRowsSpan(e){for(const[t,r]of this.mapping.entries())for(const i of e.rows()){const s=r.get(i);s!==void 0&&(yield[Ce(e.sheet,t,i),s])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(r!==void 0)for(const[i,s]of r.entries())yield[Ce(e.sheet,t,i),s]}}*vertices(){for(const[e,t]of this.mapping)for(const[r,i]of t)i!==void 0&&(yield i)}}class Iwe{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let r=0;r<t;r++)this.mapping[r]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return t?!!t[e.col]:!1}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}addRows(e,t){const r=[];for(let i=0;i<t;i++)r.push(new Array(this.width));this.mapping.splice(e,0,...r),this.height+=t}addColumns(e,t){for(let r=0;r<this.height;r++)this.mapping[r]!==void 0&&this.mapping[r].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){for(let i=0;i<this.height;i++)this.mapping[i]!==void 0&&this.mapping[i].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),r=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-r)}*getEntries(e){for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r){const i=this.getCellVertex(r,t);i&&(yield[Ce(e,r,t),i])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const r=this.getCellVertex(e,t);r&&(yield r)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const i=this.getCellVertex(t,r);i&&(yield i)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const i=this.getCellVertex(t,r);i&&(yield i)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const i=this.getCellVertex(t,r);i&&(yield[Ce(e.sheet,t,r),i])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const i=this.getCellVertex(t,r);i&&(yield[Ce(e.sheet,t,r),i])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}getCellVertex(e,t){var r;return(r=this.mapping[t])===null||r===void 0?void 0:r[e]}}var N;(function(n){n.DIV_BY_ZERO="DIV_BY_ZERO",n.NAME="NAME",n.VALUE="VALUE",n.NUM="NUM",n.NA="NA",n.CYCLE="CYCLE",n.REF="REF",n.SPILL="SPILL",n.LIC="LIC",n.ERROR="ERROR"})(N||(N={}));var Ii;(function(n){n.FORMULA="FORMULA",n.VALUE="VALUE",n.ARRAY="ARRAY",n.EMPTY="EMPTY",n.ARRAYFORMULA="ARRAYFORMULA"})(Ii||(Ii={}));const Mwe=(n,e)=>n instanceof zn?n.isLeftCorner(e)?Ii.ARRAYFORMULA:Ii.ARRAY:n instanceof la||n instanceof Md?Ii.FORMULA:n instanceof hu?Ii.VALUE:Ii.EMPTY;var iC;(function(n){n.EMPTY="EMPTY",n.NUMBER="NUMBER",n.STRING="STRING",n.BOOLEAN="BOOLEAN",n.ERROR="ERROR"})(iC||(iC={}));var WN;(function(n){n.NUMBER="NUMBER"})(WN||(WN={}));const oo=Object.assign(Object.assign({},iC),WN),Owe=Object.assign(Object.assign({},iC),Ie),PF=n=>{switch(n){case oo.EMPTY:return 0;case oo.NUMBER:return 1;case oo.STRING:return 2;case oo.BOOLEAN:return 3;case oo.ERROR:return 4}throw new Error("Cell value not computed")},sC=n=>{if(n===ft)return oo.EMPTY;if(n instanceof E||n instanceof Me)return oo.ERROR;if(typeof n=="string")return oo.STRING;if(Lt(n))return oo.NUMBER;if(typeof n=="boolean")return oo.BOOLEAN;throw new Error("Cell value not computed")},_we=n=>Lt(n)?lwe(n):sC(n),xwe=n=>{if(Lt(n))return uwe(n)};class E{constructor(e,t,r){this.type=e,this.message=t,this.root=r}static parsingError(e){return new E(N.ERROR,`${_.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return this.root===void 0?new E(this.type,this.message,e):this}}const cj=(n,e)=>({sheet:n,row:e}),Pwe=n=>n.row<0,dj=(n,e)=>({sheet:n,col:e}),Lwe=n=>n.col<0,Ce=(n,e,t)=>({sheet:n,col:e,row:t}),_i=n=>n.col<0||n.row<0,Dwe=(n,e,t,r)=>Ce(e,n.col+t,n.row+r),Km=n=>`${n.sheet},${n.row},${n.col}`;function Hn(n){var e,t,r;return n&&(typeof n=="object"||typeof n=="function")&&typeof((e=n)===null||e===void 0?void 0:e.sheet)=="number"&&typeof((t=n)===null||t===void 0?void 0:t.col)=="number"&&typeof((r=n)===null||r===void 0?void 0:r.row)=="number"}const fo=(n,e)=>{var t;return(t=n.sheet)!==null&&t!==void 0?t:e.sheet},Ng=(n,e)=>n.sheet===e.sheet&&n.col===e.col&&n.row===e.row;const Hwe="AbsoluteCellRange: Wrong range size";function Ui(n){return n&&(typeof n=="object"||typeof n=="function")?"start"in n&&Hn(n.start)&&"end"in n&&Hn(n.end):!1}const $N=(n,e)=>({start:n,end:e});class Le{constructor(e,t){if(e.sheet!==t.sheet)throw new bg(e.sheet,t.sheet);this.start=Ce(e.sheet,e.col,e.row),this.end=Ce(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new bg(e.sheet,t.sheet);const r=t.col-e.col,i=t.row-e.row;return Number.isFinite(i)&&Number.isFinite(r)?new Le(e,t):Number.isFinite(i)?new al(e.sheet,e.row,t.row):new ol(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===M.CELL_RANGE?Le.fromCellRange(e,t):e.type===M.COLUMN_RANGE?ol.fromColumnRange(e,t):al.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return Le.fromAst(e,t)}catch{return}}static fromCellRange(e,t){return new Le(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,r){const i=Le.spanFromOrUndef(e,t,r);if(i===void 0)throw new Error(Hwe);return i}static spanFromOrUndef(e,t,r){if(!Number.isFinite(t)&&Number.isFinite(r))return e.col!==0?void 0:new al(e.sheet,e.row,e.row+r-1);if(!Number.isFinite(r)&&Number.isFinite(t))return e.row!==0?void 0:new ol(e.sheet,e.col,e.col+t-1);if(Number.isFinite(r)&&Number.isFinite(t))return new Le(e,Ce(e.sheet,e.col+t-1,e.row+r-1))}static fromCoordinates(e,t,r,i,s){return new Le(Ce(e,t,r),Ce(e,i,s))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),r=Math.min(this.end.row,e.end.row),i=Math.max(this.start.col,e.start.col),s=Math.min(this.end.col,e.end.col);if(!(t>r||i>s))return new Le(Ce(this.sheet,i,t),Ce(this.sheet,s,r))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return Le.spanFrom(Ce(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof xi?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return Le.spanFrom(Ce(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return Le.spanFrom(Ce(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let r=0;r<this.width();++r){const i=Ce(this.sheet,this.start.col+r,this.start.row+t);e[t].push(i)}}return e}withStart(e){return new Le(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return Ng(this.start,e.start)&&Ng(this.end,e.end)}addressesArrayMap(e,t){const r=[];let i=this.start.row;for(;i<=this.effectiveEndRow(e);){let s=this.start.col;const o=[];for(;s<=this.effectiveEndColumn(e);)o.push(t(Ce(this.start.sheet,s,i))),s++;r.push(o),i++}return r}addresses(e){const t=[];let r=this.start.row;const i=this.effectiveEndRow(e),s=this.effectiveEndColumn(e);for(;r<=i;){let o=this.start.col;for(;o<=s;)t.push(Ce(this.start.sheet,o,r)),o++;r++}return t}*addressesWithDirection(e,t,r){if(e>0)if(t>0){let i=this.effectiveEndRow(r);for(;i>=this.start.row;){let s=this.effectiveEndColumn(r);for(;s>=this.start.col;)yield Ce(this.start.sheet,s,i),s-=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(r);){let s=this.effectiveEndColumn(r);for(;s>=this.start.col;)yield Ce(this.start.sheet,s,i),s-=1;i+=1}}else if(t>0){let i=this.effectiveEndRow(r);for(;i>=this.start.row;){let s=this.start.col;for(;s<=this.effectiveEndColumn(r);)yield Ce(this.start.sheet,s,i),s+=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(r);){let s=this.start.col;for(;s<=this.effectiveEndColumn(r);)yield Ce(this.start.sheet,s,i),s+=1;i+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return Ce(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const r=t-e+1;return this.shiftByRows(-r)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const r=t-e+1;return this.shiftByColumns(-r)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class ol extends Le{constructor(e,t,r){super(Ce(e,t,0),Ce(e,r,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const r=e.start.toSimpleColumnAddress(t),i=e.end.toSimpleColumnAddress(t);if(r.sheet!==i.sheet)throw new bg(r.sheet,i.sheet);return new ol(r.sheet,r.col,i.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new ol(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new ol(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class al extends Le{constructor(e,t,r){super(Ce(e,0,t),Ce(e,Number.POSITIVE_INFINITY,r))}static fromRowRangeAst(e,t){const r=e.start.toSimpleRowAddress(t),i=e.end.toSimpleRowAddress(t);if(r.sheet!==i.sheet)throw new bg(r.sheet,i.sheet);return new al(r.sheet,r.row,i.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new al(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new al(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}class ca{constructor(e,t,r){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=r}}function Fwe(n){const e=n.caseSensitive?n.accentSensitive?"variant":"case":n.accentSensitive?"accent":"base",t=n.caseFirst,r=n.ignorePunctuation;return new Intl.Collator(n.localeLang,{sensitivity:e,caseFirst:t,ignorePunctuation:r})}const kwe="i",Vwe=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class Uwe{constructor(e,t,r){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=r,this.lt=(i,s)=>this.compare(i,s)<0,this.leq=(i,s)=>this.compare(i,s)<=0,this.gt=(i,s)=>this.compare(i,s)>0,this.geq=(i,s)=>this.compare(i,s)>=0,this.eq=(i,s)=>this.compare(i,s)===0,this.neq=(i,s)=>this.compare(i,s)!==0,this.pow=(i,s)=>Math.pow(pe(i),pe(s)),this.addWithEpsilonRaw=(i,s)=>{const o=i+s;return Math.abs(o)<this.actualEps*Math.abs(i)?0:o},this.addWithEpsilon=(i,s)=>{const o=HF(i,s);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(pe(i),pe(s)),o)},this.unaryMinus=i=>qO(i,-pe(i)),this.unaryPlus=i=>i,this.unaryPercent=i=>new Hv(pe(i)/100),this.concat=(i,s)=>i.concat(s),this.nonstrictadd=(i,s)=>i instanceof E?i:s instanceof E?s:typeof i=="number"?typeof s=="number"?this.addWithEpsilonRaw(i,s):i:typeof s=="number"?s:0,this.subtract=(i,s)=>{const o=HF(i,s),a=pe(i),l=pe(s);let u=a-l;return Math.abs(u)<this.actualEps*Math.abs(a)&&(u=0),this.ExtendedNumberFactory(u,o)},this.divide=(i,s)=>{const o=pe(i),a=pe(s);if(a===0)return new E(N.DIV_BY_ZERO);{const l=FF(i,s);return this.ExtendedNumberFactory(o/a,l)}},this.multiply=(i,s)=>{const o=FF(i,s);return this.ExtendedNumberFactory(pe(i)*pe(s),o)},this.manyToExactComplex=i=>{const s=[];for(const o of i){if(o instanceof E)return o;if(Lt(o)||typeof o=="string"){const a=this.coerceScalarToComplex(o);a instanceof E||s.push(a)}}return s},this.coerceNumbersExactRanges=i=>this.manyToNumbers(i,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=i=>this.manyToNumbers(i,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=i=>{const s=[];for(const o of i){if(o instanceof E)return o;Lt(o)&&s.push(pe(o))}return s},this.manyToOnlyNumbersDropNulls=i=>{const s=[];for(const o of i){if(o instanceof E)return o;if(Lt(o))s.push(pe(o));else if(o!==ft)return new E(N.VALUE,_.NumberExpected)}return s},this.manyToCoercedNumbersDropNulls=i=>{const s=[];for(const o of i){if(o instanceof E)return o;if(o===ft)continue;const a=this.coerceScalarToNumberOrError(o);Lt(a)&&s.push(pe(a))}return s},this.collator=Fwe(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return r=>typeof r=="string"&&t.test(this.normalizeString(r))}neqMatcherFunction(e){const t=this.buildRegex(e);return r=>typeof r!="string"||!t.test(this.normalizeString(r))}searchString(e,t){var r;const s=this.buildRegex(e,!1).exec(t);return(r=s?.index)!==null&&r!==void 0?r:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const r=e.charAt(t);if(Ig(r)||this.config.useRegularExpressions&&Mg(r))return!0}return!1}floatCmp(e,t){const r=pe(e),i=pe(t),s=1+this.actualEps;return i>=0&&r*s>=i&&r<=i*s||i<=0&&r*s<=i&&r>=i*s?0:r>i?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof E?e:(t=this.coerceToMaybeNumber(e))!==null&&t!==void 0?t:new E(N.VALUE,_.NumberCoercion)}coerceToMaybeNumber(e){var t;return(t=this.coerceNonDateScalarToMaybeNumber(e))!==null&&t!==void 0?t:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===ft)return 0;if(typeof e=="string"){if(e==="")return 0;const t=this.coerceStringToMaybePercentNumber(e);if(t!==void 0)return t;const r=this.coerceStringToMaybeCurrencyNumber(e);return r!==void 0?r:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}else return Lt(e)?e:typeof e=="boolean"?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const r=t.slice(0,t.length-1).trim(),i=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(i!==void 0)return new Hv(i/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(t!==void 0){const[r,i]=t,s=this.numberLiteralsHelper.numericStringToMaybeNumber(i);if(s!==void 0)return new UN(s,r)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const i of e)if(i instanceof Me)t.push(i);else if(i!==ft){const s=this.coerceScalarToComplex(i);if(s instanceof E)return s;t.push(s)}const r=[];for(const i of t)if(i instanceof Me){const s=this.manyToExactComplex(i.valuesFromTopLeftCorner());if(s instanceof E)return s;r.push(...s)}else r.push(i);return r}coerceScalarToComplex(e){return e instanceof E?e:e===ft?[0,0]:Lt(e)?[pe(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new E(N.NUM,_.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:r,format:i}=t;switch(r){case Ie.NUMBER_RAW:return e;case Ie.NUMBER_CURRENCY:return new UN(e,i??this.config.currencySymbol[0]);case Ie.NUMBER_DATE:return new XO(e,i);case Ie.NUMBER_DATETIME:return new ZO(e,i);case Ie.NUMBER_TIME:return new QO(e,i);case Ie.NUMBER_PERCENT:return new Hv(e,i)}}buildRegex(e,t=!0){e=this.normalizeString(e);let r,i=this.config.useWildcards,s=this.config.useRegularExpressions;if(s)try{RegExp(e)}catch{s=!1,i=!1}return s?r=Gwe(e,this.config.caseSensitive):i?r=Wwe(e,this.config.caseSensitive):r=$we(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+r+")$"):RegExp(r)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=wj(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if(typeof e=="string"||typeof t=="string"){const r=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,i=typeof t=="string"?this.dateTimeHelper.dateStringToDateNumber(t):t;if(Lt(r)&&Lt(i))return this.floatCmp(r,i)}return e===ft?e=LF(t):t===ft&&(t=LF(e)),typeof e=="string"&&typeof t=="string"?this.stringCmp(e,t):typeof e=="boolean"&&typeof t=="boolean"?DF(GN(e),GN(t)):Lt(e)&&Lt(t)?this.floatCmp(e,t):e===ft&&t===ft?0:DF(PF(sC(e)),PF(sC(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const r=[];for(const s of e)if(s instanceof Me)r.push(s);else{const o=pe(this.coerceScalarToNumberOrError(s));if(o instanceof E)return o;r.push(o)}const i=[];for(const s of r)if(s instanceof Me){const o=t(s.valuesFromTopLeftCorner());if(o instanceof E)return o;i.push(...o)}else i.push(s);return i}coerceStringToComplex(e){const t=Vwe.exec(e);if(t===null)return new E(N.NUM,_.ComplexNumberExpected);let r;if(t[6]!==void 0?r=t[1]==="-"?[0,-1]:[0,1]:r=this.parseComplexToken(t[1]+t[3],t[5]),r instanceof E||t[8]===void 0)return r;let i;return t[14]!==void 0?i=t[9]==="-"?[0,-1]:[0,1]:i=this.parseComplexToken(t[9]+t[11],t[13]),i instanceof E?i:t[5]!==""||t[13]===""?new E(N.NUM,_.ComplexNumberExpected):t[8]==="+"?[r[0]+i[0],r[1]+i[1]]:[r[0]-i[0],r[1]-i[1]]}parseComplexToken(e,t){const r=pe(this.coerceNonDateScalarToMaybeNumber(e));return r===void 0?new E(N.NUM,_.ComplexNumberExpected):t===""?[r,0]:[0,r]}}function Dn([n,e],t){if(!isFinite(n)||!isFinite(e))return new E(N.NUM,_.NaN);if(t=t??kwe,e===0)return`${n}`;const r=`${e===-1||e===1?"":Math.abs(e)}${t}`;return n===0?`${e<0?"-":""}${r}`:`${n}${e<0?"-":"+"}${r}`}function fj(n){return n instanceof Me?n:Me.fromScalar(n)}function GN(n){return Number(n)}function LF(n){return typeof n=="string"?"":Lt(n)?0:typeof n=="boolean"?!1:ft}function mj(n){if(n instanceof E||typeof n=="boolean")return n;if(n===ft)return!1;if(Lt(n))return pe(n)!==0;{const e=n.toUpperCase();return e==="TRUE"?!0:e==="FALSE"||e===""?!1:void 0}}function jN(n){return n instanceof E||typeof n=="string"?n:n===ft?"":Lt(n)?pe(n).toString():n?"TRUE":"FALSE"}function gA(n){return n===ft?0:n}function DF(n,e){const t=pe(n),r=pe(e);return t>r?1:t<r?-1:0}function gj(n){return isNaN(n)||n===1/0||n===-1/0}function pj(n){return n===0?0:n}function Ig(n){return["*","?"].includes(n)}const Bwe=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function Mg(n){return Bwe.includes(n)}function Wwe(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);if(i==="~"){if(r==n.length-1){t+="~";continue}const s=n.charAt(r+1);Ig(s)||Mg(s)?(t+="\\"+s,r++):(t+=s,r++)}else Ig(i)?t+="."+i:Mg(i)?t+="\\"+i:e?t+=i:t+=i.toLowerCase()}return t}function $we(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);Ig(i)||Mg(i)?t+="\\"+i:e?t+=i:t+=i.toLowerCase()}return t}function Gwe(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);Ig(i)||Mg(i)||e?t+=i:t+=i.toLowerCase()}return t}function HF(n,e){const{type:t,format:r}=nC(n),{type:i,format:s}=nC(e);if(t===Ie.NUMBER_RAW)return{type:i,format:s};if(i===Ie.NUMBER_RAW)return{type:t,format:r};if((t===Ie.NUMBER_DATETIME||t===Ie.NUMBER_DATE)&&(i===Ie.NUMBER_DATETIME||i===Ie.NUMBER_DATE))return{type:Ie.NUMBER_RAW};if(t===Ie.NUMBER_TIME){if(i===Ie.NUMBER_DATE)return{type:Ie.NUMBER_DATETIME,format:`${s} ${r}`};if(i===Ie.NUMBER_DATETIME)return{type:Ie.NUMBER_DATETIME,format:s}}if(i===Ie.NUMBER_TIME){if(t===Ie.NUMBER_DATE)return{type:Ie.NUMBER_DATETIME,format:`${r} ${s}`};if(t===Ie.NUMBER_DATETIME)return{type:Ie.NUMBER_DATETIME,format:r}}return{type:t,format:r}}function FF(n,e){let{type:t,format:r}=nC(n),{type:i,format:s}=nC(e);return t===Ie.NUMBER_PERCENT&&(t=Ie.NUMBER_RAW,r=void 0),i===Ie.NUMBER_PERCENT&&(i=Ie.NUMBER_RAW,s=void 0),t===Ie.NUMBER_RAW?{type:i,format:s}:i===Ie.NUMBER_RAW?{type:t,format:r}:{type:Ie.NUMBER_RAW}}function qm(n){return wj(n.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function Vv(n,e){var t;if(n.isAdHoc())return(t=n.data[0])===null||t===void 0?void 0:t[0];const r=n.range;if(e.formulaAddress.sheet===r.sheet){if(r.width()===1){const i=e.formulaAddress.row-r.start.row;if(i>=0&&i<r.height())return n.data[i][0]}else if(r.height()===1){const i=e.formulaAddress.col-r.start.col;if(i>=0&&i<r.width())return n.data[0][i]}}}function wj(n,e){return n.normalize(e.toUpperCase())}var g;(function(n){n.STRING="STRING",n.NUMBER="NUMBER",n.BOOLEAN="BOOLEAN",n.SCALAR="SCALAR",n.NOERROR="NOERROR",n.RANGE="RANGE",n.INTEGER="INTEGER",n.COMPLEX="COMPLEX",n.ANY="ANY"})(g||(g={}));class st{constructor(e){this.coerceScalarToNumberOrError=t=>this.arithmeticHelper.coerceScalarToNumberOrError(t),this.runFunction=(t,r,i,s)=>{const o=this.evaluateArguments(t,r,i),a=o.map(([m,p])=>m),l=o.map(([m,p])=>p),u=this.buildMetadataForEachArgumentValue(a.length,i),h=r.arraysFlag&&!i.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(u,a.length))return new E(N.NA,_.WrongArgNumber);const[c,d]=h?this.calculateSizeOfVectorizedResultArray(a,u):[1,1];if(c===1&&d===1){const m=this.vectorizeAndBroadcastArgumentsIfNecessary(h,a,u,0,0);return this.calculateSingleCellOfResultArray(r,m,u,l,s,i.returnNumberType)}const f=[...Array(c).keys()].map(m=>[...Array(d).keys()].map(p=>{const v=this.vectorizeAndBroadcastArgumentsIfNecessary(h,a,u,m,p),y=this.calculateSingleCellOfResultArray(r,v,u,l,s,i.returnNumberType);if(y instanceof Me)throw new Error("Function returning array cannot be vectorized.");return y}));return Me.onlyValues(f)},this.runFunctionWithReferenceArgument=(t,r,i,s,o,a=()=>new E(N.NA,_.CellRefExpected))=>{if(t.length===0)return this.returnNumberWrapper(s(),i.returnNumberType);if(t.length>1)return new E(N.NA,_.WrongArgNumber);let l=t[0];for(;l.type===M.PARENTHESIS;)l=l.expression;let u;if(l.type===M.CELL_REFERENCE)u=l.reference.toSimpleCellAddress(r.formulaAddress);else if(l.type===M.CELL_RANGE||l.type===M.COLUMN_RANGE||l.type===M.ROW_RANGE)try{u=Le.fromAst(l,r.formulaAddress).start}catch{return new E(N.REF,_.CellRefExpected)}return u!==void 0?this.returnNumberWrapper(o(u),i.returnNumberType):this.runFunction(t,r,i,a)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const r=[];for(const i of e){const s=this.evaluateAst(i,t);if(s instanceof Me)for(const o of s.valuesFromTopLeftCorner())r.push([o,!0]);else r.push([s,!1])}return r}coerceToType(e,t,r){let i;if(e instanceof Me)switch(t.argumentType){case g.RANGE:case g.ANY:i=e;break;default:{const s=Vv(e,r);if(s===void 0)return;e=s}}if(!(e instanceof Me))switch(t.argumentType){case g.INTEGER:case g.NUMBER:const s=this.coerceScalarToNumberOrError(e);if(!Lt(s)){i=s;break}const o=pe(s);if(t.maxValue!==void 0&&o>t.maxValue)return new E(N.NUM,_.ValueLarge);if(t.minValue!==void 0&&o<t.minValue)return new E(N.NUM,_.ValueSmall);if(t.lessThan!==void 0&&o>=t.lessThan)return new E(N.NUM,_.ValueLarge);if(t.greaterThan!==void 0&&o<=t.greaterThan)return new E(N.NUM,_.ValueSmall);if(t.argumentType===g.INTEGER&&!Number.isInteger(o))return new E(N.NUM,_.IntegerExpected);i=s;break;case g.STRING:i=jN(e);break;case g.BOOLEAN:i=mj(e);break;case g.SCALAR:case g.NOERROR:case g.ANY:i=e;break;case g.RANGE:if(e instanceof E)return e;i=fj(e);break;case g.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(pe(e))}return t.passSubtype||i===void 0?i:pe(i)}calculateSingleCellOfResultArray(e,t,r,i,s,o){const a=this.coerceArgumentsToRequiredTypes(e,t,r,i);if(a instanceof E)return a;const l=s(...a);return this.returnNumberWrapper(l,o)}coerceArgumentsToRequiredTypes(e,t,r,i){const s=[];for(let o=0;o<r.length;o++){const a=r[o],l=t[o]!==void 0?t[o]:a?.defaultValue;if(l===void 0){s.push(void 0);continue}const u=this.coerceToType(l,a,e);if(u===void 0&&!i[o])return new E(N.VALUE,_.WrongType);if(u instanceof E&&a.argumentType!==g.SCALAR)return u;s.push(u)}return s}vectorizeAndBroadcastArgumentsIfNecessary(e,t,r,i,s){return t.map((o,a)=>e&&this.isRangePassedAsAScalarArgument(o,r[a])?this.vectorizeAndBroadcastRangeArgument(o,i,s):o)}vectorizeAndBroadcastRangeArgument(e,t,r){var i;const s=e.height()===1?0:t,o=e.width()===1?0:r;return(i=e.data[s])===null||i===void 0?void 0:i[o]}evaluateArguments(e,t,r){return r.expandRanges?this.listOfScalarValues(e,t):e.map(i=>[this.evaluateAst(i,t),!1])}buildMetadataForEachArgumentValue(e,t){const r=t.parameters?[...t.parameters]:[];if(t.repeatLastArgs!==void 0&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>r.length;)r.push(...r.slice(r.length-t.repeatLastArgs));return r}isNumberOfArgumentValuesValid(e,t){return t>e.length?!1:t<e.length?e.slice(t).every(s=>s?.optionalArg||s?.defaultValue!==void 0):!0}calculateSizeOfVectorizedResultArray(e,t){const r=e.filter((o,a)=>this.isRangePassedAsAScalarArgument(o,t[a])),i=Math.max(1,...r.map(o=>o.height())),s=Math.max(1,...r.map(o=>o.width()));return[i,s]}isRangePassedAsAScalarArgument(e,t){return e==null||t==null?!1:e instanceof Me&&![g.RANGE,g.ANY].includes(t.argumentType)}metadata(e){const t=this.constructor.implementedFunctions[e];if(t!==void 0)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,r){return t!==void 0&&Lt(e)?this.arithmeticHelper.ExtendedNumberFactory(pe(e),{type:t,format:r}):e}}class Ct{constructor(e,t,r=!1){this.width=e,this.height=t,this.isRef=r}static error(){return new Ct(1,1,!0)}static scalar(){return new Ct(1,1,!1)}isScalar(){return this.width===1&&this.height===1||this.isRef}}function jwe(n,e){return new Ct(Math.max(n.width,e.width),Math.max(n.height,e.height))}function zwe(n){return new Ct(n.width,n.height)}class Ywe{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case M.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case M.COLUMN_RANGE:case M.ROW_RANGE:case M.CELL_RANGE:{const r=Le.fromAstOrUndef(e,t.formulaAddress);return r===void 0?Ct.error():new Ct(r.width(),r.height(),!0)}case M.ARRAY:{const r=[],i=[];for(const a of e.args){const l=a.map(c=>this.checkArraySizeForAst(c,t)),u=Math.min(...l.map(c=>c.height)),h=l.reduce((c,d)=>c+d.width,0);r.push(u),i.push(h)}const s=r.reduce((a,l)=>a+l,0),o=Math.min(...i);return new Ct(o,s)}case M.STRING:case M.NUMBER:return Ct.scalar();case M.CELL_REFERENCE:return new Ct(1,1,!0);case M.DIV_OP:case M.CONCATENATE_OP:case M.EQUALS_OP:case M.GREATER_THAN_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.LESS_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.NOT_EQUAL_OP:case M.PLUS_OP:case M.POWER_OP:case M.TIMES_OP:{const r=this.checkArraySizeForAst(e.left,t),i=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(r.height>1||r.width>1||i.height>1||i.width>1)?Ct.error():jwe(r,i)}case M.MINUS_UNARY_OP:case M.PLUS_UNARY_OP:case M.PERCENT_OP:{const r=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(r.height>1||r.width>1)?Ct.error():zwe(r)}case M.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case M.EMPTY:return Ct.error();default:return Ct.error()}}checkArraySizeForFunction(e,t){const r=this.functionRegistry.getArraySizeFunction(e.procedureName);if(r!==void 0)return r(e,t);const i=this.functionRegistry.getMetadata(e.procedureName);if(i===void 0||i.expandRanges||!t.arraysFlag||i.vectorizationForbidden||i.parameters===void 0)return new Ct(1,1);const s=e.args.map(u=>{var h;return this.checkArraySizeForAst(u,new ca(t.formulaAddress,t.arraysFlag||((h=i?.arrayFunction)!==null&&h!==void 0?h:!1)))}),o=[...i.parameters];if(i.repeatLastArgs!==void 0&&o.length<s.length&&(s.length-o.length)%i.repeatLastArgs!==0)return Ct.error();for(;o.length<s.length;){if(i.repeatLastArgs===void 0)return Ct.error();o.push(...o.slice(o.length-i.repeatLastArgs))}let a=1,l=1;for(let u=0;u<s.length;u++)o[u].argumentType!==g.RANGE&&o[u].argumentType!==g.ANY&&(l=Math.max(l,s[u].height),a=Math.max(a,s[u].width));return new Ct(a,l)}}class vj{constructor(e,t,r){var i;this.value=t,this.address=r,this.type=e.type,this.message=(i=e.message)!==null&&i!==void 0?i:""}toString(){return this.value}valueOf(){return this.value}}function Ut(n,e,t){if(typeof n>"u")return _r.defaultConfig[t];if(typeof e=="string"){if(typeof n===e)return n;throw new xt(e,t)}else{if(e.includes(n))return n;throw new aj(e.map(r=>`'${r}'`).join(" "),t)}}function Yc(n,e,t){if(n<t)throw new sj(e,t)}function Kwe(n,e,t){if(n>t)throw new oj(e,t)}function Kw(n,e,t,r){if(e(n))return n;if(typeof n>"u")return _r.defaultConfig[r];throw new xt(t,r)}function kF(...n){const e=new Map;n.forEach(r=>{const i=e.get(r.value)||[];i.push(r.name),e.set(r.value,i)});const t=[];for(const r of e.values())r.length>1&&t.push(r);if(t.length>0){t.forEach(i=>i.sort());const r=t.map(i=>`[${i}]`).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${r}`)}}function ce(n,e,t){if(typeof n!==e)throw new xt(e,t)}const t_=new RegExp("^ss(\\.(s+|0+))?$"),qwe=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),Xwe=new RegExp("\\s+"),yj=new RegExp("[ /.-]"),zN=":",VF=1e3,Qwe=Cj(eve),Zwe=Cj(tve);function Jwe(n,e,t){if(e===void 0&&t===void 0)return;let r=n.replace(Xwe," ").trim().toLowerCase();if(!nve(r))return;let i=r.substring(r.length-2);i==="am"||i==="pm"?r=r.substring(0,r.length-2).trim():(i=r.substring(r.length-1),i==="a"||i==="p"?r=r.substring(0,r.length-1).trim():i=void 0);const s=r.split(yj);s.length>=2&&s[s.length-2].includes(zN)&&(s[s.length-2]=s[s.length-2]+"."+s[s.length-1],s.pop());const o=s[s.length-1].split(zN);if(i!==void 0&&o.push(i),s.length===1)return UF(o,t);if(o.length===1)return BF(s,e);const a=BF(s.slice(0,s.length-1),e),l=UF(o,t);if(a!==void 0)return l===void 0?void 0:Object.assign(Object.assign({},a),l)}function UF(n,e){var t,r,i;if(e===void 0)return;const{itemsCount:s,hourItem:o,minuteItem:a,secondItem:l}=Qwe(e);let u;if(n[n.length-1]==="am"||n[n.length-1]==="a"?(u=!1,n.pop()):(n[n.length-1]==="pm"||n[n.length-1]==="p")&&(u=!0,n.pop()),n.length!==s)return;const h=Number((t=n[l])!==null&&t!==void 0?t:"0");if(!Number.isFinite(h))return;const c=Math.round(h*VF)/VF,d=Number((r=n[a])!==null&&r!==void 0?r:"0");if(!(Number.isFinite(d)&&Number.isInteger(d)))return;const f=Number((i=n[o])!==null&&i!==void 0?i:"0");return!(Number.isFinite(f)&&Number.isInteger(f))||u!==void 0&&(f<0||f>12)?void 0:{hours:u!==void 0?f%12+(u?12:0):f,minutes:d,seconds:c}}function BF(n,e){var t;if(e===void 0)return;const{itemsCount:r,dayItem:i,monthItem:s,shortYearItem:o,longYearItem:a}=Zwe(e);if(n.length!==r)return;const l=Number(n[i]);if(!(Number.isFinite(l)&&Number.isInteger(l)))return;const u=Number(n[s]);if(!(Number.isFinite(u)&&Number.isInteger(u))||n[a]&&n[o])return;const h=Number((t=n[a])!==null&&t!==void 0?t:n[o]);if(Number.isFinite(h)&&Number.isInteger(h)&&!(n[a]&&(h<1e3||h>9999))&&!(n[o]&&(h<0||h>99)))return{year:h,month:u,day:l}}function eve(n){const e=n.toLowerCase().trim(),r=(e.endsWith("am/pm")?e.substring(0,e.length-5):e.endsWith("a/p")?e.substring(0,n.length-3):e).trim().split(zN);return{itemsCount:r.length,hourItem:r.indexOf("hh"),minuteItem:r.indexOf("mm"),secondItem:r.findIndex(i=>t_.test(i))}}function tve(n){const e=n.toLowerCase().trim().split(yj);return{itemsCount:e.length,dayItem:e.indexOf("dd"),monthItem:e.indexOf("mm"),shortYearItem:e.indexOf("yy"),longYearItem:e.indexOf("yyyy")}}function nve(n){return qwe.test(n)}function Cj(n){const e={};return t=>{const r=e[t];if(r!==void 0)return r;const i=n(t);return e[t]=i,i}}const YN=[31,28,31,30,31,30,31,31,30,31,30,31],vd=[0,31,59,90,120,151,181,212,243,273,304,334],qw=60,Xw=60,KN=24;function Xm(n){return n&&(typeof n=="object"||typeof n=="function")?"year"in n&&typeof n.year=="number"&&"month"in n&&typeof n.month=="number"&&"day"in n&&typeof n.day=="number":!1}function Sj(n){return n&&(typeof n=="object"||typeof n=="function")?"hours"in n&&typeof n.hours=="number"&&"minutes"in n&&typeof n.minutes=="number"&&"seconds"in n&&typeof n.seconds=="number":!1}const rve={year:9999,month:12,day:31};class ive{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(rve),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:r="",timeFormat:i=""}=this.parseDateTimeFromConfigFormats(e);if(t!==void 0)return Sj(t)?Xm(t)?new ZO(_d(t)+this.dateToNumber(t),r+" "+i):new QO(_d(t),i):Xm(t)?new XO(this.dateToNumber(t),r):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=YN[e.month-1]}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let r=Math.floor(t/365.2425);this.dateToNumberFromZero({year:r+1,month:1,day:1})<=t?r++:this.dateToNumberFromZero({year:r-1,month:1,day:1})>t&&r--;const i=t-this.dateToNumberFromZero({year:r,month:1,day:1}),s=sve(i-(this.isLeapYear(r)&&i>=59?1:0)),o=i-vd[s]-(this.isLeapYear(r)&&s>1?1:0);return{year:r,month:s+1,day:o+1}}numberToSimpleDateTime(e){const t=Od(e%1),r=Math.floor(t.hours/KN);t.hours=t.hours%KN;const i=this.numberToSimpleDate(Math.floor(e)+r);return Object.assign(Object.assign({},i),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&t===2?29:YN[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return e.day===31&&(e.day=30),e.day===30&&t.day===31&&(t.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,t.month===2&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,r){const i=this.parseDateTime(e,t,r);if(!(Xm(i)&&(i.year>=0&&i.year<100&&(i.year<this.getNullYear()?i.year+=2e3:i.year+=1900),!this.isValidDate(i))))return i}parseDateTimeFromFormats(e,t,r){const i=t.length===0?[void 0]:t,s=r.length===0?[void 0]:r;for(const o of i)for(const a of s){const l=this.parseSingleFormat(e,o,a);if(l!==void 0)return{dateTime:l,timeFormat:a,dateFormat:o}}return{}}countLeapDays(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+vd[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}function sve(n){let e=0;return vd[e+6]<=n&&(e+=6),vd[e+3]<=n&&(e+=3),vd[e+2]<=n?e+=2:vd[e+1]<=n&&(e+=1),e}function WF(n,e){const t=12*n.year+n.month-1+e;return{year:Math.floor(t/12),month:t%12+1,day:n.day}}function ove(n){return{year:n.year,month:n.month,day:Math.min(n.day,YN[n.month-1])}}function pA(n){return Math.round(n*3600*24)/(3600*24)}function ave(n,e=1){return Math.round(n*e)/e}function Od(n){const e=n*KN*Xw*qw,t=ave(e%qw,1e5)%qw,r=(e-t)/qw,i=Math.round(r%Xw)%Xw,s=(r-i)/Xw;return{hours:Math.round(s),minutes:i,seconds:t}}function _d(n){return((n.seconds/60+n.minutes)/60+n.hours)/24}function $F(n){return{year:n.year,month:n.month,day:Math.min(30,n.day)}}class lve{call(){return Iwe}}const GF=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,jF=/(\\.|[#0]+(\.[#0]*)?)/g;var ua;(function(n){n.FORMAT="FORMAT",n.FREE_TEXT="FREE_TEXT"})(ua||(ua={}));function Qw(n,e){return{type:n,value:e}}var oC;(function(n){n.DATE="DATE",n.NUMBER="NUMBER",n.STRING="STRING"})(oC||(oC={}));function uve(n){GF.lastIndex=0;const e=[];let t;do t=GF.exec(n),t!==null&&e.push(t);while(t);return e}function hve(n){jF.lastIndex=0;const e=jF.exec(n);return e!==null?[e]:[]}function Rj(n,e){const t=[];let r=0;for(let s=0;s<n.length;++s){const o=n[s];if(o.index!==r){const a=e.substr(r,o.index-r);t.push(Qw(ua.FREE_TEXT,a))}o[0].startsWith("\\")?t.push(Qw(ua.FREE_TEXT,o[0])):t.push(Qw(ua.FORMAT,o[0])),r=o.index+o[0].length}const i=n[n.length-1];if(i.index+i[0].length<e.length){const s=e.substr(i.index+i[0].length,e.length);t.push(Qw(ua.FREE_TEXT,s))}return t}function Ej(n){const e=uve(n);if(!e.every(t=>bj(t)))return{type:oC.DATE,tokens:Rj(e,n)}}function cve(n){const e=hve(n);if(!e.every(t=>bj(t)))return{type:oC.NUMBER,tokens:Rj(e,n)}}function bj(n){return n[0].startsWith("\\")}function dve(n,e,t,r){const i=t.stringifyDateTime(r.numberToSimpleDateTime(n),e);if(i!==void 0)return i;const s=t.stringifyDuration(Od(n),e);if(s!==void 0)return s;const o=cve(e);return o!==void 0?mve(o.tokens,n):e}function Mi(n,e){let t=`${n}`;for(;t.length<e;)t="0"+t;return t}function fve(n,e){let t=`${n}`;for(;t.length<e;)t=t+"0";return t}function zF(n,e){return n.split(e).length-1}function mve(n,e){let t="";for(let r=0;r<n.length;++r){const i=n[r];if(i.type===ua.FREE_TEXT){t+=i.value;continue}const s=i.value.split("."),o=s[0],a=s[1]||"",l=s[1]?".":"",u=Number(e.toFixed(a.length)).toString().split(".");let h=u[0]||"",c=u[1]||"";if(o.length>h.length){const f=zF(o.substr(0,o.length-h.length),"0");h=Mi(h,f+h.length)}const d=zF(a.substr(c.length,a.length-c.length),"0");c=fve(c,d+c.length),t+=h+l+c}return t}function gve(n,e){const t=Ej(e);if(t===void 0)return;const r=t.tokens;let i="";for(const s of r){if(s.type===ua.FREE_TEXT){i+=s.value;continue}switch(s.value.toLowerCase()){case"h":case"hh":{i+=Mi(n.hours,s.value.length),n.hours=0;break}case"[hh]":{i+=Mi(n.hours,s.value.length-2),n.hours=0;break}case"m":case"mm":{i+=Mi(n.minutes,s.value.length),n.minutes=0;break}case"[mm]":{i+=Mi(n.minutes+60*n.hours,s.value.length-2),n.minutes=0,n.hours=0;break}case"s":case"ss":{i+=Mi(Math.floor(n.seconds),s.value.length);break}default:{if(t_.test(s.value)){const o=Math.max(s.value.length-3,0);i+=`${n.seconds<10?"0":""}${Math.floor(n.seconds*Math.pow(10,o))/Math.pow(10,o)}`;continue}return}}}return i}function pve(n,e){const t=Ej(e);if(t===void 0)return;const r=t.tokens;let i="",s=!1;const o=r.some(a=>a.type===ua.FORMAT&&(a.value==="a/p"||a.value==="A/P"||a.value==="am/pm"||a.value==="AM/PM"));for(let a=0;a<r.length;a++){const l=r[a];if(l.type===ua.FREE_TEXT){i+=l.value;continue}switch(l.value.toLowerCase()){case"h":case"hh":{s=!0,i+=Mi(o?(n.hours+11)%12+1:n.hours,l.value.length);break}case"d":case"dd":{i+=Mi(n.day,l.value.length);break}case"s":case"ss":{i+=Mi(Math.floor(n.seconds),l.value.length);break}case"m":case"mm":{a+1<r.length&&r[a+1].value.startsWith(":")&&(s=!0),s?i+=Mi(n.minutes,l.value.length):i+=Mi(n.month,l.value.length),s=!0;break}case"yy":{i+=Mi(n.year%100,l.value.length);break}case"yyyy":{i+=n.year;break}case"am/pm":case"a/p":{const[u,h]=l.value.split("/");i+=n.hours<12?u:h;break}default:{if(t_.test(l.value)){const u=l.value.length-3;i+=`${n.seconds<10?"0":""}${Math.floor(n.seconds*Math.pow(10,u))/Math.pow(10,u)}`;continue}return}}}return i}const qN="length",Qm=n=>parseInt(n,16),YF=n=>parseInt(n,10),wA=n=>(n+"").replace(/\-/g,""),aC=(n,e,t)=>n.substr(e,t),eo=n=>n.codePointAt(0)-65;function wve(n){return wA(n)[qN]===25?Qm(aC(wA(n),Qm("12"),eo("F")))/(Qm(aC(wA(n),eo("C"),eo("Y")>>4))||(~~![][qN]<<3)+1):0}function vve(n){if(n=(n+"").replace(/\-/g,""),n[qN]!==eo("Z"))return!1;let e=0;return[[0,eo("G")+1],[eo("H"),eo("H")-1],[eo("G")+eo("H"),eo("G")]].reduce((t,[r,i],s)=>(t|=(YF(`${YF(Qm(aC(n,e+r-(s===0?0:2),i+(s?2:0)))+(Qm(aC(n,e+r+i,2))+[]).padStart(2,"0"))}`)%97||2)>>1,e+=2,t),eo("A"))==="1">>1}const yve={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:n})=>`The license key for HyperFormula expired on ${n}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let KF=!1;function Cve(n){const e={template:"missing",vars:{}};if(n==="gpl-v3"||n==="internal-use-in-handsontable")e.template="valid";else if(typeof n=="string"&&vve(n)){const[t,r,i]="18/07/2024".split("/"),s=Math.floor(new Date(`${r}/${t}/${i}`).getTime()/864e5),o=wve(n);e.vars.keyValidityDate=Sve(new Date((o+1)*864e5)),s>o?e.template="expired":e.template="valid"}else n!==""&&(e.template="invalid");return!KF&&e.template!=="valid"&&(console.warn(yve[e.template](e.vars)),KF=!0),e.template}function Sve(n){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][n.getMonth()],r=n.getDate(),i=n.getFullYear();return`${t} ${r}, ${i}`}var yn;(function(n){class e{constructor(l){this.value=l,this.value=qO(this.value,pj(pe(this.value)))}}n.Number=e;class t{constructor(l){this.value=l}}n.String=t;class r{constructor(l){this.value=l}}n.Boolean=r;class i{static getSingletonInstance(){return i.instance||(i.instance=new i),i.instance}}n.Empty=i;class s{constructor(l){this.formula=l}}n.Formula=s;class o{constructor(l,u){this.value=new E(l,u)}}n.Error=o})(yn||(yn={}));function Rve(n){return n.startsWith("=")}function Eve(n){const e=n.toLowerCase();return e==="true"||e==="false"}function bve(n,e){const t=n.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(t)&&Object.prototype.hasOwnProperty.call(e,t)}class Tve{constructor(e,t,r){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=r}parse(e){if(e==null)return yn.Empty.getSingletonInstance();if(typeof e=="number")return gj(e)?new yn.Error(N.NUM,_.ValueLarge):new yn.Number(e);if(typeof e=="boolean")return new yn.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),r=_d({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),i=t+r;return i<0?new yn.Error(N.NUM,_.DateBounds):i%1===0?new yn.Number(new XO(i,"Date()")):i<1?new yn.Number(new QO(i,"Date()")):new yn.Number(new ZO(i,"Date()"))}else if(typeof e=="string"){if(Eve(e))return new yn.Boolean(e.toLowerCase()==="true");if(Rve(e))return new yn.Formula(e);if(bve(e,this.config.errorMapping))return new yn.Error(this.config.errorMapping[e.toUpperCase()]);{let t=e.trim(),r=0,i;if(t.endsWith("%"))r=1,t=t.slice(0,t.length-1);else{const a=this.currencyMatcher(t);a!==void 0&&(r=2,[i,t]=a)}const s=this.numberLiteralsHelper.numericStringToMaybeNumber(t);if(s!==void 0){let a;return r===1?a=new Hv(s/100):r===2?a=new UN(s,i):a=s,new yn.Number(a)}const o=this.dateHelper.dateStringToDateNumber(t);return o!==void 0?new yn.Number(o):new yn.String(e.startsWith("'")?e.slice(1):e)}}else throw new ij(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}var Rh;(function(n){n[n.COPY=0]="COPY",n[n.CUT=1]="CUT"})(Rh||(Rh={}));var Mr;(function(n){n[n.VALUE=0]="VALUE",n[n.EMPTY=1]="EMPTY",n[n.FORMULA=2]="FORMULA",n[n.PARSING_ERROR=3]="PARSING_ERROR"})(Mr||(Mr={}));class qF{constructor(e,t,r,i,s){this.sourceLeftCorner=e,this.width=t,this.height=r,this.type=i,this.content=s}*getContent(e){if(this.content!==void 0)for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r)yield[Ce(e.sheet,e.col+r,e.row+t),this.content[t][r]]}}class Ave{constructor(e,t,r){this.dependencyGraph=t,this.operations=r,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,r){this.clipboard=new qF(e,t,r,Rh.CUT)}copy(e,t,r){const i=[];for(let s=0;s<r;++s){i[s]=[];for(let o=0;o<t;++o){const a=this.operations.getClipboardCell(Ce(e.sheet,e.col+o,e.row+s));i[s].push(a)}}this.clipboard=new qF(e,t,r,Rh.COPY,i)}abortCut(){this.clipboard&&this.clipboard.type===Rh.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(this.clipboard===void 0)return;if(_i(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new Jn("a valid target address.");const t=Le.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Hh;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return this.clipboard!==void 0&&this.clipboard.type===Rh.CUT}isCopyClipboard(){return this.clipboard!==void 0&&this.clipboard.type===Rh.COPY}}class lC{constructor(e,t,r,i){this.displayName=e,this.address=t,this.added=r,this.options=i}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new lC(this.displayName,this.address,this.added,this.options)}}class Nve{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);return!(r&&r.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));if(t&&t.added)return t}remove(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);r&&(r.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class XF{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class Xh{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new Nve,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var r,i;return t===void 0?this.workbookStore.isNameAvailable(e):(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.isNameAvailable(e))!==null&&i!==void 0?i:!0}namedExpressionInAddress(e){const t=this.addressCache.get(e);if(t&&t.added)return t}namedExpressionForScope(e,t){var r;return t===void 0?this.workbookStore.getExisting(e):(r=this.worksheetStore(t))===null||r===void 0?void 0:r.get(e)}nearestNamedExpression(e,t){var r,i;return(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.get(e))!==null&&i!==void 0?i:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var r,i;return(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.has(e))!==null&&i!==void 0?i:!1}isNameValid(e){const t=new RegExp(`^${U$}$`),r=new RegExp(`^${B$}$`),i=new RegExp(`^${W$}$`);return t.test(e)||r.test(e)?!1:i.test(e)}addNamedExpression(e,t,r){const i=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);let s=i.get(e);return s!==void 0?(s.added=!0,s.displayName=e,s.options=r):(s=new lC(e,this.nextAddress(),!0,r),i.add(s)),this.addressCache.set(s.address.row,s),s}restoreNamedExpression(e,t){const r=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,r.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var r;return(r=this.worksheetStoreOrCreate(t).get(e))!==null&&r!==void 0?r:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return t===void 0&&(t=new lC(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let r;t===void 0?r=this.workbookStore:r=this.worksheetStore(t);const i=r?.get(e);if(r===void 0||i===void 0||!i.added)throw Error("Named expression does not exist");r.remove(e),r instanceof XF&&r.mapping.size===0&&this.worksheetStores.delete(t),this.addressCache.delete(i.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:t})=>t===e).map(t=>t.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:void 0})}),this.worksheetStores.forEach((t,r)=>{t.getAllNamedExpressions().forEach(i=>{e.push({expression:i,scope:r})})}),e}getAllNamedExpressionsForScope(e){var t,r;return e===void 0?this.workbookStore.getAllNamedExpressions():(r=(t=this.worksheetStores.get(e))===null||t===void 0?void 0:t.getAllNamedExpressions())!==null&&r!==void 0?r:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new XF,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return Ce(Xh.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}Xh.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const Wl=n=>{switch(n.type){case M.EMPTY:case M.NUMBER:case M.STRING:case M.ERROR:case M.ERROR_WITH_RAW_INPUT:return!1;case M.CELL_REFERENCE:return!n.reference.isAbsolute();case M.CELL_RANGE:case M.COLUMN_RANGE:case M.ROW_RANGE:return!n.start.isAbsolute();case M.NAMED_EXPRESSION:return!1;case M.PERCENT_OP:case M.PLUS_UNARY_OP:case M.MINUS_UNARY_OP:return Wl(n.value);case M.CONCATENATE_OP:case M.EQUALS_OP:case M.NOT_EQUAL_OP:case M.LESS_THAN_OP:case M.GREATER_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.PLUS_OP:case M.TIMES_OP:case M.DIV_OP:case M.POWER_OP:return Wl(n.left)||Wl(n.right);case M.PARENTHESIS:return Wl(n.expression);case M.FUNCTION_CALL:return n.args.some(e=>Wl(e));case M.ARRAY:return n.args.some(e=>e.some(t=>Wl(t)))}};class Eu{performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[i,s]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService)),o=t.rememberNewAst(i);r.setFormula(o),r.setAddress(s)}}transformSingleAst(e,t){const r=this.transformAst(e,t),i=this.fixNodeAddress(t);return[r,i]}transformAst(e,t){switch(e.type){case M.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case M.CELL_RANGE:return this.transformCellRangeAst(e,t);case M.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case M.ROW_RANGE:return this.transformRowRangeAst(e,t);case M.EMPTY:case M.ERROR:case M.NUMBER:case M.NAMED_EXPRESSION:case M.ERROR_WITH_RAW_INPUT:case M.STRING:return e;case M.PERCENT_OP:case M.MINUS_UNARY_OP:case M.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case M.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(r=>this.transformAst(r,t))});case M.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case M.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(r=>r.map(i=>this.transformAst(i,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const r=this.transformCellAddress(e.reference,t);return r instanceof nn?Object.assign(Object.assign({},e),{reference:r}):r===N.REF?ea(new E(N.REF)):e}transformCellRangeAst(e,t){const r=this.transformCellRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===N.REF?ea(new E(N.REF)):e}transformColumnRangeAst(e,t){const r=this.transformColumnRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===N.REF?ea(new E(N.REF)):e}transformRowRangeAst(e,t){const r=this.transformRowRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===N.REF?ea(new E(N.REF)):e}}class Ive extends Eu{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=fo(e,t);if(r!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const i=e.toSimpleColumnAddress(t);return r===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=i.col?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1:t.sheet===this.columnsSpan.sheet&&r!==this.columnsSpan.sheet?e.isColumnAbsolute()||t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?e.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i===N.REF||s===N.REF?N.REF:i||s?[i||e,s||t]:!1}}class XN extends Eu{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}transformCellAddress(e,t){const r=fo(e,t);if(r!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const i=e.toSimpleRowAddress(t);return r===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=i.row?e.shiftedByRows(this.rowsSpan.numberOfRows):!1:t.sheet===this.rowsSpan.sheet&&r!==this.rowsSpan.sheet?e.isRowAbsolute()||t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?e.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(this.rowsSpan.numberOfRows):i.row<this.rowsSpan.rowStart?t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart?e.shiftedByRows(this.rowsSpan.numberOfRows):!1}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i===N.REF||s===N.REF?N.REF:i||s?[i||e,s||t]:!1}}class Mve extends Eu{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return e.isInvalid(t)?N.REF:!1}transformCellRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?N.REF:!1}transformColumnRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?N.REF:!1}transformRowRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?N.REF:!1}}class Ove extends Eu{constructor(e,t,r,i){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=i,this.dependentFormulaTransformer=new _ve(e,t,r,i)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return Ce(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformAddress(e,t){const r=this.sourceRange;if(e instanceof nn){const i=e.toSimpleCellAddress(t);if(r.addressInRange(i))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,r){const i=this.sourceRange;if(e instanceof nn&&t instanceof nn){const s=e.toSimpleCellAddress(r),o=t.toSimpleCellAddress(r);if(i.addressInRange(s)&&i.addressInRange(o))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class _ve extends Eu{constructor(e,t,r,i){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=i}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.shouldMove(e,t)?e.moved(this.toSheet,this.toRight,this.toBottom):!1}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}shouldMove(e,t){return e instanceof nn?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof Gr?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i&&s?[i,s]:!1}}class xve extends Eu{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=fo(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==r)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===r){const i=e.toSimpleColumnAddress(t);if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==r){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===r)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const i=e.toSimpleColumnAddress(t);if(i.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(i.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return N.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const i=fo(e,r);let s=e,o=t;if(this.columnsSpan.sheet===i){const u=e.toSimpleColumnAddress(r),h=t.toSimpleColumnAddress(r);if(this.columnsSpan.columnStart<=u.col&&this.columnsSpan.columnEnd>=h.col)return N.REF;u.col>=this.columnsSpan.columnStart&&u.col<=this.columnsSpan.columnEnd&&(s=e.shiftedByColumns(this.columnsSpan.columnEnd-u.col+1)),h.col>=this.columnsSpan.columnStart&&h.col<=this.columnsSpan.columnEnd&&(o=t.shiftedByColumns(-(h.col-this.columnsSpan.columnStart+1)))}const a=this.transformCellAddress(s,r),l=this.transformCellAddress(o,r);if(a===!1&&l===!1)return[s,o];if(a===N.REF||l===N.REF)throw Error("Cannot happen");return[a||s,l||o]}}class QN extends Eu{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const r=fo(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==r)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===r){const i=e.toSimpleRowAddress(t);if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==r){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===r)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const i=e.toSimpleRowAddress(t);if(i.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(i.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return N.REF}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const i=fo(e,r);let s=e,o=t;if(this.rowsSpan.sheet===i){const u=e.toSimpleRowAddress(r),h=t.toSimpleRowAddress(r);if(this.rowsSpan.rowStart<=u.row&&this.rowsSpan.rowEnd>=h.row)return N.REF;u.row>=this.rowsSpan.rowStart&&u.row<=this.rowsSpan.rowEnd&&(s=e.shiftedByRows(this.rowsSpan.rowEnd-u.row+1)),h.row>=this.rowsSpan.rowStart&&h.row<=this.rowsSpan.rowEnd&&(o=t.shiftedByRows(-(h.row-this.rowsSpan.rowStart+1)))}const a=this.transformCellAddress(s,r),l=this.transformCellAddress(o,r);return a===!1&&l===!1?[s,o]:a===N.REF||l===N.REF?N.REF:[a||s,l||o]}}class Pve extends Eu{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[i]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService));r.setFormula(i)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,r){return this.transformAddress(e)}transformColumnRange(e,t,r){return this.transformAddress(e)}transformRowRange(e,t,r){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet?N.REF:!1}}function Tj(n){if(!Array.isArray(n))throw new Jn("an array of arrays.");for(let e=0;e<n.length;e++)if(!Array.isArray(n[e]))throw new Jn("an array of arrays.")}function uC(n){let e=0,t=0,r=0;for(let s=0;s<n.length;s++){let o=0;for(let a=0;a<n[s].length;a++){const l=n[s][a];l!=null&&(o=a+1,++r)}e=Math.max(e,o),o>0&&(t=s+1)}const i=e*t;return{height:t,width:e,fill:i===0?0:r/i}}class Aj{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return hC(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>xi.fromNumberOfRows(this.sheet,e[0],e[1]))}}class Nj{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return cC(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>xi.fromNumberOfRows(this.sheet,e[0],e[1]))}}class Ij{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return cC(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>Xi.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class Mj{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return hC(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>Xi.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class Lve{constructor(e,t,r,i,s,o,a,l,u){this.dependencyGraph=t,this.columnSearch=r,this.cellContentParser=i,this.parser=s,this.stats=o,this.lazilyTransformingAstService=a,this.namedExpressions=l,this.arraySizePredictor=u,this.changes=uu.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const r of e.rowsSpans()){const i=this.doRemoveRows(r);i&&t.push(i)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const r of e.columnsSpans()){const i=this.doRemoveColumns(r);i&&t.push(i)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t=0;this.stats.measure(tt.TRANSFORM_ASTS,()=>{const i=new Pve(e);i.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(i)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const r=this.namedExpressions.getAllNamedExpressionsForScope(e).map(i=>this.removeNamedExpression(i.normalizeExpressionName(),e));return{version:t,scopedNamedExpressions:r}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e),r=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,uC(r)),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,r,i){const s=xi.fromNumberOfRows(e,i,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(s),i<t&&(t+=r);const o=Ce(e,0,t),a=Ce(e,0,i);this.moveCells(o,Number.POSITIVE_INFINITY,r,a);const l=xi.fromNumberOfRows(e,t,r);return this.doRemoveRows(l),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,r,i){const s=Xi.fromNumberOfColumns(e,i,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(s),i<t&&(t+=r);const o=Ce(e,t,0),a=Ce(e,i,0);this.moveCells(o,r,Number.POSITIVE_INFINITY,a);const l=Xi.fromNumberOfColumns(e,t,r);return this.doRemoveColumns(l),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,r,i){this.ensureItIsPossibleToMoveCells(e,t,r,i);const s=Le.spanFrom(e,t,r),o=Le.spanFrom(i,t,r),a=i.col-e.col,l=i.row-e.row,u=i.sheet,h=this.getRangeClipboardCells(o),c=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.removeValues(c);const d=this.dependencyGraph.rawValuesFromRange(s);this.columnSearch.moveValues(d,a,l,u);let f=0;this.stats.measure(tt.TRANSFORM_ASTS,()=>{const p=new Ove(s,a,l,u);p.performEagerTransformations(this.dependencyGraph,this.parser),f=this.lazilyTransformingAstService.addTransformation(p)}),this.dependencyGraph.moveCells(s,a,l,u);const m=this.updateNamedExpressionsForMovedCells(e,t,r,i);return{version:f,overwrittenCellsData:h,addedGlobalNamedExpressions:m}}setRowOrder(e,t){const r=[];let i=[];for(const[s,o]of t)if(s!==o){const a=Le.spanFrom({sheet:e,col:0,row:s},1/0,1),l=this.getRangeClipboardCells(a);i=i.concat(l),r.push(l.map(([{sheet:u,col:h},c])=>[{sheet:u,col:h,row:o},c]))}return r.forEach(s=>this.restoreClipboardCells(e,s.values())),i}setColumnOrder(e,t){const r=[];let i=[];for(const[s,o]of t)if(s!==o){const a=Le.spanFrom({sheet:e,col:s,row:0},1,1/0),l=this.getRangeClipboardCells(a);i=i.concat(l),r.push(l.map(([{sheet:u,col:h,row:c},d])=>[{sheet:u,col:o,row:c},d]))}return r.forEach(s=>this.restoreClipboardCells(e,s.values())),i}addNamedExpression(e,t,r,i){const s=this.namedExpressions.addNamedExpression(e,r,i);this.storeNamedExpressionInCell(s.address,t),this.adjustNamedExpressionEdges(s,e,r)}restoreNamedExpression(e,t,r){const i=e.displayName;this.restoreCell(e.address,t);const s=this.namedExpressions.restoreNamedExpression(e,r);this.adjustNamedExpressionEdges(s,i,r)}changeNamedExpressionExpression(e,t,r,i){const s=this.namedExpressions.namedExpressionForScope(e,r);if(!s)throw new Tg(e);const o=s.copy();s.options=i;const a=this.getClipboardCell(s.address);return this.storeNamedExpressionInCell(s.address,t),[o,a]}removeNamedExpression(e,t){const r=this.namedExpressions.namedExpressionForScope(e,t);if(!r)throw new Tg(e);this.namedExpressions.remove(r.displayName,t);const i=this.getClipboardCell(r.address);if(t!==void 0){const s=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(r.address,s.address)}else this.dependencyGraph.setCellEmpty(r.address);return[r,i]}ensureItIsPossibleToMoveCells(e,t,r,i){if(_i(e)||!(dC(t)&&dC(r)||Dve(e,t,r))||_i(i)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(i.sheet))throw new Jn("a valid range of cells to move.");const s=Le.spanFrom(e,t,r),o=Le.spanFrom(i,t,r);if(o.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Hh;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new wd;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new rC}restoreClipboardCells(e,t){const r=[];for(const[i,s]of t)if(this.restoreCell(i,s),s.type===Mr.FORMULA){const{dependencies:o}=this.parser.fetchCachedResult(s.hash);r.push(...this.updateNamedExpressionsForTargetAddress(e,i,o))}return r}restoreCell(e,t){switch(t.type){case Mr.VALUE:{this.setValueToCell(t,e);break}case Mr.FORMULA:{this.setFormulaToCellFromCache(t.hash,e);break}case Mr.EMPTY:{this.setCellEmpty(e);break}case Mr.PARSING_ERROR:{this.setParsingErrorToCell(t.rawInput,t.errors,e);break}}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof ql)return[e,{type:Mr.EMPTY}];if(t instanceof hu)return[e,Object.assign({type:Mr.VALUE},t.getValues())];if(t instanceof Qi)return[t.getAddress(this.lazilyTransformingAstService),{type:Mr.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof Md)return[e,{type:Mr.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof ql)return{type:Mr.EMPTY};if(t instanceof hu)return Object.assign({type:Mr.VALUE},t.getValues());if(t instanceof zn){const r=t.getArrayCellValue(e);return r===ft?{type:Mr.EMPTY}:{type:Mr.VALUE,parsedValue:r,rawValue:t.getArrayCellRawValue(e)}}else{if(t instanceof la)return{type:Mr.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof Md)return{type:Mr.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}}throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),i=new Array(t);for(let s=0;s<t;s++){i[s]=new Array(r);for(let o=0;o<r;o++){const a=Ce(e,o,s);i[s][o]=this.getClipboardCell(a)}}return i}getRangeClipboardCells(e){const t=[];for(const r of e.addresses(this.dependencyGraph))t.push([r,this.getClipboardCell(r)]);return t}setCellContent(e,t){const r=this.cellContentParser.parse(t),i=this.getOldContent(e);if(r instanceof yn.Formula){const s=this.parser.parse(r.formula,e),{ast:o,errors:a}=s;if(a.length>0)this.setParsingErrorToCell(r.formula,a,e);else try{const l=this.arraySizePredictor.checkArraySize(o,e);if(l.width<=0||l.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,l,s)}catch(l){if(!l.message)throw l;const u={type:Fn.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(r.formula,[u],e)}}else r instanceof yn.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e);return i}setSheetContent(e,t){this.clearSheet(e);for(let r=0;r<t.length;r++)for(let i=0;i<t[r].length;i++){const s=Ce(e,i,r);this.setCellContent(s,t[r][i])}}setParsingErrorToCell(e,t,r){const i=this.dependencyGraph.getCellValue(r),s=new Md(t,e),o=this.dependencyGraph.setParsingErrorToCell(r,s);this.columnSearch.remove(pe(i),r),this.columnSearch.applyChanges(o.getChanges()),this.changes.addAll(o),this.changes.addChange(s.getCellValue(),r)}setFormulaToCell(e,t,{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}){const a=this.dependencyGraph.getCellValue(e),l=this.dependencyGraph.setFormulaToCell(e,r,ta(o,e),t,i,s);this.columnSearch.remove(pe(a),e),this.columnSearch.applyChanges(l.getChanges()),this.changes.addAll(l)}setValueToCell(e,t){const r=this.dependencyGraph.getCellValue(t),i=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(pe(r),pe(e.parsedValue),t),this.columnSearch.applyChanges(i.getChanges().filter(s=>!Ng(s.address,t))),this.changes.addAll(i),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),r=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(pe(t),e),this.columnSearch.applyChanges(r.getChanges()),this.changes.addAll(r),this.changes.addChange(ft,e)}setFormulaToCellFromCache(e,t){const{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}=this.parser.fetchCachedResult(e),a=ta(o,t),[l]=new Mve(t.sheet).transformSingleAst(r,t);this.parser.rememberNewAst(l);const u=awe(a),h=this.arraySizePredictor.checkArraySize(r,t);this.dependencyGraph.setFormulaToCell(t,l,u,h,i,s)}rowEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getHeight(t);return e>=r}getAndClearContentChanges(){const e=this.changes;return this.changes=uu.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:r,contentChanges:i}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(i.getChanges());let s=0;return this.stats.measure(tt.TRANSFORM_ASTS,()=>{const o=new QN(e);o.performEagerTransformations(this.dependencyGraph,this.parser),s=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(r),{version:s,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:r,contentChanges:i}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(i.getChanges()),this.columnSearch.removeColumns(e);let s=0;return this.stats.measure(tt.TRANSFORM_ASTS,()=>{const o=new xve(e);o.performEagerTransformations(this.dependencyGraph,this.parser),s=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(r),{version:s,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(tt.TRANSFORM_ASTS,()=>{const r=new XN(e);r.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(r)}),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const r=t.getFormula(this.lazilyTransformingAstService),i=t.getAddress(this.lazilyTransformingAstService),s=this.parser.computeHashFromAst(r);this.setFormulaToCellFromCache(s,i)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:r}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(r.getChanges()),this.stats.measure(tt.TRANSFORM_ASTS,()=>{const i=new Ive(e);i.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(i)}),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getWidth(t);return e>=r}adjustNamedExpressionEdges(e,t,r){if(r===void 0)return;const{vertex:i,id:s}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=s??this.dependencyGraph.graph.getNodeId(i),a=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:l,id:u}=this.dependencyGraph.fetchCellOrCreateEmpty(a.address),h=u??this.dependencyGraph.graph.getNodeId(l);for(const c of this.dependencyGraph.graph.adjacentNodes(l))if(c instanceof la&&c.getAddress(this.lazilyTransformingAstService).sheet===r){const d=c.getFormula(this.lazilyTransformingAstService),f=c.getAddress(this.lazilyTransformingAstService),{dependencies:m}=this.parser.fetchCachedResultForAst(d);for(const p of ta(m,f))p instanceof rl&&p.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(h,c),this.dependencyGraph.graph.addEdge(o,c))}}storeNamedExpressionInCell(e,t){const r=this.cellContentParser.parse(t);if(r instanceof yn.Formula){const i=this.parser.parse(r.formula,Ce(-1,0,0));if(Wl(i.ast))throw new JO;const{ast:s,hasVolatileFunction:o,hasStructuralChangeFunction:a,dependencies:l}=i;this.dependencyGraph.setFormulaToCell(e,s,ta(l,e),Ct.scalar(),o,a)}else r instanceof yn.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,r,i){if(e.sheet===i.sheet)return[];const s=[],o=Le.spanFrom(i,t,r);for(const a of o.addresses(this.dependencyGraph)){const l=this.addressMapping.fetchCell(a);if(l instanceof la&&a.sheet!==e.sheet){const u=l.getFormula(this.lazilyTransformingAstService),{dependencies:h}=this.parser.fetchCachedResultForAst(u);s.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,a,h))}}return s}updateNamedExpressionsForTargetAddress(e,t,r){if(e===t.sheet)return[];const i=[],s=this.addressMapping.fetchCell(t);for(const o of ta(r,t)){if(!(o instanceof rl))continue;const a=o.name,l=this.dependencyGraph.fetchNamedExpressionVertex(a,e).vertex,h=this.namedExpressions.isExpressionInScope(a,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(a,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(a,l,i);h!==l&&(this.dependencyGraph.graph.removeEdgeIfExists(l,s),this.dependencyGraph.graph.addEdge(h,s))}return i}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(Xh.SHEET_FOR_WORKBOOK_EXPRESSIONS,new Nwe(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,r){let i=this.namedExpressions.namedExpressionForScope(e);if(i===void 0)if(i=this.namedExpressions.addNamedExpression(e),r.push(i.normalizeExpressionName()),t instanceof la){const s=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:u}=s;this.dependencyGraph.setFormulaToCell(i.address,o,ta(u,i.address),Ct.scalar(),a,l)}else t instanceof ql?this.setCellEmpty(i.address):t instanceof hu&&this.setValueToCell(t.getValues(),i.address);return this.dependencyGraph.fetchCellOrCreateEmpty(i.address).vertex}}function hC(n){if(n.length<=1)return n;const e=[...n].sort(([i],[s])=>i-s),t=e.reduce((i,[s,o])=>{const a=i[i.length-1],l=a[0]+a[1];return s<=l?a[1]+=Math.max(0,o-(l-s)):i.push([s,o]),i},[e[0]]);let r=0;for(let i=0;i<t.length;++i)t[i][0]-=r,r+=t[i][1];return t}function cC(n){if(n.length<=1)return n;const e=[...n].sort(([i],[s])=>i-s),t=e.reduce((i,[s,o])=>{const a=i[i.length-1];return s===a[0]?a[1]=Math.max(a[1],o):i.push([s,o]),i},[e[0]]);let r=0;for(let i=0;i<t.length;++i)t[i][0]+=r,r+=t[i][1];return t}function dC(n){return Number.isInteger(n)&&n>0}function Dve(n,e,t){return n.row===0&&dC(e)&&t===Number.POSITIVE_INFINITY||n.col===0&&dC(t)&&e===Number.POSITIVE_INFINITY}class nr{}class Hve extends nr{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class Fve extends nr{constructor(e,t,r,i,s,o,a){super(),this.sourceLeftCorner=e,this.width=t,this.height=r,this.destinationLeftCorner=i,this.overwrittenCellsData=s,this.addedGlobalNamedExpressions=o,this.version=a}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class kve extends nr{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class Vve extends nr{constructor(e,t,r){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=r}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class Uve extends nr{constructor(e,t,r){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=r}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class Bve extends nr{constructor(e,t,r){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=r}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class Wve extends nr{constructor(e,t,r,i,s){super(),this.sheet=e,this.startRow=t,this.numberOfRows=r,this.targetRow=i,this.version=s,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class $ve extends nr{constructor(e,t,r,i,s){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=r,this.targetColumn=i,this.version=s,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class Gve extends nr{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class jve extends nr{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class zve extends nr{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class Yve extends nr{constructor(e,t,r,i,s){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=r,this.scopedNamedExpressions=i,this.version=s}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class Kve extends nr{constructor(e,t,r){super(),this.sheetId=e,this.oldName=t,this.newName=r}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class qve extends nr{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class Xve extends nr{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class Qve extends nr{constructor(e,t,r,i){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=r,this.addedGlobalNamedExpressions=i}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class Zve extends nr{constructor(e,t,r,i){super(),this.name=e,this.newContent=t,this.scope=r,this.options=i}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class Jve extends nr{constructor(e,t,r){super(),this.namedExpression=e,this.content=t,this.scope=r}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class eye extends nr{constructor(e,t,r,i,s){super(),this.namedExpression=e,this.newContent=t,this.oldContent=r,this.scope=i,this.options=s}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class tye extends nr{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class nye{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new tye}commitBatchMode(){if(this.batchUndoEntry===void 0)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,r){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,r])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return this.undoStack.length===0}isRedoStackEmpty(){return this.redoStack.length===0}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:r}=e;for(let i=r.length-1;i>=0;--i){const s=r[i];this.operations.addRows(new Nj(t,[[s.rowFrom,s.rowCount]]));for(const{address:o,cellType:a}of s.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(s.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:r}=e;for(let i=r.length-1;i>=0;--i){const s=r[i];this.operations.addColumns(new Ij(t,[[s.columnFrom,s.columnCount]]));for(const{address:o,cellType:a}of s.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(s.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let r=t.length-1;r>=0;--r){const i=t[r];this.operations.removeRows(new Aj(e.command.sheet,[[i.rowStart,i.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let r=t.length-1;r>=0;--r){const i=t[r];this.operations.removeColumns(new Mj(e.command.sheet,[[i.columnStart,i.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const r=t.address,[i,s]=t.oldContent;Ng(r,i)||this.operations.setCellEmpty(r),this.operations.restoreCell(i,s)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:r}=e;this.operations.addSheet(e.sheetName);for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=Ce(r,o,i);this.operations.restoreCell(l,a)}}for(const[i,s]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(i,s,r);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:r}=e;for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=Ce(r,o,i);this.operations.restoreCell(l,a)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:r}=e;this.operations.clearSheet(r);for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=Ce(r,o,i);this.operations.restoreCell(l,a)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:r}=e,i=r.length,s=r[0].length;for(let o=0;o<i;++o)for(let a=0;a<s;++a){const l=Ce(t.sheet,t.col+a,t.row+o);this.operations.restoreCell(l,r[o][a])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:r}=e;this.operations.setSheetContent(t,r)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,r]of e)this.operations.restoreCell(t,r)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const r of t){const[i,s]=r;this.operations.setFormulaToCellFromCache(s,i)}}}class rye{constructor(e,t,r,i,s,o,a,l,u,h){this.operations=t,this.undoRedo=r,this.clipboardOperations=i,this.dependencyGraph=s,this.columnSearch=o,this.parser=a,this.cellContentParser=l,this.lazilyTransformingAstService=u,this.namedExpressions=h,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const r=new Nj(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(r),this.undoRedo.saveOperation(new kve(r))}removeRows(e,...t){const r=new Aj(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeRows(r);this.undoRedo.saveOperation(new Hve(r,i))}addColumns(e,...t){const r=new Ij(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(r),this.undoRedo.saveOperation(new Gve(r))}removeColumns(e,...t){const r=new Mj(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeColumns(r);this.undoRedo.saveOperation(new jve(r,i))}moveCells(e,t,r,i){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:s,overwrittenCellsData:o,addedGlobalNamedExpressions:a}=this.operations.moveCells(e,t,r,i);this.undoRedo.saveOperation(new Fve(e,t,r,i,o,a,s))}moveRows(e,t,r,i){this.ensureItIsPossibleToMoveRows(e,t,r,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const s=this.operations.moveRows(e,t,r,i);this.undoRedo.saveOperation(new Wve(e,t,r,i,s))}moveColumns(e,t,r,i){this.ensureItIsPossibleToMoveColumns(e,t,r,i),this.undoRedo.clearRedoStack();const s=this.operations.moveColumns(e,t,r,i);this.undoRedo.saveOperation(new $ve(e,t,r,i,s))}cut(e,t,r){this.clipboardOperations.cut(e,t,r)}ensureItIsPossibleToCopy(e,t,r){if(!Kc(t))throw new Jn("width to be positive integer.");if(!Kc(r))throw new Jn("height to be positive integer.")}copy(e,t,r){this.ensureItIsPossibleToCopy(e,t,r),this.clipboardOperations.copy(e,t,r)}paste(e){const t=this.clipboardOperations.clipboard;if(t===void 0)throw new rj;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const r=Le.spanFrom(e,t.width,t.height),i=this.operations.getRangeClipboardCells(r);this.undoRedo.clearRedoStack();const s=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new Qve(e,i,t.content,s))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return this.clipboardOperations.clipboard===void 0}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new zve(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),r=this.operations.getSheetClipboardCells(e),{version:i,scopedNamedExpressions:s}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new Yve(t,e,r,s,i))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const r=this.operations.renameSheet(e,t);return r!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new Kve(e,r,t))),r}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new qve(e,t))}setCellContents(e,t){if(!(t instanceof Array))t=[[t]];else for(let i=0;i<t.length;i++)if(!(t[i]instanceof Array))throw new Jn("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const r=[];for(let i=0;i<t.length;i++)for(let s=0;s<t[i].length;s++){const o={sheet:e.sheet,row:e.row+i,col:e.col+s},a=t[i][s];this.clipboardOperations.abortCut();const l=this.operations.setCellContent(o,a);r.push({address:o,newContent:a,oldContent:l})}this.undoRedo.saveOperation(new Xve(r))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),Tj(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new Bve(e,r,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new Vve(e,t,r))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Nn(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[r,i]of t)if(r!==i){const s=Le.spanFrom({sheet:e,col:r,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new wd}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new Uve(e,t,r))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Nn(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[r,i]of t)if(r!==i){const s=Le.spanFrom({sheet:e,col:0,row:r},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new wd}}mappingFromOrder(e,t,r){if(!this.sheetMapping.hasSheetWithId(e))throw new Nn(e);const i=r==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==i)throw new Jn(`number of ${r}s provided to be sheet ${r==="row"?"height":"width"}.`);const s=[];for(let o=0;o<i;o++)t[o]!==o&&s.push([o,t[o]]);return s}undo(){if(this.undoRedo.isUndoStackEmpty())throw new tj;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new nj;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,r,i){this.ensureItIsPossibleToAddNamedExpression(e,t,r),this.operations.addNamedExpression(e,t,r,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Zve(e,t,r,i))}changeNamedExpressionExpression(e,t,r,i){this.ensureItIsPossibleToChangeNamedExpression(e,r,t);const[s,o]=this.operations.changeNamedExpressionExpression(e,r,t,i);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new eye(s,r,o,t,i))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[r,i]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Jve(r,i,t)),r}ensureItIsPossibleToAddNamedExpression(e,t,r){this.ensureScopeIdIsValid(r),this.ensureNamedExpressionNameIsValid(e,r),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,r){if(this.ensureScopeIdIsValid(r),this.namedExpressions.namedExpressionForScope(e,r)===void 0)throw new Tg(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),this.namedExpressions.namedExpressionForScope(e,t)===void 0)throw new Tg(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new Nn(e);const r=this.dependencyGraph.getSheetHeight(e),i=t.map(s=>s[1]).reduce((s,o)=>s+o,0);if(r+i>this.maxRows)throw new Hh;for(const[s,o]of t)if(!fh(s)||!Kc(o))throw new Jn("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[r,i]of t){const s=r+i-1;if(!fh(r)||!fh(s))throw new Jn("starting and ending row to be nonnegative.");if(s<r)throw new Jn("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new Nn(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new Nn(e);const r=this.dependencyGraph.getSheetWidth(e),i=t.map(s=>s[1]).reduce((s,o)=>s+o,0);if(r+i>this.maxColumns)throw new Hh;for(const[s,o]of t)if(!fh(s)||!Kc(o))throw new Jn("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[r,i]of t){const s=r+i-1;if(!fh(r)||!fh(s))throw new Jn("starting and ending column to be nonnegative.");if(s<r)throw new Jn("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new Nn(e)}}ensureItIsPossibleToMoveRows(e,t,r,i){this.ensureItIsPossibleToAddRows(e,[i,r]);const s=Ce(e,0,t),o=Ce(e,0,i);if(!this.sheetMapping.hasSheetWithId(e)||_i(s)||_i(o)||!Kc(r)||i<=t+r&&i>=t)throw new Jn("a valid range of rows to move.");const a=this.dependencyGraph.getSheetWidth(e),l=Le.spanFrom(s,a,r);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new wd;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(xi.fromNumberOfRows(e,i-1,2)))throw new rC}ensureItIsPossibleToMoveColumns(e,t,r,i){this.ensureItIsPossibleToAddColumns(e,[i,r]);const s=Ce(e,t,0),o=Ce(e,i,0);if(!this.sheetMapping.hasSheetWithId(e)||_i(s)||_i(o)||!Kc(r)||i<=t+r&&i>=t)throw new Jn("a valid range of columns to move.");const a=this.dependencyGraph.getSheetHeight(e),l=Le.spanFrom(s,r,a);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new wd;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(Xi.fromNumberOfColumns(e,i-1,2)))throw new rC}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new Eg(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Nn(e);const r=this.sheetMapping.get(t);if(r!==void 0&&r!==e)throw new Eg(t)}ensureItIsPossibleToChangeContent(e){if(_i(e))throw new ZG(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new Nn(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const r=uC(t),i=Le.spanFrom(e,r.width,r.height);this.ensureRangeInSizeLimits(i);for(const s of i.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(s)}ensureItIsPossibleToChangeSheetContents(e,t){const r=uC(t),i=Le.spanFrom(Ce(e,0,0),r.width,r.height);this.ensureRangeInSizeLimits(i)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Hh}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new Nn(e)}validateRowOrColumnMapping(e,t,r){const i=r==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),s=t.map(([a,l])=>a).sort((a,l)=>a-l),o=t.map(([a,l])=>l).sort((a,l)=>a-l);for(let a=0;a<s.length;a++){if(!fh(s[a])||s[a]>=i)throw new Jn(`${r} numbers to be nonnegative integers and less than sheet ${r==="row"?"height":"width"}.`);if(s[a]===s[a+1])throw new Jn(`source ${r} numbers to be unique.`);if(s[a]!==o[a])throw new Jn(`target ${r} numbers to be permutation of source ${r} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new ej(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new JG(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof yn.Formula){const r=this.parser.parse(t.formula,Ce(-1,0,0));if(Wl(r.ast))throw new JO}}}function Kc(n){return Number.isInteger(n)&&n>0}function fh(n){return Number.isInteger(n)&&n>=0}class iye{constructor(e,t,r,i,s,o){this.config=e,this.stats=t,this.interpreter=r,this.lazilyTransformingAstService=i,this.dependencyGraph=s,this.columnSearch=o}run(){this.stats.start(tt.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(tt.TOP_SORT),this.stats.measure(tt.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){const t=uu.empty();return this.stats.measure(tt.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,r=>{if(r instanceof Qi){const i=r.isComputed()?r.getCellValue():void 0,s=this.recomputeFormulaVertexValue(r);if(s!==i){const o=r.getAddress(this.lazilyTransformingAstService);return t.addChange(s,o),this.columnSearch.change(pe(i),pe(s),o),!0}return!1}else return r instanceof $r&&r.clearCache(),!0},r=>{if(r instanceof $r)r.clearCache();else if(r instanceof Qi){const i=r.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(pe(r.valueOrUndef()),i);const s=new E(N.CYCLE,void 0,r);r.setCellValue(s),t.addChange(s,i)}})}),t}runAndForget(e,t,r){const i=[];for(const o of ta(r,t))if(o instanceof Le){const a=o;if(this.dependencyGraph.getRange(a.start,a.end)===void 0){const l=new $r(a);this.dependencyGraph.rangeMapping.setRange(l),i.push(l)}}const s=this.evaluateAstToCellValue(e,new ca(t,this.config.useArrayArithmetic));return i.forEach(o=>{this.dependencyGraph.rangeMapping.removeRange(o)}),s}recomputeFormulas(e,t){e.forEach(r=>{r instanceof Qi&&r.setCellValue(new E(N.CYCLE,void 0,r))}),t.forEach(r=>{if(r instanceof Qi){const i=this.recomputeFormulaVertexValue(r),s=r.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(pe(i),s)}else r instanceof $r&&r.clearCache()})}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof zn&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const r=e.getFormula(this.lazilyTransformingAstService),i=this.evaluateAstToCellValue(r,new ca(t,this.config.useArrayArithmetic,e));return e.setCellValue(i)}}evaluateAstToCellValue(e,t){const r=this.interpreter.evaluateAst(e,t);return r instanceof Me?r:r===ft&&this.config.evaluateNullToZero?0:r}}class ZN{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class Oj{constructor(e,t){this.name=e,this.newValue=t}}class sye{constructor(e,t,r,i){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=r,this.lazilyTransformingService=i}exportChange(e){const t=e.value,r=e.address;if(r.sheet===Xh.SHEET_FOR_WORKBOOK_EXPRESSIONS){const i=this.namedExpressions.namedExpressionInAddress(r.row);if(!i)throw new Error("Missing named expression");return new Oj(i.displayName,this.exportScalarOrRange(t))}else if(t instanceof Me){const i=[];for(const[s,o]of t.entriesFromTopLeftCorner(r))i.push(new ZN(o,this.exportValue(s)));return i}else return new ZN(r,this.exportValue(t))}exportValue(e){return e instanceof Me?this.detailedError(new E(N.VALUE,_.ScalarExpected)):this.config.smartRounding&&Lt(e)?this.cellValueRounding(pe(e)):e instanceof E?this.detailedError(e):e===ft?null:pe(e)}exportScalarOrRange(e){return e instanceof Me?e.rawData().map(t=>t.map(r=>this.exportValue(r))):this.exportValue(e)}detailedError(e){var t,r;let i;const s=(t=e.root)===null||t===void 0?void 0:t.getAddress(this.lazilyTransformingService);return s!==void 0&&(s.sheet===Xh.SHEET_FOR_WORKBOOK_EXPRESSIONS?i=(r=this.namedExpressions.namedExpressionInAddress(s.row))===null||r===void 0?void 0:r.displayName:i=Gy(this.sheetIndexMapping,s,-1)),new vj(e,this.config.translationPackage.getErrorTranslation(e.type),i)}cellValueRounding(e){if(e===0)return e;const t=Math.floor(Math.log10(Math.abs(e))),r=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}}class oye{constructor(e,t,r,i,s,o){this.dependencyGraph=e,this.columnSearch=t,this.parser=r,this.cellContentParser=i,this.stats=s,this.arraySizePredictor=o,this.buildStrategy=new aye(e,t,r,s,i,o)}buildGraph(e,t){const r=t.measure(tt.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(tt.PROCESS_DEPENDENCIES,()=>this.processDependencies(r))}processDependencies(e){e.forEach((t,r)=>{this.dependencyGraph.processCellDependencies(t,r)})}}class aye{constructor(e,t,r,i,s,o){this.dependencyGraph=e,this.columnIndex=t,this.parser=r,this.stats=i,this.cellContentParser=s,this.arraySizePredictor=o}run(e){const t=new Map;for(const r in e){const i=this.dependencyGraph.getSheetId(r),s=e[r];for(let o=0;o<s.length;++o){const a=s[o];for(let l=0;l<a.length;++l){const u=a[l],h=Ce(i,l,o),c=this.cellContentParser.parse(u);if(c instanceof yn.Formula){const d=this.stats.measure(tt.PARSER,()=>this.parser.parse(c.formula,h));if(d.errors.length>0){this.shrinkArrayIfNeeded(h);const f=new Md(d.errors,c.formula);this.dependencyGraph.addVertex(h,f)}else{this.shrinkArrayIfNeeded(h);const f=this.arraySizePredictor.checkArraySize(d.ast,h);if(f.isScalar()){const m=new la(d.ast,h,0);t.set(m,ta(d.dependencies,h)),this.dependencyGraph.addVertex(h,m),d.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(m),d.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(m)}else{const m=new zn(d.ast,h,new Ct(f.width,f.height));t.set(m,ta(d.dependencies,h)),this.dependencyGraph.addArrayVertex(h,m)}}}else if(!(c instanceof yn.Empty)){this.shrinkArrayIfNeeded(h);const d=new hu(c.value,u);this.columnIndex.add(pe(c.value),h),this.dependencyGraph.addVertex(h,d)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof zn&&this.dependencyGraph.shrinkArrayToCorner(t)}}const Zw=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class _j extends st{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:r,licenseKey:i}=this.config;let s;return Zw.has(i)?s=Zw.get(i):Zw.has(r)?s=Zw.get(r):r==="valid"&&(s=i.slice(-5)),`HyperFormula v${Tr.version}, ${s}`})}}_j.implementedFunctions={VERSION:{method:"version",parameters:[]}};function vA(n,e){var t;let r=e.implementedFunctions[n];const i=(t=e.aliases)===null||t===void 0?void 0:t[n];if(i!==void 0){if(r!==void 0)throw new fwe(n,e.name);r=e.implementedFunctions[i]}if(r===void 0)throw $d.functionNotDeclaredInPlugin(n,e.name);return r}class ur{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=t=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(t),this.isFunctionVolatile=t=>this.volatileFunctions.has(t),this.isArrayFunction=t=>this.arrayFunctions.has(t),this.isFunctionDependentOnSheetStructureChange=t=>this.structuralChangeFunctions.has(t),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)ur.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(ur.plugins);for(const[t,r]of ur.protectedFunctions())ur.loadFunctionUnprotected(r,t,this.instancePlugins);for(const[t,r]of this.instancePlugins.entries())this.categorizeFunction(t,vA(t,r))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),t!==void 0&&this.loadTranslations(t)}static registerFunction(e,t,r){this.loadPluginFunction(t,e,this.plugins),r!==void 0&&this.loadTranslations(r)}static unregisterFunction(e){if(this.functionIsProtected(e))throw Fh.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw Fh.cannotUnregisterProtectedPlugin();for(const[t,r]of this.plugins.entries())r===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(Tr.getRegisteredLanguagesCodes());Object.keys(e).forEach(r=>{t.has(r)&&Tr.getLanguage(r).extendFunctions(e[r])})}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach(r=>{this.loadPluginFunction(e,r,t)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(r=>{this.loadPluginFunction(e,r,t)})}static loadPluginFunction(e,t,r){if(this.functionIsProtected(t))throw Fh.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,r)}static loadFunctionUnprotected(e,t,r){const i=vA(t,e).method;if(Object.prototype.hasOwnProperty.call(e.prototype,i))r.set(t,e);else throw $d.functionMethodNotFound(i,e.name)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)t!==void 0&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)e!==void 0&&(yield e)}initializePlugins(e){const t=[];for(const[r,i]of this.instancePlugins.entries()){let s=t.find(u=>u instanceof i);s===void 0&&(s=new i(e),t.push(s));const o=vA(r,i),a=o.method;this.functions.set(r,[a,s]);const l=o.arraySizeMethod;l!==void 0&&this.arraySizeFunctions.set(r,[l,s])}}getFunctionPlugin(e){if(!ur.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[r,i]=t;return(s,o)=>i[r](s,o)}else return}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[r,i]=t;return(s,o)=>i[r](s,o)}else return}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,r]of this.instancePlugins)ur.functionIsProtected(t)||e.add(r);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}ur.plugins=new Map;ur._protectedPlugins=new Map([["VERSION",_j],["OFFSET",void 0]]);var Cr;(function(n){n.GREATER_THAN="GREATER_THAN",n.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",n.LESS_THAN="LESS_THAN",n.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",n.NOT_EQUAL="NOT_EQUAL",n.EQUAL="EQUAL"})(Cr||(Cr={}));const Jw=(n,e)=>({operator:n,value:e});class lye{constructor(e){var t,r,i,s;this.trueString=(r=(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||t===void 0?void 0:t.toLowerCase())!==null&&r!==void 0?r:"true",this.falseString=(s=(i=e.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||i===void 0?void 0:i.toLowerCase())!==null&&s!==void 0?s:"false"}fromCellValue(e,t){if(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")return;const r=this.parseCriterion(e,t);if(r!==void 0)return{raw:e,lambda:cye(r,t)}}parseCriterion(e,t){if(typeof e=="number"||typeof e=="boolean")return Jw(Cr.EQUAL,e);if(typeof e=="string"){const r=uye.exec(e);let i,s;r?(s=hye(r[1]),i=r[2]):(s=Cr.EQUAL,i=e);const o=t.coerceToMaybeNumber(i),a=i.toLowerCase()===this.trueString?!0:i.toLowerCase()===this.falseString?!1:void 0;if(s===void 0)return;if(i==="")return Jw(s,null);if(o===void 0){if(s===Cr.EQUAL||s===Cr.NOT_EQUAL)return Jw(s,a??i)}else return Jw(s,pe(o))}}}const uye=/([<>=]+)(.*)/;function hye(n){switch(n){case">":return Cr.GREATER_THAN;case">=":return Cr.GREATER_THAN_OR_EQUAL;case"<":return Cr.LESS_THAN;case"<=":return Cr.LESS_THAN_OR_EQUAL;case"<>":return Cr.NOT_EQUAL;case"=":return Cr.EQUAL;default:return}}const cye=(n,e)=>{switch(n.operator){case Cr.GREATER_THAN:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)>0:t=>!1;case Cr.GREATER_THAN_OR_EQUAL:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)>=0:t=>!1;case Cr.LESS_THAN:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)<0:t=>!1;case Cr.LESS_THAN_OR_EQUAL:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)<=0:t=>!1;case Cr.EQUAL:return typeof n.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,n.value)===0;if(typeof t=="string"){if(t==="")return!1;const r=e.coerceToMaybeNumber(t);return r===void 0?!1:e.floatCmp(r,n.value)===0}else return!1}:typeof n.value=="string"?e.eqMatcherFunction(n.value):typeof n.value=="boolean"?t=>typeof t=="boolean"&&t===n.value:t=>t===ft;case Cr.NOT_EQUAL:return typeof n.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,n.value)!==0;if(typeof t=="string"){if(t==="")return!0;const r=e.coerceToMaybeNumber(t);return r===void 0?!0:e.floatCmp(r,n.value)!==0}else return!0}:typeof n.value=="string"?e.neqMatcherFunction(n.value):typeof n.value=="boolean"?t=>typeof t!="boolean"||t!==n.value:t=>t!==ft}};class dye{constructor(e,t,r,i,s,o,a,l,u,h){this.config=e,this.dependencyGraph=t,this.columnSearch=r,this.stats=i,this.arithmeticHelper=s,this.functionRegistry=o,this.namedExpressions=a,this.serialization=l,this.arraySizePredictor=u,this.dateTimeHelper=h,this.equalOp=(c,d)=>us(this.arithmeticHelper.eq,c,d),this.notEqualOp=(c,d)=>us(this.arithmeticHelper.neq,c,d),this.greaterThanOp=(c,d)=>us(this.arithmeticHelper.gt,c,d),this.lessThanOp=(c,d)=>us(this.arithmeticHelper.lt,c,d),this.greaterThanOrEqualOp=(c,d)=>us(this.arithmeticHelper.geq,c,d),this.lessThanOrEqualOp=(c,d)=>us(this.arithmeticHelper.leq,c,d),this.concatOp=(c,d)=>us(this.arithmeticHelper.concat,jN(c),jN(d)),this.plusOp=(c,d)=>us(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.minusOp=(c,d)=>us(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.timesOp=(c,d)=>us(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.powerOp=(c,d)=>us(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.divOp=(c,d)=>us(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.unaryMinusOp=c=>QF(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(c)),this.percentOp=c=>QF(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(c)),this.unaryPlusOp=c=>this.arithmeticHelper.unaryPlus(c),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new lye(e)}evaluateAst(e,t){let r=this.evaluateAstWithoutPostprocessing(e,t);if(Lt(r)){if(gj(pe(r)))return new E(N.NUM,_.NaN);r=qO(r,pj(pe(r)))}return r instanceof Me&&r.height()===1&&r.width()===1&&([[r]]=r.data),fye(r,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case M.EMPTY:return ft;case M.CELL_REFERENCE:{const r=e.reference.toSimpleCellAddress(t.formulaAddress);return _i(r)?new E(N.REF,_.BadRef):this.dependencyGraph.getCellValue(r)}case M.NUMBER:case M.STRING:return e.value;case M.CONCATENATE_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,r,i,t)}case M.EQUALS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,r,i,t)}case M.NOT_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,r,i,t)}case M.GREATER_THAN_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,r,i,t)}case M.LESS_THAN_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,r,i,t)}case M.GREATER_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,r,i,t)}case M.LESS_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,r,i,t)}case M.PLUS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,r,i,t)}case M.MINUS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,r,i,t)}case M.TIMES_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,r,i,t)}case M.POWER_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,r,i,t)}case M.DIV_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,r,i,t)}case M.PLUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,r,t)}case M.MINUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,r,t)}case M.PERCENT_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,r,t)}case M.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!ur.functionIsProtected(e.procedureName))return new E(N.LIC,_.LicenseKey(this.config.licenseKeyValidityState));const r=this.functionRegistry.getFunction(e.procedureName);return r!==void 0?r(e,new ca(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new E(N.NAME,_.FunctionName(e.procedureName))}case M.NAMED_EXPRESSION:{const r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return r?this.dependencyGraph.getCellValue(r.address):new E(N.NAME,_.NamedExpressionName(e.expressionName))}case M.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new E(N.REF,_.RangeManySheets);const r=Le.fromCellRange(e,t.formulaAddress),i=this.dependencyGraph.getArray(r);if(i){const s=i.array;if(s instanceof wm)throw new Error("Array should be already computed");if(s instanceof E)return s;if(s instanceof Gd)return Me.fromRange(s.raw(),r,this.dependencyGraph);throw new Error("Unknown array")}else return Me.onlyRange(r,this.dependencyGraph)}case M.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new E(N.REF,_.RangeManySheets);const r=ol.fromColumnRange(e,t.formulaAddress);return Me.onlyRange(r,this.dependencyGraph)}case M.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new E(N.REF,_.RangeManySheets);const r=al.fromRowRangeAst(e,t.formulaAddress);return Me.onlyRange(r,this.dependencyGraph)}case M.PARENTHESIS:return this.evaluateAst(e.expression,t);case M.ARRAY:{let r;const i=[];for(const s of e.args){let o;const a=[];for(const u of s){const h=fj(this.evaluateAst(u,t)),c=h.height();if(o===void 0)o=c,a.push(...h.data);else if(o===c)for(let d=0;d<c;d++)a[d].push(...h.data[d]);else return new E(N.REF,_.SizeMismatch)}const l=a[0].length;if(r===void 0)r=l,i.push(...a);else if(r===l)i.push(...a);else return new E(N.REF,_.SizeMismatch)}return Me.onlyValues(i)}case M.ERROR_WITH_RAW_INPUT:case M.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,r){var i;if(t instanceof Me&&!r.arraysFlag&&(t=(i=Vv(t,r))!==null&&i!==void 0?i:new E(N.VALUE,_.ScalarExpected)),t instanceof E)return t;if(t instanceof Me){const s=t.data.map(o=>o.map(e));return Me.onlyValues(s)}return e(t)}binaryRangeWrapper(e,t,r,i){var s,o;if(t instanceof Me&&!i.arraysFlag&&(t=(s=Vv(t,i))!==null&&s!==void 0?s:new E(N.VALUE,_.ScalarExpected)),t instanceof E)return t;if(r instanceof Me&&!i.arraysFlag&&(r=(o=Vv(r,i))!==null&&o!==void 0?o:new E(N.VALUE,_.ScalarExpected)),r instanceof E)return r;if(t instanceof Me||r instanceof Me){if(!(t instanceof Me))if(r.isAdHoc()){const h=r.data;for(let c=0;c<h.length;c++)for(let d=0;d<h[0].length;d++)h[c][d]=e(t,h[c][d]);return Me.onlyValues(h)}else t=Me.fromScalar(t);if(!(r instanceof Me))if(t.isAdHoc()){const h=t.data;for(let c=0;c<h.length;c++)for(let d=0;d<h[0].length;d++)h[c][d]=e(h[c][d],r);return Me.onlyValues(h)}else r=Me.fromScalar(r);if(t.width()===r.width()&&t.height()===r.height()){if(t.isAdHoc()){const h=t.data,c=r.data;for(let d=0;d<h.length;d++)for(let f=0;f<h[0].length;f++)h[d][f]=e(h[d][f],c[d][f]);return Me.onlyValues(h)}if(r.isAdHoc()){const h=t.data,c=r.data;for(let d=0;d<h.length;d++)for(let f=0;f<h[0].length;f++)c[d][f]=e(h[d][f],c[d][f]);return Me.onlyValues(c)}}const a=Math.max(t.width(),r.width()),l=Math.max(t.height(),r.height()),u=Array(l);for(let h=0;h<l;h++)u[h]=Array(a);for(let h=0;h<l;h++){const c=t.height()!==1?h:0,d=r.height()!==1?h:0;for(let f=0;f<a;f++){const m=t.width()!==1?f:0,p=r.width()!==1?f:0;c<t.height()&&d<r.height()&&m<t.width()&&p<r.width()?u[h][f]=e(t.data[c][m],r.data[d][p]):u[h][f]=new E(N.NA)}}return Me.onlyValues(u)}return e(t,r)}}function QF(n,e){return e instanceof E?e:n(e)}function us(n,e,t){return e instanceof E?e:t instanceof E?t:n(e,t)}function fye(n,e){return n instanceof E&&e!==void 0?n.attachRootVertex(e):n}class mye{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach(r=>r.performEagerTransformations(e,t))}transformSingleAst(e,t){let[r,i]=[e,t];return this.transformations.forEach(s=>{[r,i]=s.transformSingleAst(r,i)}),[r,i]}isIrreversible(){return!0}}class gye{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new mye(e)}commitCombinedMode(){if(this.combinedTransformer===void 0)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,r){this.stats.start(tt.TRANSFORM_ASTS_POSTPONED);for(let s=r;s<this.transformations.length;s++){const o=this.transformations[s];o.isIrreversible()&&(this.undoRedo.storeDataForVersion(s,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[a,l]=o.transformSingleAst(e,t);e=a,t=l}const i=this.parser.rememberNewAst(e);return this.stats.end(tt.TRANSFORM_ASTS_POSTPONED),[i,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let r=e;r<this.transformations.length;r++){const i=this.transformations[r];(!t||t(i))&&(yield i)}}}const Uv=-1;function pye(n,e,{searchCoordinate:t,orderingDirection:r,matchExactly:i},s){const o=e.start[t],a=t==="col"?e.effectiveEndColumn(s):e.effectiveEndRow(s),l=t==="col"?d=>pe(s.getCellValue(Ce(e.sheet,d,e.start.row))):d=>pe(s.getCellValue(Ce(e.sheet,e.start.col,d))),u=r==="asc"?(d,f)=>ZF(d,f):(d,f)=>-ZF(d,f),h=wye(d=>u(n,l(d))>=0,o,a),c=l(h);return h===Uv||typeof c!=typeof n||i&&c!==n?Uv:h-o}function wye(n,e,t){let r=e,i=t;for(;r<i;){const s=Math.ceil((r+i)/2);n(s)?r=s:i=s-1}return r===i&&n(r)?r:Uv}function ZF(n,e){return typeof n==typeof e?n===ft?0:n<e?-1:n>e?1:0:n===ft?-1:e===ft?1:e instanceof E||typeof n=="number"&&typeof e=="string"||typeof n=="number"&&typeof e=="boolean"?-1:typeof n=="string"&&typeof e=="number"?1:typeof n=="string"&&typeof e=="boolean"?-1:1}class xj{constructor(e){this.dependencyGraph=e}advancedFind(e,t){let r;const i=t.range;i===void 0?r=t.valuesFromTopLeftCorner():r=this.dependencyGraph.computeListOfValuesInRange(i);for(let s=0;s<r.length;s++)if(e(pe(r[s])))return s;return-1}basicFind(e,t,r,{ordering:i,matchExactly:s}){const o=typeof e=="string"?qm(e):e,a=t.range;return a===void 0?this.findNormalizedValue(o,t.valuesFromTopLeftCorner()):i==="none"?this.findNormalizedValue(o,this.dependencyGraph.computeListOfValuesInRange(a)):pye(o,a,{searchCoordinate:r,orderingDirection:i,matchExactly:s},this.dependencyGraph)}findNormalizedValue(e,t){return t.map(pe).map(r=>typeof r=="string"?qm(r):r).indexOf(e)}}class Pj extends xj{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,r){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,r,i){}removeValues(e){}find(e,t,r){return this.basicFind(e,t,"row",r)}}class Eh{constructor(e,t,r){this.dependencyGraph=e,this.config=t,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new Pj(e)}add(e,t){if(!(e===ft||e instanceof E))if(e instanceof Me)for(const[r,i]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(pe(r),i);else this.addSingleCellValue(e,t)}remove(e,t){if(e!==void 0)if(e instanceof Me)for(const[r,i]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(pe(r),i);else this.removeSingleValue(e,t)}change(e,t,r){e!==t&&(this.remove(e,r),this.add(t,r))}applyChanges(e){for(const t of e)t.oldValue!==void 0&&this.change(pe(t.oldValue),pe(t.value),t.address)}moveValues(e,t,r,i){for(const[s,o]of e){const a=Dwe(o,i,t,r);this.remove(s,o),this.add(s,a)}}removeValues(e){for(const[t,r]of e)this.remove(t,r)}find(e,t,{ordering:r,matchExactly:i}){const s=i===!0?"findFirst":"findLast",o=this.findUsingColumnIndex(e,t,s);return o!==void 0?o:this.binarySearchStrategy.find(e,t,{ordering:r,matchExactly:i})}findUsingColumnIndex(e,t,r){const i=t.range;if(i===void 0)return;this.ensureRecentData(i.sheet,i.start.col,e);const s=this.getColumnMap(i.sheet,i.start.col);if(!s)return-1;const o=typeof e=="string"?qm(e):e,a=s.get(o);if(!a||!a.index||a.index.length===0)return;const l=Eh.findRowBelongingToRange(a,i,r);return l!==void 0?l-i.start.row:void 0}static findRowBelongingToRange(e,t,r){const i=t.start.row,s=t.end.row,o=r==="findFirst"?mh(i,e.index,"upperBound"):mh(s,e.index,"lowerBound");if(o===-1)return;const a=e.index[o];return a>=i&&a<=s?a:void 0}advancedFind(e,t){return this.binarySearchStrategy.advancedFind(e,t)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const r=this.index.get(e);let i=r[t];return i||(i=new Map,r[t]=i),i}getValueIndex(e,t,r){const i=this.getColumnMap(e,t);let s=this.getColumnMap(e,t).get(r);return s||(s={version:this.transformingService.version(),index:[]},i.set(r,s)),s}ensureRecentData(e,t,r){const i=this.getValueIndex(e,t,r),s=this.transformingService.version();if(i.version===s)return;const o=this.transformingService.getTransformationsFrom(i.version,a=>a.sheet===e&&(a instanceof XN||a instanceof QN));for(const a of o)a instanceof XN?this.addRows(t,a.rowsSpan,r):a instanceof QN&&this.removeRows(t,a.rowsSpan,r);i.version=s}addSingleCellValue(e,t){this.stats.measure(tt.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e),typeof e=="string"&&(e=qm(e));const r=this.getValueIndex(t.sheet,t.col,e);Eh.addValue(r,t.row)})}removeSingleValue(e,t){this.stats.measure(tt.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e);const r=this.getColumnMap(t.sheet,t.col);typeof e=="string"&&(e=qm(e));const i=r.get(e);if(!i)return;const s=mh(t.row,i.index);s>-1&&i.index.splice(s,1),i.index.length===0&&r.delete(e),r.size===0&&delete this.index.get(t.sheet)[t.col]})}addRows(e,t,r){const i=this.getValueIndex(t.sheet,e,r);Eh.shiftRows(i,t.rowStart,t.numberOfRows)}removeRows(e,t,r){const i=this.getValueIndex(t.sheet,e,r);Eh.removeRowsFromValues(i,t),Eh.shiftRows(i,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const r=mh(t,e.index,"lowerBound");e.index[r]===t||e.index.splice(r+1,0,t)}static removeRowsFromValues(e,t){const r=mh(t.rowStart,e.index,"upperBound"),i=mh(t.rowEnd,e.index,"lowerBound");r>-1&&i>-1&&r<=i&&e.index[r]<=t.rowEnd&&e.index.splice(r,i-r+1)}static shiftRows(e,t,r){const i=mh(t,e.index,"upperBound");if(i!==-1)for(let s=i;s<e.index.length;++s)e.index[s]+=r}}function mh(n,e,t="upperBound"){let r=0,i=e.length-1;for(;r<=i;){const a=Math.floor((r+i)/2);if(n>e[a])r=a+1;else if(n<e[a])i=a-1;else return a}const s=t==="lowerBound"?i:r;return s>=0&&s<=e.length?s:-1}function vye(n,e,t){return e.useColumnIndex?new Eh(n,e,t):new Pj(n)}class yye{constructor(e){this.config=e;const t=this.config.thousandSeparator==="."?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,r=this.config.decimalSeparator==="."?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${r}\\d+)|(\\d+(${t}\\d{3,})*(${r}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);return isNaN(t)?void 0:t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}class n_{constructor(e,t,r){this.dependencyGraph=e,this.unparser=t,this.exporter=r}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof la){const r=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(r.procedureName==="HYPERLINK")return r.hyperlink}}getCellFormula(e,t){const r=this.dependencyGraph.getCell(e);if(r instanceof la){const i=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=t??e,this.unparser.unparse(i,t)}else if(r instanceof zn){const i=r.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(i.row!==e.row||i.col!==e.col||i.sheet!==e.sheet)return;t=t??e;const s=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(s!==void 0)return this.unparser.unparse(s,t)}else if(r instanceof Md)return r.getFormula()}getCellSerialized(e,t){var r;return(r=this.getCellFormula(e,t))!==null&&r!==void 0?r:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,t=>this.getCellValue(t))}getSheetFormulas(e){return this.genericSheetGetter(e,t=>this.getCellFormula(t))}genericSheetGetter(e,t){const r=this.dependencyGraph.getSheetHeight(e),i=this.dependencyGraph.getSheetWidth(e),s=new Array(r);for(let o=0;o<r;o++){s[o]=new Array(i);for(let a=0;a<i;a++){const l=Ce(e,a,o);s[o][a]=t(l)}for(let a=i-1;a>=0&&(s[o][a]===null||s[o][a]===void 0);a--)s[o].pop()}for(let o=r-1;o>=0&&s[o].length===0;o--)s.pop();return s}genericAllSheetsGetter(e){const t={};for(const r of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(r);t[r]=e(i)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,t=>this.getCellSerialized(t))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const r of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(r);e[i]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(r=>({name:r.expression.displayName,expression:this.getCellSerialized(r.expression.address),scope:r.scope!==void 0?e[r.scope]:void 0,options:r.expression.options}))}withNewConfig(e,t){const r=new YG(e,KO(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new n_(this.dependencyGraph,r,this.exporter)}}class ev{static buildFromSheets(e,t={},r=[]){const i=new _r(t);return this.buildEngine(i,e,r)}static buildFromSheet(e,t={},r=[]){const i=new _r(t),s=i.translationPackage.getUITranslation(Ag.NEW_SHEET_PREFIX)+"1";return this.buildEngine(i,{[s]:e},r)}static buildEmpty(e={},t=[]){return this.buildEngine(new _r(e),{},t)}static rebuildWithConfig(e,t,r,i){return this.buildEngine(e,t,r,i)}static buildEngine(e,t={},r=[],i=e.useStats?new XG:new hwe){i.start(tt.BUILD_ENGINE_TOTAL);const s=new Xh,o=new ur(e),a=new gye(i),l=e_.buildEmpty(a,e,o,s,i),u=vye(l,e,i),h=l.sheetMapping,c=l.addressMapping;for(const q in t)if(Object.prototype.hasOwnProperty.call(t,q)){const J=t[q];Tj(J);const re=uC(J);if(re.height>e.maxRows||re.width>e.maxColumns)throw new Hh;const ie=h.addSheet(q);c.autoAddSheet(ie,re)}const d=new Ym(e,o,h.get);a.parser=d;const f=new YG(e,KO(e),h.fetchDisplayName,s),m=new ive(e),p=new yye(e),v=new Uwe(e,m,p),y=new Tve(e,m,p),C=new Ywe(e,o),R=new Lve(e,l,u,y,d,i,a,s,C),A=new nye(e,R);a.undoRedo=A;const I=new Ave(e,l,R),H=new rye(e,R,A,I,l,u,d,y,a,s);r.forEach(q=>{H.ensureItIsPossibleToAddNamedExpression(q.name,q.expression,q.scope),H.operations.addNamedExpression(q.name,q.expression,q.scope,q.options)});const k=new sye(e,s,h.fetchDisplayName,a),W=new n_(l,f,k),z=new dye(e,l,u,i,v,o,s,W,C,m);i.measure(tt.GRAPH_BUILD,()=>{new oye(l,u,d,y,i,C).buildGraph(t,i)});const G=new iye(e,i,z,a,l,u);return G.run(),i.end(tt.BUILD_ENGINE_TOTAL),{config:e,stats:i,dependencyGraph:l,columnSearch:u,parser:d,unparser:f,cellContentParser:y,evaluator:G,lazilyTransformingAstService:a,crudOperations:H,exporter:k,namedExpressions:s,serialization:W,functionRegistry:o}}}function Cye(n){for(const[e,t]of Object.entries(n))t instanceof Function?n[e]=Sye(t):delete n[e]}function Sye(n){return()=>{throw new Error(`The "${n}" method cannot be called because this HyperFormula instance has been destroyed`)}}var tv={exports:{}},JF;function Rye(){if(JF)return tv.exports;JF=1;function n(){}return n.prototype={on:function(e,t,r){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var i=this;function s(){i.off(e,s),t.apply(r,arguments)}return s._=t,this.on(e,s,r)},emit:function(e){var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),i=0,s=r.length;for(i;i<s;i++)r[i].fn.apply(r[i].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),i=r[e],s=[];if(i&&t)for(var o=0,a=i.length;o<a;o++)i[o].fn!==t&&i[o].fn._!==t&&s.push(i[o]);return s.length?r[e]=s:delete r[e],this}},tv.exports=n,tv.exports.TinyEmitter=n,tv.exports}var Eye=Rye();var Xo;(function(n){n.SheetAdded="sheetAdded",n.SheetRemoved="sheetRemoved",n.SheetRenamed="sheetRenamed",n.NamedExpressionAdded="namedExpressionAdded",n.NamedExpressionRemoved="namedExpressionRemoved",n.ValuesUpdated="valuesUpdated",n.EvaluationSuspended="evaluationSuspended",n.EvaluationResumed="evaluationResumed"})(Xo||(Xo={}));class bye extends Eye.TinyEmitter{emit(e,...t){return super.emit(e,...t),this}}class Tr{constructor(e,t,r,i,s,o,a,l,u,h,c,d,f,m){this._config=e,this._stats=t,this._dependencyGraph=r,this._columnSearch=i,this._parser=s,this._unparser=o,this._cellContentParser=a,this._evaluator=l,this._lazilyTransformingAstService=u,this._crudOperations=h,this._exporter=c,this._namedExpressions=d,this._serialization=f,this._functionRegistry=m,this._emitter=new bye,this._evaluationSuspended=!1}static get defaultConfig(){return Tye()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},r=[]){return this.buildFromEngineState(ev.buildFromSheet(e,t,r))}static buildFromSheets(e,t={},r=[]){return this.buildFromEngineState(ev.buildFromSheets(e,t,r))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(ev.buildEmpty(e,t))}static getLanguage(e){ce(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(t===void 0)throw new BN;return t}static registerLanguage(e,t){if(ce(e,"string","languageCode"),this.registeredLanguages.has(e))throw new hj;this.registeredLanguages.set(e,bwe(t))}static unregisterLanguage(e){if(ce(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new BN}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){ur.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){ur.unregisterFunctionPlugin(e)}static registerFunction(e,t,r){ce(e,"string","functionId"),ur.registerFunction(e,t,r)}static unregisterFunction(e){ce(e,"string","functionId"),ur.unregisterFunction(e)}static unregisterAllFunctions(){ur.unregisterAll()}static getRegisteredFunctionNames(e){ce(e,"string","code");const t=ur.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return ce(e,"string","functionId"),ur.getFunctionPlugin(e)}static getAllFunctionPlugins(){return ur.getPlugins()}static buildFromEngineState(e){return new Tr(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!Hn(e))throw new xt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!Hn(e))throw new xt("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!Hn(e))throw new xt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!Hn(e))throw new xt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return ce(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return ce(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return ce(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return ce(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([r,i])=>this._config[r]===i)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if(Hn(e))t=new Le(e,e);else if(Ui(e))t=new Le(e.start,e.end);else throw new xt("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(t);for(const r of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(r)}catch{return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return ce(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){ce(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch{return!1}}setRowOrder(e,t){ce(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,r)}isItPossibleToSetRowOrder(e,t){ce(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch{return!1}}swapColumnIndexes(e,t){return ce(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){ce(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch{return!1}}setColumnOrder(e,t){ce(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,r)}isItPossibleToSetColumnOrder(e,t){ce(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch{return!1}}isItPossibleToAddRows(e,...t){ce(e,"number","sheetId");const r=cC(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...r),!0}catch{return!1}}addRows(e,...t){return ce(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){ce(e,"number","sheetId");const r=hC(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...r),!0}catch{return!1}}removeRows(e,...t){return ce(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){ce(e,"number","sheetId");const r=cC(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...r),!0}catch{return!1}}addColumns(e,...t){return ce(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){ce(e,"number","sheetId");const r=hC(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...r),!0}catch{return!1}}removeColumns(e,...t){return ce(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!Hn(t))throw new xt("SimpleCellAddress","destinationLeftCorner");if(!Ui(e))throw new xt("SimpleCellRange","source");try{const r=new Le(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(r.start,r.width(),r.height(),t),!0}catch{return!1}}moveCells(e,t){if(!Hn(t))throw new xt("SimpleCellAddress","destinationLeftCorner");if(!Ui(e))throw new xt("SimpleCellRange","source");const r=new Le(e.start,e.end);return this._crudOperations.moveCells(r.start,r.width(),r.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,r,i){ce(e,"number","sheetId"),ce(t,"number","startRow"),ce(r,"number","numberOfRows"),ce(i,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,r,i),!0}catch{return!1}}moveRows(e,t,r,i){return ce(e,"number","sheetId"),ce(t,"number","startRow"),ce(r,"number","numberOfRows"),ce(i,"number","targetRow"),this._crudOperations.moveRows(e,t,r,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,r,i){ce(e,"number","sheetId"),ce(t,"number","startColumn"),ce(r,"number","numberOfColumns"),ce(i,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,r,i),!0}catch{return!1}}moveColumns(e,t,r,i){return ce(e,"number","sheetId"),ce(t,"number","startColumn"),ce(r,"number","numberOfColumns"),ce(i,"number","targetColumn"),this._crudOperations.moveColumns(e,t,r,i),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!Ui(e))throw new xt("SimpleCellRange","source");const t=new Le(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!Ui(e))throw new xt("SimpleCellRange","source");const t=new Le(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!Hn(e))throw new xt("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!Ui(e))throw new xt("SimpleCellRange","source");return new Le(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellValue(i)))}getRangeFormulas(e){if(!Ui(e))throw new xt("SimpleCellRange","source");return new Le(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellFormula(i)))}getRangeSerialized(e){if(!Ui(e))throw new xt("SimpleCellRange","source");return new Le(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellSerialized(i)))}getFillRangeData(e,t,r=!1){if(!Ui(e))throw new xt("SimpleCellRange","source");if(!Ui(t))throw new xt("SimpleCellRange","target");const i=new Le(e.start,e.end),s=new Le(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),s.arrayOfAddressesInRange().map(o=>o.map(a=>{const l=((a.row-(r?t:e).start.row)%i.height()+i.height())%i.height()+e.start.row,u=((a.col-(r?t:e).start.col)%i.width()+i.width())%i.width()+e.start.col;return this._serialization.getCellSerialized({row:l,col:u,sheet:i.sheet},a)}))}isItPossibleToAddSheet(e){ce(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}addSheet(e){e!==void 0&&ce(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(Xo.SheetAdded,t),t}isItPossibleToRemoveSheet(e){ce(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}removeSheet(e){ce(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Xo.SheetRemoved,t,r),r}isItPossibleToClearSheet(e){ce(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}clearSheet(e){return ce(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){ce(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch{return!1}}setSheetContent(e,t){return ce(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return ce(e,"string","cellAddress"),ce(t,"number","sheetId"),IN(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return ce(e,"string","cellRange"),ce(t,"number","sheetId"),lme(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t){if(!Hn(e))throw new xt("SimpleCellAddress","cellAddress");return ce(t,"number","sheetId"),Gy(this.sheetMapping.fetchDisplayName,e,t)}simpleCellRangeToString(e,t){if(!Ui(e))throw new xt("SimpleCellRange","cellRange");return ce(t,"number","sheetId"),ume(this.sheetMapping.fetchDisplayName,e,t)}getCellDependents(e){let t;if(Hn(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(Ui(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new xt("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if(Hn(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(Ui(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new xt("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return ce(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return ce(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return ce(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!Hn(e))throw new xt("SimpleCellAddress","cellAddress");const t=this.dependencyGraph.getCell(e);return Mwe(t,e)}doesCellHaveSimpleValue(e){if(!Hn(e))throw new xt("SimpleCellAddress","cellAddress");return this.getCellType(e)===Ii.VALUE}doesCellHaveFormula(e){if(!Hn(e))throw new xt("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===Ii.FORMULA||t===Ii.ARRAYFORMULA}isCellEmpty(e){if(!Hn(e))throw new xt("SimpleCellAddress","cellAddress");return this.getCellType(e)===Ii.EMPTY}isCellPartOfArray(e){if(!Hn(e))throw new xt("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===Ii.ARRAY||t===Ii.ARRAYFORMULA}getCellValueType(e){if(!Hn(e))throw new xt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return sC(t)}getCellValueDetailedType(e){if(!Hn(e))throw new xt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return _we(t)}getCellValueFormat(e){if(!Hn(e))throw new xt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return xwe(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){ce(e,"number","sheetId"),ce(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch{return!1}}renameSheet(e,t){ce(e,"number","sheetId"),ce(t,"string","newName");const r=this._crudOperations.renameSheet(e,t);r!==void 0&&this._emitter.emit(Xo.SheetRenamed,r,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(Xo.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Xo.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,r){ce(e,"string","expressionName"),r!==void 0&&ce(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,r),!0}catch{return!1}}addNamedExpression(e,t,r,i){ce(e,"string","expressionName"),r!==void 0&&ce(r,"number","scope"),this._crudOperations.addNamedExpression(e,t,r,i);const s=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Xo.NamedExpressionAdded,e,s),s}getNamedExpressionValue(e,t){ce(e,"string","expressionName"),t!==void 0&&ce(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);if(r)return this._serialization.getCellValue(r.address)}getNamedExpressionFormula(e,t){ce(e,"string","expressionName"),t!==void 0&&ce(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);if(r!==void 0)return this._serialization.getCellFormula(r.address)}getNamedExpression(e,t){ce(e,"string","expressionName"),t!==void 0&&ce(t,"number","scope");const r=this._namedExpressions.namedExpressionForScope(e,t);if(r===void 0)return;const i=this._serialization.getCellFormula(r.address);return{name:e,scope:t,expression:i,options:r.options}}isItPossibleToChangeNamedExpression(e,t,r){ce(e,"string","expressionName"),r!==void 0&&ce(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,r),!0}catch{return!1}}changeNamedExpression(e,t,r,i){return ce(e,"string","expressionName"),r!==void 0&&ce(r,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,r,t,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){ce(e,"string","expressionName"),t!==void 0&&ce(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch{return!1}}removeNamedExpression(e,t){ce(e,"string","expressionName"),t!==void 0&&ce(t,"number","scope");const r=this._crudOperations.removeNamedExpression(e,t);if(r){const i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Xo.NamedExpressionRemoved,r.displayName,i),i}else return[]}listNamedExpressions(e){return e!==void 0&&ce(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){ce(e,"string","formulaString");const{ast:t,address:r}=this.extractTemporaryFormula(e);if(t===void 0)throw new Fv;return this._unparser.unparse(t,r)}calculateFormula(e,t){ce(e,"string","formulaString"),ce(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:r,address:i,dependencies:s}=this.extractTemporaryFormula(e,t);if(r===void 0)throw new Fv;const o=this.evaluator.runAndForget(r,i,s);return this._exporter.exportScalarOrRange(o)}getNamedExpressionsFromFormula(e){ce(e,"string","formulaString");const{ast:t,dependencies:r}=this.extractTemporaryFormula(e);if(t===void 0)throw new Fv;const i=r.filter(o=>o instanceof rl).map(o=>o.name);return[...new Set(i)]}validateFormula(e){ce(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return t!==void 0}getRegisteredFunctionNames(){return Tr.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return ce(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return ce(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return ce(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return ce(e,"number","val"),Od(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){Cye(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new lj}extractTemporaryFormula(e,t=1){const r=this._cellContentParser.parse(e),i={sheet:t,col:0,row:0};if(!(r instanceof yn.Formula))return{address:i,dependencies:[]};const{ast:s,errors:o,dependencies:a}=this._parser.parse(r.formula,i);return o.length>0?{address:i,dependencies:[]}:{ast:s,address:i,dependencies:a}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),r=this._config.mergeConfig({language:e.language}),i=this._serialization.withNewConfig(r,this._namedExpressions).getAllSheetsSerialized(),s=this._serialization.getAllNamedExpressionsSerialized(),o=ev.rebuildWithConfig(t,i,s,this._stats);this._config=o.config,this._stats=o.stats,this._dependencyGraph=o.dependencyGraph,this._columnSearch=o.columnSearch,this._parser=o.parser,this._unparser=o.unparser,this._cellContentParser=o.cellContentParser,this._evaluator=o.evaluator,this._lazilyTransformingAstService=o.lazilyTransformingAstService,this._crudOperations=o.crudOperations,this._exporter=o.exporter,this._namedExpressions=o.namedExpressions,this._serialization=o.serialization,this._functionRegistry=o.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const r=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(Xo.ValuesUpdated,r),r}}}Tr.version="2.7.1";Tr.buildDate="18/07/2024 11:23:17";Tr.releaseDate="18/07/2024";Tr.languages={};Tr.registeredLanguages=new Map;const ek=new WeakMap;class _r{constructor(e={},t=!0){const{accentSensitive:r,binarySearchThreshold:i,caseSensitive:s,caseFirst:o,chooseAddressMappingPolicy:a,context:l,currencySymbol:u,dateFormats:h,decimalSeparator:c,evaluateNullToZero:d,functionArgSeparator:f,functionPlugins:m,ignorePunctuation:p,leapYear1900:v,localeLang:y,language:C,ignoreWhiteSpace:R,licenseKey:A,matchWholeCell:I,arrayColumnSeparator:H,arrayRowSeparator:k,maxRows:W,maxColumns:z,nullYear:G,nullDate:q,parseDateTime:J,precisionEpsilon:re,precisionRounding:ie,stringifyDateTime:ae,stringifyDuration:Ke,smartRounding:xe,timeFormats:Se,thousandSeparator:ve,useArrayArithmetic:He,useStats:w,undoLimit:S,useColumnIndex:b,useRegularExpressions:x,useWildcards:L}=e;t&&_r.warnDeprecatedOptions(e),this.useArrayArithmetic=Ut(He,"boolean","useArrayArithmetic"),this.accentSensitive=Ut(r,"boolean","accentSensitive"),this.caseSensitive=Ut(s,"boolean","caseSensitive"),this.caseFirst=Ut(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=Ut(p,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=a??_r.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...Kw(h,Array.isArray,"array","dateFormats")],this.timeFormats=[...Kw(Se,Array.isArray,"array","timeFormats")],this.functionArgSeparator=Ut(f,"string","functionArgSeparator"),this.decimalSeparator=Ut(c,[".",","],"decimalSeparator"),this.language=Ut(C,"string","language"),this.ignoreWhiteSpace=Ut(R,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=Ut(A,"string","licenseKey"),this.thousandSeparator=Ut(ve,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=Ut(H,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=Ut(k,[";","|"],"arrayRowSeparator"),this.localeLang=Ut(y,"string","localeLang"),this.functionPlugins=[...m??_r.defaultConfig.functionPlugins],this.smartRounding=Ut(xe,"boolean","smartRounding"),this.evaluateNullToZero=Ut(d,"boolean","evaluateNullToZero"),this.nullYear=Ut(G,"number","nullYear"),Yc(this.nullYear,"nullYear",0),Kwe(this.nullYear,"nullYear",100),this.precisionRounding=Ut(ie,"number","precisionRounding"),Yc(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=Ut(re,"number","precisionEpsilon"),Yc(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=Ut(b,"boolean","useColumnIndex"),this.useStats=Ut(w,"boolean","useStats"),this.binarySearchThreshold=i??_r.defaultConfig.binarySearchThreshold,this.parseDateTime=Ut(J,"function","parseDateTime"),this.stringifyDateTime=Ut(ae,"function","stringifyDateTime"),this.stringifyDuration=Ut(Ke,"function","stringifyDuration"),this.translationPackage=Tr.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=Kw(q,Xm,"IDate","nullDate"),this.leapYear1900=Ut(v,"boolean","leapYear1900"),this.undoLimit=Ut(S,"number","undoLimit"),this.useRegularExpressions=Ut(x,"boolean","useRegularExpressions"),this.useWildcards=Ut(L,"boolean","useWildcards"),this.matchWholeCell=Ut(I,"boolean","matchWholeCell"),Yc(this.undoLimit,"undoLimit",0),this.maxRows=Ut(W,"number","maxRows"),Yc(this.maxRows,"maxRows",1),this.maxColumns=Ut(z,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(u),Yc(this.maxColumns,"maxColumns",1),this.context=l,ek.set(this,{licenseKeyValidityState:Cve(this.licenseKey)}),kF({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),kF({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...Kw(e,Array.isArray,"array","currencySymbol")];return t.forEach(r=>{if(typeof r!="string")throw new xt("string[]","currencySymbol");if(r==="")throw new dwe("currencySymbol")}),t}get licenseKeyValidityState(){return ek.get(this).licenseKeyValidityState}getConfig(){return Lj(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return _r.warnDeprecatedOptions(e),new _r(t,!1)}static warnDeprecatedOptions(e){_r.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,t,r,i){e!==void 0&&console.warn(i===void 0?`${t} option is deprecated since ${r}`:`${t} option is deprecated since ${r}, please use ${i}`)}}_r.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new lve,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:Jwe,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:pve,stringifyDuration:gve,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function Lj(n){var e;const t={};for(const r in _r.defaultConfig){const i=(e=n[r])!==null&&e!==void 0?e:_r.defaultConfig[r];Array.isArray(i)?t[r]=[...i]:t[r]=i}return t}function Tye(){return Lj({})}const JN={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};var $l;(function(n){n[n.FullyAbsolute=1]="FullyAbsolute",n[n.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",n[n.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",n[n.FullyRelative=4]="FullyRelative"})($l||($l={}));class Dj extends st{verifyAddressArguments(e,t,r,i){if(i){if(e<1||t<1)return new E(N.VALUE,_.LessThanOne)}else if($l.FullyAbsolute==r){if(e<1||t<1)return new E(N.VALUE,_.LessThanOne)}else if($l.RowAbsoluteColRelative==r){if(e<1)return new E(N.VALUE,_.LessThanOne)}else if($l.RowRelativeColAbsolute==r&&t<1)return new E(N.VALUE,_.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(r,i,s,o,a)=>{const l=this.verifyAddressArguments(r,i,s,o);if(l!==void 0)return l;const u=dS(i-1);let h="";a!=null&&(h=`${a}!`);const c=i==0?"C":`C[${i}]`,d=r==0?"R":`R[${r}]`;return $l.FullyRelative==s?o?`${h}${u}${r}`:`${h}${d}${c}`:$l.RowRelativeColAbsolute==s?o?`${h}$${u}${r}`:`${h}${d}C${i}`:$l.RowAbsoluteColRelative==s?o?`${h}${u}$${r}`:`${h}R${r}${c}`:o?`${h}$${u}$${r}`:`${h}R${r}C${i}`})}}Dj.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:g.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:g.STRING,optionalArg:!0}]}};class Hj extends st{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),r=>r)}arrayformulaArraySize(e,t){if(e.args.length!==1)return Ct.error();const r=this.metadata("ARRAYFORMULA");return e.args.map(s=>{var o;return this.arraySizeForAst(s,new ca(t.formulaAddress,t.arraysFlag||((o=r?.arrayFunction)!==null&&o!==void 0?o:!1)))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(r,i,s)=>{i=Math.min(i,r.height()),s=Math.min(s,r.width());const o=r.data,a=[];for(let l=0;l<i;l++)a.push(o[l].slice(0,s));return Me.onlyValues(a)})}arrayconstrainArraySize(e,t){if(e.args.length!==3)return Ct.error();const r=this.metadata("ARRAY_CONSTRAIN"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new ca(t.formulaAddress,t.arraysFlag||((l=r?.arrayFunction)!==null&&l!==void 0?l:!1)))});let{height:s,width:o}=i[0];return e.args[1].type===M.NUMBER&&(s=Math.min(s,e.args[1].value)),e.args[2].type===M.NUMBER&&(o=Math.min(o,e.args[2].value)),s<1||o<1||!Number.isInteger(s)||!Number.isInteger(o)?Ct.error():new Ct(o,s)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(r,...i)=>{for(const a of i)if(r.width()!==a.width()||r.height()!==a.height())return new E(N.NA,_.EqualLength);if(r.width()>1&&r.height()>1)return new E(N.NA,_.WrongDimension);const s=r.data,o=[];for(let a=0;a<r.height();a++){const l=[];for(let u=0;u<r.width();u++){let h=!0;for(const c of i)if(mj(c.data[a][u])!==!0){h=!1;break}h&&l.push(s[a][u])}l.length>0&&o.push(l)}return o.length>0?Me.onlyValues(o):new E(N.NA,_.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return Ct.error();const r=this.metadata("FILTER"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new ca(t.formulaAddress,t.arraysFlag||((l=r?.arrayFunction)!==null&&l!==void 0?l:!1)))}),s=Math.max(...i.map(a=>a.width)),o=Math.max(...i.map(a=>a.height));return new Ct(s,o)}}Hj.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:g.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:g.RANGE},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}],repeatLastArgs:1}};class Fj extends st{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}Fj.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:g.NUMBER}]}};const Aye=0xffffffffffff,tk=-53,nk=53;class kj extends st{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),Vj)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),Uj)}}kj.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:tk,maxValue:nk}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:tk,maxValue:nk}]}};function Vj(n,e){return e<0?Uj(n,-e):Bj(n*Math.pow(2,e))}function Uj(n,e){return e<0?Vj(n,-e):Bj(Math.floor(n/Math.pow(2,e)))}function Bj(n){return n>Aye?new E(N.NUM,_.BitshiftLong):n}class Wj extends st{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(r,i)=>r&i)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(r,i)=>r|i)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(r,i)=>r^i)}}Wj.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:0}]}};class $j extends st{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(r,i,s)=>r?i:s)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...r)=>{for(let i=0;i<r.length;i+=2)if(r[i])return r[i+1];return new E(N.NA,_.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...r)=>r.filter(i=>i!==void 0).every(i=>!!i))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...r)=>r.filter(i=>i!==void 0).some(i=>i))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),r=>!r)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...r)=>{let i=0;return r.filter(s=>s!==void 0).forEach(s=>{s&&i++}),i%2===1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(r,...i)=>{const s=i.length;let o=0;for(;o+1<s;o+=2)if(!(i[o]instanceof E)&&this.arithmeticHelper.eq(r,i[o]))return i[o+1];return o<s?i[o]:new E(N.NA,_.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(r,i)=>r instanceof E?i:r)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(r,i)=>r instanceof E&&r.type===N.NA?i:r)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(r,...i)=>r>i.length?new E(N.NUM,_.Selector):i[r-1])}}$j.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:g.BOOLEAN},{argumentType:g.SCALAR,passSubtype:!0},{argumentType:g.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:g.BOOLEAN},{argumentType:g.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:g.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:g.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:g.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:g.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:g.NOERROR},{argumentType:g.SCALAR,passSubtype:!0},{argumentType:g.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:g.SCALAR,passSubtype:!0},{argumentType:g.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:g.SCALAR,passSubtype:!0},{argumentType:g.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:g.INTEGER,minValue:1},{argumentType:g.SCALAR,passSubtype:!0}],repeatLastArgs:1}};class Gj extends st{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),r=>r<1||r>=256?new E(N.VALUE,_.CharacterCodeBounds):String.fromCharCode(Math.trunc(r)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),r=>r<1||r>=1114112?new E(N.VALUE,_.CharacterCodeBounds):String.fromCodePoint(Math.trunc(r)))}}Gj.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:g.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:g.NUMBER}]}};class jj extends st{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),r=>r.length===0?new E(N.VALUE,_.EmptyString):r.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),r=>{var i;return(i=r.codePointAt(0))!==null&&i!==void 0?i:new E(N.VALUE,_.EmptyString)})}}jj.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:g.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:g.STRING}]}};class zj extends st{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...r)=>{let i=0;return r.forEach(s=>{s===ft&&i++}),i})}}zj.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:g.SCALAR}],repeatLastArgs:1,expandRanges:!0}};class Yj extends st{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...r)=>{const i=new Set,s=new Set;for(const o of r)o instanceof E?s.add(o.type):o!==""&&i.add(o);return i.size+s.size})}}Yj.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:g.SCALAR}],repeatLastArgs:1,expandRanges:!0}};class Kj extends st{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),s=this.dateTimeHelper.relativeNumberToAbsoluteNumber(i),o=s+((4-s)%7+7)%7,a=Math.floor((t-1)/7)-Math.floor((o-1)/7)+1;return a===0?this.isoweeknumCore(e-7)+1:a},this.days360Core=(e,t,r)=>{const i=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.numberToSimpleDate(t);let o,a;return r?(o=$F(i),a=$F(s)):[o,a]=this.dateTimeHelper.toBasisUS(i,s),360*(a.year-o.year)+30*(a.month-o.month)+a.day-o.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(r,i,s)=>{const o=Math.trunc(s);let a=Math.trunc(i),l=Math.trunc(r);l<this.dateTimeHelper.getEpochYearZero()&&(l+=this.dateTimeHelper.getEpochYearZero());const u=Math.floor((a-1)/12);l+=u,a-=u*12;const h={year:l,month:a,day:1};if(this.dateTimeHelper.isValidDate(h)){let c=this.dateTimeHelper.dateToNumber(h)+(o-1);return c=this.dateTimeHelper.getWithinBounds(c),c===void 0?new E(N.NUM,_.DateBounds):c}return new E(N.VALUE,_.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(r,i,s)=>{const o=_d({hours:Math.trunc(r),minutes:Math.trunc(i),seconds:Math.trunc(s)});return o<0?new E(N.NUM,_.NegativeTime):o%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(r,i)=>{const s=this.dateTimeHelper.numberToSimpleDate(r);let o=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(WF(s,i)));return o=this.dateTimeHelper.getWithinBounds(o),o===void 0?new E(N.NUM,_.DateBounds):o})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),r=>this.dateTimeHelper.numberToSimpleDate(r).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(r,i)=>Math.trunc(r)-Math.trunc(i))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),r=>this.dateTimeHelper.numberToSimpleDate(r).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),r=>this.dateTimeHelper.numberToSimpleDate(r).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),r=>Od(pA(r)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),r=>Od(pA(r)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),r=>Od(pA(r)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(r,i)=>dve(r,i,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(r,i)=>{const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r));if(i===3)return(s-1)%7;const o=sk.get(i);return o===void 0?new E(N.NUM,_.BadMode):(s-o)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(r,i)=>{const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r)),o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.dateToNumber({year:o.year,month:1,day:1}),l=this.dateTimeHelper.relativeNumberToAbsoluteNumber(a);if(i===21)return this.isoweeknumCore(r);const u=sk.get(i);return u===void 0?new E(N.NUM,_.BadMode):Math.floor((s-u)/7)-Math.floor((l-u)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),r=>{const{dateTime:i}=this.dateTimeHelper.parseDateTimeFromConfigFormats(r);return i===void 0?new E(N.VALUE,_.IncorrectDateTime):Xm(i)?(Sj(i)?Math.trunc(_d(i)):0)+this.dateTimeHelper.dateToNumber(i):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),r=>{const i=this.dateTimeHelper.dateStringToDateNumber(r);return i===void 0?new E(N.VALUE,_.IncorrectDateTime):pe(i)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{const r=new Date(Date.now());return _d({hours:r.getHours(),minutes:r.getMinutes(),seconds:r.getSeconds()})+this.dateTimeHelper.dateToNumber({year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{const r=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(r,i)=>{const s=this.dateTimeHelper.numberToSimpleDate(r),o=ove(WF(s,i));let a=this.dateTimeHelper.dateToNumber(o);return a=this.dateTimeHelper.getWithinBounds(a),a===void 0?new E(N.NUM,_.DateBounds):a})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(r,i,s)=>{if(r>i)return new E(N.NUM,_.StartEndDate);if(s==="D")return Math.floor(i)-Math.floor(r);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);switch(s){case"M":return(a.year-o.year)*12+(a.month-o.month)-(a.day<o.day?1:0);case"YM":return(12+(a.month-o.month)-(a.day<o.day?1:0))%12;case"Y":return a.month>o.month||a.month===o.month&&a.day>=o.day?a.year-o.year:a.year-o.year-1;case"MD":if(a.day>=o.day)return a.day-o.day;{const l=a.month===1?12:a.month-1,u=a.month===1?a.year-1:a.year;return this.dateTimeHelper.daysInMonth(u,l)+a.day-o.day}case"YD":return a.month>o.month||a.month===o.month&&a.day>=o.day?Math.floor(i)-this.dateTimeHelper.dateToNumber({year:a.year,month:o.month,day:o.day}):Math.floor(i)-Math.floor(r)-365*(a.year-o.year-1)-this.dateTimeHelper.leapYearsCount(a.year-1)+this.dateTimeHelper.leapYearsCount(o.year);default:return new E(N.NUM,_.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(r,i,s)=>{switch(r=Math.trunc(r),i=Math.trunc(i),r>i&&([r,i]=[i,r]),s){case 0:return this.days360Core(r,i,!1)/360;case 1:return(i-r)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(r),this.dateTimeHelper.numberToSimpleDate(i));case 2:return(i-r)/360;case 3:return(i-r)/365;case 4:return this.days360Core(r,i,!0)/360}throw new Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),r=>{r=Math.trunc(r);const i=r%60;r=Math.trunc(r/60);const s=r%60;r=Math.trunc(r/60);const o=r%24;r=Math.trunc(r/24);const a=r%30;r=Math.trunc(r/30);const l=r%12,u=Math.trunc(r/12);return"P"+(u>0?`${u}Y`:"")+(l>0?`${l}M`:"")+(a>0?`${a}D`:"")+"T"+(o>0?`${o}H`:"")+(s>0?`${s}M`:"")+(i>0?`${i}S`:"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(r,i,s)=>this.networkdayscore(r,i,1,s))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(r,i,s,o)=>this.networkdayscore(r,i,s,o))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(r,i,s)=>this.workdaycore(r,i,1,s))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(r,i,s,o)=>this.workdaycore(r,i,s,o))}networkdayscore(e,t,r,i){e=Math.trunc(e),t=Math.trunc(t);let s=1;e>t&&([e,t]=[t,e],s=-1);const o=ik(r);if(o instanceof E)return o;const a=this.simpleRangeToFilteredHolidays(o,i);return a instanceof E?a:s*this.countWorkdays(e,t,o,a)}workdaycore(e,t,r,i){e=Math.trunc(e),t=Math.trunc(t);const s=ik(r);if(s instanceof E)return s;const o=this.simpleRangeToFilteredHolidays(s,i);if(o instanceof E)return o;if(t>0){let a=1;for(;this.countWorkdays(e+1,e+a,s,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e+1,e+u,s,o)<t?l=u:a=u}return e+a}else if(t<0){t*=-1;let a=1;for(;this.countWorkdays(e-a,e-1,s,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e-u,e-1,s,o)<t?l=u:a=u}return e-a}else return e}countWorkdays(e,t,r,i){const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let a=0;for(let l=0;l<7;l++)r.charAt(l)==="0"&&(a+=Math.floor((s+6-l)/7),a-=Math.floor((o-1+6-l)/7));return a-=rk(t+1,i)-rk(e,i),a}simpleRangeToFilteredHolidays(e,t){var r;const i=(r=t?.valuesFromTopLeftCorner())!==null&&r!==void 0?r:[];for(const o of i)if(o instanceof E)return o;const s=[];for(const o of i)if(o!==ft)if(Lt(o))s.push(Math.trunc(pe(o)));else return new E(N.VALUE,_.WrongType);return[...new Set(s)].sort((o,a)=>o-a).filter(o=>{const l=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(o)-1)%7;return e.charAt(l)==="0"})}}Kj.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:g.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:g.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:g.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:g.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:g.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:g.NUMBER},{argumentType:g.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:g.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:g.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:g.STRING}],returnNumberType:Ie.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:g.STRING}],returnNumberType:Ie.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:Ie.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:Ie.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:g.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NOERROR,defaultValue:1},{argumentType:g.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER},{argumentType:g.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER},{argumentType:g.NOERROR,defaultValue:1},{argumentType:g.RANGE,optionalArg:!0}]}};function rk(n,e){if(e.length===0||n<=e[0])return 0;if(e[e.length-1]<n)return e.length;let t=0,r=e.length-1;for(;t+1<r;){const i=Math.floor((r+t)/2);e[i]>=n?r=i:t=i}return r}function ik(n){var e;return typeof n!="number"&&typeof n!="string"?new E(N.VALUE,_.WrongType):typeof n=="string"?n.length!==7||!/^(0|1)*$/.test(n)||n==="1111111"?new E(N.NUM,_.WeekendString):n:(e=Nye.get(n))!==null&&e!==void 0?e:new E(N.NUM,_.BadMode)}const sk=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),Nye=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);class qj extends st{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),r=>r*(180/Math.PI))}}qj.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:g.NUMBER}]}};class Xj extends st{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(r,i)=>r===i?1:0)}}Xj.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0}]}};class Qj extends st{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}Qj.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:g.NUMBER}]}};class Zj extends st{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),r_)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),e0)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),ok)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),t0)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(r,i,s,o,a,l)=>{if(o>a)return new E(N.NUM,_.EndStartPeriod);let u=0;for(let h=o;h<=a;h++)u+=e0(r,h,i,s,0,l);return u})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(r,i,s,o,a,l)=>{if(o>a)return new E(N.NUM,_.EndStartPeriod);let u=0;for(let h=o;h<=a;h++)u+=ok(r,h,i,s,0,l);return u})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(r,i,s,o,a)=>{if(a===12&&o>s||o>s+1)return new E(N.NUM,_.PeriodLong);if(i>=r)return 0;const l=Math.round((1-Math.pow(i/r,1/s))*1e3)/1e3,u=r*l*a/12;if(o===1)return u;let h=u;for(let c=0;c<o-2;c++)h+=(r-h)*l;return o===s+1?(r-h)*l*(12-a)/12:(r-h)*l})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(r,i,s,o,a)=>{if(o>s)return new E(N.NUM);let l=a/s,u;l>=1?(l=1,o===1?u=r:u=0):u=r*Math.pow(1-l,o-1);const h=r*Math.pow(1-l,o);return Math.max(u-Math.max(i,h),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(r,i)=>{if(i<1)return new E(N.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(r)+(r-Math.trunc(r))*10/i})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(r,i)=>{if(i<1)return new E(N.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(r)+(r-Math.trunc(r))*i/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(r,i)=>(i=Math.trunc(i),Math.pow(1+r/i,i)-1))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(r,i,s,o)=>s===0?new E(N.DIV_BY_ZERO):o*r*(i/s-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(r,i)=>(i=Math.trunc(i),(Math.pow(r+1,1/i)-1)*i))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(r,i,s,o,a)=>r===0?i===0?new E(N.DIV_BY_ZERO):(-s-o)/i:(a&&(i*=1+r),Math.log((i-o*r)/(s*r+i))/Math.log(1+r)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(r,i,s,o,a,l)=>{if(l<=-1)return new E(N.VALUE);const u=1e-7,h=50;let c=l;a=a?1:0;for(let d=0;d<h;d++){if(c<=-1)return new E(N.NUM);let f;if(Math.abs(c)<u)f=s*(1+r*c)+i*(1+c*a)*r+o;else{const p=Math.pow(1+c,r);f=s*p+i*(1/c+a)*(p-1)+o}if(Math.abs(f)<u)return c;let m;if(Math.abs(c)<u)m=s*r+i*a*r;else{const p=Math.pow(1+c,r),v=r*Math.pow(1+c,r-1);m=s*v+i*(1/c+a)*v+i*(-1/(c*c))*(p-1)}c-=f/m}return new E(N.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(r,i,s,o,a)=>(a=a?1:0,r===-1?i===0?new E(N.NUM):new E(N.DIV_BY_ZERO):r===0?-s*i-o:((1-Math.pow(1+r,i))*s*(1+r*a)/r-o)/Math.pow(1+r,i)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(r,i,s)=>i===0||s<0&&i>0||s>0&&i<0?new E(N.NUM):Math.pow(s/i,1/r)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(r,i,s)=>s===0?new E(N.DIV_BY_ZERO):(r-i)/s)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(r,i,s,o)=>o>s?new E(N.NUM):(r-i)*(s-o+1)*2/(s*(s+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new E(N.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new E(N.NUM);const l=360-s*(i-r);return l===0?0:l<0?new E(N.NUM):365*s/l})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new E(N.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new E(N.NUM);const l=360-s*(i-r);return l===0?0:l<0?new E(N.NUM):100*(1-s*(i-r)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new E(N.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);return a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day)?new E(N.NUM):(100-s)*360/(s*(i-r))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(r,i)=>{const s=i.valuesFromTopLeftCorner();for(const o of s)if(o instanceof E)return o;for(const o of s)if(Lt(o))r*=1+pe(o);else if(o!==ft)return new E(N.VALUE,_.NumberExpected);return r})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(r,...i)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(i);return s instanceof E?s:yA(r,s)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(r,i,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());if(o instanceof E)return o;let a=!1,l=!1;const u=[],h=[];for(const m of o)m>0?(a=!0,u.push(m),h.push(0)):m<0?(l=!0,h.push(m),u.push(0)):(h.push(0),u.push(0));if(!a||!l)return new E(N.DIV_BY_ZERO);const c=o.length,d=yA(s,u);if(d instanceof E)return d;const f=yA(i,h);return f instanceof E?f:Math.pow(-d*Math.pow(1+s,c)/f/(1+i),1/(c-1))-1})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(r,i,s)=>(Math.log(s)-Math.log(i))/Math.log(1+r))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(r,i,s)=>{const o=i.valuesFromTopLeftCorner();for(const d of o)if(typeof d!="number")return new E(N.VALUE,_.NumberExpected);const a=o,l=s.valuesFromTopLeftCorner();for(const d of l)if(typeof d!="number")return new E(N.VALUE,_.NumberExpected);const u=l;if(u.length!==a.length)return new E(N.NUM,_.EqualLength);const h=u.length;let c=0;if(u[0]<0)return new E(N.NUM,_.ValueSmall);for(let d=0;d<h;d++){if(u[d]=Math.floor(u[d]),u[d]<u[0])return new E(N.NUM,_.ValueSmall);c+=a[d]/Math.pow(1+r,(u[d]-u[0])/365)}return c})}}Zj.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Ie.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Ie.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Ie.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Ie.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:0,maxValue:1}],returnNumberType:Ie.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:0,maxValue:1}],returnNumberType:Ie.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:Ie.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.INTEGER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:Ie.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1}],returnNumberType:Ie.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1}],returnNumberType:Ie.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Ie.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:.1}],returnNumberType:Ie.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0}],returnNumberType:Ie.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0}],returnNumberType:Ie.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0}],returnNumberType:Ie.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0}],returnNumberType:Ie.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:g.NUMBER},{argumentType:g.RANGE}],returnNumberType:Ie.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:g.NUMBER},{argumentType:g.ANY}],repeatLastArgs:1,returnNumberType:Ie.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:g.NUMBER,greaterThan:-1},{argumentType:g.RANGE},{argumentType:g.RANGE}]}};function r_(n,e,t,r,i){if(n===0)return(-t-r)/e;{const s=Math.pow(1+n,e);return(r*n+t*n*s)*(i?1/(1+n):1)/(1-s)}}function e0(n,e,t,r,i,s){const o=r_(n,t,r,i,s);return e===1?n*(s?0:-r):n*(s?t0(n,e-2,o,r,s)-o:t0(n,e-1,o,r,s))}function t0(n,e,t,r,i){if(n===0)return-r-t*e;{const s=Math.pow(1+n,e);return t*(i?1+n:1)*(1-s)/n-r*s}}function ok(n,e,t,r,i,s){return r_(n,t,r,i,s)-e0(n,e,t,r,i,s)}function yA(n,e){let t=0;for(let r=e.length-1;r>=0;r--){if(t+=e[r],n===-1){if(t===0)continue;return new E(N.DIV_BY_ZERO)}t/=1+n}return t}class Jj extends st{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new E(N.NA,_.WrongArgNumber),r=>{var i;return(i=this.serialization.getCellFormula(r))!==null&&i!==void 0?i:new E(N.NA,_.Formula)})}}Jj.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:g.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};class e2 extends st{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),(r,i)=>(e.hyperlink=r,i??r))}}e2.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:g.STRING},{argumentType:g.STRING,optionalArg:!0}]}};class t2 extends st{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),r=>/^[01]{1,10}$/.test(r))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),r=>r instanceof E&&r.type!==N.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),r=>r instanceof E)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new E(N.NA,_.WrongArgNumber),r=>this.dependencyGraph.addressMapping.getCell(r)instanceof Qi)}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),r=>r===ft)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),r=>r instanceof E&&r.type==N.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),Lt)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),r=>typeof r=="boolean")}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),r=>r instanceof E&&(r.type==N.REF||r.type==N.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),r=>typeof r=="string")}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),r=>typeof r!="string")}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,r=>r.col+1)}columns(e,t){if(e.args.length!==1)return new E(N.NA,_.WrongArgNumber);if(e.args.some(i=>i.type===M.EMPTY))return new E(N.NUM,_.EmptyArg);let r=e.args[0];for(;r.type===M.PARENTHESIS;)r=r.expression;if(r.type===M.CELL_RANGE||r.type===M.COLUMN_RANGE)return r.end.col-r.start.col+1;if(r.type===M.CELL_REFERENCE)return 1;if(r.type===M.ROW_RANGE)return this.config.maxColumns;{const i=this.evaluateAst(r,t);return i instanceof Me?i.width():i instanceof E?i:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,r=>r.row+1)}rows(e,t){if(e.args.length!==1)return new E(N.NA,_.WrongArgNumber);if(e.args.some(i=>i.type===M.EMPTY))return new E(N.NUM,_.EmptyArg);let r=e.args[0];for(;r.type===M.PARENTHESIS;)r=r.expression;if(r.type===M.CELL_RANGE||r.type===M.ROW_RANGE)return r.end.row-r.start.row+1;if(r.type===M.CELL_REFERENCE)return 1;if(r.type===M.COLUMN_RANGE)return this.config.maxRows;{const i=this.evaluateAst(r,t);return i instanceof Me?i.height():i instanceof E?i:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(r,i,s)=>{var o,a,l,u,h,c;return s<1||i<1?new E(N.VALUE,_.LessThanOne):s>r.width()||i>r.height()?new E(N.NUM,_.ValueLarge):(c=(l=(a=(o=r?.data)===null||o===void 0?void 0:o[i-1])===null||a===void 0?void 0:a[s-1])!==null&&l!==void 0?l:(h=(u=r?.data)===null||u===void 0?void 0:u[0])===null||h===void 0?void 0:h[0])!==null&&c!==void 0?c:new E(N.VALUE,_.CellRangeExpected)})}na(e,t){return new E(N.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,r=>r.sheet+1,r=>{const i=this.dependencyGraph.sheetMapping.get(r);return i!==void 0?i+1:new E(N.NA,_.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new E(N.VALUE,_.CellRefExpected))}}t2.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:g.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:g.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:g.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:g.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:g.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:g.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:g.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:g.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:g.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:g.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:g.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:g.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:g.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:g.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:g.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:g.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:g.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};class n2 extends st{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),r=>r%2===0)}}n2.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:g.NUMBER}]}};class r2 extends st{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),r=>r%2===1)}}r2.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:g.NUMBER}]}};class i2 extends st{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(r,i)=>Math.log(r)/Math.log(i))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}i2.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:g.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:g.NUMBER}]}};const n0=parseFloat(Math.PI.toFixed(14));class s2 extends st{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>n0)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),r=>Math.sqrt(n0*r))}}s2.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:g.NUMBER,minValue:0}]}};function ak(n,e){return new Ct(e.width,n.height)}function CA(n,e,t){return new Ct(1+(n.width-e)/t,1+(n.height-e)/t)}class o2 extends st{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(r,i)=>{if(!r.hasOnlyNumbers()||!i.hasOnlyNumbers())return new E(N.VALUE,_.NumberRange);if(i.height()!==r.width())return new E(N.VALUE,_.ArrayDimensions);const s=ak(r.size,i.size),o=this.createKernel(function(a,l,u){let h=0;for(let c=0;c<u;++c)h+=a[this.thread.y][c]*l[c][this.thread.x];return h},s)(r.rawNumbers(),i.rawNumbers(),r.width());return Me.onlyNumbers(o)})}mmultArraySize(e,t){if(e.args.length!==2)return Ct.error();const r=this.metadata("MMULT"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new ca(t.formulaAddress,t.arraysFlag||((l=r?.arrayFunction)!==null&&l!==void 0?l:!1)))}),[s,o]=i;return ak(s,o)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(r,i,s=i)=>{if(!r.hasOnlyNumbers())return new E(N.VALUE,_.NumberRange);const o=CA(r.size,i,s),a=this.createKernel(function(l,u,h){const c=this.thread.x*h,d=this.thread.y*h;let f=l[d][c];for(let m=0;m<u;m++)for(let p=0;p<u;p++)f=Math.max(f,l[d+m][c+p]);return f},o)(r.rawNumbers(),i,s);return Me.onlyNumbers(a)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(r,i,s=i)=>{if(!r.hasOnlyNumbers())return new E(N.VALUE,_.NumberRange);const o=CA(r.size,i,s),a=this.createKernel(function(l,u,h){const c=this.thread.x*h,d=this.thread.y*h;let f=l[d][c];for(let R=0;R<u;R++)for(let A=0;A<u;A++)f=Math.max(f,l[d+R][c+A]);let m=l[d][c];for(let R=0;R<u;R++)for(let A=0;A<u;A++)m=Math.min(m,l[d+R][c+A]);const p=u*u;let v=m,y=f,C=42;for(let R=0;R<32;R++){const A=(v+y)/2;let I=0;for(let H=0;H<u;H++)for(let k=0;k<u;k++)l[d+H][c+k]>A&&I++;if(u%2===0)if(I===p/2){C=A;break}else I>p/2?v=A:y=A;else if(I===(p-1)/2){C=A;break}else I>(p-1)/2?v=A:y=A}return C},o)(r.rawNumbers(),i,s);return Me.onlyNumbers(a)})}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return Ct.error();const r=this.metadata("MAXPOOL"),s=e.args.map(u=>{var h;return this.arraySizeForAst(u,new ca(t.formulaAddress,t.arraysFlag||((h=r?.arrayFunction)!==null&&h!==void 0?h:!1)))})[0],o=e.args[1];let a;o.type===M.NUMBER?a=o.value:a=1;let l=a;if(e.args.length===3){const u=e.args[2];u.type===M.NUMBER?l=u.value:l=1}return a>s.width||a>s.height||l>a||(s.width-a)%l!==0||(s.height-a)%l!==0?Ct.error():CA(s,a,l)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),r=>{const i=r.rawData(),s=r.size,o=[];for(let a=0;a<s.width;++a){o[a]=[];for(let l=0;l<s.height;++l)o[a][l]=i[l][a]}return Me.onlyValues(o)})}transposeArraySize(e,t){if(e.args.length!==1)return Ct.error();const r=this.metadata("TRANSPOSE"),i=e.args.map(o=>{var a;return this.arraySizeForAst(o,new ca(t.formulaAddress,t.arraysFlag||((a=r?.arrayFunction)!==null&&a!==void 0?a:!1)))}),[s]=i;return new Ct(s.height,s.width)}createKernel(e,t){return function(...r){const i=[];for(let s=0;s<t.height;++s){i.push([]);for(let o=0;o<t.width;++o)i[s][o]=e.apply({thread:{x:o,y:s}},r)}return i}}}o2.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:g.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};class a2 extends st{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);return i instanceof E?i:i.length===0?new E(N.NUM,_.OneValue):(i.sort((s,o)=>s-o),i.length%2===0?(i[i.length/2-1]+i[i.length/2])/2:i[Math.floor(i.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());return s instanceof E?s:(s.sort((o,a)=>o-a),i=Math.trunc(i),i>s.length?new E(N.NUM,_.ValueLarge):s[s.length-i])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());return s instanceof E?s:(s.sort((o,a)=>o-a),i=Math.trunc(i),i>s.length?new E(N.NUM,_.ValueLarge):s[i-1])})}}a2.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER,minValue:1}]}};class l2 extends st{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(r,i)=>i===0?new E(N.DIV_BY_ZERO):r%i)}}l2.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]}};function nv(n){return Lt(n)&&!Number.isFinite(pe(n))?0:n}class so{constructor(e,t,r){this.sumsq=e,this.sum=t,this.count=r}static single(e){return new so(e*e,e,1)}compose(e){return new so(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}varSValue(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}so.empty=new so(0,0,0);class i_ extends st{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,r=>Math.pow(pe(r),2),qc)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){const r=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(i,s)=>Math.max(i,s),pe,rv);return nv(r)}min(e,t){return this.doMin(e.args,t)}mina(e,t){const r=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(i,s)=>Math.min(i,s),pe,rv);return nv(r)}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var r;const i=this.reduce(e.args,t,so.empty,"_AGGREGATE_A",(s,o)=>s.compose(o),s=>so.single(pe(s)),rv);return i instanceof E?i:(r=i.averageValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var r;const i=this.reduceAggregateA(e.args,t);return i instanceof E?i:(r=i.varSValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}varpa(e,t){var r;const i=this.reduceAggregateA(e.args,t);return i instanceof E?i:(r=i.varPValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof E)return r;{const i=r.varSValue();return i===void 0?new E(N.DIV_BY_ZERO):Math.sqrt(i)}}stdevpa(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof E)return r;{const i=r.varPValue();return i===void 0?new E(N.DIV_BY_ZERO):Math.sqrt(i)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new E(N.NA,_.WrongArgNumber);const r=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:g.NUMBER},t),i=e.args.slice(1);switch(r){case 1:case 101:return this.doAverage(i,t);case 2:case 102:return this.doCount(i,t);case 3:case 103:return this.doCounta(i,t);case 4:case 104:return this.doMax(i,t);case 5:case 105:return this.doMin(i,t);case 6:case 106:return this.doProduct(i,t);case 7:case 107:return this.doStdevS(i,t);case 8:case 108:return this.doStdevP(i,t);case 9:case 109:return this.doSum(i,t);case 10:case 110:return this.doVarS(i,t);case 11:case 111:return this.doVarP(i,t);default:return new E(N.VALUE,_.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,so.empty,"_AGGREGATE",(r,i)=>r.compose(i),r=>so.single(pe(r)),qc)}reduceAggregateA(e,t){return this.reduce(e,t,so.empty,"_AGGREGATE_A",(r,i)=>r.compose(i),r=>so.single(pe(r)),rv)}doAverage(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof E?i:(r=i.averageValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}doVarS(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof E?i:(r=i.varSValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}doVarP(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof E?i:(r=i.varPValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}doStdevS(e,t){const r=this.reduceAggregate(e,t);if(r instanceof E)return r;{const i=r.varSValue();return i===void 0?new E(N.DIV_BY_ZERO):Math.sqrt(i)}}doStdevP(e,t){const r=this.reduceAggregate(e,t);if(r instanceof E)return r;{const i=r.varPValue();return i===void 0?new E(N.DIV_BY_ZERO):Math.sqrt(i)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",(r,i)=>r+i,pe,r=>Lt(r)?1:0)}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(r,i)=>r+i,pe,r=>r===ft?0:1)}doMax(e,t){const r=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(i,s)=>Math.max(i,s),pe,qc);return nv(r)}doMin(e,t){const r=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(i,s)=>Math.min(i,s),pe,qc);return nv(r)}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,pe,qc)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(r,i)=>r*i,pe,qc)}reduce(e,t,r,i,s,o,a){return e.length<1?new E(N.NA,_.WrongArgNumber):e.reduce((l,u)=>{if(l instanceof E)return l;if(u.type===M.CELL_RANGE||u.type===M.COLUMN_RANGE||u.type===M.ROW_RANGE){const c=this.evaluateRange(u,t,r,i,s,o,a);return c instanceof E?c:s(c,l)}let h;if(h=this.evaluateAst(u,t),h instanceof Me)return Array.from(h.valuesFromTopLeftCorner()).map(a).filter(d=>d!==void 0).map(d=>d instanceof E?d:o(d)).reduce((d,f)=>d instanceof E?d:f instanceof E?f:s(d,f),l);if(u.type===M.CELL_REFERENCE){if(h=a(h),h===void 0)return l}else if(h=this.coerceScalarToNumberOrError(h),h=a(h),h===void 0)return l;return h instanceof E?h:s(l,o(h))},r)}evaluateRange(e,t,r,i,s,o,a){let l;try{l=Le.fromAst(e,t.formulaAddress)}catch(c){if(c instanceof bg)return new E(N.REF,_.RangeManySheets);throw c}const u=this.dependencyGraph.getRange(l.start,l.end);if(u===void 0)throw new Error("Range does not exists in graph");let h=u.getFunctionValue(i);return h===void 0&&(h=this.getRangeValues(i,l,u,o,a).reduce((d,f)=>d instanceof E?d:f instanceof E?f:s(d,f),r),u.setFunctionValue(i,h)),h}getRangeValues(e,t,r,i,s){const o=[],{smallerRangeVertex:a,restRange:l}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let u;if(a!==void 0&&this.dependencyGraph.existsEdge(a,r)){const h=a.getFunctionValue(e);if(h!==void 0)o.push(h);else for(const c of a.range.addresses(this.dependencyGraph)){const d=s(this.dependencyGraph.getScalarValue(c));d instanceof E?o.push(d):d!==void 0&&o.push(i(d))}u=l}else u=t;for(const h of u.addresses(this.dependencyGraph)){const c=s(this.dependencyGraph.getScalarValue(h));c instanceof E?o.push(c):c!==void 0&&o.push(i(c))}return o}}i_.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:g.NUMBER},{argumentType:g.ANY}],repeatLastArgs:1}};i_.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function qc(n){if(Lt(n)||n instanceof E)return n}function rv(n){return typeof n=="boolean"?GN(n):Lt(n)||n instanceof E?n:typeof n=="string"?0:void 0}class u2 extends st{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}u2.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]}};class h2 extends st{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),r=>r*(Math.PI/180))}}h2.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:g.NUMBER}]}};const wr=10,c2=255,lk=2,uk=36,Iye="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class d2 extends st{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(r,i)=>ka(r,2,i))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(r,i)=>ka(r,8,i))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(r,i)=>ka(r,16,i))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),r=>{const i=$o(r,2,wr);return i===void 0?new E(N.NUM,_.NotBinary):Va(i,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(r,i)=>{const s=$o(r,2,wr);return s===void 0?new E(N.NUM,_.NotBinary):ka(Va(s,2),8,i)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(r,i)=>{const s=$o(r,2,wr);return s===void 0?new E(N.NUM,_.NotBinary):ka(Va(s,2),16,i)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),r=>{const i=$o(r,8,wr);return i===void 0?new E(N.NUM,_.NotOctal):Va(i,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(r,i)=>{const s=$o(r,8,wr);return s===void 0?new E(N.NUM,_.NotOctal):ka(Va(s,8),2,i)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(r,i)=>{const s=$o(r,8,wr);return s===void 0?new E(N.NUM,_.NotOctal):ka(Va(s,8),16,i)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),r=>{const i=$o(r,16,wr);return i===void 0?new E(N.NUM,_.NotHex):Va(i,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(r,i)=>{const s=$o(r,16,wr);return s===void 0?new E(N.NUM,_.NotHex):ka(Va(s,16),2,i)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(r,i)=>{const s=$o(r,16,wr);return s===void 0?new E(N.NUM,_.NotHex):ka(Va(s,16),8,i)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),Oye)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(r,i)=>{const s=$o(r,i,c2);return s===void 0?new E(N.NUM,_.NotHex):parseInt(s,i)})}}d2.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:g.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:wr}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:wr}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:g.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:wr}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:wr}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:g.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:wr}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:wr}]},DECIMAL:{method:"decimal",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,minValue:lk,maxValue:uk}]},BASE:{method:"base",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:lk,maxValue:uk},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:c2}]}};function $o(n,e,t){const r=Iye.substr(0,e),i=new RegExp(`^[${r}]+$`);if(!(n.length>t||!i.test(n)))return n}function ka(n,e,t){if(n>Mye(e))return new E(N.NUM,_.ValueBaseLarge);if(n<f2(e))return new E(N.NUM,_.ValueBaseSmall);const r=m2(n,e);return t===void 0||n<0?r:r.length>t?new E(N.NUM,_.ValueBaseLong):Mi(r,t)}function f2(n){return-Math.pow(n,wr)/2}function Mye(n){return-f2(n)-1}function Oye(n,e,t){const r=m2(n,e);return t!==void 0&&t>r.length?Mi(r,t):r}function m2(n,e){const t=n<0?Math.pow(e,wr):0;return(n+t).toString(e).toUpperCase()}function Va(n,e){const t=parseInt(n,e),r=Math.pow(e,wr);return t>=r/2?t-r:t}class g2 extends st{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(r,i)=>i<r?new E(N.NUM,_.WrongOrder):(r=Math.ceil(r),i=Math.floor(i)+1,r===i&&(i+=1),r+Math.floor(Math.random()*(i-r))))}}g2.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}],isVolatile:!0}};function hk(n){const e=Math.ceil(n);return e%2===1?e:e+1}function ck(n){const e=Math.ceil(n);return e%2===0?e:e+1}class s_ extends st{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.ceil(-r*s)/s:Math.ceil(r*s)/s})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.floor(-r*s)/s:Math.floor(r*s)/s})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.round(-r*s)/s:Math.round(r*s)/s})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),r=>r<0?-Math.floor(-r):Math.floor(r))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),r=>r<0?-ck(-r):ck(r))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),r=>r<0?-hk(-r):hk(r))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(r,i,s)=>i===0||r===0?0:(i=Math.abs(i),s===1&&r<0&&(i=-i),Math.ceil(r/i)*i))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(r,i)=>r===0?0:i===0?new E(N.DIV_BY_ZERO):r>0&&i<0?new E(N.NUM,_.DistinctSigns):Math.ceil(r/i)*i)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(r,i)=>i===0||r===0?0:(i=Math.abs(i),Math.ceil(r/i)*i))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(r,i,s)=>i===0||r===0?0:(i=Math.abs(i),s===1&&r<0&&(i*=-1),Math.floor(r/i)*i))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(r,i)=>r===0?0:i===0?new E(N.DIV_BY_ZERO):r>0&&i<0?new E(N.NUM,_.DistinctSigns):Math.floor(r/i)*i)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(r,i)=>i===0||r===0?0:(i=Math.abs(i),Math.floor(r/i)*i))}}s_.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:g.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:g.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:g.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1},{argumentType:g.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1},{argumentType:g.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1}]}};s_.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};class p2 extends st{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}p2.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:g.NUMBER}]}};function*_ye(){}function xye(n){const e=n[Symbol.iterator](),{done:t,value:r}=e.next();return t?{rest:_ye()}:{value:r,rest:e}}const Pye=(n,e,t)=>{if(t.end.row>t.start.row){const r=Ce(t.end.sheet,t.end.col,t.end.row-1),i=n.getRange(t.start,r);if(i!==void 0)return{smallerRangeVertex:i,restValuesRange:t.withStart(Ce(t.start.sheet,t.start.col,t.end.row)),restConditionRanges:e.map(s=>s.withStart(Ce(s.start.sheet,s.start.col,s.end.row)))}}return{restValuesRange:t,restConditionRanges:e}};class Lye{constructor(e,t,r,i,s){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=r,this.composeFunction=i,this.mapFunction=s,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const s of t)if(!s.conditionRange.sameDimensionsAs(e))return new E(N.VALUE,_.EqualLength);const r=this.tryToGetRangeVertexForRangeValue(e),i=t.map(s=>this.tryToGetRangeVertexForRangeValue(s.conditionRange));if(r&&i.every(s=>s!==void 0)){const s=t.map(l=>l.criterionPackage.raw).join(","),o=this.findAlreadyComputedValueInCache(r,this.cacheKey(t),s);if(o!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),o;const a=this.buildNewCriterionCache(this.cacheKey(t),t.map(l=>l.conditionRange.range),e.range);return a.has(s)||a.set(s,[this.evaluateRangeValue(e,t),t.map(l=>l.criterionPackage.lambda)]),r.setCriterionFunctionValues(this.cacheKey(t),a),i.forEach(l=>{l!==void 0&&l.addDependentCacheRange(r)}),a.get(s)[0]}else return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;if(t!==void 0)return this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const r of e)t=this.composeFunction(t,r);return t}findAlreadyComputedValueInCache(e,t,r){return e.getCriterionFunctionValue(t,r)}evaluateRangeValue(e,t){const r=t.map(a=>a.criterionPackage.lambda),i=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),s=t.map(a=>a.conditionRange.iterateValuesFromTopLeftCorner()),o=fk(r,s,i);return this.reduceFunction(o)}buildNewCriterionCache(e,t,r){const i=this.dependencyGraph.getRange(r.start,r.end),{smallerRangeVertex:s,restConditionRanges:o,restValuesRange:a}=Pye(this.dependencyGraph,t,r);let l;s!==void 0&&this.dependencyGraph.existsEdge(s,i)?l=s.getCriterionFunctionValues(e):l=new Map;const u=new Map;return l.forEach(([h,c],d)=>{const f=fk(c,o.map(p=>dk(this.dependencyGraph,p)),Array.from(dk(this.dependencyGraph,a)).map(this.mapFunction)[Symbol.iterator]()),m=this.composeFunction(h,this.reduceFunction(f));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),u.set(d,[m,c])}),u}}class Dye{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*dk(n,e){for(const t of e.addresses(n))yield pe(n.getScalarValue(t))}function*fk(n,e,t){for(const r of t){const i=e.map(o=>xye(o));if(!i.every(o=>Object.prototype.hasOwnProperty.call(o,"value")))return;const s=i.map(o=>pe(o.value));Hye(s,n).every(([o,a])=>a(o))&&(yield r),e=i.map(o=>o.rest)}}function Hye(n,e){const t=[];for(let r=0;r<Math.min(n.length,e.length);r++)t.push([n[r],e[r]]);return t}class cu{constructor(e,t){this.sum=e,this.count=t}static single(e){return new cu(e,1)}compose(e){return new cu(this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}}cu.empty=new cu(0,0);function Fye(n){return e=>{const t=e.map(r=>`${r.conditionRange.range.sheet},${r.conditionRange.range.start.col},${r.conditionRange.range.start.row}`);return[n,...t].join(",")}}function mk(n){return Lt(n)&&!Number.isFinite(pe(n))?0:n}function iv(n){if(n instanceof E)return n;if(Lt(n))return pe(n)}class w2 extends st{sumif(e,t){const r="SUMIF",i=(s,o,a)=>this.computeConditionalAggregationFunction(a??s,[s,o],r,0,(l,u)=>this.arithmeticHelper.nonstrictadd(l,u),iv);return this.runFunction(e.args,t,this.metadata(r),i)}sumifs(e,t){const r="SUMIFS",i=(s,...o)=>this.computeConditionalAggregationFunction(s,o,r,0,(a,l)=>this.arithmeticHelper.nonstrictadd(a,l),iv);return this.runFunction(e.args,t,this.metadata(r),i)}averageif(e,t){const r="AVERAGEIF",i=(s,o,a)=>{const l=this.computeConditionalAggregationFunction(a??s,[s,o],r,cu.empty,(u,h)=>u.compose(h),u=>Lt(u)?cu.single(pe(u)):cu.empty);return l instanceof E?l:l.averageValue()||new E(N.DIV_BY_ZERO)};return this.runFunction(e.args,t,this.metadata(r),i)}countif(e,t){const r="COUNTIF",i=(s,o)=>this.computeConditionalAggregationFunction(s,[s,o],r,0,(a,l)=>a+l,()=>1);return this.runFunction(e.args,t,this.metadata(r),i)}countifs(e,t){const r="COUNTIFS",i=(...s)=>this.computeConditionalAggregationFunction(s[0],s,r,0,(o,a)=>o+a,()=>1);return this.runFunction(e.args,t,this.metadata(r),i)}minifs(e,t){const r="MINIFS",i=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.min(o,a),s=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,r,Number.POSITIVE_INFINITY,i,iv);return mk(l)};return this.runFunction(e.args,t,this.metadata(r),s)}maxifs(e,t){const r="MAXIFS",i=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.max(o,a),s=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,r,Number.NEGATIVE_INFINITY,i,iv);return mk(l)};return this.runFunction(e.args,t,this.metadata(r),s)}computeConditionalAggregationFunction(e,t,r,i,s,o){const a=[];for(let l=0;l<t.length;l+=2){const u=t[l],h=this.interpreter.criterionBuilder.fromCellValue(t[l+1],this.arithmeticHelper);if(h===void 0)return new E(N.VALUE,_.BadCriterion);a.push(new Dye(u,h))}return new Lye(this.interpreter,Fye(r),i,s,o).compute(e,a)}}w2.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:g.RANGE},{argumentType:g.NOERROR},{argumentType:g.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:g.RANGE},{argumentType:g.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:g.RANGE},{argumentType:g.NOERROR},{argumentType:g.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE},{argumentType:g.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:g.RANGE},{argumentType:g.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE},{argumentType:g.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE},{argumentType:g.NOERROR}],repeatLastArgs:2}};class v2 extends st{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...r)=>{const i=r[0].width(),s=r[0].height();for(const l of r)if(l.width()!==i||l.height()!==s)return new E(N.VALUE,_.EqualLength);let o=0;const a=r.map(l=>l.iterateValuesFromTopLeftCorner());for(let l=0;l<i*s;l++){let u=1;for(const h of a){const c=h.next().value;if(c instanceof E)return c;const d=this.coerceScalarToNumberOrError(c);Lt(d)?u*=pe(d):u=0}o+=u}return o})}}v2.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:g.RANGE}],repeatLastArgs:1}};class y2 extends st{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...r)=>"".concat(...r))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(r,i)=>{const s=r.split(" ");return i>=s.length||i<0?new E(N.VALUE,_.IndexBounds):s[i]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),r=>r.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),r=>r.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),r=>r.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),r=>r.replace(new RegExp("\\p{L}+","gu"),i=>i.charAt(0).toUpperCase()+i.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),r=>r.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(r,i)=>r===i)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(r,i)=>i<0?new E(N.VALUE,_.NegativeCount):r.repeat(i))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(r,i)=>i<0?new E(N.VALUE,_.NegativeLength):i===0?"":r.slice(-i))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(r,i)=>i<0?new E(N.VALUE,_.NegativeLength):r.slice(0,i))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(r,i,s)=>i<1?new E(N.VALUE,_.LessThanOne):s<0?new E(N.VALUE,_.NegativeLength):r.substring(i-1,i+s-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(r,i,s,o)=>i<1?new E(N.VALUE,_.LessThanOne):s<0?new E(N.VALUE,_.NegativeLength):r.substring(0,i-1)+o+r.substring(i+s-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(r,i,s)=>{if(s<1||s>i.length)return new E(N.VALUE,_.LengthBounds);const o=r.toLowerCase(),a=i.substring(s-1).toLowerCase(),l=this.arithmeticHelper.requiresRegex(o)?this.arithmeticHelper.searchString(o,a):a.indexOf(o);return l>-1?l+s:new E(N.VALUE,_.PatternNotFound)})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(r,i,s,o)=>{const a=this.escapeRegExpSpecialCharacters(i),l=new RegExp(a,"g");if(o===void 0)return r.replace(l,s);if(o<1)return new E(N.VALUE,_.LessThanOne);let u,h=0;for(;(u=l.exec(r))!==null;)if(o===++h)return r.substring(0,u.index)+s+r.substring(l.lastIndex);return r})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(r,i,s)=>{if(s<1||s>i.length)return new E(N.VALUE,_.IndexBounds);const a=i.substring(s-1).indexOf(r)+s;return a>0?a:new E(N.VALUE,_.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),r=>r instanceof E||typeof r=="string"?r:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),r=>r.toUpperCase())}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}y2.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:g.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:g.STRING},{argumentType:g.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:g.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:g.STRING}]},MID:{method:"mid",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:g.STRING}]},T:{method:"t",parameters:[{argumentType:g.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:g.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:g.STRING}]},REPT:{method:"rept",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:g.STRING},{argumentType:g.STRING},{argumentType:g.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:g.STRING},{argumentType:g.STRING},{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:g.STRING},{argumentType:g.STRING},{argumentType:g.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:g.STRING}]}};class C2 extends st{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(r,i)=>r===0&&i===0?new E(N.DIV_BY_ZERO):Math.atan2(i,r))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),r=>r===0?new E(N.DIV_BY_ZERO):1/Math.tan(r))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),r=>r===0?n0/2:Math.atan(1/r))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),r=>1/Math.cos(r))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),r=>r===0?new E(N.DIV_BY_ZERO):1/Math.sin(r))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),r=>r===0?new E(N.DIV_BY_ZERO):1/Math.tanh(r))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),r=>r===0?new E(N.NUM,_.NonZero):Math.atanh(1/r))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),r=>1/Math.cosh(r))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),r=>r===0?new E(N.DIV_BY_ZERO):1/Math.sinh(r))}}C2.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:g.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:g.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:g.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:g.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:g.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:g.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:g.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:g.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:g.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:g.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:g.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:g.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:g.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:g.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:g.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:g.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:g.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:g.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:g.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:g.NUMBER}]}};class kye extends xj{constructor(e){super(e),this.dependencyGraph=e}find(e,t,r){return this.basicFind(e,t,"col",r)}}class S2 extends st{constructor(){super(...arguments),this.rowSearch=new kye(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(r,i,s,o)=>{const a=i.range;return a===void 0?new E(N.VALUE,_.WrongType):s<1?new E(N.VALUE,_.LessThanOne):s>a.width()?new E(N.REF,_.IndexLarge):this.doVlookup(gA(r),i,s-1,o)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(r,i,s,o)=>{const a=i.range;return a===void 0?new E(N.VALUE,_.WrongType):s<1?new E(N.VALUE,_.LessThanOne):s>a.height()?new E(N.REF,_.IndexLarge):this.doHlookup(gA(r),i,s-1,o)})}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(r,i,s)=>this.doMatch(gA(r),i,s))}searchInRange(e,t,r,i){if(!r&&typeof e=="string"&&this.arithmeticHelper.requiresRegex(e))return i.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t);{const s=r?{ordering:"asc"}:{ordering:"none",matchExactly:!0};return i.find(e,t,s)}}doVlookup(e,t,r,i){this.dependencyGraph.stats.start(tt.VLOOKUP);const s=t.range;let o;s===void 0?o=Me.onlyValues(t.data.map(u=>[u[0]])):o=Me.onlyRange(Le.spanFrom(s.start,1,s.height()),this.dependencyGraph);const a=this.searchInRange(e,o,i,this.columnSearch);if(this.dependencyGraph.stats.end(tt.VLOOKUP),a===-1)return new E(N.NA,_.ValueNotFound);let l;if(s===void 0)l=t.data[a][r];else{const u=Ce(s.sheet,s.start.col+r,s.start.row+a);l=this.dependencyGraph.getCellValue(u)}return l instanceof Me?new E(N.VALUE,_.WrongType):l}doHlookup(e,t,r,i){const s=t.range;let o;s===void 0?o=Me.onlyValues([t.data[0]]):o=Me.onlyRange(Le.spanFrom(s.start,s.width(),1),this.dependencyGraph);const a=this.searchInRange(e,o,i,this.rowSearch);if(a===-1)return new E(N.NA,_.ValueNotFound);let l;if(s===void 0)l=t.data[r][a];else{const u=Ce(s.sheet,s.start.col+a,s.start.row+r);l=this.dependencyGraph.getCellValue(u)}return l instanceof Me?new E(N.VALUE,_.WrongType):l}doMatch(e,t,r){if(![-1,0,1].includes(r))return new E(N.VALUE,_.BadMode);if(t.width()>1&&t.height()>1)return new E(N.NA);const i=t.width()===1?this.columnSearch:this.rowSearch,s=r===0?{ordering:"none",matchExactly:!0}:{ordering:r===-1?"desc":"asc"},o=i.find(e,t,s);return o===-1?new E(N.NA,_.ValueNotFound):o+1}}S2.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:g.NOERROR},{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:g.NOERROR},{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:g.NOERROR},{argumentType:g.RANGE},{argumentType:g.NUMBER,defaultValue:1}]}};class R2 extends st{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(r,i)=>(r=Math.trunc(r),i===!1?i=4:i===!0&&(i=0),i=pe(this.coerceScalarToNumberOrError(i)),i instanceof E?i:(i=Math.trunc(i),i<0?new E(N.VALUE,_.ValueSmall):i>4?new E(N.VALUE,_.ValueLarge):Vye(r,i))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),r=>{r=r.trim().toUpperCase();let i=!1;if(r.startsWith("-")&&(r=r.slice(1),i=!0,r===""))return new E(N.VALUE,_.InvalidRoman);const s={input:r,acc:0};return Go(s,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),Go(s,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),Go(s,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),Go(s,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),Go(s,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),Go(s,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),Go(s,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),Go(s,{token:"IX",val:9}),Go(s,{token:"V",val:5},{token:"IV",val:4}),Go(s,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),s.input!==""?new E(N.VALUE,_.InvalidRoman):i?-s.acc:s.acc})}}R2.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:g.NUMBER,minValue:1,lessThan:4e3},{argumentType:g.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:g.STRING}]}};function Go(n,...e){for(const t of e)if(n.input.startsWith(t.token)){n.input=n.input.slice(t.token.length),n.acc+=t.val;break}}function Vye(n,e){const t={val:n%1e3,acc:"M".repeat(Math.floor(n/1e3))};return e===4&&(Wn(t,"IM",999,1e3),Wn(t,"ID",499,500)),e>=3&&(Wn(t,"VM",995,1e3),Wn(t,"VD",495,500)),e>=2&&(Wn(t,"XM",990,1e3),Wn(t,"XD",490,500)),e>=1&&(Wn(t,"LM",950,1e3),Wn(t,"LD",450,500)),Wn(t,"CM",900,1e3),Wn(t,"CD",400,500),Wn(t,"D",500,900),t.acc+="C".repeat(Math.floor(t.val/100)),t.val%=100,e>=2&&(Wn(t,"IC",99,100),Wn(t,"IL",49,50)),e>=1&&(Wn(t,"VC",95,100),Wn(t,"VL",45,50)),Wn(t,"XC",90,100),Wn(t,"XL",40,50),Wn(t,"L",50,90),t.acc+="X".repeat(Math.floor(t.val/10)),t.val%=10,Wn(t,"IX",9,10),Wn(t,"IV",4,5),Wn(t,"V",5,9),t.acc+="I".repeat(t.val),t.acc}function Wn(n,e,t,r){n.val>=t&&n.val<r&&(n.val-=t,n.acc+=e)}class E2 extends st{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}E2.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:g.STRING,passSubtype:!0},{argumentType:g.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:g.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:g.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:g.NUMBER,passSubtype:!0}]}};var ht=Math;function Sn(n,e){for(var t=0,r=0;t<n.length;++t)r=e*r+n[t];return r}function b2(n,e,t,r,i){if(e===0)return t;if(e===1)return r;for(var s=2/n,o=r,a=1;a<e;++a)o=r*a*s+i*t,t=r,r=o;return o}function T2(n,e,t,r,i){return function(o,a){if(r){if(o===0)return r==1?-1/0:1/0;if(o<0)return NaN}if(a===0)return n(o);if(a===1)return e(o);if(a<0)return NaN;a|=0;var l=n(o),u=e(o);return b2(o,a,l,u,i)}}var r0=(function(){var n=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),t=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function s(c){var d=0,f=0,m=0,p=c*c;if(c<8)f=Sn(e,p),m=Sn(t,p),d=f/m;else{var v=c-.785398164;p=64/p,f=Sn(r,p),m=Sn(i,p),d=ht.sqrt(n/c)*(ht.cos(v)*f-ht.sin(v)*m*8/c)}return d}var o=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),a=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function h(c){var d=0,f=0,m=0,p=c*c,v=ht.abs(c)-2.356194491;return Math.abs(c)<8?(f=c*Sn(o,p),m=Sn(a,p),d=f/m):(p=64/p,f=Sn(l,p),m=Sn(u,p),d=ht.sqrt(n/ht.abs(c))*(ht.cos(v)*f-ht.sin(v)*m*8/ht.abs(c)),c<0&&(d=-d)),d}return function c(d,f){if(f=Math.round(f),!isFinite(d))return isNaN(d)?d:0;if(f<0)return(f%2?-1:1)*c(d,-f);if(d<0)return(f%2?-1:1)*c(-d,f);if(f===0)return s(d);if(f===1)return h(d);if(d===0)return 0;var m=0;if(d>f)m=b2(d,f,s(d),h(d),-1);else{for(var p=2*ht.floor((f+ht.floor(ht.sqrt(40*f)))/2),v=!1,y=0,C=0,R=1,A=0,I=2/d,H=p;H>0;H--)A=H*I*R-y,y=R,R=A,ht.abs(R)>1e10&&(R*=1e-10,y*=1e-10,m*=1e-10,C*=1e-10),v&&(C+=R),v=!v,H==f&&(m=y);C=2*C-R,m/=C}return m}})(),Uye=(function(){var n=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),t=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function s(c){var d=0,f=0,m=0,p=c*c,v=c-.785398164;return c<8?(f=Sn(e,p),m=Sn(t,p),d=f/m+n*r0(c,0)*ht.log(c)):(p=64/p,f=Sn(r,p),m=Sn(i,p),d=ht.sqrt(n/c)*(ht.sin(v)*f+ht.cos(v)*m*8/c)),d}var o=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),a=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function h(c){var d=0,f=0,m=0,p=c*c,v=c-2.356194491;return c<8?(f=c*Sn(o,p),m=Sn(a,p),d=f/m+n*(r0(c,1)*ht.log(c)-1/c)):(p=64/p,f=Sn(l,p),m=Sn(u,p),d=ht.sqrt(n/c)*(ht.sin(v)*f+ht.cos(v)*m*8/c)),d}return T2(s,h,"BESSELY",1,-1)})(),i0=(function(){var n=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function t(o){return o<=3.75?Sn(n,o*o/(3.75*3.75)):ht.exp(ht.abs(o))/ht.sqrt(ht.abs(o))*Sn(e,3.75/ht.abs(o))}var r=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),i=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function s(o){return o<3.75?o*Sn(r,o*o/(3.75*3.75)):(o<0?-1:1)*ht.exp(ht.abs(o))/ht.sqrt(ht.abs(o))*Sn(i,3.75/ht.abs(o))}return function o(a,l){if(l=Math.round(l),l===0)return t(a);if(l===1)return s(a);if(l<0)return NaN;if(ht.abs(a)===0)return 0;if(a==1/0)return 1/0;var u=0,h,c=2/ht.abs(a),d=0,f=1,m=0,p=2*ht.round((l+ht.round(ht.sqrt(40*l)))/2);for(h=p;h>0;h--)m=h*c*f+d,d=f,f=m,ht.abs(f)>1e10&&(f*=1e-10,d*=1e-10,u*=1e-10),h==l&&(u=d);return u*=o(a,0)/f,a<0&&l%2?-u:u}})(),Bye=(function(){var n=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function t(o){return o<=2?-ht.log(o/2)*i0(o,0)+Sn(n,o*o/4):ht.exp(-o)/ht.sqrt(o)*Sn(e,2/o)}var r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),i=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function s(o){return o<=2?ht.log(o/2)*i0(o,1)+1/o*Sn(r,o*o/4):ht.exp(-o)/ht.sqrt(o)*Sn(i,2/o)}return T2(t,s,"BESSELK",2,1)})();function xd(n){const e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let t=e.length-1,r=!1,i=0,s=0,o,a,l,u;if(n===0)return 0;for(n<0&&(n=-n,r=!0),o=2/(2+n),a=4*o-2;t>0;t--)l=i,i=a*i-s+e[t],s=l;return u=o*Math.exp(-n*n+.5*(e[0]+a*i)-s),r?u-1:1-u}function A2(n){return 1-xd(n)}function N2(n){let e=0,t,r,i,s;if(n>=2)return-100;if(n<=0)return 100;for(s=n<1?n:2-n,i=Math.sqrt(-2*Math.log(s/2)),t=-.70711*((2.30753+i*.27061)/(1+i*(.99229+i*.04481))-i);e<2;e++)r=A2(t)-s,t+=r/(1.1283791670955126*Math.exp(-t*t)-t*r);return n<1?t:-t}const gk={pdf:(n,e)=>n<0?0:e*Math.exp(-e*n),cdf:(n,e)=>n<0?0:1-Math.exp(-e*n)};function Zm(n){const e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],t=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let r=!1,i=0,s=0,o=0,a=n,l,u,h,c;if(n>171.6243769536076)return 1/0;if(a<=0)if(c=a%1,c)r=(a&1?-1:1)*Math.PI/Math.sin(Math.PI*c),a=1-a;else return 1/0;for(h=a,a<1?u=a++:u=(a-=i=(a|0)-1)-1,l=0;l<8;++l)o=(o+e[l])*u,s=s*u+t[l];if(c=o/s+1,h<a)c/=h;else if(h>a)for(l=0;l<i;++l)c*=a,a++;return r&&(c=r/c),c}const SA={pdf:function(e,t,r){return e<0?0:e===0&&t===1?1/r:Math.exp((t-1)*Math.log(e)-e/r-Er(t)-t*Math.log(r))},cdf:function(e,t,r){return e<0?0:o_(t,e/r)},inv:function(n,e,t){return I2(n,e)*t}};function Er(n){let e=0;const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let r=1.000000000190015,i,s,o;for(o=(s=i=n)+5.5,o-=(i+.5)*Math.log(o);e<6;e++)r+=t[e]/++s;return Math.log(2.5066282746310007*r/i)-o}function o_(n,e){const t=Er(n);let r=n,i=1/n,s=i,o=e+1-n,a=1/1e-30,l=1/o,u=l,h=1;const c=-~(Math.log(n>=1?n:1/n)*8.5+n*.4+17);let d;if(e<0||n<=0)return NaN;if(e<n+1){for(;h<=c;h++)i+=s*=e/++r;return i*Math.exp(-e+n*Math.log(e)-t)}for(;h<=c;h++)d=-h*(h-n),o+=2,l=d*l+o,a=o+d/a,l=1/l,u*=l*a;return 1-u*Math.exp(-e+n*Math.log(e)-t)}function I2(n,e){let t=0;const r=e-1,i=1e-8,s=Er(e);let o,a,l,u,h,c,d;if(n>=1)return Math.max(100,e+100*Math.sqrt(e));if(n<=0)return 0;for(e>1?(c=Math.log(r),d=Math.exp(r*(c-1)-s),h=n<.5?n:1-n,l=Math.sqrt(-2*Math.log(h)),o=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,n<.5&&(o=-o),o=Math.max(.001,e*Math.pow(1-1/(9*e)-o/(3*Math.sqrt(e)),3))):(l=1-e*(.253+e*.12),n<l?o=Math.pow(n/l,1/e):o=1-Math.log(1-(n-l)/(1-l)));t<12;t++){if(o<=0)return 0;if(a=o_(e,o)-n,e>1?l=d*Math.exp(-(o-r)+r*(Math.log(o)-c)):l=Math.exp(-o+r*Math.log(o)-s),u=a/l,o-=l=u/(1-.5*Math.min(1,u*((e-1)/o-1))),o<=0&&(o=.5*(o+l)),Math.abs(l)<i*o)break}return o}const to={pdf:function(e,t,r){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(e-t,2)/(2*r*r))},cdf:function(e,t,r){return .5*(1+xd((e-t)/Math.sqrt(2*r*r)))},inv:function(n,e,t){return-1.4142135623730951*t*N2(2*n)+e}},RA={pdf:function(e,t,r){return e>1||e<0?0:t==1&&r==1?1:t<512&&r<512?Math.pow(e,t-1)*Math.pow(1-e,r-1)/a_(t,r):Math.exp((t-1)*Math.log(e)+(r-1)*Math.log(1-e)-M2(t,r))},cdf:function(e,t,r){return e>1||e<0?+(e>1):bS(e,t,r)},inv:function(e,t,r){return l_(e,t,r)}};function a_(n,e){if(!(n<=0||e<=0))return n+e>170?Math.exp(M2(n,e)):Zm(n)*Zm(e)/Zm(n+e)}function M2(n,e){return Er(n)+Er(e)-Er(n+e)}function l_(n,e,t){var r=1e-8,i=e-1,s=t-1,o=0,a,l,u,h,c,d,f,m,p,v,y;if(n<=0)return 0;if(n>=1)return 1;for(e>=1&&t>=1?(u=n<.5?n:1-n,h=Math.sqrt(-2*Math.log(u)),f=(2.30753+h*.27061)/(1+h*(.99229+h*.04481))-h,n<.5&&(f=-f),m=(f*f-3)/6,p=2/(1/(2*e-1)+1/(2*t-1)),v=f*Math.sqrt(m+p)/p-(1/(2*t-1)-1/(2*e-1))*(m+5/6-2/(3*p)),f=e/(e+t*Math.exp(2*v))):(a=Math.log(e/(e+t)),l=Math.log(t/(e+t)),h=Math.exp(e*a)/e,c=Math.exp(t*l)/t,v=h+c,n<h/v?f=Math.pow(e*v*n,1/e):f=1-Math.pow(t*v*(1-n),1/t)),y=-Er(e)-Er(t)+Er(e+t);o<10;o++){if(f===0||f===1)return f;if(d=bS(f,e,t)-n,h=Math.exp(i*Math.log(f)+s*Math.log(1-f)+y),c=d/h,f-=h=c/(1-.5*Math.min(1,c*(i/f-s/(1-f)))),f<=0&&(f=.5*(f+h)),f>=1&&(f=.5*(f+h+1)),Math.abs(h)<r*f&&o>0)break}return f}function bS(n,e,t){var r=n===0||n===1?0:Math.exp(Er(e+t)-Er(e)-Er(t)+e*Math.log(n)+t*Math.log(1-n));return n<0||n>1?!1:n<(e+1)/(e+t+2)?r*pk(n,e,t)/e:1-r*pk(1-n,t,e)/t}function pk(n,e,t){var r=1e-30,i=1,s=e+t,o=e+1,a=e-1,l=1,u=1-s*n/o,h,c,d,f;for(Math.abs(u)<r&&(u=r),u=1/u,f=u;i<=100&&(h=2*i,c=i*(t-i)*n/((a+h)*(e+h)),u=1+c*u,Math.abs(u)<r&&(u=r),l=1+c/l,Math.abs(l)<r&&(l=r),u=1/u,f*=u*l,c=-(e+i)*(s+i)*n/((e+h)*(o+h)),u=1+c*u,Math.abs(u)<r&&(u=r),l=1+c/l,Math.abs(l)<r&&(l=r),u=1/u,d=u*l,f*=d,!(Math.abs(d-1)<3e-7));i++);return f}const Bv={pdf:function(n,e,t){return t===0||t===1?e*t===n?1:0:O2(e,n)*Math.pow(t,n)*Math.pow(1-t,e-n)},cdf:function(n,e,t){var r,i=1e-10;if(n<0)return 0;if(n>=e)return 1;if(t<0||t>1||e<=0)return NaN;n=Math.floor(n);var s=t,o=n+1,a=e-n,l=o+a,u=Math.exp(Er(l)-Er(a)-Er(o)+o*Math.log(s)+a*Math.log(1-s));return s<(o+1)/(l+2)?r=u*wk(s,o,a,i):r=1-u*wk(1-s,a,o,i),Math.round((1-r)*(1/i))/(1/i)}};function wk(n,e,t,r){for(var i=0,s=1,o=1,a=1,l=0,u=0,h;Math.abs((o-u)/o)>r;)u=o,h=-(e+l)*(e+t+l)*n/(e+2*l)/(e+2*l+1),i=o+h*i,s=a+h*s,l=l+1,h=l*(t-l)*n/(e+2*l-1)/(e+2*l),o=i+h*o,a=s+h*a,i=i/a,s=s/a,o=o/a,a=1;return o/e}function O2(n,e){return n>170||e>170?Math.exp(Wye(n,e)):Wv(n)/Wv(e)/Wv(n-e)}function Wye(n,e){return EA(n)-EA(e)-EA(n-e)}function EA(n){return n<0?NaN:Er(n+1)}function Wv(n){return n<0?NaN:Zm(n+1)}const ad={pdf:function(e,t){return e<0?0:e===0&&t===2?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-Er(t/2))},cdf:function(e,t){return e<0?0:o_(t/2,e/2)},inv:function(n,e){return 2*I2(n,.5*e)}},ld={pdf:function(e,t,r){var i,s,o;return e<0?0:t<=2?e===0&&t<2?1/0:e===0&&t===2?1:1/a_(t/2,r/2)*Math.pow(t/r,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/r*e,-(t+r)/2):(i=t*e/(r+e*t),s=r/(r+e*t),o=t*s/2,o*Bv.pdf((t-2)/2,(t+r-2)/2,i))},cdf:function(e,t,r){return e<0?0:bS(t*e/(t*e+r),t/2,r/2)},inv:function(e,t,r){return r/(t*(1/l_(e,t/2,r/2)-1))}},vk={pdf:function(e,t,r){return e<0||t<0||r<0?0:r/t*Math.pow(e/t,r-1)*Math.exp(-Math.pow(e/t,r))},cdf:function(e,t,r){return e<0?0:1-Math.exp(-Math.pow(e/t,r))}},s0={pdf:function(e,t){return t<0||e%1!==0||e<0?0:Math.pow(t,e)*Math.exp(-t)/Wv(e)},cdf:function(e,t){var r=0;if(e<0)return 0;for(var i=0;r<=e;r++)i+=s0.pdf(r,t);return i}},qa={pdf:function(e,t,r,i){if(e<0||e<r-(t-i))return 0;if(e>i||e>r)return 0;if(r*2>t)return i*2>t?qa.pdf(t-r-i+e,t,t-r,t-i):qa.pdf(i-e,t,t-r,i);if(i*2>t)return qa.pdf(r-e,t,r,t-i);if(r<i)return qa.pdf(e,t,i,r);for(var s=1,o=0,a=0;a<e;a++){for(;s>1&&o<i;)s*=1-r/(t-o),o++;s*=(i-a)*(r-a)/((a+1)*(t-r-i+a+1))}for(;o<i;o++)s*=1-r/(t-o);return Math.min(1,Math.max(0,s))},cdf:function n(e,t,r,i){if(e<0||e<r-(t-i))return 0;if(e>=i||e>=r)return 1;if(r*2>t)return i*2>t?n(t-r-i+e,t,t-r,t-i):1-qa.cdf(i-e-1,t,t-r,i);if(i*2>t)return 1-qa.cdf(r-e-1,t,r,t-i);if(r<i)return qa.cdf(e,t,i,r);for(var s=1,o=1,a=0,l=0;l<e;l++){for(;s>1&&a<i;){var u=1-r/(t-a);o*=u,s*=u,a++}o*=(i-l)*(r-l)/((l+1)*(t-r-i+l+1)),s+=o}for(;a<i;a++)s*=1-r/(t-a);return Math.min(1,Math.max(0,s))}},vs={pdf:function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*a_(.5,t/2))*Math.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var r=t/2;return bS((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),r,r)},inv:function(n,e){var t=l_(2*Math.min(n,1-n),.5*e,.5);return t=Math.sqrt(e*(1-t)/t),n>.5?t:-t}},bA={pdf:function(e,t,r){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(Math.log(e)-t,2)/(2*r*r))},cdf:function(e,t,r){return e<0?0:.5+.5*xd((Math.log(e)-t)/Math.sqrt(2*r*r))},inv:function(n,e,t){return Math.exp(-1.4142135623730951*t*N2(2*n)+e)}},o0={pdf:function(e,t,r){return e!==e>>>0?!1:e<0?0:O2(e+t-1,t-1)*Math.pow(1-r,e)*Math.pow(r,t)},cdf:function(e,t,r){var i=0,s=0;if(e<0)return 0;for(;s<=e;s++)i+=o0.pdf(s,t,r);return i}};function _2(n){for(var e=0,t=n.length;--t>=0;)e+=n[t];return e}function ds(n){return _2(n)/n.length}function Ch(n){for(var e=ds(n),t=0,r=n.length,i;--r>=0;)i=n[r]-e,t+=i*i;return t}function vm(n,e){return Ch(n)/(n.length-(e?1:0))}function iu(n,e){return Math.sqrt(vm(n,e))}function $ye(){var n=[].slice.call(arguments),e=new Array(2),t;return n.length===4?t=Math.abs(to.inv(n[1]/2,0,1)*n[2]/Math.sqrt(n[3])):t=Math.abs(to.inv(n[1]/2,0,1)*iu(n[2])/Math.sqrt(n[2].length)),e[0]=n[0]-t,e[1]=n[0]+t,e}function Gye(){var n=[].slice.call(arguments),e=new Array(2),t;return n.length===4?t=Math.abs(vs.inv(n[1]/2,n[3]-1)*n[2]/Math.sqrt(n[3])):t=Math.abs(vs.inv(n[1]/2,n[2].length-1)*iu(n[2],!0)/Math.sqrt(n[2].length)),e[0]=n[0]-t,e[1]=n[0]+t,e}function jye(n){for(var e=1,t=n.length;--t>=0;)e*=n[t];return e}function zye(n){return Math.pow(jye(n),1/n.length)}function ym(n,e){var t=ds(n),r=ds(e),i=n.length,s=new Array(i),o;for(o=0;o<i;o++)s[o]=(n[o]-t)*(e[o]-r);return _2(s)/(i-1)}function yk(n,e){return ym(n,e)/iu(n,1)/iu(e,1)}class u_ extends st{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(r,i)=>i===void 0?xd(r):xd(i)-xd(r))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),A2)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(r,i,s)=>s?gk.cdf(r,i):gk.pdf(r,i))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),r=>Math.log((1+r)/(1-r))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),r=>1-2/(Math.exp(2*r)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),Zm)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(r,i,s,o)=>o?SA.cdf(r,i,s):SA.pdf(r,i,s))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),Er)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),SA.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),r=>to.cdf(r,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(r,i,s,o,a,l)=>r<=a?new E(N.NUM,_.ValueSmall):r>=l?new E(N.NUM,_.ValueLarge):(r=(r-a)/(l-a),o?RA.cdf(r,i,s):RA.pdf(r,i,s)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(r,i,s,o,a)=>o>=a?new E(N.NUM,_.WrongOrder):RA.inv(r,i,s)*(a-o)+o)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(r,i,s,o)=>r>i?new E(N.NUM,_.WrongOrder):(r=Math.trunc(r),i=Math.trunc(i),o?Bv.cdf(r,i,s):Bv.pdf(r,i,s)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(r,i,s)=>{r=Math.trunc(r);let o=-1,a=r;for(;a>o+1;){const l=Math.trunc((o+a)/2);Bv.cdf(l,r,i)>=s?a=l:o=l}return a})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(r,i)=>i0(r,Math.trunc(i)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(r,i)=>r0(r,Math.trunc(i)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(r,i)=>Bye(r,Math.trunc(i)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(r,i)=>Uye(r,Math.trunc(i)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(r,i,s)=>(i=Math.trunc(i),s?ad.cdf(r,i):ad.pdf(r,i)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(r,i)=>1-ad.cdf(r,Math.trunc(i)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(r,i)=>ad.inv(r,Math.trunc(i)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(r,i)=>ad.inv(1-r,Math.trunc(i)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(r,i,s,o)=>(i=Math.trunc(i),s=Math.trunc(s),o?ld.cdf(r,i,s):ld.pdf(r,i,s)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(r,i,s)=>1-ld.cdf(r,Math.trunc(i),Math.trunc(s)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(r,i,s)=>ld.inv(r,Math.trunc(i),Math.trunc(s)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(r,i,s)=>ld.inv(1-r,Math.trunc(i),Math.trunc(s)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(r,i,s,o)=>o?vk.cdf(r,s,i):vk.pdf(r,s,i))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(r,i,s)=>(r=Math.trunc(r),s?s0.cdf(r,i):s0.pdf(r,i)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(r,i,s,o,a)=>r>i||r>s||i>o||s>o?new E(N.NUM,_.ValueLarge):r+o<s+i?new E(N.NUM,_.ValueLarge):(r=Math.trunc(r),i=Math.trunc(i),s=Math.trunc(s),o=Math.trunc(o),a?qa.cdf(r,o,s,i):qa.pdf(r,o,s,i)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(r,i,s)=>(i=Math.trunc(i),s?vs.cdf(r,i):vs.pdf(r,i)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(r,i)=>(1-vs.cdf(r,Math.trunc(i)))*2)}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(r,i)=>1-vs.cdf(r,Math.trunc(i)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(r,i,s)=>s*(1-vs.cdf(r,Math.trunc(i))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(r,i)=>vs.inv(r,Math.trunc(i)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(r,i)=>vs.inv(1-r/2,Math.trunc(i)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(r,i,s,o)=>o?bA.cdf(r,i,s):bA.pdf(r,i,s))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(r,i,s)=>bA.inv(r,i,s))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(r,i,s,o)=>o?to.cdf(r,i,s):to.pdf(r,i,s))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(r,i,s)=>to.inv(r,i,s))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(r,i)=>i?to.cdf(r,0,1):to.pdf(r,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),r=>to.inv(r,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),r=>to.pdf(r,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(r,i,s,o)=>(r=Math.trunc(r),i=Math.trunc(i),o?o0.cdf(r,i,s):o0.pdf(r,i,s)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(r,i,s)=>$ye(1,r,i,Math.trunc(s))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(r,i,s)=>(s=Math.trunc(s),s===1?new E(N.DIV_BY_ZERO):Gye(1,r,i,s)[1]-1))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(r,i,s)=>(r-i)/s)}}u_.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:g.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:g.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:g.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:g.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:g.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:g.NUMBER,minValue:0,lessThan:1},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:g.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:g.NUMBER,greaterThan:0,maxValue:1},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:1,maxValue:1e10},{argumentType:g.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:1},{argumentType:g.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:1},{argumentType:g.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1},{argumentType:g.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:g.NUMBER,greaterThan:0,maxValue:1},{argumentType:g.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:g.NUMBER},{argumentType:g.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:g.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0}]}};u_.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};class x2 extends st{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),r=>{r=Math.trunc(r);let i=1;for(let s=1;s<=r;s++)i*=s;return i})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),r=>{r=Math.trunc(r);let i=1;for(let s=r;s>=1;s-=2)i*=s;return i})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(r,i)=>i>r?new E(N.NUM,_.WrongOrder):(r=Math.trunc(r),i=Math.trunc(i),Ck(r,i)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(r,i)=>(r=Math.trunc(r),i=Math.trunc(i),r+i-1>=1030?new E(N.NUM,_.ValueLarge):r===0&&i===0?1:Ck(r+i-1,i)))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(r);if(i instanceof E)return i;let s=0;for(const o of i){if(o<0)return new E(N.NUM,_.ValueSmall);s=P2(s,Math.trunc(o))}return s>Number.MAX_SAFE_INTEGER?new E(N.NUM,_.ValueLarge):s})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(r);if(i instanceof E)return i;let s=1;for(const o of i){if(o<0)return new E(N.NUM,_.ValueSmall);s=Yye(s,Math.trunc(o))}return s>Number.MAX_SAFE_INTEGER?new E(N.NUM,_.ValueLarge):s})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(r,i)=>i===0?0:r>0&&i<0||r<0&&i>0?new E(N.NUM,_.DistinctSigns):Math.round(r/i)*i)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...r)=>{let i=0,s=1;for(let o of r){if(o<0)return new E(N.NUM,_.ValueSmall);o=Math.trunc(o);for(let a=1;a<=o;a++)s*=(i+a)/a;i+=o}return Math.round(s)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(r,i)=>i===0?new E(N.DIV_BY_ZERO):Math.trunc(r/i))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(r,i,s,o)=>{const a=this.arithmeticHelper.manyToOnlyNumbersDropNulls(o.valuesFromTopLeftCorner());if(a instanceof E)return a;let l=0;a.reverse();for(const u of a)l*=Math.pow(r,s),l+=u;return l*Math.pow(r,i)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),r=>r>0?1:r<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new E(N.NA,_.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const h=s[u],c=o[u];if(h instanceof E)return h;if(c instanceof E)return c;typeof h=="number"&&typeof c=="number"&&(l+=Math.pow(h,2)-Math.pow(c,2))}return l})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new E(N.NA,_.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const h=s[u],c=o[u];if(h instanceof E)return h;if(c instanceof E)return c;typeof h=="number"&&typeof c=="number"&&(l+=Math.pow(h,2)+Math.pow(c,2))}return l})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new E(N.NA,_.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const h=s[u],c=o[u];if(h instanceof E)return h;if(c instanceof E)return c;typeof h=="number"&&typeof c=="number"&&(l+=Math.pow(h-c,2))}return l})}}x2.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:g.NUMBER,minValue:0,lessThan:1030},{argumentType:g.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:g.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:g.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]}};function Ck(n,e){2*e>n&&(e=n-e);let t=1;for(let r=1;r<=e;r++)t*=(n-e+r)/r;return Math.round(t)}function P2(n,e){for(n<e&&([n,e]=[e,n]);e>0;)[n,e]=[e,n%e];return n}function Yye(n,e){return n===0||e===0?0:n*(e/P2(n,e))}class L2 extends st{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(r,i,s)=>s!=="i"&&s!=="j"?new E(N.VALUE,_.ShouldBeIorJ):Dn([r,i],s))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),F2)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([r,i])=>i)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([r,i])=>r)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([r,i])=>r===0&&i===0?new E(N.DIV_BY_ZERO):Math.atan2(i,r))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([r,i])=>Dn([r,-i]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),r=>Dn(sv(r)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),r=>Dn(Sk(r)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),r=>Dn(gh(sv(r),ov(r))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),r=>Dn(gh([1,0],ov(r))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),r=>Dn(gh([1,0],Rk(r))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),r=>Dn(gh([1,0],sv(r))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),r=>Dn(gh([1,0],Sk(r))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),r=>Dn(ov(r)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),r=>Dn(Rk(r)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),r=>Dn(gh(ov(r),sv(r))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(r,i)=>Dn(gh(r,i)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...r)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(r);if(i instanceof E)return i;let s=[1,0];for(const o of i)s=D2(s,o);return Dn(s)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...r)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(r);if(i instanceof E)return i;let s=[0,0];for(const o of i)s=Kye(s,o);return Dn(s)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(r,i)=>Dn(qye(r,i)))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),r=>Dn(H2(r)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),r=>Dn($v(r)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),r=>{const[i,s]=$v(r),o=Math.log(10);return Dn([i/o,s/o])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),r=>{const[i,s]=$v(r),o=Math.log(2);return Dn([i/o,s/o])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(r,i)=>Dn(Ek(r,i)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),r=>Dn(Ek(r,.5)))}}L2.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:g.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:g.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:g.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:g.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:g.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:g.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:g.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:g.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:g.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:g.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:g.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:g.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:g.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:g.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:g.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:g.COMPLEX},{argumentType:g.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:g.COMPLEX},{argumentType:g.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:g.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:g.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:g.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:g.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:g.COMPLEX},{argumentType:g.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:g.COMPLEX}]}};function Kye([n,e],[t,r]){return[n+t,e+r]}function qye([n,e],[t,r]){return[n-t,e-r]}function D2([n,e],[t,r]){return[n*t-e*r,n*r+t*e]}function gh([n,e],[t,r]){const i=Math.pow(t,2)+Math.pow(r,2),[s,o]=D2([n,e],[t,-r]);return[s/i,o/i]}function sv([n,e]){return[Math.cos(n)*Math.cosh(e),-Math.sin(n)*Math.sinh(e)]}function Sk([n,e]){return[Math.cosh(n)*Math.cos(e),Math.sinh(n)*Math.sin(e)]}function ov([n,e]){return[Math.sin(n)*Math.cosh(e),Math.cos(n)*Math.sinh(e)]}function Rk([n,e]){return[Math.sinh(n)*Math.cos(e),Math.cosh(n)*Math.sin(e)]}function H2([n,e]){return[Math.exp(n)*Math.cos(e),Math.exp(n)*Math.sin(e)]}function F2([n,e]){return Math.sqrt(n*n+e*e)}function $v([n,e]){return[Math.log(F2([n,e])),Math.atan2(e,n)]}function Ek(n,e){const[t,r]=$v(n);return H2([e*t,e*r])}class h_ extends st{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;if(i.length===0)return new E(N.DIV_BY_ZERO);const s=ds(i);return i.reduce((o,a)=>o+Math.abs(a-s),0)/i.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);return i instanceof E?i:i.length===0?0:Ch(i)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;if(i.length===0)return new E(N.NUM,_.OneValue);for(const s of i)if(s<=0)return new E(N.NUM,_.ValueSmall);return zye(i)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;if(i.length===0)return new E(N.NUM,_.OneValue);for(const s of i)if(s<=0)return new E(N.NUM,_.ValueSmall);return i.length/i.reduce((s,o)=>s+1/o,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=ph(r,i);return s instanceof E?s:s[0].length<=1?new E(N.DIV_BY_ZERO,_.TwoValues):yk(s[0],s[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=ph(r,i);return s instanceof E?s:s[0].length<=1?new E(N.DIV_BY_ZERO,_.TwoValues):Math.pow(yk(s[0],s[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=ph(r,i);if(s instanceof E)return s;const o=s[0].length;return o<1?new E(N.DIV_BY_ZERO,_.OneValue):o===1?0:ym(s[0],s[1])*(o-1)/o})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=ph(r,i);return s instanceof E?s:s[0].length<=1?new E(N.DIV_BY_ZERO,_.TwoValues):ym(s[0],s[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(r,i,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());if(o instanceof E)return o;const a=o.length;if(s===void 0){if(a<2)return new E(N.DIV_BY_ZERO,_.TwoValues);s=iu(o,!0)}return a<1?new E(N.NA,_.OneValue):s===0?new E(N.DIV_BY_ZERO):1-to.cdf((ds(o)-i)/(s/Math.sqrt(a)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner()),o=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(s instanceof E)return s;if(o instanceof E)return o;if(s.length<=1||o.length<=1)return new E(N.DIV_BY_ZERO);const a=vm(s,!0),l=vm(o,!0);if(a===0||l===0)return new E(N.DIV_BY_ZERO);const u=a/l,h=ld.cdf(u,s.length-1,o.length-1);return 2*Math.min(h,1-h)})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=ph(r,i);if(s instanceof E)return s;const o=s[0].length;return o<=2?new E(N.DIV_BY_ZERO,_.ThreeValues):Math.sqrt((Ch(s[0])-Math.pow(ym(s[0],s[1])*(o-1),2)/Ch(s[1]))/(o-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=ph(r,i);if(s instanceof E)return s;const o=s[0].length;return o<=1?new E(N.DIV_BY_ZERO,_.TwoValues):ym(s[0],s[1])*(o-1)/Ch(s[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(r,i)=>{const s=r.height(),o=r.width();if(i.height()!==s||i.width()!==o)return new E(N.NA,_.EqualLength);const a=ph(r,i);if(a instanceof E)return a;if(a[0].length<=1)return new E(N.DIV_BY_ZERO,_.TwoValues);let l=0;for(let u=0;u<a[0].length;u++){if(a[1][u]===0)return new E(N.DIV_BY_ZERO);l+=Math.pow(a[0][u]-a[1][u],2)/a[1][u]}return l<0?new E(N.NUM,_.NaN):1-ad.cdf(l,s>1&&o>1?(s-1)*(o-1):s*o-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(r,i,s,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner()),l=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(a instanceof E)return a;if(l instanceof E)return l;const u=a.length,h=l.length;if(o===1){if(h!==u)return new E(N.NA,_.EqualLength);if(u<=1)return new E(N.DIV_BY_ZERO,_.TwoValues);const c=Array(u);for(let m=0;m<u;m++)c[m]=a[m]-l[m];const d=iu(c,!0);if(d===0)return new E(N.DIV_BY_ZERO);const f=Math.abs(Math.sqrt(u)*ds(c)/d);return s*(1-vs.cdf(f,u-1))}else if(o===2){if(u<=1||h<=1)return new E(N.DIV_BY_ZERO,_.TwoValues);const c=(Ch(a)+Ch(l))/(u+h-2);if(c===0)return new E(N.DIV_BY_ZERO);const d=Math.abs((ds(a)-ds(l))/Math.sqrt(c*(1/u+1/h)));return s*(1-vs.cdf(d,u+h-2))}else{if(u<=1||h<=1)return new E(N.DIV_BY_ZERO,_.TwoValues);const c=vm(a,!0),d=vm(l,!0);if(c===0&&d===0)return new E(N.DIV_BY_ZERO);const f=Math.abs((ds(a)-ds(l))/Math.sqrt(c/u+d/h)),m=Math.pow(c/u+d/h,2)/(Math.pow(c/u,2)/(u-1)+Math.pow(d/h,2)/(h-1));return s*(1-vs.cdf(f,m))}})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;const s=i.length;if(s<3)return new E(N.DIV_BY_ZERO,_.ThreeValues);const o=ds(i),a=iu(i,!0);return a===0?new E(N.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)*s/(s-1)/(s-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;const s=i.length;if(s<3)return new E(N.DIV_BY_ZERO,_.ThreeValues);const o=ds(i),a=iu(i,!1);return a===0?new E(N.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)/s})}}h_.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE},{argumentType:g.INTEGER,minValue:1,maxValue:2},{argumentType:g.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:g.ANY}],repeatLastArgs:1}};h_.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function ph(n,e){const t=n.iterateValuesFromTopLeftCorner(),r=e.iterateValuesFromTopLeftCorner();let i,s;const o=[],a=[];for(;i=t.next(),s=r.next(),!i.done&&!s.done;){const l=i.value,u=s.value;if(l instanceof E)return l;if(u instanceof E)return u;Lt(l)&&Lt(u)&&(o.push(pe(l)),a.push(pe(u)))}return[o,a]}const bk=Object.freeze(Object.defineProperty({__proto__:null,AbsPlugin:Fj,AddressPlugin:Dj,ArrayPlugin:Hj,BitShiftPlugin:kj,BitwiseLogicOperationsPlugin:Wj,BooleanPlugin:$j,CharPlugin:Gj,CodePlugin:jj,ComplexPlugin:L2,ConditionalAggregationPlugin:w2,CountBlankPlugin:zj,CountUniquePlugin:Yj,DateTimePlugin:Kj,DegreesPlugin:qj,DeltaPlugin:Xj,ExpPlugin:Qj,FinancialPlugin:Zj,FormulaTextPlugin:Jj,HyperlinkPlugin:e2,InformationPlugin:t2,IsEvenPlugin:n2,IsOddPlugin:r2,LogarithmPlugin:i2,LookupPlugin:S2,MathConstantsPlugin:s2,MathPlugin:x2,MatrixPlugin:o2,MedianPlugin:a2,ModuloPlugin:l2,NumericAggregationPlugin:i_,PowerPlugin:u2,RadiansPlugin:h2,RadixConversionPlugin:d2,RandomPlugin:g2,RomanPlugin:R2,RoundingPlugin:s_,SimpleArithmerticPlugin:E2,SqrtPlugin:p2,StatisticalAggregationPlugin:h_,StatisticalPlugin:u_,SumprodPlugin:v2,TextPlugin:y2,TrigonometryPlugin:C2},Symbol.toStringTag,{value:"Module"}));class pt extends Tr{}pt.HyperFormula=Tr;pt.ErrorType=N;pt.CellError=E;pt.CellType=Ii;pt.CellValueType=oo;pt.CellValueDetailedType=Owe;pt.DetailedCellError=vj;pt.ExportedCellChange=ZN;pt.ExportedNamedExpressionChange=Oj;pt.ConfigValueTooBigError=oj;pt.ConfigValueTooSmallError=sj;pt.EvaluationSuspendedError=lj;pt.ExpectedOneOfValuesError=aj;pt.ExpectedValueOfTypeError=xt;pt.ArraySize=Ct;pt.SimpleRangeValue=Me;pt.EmptyValue=ft;pt.FunctionPlugin=st;pt.FunctionArgumentType=g;pt.FunctionPluginValidationError=$d;pt.InvalidAddressError=ZG;pt.InvalidArgumentsError=Jn;pt.LanguageNotRegisteredError=BN;pt.LanguageAlreadyRegisteredError=hj;pt.MissingTranslationError=sd;pt.NamedExpressionDoesNotExistError=Tg;pt.NamedExpressionNameIsAlreadyTakenError=JG;pt.NamedExpressionNameIsInvalidError=ej;pt.NoOperationToRedoError=nj;pt.NoOperationToUndoError=tj;pt.NoRelativeAddressesAllowedError=JO;pt.NoSheetWithIdError=Nn;pt.NoSheetWithNameError=QG;pt.NotAFormulaError=Fv;pt.NothingToPasteError=rj;pt.ProtectedFunctionTranslationError=uj;pt.SheetNameAlreadyTakenError=Eg;pt.SheetSizeLimitExceededError=Hh;pt.SourceLocationHasArrayError=wd;pt.TargetLocationHasArrayError=rC;pt.UnableToParseError=ij;const Xye=_r.defaultConfig.language;Tr.registerLanguage(Xye,JN);Tr.languages[JN.langCode]=JN;for(const n of Object.getOwnPropertyNames(bk))n.startsWith("_")||Tr.registerFunctionPlugin(bk[n]);Jfe();const Qye=qr(vr)(({theme:n})=>({flex:1,overflow:"hidden","& .handsontable":{fontFamily:n.typography.fontFamily,fontSize:"13px"},"& .handsontable th":{backgroundColor:n.palette.mode==="dark"?Rn(n.palette.text.primary,.05):Yr[200],fontWeight:600},"& .handsontable td":{verticalAlign:"middle"},"& .handsontable td.area":{backgroundColor:n.palette.mode==="dark"?Rn(n.palette.text.primary,.1):Yr[300]},"& .handsontable .htContextMenu":{borderRadius:8,boxShadow:n.shadows[8]},"& .handsontable .wtBorder.current":{backgroundColor:n.palette.mode==="dark"?Yr[1e3]:Yr[1100]}})),Zye=Tr.buildEmpty({licenseKey:"gpl-v3"}),Jye=n=>{const e=[];for(let t=0;t<n;t++){let r="",i=t;for(;i>=0;)r=String.fromCharCode(i%26+65)+r,i=Math.floor(i/26)-1;e.push(r)}return e};function eCe({data:n=[],columns:e=26,rows:t=100,onCellChange:r,onSelectionChange:i,onFormulaBarUpdate:s,readOnly:o=!1,contextMenuEnabled:a=!0,formulas:l=!0}){a0();const u=Ne.useRef(null),[h,c]=Ne.useState(null),[d,f]=Ne.useState(null),m=Ne.useMemo(()=>n&&n.length>0?n:Array(t).fill(null).map(()=>Array(e).fill("")),[n,t,e]),p=Ne.useMemo(()=>Jye(e),[e]),v=Ne.useCallback((A,I)=>{if(!A||I==="loadData")return;const H=A.map(([k,W,z,G])=>({row:k,col:W,oldValue:z,newValue:G,cellRef:`${p[W]}${k+1}`}));r?.(H,I)},[p,r]),y=Ne.useCallback((A,I,H,k)=>{const W={start:{row:A,col:I,ref:`${p[I]}${A+1}`},end:{row:H,col:k,ref:`${p[k]}${H+1}`},isRange:A!==H||I!==k};f(W),i?.(W);const z=u.current?.hotInstance;if(z){const G=z.getDataAtCell(A,I),q=z.getCellMeta(A,I);s?.({cellRef:W.start.ref,value:G||"",formula:q?.formula||null})}},[p,s,i]);Ne.useCallback(A=>{A.preventDefault(),c({mouseX:A.clientX,mouseY:A.clientY})},[]);const C=Ne.useCallback(()=>{c(null)},[]);Ne.useCallback(A=>{const I=u.current?.hotInstance;if(I){switch(A){case"copy":document.execCommand("copy");break;case"cut":document.execCommand("cut");break;case"paste":document.execCommand("paste");break;case"delete":if(d){const{start:H,end:k}=d;for(let W=Math.min(H.row,k.row);W<=Math.max(H.row,k.row);W++)for(let z=Math.min(H.col,k.col);z<=Math.max(H.col,k.col);z++)I.setDataAtCell(W,z,"")}break;case"insert_row_above":d&&I.alter("insert_row_above",d.start.row);break;case"insert_row_below":d&&I.alter("insert_row_below",d.start.row);break;case"delete_row":d&&I.alter("remove_row",d.start.row);break;case"insert_col_left":d&&I.alter("insert_col_start",d.start.col);break;case"insert_col_right":d&&I.alter("insert_col_end",d.start.col);break;case"delete_col":d&&I.alter("remove_col",d.start.col);break}C()}},[C,d]);const R=Ne.useMemo(()=>({data:m,colHeaders:p,rowHeaders:!0,width:"100%",height:"100%",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,readOnly:o,manualColumnResize:!0,manualRowResize:!0,manualColumnMove:!0,manualRowMove:!0,dropdownMenu:a,filters:!0,multiColumnSorting:!0,mergeCells:!0,undo:!0,autoColumnSize:{syncLimit:100},autoRowSize:{syncLimit:100},licenseKey:"non-commercial-and-evaluation",formulas:l?{engine:Zye}:!1,cells:function(A,I){return{}},comments:!0,validator:(A,I)=>{I(!0)},afterChange:v,afterSelection:y,afterScrollVertically:()=>{},afterScrollHorizontally:()=>{},contextMenu:a?{items:{copy:{name:"Copy",disabled:!1},cut:{name:"Cut",disabled:!1},hsep1:"---------",row_above:{name:"Insert row above"},row_below:{name:"Insert row below"},remove_row:{name:"Remove row"},hsep2:"---------",col_left:{name:"Insert column left"},col_right:{name:"Insert column right"},remove_col:{name:"Remove column"},hsep3:"---------",undo:{name:"Undo"},redo:{name:"Redo"}}}:!1}),[m,p,o,a,l,v,y]);return Ne.useEffect(()=>{if(u.current){const A=u.current.hotInstance;u.current.setSelectedCellValue=I=>{d&&A&&A.setDataAtCell(d.start.row,d.start.col,I)},u.current.getData=()=>A?.getData()||[],u.current.loadData=I=>A?.loadData(I),u.current.insertRow=(I,H=1)=>{A?.alter("insert_row_below",I,H)},u.current.insertColumn=(I,H=1)=>{A?.alter("insert_col_end",I,H)}}},[d]),te.jsx(Qye,{children:te.jsx(PB,{ref:u,settings:R})})}const tCe=qr(vr)(({theme:n})=>({display:"flex",alignItems:"center",padding:n.spacing(1,2),borderBottom:`1px solid ${Rn(n.palette.divider,.1)}`,backgroundColor:n.palette.background.paper,gap:n.spacing(1)})),nCe=qr(vr)(({theme:n})=>({display:"flex",alignItems:"center",minWidth:80,padding:n.spacing(.5,1),backgroundColor:n.palette.mode==="dark"?Rn(n.palette.text.primary,.05):Yr[200],borderRadius:8,border:`1px solid ${Rn(n.palette.divider,.2)}`,cursor:"pointer","&:hover":{borderColor:n.palette.mode==="dark"?Yr[1e3]:Yr[1100]}})),rCe=qr(av)(({theme:n})=>({flex:1,"& .MuiOutlinedInput-root":{borderRadius:8,fontSize:"13px",fontFamily:"monospace","& fieldset":{borderColor:Rn(n.palette.divider,.2)},"&:hover fieldset":{borderColor:n.palette.mode==="dark"?Rn(n.palette.text.primary,.3):Yr[600]},"&.Mui-focused fieldset":{borderColor:n.palette.mode==="dark"?Yr[1e3]:Yr[1100]}}})),Tk=qr(l0)(({theme:n})=>({borderRadius:8,height:24,fontSize:"0.75rem",fontFamily:"monospace",backgroundColor:n.palette.mode==="dark"?Rn(n.palette.text.primary,.1):Yr[300],color:"text.secondary","&:hover":{backgroundColor:n.palette.mode==="dark"?Rn(n.palette.text.primary,.15):Yr[400]}})),Ak=[{name:"SUM",syntax:"SUM(range)",description:"Sum of values"},{name:"AVERAGE",syntax:"AVERAGE(range)",description:"Average of values"},{name:"COUNT",syntax:"COUNT(range)",description:"Count of numbers"},{name:"COUNTA",syntax:"COUNTA(range)",description:"Count of non-empty cells"},{name:"MAX",syntax:"MAX(range)",description:"Maximum value"},{name:"MIN",syntax:"MIN(range)",description:"Minimum value"},{name:"IF",syntax:"IF(condition, true_val, false_val)",description:"Conditional logic"},{name:"VLOOKUP",syntax:"VLOOKUP(value, range, col, exact)",description:"Vertical lookup"},{name:"HLOOKUP",syntax:"HLOOKUP(value, range, row, exact)",description:"Horizontal lookup"},{name:"SUMIF",syntax:"SUMIF(range, criteria, sum_range)",description:"Conditional sum"},{name:"COUNTIF",syntax:"COUNTIF(range, criteria)",description:"Conditional count"},{name:"CONCATENATE",syntax:"CONCATENATE(text1, text2, ...)",description:"Join text"},{name:"LEFT",syntax:"LEFT(text, num_chars)",description:"Left characters"},{name:"RIGHT",syntax:"RIGHT(text, num_chars)",description:"Right characters"},{name:"MID",syntax:"MID(text, start, length)",description:"Middle characters"},{name:"LEN",syntax:"LEN(text)",description:"Text length"},{name:"TRIM",syntax:"TRIM(text)",description:"Remove extra spaces"},{name:"ROUND",syntax:"ROUND(number, decimals)",description:"Round number"},{name:"ABS",syntax:"ABS(number)",description:"Absolute value"},{name:"TODAY",syntax:"TODAY()",description:"Current date"},{name:"NOW",syntax:"NOW()",description:"Current date and time"},{name:"YEAR",syntax:"YEAR(date)",description:"Year from date"},{name:"MONTH",syntax:"MONTH(date)",description:"Month from date"},{name:"DAY",syntax:"DAY(date)",description:"Day from date"}];function iCe({cellRef:n="",value:e="",formula:t=null,onChange:r,onApply:i,onCancel:s,onCellRefClick:o,disabled:a=!1}){a0();const l=Ne.useRef(null),[u,h]=Ne.useState(e),[c,d]=Ne.useState(!1),[f,m]=Ne.useState(null),[p,v]=Ne.useState(null),[y,C]=Ne.useState([]);Ne.useEffect(()=>{h(t||e)},[e,t]),u.startsWith("=");const R=Ne.useCallback(q=>{const J=q.target.value;if(h(J),d(!0),r?.(J),J.startsWith("=")){const re=J.match(/=([A-Z]+)$/i);if(re){const ie=re[1].toUpperCase(),ae=Ak.filter(Ke=>Ke.name.startsWith(ie));ae.length>0?(C(ae),v(l.current)):v(null)}else v(null)}else v(null)},[r]),A=Ne.useCallback(()=>{d(!1),v(null),i?.(u)},[u,i]),I=Ne.useCallback(()=>{h(t||e),d(!1),v(null),s?.()},[t,s,e]),H=Ne.useCallback(q=>{q.key==="Enter"?A():q.key==="Escape"&&I()},[A,I]),k=Ne.useCallback(q=>{const J=u,re=J.match(/=([A-Z]+)$/i);if(re){const ie=J.slice(0,-re[1].length)+q.name+"(";h(ie),r?.(ie)}v(null),l.current?.focus()},[u,r]),W=Ne.useCallback(q=>{m(q.currentTarget)},[]),z=Ne.useCallback(()=>{m(null)},[]),G=Ne.useCallback(q=>{const J=`=${q.name}(`;h(J),r?.(J),z(),l.current?.focus()},[z,r]);return te.jsxs(tCe,{children:[te.jsx(nCe,{onClick:o,children:te.jsx(no,{variant:"body2",sx:{fontWeight:600,fontFamily:"monospace"},children:n||"A1"})}),te.jsx(bh,{title:"Insert Function",children:te.jsx(Gl,{size:"small",onClick:W,disabled:a,sx:{color:"text.secondary"},children:te.jsx(nz,{fontSize:"small"})})}),te.jsx(rCe,{ref:l,size:"small",fullWidth:!0,value:u,onChange:R,onKeyDown:H,onFocus:()=>d(!0),placeholder:"Enter value or formula (start with =)",disabled:a,InputProps:{sx:{color:"text.primary"}}}),c&&te.jsxs(y_,{direction:"row",spacing:.5,children:[te.jsx(bh,{title:"Apply (Enter)",children:te.jsx(Gl,{size:"small",onClick:A,sx:{color:"text.secondary"},children:te.jsx(J2,{fontSize:"small"})})}),te.jsx(bh,{title:"Cancel (Esc)",children:te.jsx(Gl,{size:"small",onClick:I,sx:{color:"text.secondary"},children:te.jsx(W2,{fontSize:"small"})})})]}),te.jsx(C_,{open:!!f,anchorEl:f,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"left"},PaperProps:{sx:{width:320,maxHeight:400,borderRadius:1}},children:te.jsxs(vr,{sx:{p:1.5},children:[te.jsx(no,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"Insert Function"}),te.jsx(AA,{dense:!0,sx:{maxHeight:300,overflow:"auto"},children:Ak.map(q=>te.jsx(S_,{disablePadding:!0,children:te.jsx(NA,{onClick:()=>G(q),sx:{borderRadius:1,py:.5},children:te.jsx(um,{primary:te.jsx(y_,{direction:"row",alignItems:"center",spacing:1,children:te.jsx(Tk,{label:q.name,size:"small"})}),secondary:te.jsx(no,{variant:"caption",color:"text.secondary",children:q.description})})})},q.name))})]})}),te.jsx(C_,{open:!!p&&y.length>0,anchorEl:p,onClose:()=>v(null),anchorOrigin:{vertical:"bottom",horizontal:"left"},disableAutoFocus:!0,disableEnforceFocus:!0,PaperProps:{sx:{width:250,maxHeight:200,borderRadius:1}},children:te.jsx(AA,{dense:!0,children:y.slice(0,8).map(q=>te.jsx(S_,{disablePadding:!0,children:te.jsxs(NA,{onClick:()=>k(q),sx:{py:.5},children:[te.jsx(Tk,{label:q.name,size:"small",sx:{mr:1}}),te.jsx(no,{variant:"caption",color:"text.secondary",noWrap:!0,children:q.description})]})},q.name))})})]})}const sCe=qr(vr)(({theme:n})=>({display:"flex",height:"calc(100vh - 64px)",backgroundColor:n.palette.background.default})),oCe=qr(vr)(({theme:n})=>({width:280,display:"flex",flexDirection:"column",borderRight:`1px solid ${Rn(n.palette.divider,.1)}`,backgroundColor:Rn(n.palette.background.paper,.6)})),aCe=qr(vr)(({theme:n})=>({padding:n.spacing(2),borderBottom:`1px solid ${Rn(n.palette.divider,.1)}`,display:"flex",alignItems:"center",justifyContent:"space-between"})),lCe=qr(vr)(({theme:n})=>({flex:1,display:"flex",flexDirection:"column",overflow:"hidden"})),uCe=qr(vr)(({theme:n})=>({display:"flex",alignItems:"center",justifyContent:"space-between",padding:n.spacing(1,2),borderBottom:`1px solid ${Rn(n.palette.divider,.1)}`,backgroundColor:Rn(n.palette.background.paper,.8),gap:n.spacing(1)})),hCe=qr(vr)(({theme:n})=>({flex:1,overflow:"hidden",backgroundColor:n.palette.background.paper})),cCe=qr(vr)(({theme:n})=>({display:"flex",alignItems:"center",padding:n.spacing(.5,1),borderTop:`1px solid ${Rn(n.palette.divider,.1)}`,backgroundColor:Rn(n.palette.background.paper,.6),minHeight:40,gap:n.spacing(.5)})),dCe=qr(l0,{shouldForwardProp:n=>n!=="active"})(({theme:n,active:e})=>({borderRadius:"4px 4px 0 0",height:28,fontSize:"0.8125rem",backgroundColor:e?n.palette.background.paper:Rn(n.palette.background.default,.5),border:`1px solid ${Rn(n.palette.divider,.2)}`,borderBottom:e?"none":`1px solid ${Rn(n.palette.divider,.2)}`,"&:hover":{backgroundColor:e?n.palette.background.paper:n.palette.mode==="dark"?Rn(n.palette.text.primary,.05):Yr[200]}})),Xc=qr(wh)(({theme:n})=>({borderRadius:6,textTransform:"none",fontWeight:500,minWidth:"auto",fontSize:"0.8125rem"})),fCe=qr(NA,{shouldForwardProp:n=>n!=="active"})(({theme:n,active:e})=>({borderRadius:8,marginBottom:n.spacing(.5),backgroundColor:e?n.palette.mode==="dark"?Rn(n.palette.text.primary,.1):Yr[300]:"transparent","&:hover":{backgroundColor:e?n.palette.mode==="dark"?Rn(n.palette.text.primary,.15):Yr[300]:Rn(n.palette.action.hover,.05)}})),mCe=qr(vr)(({theme:n})=>({flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:n.spacing(4),textAlign:"center"})),TA=(n,e)=>{let t="",r=e;for(;r>=0;)t=String.fromCharCode(r%26+65)+t,r=Math.floor(r/26)-1;return`${t}${n+1}`};function gCe(){a0();const n=$2(),{execute:e}=Ik(),{spreadsheets:t,currentSpreadsheet:r,activeSheetIndex:i,selectedCells:s,loading:o,saving:a,error:l,fetchSpreadsheets:u,createSpreadsheet:h,getSpreadsheet:c,updateSpreadsheet:d,deleteSpreadsheet:f,updateCells:m,addSheet:p,deleteSheet:v,renameSheet:y,setActiveSheetIndex:C,setSelectedCells:R,createPivotTable:A,generateFormula:I,importCsv:H,importExcel:k,exportSpreadsheet:W,reset:z}=G2(),[G,q]=Ne.useState(!1),[J,re]=Ne.useState(""),[ie,ae]=Ne.useState("A1"),[Ke,xe]=Ne.useState(""),[Se,ve]=Ne.useState(null),[He,w]=Ne.useState([]),[S,b]=Ne.useState(!1),[x,L]=Ne.useState(!1),[$,ee]=Ne.useState(""),[ne,he]=Ne.useState(null),[we,le]=Ne.useState(null),[$e,Be]=Ne.useState(!1),[Q,Je]=Ne.useState(""),[nt,wt]=Ne.useState(null),et=Ne.useRef(null),ke=Ne.useRef(null);Ne.useEffect(()=>(u(),()=>z()),[u,z]),Ne.useEffect(()=>{if(r?.sheets?.[i]?.data){const ue=r.sheets[i].data,Ue=[],Nt=100,Qe=26;for(let fn=0;fn<Nt;fn++){const rr=[];for(let fi=0;fi<Qe;fi++){const Tu=TA(fn,fi),Au=ue[Tu];rr.push(Au?.formula||Au?.value||"")}Ue.push(rr)}w(Ue)}else w(Array(100).fill(null).map(()=>Array(26).fill("")))},[r,i]);const T=Ne.useCallback((ue,Ue,Nt={})=>e({type:Hs.EXECUTE,label:ue,reversibility:Ds.FULLY_REVERSIBLE,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{source:"spreadsheets",...Nt},action:Ue}),[e]),O=Ne.useCallback(()=>T("Open create spreadsheet",()=>q(!0)),[T]),P=Ne.useCallback(()=>T("Close create spreadsheet",()=>{q(!1),re("")}),[T]),Y=Ne.useCallback(()=>T("Open AI formula",()=>L(!0)),[T]),F=Ne.useCallback(()=>T("Close AI formula",()=>{L(!1),ee("")}),[T]),X=Ne.useCallback(()=>T("Import spreadsheet",()=>et.current?.click()),[T]),B=Ne.useCallback(ue=>e({type:Hs.EXECUTE,label:"Open spreadsheet",reversibility:Ds.FULLY_REVERSIBLE,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{source:"spreadsheets",spreadsheetId:ue},action:async()=>{await c(ue),b(!1)}}),[e,c]),V=Ne.useCallback(()=>{if(J)return e({type:Hs.CREATE,label:"Create spreadsheet",reversibility:Ds.SYSTEM_MANAGED,intent:{source:"spreadsheets",name:J},action:async()=>{const ue=await h({name:J,sheets:[{name:"Sheet 1",data:{}}]});return ue&&(q(!1),re(""),n.show("Spreadsheet created","success")),ue}})},[h,e,J,n]),K=Ne.useCallback(ue=>e({type:Hs.DELETE,label:"Delete spreadsheet",reversibility:Ds.REQUIRES_CONFIRMATION,intent:{source:"spreadsheets",spreadsheetId:ue},action:async()=>{const Ue=await f(ue);return Ue&&n.show("Spreadsheet deleted","success"),Ue}}),[f,e,n]),j=Ne.useCallback((ue,Ue)=>{Ue!=="loadData"&&ue&&(b(!0),w(Nt=>{const Qe=Nt.map(fn=>[...fn]);return ue.forEach(([fn,rr,fi,Tu])=>{Qe[fn]&&(Qe[fn][rr]=Tu)}),Qe}))},[]),Z=Ne.useCallback((ue,Ue,Nt,Qe)=>{const fn=TA(ue,Ue);ae(fn);const rr=He[ue]?.[Ue]||"";xe(rr),ve(rr.startsWith("=")?rr:null)},[He]),me=Ne.useCallback(ue=>{xe(ue)},[]),Re=Ne.useCallback(ue=>{const Ue=ie.match(/^([A-Z]+)(\d+)$/);if(!Ue)return;const Nt=Ue[1],Qe=parseInt(Ue[2],10)-1;let fn=0;for(let rr=0;rr<Nt.length;rr++)fn=fn*26+(Nt.charCodeAt(rr)-64);fn-=1,w(rr=>{const fi=rr.map(Tu=>[...Tu]);return fi[Qe]&&(fi[Qe][fn]=ue),fi}),b(!0)},[ie]),Ve=Ne.useCallback(()=>{const ue=ie.match(/^([A-Z]+)(\d+)$/);if(!ue)return;const Ue=ue[1],Nt=parseInt(ue[2],10)-1;let Qe=0;for(let fn=0;fn<Ue.length;fn++)Qe=Qe*26+(Ue.charCodeAt(fn)-64);Qe-=1,xe(He[Nt]?.[Qe]||"")},[ie,He]),ot=Ne.useCallback(()=>{if(r)return e({type:Hs.UPDATE,label:"Save spreadsheet",reversibility:Ds.SYSTEM_MANAGED,intent:{source:"spreadsheets",spreadsheetId:r.id},action:async()=>{const ue={};He.forEach((Ue,Nt)=>{Ue.forEach((Qe,fn)=>{if(Qe!==""){const rr=TA(Nt,fn),fi=typeof Qe=="string"&&Qe.startsWith("=");ue[rr]={value:fi?"":Qe,formula:fi?Qe:null}}})}),await m(r.id,i,ue),b(!1),n.show("Spreadsheet saved","success")}})},[i,r,e,He,n,m]),Rt=Ne.useCallback(ue=>{const Ue=ue.target.files[0];if(!Ue)return;const Nt=Ue.name.endsWith(".xlsx")||Ue.name.endsWith(".xls");e({type:Hs.UPLOAD,label:"Import spreadsheet",reversibility:Ds.SYSTEM_MANAGED,intent:{source:"spreadsheets",filename:Ue.name},action:async()=>{(Nt?await k(Ue):await H(Ue))&&n.show("File imported successfully","success")}}).finally(()=>{ue.target.value=""})},[e,H,k,n]),at=Ne.useCallback(ue=>{if(r)return he(null),e({type:Hs.DOWNLOAD,label:"Export spreadsheet",reversibility:Ds.FULLY_REVERSIBLE,suppressSuccessToast:!0,suppressErrorToast:!0,intent:{source:"spreadsheets",spreadsheetId:r.id,format:ue},action:async()=>{const Ue=await W(r.id,ue);if(Ue){const Nt=URL.createObjectURL(Ue),Qe=document.createElement("a");Qe.href=Nt,Qe.download=`${r.name}.${ue}`,Qe.click(),URL.revokeObjectURL(Nt),n.show(`Exported to ${ue.toUpperCase()}`,"success")}else n.show("Export not available","warning")}})},[r,e,W,n]),qe=Ne.useCallback(()=>{if(!(!$||!r))return e({type:Hs.GENERATE,label:"Generate formula",reversibility:Ds.FULLY_REVERSIBLE,blocksNavigation:!0,intent:{source:"spreadsheets",spreadsheetId:r.id},action:async()=>{const ue=await I(r.id,$);return ue?.formula&&(xe(ue.formula),Re(ue.formula),n.show("Formula generated","success")),L(!1),ee(""),ue}})},[$,r,e,I,Re,n]),Tt=Ne.useCallback(ue=>T("Switch sheet",()=>C(ue),{index:ue}),[T,C]),dn=Ne.useCallback(()=>{if(r)return e({type:Hs.UPDATE,label:"Add sheet",reversibility:Ds.SYSTEM_MANAGED,intent:{source:"spreadsheets",spreadsheetId:r.id},action:async()=>{const ue=(r.sheets?.length||0)+1;await p(r.id,`Sheet ${ue}`),n.show("Sheet added","success")}})},[p,r,e,n]),Ea=Ne.useCallback(()=>{if(!(!r||nt===null||!Q))return e({type:Hs.UPDATE,label:"Rename sheet",reversibility:Ds.SYSTEM_MANAGED,intent:{source:"spreadsheets",spreadsheetId:r.id},action:async()=>{await y(r.id,nt,Q),Be(!1),Je(""),wt(null),n.show("Sheet renamed","success")}})},[r,e,Q,y,nt,n]),Fi=Ne.useCallback(ue=>{if(!r||r.sheets?.length<=1){n.show("Cannot delete the only sheet","warning");return}return e({type:Hs.DELETE,label:"Delete sheet",reversibility:Ds.REQUIRES_CONFIRMATION,intent:{source:"spreadsheets",spreadsheetId:r.id,sheetIndex:ue},action:async()=>{await v(r.id,ue),n.show("Sheet deleted","success")}})},[r,v,e,n]),bu=Ne.useCallback(()=>T("Dismiss spreadsheet error",()=>z()),[T,z]),di=Ne.useCallback(ue=>{wt(ue),Je(r?.sheets?.[ue]?.name||""),Be(!0)},[r]);return te.jsxs(sCe,{children:[te.jsxs(oCe,{children:[te.jsxs(aCe,{children:[te.jsx(no,{variant:"subtitle2",sx:{fontWeight:600},children:"Spreadsheets"}),te.jsx(bh,{title:"New Spreadsheet",children:te.jsx(Gl,{size:"small",onClick:O,children:te.jsx(IS,{fontSize:"small"})})})]}),te.jsx(vr,{sx:{flex:1,overflow:"auto",p:1},children:o&&t.length===0?te.jsx(vr,{sx:{display:"flex",justifyContent:"center",py:4},children:te.jsx(j2,{size:24})}):t.length===0?te.jsx(no,{variant:"body2",color:"text.secondary",sx:{p:2,textAlign:"center"},children:"No spreadsheets yet"}):te.jsx(AA,{disablePadding:!0,children:t.map(ue=>te.jsxs(fCe,{active:r?.id===ue.id,onClick:()=>B(ue.id),children:[te.jsx(z2,{sx:{minWidth:36},children:te.jsx(R_,{sx:{color:"text.secondary"},fontSize:"small"})}),te.jsx(um,{primary:ue.name,secondary:`${ue.sheets?.length||1} sheets`,primaryTypographyProps:{variant:"body2",fontWeight:500},secondaryTypographyProps:{variant:"caption"}}),te.jsx(Gl,{size:"small",onClick:Ue=>{Ue.stopPropagation(),K(ue.id)},children:te.jsx(Y2,{fontSize:"small"})})]},ue.id))})})]}),te.jsxs(lCe,{children:[r?te.jsxs(te.Fragment,{children:[te.jsxs(uCe,{children:[te.jsxs(vr,{sx:{display:"flex",alignItems:"center",gap:1},children:[te.jsx(no,{variant:"subtitle1",sx:{fontWeight:600},children:r.name}),S&&te.jsx(l0,{label:"Unsaved",size:"small",sx:{height:20,fontSize:"0.7rem",bgcolor:ue=>ue.palette.mode==="dark"?Rn(ue.palette.text.primary,.1):Yr[400],color:"text.secondary"}})]}),te.jsxs(vr,{sx:{display:"flex",gap:1},children:[te.jsx(bh,{title:"Undo",children:te.jsx(Gl,{size:"small",children:te.jsx(K2,{fontSize:"small"})})}),te.jsx(bh,{title:"Redo",children:te.jsx(Gl,{size:"small",children:te.jsx(ez,{fontSize:"small"})})}),te.jsx(q2,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),te.jsx(Xc,{size:"small",startIcon:te.jsx(E_,{}),onClick:X,children:"Import"}),te.jsx(Xc,{size:"small",startIcon:te.jsx(X2,{}),onClick:ue=>he(ue.currentTarget),children:"Export"}),te.jsx(Xc,{size:"small",startIcon:te.jsx(MS,{}),onClick:Y,children:"AI Formula"}),te.jsx(Xc,{variant:"contained",size:"small",startIcon:te.jsx(tz,{}),onClick:ot,disabled:a||!S,children:a?"Saving...":"Save"})]})]}),te.jsx(iCe,{cellRef:ie,value:Ke,formula:Se,onChange:me,onApply:Re,onCancel:Ve,disabled:!r}),te.jsx(hCe,{children:te.jsx(eCe,{ref:ke,data:He,onCellChange:j,onSelectionChange:Z,formulas:!0})}),te.jsxs(cCe,{children:[r.sheets?.map((ue,Ue)=>te.jsx(dCe,{label:ue.name,size:"small",active:i===Ue,onClick:()=>Tt(Ue),onDoubleClick:()=>di(Ue),onDelete:r.sheets.length>1?()=>Fi(Ue):void 0},Ue)),te.jsx(bh,{title:"Add Sheet",children:te.jsx(Gl,{size:"small",onClick:dn,children:te.jsx(IS,{fontSize:"small"})})})]})]}):te.jsxs(mCe,{children:[te.jsx(R_,{sx:{fontSize:80,color:"text.disabled",mb:2}}),te.jsx(no,{variant:"h5",sx:{fontWeight:600,mb:1},children:"No Spreadsheet Selected"}),te.jsx(no,{color:"text.secondary",sx:{mb:3},children:"Create a new spreadsheet or select one from the sidebar."}),te.jsxs(vr,{sx:{display:"flex",gap:2},children:[te.jsx(Xc,{variant:"contained",startIcon:te.jsx(IS,{}),onClick:O,children:"Create Spreadsheet"}),te.jsx(Xc,{variant:"outlined",startIcon:te.jsx(E_,{}),onClick:X,children:"Import File"})]})]}),te.jsx("input",{ref:et,type:"file",hidden:!0,accept:".csv,.xlsx,.xls",onChange:Rt})]}),te.jsxs(OS,{open:G,onClose:P,maxWidth:"xs",fullWidth:!0,children:[te.jsx(_S,{children:"Create New Spreadsheet"}),te.jsx(xS,{children:te.jsx(av,{autoFocus:!0,fullWidth:!0,label:"Spreadsheet Name",value:J,onChange:ue=>re(ue.target.value),sx:{mt:2},onKeyDown:ue=>{ue.key==="Enter"&&J&&V()}})}),te.jsxs(PS,{children:[te.jsx(wh,{onClick:P,children:"Cancel"}),te.jsx(wh,{variant:"contained",onClick:V,disabled:!J||o,children:"Create"})]})]}),te.jsxs(OS,{open:$e,onClose:()=>Be(!1),maxWidth:"xs",fullWidth:!0,children:[te.jsx(_S,{children:"Rename Sheet"}),te.jsx(xS,{children:te.jsx(av,{autoFocus:!0,fullWidth:!0,label:"Sheet Name",value:Q,onChange:ue=>Je(ue.target.value),sx:{mt:2},onKeyDown:ue=>{ue.key==="Enter"&&Q&&Ea()}})}),te.jsxs(PS,{children:[te.jsx(wh,{onClick:()=>Be(!1),children:"Cancel"}),te.jsx(wh,{variant:"contained",onClick:Ea,disabled:!Q,children:"Rename"})]})]}),te.jsxs(OS,{open:x,onClose:F,maxWidth:"sm",fullWidth:!0,children:[te.jsx(_S,{children:te.jsxs(vr,{sx:{display:"flex",alignItems:"center",gap:1},children:[te.jsx(MS,{sx:{color:"text.secondary"}}),"Generate Formula with AI"]})}),te.jsxs(xS,{children:[te.jsx(no,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Describe what you want to calculate in plain English."}),te.jsx(av,{autoFocus:!0,fullWidth:!0,multiline:!0,rows:3,placeholder:"e.g., Sum all values in column A where column B equals 'Sales'",value:$,onChange:ue=>ee(ue.target.value)}),te.jsxs(no,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:["The formula will be inserted into the currently selected cell (",ie,")"]})]}),te.jsxs(PS,{children:[te.jsx(wh,{onClick:F,children:"Cancel"}),te.jsx(wh,{variant:"contained",onClick:qe,disabled:!$,startIcon:te.jsx(MS,{}),children:"Generate"})]})]}),te.jsxs(Q2,{anchorEl:ne,open:!!ne,onClose:()=>he(null),children:[te.jsx(LS,{onClick:()=>at("csv"),children:te.jsx(um,{primary:"CSV",secondary:"Comma-separated values"})}),te.jsx(LS,{onClick:()=>at("xlsx"),children:te.jsx(um,{primary:"Excel (.xlsx)",secondary:"Microsoft Excel format"})}),te.jsx(LS,{onClick:()=>at("json"),children:te.jsx(um,{primary:"JSON",secondary:"JavaScript Object Notation"})})]}),l&&te.jsx(Z2,{severity:"error",onClose:bu,sx:{position:"fixed",bottom:16,right:16,maxWidth:400},children:l})]})}function UCe(){return Ik(),te.jsx(gCe,{})}export{UCe as default};
